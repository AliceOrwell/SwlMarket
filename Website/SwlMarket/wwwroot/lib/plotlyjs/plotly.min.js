(function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.Plotly=n()}})(function(){var n;return function t(n,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!n[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};n[f][0].call(s.exports,function(t){var i=n[f][1][t];return u(i?i:t)},s,s.exports,t,n,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n){"use strict";var u=n("../src/lib"),i={"X,X div":"font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;background:rgba(255,255,255,0.7);","X .modebar--hover":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group:first-child":"margin-left:0px;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar-btn path":"fill:rgba(0,31,95,0.3);","X .modebar-btn.active path,X .modebar-btn:hover path":"fill:rgba(0,22,72,0.5);","X .modebar-btn.modebar-btn--logo":"padding:3px 1px;","X .modebar-btn.modebar-btn--logo path":"fill:#447adb !important;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"},t,r;for(t in i)r=t.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier"),u.addStyleRule(r,i[t])},{"../src/lib":681}],2:[function(n,t){"use strict";t.exports={undo:{width:857.1,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",ascent:850,descent:-150},home:{width:928.6,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",ascent:850,descent:-150},"camera-retro":{width:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",ascent:850,descent:-150},zoombox:{width:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",ascent:850,descent:-150},pan:{width:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",ascent:850,descent:-150},zoom_plus:{width:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",ascent:850,descent:-150},zoom_minus:{width:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",ascent:850,descent:-150},autoscale:{width:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",ascent:850,descent:-150},tooltip_basic:{width:1500,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",ascent:850,descent:-150},tooltip_compare:{width:1125,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",ascent:850,descent:-150},plotlylogo:{width:1542,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",ascent:850,descent:-150},"z-axis":{width:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",ascent:850,descent:-150},"3d_rotate":{width:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",ascent:850,descent:-150},camera:{width:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",ascent:850,descent:-150},movie:{width:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",ascent:850,descent:-150},question:{width:857.1,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",ascent:850,descent:-150},disk:{width:857.1,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",ascent:850,descent:-150},lasso:{width:1031,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",ascent:850,descent:-150},selectbox:{width:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",ascent:850,descent:-150}}},{}],3:[function(n,t){"use strict";t.exports=n("../src/traces/bar")},{"../src/traces/bar":798}],4:[function(n,t){"use strict";t.exports=n("../src/traces/box")},{"../src/traces/box":809}],5:[function(n,t){"use strict";t.exports=n("../src/traces/candlestick")},{"../src/traces/candlestick":817}],6:[function(n,t){"use strict";t.exports=n("../src/traces/choropleth")},{"../src/traces/choropleth":822}],7:[function(n,t){"use strict";t.exports=n("../src/traces/contour")},{"../src/traces/contour":829}],8:[function(n,t){"use strict";t.exports=n("../src/core")},{"../src/core":667}],9:[function(n,t){"use strict";t.exports=n("../src/transforms/filter")},{"../src/transforms/filter":951}],10:[function(n,t){"use strict";t.exports=n("../src/transforms/groupby")},{"../src/transforms/groupby":952}],11:[function(n,t){"use strict";t.exports=n("../src/traces/heatmap")},{"../src/traces/heatmap":841}],12:[function(n,t){"use strict";t.exports=n("../src/traces/histogram")},{"../src/traces/histogram":852}],13:[function(n,t){"use strict";t.exports=n("../src/traces/histogram2d")},{"../src/traces/histogram2d":857}],14:[function(n,t){"use strict";t.exports=n("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":861}],15:[function(n,t){"use strict";var i=n("./core");i.register([n("./bar"),n("./box"),n("./heatmap"),n("./histogram"),n("./histogram2d"),n("./histogram2dcontour"),n("./pie"),n("./contour"),n("./scatterternary"),n("./scatter3d"),n("./surface"),n("./mesh3d"),n("./scattergeo"),n("./choropleth"),n("./scattergl"),n("./pointcloud"),n("./scattermapbox"),n("./ohlc"),n("./candlestick")]);i.register([n("./filter"),n("./groupby")]);t.exports=i},{"./bar":3,"./box":4,"./candlestick":5,"./choropleth":6,"./contour":7,"./core":8,"./filter":9,"./groupby":10,"./heatmap":11,"./histogram":12,"./histogram2d":13,"./histogram2dcontour":14,"./mesh3d":16,"./ohlc":17,"./pie":18,"./pointcloud":19,"./scatter3d":20,"./scattergeo":21,"./scattergl":22,"./scattermapbox":23,"./scatterternary":24,"./surface":25}],16:[function(n,t){"use strict";t.exports=n("../src/traces/mesh3d")},{"../src/traces/mesh3d":865}],17:[function(n,t){"use strict";t.exports=n("../src/traces/ohlc")},{"../src/traces/ohlc":870}],18:[function(n,t){"use strict";t.exports=n("../src/traces/pie")},{"../src/traces/pie":878}],19:[function(n,t){"use strict";t.exports=n("../src/traces/pointcloud")},{"../src/traces/pointcloud":887}],20:[function(n,t){"use strict";t.exports=n("../src/traces/scatter3d")},{"../src/traces/scatter3d":917}],21:[function(n,t){"use strict";t.exports=n("../src/traces/scattergeo")},{"../src/traces/scattergeo":923}],22:[function(n,t){"use strict";t.exports=n("../src/traces/scattergl")},{"../src/traces/scattergl":928}],23:[function(n,t){"use strict";t.exports=n("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":935}],24:[function(n,t){"use strict";t.exports=n("../src/traces/scatterternary")},{"../src/traces/scatterternary":941}],25:[function(n,t){"use strict";t.exports=n("../src/traces/surface")},{"../src/traces/surface":950}],26:[function(n,t){"use strict";function r(n,t,i){return Math.min(t,Math.max(n,i))}function u(n,t,i){this.dimension=n.length;this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var r=0;r<this.dimension;++r)this.bounds[0][r]=-Infinity,this.bounds[1][r]=Infinity;this._state=n.slice().reverse();this._velocity=t.slice().reverse();this._time=[i];this._scratch=[n.slice(),n.slice(),n.slice(),n.slice(),n.slice()]}function o(n){for(var i=new Array(n),t=0;t<n;++t)i[t]=0;return i}function s(n,t,i){var r;switch(arguments.length){case 0:return new u([0],[0],0);case 1:return typeof n=="number"?(r=o(n),new u(r,r,0)):new u(n,o(n.length),0);case 2:if(typeof t=="number")return r=o(n.length),new u(n,r,+t);i=0;case 3:if(n.length!==t.length)throw new Error("state and velocity lengths must match");return new u(n,t,i)}}var e,f,i;t.exports=s;e=n("cubic-hermite");f=n("binary-search-bounds");i=u.prototype;i.flush=function(n){var t=f.gt(this._time,n)-1;t<=0||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))};i.curve=function(n){var s=this._time,k=s.length,h=f.le(s,n),o=this._scratch[0],c=this._state,v=this._velocity,u=this.dimension,d=this.bounds,i,g,tt,it,t;if(h<0)for(i=u-1,t=0;t<u;++t,--i)o[t]=c[i];else if(h>=k-1)for(i=c.length-1,g=n-s[k-1],t=0;t<u;++t,--i)o[t]=c[i]+g*v[i];else{var i=u*(h+1)-1,nt=s[h],rt=s[h+1],y=rt-nt||1,l=this._scratch[1],p=this._scratch[2],a=this._scratch[3],w=this._scratch[4],b=!0;for(t=0;t<u;++t,--i)l[t]=c[i],a[t]=v[i]*y,p[t]=c[i+u],w[t]=v[i+u]*y,b=b&&l[t]===p[t]&&a[t]===w[t]&&a[t]===0;if(b)for(t=0;t<u;++t)o[t]=l[t];else e(l,a,p,w,(n-nt)/y,o)}for(tt=d[0],it=d[1],t=0;t<u;++t)o[t]=r(tt[t],it[t],o[t]);return o};i.dcurve=function(n){var u=this._time,b=u.length,s=f.le(u,n),o=this._scratch[0],l=this._state,a=this._velocity,r=this.dimension,i,d,t;if(s>=b-1)for(i=l.length-1,d=n-u[b-1],t=0;t<r;++t,--i)o[t]=a[i];else{var i=r*(s+1)-1,k=u[s],g=u[s+1],h=g-k||1,v=this._scratch[1],y=this._scratch[2],c=this._scratch[3],p=this._scratch[4],w=!0;for(t=0;t<r;++t,--i)v[t]=l[i],c[t]=a[i]*h,y[t]=l[i+r],p[t]=a[i+r]*h,w=w&&v[t]===y[t]&&c[t]===p[t]&&c[t]===0;if(w)for(t=0;t<r;++t)o[t]=0;else for(e.derivative(v,c,y,p,(n-k)/h,o),t=0;t<r;++t)o[t]/=h}return o};i.lastT=function(){var n=this._time;return n[n.length-1]};i.stable=function(){for(var n=this._velocity,i=n.length,t=this.dimension-1;t>=0;--t)if(n[--i])return!1;return!0};i.jump=function(n){var e=this.lastT(),u=this.dimension,f,t;if(!(n<e)&&arguments.length===u+1){var i=this._state,o=this._velocity,h=i.length-this.dimension,s=this.bounds,c=s[0],l=s[1];for(this._time.push(e,n),f=0;f<2;++f)for(t=0;t<u;++t)i.push(i[h++]),o.push(0);for(this._time.push(n),t=u;t>0;--t)i.push(r(c[t-1],l[t-1],arguments[t])),o.push(0)}};i.push=function(n){var f=this.lastT(),e=this.dimension,t,u;if(!(n<f)&&arguments.length===e+1){var i=this._state,h=this._velocity,c=i.length-this.dimension,o=n-f,s=this.bounds,l=s[0],a=s[1],v=o>1e-6?1/o:0;for(this._time.push(n),t=e;t>0;--t)u=r(l[t-1],a[t-1],arguments[t]),i.push(u),h.push((u-i[c++])*v)}};i.set=function(n){var i=this.dimension,t;if(!(n<this.lastT())&&arguments.length===i+1){var f=this._state,e=this._velocity,u=this.bounds,o=u[0],s=u[1];for(this._time.push(n),t=i;t>0;--t)f.push(r(o[t-1],s[t-1],arguments[t])),e.push(0)}};i.move=function(n){var f=this.lastT(),e=this.dimension,t,u;if(!(n<=f)&&arguments.length===e+1){var i=this._state,h=this._velocity,c=i.length-this.dimension,o=this.bounds,l=o[0],a=o[1],s=n-f,v=s>1e-6?1/s:0;for(this._time.push(n),t=e;t>0;--t)u=arguments[t],i.push(r(l[t-1],a[t-1],i[c++]+u)),h.push(u*v)}};i.idle=function(n){var f=this.lastT(),t;if(!(n<f)){var e=this.dimension,i=this._state,o=this._velocity,u=i.length-e,s=this.bounds,h=s[0],c=s[1],l=n-f;for(this._time.push(n),t=e-1;t>=0;--t)i.push(r(h[t],c[t],i[u]+l*o[u])),o.push(0),u+=1}}},{"binary-search-bounds":27,"cubic-hermite":28}],27:[function(n,t){"use strict";function r(n,t,i,r,u,f){var e=["function ",n,"(a,l,h,",r.join(","),"){",f?"":"var i=",i?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",u?".get(m)":"[m]"];return f?t.indexOf("c")<0?e.push(";if(x===y){return m}else if(x<=y){"):e.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):e.push(";if(",t,"){i=m;"),i?e.push("l=m+1}else{h=m-1}"):e.push("h=m-1}else{l=m+1}"),e.push("}"),f?e.push("return -1};"):e.push("return i};"),e.join("")}function i(n,t,i,u){var f=new Function([r("A","x"+n+"y",t,["y"],!1,u),r("B","x"+n+"y",t,["y"],!0,u),r("P","c(x,y)"+n+"0",t,["y","c"],!1,u),r("Q","c(x,y)"+n+"0",t,["y","c"],!0,u),"function dispatchBsearch",i,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",i].join(""));return f()}t.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},{}],28:[function(n,t){"use strict";function i(n,t,i,r,u,f){var o=6*u*u-6*u,s=3*u*u-4*u+1,h=-6*u*u+6*u,c=3*u*u-2*u,e;if(n.length){for(f||(f=new Array(n.length)),e=n.length-1;e>=0;--e)f[e]=o*n[e]+s*t[e]+h*i[e]+c*r[e];return f}return o*n+s*t+h*i[e]+c*r}function r(n,t,i,r,u,f){var o=u-1,s=u*u,h=o*o,c=(1+2*u)*h,l=u*h,a=s*(3-2*u),v=s*o,e;if(n.length){for(f||(f=new Array(n.length)),e=n.length-1;e>=0;--e)f[e]=c*n[e]+l*t[e]+a*i[e]+v*r[e];return f}return c*n+l*t+a*i+v*r}t.exports=r;t.exports.derivative=i},{}],29:[function(n,t){function i(n,t,i){var r=t[0],u=t[1],f=t[2],e=i[0],o=i[1],s=i[2];return n[0]=u*s-f*o,n[1]=f*e-r*s,n[2]=r*o-u*e,n}t.exports=i},{}],30:[function(n,t){function i(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}t.exports=i},{}],31:[function(n,t){function i(n){var t=n[0],i=n[1],r=n[2];return Math.sqrt(t*t+i*i+r*r)}t.exports=i},{}],32:[function(n,t){function i(n,t,i,r){var u=t[0],f=t[1],e=t[2];return n[0]=u+r*(i[0]-u),n[1]=f+r*(i[1]-f),n[2]=e+r*(i[2]-e),n}t.exports=i},{}],33:[function(n,t){function i(n,t){var r=t[0],u=t[1],f=t[2],i=r*r+u*u+f*f;return i>0&&(i=1/Math.sqrt(i),n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i),n}t.exports=i},{}],34:[function(n,t){"use strict";function o(n){this._components=n.slice();this._time=[0];this.prevMatrix=n.slice();this.nextMatrix=n.slice();this.computedMatrix=n.slice();this.computedInverse=n.slice();this.computedEye=[0,0,0];this.computedUp=[0,0,0];this.computedCenter=[0,0,0];this.computedRadius=[0];this._limits=[-Infinity,Infinity]}function p(n){n=n||{};var t=n.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new o(t)}var f=n("binary-search-bounds"),s=n("mat4-interpolate"),u=n("gl-mat4/invert"),h=n("gl-mat4/rotateX"),c=n("gl-mat4/rotateY"),l=n("gl-mat4/rotateZ"),a=n("gl-mat4/lookAt"),e=n("gl-mat4/translate"),w=n("gl-mat4/scale"),v=n("gl-vec3/normalize"),y=[0,0,0],i,r;t.exports=p;i=o.prototype;i.recalcMatrix=function(n){var h=this._time,r=f.le(h,n),i=this.computedMatrix,l,a,p,e,o,c,w,d,g,t;if(!(r<0)){if(l=this._components,r===h.length-1)for(a=16*r,t=0;t<16;++t)i[t]=l[a++];else{var k=h[r+1]-h[r],a=16*r,y=this.prevMatrix,b=!0;for(t=0;t<16;++t)y[t]=l[a++];for(p=this.nextMatrix,t=0;t<16;++t)p[t]=l[a++],b=b&&y[t]===p[t];if(k<1e-6||b)for(t=0;t<16;++t)i[t]=y[t];else s(i,y,p,(n-h[r])/k)}for(e=this.computedUp,e[0]=i[1],e[1]=i[5],e[2]=i[6],v(e,e),o=this.computedInverse,u(o,i),c=this.computedEye,w=o[15],c[0]=o[12]/w,c[1]=o[13]/w,c[2]=o[14]/w,d=this.computedCenter,g=Math.exp(this.computedRadius[0]),t=0;t<3;++t)d[t]=c[t]-i[2+4*t]*g}};i.idle=function(n){var t,r,i;if(!(n<this.lastT())){for(t=this._components,r=t.length-16,i=0;i<16;++i)t.push(t[r++]);this._time.push(n)}};i.flush=function(n){var t=f.gt(this._time,n)-2;t<0||(this._time.slice(0,t),this._components.slice(0,16*t))};i.lastT=function(){return this._time[this._time.length-1]};i.lookAt=function(n,t,i,r){var u,f;for(this.recalcMatrix(n),t=t||this.computedEye,i=i||y,r=r||this.computedUp,this.setMatrix(n,a(this.computedMatrix,t,i,r)),u=0,f=0;f<3;++f)u+=Math.pow(i[f]-t[f],2);u=Math.log(Math.sqrt(u));this.computedRadius[0]=u};i.rotate=function(n,t,i,r){this.recalcMatrix(n);var f=this.computedInverse;t&&c(f,f,t);i&&h(f,f,i);r&&l(f,f,r);this.setMatrix(n,u(this.computedMatrix,f))};r=[0,0,0];i.pan=function(n,t,i,f){r[0]=-(t||0);r[1]=-(i||0);r[2]=-(f||0);this.recalcMatrix(n);var o=this.computedInverse;e(o,o,r);this.setMatrix(n,u(o,o))};i.translate=function(n,t,i,u){r[0]=t||0;r[1]=i||0;r[2]=u||0;this.recalcMatrix(n);var f=this.computedMatrix;e(f,f,r);this.setMatrix(n,f)};i.setMatrix=function(n,t){if(!(n<this.lastT())){this._time.push(n);for(var i=0;i<16;++i)this._components.push(t[i])}};i.setDistance=function(n,t){this.computedRadius[0]=t};i.setDistanceLimits=function(n,t){var i=this._limits;i[0]=n;i[1]=t};i.getDistanceLimits=function(n){var t=this._limits;return n?(n[0]=t[0],n[1]=t[1],n):t}},{"binary-search-bounds":35,"gl-mat4/invert":153,"gl-mat4/lookAt":154,"gl-mat4/rotateX":158,"gl-mat4/rotateY":159,"gl-mat4/rotateZ":160,"gl-mat4/scale":161,"gl-mat4/translate":162,"gl-vec3/normalize":33,"mat4-interpolate":36}],35:[function(n,t,i){arguments[4][27][0].apply(i,arguments)},{dup:27}],36:[function(n,t){function v(n,t,e,o){if(h(t)===0||h(e)===0)return!1;var c=s(t,i.translate,i.scale,i.skew,i.perspective,i.quaternion),v=s(e,r.translate,r.scale,r.skew,r.perspective,r.quaternion);return!c||!v?!1:(f(u.translate,i.translate,r.translate,o),f(u.skew,i.skew,r.skew,o),f(u.scale,i.scale,r.scale,o),f(u.perspective,i.perspective,r.perspective,o),a(u.quaternion,i.quaternion,r.quaternion,o),l(n,u.translate,u.scale,u.skew,u.perspective,u.quaternion),!0)}function e(){return{translate:o(),scale:o(1),skew:o(),perspective:c(),quaternion:c()}}function o(n){return[n||0,n||0,n||0]}function c(){return[0,0,0,1]}var f=n("gl-vec3/lerp"),l=n("mat4-recompose"),s=n("mat4-decompose"),h=n("gl-mat4/determinant"),a=n("quat-slerp"),i=e(),r=e(),u=e();t.exports=v},{"gl-mat4/determinant":149,"gl-vec3/lerp":32,"mat4-decompose":37,"mat4-recompose":39,"quat-slerp":40}],37:[function(n,t){function p(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3];return n[0]=i[0]*r+i[4]*u+i[8]*f+i[12]*e,n[1]=i[1]*r+i[5]*u+i[9]*f+i[13]*e,n[2]=i[2]*r+i[6]*u+i[10]*f+i[14]*e,n[3]=i[3]*r+i[7]*u+i[11]*f+i[15]*e,n}function w(n,t){n[0][0]=t[0];n[0][1]=t[1];n[0][2]=t[2];n[1][0]=t[4];n[1][1]=t[5];n[1][2]=t[6];n[2][0]=t[8];n[2][1]=t[9];n[2][2]=t[10]}function o(n,t,i,r,u){n[0]=t[0]*r+i[0]*u;n[1]=t[1]*r+i[1]*u;n[2]=t[2]*r+i[2]*u}var c=n("./normalize"),s=n("gl-mat4/create"),l=n("gl-mat4/clone"),a=n("gl-mat4/determinant"),v=n("gl-mat4/invert"),y=n("gl-mat4/transpose"),r={length:n("gl-vec3/length"),normalize:n("gl-vec3/normalize"),dot:n("gl-vec3/dot"),cross:n("gl-vec3/cross")},f=s(),u=s(),e=[0,0,0,0],i=[[0,0,0],[0,0,0],[0,0,0]],h=[0,0,0];t.exports=function(n,t,s,b,k,d){var rt,g;if((t||(t=[0,0,0]),s||(s=[0,0,0]),b||(b=[0,0,0]),k||(k=[0,0,0,1]),d||(d=[0,0,0,1]),!c(f,n))||(l(u,f),u[3]=0,u[7]=0,u[11]=0,u[15]=1,Math.abs(a(u)<1e-8)))return!1;var nt=f[3],tt=f[7],it=f[11],ut=f[12],ft=f[13],et=f[14],ot=f[15];if(nt!==0||tt!==0||it!==0){if(e[0]=nt,e[1]=tt,e[2]=it,e[3]=ot,rt=v(u,u),!rt)return!1;y(u,u);p(k,e,u)}else k[0]=k[1]=k[2]=0,k[3]=1;if(t[0]=ut,t[1]=ft,t[2]=et,w(i,f),s[0]=r.length(i[0]),r.normalize(i[0],i[0]),b[0]=r.dot(i[0],i[1]),o(i[1],i[1],i[0],1,-b[0]),s[1]=r.length(i[1]),r.normalize(i[1],i[1]),b[0]/=s[1],b[1]=r.dot(i[0],i[2]),o(i[2],i[2],i[0],1,-b[1]),b[2]=r.dot(i[1],i[2]),o(i[2],i[2],i[1],1,-b[2]),s[2]=r.length(i[2]),r.normalize(i[2],i[2]),b[1]/=s[2],b[2]/=s[2],r.cross(h,i[1],i[2]),r.dot(i[0],h)<0)for(g=0;g<3;g++)s[g]*=-1,i[g][0]*=-1,i[g][1]*=-1,i[g][2]*=-1;return d[0]=.5*Math.sqrt(Math.max(1+i[0][0]-i[1][1]-i[2][2],0)),d[1]=.5*Math.sqrt(Math.max(1-i[0][0]+i[1][1]-i[2][2],0)),d[2]=.5*Math.sqrt(Math.max(1-i[0][0]-i[1][1]+i[2][2],0)),d[3]=.5*Math.sqrt(Math.max(1+i[0][0]+i[1][1]+i[2][2],0)),i[2][1]>i[1][2]&&(d[0]=-d[0]),i[0][2]>i[2][0]&&(d[1]=-d[1]),i[1][0]>i[0][1]&&(d[2]=-d[2]),!0}},{"./normalize":38,"gl-mat4/clone":147,"gl-mat4/create":148,"gl-mat4/determinant":149,"gl-mat4/invert":153,"gl-mat4/transpose":163,"gl-vec3/cross":29,"gl-vec3/dot":30,"gl-vec3/length":31,"gl-vec3/normalize":33}],38:[function(n,t){t.exports=function(n,t){var r=t[15],u,i;if(r===0)return!1;for(u=1/r,i=0;i<16;i++)n[i]=t[i]*u;return!0}},{}],39:[function(n,t){var i={identity:n("gl-mat4/identity"),translate:n("gl-mat4/translate"),multiply:n("gl-mat4/multiply"),create:n("gl-mat4/create"),scale:n("gl-mat4/scale"),fromRotationTranslation:n("gl-mat4/fromRotationTranslation")},u=i.create(),r=i.create();t.exports=function(n,t,u,f,e,o){return i.identity(n),i.fromRotationTranslation(n,o,t),n[3]=e[0],n[7]=e[1],n[11]=e[2],n[15]=e[3],i.identity(r),f[2]!==0&&(r[9]=f[2],i.multiply(n,n,r)),f[1]!==0&&(r[9]=0,r[8]=f[1],i.multiply(n,n,r)),f[0]!==0&&(r[8]=0,r[4]=f[0],i.multiply(n,n,r)),i.scale(n,n,u),n}},{"gl-mat4/create":148,"gl-mat4/fromRotationTranslation":151,"gl-mat4/identity":152,"gl-mat4/multiply":155,"gl-mat4/scale":161,"gl-mat4/translate":162}],40:[function(n,t){t.exports=n("gl-quat/slerp")},{"gl-quat/slerp":41}],41:[function(n,t){function i(n,t,i,r){var v=t[0],y=t[1],p=t[2],w=t[3],o=i[0],s=i[1],h=i[2],c=i[3],l,u,a,f,e;return u=v*o+y*s+p*h+w*c,u<0&&(u=-u,o=-o,s=-s,h=-h,c=-c),1-u>1e-6?(l=Math.acos(u),a=Math.sin(l),f=Math.sin((1-r)*l)/a,e=Math.sin(r*l)/a):(f=1-r,e=r),n[0]=f*v+e*o,n[1]=f*y+e*s,n[2]=f*p+e*h,n[3]=f*w+e*c,n}t.exports=i},{}],42:[function(n,t){"use strict";function i(n,t,i,r,u,f,e,o,s,h){var a=t+f+h,l,c;return c>0?(c=Math.sqrt(a+1),n[0]=.5*(e-s)/c,n[1]=.5*(o-r)/c,n[2]=.5*(i-f)/c,n[3]=.5*c):(l=Math.max(t,f,h),c=Math.sqrt(2*l-a+1),t>=l?(n[0]=.5*c,n[1]=.5*(u+i)/c,n[2]=.5*(o+r)/c,n[3]=.5*(e-s)/c):f>=l?(n[0]=.5*(i+u)/c,n[1]=.5*c,n[2]=.5*(s+e)/c,n[3]=.5*(o-r)/c):(n[0]=.5*(r+o)/c,n[1]=.5*(e+s)/c,n[2]=.5*c,n[3]=.5*(i-u)/c)),n}t.exports=i},{}],43:[function(n,t){"use strict";function r(n,t,i){return Math.sqrt(Math.pow(n,2)+Math.pow(t,2)+Math.pow(i,2))}function e(n,t,i,r){return Math.sqrt(Math.pow(n,2)+Math.pow(t,2)+Math.pow(i,2)+Math.pow(r,2))}function u(n,t){var r=t[0],u=t[1],f=t[2],o=t[3],i=e(r,u,f,o);i>1e-6?(n[0]=r/i,n[1]=u/i,n[2]=f/i,n[3]=o/i):(n[0]=n[1]=n[2]=0,n[3]=1)}function s(n,t,i){this.radius=f([i]);this.center=f(t);this.rotation=f(n);this.computedRadius=this.radius.curve(0);this.computedCenter=this.center.curve(0);this.computedRotation=this.rotation.curve(0);this.computedUp=[.1,0,0];this.computedEye=[.1,0,0];this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.recalcMatrix(0)}function a(n){var i;n=n||{};var r=n.center||[0,0,0],t=n.rotation||[0,0,0,1],f=n.radius||1;return r=[].slice.call(r,0,3),t=[].slice.call(t,0,4),u(t,t),i=new s(t,r,Math.log(f)),i.setDistanceLimits(n.zoomMin,n.zoomMax),("eye"in n||"up"in n)&&i.lookAt(0,n.eye,n.center,n.up),i}var i;t.exports=a;var f=n("filtered-vector"),h=n("gl-mat4/lookAt"),c=n("gl-mat4/fromQuat"),l=n("gl-mat4/invert"),o=n("./lib/quatFromFrame");i=s.prototype;i.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())};i.recalcMatrix=function(n){var f,t,i,l,r;this.radius.curve(n);this.center.curve(n);this.rotation.curve(n);f=this.computedRotation;u(f,f);t=this.computedMatrix;c(t,f);var o=this.computedCenter,e=this.computedEye,s=this.computedUp,h=Math.exp(this.computedRadius[0]);for(e[0]=o[0]+h*t[2],e[1]=o[1]+h*t[6],e[2]=o[2]+h*t[10],s[0]=t[1],s[1]=t[5],s[2]=t[9],i=0;i<3;++i){for(l=0,r=0;r<3;++r)l+=t[i+4*r]*e[r];t[12+i]=-l}};i.getMatrix=function(n,t){var r,i;if(this.recalcMatrix(n),r=this.computedMatrix,t){for(i=0;i<16;++i)t[i]=r[i];return t}return r};i.idle=function(n){this.center.idle(n);this.radius.idle(n);this.rotation.idle(n)};i.flush=function(n){this.center.flush(n);this.radius.flush(n);this.rotation.flush(n)};i.pan=function(n,t,i,u){var p,w,b;t=t||0;i=i||0;u=u||0;this.recalcMatrix(n);var f=this.computedMatrix,e=f[1],o=f[5],s=f[9],k=r(e,o,s);e/=k;o/=k;s/=k;var h=f[0],c=f[4],l=f[8],d=h*e+c*o+l*s;h-=e*d;c-=o*d;l-=s*d;p=r(h,c,l);h/=p;c/=p;l/=p;var a=f[2],v=f[6],y=f[10],g=a*e+v*o+y*s,nt=a*h+v*c+y*l;a-=g*e+nt*h;v-=g*o+nt*c;y-=g*s+nt*l;w=r(a,v,y);a/=w;v/=w;y/=w;var tt=h*t+e*i,it=c*t+o*i,rt=l*t+s*i;this.center.move(n,tt,it,rt);b=Math.exp(this.computedRadius[0]);b=Math.max(.0001,b+u);this.radius.set(n,Math.log(b))};i.rotate=function(n,t,i,u){var tt,p;this.recalcMatrix(n);t=t||0;i=i||0;var c=this.computedMatrix,st=c[0],ht=c[4],ct=c[8],lt=c[1],at=c[5],vt=c[9],it=c[2],rt=c[6],ut=c[10],ft=t*st+i*lt,et=t*ht+i*at,ot=t*ct+i*vt,f=-(rt*ot-ut*et),o=-(ut*ft-it*ot),s=-(it*et-rt*ft),h=Math.sqrt(Math.max(0,1-Math.pow(f,2)-Math.pow(o,2)-Math.pow(s,2))),w=e(f,o,s,h);w>1e-6?(f/=w,o/=w,s/=w,h/=w):(f=o=s=0,h=1);var b=this.computedRotation,k=b[0],d=b[1],g=b[2],nt=b[3],l=k*h+nt*f+d*s-g*o,a=d*h+nt*o+g*f-k*s,v=g*h+nt*s+k*o-d*f,y=nt*h-k*f-d*o-g*s;u&&(f=it,o=rt,s=ut,tt=Math.sin(u)/r(f,o,s),f*=tt,o*=tt,s*=tt,h=Math.cos(t),l=l*h+y*f+a*s-v*o,a=a*h+y*o+v*f-l*s,v=v*h+y*s+l*o-a*f,y=y*h-l*f-a*o-v*s);p=e(l,a,v,y);p>1e-6?(l/=p,a/=p,v/=p,y/=p):(l=a=v=0,y=1);this.rotation.set(n,l,a,v,y)};i.lookAt=function(n,t,i,r){var f,e,c,s;for(this.recalcMatrix(n),i=i||this.computedCenter,t=t||this.computedEye,r=r||this.computedUp,f=this.computedMatrix,h(f,t,i,r),e=this.computedRotation,o(e,f[0],f[1],f[2],f[4],f[5],f[6],f[8],f[9],f[10]),u(e,e),this.rotation.set(n,e[0],e[1],e[2],e[3]),c=0,s=0;s<3;++s)c+=Math.pow(i[s]-t[s],2);this.radius.set(n,.5*Math.log(Math.max(c,1e-6)));this.center.set(n,i[0],i[1],i[2])};i.translate=function(n,t,i,r){this.center.move(n,t||0,i||0,r||0)};i.setMatrix=function(n,t){var r=this.computedRotation,i,f,e;if(o(r,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),u(r,r),this.rotation.set(n,r[0],r[1],r[2],r[3]),i=this.computedMatrix,l(i,t),f=i[15],Math.abs(f)>1e-6){var s=i[12]/f,h=i[13]/f,c=i[14]/f;this.recalcMatrix(n);e=Math.exp(this.computedRadius[0]);this.center.set(n,s-i[2]*e,h-i[6]*e,c-i[10]*e);this.radius.idle(n)}else this.center.idle(n),this.radius.idle(n)};i.setDistance=function(n,t){t>0&&this.radius.set(n,Math.log(t))};i.setDistanceLimits=function(n,t){n=n>0?Math.log(n):-Infinity;t=t>0?Math.log(t):Infinity;t=Math.max(t,n);this.radius.bounds[0][0]=n;this.radius.bounds[1][0]=t};i.getDistanceLimits=function(n){var t=this.radius.bounds;return n?(n[0]=Math.exp(t[0][0]),n[1]=Math.exp(t[1][0]),n):[Math.exp(t[0][0]),Math.exp(t[1][0])]};i.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}};i.fromJSON=function(n){var u=this.lastT(),i=n.center,t,r;i&&this.center.set(u,i[0],i[1],i[2]);t=n.rotation;t&&this.rotation.set(u,t[0],t[1],t[2],t[3]);r=n.distance;r&&r>0&&this.radius.set(u,Math.log(r));this.setDistanceLimits(n.zoomMin,n.zoomMax)}},{"./lib/quatFromFrame":42,"filtered-vector":26,"gl-mat4/fromQuat":150,"gl-mat4/invert":153,"gl-mat4/lookAt":154}],44:[function(n,t){"use strict";function r(n,t,i){return Math.sqrt(Math.pow(n,2)+Math.pow(t,2)+Math.pow(i,2))}function h(n){return Math.min(1,Math.max(-1,n))}function c(n){var e=Math.abs(n[0]),o=Math.abs(n[1]),s=Math.abs(n[2]),i=[0,0,0],r,u,t;for(e>Math.max(o,s)?i[2]=1:o>Math.max(e,s)?i[0]=1:i[1]=1,r=0,u=0,t=0;t<3;++t)r+=n[t]*n[t],u+=i[t]*n[t];for(t=0;t<3;++t)i[t]-=u/r*n[t];return f(i,i),i}function l(n,t,i,r,f,e,o,s){this.center=u(i);this.up=u(r);this.right=u(f);this.radius=u([e]);this.angle=u([o,s]);this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]];this.setDistanceLimits(n,t);this.computedCenter=this.center.curve(0);this.computedUp=this.up.curve(0);this.computedRight=this.right.curve(0);this.computedRadius=this.radius.curve(0);this.computedAngle=this.angle.curve(0);this.computedToward=[0,0,0];this.computedEye=[0,0,0];this.computedMatrix=new Array(16);for(var h=0;h<16;++h)this.computedMatrix[h]=.5;this.recalcMatrix(0)}function y(n){var a,u,p,w;n=n||{};var e=n.center||[0,0,0],i=n.up||[0,1,0],t=n.right||c(i),h=n.radius||1,v=n.theta||0,y=n.phi||0;return e=[].slice.call(e,0,3),i=[].slice.call(i,0,3),f(i,i),t=[].slice.call(t,0,3),f(t,t),"eye"in n&&(a=n.eye,u=[a[0]-e[0],a[1]-e[1],a[2]-e[2]],o(t,u,i),r(t[0],t[1],t[2])<1e-6?t=c(i):f(t,t),h=r(u[0],u[1],u[2]),p=s(i,u)/h,w=s(t,u)/h,y=Math.acos(p),v=Math.acos(w)),h=Math.log(h),new l(n.zoomMin,n.zoomMax,e,i,t,h,v,y)}var i,e;t.exports=y;var u=n("filtered-vector"),a=n("gl-mat4/invert"),v=n("gl-mat4/rotate"),o=n("gl-vec3/cross"),f=n("gl-vec3/normalize"),s=n("gl-vec3/dot");i=l.prototype;i.setDistanceLimits=function(n,t){n=n>0?Math.log(n):-Infinity;t=t>0?Math.log(t):Infinity;t=Math.max(t,n);this.radius.bounds[0][0]=n;this.radius.bounds[1][0]=t};i.getDistanceLimits=function(n){var t=this.radius.bounds[0];return n?(n[0]=Math.exp(t[0][0]),n[1]=Math.exp(t[1][0]),n):[Math.exp(t[0][0]),Math.exp(t[1][0])]};i.recalcMatrix=function(n){var d,g,h,ft,t,s,c;this.center.curve(n);this.up.curve(n);this.right.curve(n);this.radius.curve(n);this.angle.curve(n);var u=this.computedUp,e=this.computedRight,l=0,k=0;for(t=0;t<3;++t)k+=u[t]*e[t],l+=u[t]*u[t];for(d=Math.sqrt(l),s=0,t=0;t<3;++t)e[t]-=u[t]*k/l,s+=e[t]*e[t],u[t]/=d;for(g=Math.sqrt(s),t=0;t<3;++t)e[t]/=g;h=this.computedToward;o(h,u,e);f(h,h);var at=Math.exp(this.computedRadius[0]),nt=this.computedAngle[0],tt=this.computedAngle[1],it=Math.cos(nt),rt=Math.sin(nt),a=Math.cos(tt),v=Math.sin(tt),vt=this.computedCenter,yt=it*a,pt=rt*a,wt=v,bt=-it*v,kt=-rt*v,dt=a,ut=this.computedEye,i=this.computedMatrix;for(t=0;t<3;++t)ft=yt*e[t]+pt*h[t]+wt*u[t],i[4*t+1]=bt*e[t]+kt*h[t]+dt*u[t],i[4*t+2]=ft,i[4*t+3]=0;var et=i[1],ot=i[5],st=i[9],ht=i[2],ct=i[6],lt=i[10],y=ot*lt-st*ct,p=st*ht-et*lt,w=et*ct-ot*ht,b=r(y,p,w);for(y/=b,p/=b,w/=b,i[0]=y,i[4]=p,i[8]=w,t=0;t<3;++t)ut[t]=vt[t]+i[2+4*t]*at;for(t=0;t<3;++t){for(s=0,c=0;c<3;++c)s+=i[t+4*c]*ut[c];i[12+t]=-s}i[15]=1};i.getMatrix=function(n,t){var r,i;if(this.recalcMatrix(n),r=this.computedMatrix,t){for(i=0;i<16;++i)t[i]=r[i];return t}return r};e=[0,0,0];i.rotate=function(n,t,i,r){var f,u;if(this.angle.move(n,t,i),r){this.recalcMatrix(n);f=this.computedMatrix;e[0]=f[2];e[1]=f[6];e[2]=f[10];var o=this.computedUp,s=this.computedRight,h=this.computedToward;for(u=0;u<3;++u)f[4*u]=o[u],f[4*u+1]=s[u],f[4*u+2]=h[u];for(v(f,f,r,e),u=0;u<3;++u)o[u]=f[4*u],s[u]=f[4*u+1];this.up.set(n,o[0],o[1],o[2]);this.right.set(n,s[0],s[1],s[2])}};i.pan=function(n,t,i,u){var a,v;t=t||0;i=i||0;u=u||0;this.recalcMatrix(n);var f=this.computedMatrix,d=Math.exp(this.computedRadius[0]),e=f[1],o=f[5],s=f[9],y=r(e,o,s);e/=y;o/=y;s/=y;var h=f[0],c=f[4],l=f[8],p=h*e+c*o+l*s;h-=e*p;c-=o*p;l-=s*p;a=r(h,c,l);h/=a;c/=a;l/=a;var w=h*t+e*i,b=c*t+o*i,k=l*t+s*i;this.center.move(n,w,b,k);v=Math.exp(this.computedRadius[0]);v=Math.max(.0001,v+u);this.radius.set(n,Math.log(v))};i.translate=function(n,t,i,r){this.center.move(n,t||0,i||0,r||0)};i.setMatrix=function(n,t,i,u){var s=1,p,dt,w,b,it,rt;typeof i=="number"&&(s=i|0);(s<0||s>3)&&(s=1);p=(s+2)%3;dt=(s+1)%3;t||(this.recalcMatrix(n),t=this.computedMatrix);var f=t[s],e=t[s+4],o=t[s+8];if(u){var ht=Math.abs(f),gt=Math.abs(e),ct=Math.abs(o),lt=Math.max(ht,gt,ct);ht===lt?(f=f<0?-1:1,e=o=0):ct===lt?(o=o<0?-1:1,f=e=0):(e=e<0?-1:1,f=o=0)}else w=r(f,e,o),f/=w,e/=w,o/=w;var c=t[p],l=t[p+4],v=t[p+8],nt=c*f+l*e+v*o;c-=f*nt;l-=e*nt;v-=o*nt;b=r(c,l,v);c/=b;l/=b;v/=b;var k=e*v-o*l,d=o*c-f*v,g=f*l-e*c,tt=r(k,d,g);if(k/=tt,d/=tt,g/=tt,this.center.jump(n,wt,bt,kt),this.radius.idle(n),this.up.jump(n,f,e,o),this.right.jump(n,c,l,v),s===2){var at=t[1],vt=t[5],yt=t[9],ni=at*c+vt*l+yt*v,ti=at*k+vt*d+yt*g;it=pt<0?-Math.PI/2:Math.PI/2;rt=Math.atan2(ti,ni)}else{var ut=t[2],ft=t[6],et=t[10],pt=ut*f+ft*e+et*o,ii=ut*c+ft*l+et*v,ri=ut*k+ft*d+et*g;it=Math.asin(h(pt));rt=Math.atan2(ri,ii)}this.angle.jump(n,rt,it);this.recalcMatrix(n);var ui=t[2],fi=t[6],ei=t[10],y=this.computedMatrix;a(y,t);var ot=y[15],wt=y[12]/ot,bt=y[13]/ot,kt=y[14]/ot,st=Math.exp(this.computedRadius[0]);this.center.jump(n,wt-ui*st,bt-fi*st,kt-ei*st)};i.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())};i.idle=function(n){this.center.idle(n);this.up.idle(n);this.right.idle(n);this.radius.idle(n);this.angle.idle(n)};i.flush=function(n){this.center.flush(n);this.up.flush(n);this.right.flush(n);this.radius.flush(n);this.angle.flush(n)};i.setDistance=function(n,t){t>0&&this.radius.set(n,Math.log(t))};i.lookAt=function(n,t,i,u){var w;this.recalcMatrix(n);t=t||this.computedEye;i=i||this.computedCenter;u=u||this.computedUp;var f=u[0],e=u[1],o=u[2],k=r(f,e,o);if(!(k<1e-6)){f/=k;e/=k;o/=k;var v=t[0]-i[0],y=t[1]-i[1],p=t[2]-i[2],b=r(v,y,p);if(!(b<1e-6)){v/=b;y/=b;p/=b;var nt=this.computedRight,s=nt[0],c=nt[1],l=nt[2],tt=f*s+e*c+o*l;if(s-=tt*f,c-=tt*e,l-=tt*o,w=r(s,c,l),!(w<.01)||(s=e*p-o*y,c=o*v-f*p,l=f*y-e*v,w=r(s,c,l),!(w<1e-6))){s/=w;c/=w;l/=w;this.up.set(n,f,e,o);this.right.set(n,s,c,l);this.center.set(n,i[0],i[1],i[2]);this.radius.set(n,Math.log(b));var it=e*l-o*c,rt=o*s-f*l,ut=f*c-e*s,ft=r(it,rt,ut);it/=ft;rt/=ft;ut/=ft;var ot=f*v+e*y+o*p,st=s*v+c*y+l*p,ht=it*v+rt*y+ut*p,ct=Math.asin(h(ot)),d=Math.atan2(ht,st),g=this.angle._state,a=g[g.length-1],lt=g[g.length-2];a=a%(2*Math.PI);var at=Math.abs(a+2*Math.PI-d),et=Math.abs(a-d),vt=Math.abs(a-2*Math.PI-d);at<et&&(a+=2*Math.PI);vt<et&&(a-=2*Math.PI);this.angle.jump(this.angle.lastT(),a,lt);this.angle.set(n,d,ct)}}}}},{"filtered-vector":26,"gl-mat4/invert":153,"gl-mat4/rotate":157,"gl-vec3/cross":29,"gl-vec3/dot":30,"gl-vec3/normalize":33}],45:[function(n,t){"use strict";function r(n,t){this._controllerNames=Object.keys(n);this._controllerList=this._controllerNames.map(function(t){return n[t]});this._mode=t;this._active=n[t];this._active||(this._mode="turntable",this._active=n.turntable);this.modes=this._controllerNames;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}function s(n){n=n||{};var i=n.eye||[0,0,1],u=n.center||[0,0,0],s=n.up||[0,1,0],t=n.distanceLimits||[0,Infinity],a=n.mode||"turntable",h=f(),c=e(),l=o();return h.setDistanceLimits(t[0],t[1]),h.lookAt(0,i,u,s),c.setDistanceLimits(t[0],t[1]),c.lookAt(0,i,u,s),l.setDistanceLimits(t[0],t[1]),l.lookAt(0,i,u,s),new r({turntable:h,orbit:c,matrix:l},a)}var i,u;t.exports=s;var f=n("turntable-camera-controller"),e=n("orbit-camera-controller"),o=n("matrix-camera-controller");i=r.prototype;u=[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]];u.forEach(function(n){for(var u,f=n[0],t=[],r=0;r<n[1];++r)t.push("a"+r);u="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+n[0]+"("+t.join()+")}";i[f]=Function.apply(null,t.concat(u))});i.recalcMatrix=function(n){this._active.recalcMatrix(n)};i.getDistance=function(n){return this._active.getDistance(n)};i.getDistanceLimits=function(n){return this._active.getDistanceLimits(n)};i.lastT=function(){return this._active.lastT()};i.setMode=function(n){var t;if(n!==this._mode&&(t=this._controllerNames.indexOf(n),!(t<0))){var i=this._active,r=this._controllerList[t],u=Math.max(i.lastT(),r.lastT());i.recalcMatrix(u);r.setMatrix(u,i.computedMatrix);this._active=r;this._mode=n;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}};i.getMode=function(){return this._mode}},{"matrix-camera-controller":34,"orbit-camera-controller":43,"turntable-camera-controller":44}],46:[function(n,t){function u(n,t){return r(i(n,t))}t.exports=u;var i=n("alpha-complex"),r=n("simplicial-complex-boundary")},{"alpha-complex":47,"simplicial-complex-boundary":50}],47:[function(n,t){"use strict";function u(n,t){return i(t).filter(function(i){for(var f=new Array(i.length),u=0;u<i.length;++u)f[u]=t[i[u]];return r(f)*n<1})}t.exports=u;var i=n("delaunay-triangulate"),r=n("circumradius")},{circumradius:48,"delaunay-triangulate":130}],48:[function(n,t){function r(n){for(var e,t,u=i(n),f=0,r=0;r<n.length;++r)for(e=n[r],t=0;t<u.length;++t)f+=Math.pow(e[t]-u[t],2);return Math.sqrt(f/n.length)}t.exports=r;var i=n("circumcenter")},{circumcenter:49}],49:[function(n,t){"use strict";function r(n,t){for(var r=0,u=n.length,i=0;i<u;++i)r+=n[i]*t[i];return r}function u(n){var f=n.length,h,t,o,c,u;if(f===0)return[];var y=n[0].length,s=i([n.length+1,n.length+1],1),l=i([n.length+1],1);for(s[f][f]=0,t=0;t<f;++t){for(u=0;u<=t;++u)s[u][t]=s[t][u]=2*r(n[t],n[u]);l[t]=r(n[t],n[t])}var a=e(s,l),v=0,o=a[f+1];for(t=0;t<o.length;++t)v+=o[t];for(h=new Array(f),t=0;t<f;++t){for(o=a[t],c=0,u=0;u<o.length;++u)c+=o[u];h[t]=c/v}return h}function f(n){var t,r;if(n.length===0)return[];var f=n[0].length,e=i([f]),o=u(n);for(t=0;t<n.length;++t)for(r=0;r<f;++r)e[r]+=n[t][r]*o[t];return e}var i=n("dup"),e=n("robust-linear-solve");f.barycenetric=u;t.exports=f},{dup:131,"robust-linear-solve":528}],50:[function(n,t){"use strict";function u(n){return r(i(n))}t.exports=u;var i=n("boundary-cells"),r=n("reduce-simplicial-complex")},{"boundary-cells":51,"reduce-simplicial-complex":54}],51:[function(n,t){"use strict";function i(n){for(var f,h,e,i,u,c,r,o=n.length,s=0,t=0;t<o;++t)s+=n[t].length;for(f=new Array(s),h=0,t=0;t<o;++t)for(e=n[t],i=e.length,u=0;u<i;++u)for(c=f[h++]=new Array(i-1),r=1;r<i;++r)c[r-1]=e[(u+r)%i];return f}t.exports=i},{}],52:[function(n,t){"use strict";function i(n){for(var i,r=1,t=1;t<n.length;++t)for(i=0;i<t;++i)if(n[t]<n[i])r=-r;else if(n[i]===n[t])return 0;return r}t.exports=i},{}],53:[function(n,t){"use strict";function u(n,t){return r(n,t)||i(n)-i(t)}var r=n("compare-cell"),i=n("cell-orientation");t.exports=u},{"cell-orientation":52,"compare-cell":117}],54:[function(n,t){"use strict";function f(n){var h,t,f,e,o,s;for(n.sort(u),h=n.length,t=0,f=0;f<h;++f)if(e=n[f],o=i(e),o!==0){if(t>0&&(s=n[t-1],r(e,s)===0&&i(s)!==o)){t-=1;continue}n[t++]=e}return n.length=t,n}var r=n("compare-cell"),u=n("compare-oriented-cell"),i=n("cell-orientation");t.exports=f},{"cell-orientation":52,"compare-cell":117,"compare-oriented-cell":53}],55:[function(n,t){"use strict";var i=function(){function r(n){return!Array.isArray(n)&&n!==null&&typeof n=="object"}function u(n,t,i){for(var f=(t-n)/Math.max(i-1,1),u=[],r=0;r<i;r++)u.push(n+r*f);return u}function f(){for(var t,i=[].slice.call(arguments),u=i.map(function(n){return n.length}),f=Math.min.apply(null,u),r=[],n=0;n<f;n++)for(r[n]=[],t=0;t<i.length;++t)r[n][t]=i[t][n];return r}function e(n,t,i){for(var f=Math.min.apply(null,[n.length,t.length,i.length]),u=[],r=0;r<f;r++)u.push([n[r],t[r],i[r]]);return u}function o(n){function i(n){for(var r=0;r<n.length;r++)Array.isArray(n[r])?i(n[r],t):t+=n[r]}var t=0;return i(n,t),t}function s(n){for(var i,r=[],t=0;t<n.length;++t)for(r[t]=[],i=0;i<n[t].length;++i)r[t][i]=n[t][i];return r}function h(n){for(var i=[],t=0;t<n.length;++t)i[t]=n[t];return i}function c(n,t){if(n.length!==t.length)return!1;for(var i=n.length;i--;)if(n[i]!==t[i])return!1;return!0}function l(n,r){var u,f,e;if(typeof n!="string")return n;if(u=[],n[0]==="#"?(n=n.substr(1),n.length===3&&(n+=n),f=parseInt(n,16),u[0]=f>>16&255,u[1]=f>>8&255,u[2]=f&255):t.test(n)&&(f=n.match(i),u[0]=parseInt(f[1]),u[1]=parseInt(f[2]),u[2]=parseInt(f[3])),!r)for(e=0;e<3;++e)u[e]=u[e]/255;return u}function a(n,r){var u,f,e;if(typeof n!="string")return n;if(u=[],n[0]==="#"?(n=n.substr(1),n.length===3&&(n+=n),f=parseInt(n,16),u[0]=f>>16&255,u[1]=f>>8&255,u[2]=f&255):t.test(n)&&(f=n.match(i),u[0]=parseInt(f[1]),u[1]=parseInt(f[2]),u[2]=parseInt(f[3]),u[3]=f[4]?parseFloat(f[4]):1),!r)for(e=0;e<3;++e)u[e]=u[e]/255;return u}var n={},t=/^rgba?\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*(,.*)?\)$/,i=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,?\s*(.*)?\)$/;return n.isPlainObject=r,n.linspace=u,n.zip3=e,n.sum=o,n.zip=f,n.isEqual=c,n.copy2D=s,n.copy1D=h,n.str2RgbArray=l,n.str2RgbaArray=a,n};t.exports=i()},{}],56:[function(n,t,i){"use strict";"use restrict";function f(n){var t=32;return n&=-n,n&&t--,n&65535&&(t-=16),n&16711935&&(t-=8),n&252645135&&(t-=4),n&858993459&&(t-=2),n&1431655765&&(t-=1),t}var u=32,r;i.INT_BITS=u;i.INT_MAX=2147483647;i.INT_MIN=-1<<u-1;i.sign=function(n){return(n>0)-(n<0)};i.abs=function(n){var t=n>>u-1;return(n^t)-t};i.min=function(n,t){return t^(n^t)&-(n<t)};i.max=function(n,t){return n^(n^t)&-(n<t)};i.isPow2=function(n){return!(n&n-1)&&!!n};i.log2=function(n){var i,t;return i=(n>65535)<<4,n>>>=i,t=(n>255)<<3,n>>>=t,i|=t,t=(n>15)<<2,n>>>=t,i|=t,t=(n>3)<<1,n>>>=t,i|=t,i|n>>1};i.log10=function(n){return n>=1e9?9:n>=1e8?8:n>=1e7?7:n>=1e6?6:n>=1e5?5:n>=1e4?4:n>=1e3?3:n>=100?2:n>=10?1:0};i.popCount=function(n){return n=n-(n>>>1&1431655765),n=(n&858993459)+(n>>>2&858993459),(n+(n>>>4)&252645135)*16843009>>>24};i.countTrailingZeros=f;i.nextPow2=function(n){return n+=n===0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1};i.prevPow2=function(n){return n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n-(n>>>1)};i.parity=function(n){return n^=n>>>16,n^=n>>>8,n^=n>>>4,n&=15,27030>>>n&1};r=new Array(256),function(n){for(var t=0;t<256;++t){var i=t,r=t,u=7;for(i>>>=1;i;i>>>=1)r<<=1,r|=i&1,--u;n[t]=r<<u&255}}(r);i.reverse=function(n){return r[n&255]<<24|r[n>>>8&255]<<16|r[n>>>16&255]<<8|r[n>>>24&255]};i.interleave2=function(n,t){return n&=65535,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1};i.deinterleave2=function(n,t){return n=n>>>t&1431655765,n=(n|n>>>1)&858993459,n=(n|n>>>2)&252645135,n=(n|n>>>4)&16711935,n=(n|n>>>16)&65535,n<<16>>16};i.interleave3=function(n,t,i){return n&=1023,n=(n|n<<16)&4278190335,n=(n|n<<8)&251719695,n=(n|n<<4)&3272356035,n=(n|n<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,n|=t<<1,i&=1023,i=(i|i<<16)&4278190335,i=(i|i<<8)&251719695,i=(i|i<<4)&3272356035,i=(i|i<<2)&1227133513,n|i<<2};i.deinterleave3=function(n,t){return n=n>>>t&1227133513,n=(n|n>>>2)&3272356035,n=(n|n>>>4)&251719695,n=(n|n>>>8)&4278190335,n=(n|n>>>16)&1023,n<<22>>22};i.nextCombination=function(n){var t=n|n-1;return t+1|(~t&-~t)-1>>>f(n)+1}},{}],57:[function(n,t,i){(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function ot(){try{var n=new Uint8Array(1);return n.foo=function(){return 42},n.foo()===42&&typeof n.subarray=="function"&&n.subarray(1,1).byteLength===0}catch(t){return!1}}function k(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(n){return(this instanceof r)?(r.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=undefined),typeof n=="number")?st(this,n):typeof n=="string"?ht(this,n,arguments.length>1?arguments[1]:"utf8"):ct(this,n):arguments.length>1?new r(n,arguments[1]):new r(n)}function st(n,t){if(n=e(n,t<0?0:s(t)|0),!r.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;i++)n[i]=0;return n}function ht(n,t,i){(typeof i!="string"||i==="")&&(i="utf8");var r=g(t,i)|0;return n=e(n,r),n.write(t,i),n}function ct(n,t){if(r.isBuffer(t))return lt(n,t);if(y(t))return at(n,t);if(t==null)throw new TypeError("must start with number, buffer, array or string");if(typeof ArrayBuffer!="undefined"){if(t.buffer instanceof ArrayBuffer)return d(n,t);if(t instanceof ArrayBuffer)return vt(n,t)}return t.length?yt(n,t):pt(n,t)}function lt(n,t){var i=s(t.length)|0;return n=e(n,i),t.copy(n,0,0,i),n}function at(n,t){var r=s(t.length)|0,i;for(n=e(n,r),i=0;i<r;i+=1)n[i]=t[i]&255;return n}function d(n,t){var r=s(t.length)|0,i;for(n=e(n,r),i=0;i<r;i+=1)n[i]=t[i]&255;return n}function vt(n,t){return t.byteLength,r.TYPED_ARRAY_SUPPORT?(n=new Uint8Array(t),n.__proto__=r.prototype):n=d(n,new Uint8Array(t)),n}function yt(n,t){var r=s(t.length)|0,i;for(n=e(n,r),i=0;i<r;i+=1)n[i]=t[i]&255;return n}function pt(n,t){var r,u=0,i;for(t.type==="Buffer"&&y(t.data)&&(r=t.data,u=s(r.length)|0),n=e(n,u),i=0;i<u;i+=1)n[i]=r[i]&255;return n}function e(n,t){r.TYPED_ARRAY_SUPPORT?(n=new Uint8Array(t),n.__proto__=r.prototype):n.length=t;var i=t!==0&&t<=r.poolSize>>>1;return i&&(n.parent=b),n}function s(n){if(n>=k())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+k().toString(16)+" bytes");return n|0}function p(n,t){if(!(this instanceof p))return new p(n,t);var i=new r(n,t);return delete i.parent,i}function g(n,t){var i,r;if(typeof n!="string"&&(n=""+n),i=n.length,i===0)return 0;for(r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return i;case"utf8":case"utf-8":return l(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return et(n).length;default:if(r)return l(n).length;t=(""+t).toLowerCase();r=!0}}function wt(n,t,i){var r=!1;if(t=t|0,i=i===undefined||i===Infinity?this.length:i|0,n||(n="utf8"),t<0&&(t=0),i>this.length&&(i=this.length),i<=t)return"";for(;;)switch(n){case"hex":return fi(this,t,i);case"utf8":case"utf-8":return tt(this,t,i);case"ascii":return ri(this,t,i);case"binary":return ui(this,t,i);case"base64":return ti(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ei(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase();r=!0}}function bt(n,t,i,r){var f,e,u,o;if(i=Number(i)||0,f=n.length-i,r?(r=Number(r),r>f&&(r=f)):r=f,e=t.length,e%2!=0)throw new Error("Invalid hex string");for(r>e/2&&(r=e/2),u=0;u<r;u++){if(o=parseInt(t.substr(u*2,2),16),isNaN(o))throw new Error("Invalid hex string");n[i+u]=o}return u}function kt(n,t,i,r){return a(l(t,n.length-i),n,i,r)}function nt(n,t,i,r){return a(ci(t),n,i,r)}function dt(n,t,i,r){return nt(n,t,i,r)}function gt(n,t,i,r){return a(et(t),n,i,r)}function ni(n,t,i,r){return a(li(t,n.length-i),n,i,r)}function ti(n,t,i){return t===0&&i===n.length?v.fromByteArray(n):v.fromByteArray(n.slice(t,i))}function tt(n,t,i){var h,f,e,s,l,u;for(i=Math.min(n.length,i),h=[],f=t;f<i;){var o=n[f],r=null,c=o>239?4:o>223?3:o>191?2:1;if(f+c<=i)switch(c){case 1:o<128&&(r=o);break;case 2:e=n[f+1];(e&192)==128&&(u=(o&31)<<6|e&63,u>127&&(r=u));break;case 3:e=n[f+1];s=n[f+2];(e&192)==128&&(s&192)==128&&(u=(o&15)<<12|(e&63)<<6|s&63,u>2047&&(u<55296||u>57343)&&(r=u));break;case 4:e=n[f+1];s=n[f+2];l=n[f+3];(e&192)==128&&(s&192)==128&&(l&192)==128&&(u=(o&15)<<18|(e&63)<<12|(s&63)<<6|l&63,u>65535&&u<1114112&&(r=u))}r===null?(r=65533,c=1):r>65535&&(r-=65536,h.push(r>>>10&1023|55296),r=56320|r&1023);h.push(r);f+=c}return ii(h)}function ii(n){var r=n.length,i,t;if(r<=w)return String.fromCharCode.apply(String,n);for(i="",t=0;t<r;)i+=String.fromCharCode.apply(String,n.slice(t,t+=w));return i}function ri(n,t,i){var u="",r;for(i=Math.min(n.length,i),r=t;r<i;r++)u+=String.fromCharCode(n[r]&127);return u}function ui(n,t,i){var u="",r;for(i=Math.min(n.length,i),r=t;r<i;r++)u+=String.fromCharCode(n[r]);return u}function fi(n,t,i){var f=n.length,u,r;for((!t||t<0)&&(t=0),(!i||i<0||i>f)&&(i=f),u="",r=t;r<i;r++)u+=hi(n[r]);return u}function ei(n,t,i){for(var u=n.slice(t,i),f="",r=0;r<u.length;r+=2)f+=String.fromCharCode(u[r]+u[r+1]*256);return f}function u(n,t,i){if(n%1!=0||n<0)throw new RangeError("offset is not uint");if(n+t>i)throw new RangeError("Trying to access beyond buffer length");}function f(n,t,i,u,f,e){if(!r.isBuffer(n))throw new TypeError("buffer must be a Buffer instance");if(t>f||t<e)throw new RangeError("value is out of bounds");if(i+u>n.length)throw new RangeError("index out of range");}function h(n,t,i,r){t<0&&(t=65535+t+1);for(var u=0,f=Math.min(n.length-i,2);u<f;u++)n[i+u]=(t&255<<8*(r?u:1-u))>>>(r?u:1-u)*8}function c(n,t,i,r){t<0&&(t=4294967295+t+1);for(var u=0,f=Math.min(n.length-i,4);u<f;u++)n[i+u]=t>>>(r?u:3-u)*8&255}function it(n,t,i,r){if(i+r>n.length)throw new RangeError("index out of range");if(i<0)throw new RangeError("index out of range");}function rt(n,t,i,r,u){return u||it(n,t,i,4,34028234663852886e22,-34028234663852886e22),o.write(n,t,i,r,23,4),i+4}function ut(n,t,i,r,u){return u||it(n,t,i,8,17976931348623157e292,-17976931348623157e292),o.write(n,t,i,r,52,8),i+8}function oi(n){if(n=si(n).replace(ft,""),n.length<2)return"";while(n.length%4!=0)n=n+"=";return n}function si(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function hi(n){return n<16?"0"+n.toString(16):n.toString(16)}function l(n,t){var f;t=t||Infinity;var i,e=n.length,u=null,r=[];for(f=0;f<e;f++){if(i=n.charCodeAt(f),i>55295&&i<57344){if(!u){if(i>56319){(t-=3)>-1&&r.push(239,191,189);continue}else if(f+1===e){(t-=3)>-1&&r.push(239,191,189);continue}u=i;continue}if(i<56320){(t-=3)>-1&&r.push(239,191,189);u=i;continue}i=(u-55296<<10|i-56320)+65536}else u&&(t-=3)>-1&&r.push(239,191,189);if(u=null,i<128){if((t-=1)<0)break;r.push(i)}else if(i<2048){if((t-=2)<0)break;r.push(i>>6|192,i&63|128)}else if(i<65536){if((t-=3)<0)break;r.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((t-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point");}return r}function ci(n){for(var i=[],t=0;t<n.length;t++)i.push(n.charCodeAt(t)&255);return i}function li(n,t){for(var i,f,e,r=[],u=0;u<n.length;u++){if((t-=2)<0)break;i=n.charCodeAt(u);f=i>>8;e=i%256;r.push(e);r.push(f)}return r}function et(n){return v.toByteArray(oi(n))}function a(n,t,i,r){for(var u=0;u<r;u++){if(u+i>=t.length||u>=n.length)break;t[u+i]=n[u]}return u}var b,w,ft;"use strict";var v=n("base64-js"),o=n("ieee754"),y=n("isarray");i.Buffer=r;i.SlowBuffer=p;i.INSPECT_MAX_BYTES=50;r.poolSize=8192;b={};r.TYPED_ARRAY_SUPPORT=t.TYPED_ARRAY_SUPPORT!==undefined?t.TYPED_ARRAY_SUPPORT:ot();r._augment=function(n){return n.__proto__=r.prototype,n};r.TYPED_ARRAY_SUPPORT?(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})):(r.prototype.length=undefined,r.prototype.parent=undefined);r.isBuffer=function(n){return!!(n!=null&&n._isBuffer)};r.compare=function(n,t){if(!r.isBuffer(n)||!r.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(n===t)return 0;for(var u=n.length,f=t.length,i=0,e=Math.min(u,f);i<e;){if(n[i]!==t[i])break;++i}return(i!==e&&(u=n[i],f=t[i]),u<f)?-1:f<u?1:0};r.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};r.concat=function(n,t){var i,u,f,e;if(!y(n))throw new TypeError("list argument must be an Array of Buffers.");if(n.length===0)return new r(0);if(t===undefined)for(t=0,i=0;i<n.length;i++)t+=n[i].length;for(u=new r(t),f=0,i=0;i<n.length;i++)e=n[i],e.copy(u,f),f+=e.length;return u};r.byteLength=g;r.prototype._isBuffer=!0;r.prototype.toString=function(){var n=this.length|0;return n===0?"":arguments.length===0?tt(this,0,n):wt.apply(this,arguments)};r.prototype.equals=function(n){if(!r.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:r.compare(this,n)===0};r.prototype.inspect=function(){var n="",t=i.INSPECT_MAX_BYTES;return this.length>0&&(n=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(n+=" ... ")),"<Buffer "+n+">"};r.prototype.compare=function(n){if(!r.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?0:r.compare(this,n)};r.prototype.indexOf=function(n,t){function i(n,t,i){for(var r=-1,u=0;i+u<n.length;u++)if(n[i+u]===t[r===-1?0:u-r]){if(r===-1&&(r=u),u-r+1===t.length)return i+r}else r=-1;return-1}if((t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t>>=0,this.length===0)||t>=this.length)return-1;if(t<0&&(t=Math.max(this.length+t,0)),typeof n=="string")return n.length===0?-1:String.prototype.indexOf.call(this,n,t);if(r.isBuffer(n))return i(this,n,t);if(typeof n=="number")return r.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"?Uint8Array.prototype.indexOf.call(this,n,t):i(this,[n],t);throw new TypeError("val must be string, number or Buffer");};r.prototype.write=function(n,t,i,r){var e,u,f;if(t===undefined?(r="utf8",i=this.length,t=0):i===undefined&&typeof t=="string"?(r=t,i=this.length,t=0):isFinite(t)?(t=t|0,isFinite(i)?(i=i|0,r===undefined&&(r="utf8")):(r=i,i=undefined)):(e=r,r=t,t=i|0,i=e),u=this.length-t,(i===undefined||i>u)&&(i=u),n.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");for(r||(r="utf8"),f=!1;;)switch(r){case"hex":return bt(this,n,t,i);case"utf8":case"utf-8":return kt(this,n,t,i);case"ascii":return nt(this,n,t,i);case"binary":return dt(this,n,t,i);case"base64":return gt(this,n,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ni(this,n,t,i);default:if(f)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase();f=!0}};r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};w=4096;r.prototype.slice=function(n,t){var i=this.length,u,e,f;if(n=~~n,t=t===undefined?i:~~t,n<0?(n+=i,n<0&&(n=0)):n>i&&(n=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<n&&(t=n),r.TYPED_ARRAY_SUPPORT)u=this.subarray(n,t),u.__proto__=r.prototype;else for(e=t-n,u=new r(e,undefined),f=0;f<e;f++)u[f]=this[f+n];return u.length&&(u.parent=this.parent||this),u};r.prototype.readUIntLE=function(n,t,i){n=n|0;t=t|0;i||u(n,t,this.length);for(var r=this[n],f=1,e=0;++e<t&&(f*=256);)r+=this[n+e]*f;return r};r.prototype.readUIntBE=function(n,t,i){n=n|0;t=t|0;i||u(n,t,this.length);for(var r=this[n+--t],f=1;t>0&&(f*=256);)r+=this[n+--t]*f;return r};r.prototype.readUInt8=function(n,t){return t||u(n,1,this.length),this[n]};r.prototype.readUInt16LE=function(n,t){return t||u(n,2,this.length),this[n]|this[n+1]<<8};r.prototype.readUInt16BE=function(n,t){return t||u(n,2,this.length),this[n]<<8|this[n+1]};r.prototype.readUInt32LE=function(n,t){return t||u(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216};r.prototype.readUInt32BE=function(n,t){return t||u(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])};r.prototype.readIntLE=function(n,t,i){n=n|0;t=t|0;i||u(n,t,this.length);for(var r=this[n],f=1,e=0;++e<t&&(f*=256);)r+=this[n+e]*f;return f*=128,r>=f&&(r-=Math.pow(2,8*t)),r};r.prototype.readIntBE=function(n,t,i){n=n|0;t=t|0;i||u(n,t,this.length);for(var e=t,r=1,f=this[n+--e];e>0&&(r*=256);)f+=this[n+--e]*r;return r*=128,f>=r&&(f-=Math.pow(2,8*t)),f};r.prototype.readInt8=function(n,t){return(t||u(n,1,this.length),!(this[n]&128))?this[n]:(256-this[n])*-1};r.prototype.readInt16LE=function(n,t){t||u(n,2,this.length);var i=this[n]|this[n+1]<<8;return i&32768?i|4294901760:i};r.prototype.readInt16BE=function(n,t){t||u(n,2,this.length);var i=this[n+1]|this[n]<<8;return i&32768?i|4294901760:i};r.prototype.readInt32LE=function(n,t){return t||u(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24};r.prototype.readInt32BE=function(n,t){return t||u(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]};r.prototype.readFloatLE=function(n,t){return t||u(n,4,this.length),o.read(this,n,!0,23,4)};r.prototype.readFloatBE=function(n,t){return t||u(n,4,this.length),o.read(this,n,!1,23,4)};r.prototype.readDoubleLE=function(n,t){return t||u(n,8,this.length),o.read(this,n,!0,52,8)};r.prototype.readDoubleBE=function(n,t){return t||u(n,8,this.length),o.read(this,n,!1,52,8)};r.prototype.writeUIntLE=function(n,t,i,r){n=+n;t=t|0;i=i|0;r||f(this,n,t,i,Math.pow(2,8*i),0);var u=1,e=0;for(this[t]=n&255;++e<i&&(u*=256);)this[t+e]=n/u&255;return t+i};r.prototype.writeUIntBE=function(n,t,i,r){n=+n;t=t|0;i=i|0;r||f(this,n,t,i,Math.pow(2,8*i),0);var u=i-1,e=1;for(this[t+u]=n&255;--u>=0&&(e*=256);)this[t+u]=n/e&255;return t+i};r.prototype.writeUInt8=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,1,255,0),r.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),this[t]=n&255,t+1};r.prototype.writeUInt16LE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n&255,this[t+1]=n>>>8):h(this,n,t,!0),t+2};r.prototype.writeUInt16BE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>8,this[t+1]=n&255):h(this,n,t,!1),t+2};r.prototype.writeUInt32LE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t+3]=n>>>24,this[t+2]=n>>>16,this[t+1]=n>>>8,this[t]=n&255):c(this,n,t,!0),t+4};r.prototype.writeUInt32BE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>24,this[t+1]=n>>>16,this[t+2]=n>>>8,this[t+3]=n&255):c(this,n,t,!1),t+4};r.prototype.writeIntLE=function(n,t,i,r){var u;n=+n;t=t|0;r||(u=Math.pow(2,8*i-1),f(this,n,t,i,u-1,-u));var e=0,o=1,s=n<0?1:0;for(this[t]=n&255;++e<i&&(o*=256);)this[t+e]=(n/o>>0)-s&255;return t+i};r.prototype.writeIntBE=function(n,t,i,r){var u;n=+n;t=t|0;r||(u=Math.pow(2,8*i-1),f(this,n,t,i,u-1,-u));var e=i-1,o=1,s=n<0?1:0;for(this[t+e]=n&255;--e>=0&&(o*=256);)this[t+e]=(n/o>>0)-s&255;return t+i};r.prototype.writeInt8=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,1,127,-128),r.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),n<0&&(n=255+n+1),this[t]=n&255,t+1};r.prototype.writeInt16LE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=n&255,this[t+1]=n>>>8):h(this,n,t,!0),t+2};r.prototype.writeInt16BE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>8,this[t+1]=n&255):h(this,n,t,!1),t+2};r.prototype.writeInt32LE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[t]=n&255,this[t+1]=n>>>8,this[t+2]=n>>>16,this[t+3]=n>>>24):c(this,n,t,!0),t+4};r.prototype.writeInt32BE=function(n,t,i){return n=+n,t=t|0,i||f(this,n,t,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),r.TYPED_ARRAY_SUPPORT?(this[t]=n>>>24,this[t+1]=n>>>16,this[t+2]=n>>>8,this[t+3]=n&255):c(this,n,t,!1),t+4};r.prototype.writeFloatLE=function(n,t,i){return rt(this,n,t,!0,i)};r.prototype.writeFloatBE=function(n,t,i){return rt(this,n,t,!1,i)};r.prototype.writeDoubleLE=function(n,t,i){return ut(this,n,t,!0,i)};r.prototype.writeDoubleBE=function(n,t,i){return ut(this,n,t,!1,i)};r.prototype.copy=function(n,t,i,u){if((i||(i=0),u||u===0||(u=this.length),t>=n.length&&(t=n.length),t||(t=0),u>0&&u<i&&(u=i),u===i)||n.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(u<0)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length);n.length-t<u-i&&(u=n.length-t+i);var e=u-i,f;if(this===n&&i<t&&t<u)for(f=e-1;f>=0;f--)n[f+t]=this[f+i];else if(e<1e3||!r.TYPED_ARRAY_SUPPORT)for(f=0;f<e;f++)n[f+t]=this[f+i];else Uint8Array.prototype.set.call(n,this.subarray(i,i+e),t);return e};r.prototype.fill=function(n,t,i){var r,u,f;if(n||(n=0),t||(t=0),i||(i=this.length),i<t)throw new RangeError("end < start");if(i!==t&&this.length!==0){if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(i<0||i>this.length)throw new RangeError("end out of bounds");if(typeof n=="number")for(r=t;r<i;r++)this[r]=n;else for(u=l(n.toString()),f=u.length,r=t;r<i;r++)this[r]=u[r%f];return this}};ft=/[^+\/0-9A-Za-z-_]/g}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"base64-js":58,ieee754:59,isarray:60}],58:[function(n,t,i){"use strict";function e(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=t.length,n=0;n<i;n++)u[n]=t[n];for(n=0;n<i;++n)r[t.charCodeAt(n)]=n;r["-".charCodeAt(0)]=62;r["_".charCodeAt(0)]=63}function o(n){var t,h,c,i,s,u,o=n.length,e;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");for(s=n[o-2]==="="?2:n[o-1]==="="?1:0,u=new f(o*3/4-s),c=s>0?o-4:o,e=0,t=0,h=0;t<c;t+=4,h+=3)i=r[n.charCodeAt(t)]<<18|r[n.charCodeAt(t+1)]<<12|r[n.charCodeAt(t+2)]<<6|r[n.charCodeAt(t+3)],u[e++]=(i&16711680)>>16,u[e++]=(i&65280)>>8,u[e++]=i&255;return s===2?(i=r[n.charCodeAt(t)]<<2|r[n.charCodeAt(t+1)]>>4,u[e++]=i&255):s===1&&(i=r[n.charCodeAt(t)]<<10|r[n.charCodeAt(t+1)]<<4|r[n.charCodeAt(t+2)]>>2,u[e++]=i>>8&255,u[e++]=i&255),u}function s(n){return u[n>>18&63]+u[n>>12&63]+u[n>>6&63]+u[n&63]}function h(n,t,i){for(var u,f=[],r=t;r<i;r+=3)u=(n[r]<<16)+(n[r+1]<<8)+n[r+2],f.push(s(u));return f.join("")}function c(n){for(var i,r=n.length,e=r%3,t="",o=[],s=16383,f=0,c=r-e;f<c;f+=s)o.push(h(n,f,f+s>c?c:f+s));return e===1?(i=n[r-1],t+=u[i>>2],t+=u[i<<4&63],t+="=="):e===2&&(i=(n[r-2]<<8)+n[r-1],t+=u[i>>10],t+=u[i>>4&63],t+=u[i<<2&63],t+="="),o.push(t),o.join("")}i.toByteArray=o;i.fromByteArray=c;var u=[],r=[],f=typeof Uint8Array!="undefined"?Uint8Array:Array;e()},{}],59:[function(n,t,i){i.read=function(n,t,i,r,u){var f,o,l=u*8-r-1,a=(1<<l)-1,v=a>>1,e=-7,s=i?u-1:0,c=i?-1:1,h=n[t+s];for(s+=c,f=h&(1<<-e)-1,h>>=-e,e+=l;e>0;f=f*256+n[t+s],s+=c,e-=8);for(o=f&(1<<-e)-1,f>>=-e,e+=r;e>0;o=o*256+n[t+s],s+=c,e-=8);if(f===0)f=1-v;else{if(f===a)return o?NaN:(h?-1:1)*Infinity;o=o+Math.pow(2,r);f=f-v}return(h?-1:1)*o*Math.pow(2,f-r)};i.write=function(n,t,i,r,u,f){var e,o,s,l=f*8-u-1,a=(1<<l)-1,h=a>>1,y=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=r?0:f-1,v=r?1:-1,p=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===Infinity?(o=isNaN(t)?1:0,e=a):(e=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-e))<1&&(e--,s*=2),t+=e+h>=1?y/s:y*Math.pow(2,1-h),t*s>=2&&(e++,s/=2),e+h>=a?(o=0,e=a):e+h>=1?(o=(t*s-1)*Math.pow(2,u),e=e+h):(o=t*Math.pow(2,h-1)*Math.pow(2,u),e=0));u>=8;n[i+c]=o&255,c+=v,o/=256,u-=8);for(e=e<<u|o,l+=u;l>0;n[i+c]=e&255,c+=v,e/=256,l-=8);n[i+c-v]|=p*128}},{}],60:[function(n,t){var i={}.toString;t.exports=Array.isArray||function(n){return i.call(n)=="[object Array]"}},{}],61:[function(n,t){function i(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}function r(n){return typeof n=="function"}function e(n){return typeof n=="number"}function u(n){return typeof n=="object"&&n!==null}function f(n){return n===void 0}t.exports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(n){if(!e(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this};i.prototype.emit=function(n){var o,t,h,i,e,s;if(this._events||(this._events={}),n==="error"&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if(o=arguments[1],o instanceof Error)throw o;throw TypeError('Uncaught, unspecified "error" event.');}if(t=this._events[n],f(t))return!1;if(r(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1);t.apply(this,i)}else if(u(t))for(i=Array.prototype.slice.call(arguments,1),s=t.slice(),h=s.length,e=0;e<h;e++)s[e].apply(this,i);return!0};i.prototype.addListener=function(n,t){var e;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,r(t.listener)?t.listener:t),this._events[n]?u(this._events[n])?this._events[n].push(t):this._events[n]=[this._events[n],t]:this._events[n]=t,u(this._events[n])&&!this._events[n].warned&&(e=f(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[n].length>e&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),typeof console.trace=="function"&&console.trace())),this};i.prototype.on=i.prototype.addListener;i.prototype.once=function(n,t){function i(){this.removeListener(n,i);u||(u=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var u=!1;i.listener=t;this.on(n,i);return this};i.prototype.removeListener=function(n,t){var i,e,o,f;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;if(i=this._events[n],o=i.length,e=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,t);else if(u(i)){for(f=o;f-->0;)if(i[f]===t||i[f].listener&&i[f].listener===t){e=f;break}if(e<0)return this;i.length===1?(i.length=0,delete this._events[n]):i.splice(e,1);this._events.removeListener&&this.emit("removeListener",n,t)}return this};i.prototype.removeAllListeners=function(n){var i,t;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[n]&&delete this._events[n],this;if(arguments.length===0){for(i in this._events)i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[n],r(t))this.removeListener(n,t);else if(t)while(t.length)this.removeListener(n,t[t.length-1]);return delete this._events[n],this};i.prototype.listeners=function(n){return this._events&&this._events[n]?r(this._events[n])?[this._events[n]]:this._events[n].slice():[]};i.prototype.listenerCount=function(n){if(this._events){var t=this._events[n];if(r(t))return 1;if(t)return t.length}return 0};i.listenerCount=function(n,t){return n.listenerCount(t)}},{}],62:[function(n,t){t.exports=typeof Object.create=="function"?function(n,t){n.super_=t;n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}:function(n,t){n.super_=t;var i=function(){};i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n}},{}],63:[function(n,t,i){(function(n){function u(n,t){for(var u,r=0,i=n.length-1;i>=0;i--)u=n[i],u==="."?n.splice(i,1):u===".."?(n.splice(i,1),r++):r&&(n.splice(i,1),r--);if(t)for(;r--;r)n.unshift("..");return n}function r(n,t){var r,i;if(n.filter)return n.filter(t);for(r=[],i=0;i<n.length;i++)t(n[i],i,n)&&r.push(n[i]);return r}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,t=function(n){return e.exec(n).slice(1)},f;i.resolve=function(){for(var i,t="",f=!1,e=arguments.length-1;e>=-1&&!f;e--){if(i=e>=0?arguments[e]:n.cwd(),typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");else if(!i)continue;t=i+"/"+t;f=i.charAt(0)==="/"}return t=u(r(t.split("/"),function(n){return!!n}),!f).join("/"),(f?"/":"")+t||"."};i.normalize=function(n){var t=i.isAbsolute(n),e=f(n,-1)==="/";return n=u(r(n.split("/"),function(n){return!!n}),!t).join("/"),n||t||(n="."),n&&e&&(n+="/"),(t?"/":"")+n};i.isAbsolute=function(n){return n.charAt(0)==="/"};i.join=function(){var n=Array.prototype.slice.call(arguments,0);return i.normalize(r(n,function(n){if(typeof n!="string")throw new TypeError("Arguments to path.join must be strings");return n}).join("/"))};i.relative=function(n,t){function s(n){for(var t=0,i;t<n.length;t++)if(n[t]!=="")break;for(i=n.length-1;i>=0;i--)if(n[i]!=="")break;return t>i?[]:n.slice(t,i-t+1)}var u,r;n=i.resolve(n).substr(1);t=i.resolve(t).substr(1);var f=s(n.split("/")),e=s(t.split("/")),h=Math.min(f.length,e.length),o=h;for(r=0;r<h;r++)if(f[r]!==e[r]){o=r;break}for(u=[],r=o;r<f.length;r++)u.push("..");return u=u.concat(e.slice(o)),u.join("/")};i.sep="/";i.delimiter=":";i.dirname=function(n){var r=t(n),u=r[0],i=r[1];return!u&&!i?".":(i&&(i=i.substr(0,i.length-1)),u+i)};i.basename=function(n,i){var r=t(n)[2];return i&&r.substr(-1*i.length)===i&&(r=r.substr(0,r.length-i.length)),r};i.extname=function(n){return t(n)[3]};f="ab".substr(-1)==="b"?function(n,t,i){return n.substr(t,i)}:function(n,t,i){return t<0&&(t=n.length+t),n.substr(t,i)}}).call(this,n("_process"))},{_process:64}],64:[function(n,t){function c(){e=!1;f.length?r=f.concat(r):o=-1;r.length&&s()}function s(){var t,n;if(!e){for(t=setTimeout(c),e=!0,n=r.length;n;){for(f=r,r=[];++o<n;)f&&f[o].run();o=-1;n=r.length}f=null;e=!1;clearTimeout(t)}}function h(n,t){this.fun=n;this.array=t}function u(){}var i=t.exports={},r=[],e=!1,f,o=-1;i.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];r.push(new h(n,i));r.length!==1||e||setTimeout(s,0)};h.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};i.on=u;i.addListener=u;i.once=u;i.off=u;i.removeListener=u;i.removeAllListeners=u;i.emit=u;i.binding=function(){throw new Error("process.binding is not supported");};i.cwd=function(){return"/"};i.chdir=function(){throw new Error("process.chdir is not supported");};i.umask=function(){return 0}},{}],65:[function(t,i,r){(function(t){
/*! https://mths.be/punycode v1.4.0 by @mathias */
(function(u){function h(n){throw new RangeError(vt[n]);}function nt(n,t){for(var i=n.length,r=[];i--;)r[i]=t(n[i]);return r}function tt(n,t){var i=n.split("@"),r="",u,f;return i.length>1&&(r=i[0]+"@",n=i[1]),n=n.replace(at,"."),u=n.split("."),f=nt(u,t).join("."),r+f}function it(n){for(var r=[],i=0,f=n.length,t,u;i<f;)t=n.charCodeAt(i++),t>=55296&&t<=56319&&i<f?(u=n.charCodeAt(i++),(u&64512)==56320?r.push(((t&1023)<<10)+(u&1023)+65536):(r.push(t),i--)):r.push(t);return r}function rt(n){return nt(n,function(n){var t="";return n>65535&&(n-=65536,t+=a(n>>>10&1023|55296),n=56320|n&1023),t+a(n)}).join("")}function yt(n){return n-48<10?n-22:n-65<26?n-65:n-97<26?n-97:f}function ut(n,t){return n+22+75*(n<26)-((t!=0)<<5)}function ft(n,t,i){var r=0;for(n=i?e(n/ht):n>>1,n+=e(n/t);n>w*l>>1;r+=f)n=e(n/w);return e(r+(w+1)*n/(n+st))}function et(n){var v=[],ut=n.length,r,t=0,b=d,y=k,i,u,w,nt,o,s,a,tt,it;for(i=n.lastIndexOf(g),i<0&&(i=0),u=0;u<i;++u)n.charCodeAt(u)>=128&&h("not-basic"),v.push(n.charCodeAt(u));for(w=i>0?i+1:0;w<ut;){for(nt=t,o=1,s=f;;s+=f){if(w>=ut&&h("invalid-input"),a=yt(n.charCodeAt(w++)),(a>=f||a>e((c-t)/o))&&h("overflow"),t+=a*o,tt=s<=y?p:s>=y+l?l:s-y,a<tt)break;it=f-tt;o>e(c/it)&&h("overflow");o*=it}r=v.length+1;y=ft(t-nt,r,nt==0);e(t/r)>c-b&&h("overflow");b+=e(t/r);t%=r;v.splice(t++,0,b)}return rt(v)}function ot(n){var r,u,v,et,y,t,o,w,b,nt,i,s=[],tt,rt,ot,st;for(n=it(n),tt=n.length,r=d,u=0,y=k,t=0;t<tt;++t)i=n[t],i<128&&s.push(a(i));for(v=et=s.length,et&&s.push(g);v<tt;){for(o=c,t=0;t<tt;++t)i=n[t],i>=r&&i<o&&(o=i);for(rt=v+1,o-r>e((c-u)/rt)&&h("overflow"),u+=(o-r)*rt,r=o,t=0;t<tt;++t)if(i=n[t],i<r&&++u>c&&h("overflow"),i==r){for(w=u,b=f;;b+=f){if(nt=b<=y?p:b>=y+l?l:b-y,w<nt)break;st=w-nt;ot=f-nt;s.push(a(ut(nt+st%ot,0)));w=e(st/ot)}s.push(a(ut(w,0)));y=ft(u,rt,v==et);u=0;++v}++u;++r}return s.join("")}function pt(n){return tt(n,function(n){return ct.test(n)?et(n.slice(4).toLowerCase()):n})}function wt(n){return tt(n,function(n){return lt.test(n)?"xn--"+ot(n):n})}var y=typeof r=="object"&&r&&!r.nodeType&&r,b=typeof i=="object"&&i&&!i.nodeType&&i,o=typeof t=="object"&&t;(o.global===o||o.window===o||o.self===o)&&(u=o);var s,c=2147483647,f=36,p=1,l=26,st=38,ht=700,k=72,d=128,g="-",ct=/^xn--/,lt=/[^\x20-\x7E]/,at=/[\x2E\u3002\uFF0E\uFF61]/g,vt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=f-p,e=Math.floor,a=String.fromCharCode,v;if(s={version:"1.3.2",ucs2:{decode:it,encode:rt},decode:et,encode:ot,toASCII:wt,toUnicode:pt},typeof n=="function"&&typeof n.amd=="object"&&n.amd)n("punycode",function(){return s});else if(y&&b)if(i.exports==y)b.exports=s;else for(v in s)s.hasOwnProperty(v)&&(y[v]=s[v]);else u.punycode=s})(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],66:[function(n,t){"use strict";function i(n,t){return Object.prototype.hasOwnProperty.call(n,t)}t.exports=function(n,t,u,f){var e,w,s,c,l,h,a,y,p,o,v;if(t=t||"&",u=u||"=",e={},typeof n!="string"||n.length===0)return e;for(w=/\+/g,n=n.split(t),s=1e3,f&&typeof f.maxKeys=="number"&&(s=f.maxKeys),c=n.length,s>0&&c>s&&(c=s),l=0;l<c;++l)h=n[l].replace(w,"%20"),a=h.indexOf(u),a>=0?(y=h.substr(0,a),p=h.substr(a+1)):(y=h,p=""),o=decodeURIComponent(y),v=decodeURIComponent(p),i(e,o)?r(e[o])?e[o].push(v):e[o]=[e[o],v]:e[o]=v;return e};var r=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}},{}],67:[function(n,t){"use strict";function u(n,t){var r,i;if(n.map)return n.map(t);for(r=[],i=0;i<n.length;i++)r.push(t(n[i],i));return r}var i=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}},r,f;t.exports=function(n,t,e,o){return(t=t||"&",e=e||"=",n===null&&(n=undefined),typeof n=="object")?u(f(n),function(f){var o=encodeURIComponent(i(f))+e;return r(n[f])?u(n[f],function(n){return o+encodeURIComponent(i(n))}).join(t):o+encodeURIComponent(i(n[f]))}).join(t):o?encodeURIComponent(i(o))+e+encodeURIComponent(i(n)):""};r=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};f=Object.keys||function(n){var t=[];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.push(i);return t}},{}],68:[function(n,t,i){"use strict";i.decode=i.parse=n("./decode");i.encode=i.stringify=n("./encode")},{"./decode":66,"./encode":67}],69:[function(n,t,i){"use strict";function r(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}function e(n,t,i){if(n&&u.isObject(n)&&n instanceof r)return n;var f=new r;return f.parse(n,t,i),f}function nt(n){return(u.isString(n)&&(n=e(n)),!(n instanceof r))?r.prototype.format.call(n):n.format()}function tt(n,t){return e(n,!1,!0).resolve(t)}function it(n,t){return n?e(n,!1,!0).resolveObject(t):t}var v=n("punycode"),u=n("./util");i.parse=e;i.resolve=tt;i.resolveObject=it;i.format=nt;i.Url=r;var y=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,w=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,b=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),o=["'"].concat(b),c=["%","/","?",";","#"].concat(o),l=["/","?","#"],k=255,a=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},s={javascript:!0,"javascript:":!0},f={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},h=n("querystring");r.prototype.parse=function(n,t,i){var r,rt,b,ot,pt,p,ni,st,nt,ht,ut,tt,wt,ft,ti,ri,e,ct,it,at,vt,et,lt,ui;if(!u.isString(n))throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var dt=n.indexOf("?"),gt=dt!==-1&&dt<n.indexOf("#")?"?":"#",yt=n.split(gt);if(yt[0]=yt[0].replace(/\\/g,"/"),n=yt.join(gt),r=n,r=r.trim(),!i&&n.split("#").length===1&&(rt=w.exec(r),rt))return this.path=r,this.href=r,this.pathname=rt[1],rt[2]?(this.search=rt[2],this.query=t?h.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this;if(b=y.exec(r),b&&(b=b[0],ot=b.toLowerCase(),this.protocol=ot,r=r.substr(b.length)),(i||b||r.match(/^\/\/[^@\/]+@[^@\/]+/))&&(pt=r.substr(0,2)==="//",!pt||b&&s[b]||(r=r.substr(2),this.slashes=!0)),!s[b]&&(pt||b&&!f[b])){for(p=-1,e=0;e<l.length;e++)nt=r.indexOf(l[e]),nt!==-1&&(p===-1||nt<p)&&(p=nt);for(st=p===-1?r.lastIndexOf("@"):r.lastIndexOf("@",p),st!==-1&&(ni=r.slice(0,st),r=r.slice(st+1),this.auth=decodeURIComponent(ni)),p=-1,e=0;e<c.length;e++)nt=r.indexOf(c[e]),nt!==-1&&(p===-1||nt<p)&&(p=nt);if(p===-1&&(p=r.length),this.host=r.slice(0,p),r=r.slice(p),this.parseHost(),this.hostname=this.hostname||"",ht=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]",!ht)for(ut=this.hostname.split(/\./),e=0,ct=ut.length;e<ct;e++)if((tt=ut[e],tt)&&!tt.match(a)){for(wt="",ft=0,ti=tt.length;ft<ti;ft++)wt+=tt.charCodeAt(ft)>127?"x":tt[ft];if(!wt.match(a)){var ii=ut.slice(0,e),bt=ut.slice(e+1),kt=tt.match(d);kt&&(ii.push(kt[1]),bt.unshift(kt[2]));bt.length&&(r="/"+bt.join(".")+r);this.hostname=ii.join(".");break}}this.hostname=this.hostname.length>k?"":this.hostname.toLowerCase();ht||(this.hostname=v.toASCII(this.hostname));lt=this.port?":"+this.port:"";ri=this.hostname||"";this.host=ri+lt;this.href+=this.host;ht&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),r[0]!=="/"&&(r="/"+r))}if(!g[ot])for(e=0,ct=o.length;e<ct;e++)(it=o[e],r.indexOf(it)!==-1)&&(at=encodeURIComponent(it),at===it&&(at=escape(it)),r=r.split(it).join(at));return vt=r.indexOf("#"),vt!==-1&&(this.hash=r.substr(vt),r=r.slice(0,vt)),et=r.indexOf("?"),et!==-1?(this.search=r.substr(et),this.query=r.substr(et+1),t&&(this.query=h.parse(this.query)),r=r.slice(0,et)):t&&(this.search="",this.query={}),r&&(this.pathname=r),f[ot]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(lt=this.pathname||"",ui=this.search||"",this.path=lt+ui),this.href=this.format(),this};r.prototype.format=function(){var i=this.auth||"",t;i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":")+"@");var e=this.protocol||"",r=this.pathname||"",o=this.hash||"",n=!1,s="";return this.host?n=i+this.host:this.hostname&&(n=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(s=h.stringify(this.query)),t=this.search||s&&"?"+s||"",e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||f[e])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),o&&o.charAt(0)!=="#"&&(o="#"+o),t&&t.charAt(0)!=="?"&&(t="?"+t),r=r.replace(/[?#]/g,function(n){return encodeURIComponent(n)}),t=t.replace("#","%23"),e+n+r+t+o};r.prototype.resolve=function(n){return this.resolveObject(e(n,!1,!0)).format()};r.prototype.resolveObject=function(n){var b,t,k,v,d,g,y,p,nt,w,tt,e,ut,ft,c,rt,h;for(u.isString(n)&&(b=new r,b.parse(n,!1,!0),n=b),t=new r,k=Object.keys(this),v=0;v<k.length;v++)d=k[v],t[d]=this[d];if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(g=Object.keys(n),y=0;y<g.length;y++)p=g[y],p!=="protocol"&&(t[p]=n[p]);return f[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!f[n.protocol]){for(nt=Object.keys(n),w=0;w<nt.length;w++)tt=nt[w],t[tt]=n[tt];return t.href=t.format(),t}if(t.protocol=n.protocol,n.host||s[n.protocol])t.pathname=n.pathname;else{for(e=(n.pathname||"").split("/");e.length&&!(n.host=e.shift()););n.host||(n.host="");n.hostname||(n.hostname="");e[0]!==""&&e.unshift("");e.length<2&&e.unshift("");t.pathname=e.join("/")}return t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,(t.pathname||t.search)&&(ut=t.pathname||"",ft=t.search||"",t.path=ut+ft),t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var ot=t.pathname&&t.pathname.charAt(0)==="/",et=n.host||n.pathname&&n.pathname.charAt(0)==="/",o=et||ot||t.host&&n.pathname,st=o,i=t.pathname&&t.pathname.split("/")||[],e=n.pathname&&n.pathname.split("/")||[],it=t.protocol&&!f[t.protocol];if(it&&(t.hostname="",t.port=null,t.host&&(i[0]===""?i[0]=t.host:i.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(e[0]===""?e[0]=n.host:e.unshift(n.host)),n.host=null),o=o&&(e[0]===""||i[0]==="")),et)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,i=e;else if(e.length)i||(i=[]),i.pop(),i=i.concat(e),t.search=n.search,t.query=n.query;else if(!u.isNullOrUndefined(n.search))return it&&(t.hostname=t.host=i.shift(),h=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1,h&&(t.auth=h.shift(),t.host=t.hostname=h.shift())),t.search=n.search,t.query=n.query,u.isNull(t.pathname)&&u.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!i.length)return t.pathname=null,t.path=t.search?"/"+t.search:null,t.href=t.format(),t;var l=i.slice(-1)[0],ht=(t.host||n.host||i.length>1)&&(l==="."||l==="..")||l==="",a=0;for(c=i.length;c>=0;c--)l=i[c],l==="."?i.splice(c,1):l===".."?(i.splice(c,1),a++):a&&(i.splice(c,1),a--);if(!o&&!st)for(;a--;a)i.unshift("..");return o&&i[0]!==""&&(!i[0]||i[0].charAt(0)!=="/")&&i.unshift(""),ht&&i.join("/").substr(-1)!=="/"&&i.push(""),rt=i[0]===""||i[0]&&i[0].charAt(0)==="/",it&&(t.hostname=t.host=rt?"":i.length?i.shift():"",h=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1,h&&(t.auth=h.shift(),t.host=t.hostname=h.shift())),o=o||t.host&&i.length,o&&!rt&&i.unshift(""),i.length?t.pathname=i.join("/"):(t.pathname=null,t.path=null),u.isNull(t.pathname)&&u.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};r.prototype.parseHost=function(){var n=this.host,t=p.exec(n);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),n=n.substr(0,n.length-t.length));n&&(this.hostname=n)}},{"./util":70,punycode:65,querystring:68}],70:[function(n,t){"use strict";t.exports={isString:function(n){return typeof n=="string"},isObject:function(n){return typeof n=="object"&&n!==null},isNull:function(n){return n===null},isNullOrUndefined:function(n){return n==null}}},{}],71:[function(n,t){t.exports=function(n){return n&&typeof n=="object"&&typeof n.copy=="function"&&typeof n.fill=="function"&&typeof n.readUInt8=="function"}},{}],72:[function(n,t,i){(function(t,r){function f(n,t){var r={seen:[],stylize:et};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),b(t)?r.showHidden=t:t&&i._extend(r,t),u(r.showHidden)&&(r.showHidden=!1),u(r.depth)&&(r.depth=2),u(r.colors)&&(r.colors=!1),u(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=ft),s(r,n,r.depth)}function ft(n,t){var i=f.styles[t];return i?"\x1b["+f.colors[i][0]+"m"+n+"\x1b["+f.colors[i][1]+"m":n}function et(n){return n}function ot(n){var t={};return n.forEach(function(n){t[n]=!0}),t}function s(n,t,r){var e,y,u,b,d,g,tt;if(n.customInspect&&t&&v(t.inspect)&&t.inspect!==i.inspect&&!(t.constructor&&t.constructor.prototype===t))return e=t.inspect(r,n),c(e)||(e=s(n,e,r)),e;if(y=st(n,t),y)return y;if(u=Object.keys(t),b=ot(u),n.showHidden&&(u=Object.getOwnPropertyNames(t)),a(t)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return p(t);if(u.length===0){if(v(t))return d=t.name?": "+t.name:"",n.stylize("[Function"+d+"]","special");if(l(t))return n.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return n.stylize(Date.prototype.toString.call(t),"date");if(a(t))return p(t)}var f="",o=!1,h=["{","}"];return(nt(t)&&(o=!0,h=["[","]"]),v(t)&&(g=t.name?": "+t.name:"",f=" [Function"+g+"]"),l(t)&&(f=" "+RegExp.prototype.toString.call(t)),k(t)&&(f=" "+Date.prototype.toUTCString.call(t)),a(t)&&(f=" "+p(t)),u.length===0&&(!o||t.length==0))?h[0]+f+h[1]:r<0?l(t)?n.stylize(RegExp.prototype.toString.call(t),"regexp"):n.stylize("[Object]","special"):(n.seen.push(t),tt=o?ht(n,t,r,b,u):u.map(function(i){return w(n,t,r,b,i,o)}),n.seen.pop(),ct(tt,f,h))}function st(n,t){if(u(t))return n.stylize("undefined","undefined");if(c(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return n.stylize(i,"string")}return tt(t)?n.stylize(""+t,"number"):b(t)?n.stylize(""+t,"boolean"):h(t)?n.stylize("null","null"):void 0}function p(n){return"["+Error.prototype.toString.call(n)+"]"}function ht(n,t,i,r,u){for(var f=[],e=0,o=t.length;e<o;++e)rt(t,String(e))?f.push(w(n,t,i,r,String(e),!0)):f.push("");return u.forEach(function(u){u.match(/^\d+$/)||f.push(w(n,t,i,r,u,!0))}),f}function w(n,t,i,r,f,e){var o,c,l;if(l=Object.getOwnPropertyDescriptor(t,f)||{value:t[f]},l.get?c=l.set?n.stylize("[Getter/Setter]","special"):n.stylize("[Getter]","special"):l.set&&(c=n.stylize("[Setter]","special")),rt(r,f)||(o="["+f+"]"),c||(n.seen.indexOf(l.value)<0?(c=h(i)?s(n,l.value,null):s(n,l.value,i-1),c.indexOf("\n")>-1&&(c=e?c.split("\n").map(function(n){return"  "+n}).join("\n").substr(2):"\n"+c.split("\n").map(function(n){return"   "+n}).join("\n"))):c=n.stylize("[Circular]","special")),u(o)){if(e&&f.match(/^\d+$/))return c;o=JSON.stringify(""+f);o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=n.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=n.stylize(o,"string"))}return o+": "+c}function ct(n,t,i){var r=0,u=n.reduce(function(n,t){return r++,t.indexOf("\n")>=0&&r++,n+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return u>60?i[0]+(t===""?"":t+"\n ")+" "+n.join(",\n  ")+" "+i[1]:i[0]+t+" "+n.join(", ")+" "+i[1]}function nt(n){return Array.isArray(n)}function b(n){return typeof n=="boolean"}function h(n){return n===null}function lt(n){return n==null}function tt(n){return typeof n=="number"}function c(n){return typeof n=="string"}function at(n){return typeof n=="symbol"}function u(n){return n===void 0}function l(n){return e(n)&&d(n)==="[object RegExp]"}function e(n){return typeof n=="object"&&n!==null}function k(n){return e(n)&&d(n)==="[object Date]"}function a(n){return e(n)&&(d(n)==="[object Error]"||n instanceof Error)}function v(n){return typeof n=="function"}function vt(n){return n===null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||typeof n=="symbol"||typeof n=="undefined"}function d(n){return Object.prototype.toString.call(n)}function g(n){return n<10?"0"+n.toString(10):n.toString(10)}function yt(){var n=new Date,t=[g(n.getHours()),g(n.getMinutes()),g(n.getSeconds())].join(":");return[n.getDate(),it[n.getMonth()],t].join(" ")}function rt(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var ut=/%[sdj%]/g,o,y,it;i.format=function(n){var u,t,r;if(!c(n)){for(u=[],t=0;t<arguments.length;t++)u.push(f(arguments[t]));return u.join(" ")}var t=1,i=arguments,o=i.length,s=String(n).replace(ut,function(n){if(n==="%%")return"%";if(t>=o)return n;switch(n){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(r){return"[Circular]"}default:return n}});for(r=i[t];t<o;r=i[++t])s+=h(r)||!e(r)?" "+r:" "+f(r);return s};i.deprecate=function(n,f){function o(){if(!e){if(t.throwDeprecation)throw new Error(f);else t.traceDeprecation?console.trace(f):console.error(f);e=!0}return n.apply(this,arguments)}if(u(r.process))return function(){return i.deprecate(n,f).apply(this,arguments)};if(t.noDeprecation===!0)return n;var e=!1;return o};o={};i.debuglog=function(n){if(u(y)&&(y=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(y)){var r=t.pid;o[n]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",n,r,t)}}else o[n]=function(){};return o[n]};i.inspect=f;f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};i.isArray=nt;i.isBoolean=b;i.isNull=h;i.isNullOrUndefined=lt;i.isNumber=tt;i.isString=c;i.isSymbol=at;i.isUndefined=u;i.isRegExp=l;i.isObject=e;i.isDate=k;i.isError=a;i.isFunction=v;i.isPrimitive=vt;i.isBuffer=n("./support/isBuffer");it=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",yt(),i.format.apply(i,arguments))};i.inherits=n("inherits");i._extend=function(n,t){if(!t||!e(t))return n;for(var i=Object.keys(t),r=i.length;r--;)n[i[r]]=t[i[r]];return n}}).call(this,n("_process"),typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":71,_process:64,inherits:62}],73:[function(n,t){"use strict";function o(n){return[Math.min(n[0],n[1]),Math.max(n[0],n[1])]}function s(n,t){return n[0]-t[0]||n[1]-t[1]}function h(n){return n.map(o).sort(s)}function i(n,t,i){return t in n?n[t]:i}function c(n,t,o){var l,s,a,v;Array.isArray(t)?(o=o||{},t=t||[]):(o=t||{},t=[]);var w=!!i(o,"delaunay",!0),y=!!i(o,"interior",!0),p=!!i(o,"exterior",!0),c=!!i(o,"infinity",!1);if(!y&&!p||n.length===0)return[];if(l=u(n,t),w||y!==p||c){for(s=f(n.length,h(t)),a=0;a<l.length;++a)v=l[a],s.addTriangle(v[0],v[1],v[2]);return w&&e(n,s),p?y?c?r(s,0,c):s.cells():r(s,1,c):r(s,-1)}return l}var u=n("./lib/monotone"),f=n("./lib/triangulation"),e=n("./lib/delaunay"),r=n("./lib/filter");t.exports=c},{"./lib/delaunay":74,"./lib/filter":75,"./lib/monotone":76,"./lib/triangulation":77}],74:[function(n,t){"use strict";function i(n,t,i,u,f,e){var o=t.opposite(u,f),s;o<0||(f<u&&(s=u,u=f,f=s,s=e,e=o,o=s),t.isConstraint(u,f))||r(n[u],n[f],n[e],n[o])<0&&i.push(u,f)}function u(n,t){for(var o,c,f,s,e,l,a,v,y,h=[],w=n.length,p=t.stars,u=0;u<w;++u)for(o=p[u],c=1;c<o.length;c+=2)if((f=o[c],!(f<u))&&!t.isConstraint(u,f)){for(s=o[c-1],e=-1,l=1;l<o.length;l+=2)if(o[l-1]===f){e=o[l];break}e<0||r(n[u],n[f],n[s],n[e])<0&&h.push(u,f)}while(h.length>0){var f=h.pop(),u=h.pop(),s=-1,e=-1,o=p[u];for(a=1;a<o.length;a+=2)v=o[a-1],y=o[a],v===f?e=y:y===f&&(s=v);s<0||e<0||r(n[u],n[f],n[s],n[e])>=0||(t.flip(u,f),i(n,t,h,s,u,e),i(n,t,h,u,e,s),i(n,t,h,e,f,s),i(n,t,h,f,s,e))}}var r=n("robust-in-sphere")[4],f=n("binary-search-bounds");t.exports=u},{"binary-search-bounds":78,"robust-in-sphere":79}],75:[function(n,t){"use strict";function i(n,t,i,r,u,f,e){this.cells=n;this.neighbor=t;this.flags=r;this.constraint=i;this.active=u;this.next=f;this.boundary=e}function u(n,t){return n[0]-t[0]||n[1]-t[1]||n[2]-t[2]}function e(n,t){for(var l,y,f,s,h=n.cells(),c=h.length,r=0;r<c;++r){var f=h[r],e=f[0],o=f[1],a=f[2];o<a?o<e&&(f[0]=o,f[1]=a,f[2]=e):a<e&&(f[0]=a,f[1]=e,f[2]=o)}for(h.sort(u),l=new Array(c),r=0;r<l.length;++r)l[r]=0;var p=[],w=[],b=new Array(3*c),k=new Array(3*c),v=null;for(t&&(v=[]),y=new i(h,b,k,l,p,w,v),r=0;r<c;++r)for(f=h[r],s=0;s<3;++s){var e=f[s],o=f[(s+1)%3],d=b[3*r+s]=y.locate(o,e,n.opposite(o,e)),g=k[3*r+s]=n.isConstraint(e,o);d<0&&(g?w.push(r):(p.push(r),l[r]=1),t&&v.push([o,e,-1]))}return y}function o(n,t,i){for(var u=0,r=0;r<n.length;++r)t[r]===i&&(n[u++]=n[r]);return n.length=u,n}function s(n,t,i){var r=e(n,i),f,k,a,s,p,v;if(t===0)return i?r.cells.concat(r.boundary):r.cells;for(var h=1,u=r.active,c=r.next,l=r.flags,y=r.cells,w=r.constraint,b=r.neighbor;u.length>0||c.length>0;){while(u.length>0)if(f=u.pop(),l[f]!==-h)for(l[f]=h,k=y[f],a=0;a<3;++a)s=b[3*f+a],s>=0&&l[s]===0&&(w[3*f+a]?c.push(s):(u.push(s),l[s]=h));p=c;c=u;u=p;c.length=0;h=-h}return(v=o(y,l,t),i)?v.concat(r.boundary):v}var f=n("binary-search-bounds"),r;t.exports=s;r=i.prototype;r.locate=function(){var n=[0,0,0];return function(t,i,r){var e=t,o=i,s=r;return(i<r?i<t&&(e=i,o=r,s=t):r<t&&(e=r,o=t,s=i),e<0)?-1:(n[0]=e,n[1]=o,n[2]=s,f.eq(this.cells,n,u))}}()},{"binary-search-bounds":78}],76:[function(n,t){"use strict";function s(n,t,i,r,u){this.a=n;this.b=t;this.idx=i;this.lowerIds=r;this.upperIds=u}function r(n,t,i,r){this.a=n;this.b=t;this.type=i;this.idx=r}function l(n,t){var r=n.a[0]-t.a[0]||n.a[1]-t.a[1]||n.type-t.type;return r?r:n.type!==f&&(r=i(n.a,n.b,t.b),r)?r:n.idx-t.idx}function h(n,t){return i(n.a,n.b,t)}function a(n,t,r,f,e){for(var s,o,v=u.lt(t,f,h),y=u.gt(t,f,h),l=v;l<y;++l){for(var a=t[l],c=a.lowerIds,o=c.length;o>1&&i(r[c[o-2]],r[c[o-1]],f)>0;)n.push([c[o-1],c[o-2],e]),o-=1;for(c.length=o,c.push(e),s=a.upperIds,o=s.length;o>1&&i(r[s[o-2]],r[s[o-1]],f)<0;)n.push([s[o-2],s[o-1],e]),o-=1;s.length=o;s.push(e)}}function c(n,t){var r;return(r=n.a[0]<t.a[0]?i(n.a,n.b,t.a):i(t.b,t.a,n.a),r)?r:(r=t.b[0]<n.b[0]?i(n.a,n.b,t.b):i(t.b,t.a,n.b),r||n.idx-t.idx)}function v(n,t,i){var f=u.le(n,i,c),e=n[f],r=e.upperIds,o=r[r.length-1];e.upperIds=[o];n.splice(f+1,0,new s(i.a,i.b,i.idx,[o],r))}function y(n,t,i){var f=i.a;i.a=i.b;i.b=f;var r=u.eq(n,i,c),e=n[r],o=n[r-1];o.upperIds=e.upperIds;n.splice(r,1)}function p(n,t){for(var nt,p,b,tt=n.length,it=t.length,u=[],i=0;i<tt;++i)u.push(new r(n[i],null,f,i));for(i=0;i<it;++i){var k=t[i],h=n[k[0]],c=n[k[1]];h[0]<c[0]?u.push(new r(h,c,e,i),new r(c,h,o,i)):h[0]>c[0]&&u.push(new r(c,h,e,i),new r(h,c,o,i))}u.sort(l);var d=u[0].a[0]-(1+Math.abs(u[0].a[0]))*Math.pow(2,-52),w=[new s([d,1],[d,0],-1,[],[],[],[])],g=[];for(i=0,nt=u.length;i<nt;++i)p=u[i],b=p.type,b===f?a(g,w,n,p.a,p.idx):b===e?v(w,n,p):y(w,n,p);return g}var u=n("binary-search-bounds"),i=n("robust-orientation")[3],f=0,o=1,e=2;t.exports=p},{"binary-search-bounds":78,"robust-orientation":531}],77:[function(n,t){"use strict";function u(n,t){this.stars=n;this.edges=t}function r(n,t,i){for(var r=1,u=n.length;r<u;r+=2)if(n[r-1]===t&&n[r]===i){n[r-1]=n[u-2];n[r]=n[u-1];n.length=u-2;return}}function e(n,t){for(var r=new Array(n),i=0;i<n;++i)r[i]=[];return new u(r,t)}var f=n("binary-search-bounds"),i;t.exports=e;i=u.prototype;i.isConstraint=function(){function t(n,t){return n[0]-t[0]||n[1]-t[1]}var n=[0,0];return function(i,r){return n[0]=Math.min(i,r),n[1]=Math.max(i,r),f.eq(this.edges,n,t)>=0}}();i.removeTriangle=function(n,t,i){var u=this.stars;r(u[n],t,i);r(u[t],i,n);r(u[i],n,t)};i.addTriangle=function(n,t,i){var r=this.stars;r[n].push(t,i);r[t].push(i,n);r[i].push(n,t)};i.opposite=function(n,t){for(var r=this.stars[t],i=1,u=r.length;i<u;i+=2)if(r[i]===n)return r[i-1];return-1};i.flip=function(n,t){var i=this.opposite(n,t),r=this.opposite(t,n);this.removeTriangle(n,t,i);this.removeTriangle(t,n,r);this.addTriangle(n,r,i);this.addTriangle(t,i,r)};i.edges=function(){for(var t,n,f,r=this.stars,u=[],i=0,e=r.length;i<e;++i)for(t=r[i],n=0,f=t.length;n<f;n+=2)u.push([t[n],t[n+1]]);return u};i.cells=function(){for(var i,t,o,r,u,f=this.stars,e=[],n=0,s=f.length;n<s;++n)for(i=f[n],t=0,o=i.length;t<o;t+=2)r=i[t],u=i[t+1],n<Math.min(r,u)&&e.push([n,r,u]);return e}},{"binary-search-bounds":78}],78:[function(n,t){"use strict";function r(n,t,i,r,u){var f=["function ",n,"(a,l,h,",r.join(","),"){",u?"":"var i=",i?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return u?t.indexOf("c")<0?f.push(";if(x===y){return m}else if(x<=y){"):f.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):f.push(";if(",t,"){i=m;"),i?f.push("l=m+1}else{h=m-1}"):f.push("h=m-1}else{l=m+1}"),f.push("}"),u?f.push("return -1};"):f.push("return i};"),f.join("")}function i(n,t,i,u){var f=new Function([r("A","x"+n+"y",t,["y"],u),r("P","c(x,y)"+n+"0",t,["y","c"],u),"function dispatchBsearch",i,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",i].join(""));return f()}t.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},{}],79:[function(n,t){"use strict";function f(n,t){for(var f,i,e,u=new Array(n.length-1),r=1;r<n.length;++r)for(f=u[r-1]=new Array(n.length-1),i=0,e=0;i<n.length;++i)i!==t&&(f[e++]=n[r][i]);return u}function v(n){for(var i,r=new Array(n),t=0;t<n;++t)for(r[t]=new Array(n),i=0;i<n;++i)r[t][i]=["m",i,"[",n-t-2,"]"].join("");return r}function r(n){if(n.length===1)return n[0];if(n.length===2)return["sum(",n[0],",",n[1],")"].join("");var t=n.length>>1;return["sum(",r(n.slice(0,t)),",",r(n.slice(t)),")"].join("")}function e(n,t){if(n.charAt(0)==="m"){if(t.charAt(0)==="w"){var i=n.split("[");return["w",t.substr(1),"m",i[0].substr(1)].join("")}return["prod(",n,",",t,")"].join("")}return e(t,n)}function y(n){return n&!0?"-":""}function o(n){var i,t;if(n.length===2)return[["diff(",e(n[0][0],n[1][1]),",",e(n[1][0],n[0][1]),")"].join("")];for(i=[],t=0;t<n.length;++t)i.push(["scale(",r(o(f(n,t))),",",y(t),n[0][t],")"].join(""));return i}function p(n,t){for(var u=[],i=0;i<t-2;++i)u.push(["prod(m",n,"[",i,"],m",n,"[",i,"])"].join(""));return r(u)}function s(n){for(var u,i,k,s=[],y=[],e=v(n),t=0;t<n;++t)e[0][t]="1",e[n-1][t]="w"+t;for(t=0;t<n;++t)(t&1)==0?s.push.apply(s,o(f(e,t))):y.push.apply(y,o(f(e,t)));var d=r(s),g=r(y),w="exactInSphere"+n,b=[];for(t=0;t<n;++t)b.push("m"+t);for(u=["function ",w,"(",b.join(),"){"],t=0;t<n;++t)for(u.push("var w",t,"=",p(t,n),";"),i=0;i<n;++i)i!==t&&u.push("var w",t,"m",i,"=scale(w",t,",m",i,"[0]);");return u.push("var p=",d,",n=",g,",d=diff(p,n);return d[d.length-1];}return ",w),k=new Function("sum","diff","prod","scale",u.join("")),k(c,l,h,a)}function w(){return 0}function b(){return 0}function k(){return 0}function d(n){var t=i[n.length];return t||(t=i[n.length]=s(n.length)),t.apply(undefined,n)}function g(){for(var r,f,e,o,n;i.length<=u;)i.push(s(i.length));for(r=[],f=["slow"],n=0;n<=u;++n)r.push("a"+n),f.push("o"+n);for(e=["function testInSphere(",r.join(),"){switch(arguments.length){case 0:case 1:return 0;"],n=2;n<=u;++n)e.push("case ",n,":return o",n,"(",r.slice(0,n).join(),");");for(e.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),f.push(e.join("")),o=Function.apply(undefined,f),t.exports=o.apply(undefined,[d].concat(i)),n=0;n<=u;++n)t.exports[n]=i[n]}var h=n("two-product"),c=n("robust-sum"),l=n("robust-subtract"),a=n("robust-scale"),u=6,i=[w,b,k];g()},{"robust-scale":532,"robust-subtract":533,"robust-sum":534,"two-product":548}],80:[function(n,t){"use strict";function h(n){var t=e(n),i=f(u(t),n);return i<0?[t,s(t,Infinity)]:i>0?[s(t,-Infinity),t]:[t,t]}function a(n,t){for(var f=new Array(t.length),i=0;i<t.length;++i){var e=t[i],r=n[e[0]],u=n[e[1]];f[i]=[Math.min(r[0],u[0]),Math.min(r[1],u[1]),Math.max(r[0],u[0]),Math.max(r[1],u[1])]}return f}function v(n){for(var t,r=new Array(n.length),i=0;i<n.length;++i)t=n[i],r[i]=[t[0],t[1],t[0],t[1]];return r}function y(n,t,i){var u=[];return r(i,function(i,r){var f=t[i],e=t[r];if(f[0]!==e[0]&&f[0]!==e[1]&&f[1]!==e[0]&&f[1]!==e[1]){var s=n[f[0]],h=n[f[1]],c=n[e[0]],l=n[e[1]];o(s,h,c,l)&&u.push([i,r])}}),u}function p(n,t,i,u){var f=[];return r(i,u,function(i,r){var u=t[i];if(u[0]!==r&&u[1]!==r){var e=n[r],s=n[u[0]],h=n[u[1]];o(s,h,e,e)&&f.push([i,r])}}),f}function w(n,t,r,e,o){function ut(t){if(t>=n.length)return v[t-n.length];var i=n[t];return[u(i[0]),u(i[1])]}for(var k,ot,h,d,p,b,v=[],s=0;s<r.length;++s){var g=r[s],y=g[0],nt=g[1],tt=t[y],it=t[nt],rt=l(i(n[tt[0]]),i(n[tt[1]]),i(n[it[0]]),i(n[it[1]]));rt&&(k=v.length+n.length,v.push(rt),e.push([y,k],[nt,k]))}for(e.sort(function(n,t){if(n[0]!==t[0])return n[0]-t[0];var i=ut(n[1]),r=ut(t[1]);return f(i[0],r[0])||f(i[1],r[1])}),s=e.length-1;s>=0;--s){var p=e[s],y=p[0],c=t[y],w=c[0],a=c[1],ft=n[w],et=n[a];for((ft[0]-et[0]||ft[1]-et[1])<0&&(ot=w,w=a,a=ot),c[0]=w,h=c[1]=p[1],o&&(d=c[2]);s>0&&e[s-1][0]===y;)p=e[--s],b=p[1],o?t.push([h,b,d]):t.push([h,b]),h=b;o?t.push([h,a,d]):t.push([h,a])}return v}function b(n,t,i){for(var b,o=n.length+t.length,l=new c(o),v=i,u=0;u<t.length;++u){var s=t[u],y=h(s[0]),p=h(s[1]);v.push([y[0],p[0],y[1],p[1]]);n.push([e(s[0]),e(s[1])])}r(v,function(n,t){l.link(n,t)});var a=0,w=!0,f=new Array(o);for(u=0;u<o;++u)b=l.find(u),b===u?(f[u]=a,n[a++]=n[u]):(w=!1,f[u]=-1);if(n.length=a,w)return null;for(u=0;u<o;++u)f[u]<0&&(f[u]=f[l.find(u)]);return f}function k(n,t){return n[0]-t[0]||n[1]-t[1]}function d(n,t){var i=n[0]-t[0]||n[1]-t[1];return i?i:n[2]<t[2]?-1:n[2]>t[2]?1:0}function g(n,t,i){var h,r,s,f;if(n.length!==0){if(t)for(r=0;r<n.length;++r){var u=n[r],e=t[u[0]],o=t[u[1]];u[0]=Math.min(e,o);u[1]=Math.max(e,o)}else for(r=0;r<n.length;++r){var u=n[r],e=u[0],o=u[1];u[0]=Math.min(e,o);u[1]=Math.max(e,o)}for(i?n.sort(d):n.sort(k),h=1,r=1;r<n.length;++r)(s=n[r-1],f=n[r],f[0]!==s[0]||f[1]!==s[1]||i&&f[2]!==s[2])&&(n[h++]=f);n.length=h}}function nt(n,t,i){var r=a(n,t),u=y(n,t,r),f=v(n),e=p(n,t,r,f),s=w(n,t,u,e,i),o=b(n,s,f);return(g(t,o,i),!o)?u.length>0||e.length>0:!0}function tt(n,t,i){var f=!1,e,o,r,u;if(i){for(e=t,o=new Array(t.length),r=0;r<t.length;++r)u=t[r],o[r]=[u[0],u[1],i[r]];t=o}while(nt(n,t,!!i))f=!0;if(!!i&&f)for(e.length=0,i.length=0,r=0;r<t.length;++r)u=t[r],e.push([u[0],u[1]]),i.push(u[2]);return f}t.exports=tt;var c=n("union-find"),r=n("box-intersect"),it=n("compare-cell"),o=n("robust-segment-intersect"),u=n("big-rat"),f=n("big-rat/cmp"),e=n("big-rat/to-float"),i=n("rat-vec"),s=n("nextafter"),l=n("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":81,"big-rat":85,"big-rat/cmp":83,"big-rat/to-float":98,"box-intersect":99,"compare-cell":117,nextafter:107,"rat-vec":109,"robust-segment-intersect":112,"union-find":113}],81:[function(n,t){"use strict";function u(n,t){return e(r(n[0],t[1]),r(n[1],t[0]))}function c(n,t,r,e){var c=i(t,n),l=i(e,r),a=u(c,l);if(o(a)===0)return null;var v=i(n,r),y=u(l,v),p=f(y,a);return s(n,h(c,p))}t.exports=c;var r=n("big-rat/mul"),f=n("big-rat/div"),e=n("big-rat/sub"),o=n("big-rat/sign"),i=n("rat-vec/sub"),s=n("rat-vec/add"),h=n("rat-vec/muls"),l=n("big-rat/to-float")},{"big-rat/div":84,"big-rat/mul":94,"big-rat/sign":96,"big-rat/sub":97,"big-rat/to-float":98,"rat-vec/add":108,"rat-vec/muls":110,"rat-vec/sub":111}],82:[function(n,t){"use strict";function r(n,t){return i(n[0].mul(t[1]).add(t[0].mul(n[1])),n[1].mul(t[1]))}var i=n("./lib/rationalize");t.exports=r},{"./lib/rationalize":92}],83:[function(n,t){"use strict";function i(n,t){return n[0].mul(t[1]).cmp(t[0].mul(n[1]))}t.exports=i},{}],84:[function(n,t){"use strict";function r(n,t){return i(n[0].mul(t[1]),n[1].mul(t[0]))}var i=n("./lib/rationalize");t.exports=r},{"./lib/rationalize":92}],85:[function(n,t){"use strict";function e(n,t){if(r(n))return t?s(n,e(t)):[n[0].clone(),n[1].clone()];var l=0,c,h;if(u(n))c=n.clone();else if(typeof n=="string")c=f(n);else{if(n===0)return[i(0),i(1)];if(n===Math.floor(n))c=i(n);else{while(n!==Math.floor(n))n=n*Math.pow(2,256),l-=256;c=i(n)}}if(r(t))c.mul(t[1]),h=t[0].clone();else if(u(t))h=t.clone();else if(typeof t=="string")h=f(t);else if(t)if(t===Math.floor(t))h=i(t);else{while(t!==Math.floor(t))t=t*Math.pow(2,256),l+=256;h=i(t)}else h=i(1);return l>0?c=c.shln(l):l<0&&(h=h.shln(-l)),o(c,h)}var r=n("./is-rat"),u=n("./lib/is-bn"),i=n("./lib/num-to-bn"),f=n("./lib/str-to-bn"),o=n("./lib/rationalize"),s=n("./div");t.exports=e},{"./div":84,"./is-rat":86,"./lib/is-bn":90,"./lib/num-to-bn":91,"./lib/rationalize":92,"./lib/str-to-bn":93}],86:[function(n,t){"use strict";function r(n){return Array.isArray(n)&&n.length===2&&i(n[0])&&i(n[1])}var i=n("./lib/is-bn");t.exports=r},{"./lib/is-bn":90}],87:[function(n,t){"use strict";function r(n){return n.cmp(new i(0))}var i=n("bn.js");t.exports=r},{"bn.js":95}],88:[function(n,t){"use strict";function i(n){var u=n.length,r=n.words,t=0,i,f;if(u===1)t=r[0];else if(u===2)t=r[0]+r[1]*67108864;else for(t=0,i=0;i<u;i++)f=r[i],t+=f*Math.pow(67108864,i);return n.sign?-t:t}t.exports=i},{}],89:[function(n,t){"use strict";function u(n){var u=r(i.lo(n)),t;return u<32?u:(t=r(i.hi(n)),t>20)?52:t+32}var i=n("double-bits"),r=n("bit-twiddle").countTrailingZeros;t.exports=u},{"bit-twiddle":56,"double-bits":106}],90:[function(n,t){"use strict";function i(n){return n&&typeof n=="object"&&Boolean(n.words)}var r=n("bn.js");t.exports=i},{"bn.js":95}],91:[function(n,t){"use strict";function u(n){var t=r.exponent(n);return t<52?new i(n):new i(n*Math.pow(2,52-t)).shln(t-52)}var i=n("bn.js"),r=n("double-bits");t.exports=u},{"bn.js":95,"double-bits":106}],92:[function(n,t){"use strict";function u(n,t){var e=r(n),f=r(t),u;return e===0?[i(0),i(1)]:f===0?[i(0),i(0)]:(f<0&&(n=n.neg(),t=t.neg()),u=n.gcd(t),u.cmpn(1))?[n.div(u),t.div(u)]:[n,t]}var i=n("./num-to-bn"),r=n("./bn-sign");t.exports=u},{"./bn-sign":87,"./num-to-bn":91}],93:[function(n,t){"use strict";function r(n){return new i(n)}var i=n("bn.js");t.exports=r},{"bn.js":95}],94:[function(n,t){"use strict";function r(n,t){return i(n[0].mul(t[0]),n[1].mul(t[1]))}var i=n("./lib/rationalize");t.exports=r},{"./lib/rationalize":92}],95:[function(n,t){(function(n,t){"use strict";function r(n,t){if(!n)throw new Error(t||"Assertion failed");}function o(n,t){n.super_=t;var i=function(){};i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n}function i(n,t,i){if(n!==null&&typeof n=="object"&&Array.isArray(n.words))return n;this.sign=!1;this.words=null;this.length=0;this.red=null;(t==="le"||t==="be")&&(i=t,t=10);n!==null&&this._init(n||0,t||10,i||"be")}function l(n,t,i){for(var r,u=0,e=Math.min(n.length,i),f=t;f<e;f++)r=n.charCodeAt(f)-48,u<<=4,u|=r>=49&&r<=54?r-39:r>=17&&r<=22?r-7:r&15;return u}function a(n,t,i,r){for(var u,f=0,o=Math.min(n.length,i),e=t;e<o;e++)u=n.charCodeAt(e)-48,f*=r,f+=u>=49?u-39:u>=17?u-7:u;return f}function f(n,t){this.name=n;this.p=new i(t,16);this.n=this.p.bitLength();this.k=new i(1).ishln(this.n).isub(this.p);this.tmp=this._tmp()}function h(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function p(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function c(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function u(n){if(typeof n=="string"){var t=i._prime(n);this.m=t.p;this.prime=t}else this.m=n,this.prime=null}function e(n){u.call(this,n);this.shift=this.m.bitLength();this.shift%26!=0&&(this.shift+=26-this.shift%26);this.r=new i(1).ishln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv.sign=!0;this.minv=this.minv.mod(this.r)}var s;typeof n=="object"?n.exports=i:t.BN=i;i.BN=i;i.wordSize=26;i.prototype._init=function(n,t,i){if(typeof n=="number")return this._initNumber(n,t,i);if(typeof n=="object")return this._initArray(n,t,i);t==="hex"&&(t=16);r(t===(t|0)&&t>=2&&t<=36);n=n.toString().replace(/\s+/g,"");var u=0;(n[0]==="-"&&u++,t===16?this._parseHex(n,u):this._parseBase(n,t,u),n[0]==="-"&&(this.sign=!0),this.strip(),i==="le")&&this._initArray(this.toArray(),t,i)};i.prototype._initNumber=function(n,t,i){(n<0&&(this.sign=!0,n=-n),n<67108864?(this.words=[n&67108863],this.length=1):n<4503599627370496?(this.words=[n&67108863,n/67108864&67108863],this.length=2):(r(n<9007199254740992),this.words=[n&67108863,n/67108864&67108863,1],this.length=3),i==="le")&&this._initArray(this.toArray(),t,i)};i.prototype._initArray=function(n,t,i){var f,u,e,o;if(r(typeof n.length=="number"),n.length<=0)return this.words=[0],this.length=1,this;for(this.length=Math.ceil(n.length/3),this.words=new Array(this.length),u=0;u<this.length;u++)this.words[u]=0;if(f=0,i==="be")for(u=n.length-1,e=0;u>=0;u-=3)o=n[u]|n[u-1]<<8|n[u-2]<<16,this.words[e]|=o<<f&67108863,this.words[e+1]=o>>>26-f&67108863,f+=24,f>=26&&(f-=26,e++);else if(i==="le")for(u=0,e=0;u<n.length;u+=3)o=n[u]|n[u+1]<<8|n[u+2]<<16,this.words[e]|=o<<f&67108863,this.words[e+1]=o>>>26-f&67108863,f+=24,f>=26&&(f-=26,e++);return this.strip()};i.prototype._parseHex=function(n,t){var r,i,u,f;for(this.length=Math.ceil((n.length-t)/6),this.words=new Array(this.length),i=0;i<this.length;i++)this.words[i]=0;for(r=0,i=n.length-6,u=0;i>=t;i-=6)f=l(n,i,i+6),this.words[u]|=f<<r&67108863,this.words[u+1]|=f>>>26-r&4194303,r+=24,r>=26&&(r-=26,u++);i+6!==t&&(f=l(n,t,i+6),this.words[u]|=f<<r&67108863,this.words[u+1]|=f>>>26-r&4194303);this.strip()};i.prototype._parseBase=function(n,t,i){var f,e,h,u,r;for(this.words=[0],this.length=1,f=0,e=1;e<=67108863;e*=t)f++;f--;e=e/t|0;var o=n.length-i,s=o%f,c=Math.min(o,o-s)+i,u=0;for(r=i;r<c;r+=f)u=a(n,r,r+f,t),this.imuln(e),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(s!==0){for(h=1,u=a(n,r,n.length,t),r=0;r<s;r++)h*=t;this.imuln(h);this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}};i.prototype.copy=function(n){n.words=new Array(this.length);for(var t=0;t<this.length;t++)n.words[t]=this.words[t];n.length=this.length;n.sign=this.sign;n.red=this.red};i.prototype.clone=function(){var n=new i(null);return this.copy(n),n};i.prototype.strip=function(){while(this.length>1&&this.words[this.length-1]===0)this.length--;return this._normSign()};i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.sign=!1),this};i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(n,t){var u,c,s,h;if(n=n||10,n===16||n==="hex"){var i="",e=0,t=t|0||1,o=0;for(u=0;u<this.length;u++)c=this.words[u],s=((c<<e|o)&16777215).toString(16),o=c>>>24-e&16777215,i=o!==0||u!==this.length-1?v[6-s.length]+s+i:s+i,e+=2,e>=26&&(e-=26,u--);for(o!==0&&(i=o.toString(16)+i);i.length%t!=0;)i="0"+i;return this.sign&&(i="-"+i),i}if(n===(n|0)&&n>=2&&n<=36){var a=w[n],l=b[n],i="",f=this.clone();for(f.sign=!1;f.cmpn(0)!==0;)h=f.modn(l).toString(n),f=f.idivn(l),i=f.cmpn(0)!==0?v[a-h.length]+h+i:h+i;return this.cmpn(0)===0&&(i="0"+i),this.sign&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")};i.prototype.toJSON=function(){return this.toString(16)};i.prototype.toArray=function(n){var i,t,r,u;if(this.strip(),i=new Array(this.byteLength()),i[0]=0,t=this.clone(),n!=="le")for(r=0;t.cmpn(0)!==0;r++)u=t.andln(255),t.ishrn(8),i[i.length-r-1]=u;else for(r=0;t.cmpn(0)!==0;r++)u=t.andln(255),t.ishrn(8),i[r]=u;return i};i.prototype._countBits=Math.clz32?function(n){return 32-Math.clz32(n)}:function(n){var t=n,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t};i.prototype._zeroBits=function(n){if(n===0)return 26;var t=n,i=0;return(t&8191)==0&&(i+=13,t>>>=13),(t&127)==0&&(i+=7,t>>>=7),(t&15)==0&&(i+=4,t>>>=4),(t&3)==0&&(i+=2,t>>>=2),(t&1)==0&&i++,i};i.prototype.bitLength=function(){var n=0,t=this.words[this.length-1],n=this._countBits(t);return(this.length-1)*26+n};i.prototype.zeroBits=function(){var t,n,i;if(this.cmpn(0)===0)return 0;for(t=0,n=0;n<this.length;n++)if(i=this._zeroBits(this.words[n]),t+=i,i!==26)break;return t};i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)};i.prototype.neg=function(){if(this.cmpn(0)===0)return this.clone();var n=this.clone();return n.sign=!this.sign,n};i.prototype.ior=function(n){for(this.sign=this.sign||n.sign;this.length<n.length;)this.words[this.length++]=0;for(var t=0;t<n.length;t++)this.words[t]=this.words[t]|n.words[t];return this.strip()};i.prototype.or=function(n){return this.length>n.length?this.clone().ior(n):n.clone().ior(this)};i.prototype.iand=function(n){var i,t;for(this.sign=this.sign&&n.sign,i=this.length>n.length?n:this,t=0;t<i.length;t++)this.words[t]=this.words[t]&n.words[t];return this.length=i.length,this.strip()};i.prototype.and=function(n){return this.length>n.length?this.clone().iand(n):n.clone().iand(this)};i.prototype.ixor=function(n){var i,r,t;for(this.sign=this.sign||n.sign,this.length>n.length?(i=this,r=n):(i=n,r=this),t=0;t<r.length;t++)this.words[t]=i.words[t]^r.words[t];if(this!==i)for(;t<i.length;t++)this.words[t]=i.words[t];return this.length=i.length,this.strip()};i.prototype.xor=function(n){return this.length>n.length?this.clone().ixor(n):n.clone().ixor(this)};i.prototype.setn=function(n,t){r(typeof n=="number"&&n>=0);for(var i=n/26|0,u=n%26;this.length<=i;)this.words[this.length++]=0;return this.words[i]=t?this.words[i]|1<<u:this.words[i]&~(1<<u),this.strip()};i.prototype.iadd=function(n){var r,f,u,t,i;if(this.sign&&!n.sign)return this.sign=!1,i=this.isub(n),this.sign=!this.sign,this._normSign();if(!this.sign&&n.sign)return n.sign=!1,i=this.isub(n),n.sign=!0,i._normSign();for(this.length>n.length?(r=this,f=n):(r=n,f=this),u=0,t=0;t<f.length;t++)i=r.words[t]+f.words[t]+u,this.words[t]=i&67108863,u=i>>>26;for(;u!==0&&t<r.length;t++)i=r.words[t]+u,this.words[t]=i&67108863,u=i>>>26;if(this.length=r.length,u!==0)this.words[this.length]=u,this.length++;else if(r!==this)for(;t<r.length;t++)this.words[t]=r.words[t];return this};i.prototype.add=function(n){var t;return n.sign&&!this.sign?(n.sign=!1,t=this.sub(n),n.sign=!0,t):!n.sign&&this.sign?(this.sign=!1,t=n.sub(this),this.sign=!0,t):this.length>n.length?this.clone().iadd(n):n.clone().iadd(this)};i.prototype.isub=function(n){var e,i,f,u,t,r;if(n.sign)return n.sign=!1,r=this.iadd(n),n.sign=!0,r._normSign();if(this.sign)return this.sign=!1,this.iadd(n),this.sign=!0,this._normSign();if(e=this.cmp(n),e===0)return this.sign=!1,this.length=1,this.words[0]=0,this;for(e>0?(i=this,f=n):(i=n,f=this),u=0,t=0;t<f.length;t++)r=i.words[t]-f.words[t]+u,u=r>>26,this.words[t]=r&67108863;for(;u!==0&&t<i.length;t++)r=i.words[t]+u,u=r>>26,this.words[t]=r&67108863;if(u===0&&t<i.length&&i!==this)for(;t<i.length;t++)this.words[t]=i.words[t];return this.length=Math.max(this.length,t),i!==this&&(this.sign=!0),this.strip()};i.prototype.sub=function(n){return this.clone().isub(n)};i.prototype._smallMulTo=function(n,t){var r,i,f;for(t.sign=n.sign!==this.sign,t.length=this.length+n.length,r=0,i=0;i<t.length-1;i++){var u=r>>>26,o=r&67108863,h=Math.min(i,n.length-1);for(f=Math.max(0,i-this.length+1);f<=h;f++){var c=i-f,l=this.words[c]|0,a=n.words[f]|0,s=l*a,e=s&67108863;u=u+(s/67108864|0)|0;e=e+o|0;o=e&67108863;u=u+(e>>>26)|0}t.words[i]=o;r=u}return r!==0?t.words[i]=r:t.length--,t.strip()};i.prototype._bigMulTo=function(n,t){var u,f,r,i,o,h,e;for(t.sign=n.sign!==this.sign,t.length=this.length+n.length,u=0,f=0,r=0;r<t.length-1;r++){for(i=f,f=0,o=u&67108863,h=Math.min(r,n.length-1),e=Math.max(0,r-this.length+1);e<=h;e++){var l=r-e,a=this.words[l]|0,v=n.words[e]|0,c=a*v,s=c&67108863;i=i+(c/67108864|0)|0;s=s+o|0;o=s&67108863;i=i+(s>>>26)|0;f+=i>>>26;i&=67108863}t.words[r]=o;u=i;i=f}return u!==0?t.words[r]=u:t.length--,t.strip()};i.prototype.mulTo=function(n,t){return this.length+n.length<63?this._smallMulTo(n,t):this._bigMulTo(n,t)};i.prototype.mul=function(n){var t=new i(null);return t.words=new Array(this.length+n.length),this.mulTo(n,t)};i.prototype.imul=function(n){var s,h,t,u,i,r,o;if(this.cmpn(0)===0||n.cmpn(0)===0)return this.words[0]=0,this.length=1,this;for(s=this.length,h=n.length,this.sign=n.sign!==this.sign,this.length=this.length+n.length,this.words[this.length-1]=0,t=this.length-2;t>=0;t--){var i=0,f=0,l=Math.min(t,h-1);for(u=Math.max(0,t-s+1);u<=l;u++){var r=t-u,a=this.words[r],v=n.words[u],c=a*v,e=c&67108863;i+=c/67108864|0;e+=f;f=e&67108863;i+=e>>>26}this.words[t]=f;this.words[t+1]+=i;i=0}for(i=0,r=1;r<this.length;r++)o=this.words[r]+i,this.words[r]=o&67108863,i=o>>>26;return this.strip()};i.prototype.imuln=function(n){var t,i,u,f;for(r(typeof n=="number"),t=0,i=0;i<this.length;i++)u=this.words[i]*n,f=(u&67108863)+(t&67108863),t>>=26,t+=u/67108864|0,t+=f>>>26,this.words[i]=f&67108863;return t!==0&&(this.words[i]=t,this.length++),this};i.prototype.muln=function(n){return this.clone().imuln(n)};i.prototype.sqr=function(){return this.mul(this)};i.prototype.isqr=function(){return this.mul(this)};i.prototype.ishln=function(n){var u,e,o,t;r(typeof n=="number"&&n>=0);var i=n%26,f=(n-i)/26,s=67108863>>>26-i<<26-i;if(i!==0){for(u=0,t=0;t<this.length;t++)e=this.words[t]&s,o=this.words[t]-e<<i,this.words[t]=o|u,u=e>>>26-i;u&&(this.words[t]=u,this.length++)}if(f!==0){for(t=this.length-1;t>=0;t--)this.words[t+f]=this.words[t];for(t=0;t<f;t++)this.words[t]=0;this.length+=f}return this.strip()};i.prototype.ishrn=function(n,t,i){var s,o,u,c;r(typeof n=="number"&&n>=0);s=t?(t-t%26)/26:0;var h=n%26,f=Math.min((n-h)/26,this.length),l=67108863^67108863>>>h<<h,e=i;if(s-=f,s=Math.max(0,s),e){for(u=0;u<f;u++)e.words[u]=this.words[u];e.length=f}if(f!==0)if(this.length>f)for(this.length-=f,u=0;u<this.length;u++)this.words[u]=this.words[u+f];else this.words[0]=0,this.length=1;for(o=0,u=this.length-1;u>=0&&(o!==0||u>=s);u--)c=this.words[u],this.words[u]=o<<26-h|c>>>h,o=c&l;return e&&o!==0&&(e.words[e.length++]=o),this.length===0&&(this.words[0]=0,this.length=1),this.strip(),this};i.prototype.shln=function(n){return this.clone().ishln(n)};i.prototype.shrn=function(n){return this.clone().ishrn(n)};i.prototype.testn=function(n){var u;r(typeof n=="number"&&n>=0);var t=n%26,i=(n-t)/26,f=1<<t;return this.length<=i?!1:(u=this.words[i],!!(u&f))};i.prototype.imaskn=function(n){var t,i,u;return r(typeof n=="number"&&n>=0),t=n%26,i=(n-t)/26,r(!this.sign,"imaskn works only with positive numbers"),t!==0&&i++,this.length=Math.min(i,this.length),t!==0&&(u=67108863^67108863>>>t<<t,this.words[this.length-1]&=u),this.strip()};i.prototype.maskn=function(n){return this.clone().imaskn(n)};i.prototype.iaddn=function(n){return(r(typeof n=="number"),n<0)?this.isubn(-n):this.sign?this.length===1&&this.words[0]<n?(this.words[0]=n-this.words[0],this.sign=!1,this):(this.sign=!1,this.isubn(n),this.sign=!0,this):this._iaddn(n)};i.prototype._iaddn=function(n){this.words[0]+=n;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this};i.prototype.isubn=function(n){if(r(typeof n=="number"),n<0)return this.iaddn(-n);if(this.sign)return this.sign=!1,this.iaddn(n),this.sign=!0,this;this.words[0]-=n;for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()};i.prototype.addn=function(n){return this.clone().iaddn(n)};i.prototype.subn=function(n){return this.clone().isubn(n)};i.prototype.iabs=function(){return this.sign=!1,this};i.prototype.abs=function(){return this.clone().iabs()};i.prototype._ishlnsubmul=function(n,t,i){var o=n.length+i,s,f,h,u,e;if(this.words.length<o){for(s=new Array(o),u=0;u<this.length;u++)s[u]=this.words[u];this.words=s}else u=this.length;for(this.length=Math.max(this.length,o);u<this.length;u++)this.words[u]=0;for(f=0,u=0;u<n.length;u++)e=this.words[u+i]+f,h=n.words[u]*t,e-=h&67108863,f=(e>>26)-(h/67108864|0),this.words[u+i]=e&67108863;for(;u<this.length-i;u++)e=this.words[u+i]+f,f=e>>26,this.words[u+i]=e&67108863;if(f===0)return this.strip();for(r(f===-1),f=0,u=0;u<this.length;u++)e=-this.words[u]+f,f=e>>26,this.words[u]=e&67108863;return this.sign=!0,this.strip()};i.prototype._wordDiv=function(n,t){var o=this.length-n.length,r=this.clone(),f=n,l=f.words[f.length-1],v=this._countBits(l),h,u,c,a,e,s;if(o=26-v,o!==0&&(f=f.shln(o),r.ishln(o),l=f.words[f.length-1]),h=r.length-f.length,t!=="mod")for(u=new i(null),u.length=h+1,u.words=new Array(u.length),c=0;c<u.length;c++)u.words[c]=0;for(a=r.clone()._ishlnsubmul(f,1,h),a.sign||(r=a,u&&(u.words[h]=1)),e=h-1;e>=0;e--){for(s=r.words[f.length+e]*67108864+r.words[f.length+e-1],s=Math.min(s/l|0,67108863),r._ishlnsubmul(f,s,e);r.sign;)s--,r.sign=!1,r._ishlnsubmul(f,1,e),r.cmpn(0)!==0&&(r.sign=!r.sign);u&&(u.words[e]=s)}return u&&u.strip(),r.strip(),t!=="div"&&o!==0&&r.ishrn(o),{div:u?u:null,mod:r}};i.prototype.divmod=function(n,t){var e,u,f;return(r(n.cmpn(0)!==0),this.sign&&!n.sign)?(u=this.neg().divmod(n,t),t!=="mod"&&(f=u.div.neg()),t!=="div"&&(e=u.mod.cmpn(0)===0?u.mod:n.sub(u.mod)),{div:f,mod:e}):!this.sign&&n.sign?(u=this.divmod(n.neg(),t),t!=="mod"&&(f=u.div.neg()),{div:f,mod:u.mod}):this.sign&&n.sign?this.neg().divmod(n.neg(),t):n.length>this.length||this.cmp(n)<0?{div:new i(0),mod:this}:n.length===1?t==="div"?{div:this.divn(n.words[0]),mod:null}:t==="mod"?{div:null,mod:new i(this.modn(n.words[0]))}:{div:this.divn(n.words[0]),mod:new i(this.modn(n.words[0]))}:this._wordDiv(n,t)};i.prototype.div=function(n){return this.divmod(n,"div").div};i.prototype.mod=function(n){return this.divmod(n,"mod").mod};i.prototype.divRound=function(n){var t=this.divmod(n);if(t.mod.cmpn(0)===0)return t.div;var r=t.div.sign?t.mod.isub(n):t.mod,u=n.shrn(1),f=n.andln(1),i=r.cmp(u);return i<0||f===1&&i===0?t.div:t.div.sign?t.div.isubn(1):t.div.iaddn(1)};i.prototype.modn=function(n){var u,t,i;for(r(n<=67108863),u=67108864%n,t=0,i=this.length-1;i>=0;i--)t=(u*t+this.words[i])%n;return t};i.prototype.idivn=function(n){var i,t,u;for(r(n<=67108863),i=0,t=this.length-1;t>=0;t--)u=this.words[t]+i*67108864,this.words[t]=u/n|0,i=u%n;return this.strip()};i.prototype.divn=function(n){return this.clone().idivn(n)};i.prototype.egcd=function(n){var t,u,h,c;r(!n.sign);r(n.cmpn(0)!==0);t=this;u=n.clone();t=t.sign?t.mod(n):t.clone();for(var o=new i(1),s=new i(0),f=new i(0),e=new i(1),l=0;t.isEven()&&u.isEven();)t.ishrn(1),u.ishrn(1),++l;for(h=u.clone(),c=t.clone();t.cmpn(0)!==0;){while(t.isEven())t.ishrn(1),o.isEven()&&s.isEven()?(o.ishrn(1),s.ishrn(1)):(o.iadd(h).ishrn(1),s.isub(c).ishrn(1));while(u.isEven())u.ishrn(1),f.isEven()&&e.isEven()?(f.ishrn(1),e.ishrn(1)):(f.iadd(h).ishrn(1),e.isub(c).ishrn(1));t.cmp(u)>=0?(t.isub(u),o.isub(f),s.isub(e)):(u.isub(t),f.isub(o),e.isub(s))}return{a:f,b:e,gcd:u.ishln(l)}};i.prototype._invmp=function(n){var t,u;r(!n.sign);r(n.cmpn(0)!==0);t=this;u=n.clone();t=t.sign?t.mod(n):t.clone();for(var f=new i(1),e=new i(0),o=u.clone();t.cmpn(1)>0&&u.cmpn(1)>0;){while(t.isEven())t.ishrn(1),f.isEven()?f.ishrn(1):f.iadd(o).ishrn(1);while(u.isEven())u.ishrn(1),e.isEven()?e.ishrn(1):e.iadd(o).ishrn(1);t.cmp(u)>=0?(t.isub(u),f.isub(e)):(u.isub(t),e.isub(f))}return t.cmpn(1)===0?f:e};i.prototype.gcd=function(n){var i,t,r,u,f;if(this.cmpn(0)===0)return n.clone();if(n.cmpn(0)===0)return this.clone();for(i=this.clone(),t=n.clone(),i.sign=!1,t.sign=!1,r=0;i.isEven()&&t.isEven();r++)i.ishrn(1),t.ishrn(1);do{while(i.isEven())i.ishrn(1);while(t.isEven())t.ishrn(1);if(u=i.cmp(t),u<0)f=i,i=t,t=f;else if(u===0||t.cmpn(1)===0)break;i.isub(t)}while(1);return t.ishln(r)};i.prototype.invm=function(n){return this.egcd(n).a.mod(n)};i.prototype.isEven=function(){return(this.words[0]&1)==0};i.prototype.isOdd=function(){return(this.words[0]&1)==1};i.prototype.andln=function(n){return this.words[0]&n};i.prototype.bincn=function(n){var i,t,f;r(typeof n=="number");var e=n%26,u=(n-e)/26,o=1<<e;if(this.length<=u){for(t=this.length;t<u+1;t++)this.words[t]=0;return this.words[u]|=o,this.length=u+1,this}for(i=o,t=u;i!==0&&t<this.length;t++)f=this.words[t],f+=i,i=f>>>26,f&=67108863,this.words[t]=f;return i!==0&&(this.words[t]=i,this.length++),this};i.prototype.cmpn=function(n){var i=n<0,t,r;return(i&&(n=-n),this.sign&&!i)?-1:!this.sign&&i?1:(n&=67108863,this.strip(),this.length>1?t=1:(r=this.words[0],t=r===n?0:r<n?-1:1),this.sign&&(t=-t),t)};i.prototype.cmp=function(n){if(this.sign&&!n.sign)return-1;if(!this.sign&&n.sign)return 1;var t=this.ucmp(n);return this.sign?-t:t};i.prototype.ucmp=function(n){var i,t,r,u;if(this.length>n.length)return 1;if(this.length<n.length)return-1;for(i=0,t=this.length-1;t>=0;t--)if(r=this.words[t],u=n.words[t],r!==u){r<u?i=-1:r>u&&(i=1);break}return i};i.red=function(n){return new u(n)};i.prototype.toRed=function(n){return r(!this.red,"Already a number in reduction context"),r(!this.sign,"red works only with positives"),n.convertTo(this)._forceRed(n)};i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)};i.prototype._forceRed=function(n){return this.red=n,this};i.prototype.forceRed=function(n){return r(!this.red,"Already a number in reduction context"),this._forceRed(n)};i.prototype.redAdd=function(n){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,n)};i.prototype.redIAdd=function(n){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)};i.prototype.redSub=function(n){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,n)};i.prototype.redISub=function(n){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,n)};i.prototype.redShl=function(n){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,n)};i.prototype.redMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.mul(this,n)};i.prototype.redIMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.imul(this,n)};i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)};i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)};i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)};i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)};i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)};i.prototype.redPow=function(n){return r(this.red&&!n.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,n)};s={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var n=new i(null);return n.words=new Array(Math.ceil(this.n/13)),n};f.prototype.ireduce=function(n){var t=n,i,r;do this.split(t,this.tmp),t=this.imulK(t),t=t.iadd(this.tmp),i=t.bitLength();while(i>this.n);return r=i<this.n?-1:t.ucmp(this.p),r===0?(t.words[0]=0,t.length=1):r>0?t.isub(this.p):t.strip(),t};f.prototype.split=function(n,t){n.ishrn(this.n,0,t)};f.prototype.imulK=function(n){return n.imul(this.k)};o(h,f);h.prototype.split=function(n,t){for(var r,u,f=4194303,e=Math.min(n.length,9),i=0;i<e;i++)t.words[i]=n.words[i];if(t.length=e,n.length<=9){n.words[0]=0;n.length=1;return}for(r=n.words[9],t.words[t.length++]=r&f,i=10;i<n.length;i++)u=n.words[i],n.words[i-10]=(u&f)<<4|r>>>22,r=u;n.words[i-10]=r>>>22;n.length-=9};h.prototype.imulK=function(n){var r,t,i,u;for(n.words[n.length]=0,n.words[n.length+1]=0,n.length+=2,t=0,i=0;i<n.length;i++)u=n.words[i],r=u*64,t+=u*977,r+=t/67108864|0,t&=67108863,n.words[i]=t,t=r;return n.words[n.length-1]===0&&(n.length--,n.words[n.length-1]===0&&n.length--),n};o(y,f);o(p,f);o(c,f);c.prototype.imulK=function(n){for(var r,u,t=0,i=0;i<n.length;i++)r=n.words[i]*19+t,u=r&67108863,r>>>=26,n.words[i]=u,t=r;return t!==0&&(n.words[n.length++]=t),n};i._prime=function(n){if(s[n])return s[n];var t;if(n==="k256")t=new h;else if(n==="p224")t=new y;else if(n==="p192")t=new p;else if(n==="p25519")t=new c;else throw new Error("Unknown prime "+n);return s[n]=t,t};u.prototype._verify1=function(n){r(!n.sign,"red works only with positives");r(n.red,"red works only with red numbers")};u.prototype._verify2=function(n,t){r(!n.sign&&!t.sign,"red works only with positives");r(n.red&&n.red===t.red,"red works only with red numbers")};u.prototype.imod=function(n){return this.prime?this.prime.ireduce(n)._forceRed(this):n.mod(this.m)._forceRed(this)};u.prototype.neg=function(n){var t=n.clone();return t.sign=!t.sign,t.iadd(this.m)._forceRed(this)};u.prototype.add=function(n,t){this._verify2(n,t);var i=n.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)};u.prototype.iadd=function(n,t){this._verify2(n,t);var i=n.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i};u.prototype.sub=function(n,t){this._verify2(n,t);var i=n.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)};u.prototype.isub=function(n,t){this._verify2(n,t);var i=n.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i};u.prototype.shl=function(n,t){return this._verify1(n),this.imod(n.shln(t))};u.prototype.imul=function(n,t){return this._verify2(n,t),this.imod(n.imul(t))};u.prototype.mul=function(n,t){return this._verify2(n,t),this.imod(n.mul(t))};u.prototype.isqr=function(n){return this.imul(n,n)};u.prototype.sqr=function(n){return this.mul(n,n)};u.prototype.sqrt=function(n){var h,p,f,t,c,s,e,y;if(n.cmpn(0)===0)return n.clone();if(h=this.m.andln(3),r(h%2==1),h===3)return p=this.m.add(new i(1)).ishrn(2),f=this.pow(n,p),f;for(t=this.m.subn(1),c=0;t.cmpn(0)!==0&&t.andln(1)===0;)c++,t.ishrn(1);r(t.cmpn(0)!==0);for(var l=new i(1).toRed(this),w=l.redNeg(),b=this.m.subn(1).ishrn(1),u=this.m.bitLength(),u=new i(2*u*u).toRed(this);this.pow(u,b).cmp(w)!==0;)u.redIAdd(w);for(var a=this.pow(u,t),f=this.pow(n,t.addn(1).ishrn(1)),o=this.pow(n,t),v=c;o.cmp(l)!==0;){for(s=o,e=0;s.cmp(l)!==0;e++)s=s.redSqr();r(e<v);y=this.pow(a,new i(1).ishln(v-e-1));f=f.redMul(y);a=y.redSqr();o=o.redMul(a);v=e}return f};u.prototype.invm=function(n){var t=n._invmp(this.m);return t.sign?(t.sign=!1,this.imod(t).redNeg()):this.imod(t)};u.prototype.pow=function(n,t){var e=[],f,u,r;if(t.cmpn(0)===0)return new i(1);for(r=t.clone();r.cmpn(0)!==0;)e.push(r.andln(1)),r.ishrn(1);for(f=n,u=0;u<e.length;u++,f=this.sqr(f))if(e[u]!==0)break;if(++u<e.length)for(r=this.sqr(f);u<e.length;u++,r=this.sqr(r))e[u]!==0&&(f=this.mul(f,r));return f};u.prototype.convertTo=function(n){var t=n.mod(this.m);return t===n?t.clone():t};u.prototype.convertFrom=function(n){var t=n.clone();return t.red=null,t};i.mont=function(n){return new e(n)};o(e,u);e.prototype.convertTo=function(n){return this.imod(n.shln(this.shift))};e.prototype.convertFrom=function(n){var t=this.imod(n.mul(this.rinv));return t.red=null,t};e.prototype.imul=function(n,t){if(n.cmpn(0)===0||t.cmpn(0)===0)return n.words[0]=0,n.length=1,n;var u=n.imul(t),f=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=u.isub(f).ishrn(this.shift),r=i;return i.cmp(this.m)>=0?r=i.isub(this.m):i.cmpn(0)<0&&(r=i.iadd(this.m)),r._forceRed(this)};e.prototype.mul=function(n,t){if(n.cmpn(0)===0||t.cmpn(0)===0)return new i(0)._forceRed(this);var f=n.mul(t),e=f.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=f.isub(e).ishrn(this.shift),u=r;return r.cmp(this.m)>=0?u=r.isub(this.m):r.cmpn(0)<0&&(u=r.iadd(this.m)),u._forceRed(this)};e.prototype.invm=function(n){var t=this.imod(n._invmp(this.m).mul(this.r2));return t._forceRed(this)}})(typeof t=="undefined"||t,this)},{}],96:[function(n,t){"use strict";function r(n){return i(n[0])*i(n[1])}var i=n("./lib/bn-sign");t.exports=r},{"./lib/bn-sign":87}],97:[function(n,t){"use strict";function r(n,t){return i(n[0].mul(t[1]).sub(n[1].mul(t[0])),n[1].mul(t[1]))}var i=n("./lib/rationalize");t.exports=r},{"./lib/rationalize":92}],98:[function(n,t){"use strict";function u(n){var h=n[0],e=n[1],s,f,t;if(h.cmpn(0)===0)return 0;var c=h.divmod(e),l=c.div,u=i(l),o=c.mod;return o.cmpn(0)===0?u:u?(s=r(u)+4,t=i(o.shln(s).divRound(e)),u<0&&(t=-t),u+t*Math.pow(2,-s)):(f=e.bitLength()-o.bitLength()+53,t=i(o.shln(f).divRound(e)),f<1023)?t*Math.pow(2,-f):(t*=Math.pow(2,-1023),t*Math.pow(2,1023-f))}var i=n("./lib/bn-to-num"),r=n("./lib/ctz");t.exports=u},{"./lib/bn-to-num":88,"./lib/ctz":89}],99:[function(n,t){"use strict";function h(n,t){for(var i=0;i<n;++i)if(!(t[i]<=t[i+n]))return!0;return!1}function e(n,t,i,r){for(var e,f,s=0,o=0,u=0,c=n.length;u<c;++u)if(e=n[u],!h(t,e)){for(f=0;f<2*t;++f)i[s++]=e[f];r[o++]=u}return o}function f(n,t,r,f){var o=n.length,c=t.length,h,p,l,a,v,y;if(!(o<=0)&&!(c<=0))return(h=n[0].length>>>1,h<=0)?void 0:(l=i.mallocDouble(2*h*o),a=i.mallocInt32(o),o=e(n,h,l,a),o>0&&(h===1&&f?(u.init(o),p=u.sweepComplete(h,r,0,o,l,a,0,o,l,a)):(v=i.mallocDouble(2*h*c),y=i.mallocInt32(c),c=e(t,h,v,y),c>0&&(u.init(o+c),p=h===1?u.sweepBipartite(h,r,0,o,l,a,0,c,v,y):s(h,r,f,o,l,a,c,v,y),i.free(v),i.free(y))),i.free(l),i.free(a)),p)}function o(n,t){r.push([n,t])}function c(n){return r=[],f(n,n,o,!0),r}function l(n,t){return r=[],f(n,t,o,!1),r}function a(n,t,i){switch(arguments.length){case 1:return c(n);case 2:return typeof t=="function"?f(n,n,t,!0):l(n,t);case 3:return f(n,t,i,!1);default:throw new Error("box-intersect: Invalid arguments");}}var r;t.exports=a;var i=n("typedarray-pool"),u=n("./lib/sweep"),s=n("./lib/intersect")},{"./lib/intersect":101,"./lib/sweep":105,"typedarray-pool":550}],100:[function(n,t,i){"use strict";function tt(n,t,i){var nt="bruteForce"+(n?"Red":"Blue")+(t?"Flip":"")+(i?"Full":""),a=["function ",nt,"(",b.join(),"){","var ",o,"=2*",r,";"],tt="for(var i="+c+","+f+"="+o+"*"+c+";i<"+v+";++i,"+f+"+="+o+"){var x0="+s+"["+u+"+"+f+"],x1="+s+"["+u+"+"+f+"+"+r+"],xi="+d+"[i];",it="for(var j="+l+","+e+"="+o+"*"+l+";j<"+y+";++j,"+e+"+="+o+"){var y0="+h+"["+u+"+"+e+"],"+(i?"y1="+h+"["+u+"+"+e+"+"+r+"],":"")+"yi="+g+"[j];";return n?a.push(tt,w,":",it):a.push(it,w,":",tt),i?a.push("if(y1<x0||x1<y0)continue;"):t?a.push("if(y0<=x0||x1<y0)continue;"):a.push("if(y0<x0||x1<y0)continue;"),a.push("for(var k="+u+"+1;k<"+r+";++k){var r0="+s+"[k+"+f+"],r1="+s+"[k+"+r+"+"+f+"],b0="+h+"[k+"+e+"],b1="+h+"[k+"+r+"+"+e+"];if(r1<b0||b1<r0)continue "+w+";}var "+p+"="+k+"("),t?a.push("yi,xi"):a.push("xi,yi"),a.push(");if("+p+"!==void 0)return "+p+";}}}"),{name:nt,code:a.join("")}}function nt(n){function i(i,r){var f=tt(i,r,n);u.push(f.code);t.push("return "+f.name+"("+b.join()+");")}var r="bruteForce"+(n?"Full":"Partial"),u=[],f=b.slice(),t,e,o;return n||f.splice(3,0,a),t=["function "+r+"("+f.join()+"){"],t.push("if("+v+"-"+c+">"+y+"-"+l+"){"),n?(i(!0,!1),t.push("}else{"),i(!1,!1)):(t.push("if("+a+"){"),i(!0,!0),t.push("}else{"),i(!0,!1),t.push("}}else{if("+a+"){"),i(!1,!0),t.push("}else{"),i(!1,!1),t.push("}")),t.push("}}return "+r),e=u.join("")+t.join(""),o=new Function(e),o()}var r="d",u="ax",k="vv",a="fp",o="es",c="rs",v="re",s="rb",d="ri",f="rp",l="bs",y="be",h="bb",g="bi",e="bp",p="rv",w="Q",b=[r,u,k,c,v,s,d,l,y,h,g];i.partial=nt(!1);i.full=nt(!0)},{}],101:[function(n,t){"use strict";function ut(n,t){var u=8*s.log2(t+1)*(n+1)|0,o=s.nextPow2(h*u),r;i.length<o&&(e.free(i),i=e.mallocInt32(o));r=s.nextPow2(c*u);f<r&&(e.free(f),f=e.mallocDouble(r))}function r(n,t,r,u,e,o,s,l,a){var v=h*n,y;i[v]=t;i[v+1]=r;i[v+2]=u;i[v+3]=e;i[v+4]=o;i[v+5]=s;y=c*n;f[y]=l;f[y+1]=a}function ft(n,t,i,r,u,f,e,o,s,h,c){var p=2*n,w=s*p,b=h[w+t],v,a,y,k,d,l,g;n:for(v=u,a=u*p;v<f;++v,a+=p)if((y=e[a+t],k=e[a+t+n],!(b<y)&&!(k<b))&&(!r||b!==y)){for(d=o[v],l=t+1;l<n;++l){var y=e[a+l],k=e[a+l+n],nt=h[w+l],tt=h[w+l+n];if(k<nt||tt<y)continue n}if(g=r?i(c,d):i(d,c),g!==void 0)return g}}function et(n,t,i,r,u,f,e,o,s,h){var v=2*n,y=o*v,d=s[y+t],a,l,p,w,b,c,k;n:for(a=r,l=r*v;a<u;++a,l+=v)if((p=e[a],p!==h)&&(w=f[l+t],b=f[l+t+n],!(d<w)&&!(b<d))){for(c=t+1;c<n;++c){var w=f[l+c],b=f[l+c+n],g=s[y+c],nt=s[y+c+n];if(b<g||nt<w)continue n}if(k=i(p,h),k!==void 0)return k}}function ot(n,t,e,o,s,l,p,ot,st){var bt,vi,lt,si,ci,ct,gt,ui;for(ut(n,o+p),bt=0,vi=2*n,r(bt++,0,0,o,0,p,e?16:0,-Infinity,Infinity),e||r(bt++,0,0,p,0,o,1,-Infinity,Infinity);bt>0;){bt-=1;var ei=bt*h,ht=i[ei],wt=i[ei+1],pt=i[ei+2],ri=i[ei+3],ni=i[ei+4],hi=i[ei+5],yi=bt*c,li=f[yi],ai=f[yi+1],ti=hi&1,oi=!!(hi&16),at=s,vt=l,kt=ot,dt=st;if((ti&&(at=ot,vt=st,kt=s,dt=l),!(hi&2)||(pt=tt(n,ht,wt,pt,at,vt,ai),!(wt>=pt)))&&(!(hi&4)||(wt=it(n,ht,wt,pt,at,vt,li),!(wt>=pt)))){if(si=pt-wt,ci=ni-ri,oi){if(n*si*(si+ci)<g){if(lt=u.scanComplete(n,ht,t,wt,pt,at,vt,ri,ni,kt,dt),lt!==void 0)return lt;continue}}else if(n*Math.min(si,ci)<a){if(lt=w(n,ht,t,ti,wt,pt,at,vt,ri,ni,kt,dt),lt!==void 0)return lt;continue}else if(n*si*ci<d){if(lt=u.scanBipartite(n,ht,t,ti,wt,pt,at,vt,ri,ni,kt,dt),lt!==void 0)return lt;continue}if(ct=nt(n,ht,wt,pt,at,vt,li,ai),wt<ct)if(n*(ct-wt)<a){if(lt=b(n,ht+1,t,wt,ct,at,vt,ri,ni,kt,dt),lt!==void 0)return lt}else if(ht===n-2){if(lt=ti?u.sweepBipartite(n,t,ri,ni,kt,dt,wt,ct,at,vt):u.sweepBipartite(n,t,wt,ct,at,vt,ri,ni,kt,dt),lt!==void 0)return lt}else r(bt++,ht+1,wt,ct,ri,ni,ti,-Infinity,Infinity),r(bt++,ht+1,ri,ni,wt,ct,ti^1,-Infinity,Infinity);if(ct<pt){var yt=k(n,ht,ri,ni,kt,dt),fi=kt[vi*yt+ht],ii=v(n,ht,yt,ni,kt,dt,fi);if(ii<ni&&r(bt++,ht,ct,pt,ii,ni,(ti|4)+(oi?16:0),fi,ai),ri<yt&&r(bt++,ht,ct,pt,ri,yt,(ti|2)+(oi?16:0),li,fi),yt+1===ii){if(lt=oi?et(n,ht,t,ct,pt,at,vt,yt,kt,dt[yt]):ft(n,ht,t,ti,ct,pt,at,vt,yt,kt,dt[yt]),lt!==void 0)return lt}else if(yt<ii)if(oi){if(gt=y(n,ht,ct,pt,at,vt,fi),ct<gt)if(ui=v(n,ht,ct,gt,at,vt,fi),ht===n-2){if(ct<ui&&(lt=u.sweepComplete(n,t,ct,ui,at,vt,yt,ii,kt,dt),lt!==void 0)||ui<gt&&(lt=u.sweepBipartite(n,t,ui,gt,at,vt,yt,ii,kt,dt),lt!==void 0))return lt}else ct<ui&&r(bt++,ht+1,ct,ui,yt,ii,16,-Infinity,Infinity),ui<gt&&(r(bt++,ht+1,ui,gt,yt,ii,0,-Infinity,Infinity),r(bt++,ht+1,yt,ii,ui,gt,1,-Infinity,Infinity))}else gt=ti?rt(n,ht,ct,pt,at,vt,fi):y(n,ht,ct,pt,at,vt,fi),ct<gt&&(ht===n-2?lt=ti?u.sweepBipartite(n,t,yt,ii,kt,dt,ct,gt,at,vt):u.sweepBipartite(n,t,ct,gt,at,vt,yt,ii,kt,dt):(r(bt++,ht+1,ct,gt,yt,ii,ti,-Infinity,Infinity),r(bt++,ht+1,yt,ii,ct,gt,ti^1,-Infinity,Infinity)))}}}}t.exports=ot;var e=n("typedarray-pool"),s=n("bit-twiddle"),l=n("./brute"),w=l.partial,b=l.full,u=n("./sweep"),k=n("./median"),o=n("./partition"),a=128,d=4194304,g=4194304,nt=o("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),v=o("lo===p0",["p0"]),tt=o("lo<p0",["p0"]),it=o("hi<=p0",["p0"]),y=o("lo<=p0&&p0<=hi",["p0"]),rt=o("lo<p0&&p0<=hi",["p0"]),h=6,c=2,p=1024,i=e.mallocInt32(p),f=e.mallocDouble(p)},{"./brute":100,"./median":102,"./partition":103,"./sweep":105,"bit-twiddle":56,"typedarray-pool":550}],102:[function(n,t){"use strict";function f(n,t,i,r,u,f){for(var y,e,s,c,l,a,p,w,o=2*n,v=o*(i+1)+t,h=i+1;h<r;++h,v+=o)for(y=u[v],e=h,s=o*(h-1);e>i&&u[s+t]>y;--e,s-=o){for(c=s,l=s+o,a=0;a<o;++a,++c,++l)p=u[c],u[c]=u[l],u[l]=p;w=f[e];f[e]=f[e-1];f[e-1]=w}}function e(n,t,r,e,o,s){var y,p,k,nt,tt;if(e<=r+1)return r;for(var a=r,h=e,w=e+r>>>1,l=2*n,c=w,v=o[l*w+t];a<h;){if(h-a<u){f(n,t,a,h,o,s);v=o[l*w+t];break}var it=h-a,rt=Math.random()*it+a|0,d=o[l*rt+t],ut=Math.random()*it+a|0,g=o[l*ut+t],ft=Math.random()*it+a|0,b=o[l*ft+t];for(d<=g?b>=g?(c=ut,v=g):d>=b?(c=rt,v=d):(c=ft,v=b):g>=b?(c=ut,v=g):b>=d?(c=rt,v=d):(c=ft,v=b),y=l*(h-1),p=l*c,k=0;k<l;++k,++y,++p)nt=o[y],o[y]=o[p],o[p]=nt;for(tt=s[h-1],s[h-1]=s[c],s[c]=tt,c=i(n,t,a,h-1,o,s,v),y=l*(h-1),p=l*c,k=0;k<l;++k,++y,++p)nt=o[y],o[y]=o[p],o[p]=nt;if(tt=s[h-1],s[h-1]=s[c],s[c]=tt,w<c){for(h=c-1;a<h&&o[l*(h-1)+t]===v;)h-=1;h+=1}else if(c<w)for(a=c+1;a<h&&o[l*a+t]===v;)a+=1;else break}return i(n,t,r,w,o,s,o[l*w+t])}t.exports=e;var r=n("./partition"),i=r("lo<p0",["p0"]),u=8},{"./partition":103}],103:[function(n,t){"use strict";function r(n,t){var u="abcdef".split("").concat(t),r=[];return n.indexOf("lo")>=0&&r.push("lo=e[k+n]"),n.indexOf("hi")>=0&&r.push("hi=e[k+o]"),u.push(i.replace("_",r.join()).replace("$",n)),Function.apply(void 0,u)}t.exports=r;var i="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m"},{}],104:[function(n,t){"use strict";function c(n,t){t<=4*r?u(0,t-1,n):e(0,t-1,n)}function u(n,t,i){for(var u,s,f=2*(n+1),e=n+1;e<=t;++e){for(var o=i[f++],h=i[f++],c=e,r=f-2;c-->n;){if(u=i[r-2],s=i[r-1],u<o)break;else if(u===o&&s<h)break;i[r]=u;i[r+1]=s;r-=2}i[r]=o;i[r+1]=h}}function o(n,t,i){n*=2;t*=2;var r=i[n],u=i[n+1];i[n]=i[t];i[n+1]=i[t+1];i[t]=r;i[t+1]=u}function s(n,t,i){n*=2;t*=2;i[n]=i[t];i[n+1]=i[t+1]}function l(n,t,i,r){n*=2;t*=2;i*=2;var u=r[n],f=r[n+1];r[n]=r[t];r[n+1]=r[t+1];r[t]=r[i];r[t+1]=r[i+1];r[i]=u;r[i+1]=f}function h(n,t,i,r,u){n*=2;t*=2;u[n]=u[t];u[t]=i;u[n+1]=u[t+1];u[t+1]=r}function i(n,t,i){n*=2;t*=2;var r=i[n],u=i[t];return r<u?!1:r===u?i[n+1]>i[t+1]:!0}function f(n,t,i,r){n*=2;var u=r[n];return u<t?!0:u===t?r[n+1]<i:!1}function e(n,t,c){var tt=(t-n+1)/6|0,ot=n+tt,st=t-tt,it=n+t>>1,ht=it-tt,ct=it+tt,k=ot,y=ht,w=it,p=ct,d=st,b=n+1,v=t-1,a=0,nt,g;i(k,y,c)&&(a=k,k=y,y=a);i(p,d,c)&&(a=p,p=d,d=a);i(k,w,c)&&(a=k,k=w,w=a);i(y,w,c)&&(a=y,y=w,w=a);i(k,p,c)&&(a=k,k=p,p=a);i(w,p,c)&&(a=w,w=p,p=a);i(y,d,c)&&(a=y,y=d,d=a);i(y,w,c)&&(a=y,y=w,w=a);i(p,d,c)&&(a=p,p=d,d=a);var rt=c[2*y],ut=c[2*y+1],ft=c[2*p],et=c[2*p+1],lt=2*k,at=2*w,vt=2*d,yt=2*ot,pt=2*it,wt=2*st;for(nt=0;nt<2;++nt){var bt=c[lt+nt],kt=c[at+nt],dt=c[vt+nt];c[yt+nt]=bt;c[pt+nt]=kt;c[wt+nt]=dt}for(s(ht,n,c),s(ct,t,c),g=b;g<=v;++g)if(f(g,rt,ut,c))g!==b&&o(g,b,c),++b;else if(!f(g,ft,et,c))for(;;)if(f(v,ft,et,c)){f(v,rt,ut,c)?(l(g,b,v,c),++b,--v):(o(g,v,c),--v);break}else{if(--v<g)break;continue}h(n,b-1,rt,ut,c);h(t,v+1,ft,et,c);b-2-n<=r?u(n,b-2,c):e(n,b-2,c);t-(v+2)<=r?u(v+2,t,c):e(v+2,t,c);v-b<=r?u(b,v,c):e(b,v,c)}t.exports=c;var r=32},{}],105:[function(n,t){"use strict";function w(n){var t=p.nextPow2(n),f;u.length<t&&(r.free(u),u=r.mallocInt32(t));e.length<t&&(r.free(e),e=r.mallocInt32(t));o.length<t&&(r.free(o),o=r.mallocInt32(t));h.length<t&&(r.free(h),h=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));v.length<t&&(r.free(v),v=r.mallocInt32(t));f=8*t;i.length<f&&(r.free(i),i=r.mallocDouble(f))}function l(n,t,i,r){var u=t[r],f=n[i-1];n[u]=f;t[f]=u}function a(n,t,i,r){n[i]=r;t[r]=i}function b(n,t,r,s,c,v,p,w,b,k){for(var ot,it,st,ht,ut,ft,d,tt,rt,nt=0,et=2*n,ct=n-1,lt=et-1,g=r;g<s;++g)it=v[g],ot=et*g,i[nt++]=c[ot+ct],i[nt++]=-(it+1),i[nt++]=c[ot+lt],i[nt++]=it;for(g=p;g<w;++g)it=k[g]+f,st=et*g,i[nt++]=b[st+ct],i[nt++]=-it,i[nt++]=b[st+lt],i[nt++]=it;for(ht=nt>>>1,y(i,ht),ut=0,ft=0,g=0;g<ht;++g)if(d=i[2*g+1]|0,d>=f)d=d-f|0,l(o,h,ft--,d);else if(d>=0)l(u,e,ut--,d);else if(d<=-f){for(d=-d-f|0,tt=0;tt<ut;++tt)if(rt=t(u[tt],d),rt!==void 0)return rt;a(o,h,ft++,d)}else{for(d=-d-1|0,tt=0;tt<ft;++tt)if(rt=t(d,o[tt]),rt!==void 0)return rt;a(u,e,ut++,d)}}function k(n,t,r,f,s,p,w,b,k,d){for(var ht,ft,ct,ot,et,it,nt,ut,tt,rt=0,st=2*n,yt=n-1,pt=st-1,g=r;g<f;++g)ft=p[g]+1<<1,ht=st*g,i[rt++]=s[ht+yt],i[rt++]=-ft,i[rt++]=s[ht+pt],i[rt++]=ft;for(g=w;g<b;++g)ft=d[g]+1<<1,ct=st*g,i[rt++]=k[ct+yt],i[rt++]=-ft|1,i[rt++]=k[ct+pt],i[rt++]=ft|1;ot=rt>>>1;y(i,ot);var lt=0,at=0,vt=0;for(g=0;g<ot;++g)if(et=i[2*g+1]|0,it=et&1,g<ot-1&&et>>1==i[2*g+3]>>1&&(it=2,g+=1),et<0){for(tt=-(et>>1)-1,nt=0;nt<vt;++nt)if(ut=t(c[nt],tt),ut!==void 0)return ut;if(it!==0)for(nt=0;nt<lt;++nt)if(ut=t(u[nt],tt),ut!==void 0)return ut;if(it!==1)for(nt=0;nt<at;++nt)if(ut=t(o[nt],tt),ut!==void 0)return ut;it===0?a(u,e,lt++,tt):it===1?a(o,h,at++,tt):it===2&&a(c,v,vt++,tt)}else tt=(et>>1)-1,it===0?l(u,e,lt--,tt):it===1?l(o,h,at--,tt):it===2&&l(c,v,vt--,tt)}function d(n,t,r,o,s,h,c,v,p,w,b,k){var nt=0,rt=2*n,pt=t,dt=t+n,ht=1,wt=1,ct,bt,lt,ut,d,ft,g,et,st,at,it,tt,vt,yt;for(o?wt=f:ht=f,d=s;d<h;++d)g=d+ht,ct=rt*d,i[nt++]=c[ct+pt],i[nt++]=-g,i[nt++]=c[ct+dt],i[nt++]=g;for(d=p;d<w;++d)g=d+wt,bt=rt*d,i[nt++]=b[bt+pt],i[nt++]=-g;for(lt=nt>>>1,y(i,lt),ut=0,d=0;d<lt;++d)if(ft=i[2*d+1]|0,ft<0)if(g=-ft,et=!1,g>=f?(et=!o,g-=f):(et=!!o,g-=1),et)a(u,e,ut++,g);else{var kt=k[g],ot=rt*g,gt=b[ot+t+1],ni=b[ot+t+1+n];n:for(st=0;st<ut;++st)if(at=u[st],it=rt*at,!(ni<c[it+t+1])&&!(c[it+t+1+n]<gt)){for(tt=t+2;tt<n;++tt)if(b[ot+tt+n]<c[it+tt]||c[it+tt+n]<b[ot+tt])continue n;if(vt=v[at],yt=o?r(kt,vt):r(vt,kt),yt!==void 0)return yt}}else l(u,e,ut--,ft-ht)}function g(n,t,r,e,o,s,h,c,l,a,v){for(var ut,ct,ft,g,it,et,ot,nt,st,w,k,b,d=0,tt=2*n,ht=t,at=t+n,p=e;p<o;++p)w=p+f,ut=tt*p,i[d++]=s[ut+ht],i[d++]=-w,i[d++]=s[ut+at],i[d++]=w;for(p=c;p<l;++p)w=p+1,ct=tt*p,i[d++]=a[ct+ht],i[d++]=-w;for(ft=d>>>1,y(i,ft),g=0,p=0;p<ft;++p)if(it=i[2*p+1]|0,it<0)if(w=-it,w>=f)u[g++]=w-f;else{w-=1;var lt=v[w],rt=tt*w,vt=a[rt+t+1],yt=a[rt+t+1+n];n:for(k=0;k<g;++k){if(et=u[k],ot=h[et],ot===lt)break;if(nt=tt*et,!(yt<s[nt+t+1])&&!(s[nt+t+1+n]<vt)){for(b=t+2;b<n;++b)if(a[rt+b+n]<s[nt+b]||s[nt+b+n]<a[rt+b])continue n;if(st=r(ot,lt),st!==void 0)return st}}}else{for(w=it-f,k=g-1;k>=0;--k)if(u[k]===w){for(b=k+1;b<g;++b)u[b-1]=u[b];break}--g}}t.exports={init:w,sweepBipartite:b,sweepComplete:k,scanBipartite:d,scanComplete:g};var r=n("typedarray-pool"),p=n("bit-twiddle"),y=n("./sort"),f=268435456,s=1024,u=r.mallocInt32(s),e=r.mallocInt32(s),o=r.mallocInt32(s),h=r.mallocInt32(s),c=r.mallocInt32(s),v=r.mallocInt32(s),i=r.mallocDouble(s*8)},{"./sort":104,"bit-twiddle":56,"typedarray-pool":550}],106:[function(n,t){(function(n){var f=!1,r,i,u;if(typeof Float64Array!="undefined")if(r=new Float64Array(1),i=new Uint32Array(r.buffer),r[0]=1,f=!0,i[1]===1072693248){t.exports=function(n){return r[0]=n,[i[0],i[1]]};function e(n,t){return i[0]=n,i[1]=t,r[0]}t.exports.pack=e;function o(n){return r[0]=n,i[0]}t.exports.lo=o;function s(n){return r[0]=n,i[1]}t.exports.hi=s}else if(i[0]===1072693248){t.exports=function(n){return r[0]=n,[i[1],i[0]]};function h(n,t){return i[1]=n,i[0]=t,r[0]}t.exports.pack=h;function c(n){return r[0]=n,i[1]}t.exports.lo=c;function l(n){return r[0]=n,i[0]}t.exports.hi=l}else f=!1;if(!f){u=new n(8);t.exports=function(n){return u.writeDoubleLE(n,0,!0),[u.readUInt32LE(0,!0),u.readUInt32LE(4,!0)]};function a(n,t){return u.writeUInt32LE(n,0,!0),u.writeUInt32LE(t,4,!0),u.readDoubleLE(0,!0)}t.exports.pack=a;function v(n){return u.writeDoubleLE(n,0,!0),u.readUInt32LE(0,!0)}t.exports.lo=v;function y(n){return u.writeDoubleLE(n,0,!0),u.readUInt32LE(4,!0)}t.exports.hi=y}t.exports.sign=function(n){return t.exports.hi(n)>>>31};t.exports.exponent=function(n){var i=t.exports.hi(n);return(i<<1>>>21)-1023};t.exports.fraction=function(n){var u=t.exports.lo(n),i=t.exports.hi(n),r=i&1048575;return i&2146435072&&(r+=1048576),[u,r]};t.exports.denormalized=function(n){var i=t.exports.hi(n);return!(i&2146435072)}}).call(this,n("buffer").Buffer)},{buffer:57}],107:[function(n,t){"use strict";function f(n,t){if(isNaN(n)||isNaN(t))return NaN;if(n===t)return n;if(n===0)return t<0?-r:r;var e=i.hi(n),f=i.lo(n);return t>n==n>0?f===u?(e+=1,f=0):f+=1:f===0?(f=u,e-=1):f-=1,i.pack(f,e)}var i=n("double-bits"),r=Math.pow(2,-1074),u=-1>>>0;t.exports=f},{"double-bits":106}],108:[function(n,t){"use strict";function r(n,t){for(var u=n.length,f=new Array(u),r=0;r<u;++r)f[r]=i(n[r],t[r]);return f}var i=n("big-rat/add");t.exports=r},{"big-rat/add":82}],109:[function(n,t){"use strict";function r(n){for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=i(n[t]);return r}t.exports=r;var i=n("big-rat")},{"big-rat":85}],110:[function(n,t){"use strict";function u(n,t){for(var o=i(t),f=n.length,e=new Array(f),u=0;u<f;++u)e[u]=r(n[u],o);return e}var i=n("big-rat"),r=n("big-rat/mul");t.exports=u},{"big-rat":85,"big-rat/mul":94}],111:[function(n,t){"use strict";function r(n,t){for(var u=n.length,f=new Array(u),r=0;r<u;++r)f[r]=i(n[r],t[r]);return f}var i=n("big-rat/sub");t.exports=r},{"big-rat/sub":97}],112:[function(n,t){"use strict";function r(n,t,i,r){for(var u=0;u<2;++u){var f=n[u],e=t[u],h=Math.min(f,e),c=Math.max(f,e),o=i[u],s=r[u],l=Math.min(o,s),a=Math.max(o,s);if(a<h||c<l)return!1}return!0}function u(n,t,u,f){var s=i(n,u,f),h=i(t,u,f),e,o;return s>0&&h>0||s<0&&h<0?!1:(e=i(u,n,t),o=i(f,n,t),e>0&&o>0||e<0&&o<0)?!1:s===0&&h===0&&e===0&&o===0?r(n,t,u,f):!0}t.exports=u;var i=n("robust-orientation")[3]},{"robust-orientation":531}],113:[function(n,t){"use strict";"use restrict";function r(n){this.roots=new Array(n);this.ranks=new Array(n);for(var t=0;t<n;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=r;var i=r.prototype;Object.defineProperty(i,"length",{get:function(){return this.roots.length}});i.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n};i.find=function(n){for(var i=n,t=this.roots,r;t[n]!==n;)n=t[n];while(t[i]!==n)r=t[i],t[i]=n,i=r;return n};i.link=function(n,t){var i=this.find(n),r=this.find(t);if(i!==r){var u=this.ranks,f=this.roots,e=u[i],o=u[r];e<o?f[i]=r:o<e?f[r]=i:(f[r]=i,++u[i])}}},{}],114:[function(n,t){(function(n){var i=function(){"use strict";function t(i,u,f,e){function h(i,f){var c,a,y,v,p;if(i===null)return null;if(f==0||typeof i!="object")return i;if(t.__isArray(i))c=[];else if(t.__isRegExp(i))c=new RegExp(i.source,r(i)),i.lastIndex&&(c.lastIndex=i.lastIndex);else if(t.__isDate(i))c=new Date(i.getTime());else{if(l&&n.isBuffer(i))return c=new n(i.length),i.copy(c),c;typeof e=="undefined"?(a=Object.getPrototypeOf(i),c=Object.create(a)):(c=Object.create(e),a=e)}if(u){if(y=o.indexOf(i),y!=-1)return s[y];o.push(i);s.push(c)}for(v in i)(a&&(p=Object.getOwnPropertyDescriptor(a,v)),p&&p.set==null)||(c[v]=h(i[v],f-1));return c}var c;typeof u=="object"&&(f=u.depth,e=u.prototype,c=u.filter,u=u.circular);var o=[],s=[],l=typeof n!="undefined";return typeof u=="undefined"&&(u=!0),typeof f=="undefined"&&(f=Infinity),h(i,f)}function i(n){return Object.prototype.toString.call(n)}function u(n){return typeof n=="object"&&i(n)==="[object Date]"}function f(n){return typeof n=="object"&&i(n)==="[object Array]"}function e(n){return typeof n=="object"&&i(n)==="[object RegExp]"}function r(n){var t="";return n.global&&(t+="g"),n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),t}return t.clonePrototype=function(n){if(n===null)return null;var t=function(){};return t.prototype=n,new t},t.__objToStr=i,t.__isDate=u,t.__isArray=f,t.__isRegExp=e,t.__getRegExpFlags=r,t}();typeof t=="object"&&t.exports&&(t.exports=i)}).call(this,n("buffer").Buffer)},{buffer:57}],115:[function(n,t){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:0,rgb:[255,255,255,1]}]}},{}],116:[function(n,t){"use strict";function f(n){for(var t,r="#",i=0;i<3;++i)t=n[i],t=t.toString(16),r+=("00"+t).substr(t.length);return r}function e(n){return"rgba("+n.join(",")+")"}var i=n("arraytools"),r=n("clone"),u=n("./colorScales");t.exports=function(n){var l,a,v,y,p,h,t,d,g,c,o,tt,s,w=[],b=[],k=[],nt=[];if(i.isPlainObject(n)||(n={}),g=n.nshades||72,d=n.format||"hex",t=n.colormap,t||(t="jet"),typeof t=="string"){if(t=t.toLowerCase(),!u[t])throw Error(t+" not a supported colorscale");h=r(u[t])}else if(Array.isArray(t))h=r(t);else throw Error("unsupported colormap option",t);if(h.length>g)throw new Error(t+" map requires nshades to be at least size "+h.length);for(o=Array.isArray(n.alpha)?n.alpha.length!==2?[1,1]:r(n.alpha):typeof n.alpha=="number"?[n.alpha,n.alpha]:[1,1],l=h.map(function(n){return Math.round(n.index*g)}),o[0]<0&&(o[0]=0),o[1]<0&&(o[0]=0),o[0]>1&&(o[0]=1),o[1]>1&&(o[0]=1),s=0;s<l.length;++s)(tt=h[s].index,a=h[s].rgb,a.length===4&&a[3]>=0&&a[3]<=1)||(a[3]=o[0]+(o[1]-o[0])*tt);for(s=0;s<l.length-1;++s)p=l[s+1]-l[s],v=h[s].rgb,y=h[s+1].rgb,w=w.concat(i.linspace(v[0],y[0],p)),b=b.concat(i.linspace(v[1],y[1],p)),k=k.concat(i.linspace(v[2],y[2],p)),nt=nt.concat(i.linspace(v[3],y[3],p));return w=w.map(Math.round),b=b.map(Math.round),k=k.map(Math.round),c=i.zip(w,b,k,nt),d==="hex"&&(c=c.map(f)),d==="rgbaString"&&(c=c.map(e)),c}},{"./colorScales":115,arraytools:55,clone:114}],117:[function(n,t){function r(n,t){return n-t}function u(n,t){var k=n.length,f=n.length-t.length,y,p,w,b,d,g,v;if(f)return f;switch(k){case 0:return 0;case 1:return n[0]-t[0];case 2:return n[0]+n[1]-t[0]-t[1]||i(n[0],n[1])-i(t[0],t[1]);case 3:return(y=n[0]+n[1],p=t[0]+t[1],f=y+n[2]-(p+t[2]),f)?f:(w=i(n[0],n[1]),b=i(t[0],t[1]),i(w,n[2])-i(b,t[2])||i(w+n[2],y)-i(b+t[2],p));case 4:var e=n[0],o=n[1],s=n[2],h=n[3],u=t[0],c=t[1],l=t[2],a=t[3];return e+o+s+h-(u+c+l+a)||i(e,o,s,h)-i(u,c,l,a,u)||i(e+o,e+s,e+h,o+s,o+h,s+h)-i(u+c,u+l,u+a,c+l,c+a,l+a)||i(e+o+s,e+o+h,e+s+h,o+s+h)-i(u+c+l,u+c+a,u+l+a,c+l+a);default:for(d=n.slice().sort(r),g=t.slice().sort(r),v=0;v<k;++v)if(f=d[v]-g[v],f)return f;return 0}}t.exports=u;var i=Math.min},{}],118:[function(n,t){"use strict";function f(n){var f=n.length,t;return f===0?[]:f===1?[[0]]:(t=n[0].length,t===0)?[]:t===1?i(n):t===2?r(n):u(n,t)}var i=n("./lib/ch1d"),r=n("./lib/ch2d"),u=n("./lib/chnd");t.exports=f},{"./lib/ch1d":119,"./lib/ch2d":120,"./lib/chnd":121}],119:[function(n,t){"use strict";function i(n){for(var t=0,i=0,r=1;r<n.length;++r)n[r][0]<n[t][0]&&(t=r),n[r][0]>n[i][0]&&(i=r);return t<i?[[t],[i]]:t>i?[[i],[t]]:[[t]]}t.exports=i},{}],120:[function(n,t){"use strict";function r(n){var u=i(n),r=u.length,f,e,t,o;if(r<=2)return[];for(f=new Array(r),e=u[r-1],t=0;t<r;++t)o=u[t],f[t]=[e,o],e=o;return f}t.exports=r;var i=n("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":123}],121:[function(n,t){"use strict";function u(n,t){for(var f,u=n.length,r=new Array(u),i=0;i<t.length;++i)r[i]=n[t[i]];for(f=t.length,i=0;i<u;++i)t.indexOf(i)<0&&(r[f++]=n[i]);return r}function f(n,t){for(var u,r,i,f,s=n.length,e=t.length,o=0;o<s;++o)for(u=n[o],r=0;r<u.length;++r)if(i=u[r],i<e)u[r]=t[i];else{for(i=i-e,f=0;f<e;++f)i>=t[f]&&(i+=1);u[r]=i}return n}function e(n,t){var e,o,s;try{return i(n,!0)}catch(h){return(e=r(n),e.length<=t)?[]:(o=u(n,e),s=i(o,!0),f(s,e))}}t.exports=e;var i=n("incremental-convex-hull"),r=n("affine-hull")},{"affine-hull":122,"incremental-convex-hull":315}],122:[function(n,t){"use strict";function r(n,t){for(var u,o,f,s,e=new Array(t+1),r=0;r<n.length;++r)e[r]=n[r];for(r=0;r<=n.length;++r){for(u=n.length;u<=t;++u){for(o=new Array(t),f=0;f<t;++f)o[f]=Math.pow(u+1-r,f);e[u]=o}if(s=i.apply(void 0,e),s)return!0}return!1}function u(n){var u=n.length,t;if(u===0)return[];if(u===1)return[0];var e=n[0].length,f=[n[0]],i=[0];for(t=1;t<u;++t){if(f.push(n[t]),!r(f,e)){f.pop();continue}if(i.push(t),i.length===e+1)return i}return i}t.exports=u;var i=n("robust-orientation")},{"robust-orientation":531}],123:[function(n,t){"use strict";function r(n){var o=n.length,e,r,u,s,l,t,v,h;if(o<3){for(s=new Array(o),t=0;t<o;++t)s[t]=t;return o===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:s}for(e=new Array(o),t=0;t<o;++t)e[t]=t;for(e.sort(function(t,i){var r=n[t][0]-n[i][0];return r?r:n[t][1]-n[i][1]}),r=[e[0],e[1]],u=[e[0],e[1]],t=2;t<o;++t){for(var c=e[t],a=n[c],f=r.length;f>1&&i(n[r[f-2]],n[r[f-1]],a)<=0;)f-=1,r.pop();for(r.push(c),f=u.length;f>1&&i(n[u[f-2]],n[u[f-1]],a)>=0;)f-=1,u.pop();u.push(c)}for(s=new Array(u.length+r.length-2),l=0,t=0,v=r.length;t<v;++t)s[l++]=r[t];for(h=u.length-2;h>0;--h)s[l++]=u[h];return s}t.exports=r;var i=n("robust-orientation")[3]},{"robust-orientation":531}],124:[function(n,t){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CPV:"verde",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bdr|\\bdr.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",COG:"^(?!.*\\bdem)(?!.*\\bdr)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|ç)ao",CYP:"cyprus",CZE:"^(?=.*rep).*czech|czechia|bohemia",CSK:"czechoslovakia",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"ireland",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat).*\\bkorea|^(?=.*people).*\\bkorea|^(?=.*north).*\\bkorea|dprk",KOR:"^(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MKD:"macedonia|fyrom",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"micronesia",MDA:"moldov|b(a|e)ssarabia",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",REU:"r(e|é)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|é)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|ã)o.?tom(e|é)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"\\bs\\w*.?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa",TJK:"tajik",TZA:"tanzania",THA:"thailand|\\bsiam",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",USA:"united.?states|\\bu\\.?s\\.?a\\.?\\b|\\bu\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],125:[function(n,t){"use strict";function r(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=!1}function u(n){var t=new r,e,u,f;for(t.pre=n.pre,t.body=n.body,t.post=n.post,e=n.args.slice(0),t.argTypes=e,u=0;u<e.length;++u)if(f=e[u],f==="array"||typeof f=="object"&&f.blockIndices){if(t.argTypes[u]="array",t.arrayArgs.push(u),t.arrayBlockIndices.push(f.blockIndices?f.blockIndices:0),t.shimArgs.push("array"+u),u<t.pre.args.length&&t.pre.args[u].count>0)throw new Error("cwise: pre() block may not reference array args");if(u<t.post.args.length&&t.post.args[u].count>0)throw new Error("cwise: post() block may not reference array args");}else if(f==="scalar")t.scalarArgs.push(u),t.shimArgs.push("scalar"+u);else if(f==="index"){if(t.indexArgs.push(u),u<t.pre.args.length&&t.pre.args[u].count>0)throw new Error("cwise: pre() block may not reference array index");if(u<t.body.args.length&&t.body.args[u].lvalue)throw new Error("cwise: body() block may not write to array index");if(u<t.post.args.length&&t.post.args[u].count>0)throw new Error("cwise: post() block may not reference array index");}else if(f==="shape"){if(t.shapeArgs.push(u),u<t.pre.args.length&&t.pre.args[u].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(u<t.body.args.length&&t.body.args[u].lvalue)throw new Error("cwise: body() block may not write to array shape");if(u<t.post.args.length&&t.post.args[u].lvalue)throw new Error("cwise: post() block may not write to array shape");}else if(typeof f=="object"&&f.offset)t.argTypes[u]="offset",t.offsetArgs.push({array:f.array,offset:f.offset}),t.offsetArgIndex.push(u);else throw new Error("cwise: Unknown argument type "+e[u]);if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>e.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>e.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>e.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!n.printCode||!!n.debug,t.funcName=n.funcName||"cwise",t.blockSize=n.blockSize||64,i(t)}var i=n("./lib/thunk.js");t.exports=u},{"./lib/thunk.js":127}],126:[function(n,t){"use strict";function r(n,t,i){for(var s=n.length,c=t.arrayArgs.length,l=t.indexArgs.length>0,e=[],h=[],f=0,o=0,u,r=0;r<s;++r)h.push(["i",r,"=0"].join(""));for(u=0;u<c;++u)for(r=0;r<s;++r)o=f,f=n[r],r===0?h.push(["d",u,"s",r,"=t",u,"p",f].join("")):h.push(["d",u,"s",r,"=(t",u,"p",f,"-s",o,"*t",u,"p",o,")"].join(""));for(e.push("var "+h.join(",")),r=s-1;r>=0;--r)f=n[r],e.push(["for(i",r,"=0;i",r,"<s",f,";++i",r,"){"].join(""));for(e.push(i),r=0;r<s;++r){for(o=f,f=n[r],u=0;u<c;++u)e.push(["p",u,"+=d",u,"s",r].join(""));l&&(r>0&&e.push(["index[",o,"]-=s",o].join("")),e.push(["++index[",f,"]"].join("")));e.push("}")}return e.join("\n")}function f(n,t,i,u){for(var c,o,s=t.length,l=i.arrayArgs.length,h=i.blockSize,a=i.indexArgs.length>0,e=[],f=0;f<l;++f)e.push(["var offset",f,"=p",f].join(""));for(f=n;f<s;++f)e.push(["for(var j"+f+"=SS[",t[f],"]|0;j",f,">0;){"].join("")),e.push(["if(j",f,"<",h,"){"].join("")),e.push(["s",t[f],"=j",f].join("")),e.push(["j",f,"=0"].join("")),e.push(["}else{s",t[f],"=",h].join("")),e.push(["j",f,"-=",h,"}"].join("")),a&&e.push(["index[",t[f],"]=j",f].join(""));for(f=0;f<l;++f){for(c=["offset"+f],o=n;o<s;++o)c.push(["j",o,"*t",f,"p",t[o]].join(""));e.push(["p",f,"=(",c.join("+"),")"].join(""))}for(e.push(r(t,i,u)),f=n;f<s;++f)e.push("}");return e.join("\n")}function e(n){for(var t=0,r=n[0].length,i;t<r;){for(i=1;i<n.length;++i)if(n[i][t]!==n[0][t])return t;++t}return t}function i(n,t,i){for(var c,y,b,e,o,p,w,l,r=n.body,a=[],v=[],h=0;h<n.args.length;++h)if(c=n.args[h],!(c.count<=0)){var f=new RegExp(c.name,"g"),u="",s=t.arrayArgs.indexOf(h);switch(t.argTypes[h]){case"offset":y=t.offsetArgIndex.indexOf(h);b=t.offsetArgs[y];s=b.array;u="+q"+y;case"array":if(u="p"+s+u,e="l"+h,o="a"+s,t.arrayBlockIndices[s]===0)c.count===1?i[s]==="generic"?c.lvalue?(a.push(["var ",e,"=",o,".get(",u,")"].join("")),r=r.replace(f,e),v.push([o,".set(",u,",",e,")"].join(""))):r=r.replace(f,[o,".get(",u,")"].join("")):r=r.replace(f,[o,"[",u,"]"].join("")):i[s]==="generic"?(a.push(["var ",e,"=",o,".get(",u,")"].join("")),r=r.replace(f,e),c.lvalue&&v.push([o,".set(",u,",",e,")"].join(""))):(a.push(["var ",e,"=",o,"[",u,"]"].join("")),r=r.replace(f,e),c.lvalue&&v.push([o,"[",u,"]=",e].join("")));else{for(p=[c.name],w=[u],l=0;l<Math.abs(t.arrayBlockIndices[s]);l++)p.push("\\s*\\[([^\\]]+)\\]"),w.push("$"+(l+1)+"*t"+s+"b"+l);if(f=new RegExp(p.join(""),"g"),u=w.join("+"),i[s]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");else r=r.replace(f,[o,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(f,"Y"+t.scalarArgs.indexOf(h));break;case"index":r=r.replace(f,"index");break;case"shape":r=r.replace(f,"shape")}}return[a.join("\n"),r,v.join("\n")].join("\n").trim()}function o(n){for(var u,i,r=new Array(n.length),f=!0,t=0;t<n.length;++t)u=n[t],i=u.match(/\d+/),i=i?i[0]:"",r[t]=u.charAt(0)===0?"u"+u.charAt(1)+i:u.charAt(0)+i,t>0&&(f=f&&r[t]===r[t-1]);return f?r[0]:r.join("")}function s(n,t){for(var it,rt,v,k,h,ot,ut,g,ft,st,l=t[1].length-Math.abs(n.arrayBlockIndices[0])|0,y=new Array(n.arrayArgs.length),p=new Array(n.arrayArgs.length),s=0;s<n.arrayArgs.length;++s)p[s]=t[2*s],y[s]=t[2*s+1];var nt=[],et=[],w=[],tt=[],d=[];for(s=0;s<n.arrayArgs.length;++s){for(n.arrayBlockIndices[s]<0?(w.push(0),tt.push(l),nt.push(l),et.push(l+n.arrayBlockIndices[s])):(w.push(n.arrayBlockIndices[s]),tt.push(n.arrayBlockIndices[s]+l),nt.push(0),et.push(n.arrayBlockIndices[s])),it=[],h=0;h<y[s].length;h++)w[s]<=y[s][h]&&y[s][h]<tt[s]&&it.push(y[s][h]-w[s]);d.push(it)}var b=["SS"],a=["'use strict'"],c=[];for(h=0;h<l;++h)c.push(["s",h,"=SS[",h,"]"].join(""));for(s=0;s<n.arrayArgs.length;++s){for(b.push("a"+s),b.push("t"+s),b.push("p"+s),h=0;h<l;++h)c.push(["t",s,"p",h,"=t",s,"[",w[s]+h,"]"].join(""));for(h=0;h<Math.abs(n.arrayBlockIndices[s]);++h)c.push(["t",s,"b",h,"=t",s,"[",nt[s]+h,"]"].join(""))}for(s=0;s<n.scalarArgs.length;++s)b.push("Y"+s);if(n.shapeArgs.length>0&&c.push("shape=SS.slice(0)"),n.indexArgs.length>0){for(rt=new Array(l),s=0;s<l;++s)rt[s]="0";c.push(["index=[",rt.join(","),"]"].join(""))}for(s=0;s<n.offsetArgs.length;++s){for(v=n.offsetArgs[s],k=[],h=0;h<v.offset.length;++h)if(v.offset[h]===0)continue;else v.offset[h]===1?k.push(["t",v.array,"p",h].join("")):k.push([v.offset[h],"*t",v.array,"p",h].join(""));k.length===0?c.push("q"+s+"=0"):c.push(["q",s,"=",k.join("+")].join(""))}for(ot=u([].concat(n.pre.thisVars).concat(n.body.thisVars).concat(n.post.thisVars)),c=c.concat(ot),a.push("var "+c.join(",")),s=0;s<n.arrayArgs.length;++s)a.push("p"+s+"|=0");return n.pre.body.length>3&&a.push(i(n.pre,n,p)),ut=i(n.body,n,p),g=e(d),g<l?a.push(f(g,d[0],n,ut)):a.push(r(d[0],n,ut)),n.post.body.length>3&&a.push(i(n.post,n,p)),n.debug&&console.log("-----Generated cwise routine for ",t,":\n"+a.join("\n")+"\n----------"),ft=[n.funcName||"unnamed","_cwise_loop_",y[0].join("s"),"m",g,o(p)].join(""),st=new Function(["function ",ft,"(",b.join(","),"){",a.join("\n"),"} return ",ft].join("")),st()}var u=n("uniq");t.exports=s},{uniq:551}],127:[function(n,t){"use strict";function r(n){var u=["'use strict'","var CACHED={}"],e=[],a=n.funcName+"_cwise_thunk",t,r,l;u.push(["return function ",a,"(",n.shimArgs.join(","),"){"].join(""));var o=[],s=[],f=[["array",n.arrayArgs[0],".shape.slice(",Math.max(0,n.arrayBlockIndices[0]),n.arrayBlockIndices[0]<0?","+n.arrayBlockIndices[0]+")":")"].join("")],h=[],c=[];for(r=0;r<n.arrayArgs.length;++r)t=n.arrayArgs[r],e.push(["t",t,"=array",t,".dtype,","r",t,"=array",t,".order"].join("")),o.push("t"+t),o.push("r"+t),s.push("t"+t),s.push("r"+t+".join()"),f.push("array"+t+".data"),f.push("array"+t+".stride"),f.push("array"+t+".offset|0"),r>0&&(h.push("array"+n.arrayArgs[0]+".shape.length===array"+t+".shape.length+"+(Math.abs(n.arrayBlockIndices[0])-Math.abs(n.arrayBlockIndices[r]))),c.push("array"+n.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[0])+"]===array"+t+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[r])+"]"));for(n.arrayArgs.length>1&&(u.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),u.push("for(var shapeIndex=array"+n.arrayArgs[0]+".shape.length-"+Math.abs(n.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),u.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),u.push("}")),r=0;r<n.scalarArgs.length;++r)f.push("scalar"+n.scalarArgs[r]);return e.push(["type=[",s.join(","),"].join()"].join("")),e.push("proc=CACHED[type]"),u.push("var "+e.join(",")),u.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",f.join(","),")}"].join("")),n.debug&&console.log("-----Generated thunk:\n"+u.join("\n")+"\n----------"),l=new Function("compile",u.join("\n")),l(i.bind(undefined,n))}var i=n("./compile.js");t.exports=r},{"./compile.js":126}],128:[function(n,t){t.exports=n("cwise-compiler")},{"cwise-compiler":125}],129:[function(t,i){!function(){function dl(n){return n&&(n.ownerDocument||n.document||n).documentElement}function gt(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function tr(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function hi(n){return n===null?NaN:+n}function vt(n){return!isNaN(n)}function na(n){return{left:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);r<u;){var f=r+u>>>1;n(t[f],i)<0?r=f+1:u=f}return r},right:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);r<u;){var f=r+u>>>1;n(t[f],i)>0?u=f:r=f+1}return r}}}function wk(n){return n.length}function bk(n){for(var t=1;n*t%1;)t*=10;return t}function ta(n,t){for(var i in t)Object.defineProperty(n.prototype,i,{value:t[i],enumerable:!1})}function yt(){this._=Object.create(null)}function yr(n){return(n+="")===ia||n[0]===gu?gu+n:n}function nf(n){return(n+="")[0]===gu?n.slice(1):n}function ra(n){return yr(n)in this._}function ua(n){return(n=yr(n))in this._&&delete this._[n]}function fa(){var n=[];for(var t in this._)n.push(nf(t));return n}function ea(){var n=0;for(var t in this._)++n;return n}function oa(){for(var n in this._)return!1;return!0}function vo(){this._=Object.create(null)}function p(n){return n}function kk(n,t,i){return function(){var r=i.apply(t,arguments);return r===t?n:r}}function yo(n,t){var i,u,r;if(t in n)return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0,u=po.length;i<u;++i)if(r=po[i]+t,r in n)return r}function v(){}function wo(){}function sa(n){function r(){for(var i=t,r=-1,f=i.length,u;++r<f;)(u=i[r].on)&&u.apply(this,arguments);return n}var t=[],i=new yt;return r.on=function(r,u){var f=i.get(r),e;return arguments.length<2?f&&f.on:(f&&(f.on=null,t=t.slice(0,e=t.indexOf(f)).concat(t.slice(e+1)),i.remove(r)),u&&t.push(i.set(r,{on:u})),n)},r}function ni(){t.event.preventDefault()}function bo(){for(var n=t.event,i;i=n.sourceEvent;)n=i;return n}function ko(n){for(var i=new wo,r=0,u=arguments.length;++r<u;)i[arguments[r]]=sa(i);return i.of=function(r,u){return function(f){try{var e=f.sourceEvent=t.event;f.target=n;t.event=f;i[f.type].apply(r,u)}finally{t.event=e}}},i}function ti(n){return pr(n,s),n}function ts(n){return typeof n=="function"?n:function(){return go(n,this)}}function ca(n){return typeof n=="function"?n:function(){return ns(n,this)}}function la(n,i){function r(){this.removeAttribute(n)}function u(){this.removeAttributeNS(n.space,n.local)}function f(){this.setAttribute(n,i)}function e(){this.setAttributeNS(n.space,n.local,i)}function o(){var t=i.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}function s(){var t=i.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}return n=t.ns.qualify(n),i==null?n.local?u:r:typeof i=="function"?n.local?s:o:n.local?e:f}function aa(n){return n.trim().replace(/\s+/g," ")}function va(n){return new RegExp("(?:^|\\s+)"+t.requote(n)+"(?:\\s+|$)","g")}function ya(n){return(n+"").trim().split(/^|\s+/)}function pa(n,t){function r(){for(var r=-1;++r<i;)n[r](this,t)}function u(){for(var r=-1,u=t.apply(this,arguments);++r<i;)n[r](this,u)}n=ya(n).map(dk);var i=n.length;return typeof t=="function"?u:r}function dk(n){var t=va(n);return function(i,r){if(u=i.classList)return r?u.add(n):u.remove(n);var u=i.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||i.setAttribute("class",aa(u+" "+n))):i.setAttribute("class",aa(u.replace(t," ")))}}function wa(n,t,i){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,i)}function f(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,i)}return t==null?r:typeof t=="function"?f:u}function ba(n,t){function i(){delete this[n]}function r(){this[n]=t}function u(){var i=t.apply(this,arguments);i==null?delete this[n]:this[n]=i}return t==null?i:typeof t=="function"?u:r}function ka(n){function i(){var t=this.ownerDocument,i=this.namespaceURI;return i===rf&&t.documentElement.namespaceURI===rf?t.createElement(n):t.createElementNS(i,n)}function r(){return this.ownerDocument.createElementNS(n.space,n.local)}return typeof n=="function"?n:(n=t.ns.qualify(n)).local?r:i}function gk(){var n=this.parentNode;n&&n.removeChild(this)}function is(n){return{__data__:n}}function da(n){return function(){return tf(this,n)}}function nd(n){return arguments.length||(n=tr),function(t,i){return t&&i?n(t.__data__,i.__data__):!t-!i}}function pt(n,t){for(var i=0,u=n.length;i<u;i++)for(var f=n[i],r=0,o=f.length,e;r<o;r++)(e=f[r])&&t(e,r,i);return n}function ga(n){return pr(n,st),n}function td(n){var t,i;return function(r,u,f){var e=n[f].update,s=e.length,o;for(f!=i&&(i=f,t=0),u>=t&&(t=u+1);!(o=e[t])&&++t<s;);return o}}function nv(n,i,r){function s(){var t=this[u];t&&(this.removeEventListener(n,t,t.$),delete this[u])}function h(){var t=o(i,ot(arguments));s.call(this);this.addEventListener(n,this[u]=t,t.$=r);t._=i}function c(){var f=new RegExp("^__on([^.]+)"+t.requote(n)+"$"),u,i,r;for(i in this)(u=i.match(f))&&(r=this[i],this.removeEventListener(u[1],r,r.$),delete this[i])}var u="__on"+n,f=n.indexOf("."),o=tv,e;return f>0&&(n=n.slice(0,f)),e=ff.get(n),e&&(n=e,o=id),f?i?h:s:i?v:c}function tv(n,i){return function(r){var u=t.event;t.event=r;i[0]=this.__data__;try{n.apply(this,i)}finally{t.event=u}}}function id(n,t){var i=tv(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||r.compareDocumentPosition(t)&8)||i.call(t,n)}}function ef(n){var i=".dragsuppress-"+ ++iv,f="click"+i,u=t.select(gt(n)).on("touchmove"+i,ni).on("dragstart"+i,ni).on("selectstart"+i,ni),r,e;return ci==null&&(ci="onselectstart"in n?!1:yo(n.style,"userSelect")),ci&&(r=dl(n).style,e=r[ci],r[ci]="none"),function(n){u.on(i,null);if(ci&&(r[ci]=e),n){var t=function(){u.on(f,null)};u.on(f,function(){ni();t()},!0);setTimeout(t,0)}}}function rs(n,i){var u,r,f,e,o;return(i.changedTouches&&(i=i.changedTouches[0]),u=n.ownerSVGElement||n,u.createSVGPoint)?(r=u.createSVGPoint(),of<0&&(f=gt(n),(f.scrollX||f.scrollY)&&(u=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),e=u[0][0].getScreenCTM(),of=!(e.f||e.e),u.remove())),of?(r.x=i.pageX,r.y=i.pageY):(r.x=i.clientX,r.y=i.clientY),r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]):(o=n.getBoundingClientRect(),[i.clientX-o.left-n.clientLeft,i.clientY-o.top-n.clientTop])}function rd(){return t.event.changedTouches[0].identifier}function rv(n){return n>0?1:n<0?-1:0}function us(n,t,i){return(t[0]-n[0])*(i[1]-n[1])-(t[1]-n[1])*(i[0]-n[0])}function uv(n){return n>1?0:n<-1?o:Math.acos(n)}function ii(n){return n>1?l:n<-1?-l:Math.asin(n)}function fd(n){return((n=Math.exp(n))-1/n)/2}function fv(n){return((n=Math.exp(n))+1/n)/2}function ed(n){return((n=Math.exp(2*n))-1)/(n+1)}function ev(n){return(n=Math.sin(n/2))*n}function li(){}function ht(n,t,i){return this instanceof ht?void(this.h=+n,this.s=+t,this.l=+i):arguments.length<2?n instanceof ht?new ht(n.h,n.s,n.l):yv(""+n,pv,ht):new ht(n,t,i)}function ss(n,t,i){function e(n){return(n>360?n-=360:n<0&&(n+=360),n<60)?r+(u-r)*n/60:n<180?u:n<240?r+(u-r)*(240-n)/60:r}function f(n){return Math.round(e(n)*255)}var r,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:t<0?0:t>1?1:t,i=i<0?0:i>1?1:i,u=i<=.5?i*(1+t):i+t-i*t,r=2*i-u,new d(f(n+120),f(n),f(n-120))}function ut(n,i,r){return this instanceof ut?void(this.h=+n,this.c=+i,this.l=+r):arguments.length<2?n instanceof ut?new ut(n.h,n.c,n.l):n instanceof ft?av(n.l,n.a,n.b):av((n=wv((n=t.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new ut(n,i,r)}function hs(n,t,i){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new ft(i,Math.cos(n*=e)*t,Math.sin(n)*t)}function ft(n,t,i){return this instanceof ft?void(this.l=+n,this.a=+t,this.b=+i):arguments.length<2?n instanceof ft?new ft(n.l,n.a,n.b):n instanceof ut?hs(n.h,n.c,n.l):wv((n=d(n)).r,n.g,n.b):new ft(n,t,i)}function lv(n,t,i){var r=(n+16)/116,u=r+t/500,f=r-i/200;return u=ls(u)*sv,r=ls(r)*hv,f=ls(f)*cv,new d(vs(3.2404542*u-1.5371385*r-.4985314*f),vs(-.969266*u+1.8760108*r+.041556*f),vs(.0556434*u-.2040259*r+1.0572252*f))}function av(n,t,i){return n>0?new ut(Math.atan2(i,t)*c,Math.sqrt(t*t+i*i),n):new ut(NaN,NaN,n)}function ls(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function as(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function vs(n){return Math.round(255*(n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function d(n,t,i){return this instanceof d?void(this.r=~~n,this.g=~~t,this.b=~~i):arguments.length<2?n instanceof d?new d(n.r,n.g,n.b):yv(""+n,d,ss):new d(n,t,i)}function vv(n){return new d(n>>16,n>>8&255,n&255)}function vf(n){return vv(n)+""}function ir(n){return n<16?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function yv(n,t,i){var f=0,e=0,o=0,s,u,r;if(s=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()),s){u=s[2].split(",");switch(s[1]){case"hsl":return i(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(ps(u[0]),ps(u[1]),ps(u[2]))}}return(r=kr.get(n))?t(r.r,r.g,r.b):(n==null||n.charAt(0)!=="#"||isNaN(r=parseInt(n.slice(1),16))||(n.length===4?(f=(r&3840)>>4,f=f>>4|f,e=r&240,e=e>>4|e,o=r&15,o=o<<4|o):n.length===7&&(f=(r&16711680)>>16,e=(r&65280)>>8,o=r&255)),t(f,e,o))}function pv(n,t,i){var f=Math.min(n/=255,t/=255,i/=255),r=Math.max(n,t,i),u=r-f,e,s,o=(r+f)/2;return u?(s=o<.5?u/(r+f):u/(2-r-f),e=(n==r?(t-i)/u+(t<i?6:0):t==r?(i-n)/u+2:(n-t)/u+4)*60):(e=NaN,s=o>0&&o<1?0:e),new ht(e,s,o)}function wv(n,t,i){n=ys(n);t=ys(t);i=ys(i);var u=as((.4124564*n+.3575761*t+.1804375*i)/sv),r=as((.2126729*n+.7151522*t+.072175*i)/hv),f=as((.0193339*n+.119192*t+.9503041*i)/cv);return ft(116*r-16,500*(u-r),200*(r-f))}function ys(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function ps(n){var t=parseFloat(n);return n.charAt(n.length-1)==="%"?Math.round(t*2.55):t}function h(n){return typeof n=="function"?n:function(){return n}}function ws(n){return function(t,i,r){return arguments.length===2&&typeof i=="function"&&(r=i,i=null),yf(t,i,n,r)}}function yf(n,i,r,u){function c(){var n=e.status,t;if(!n&&sd(e)||n>=200&&n<300||n===304){try{t=r.call(f,e)}catch(i){s.error.call(f,i);return}s.load.call(f,t)}else s.error.call(f,e)}var f={},s=t.dispatch("beforesend","progress","load","error"),o={},e=new XMLHttpRequest,h=null;return!this.XDomainRequest||"withCredentials"in e||!/^(http(s)?:)?\/\//.test(n)||(e=new XDomainRequest),"onload"in e?e.onload=e.onerror=c:e.onreadystatechange=function(){e.readyState>3&&c()},e.onprogress=function(n){var i=t.event;t.event=n;try{s.progress.call(f,e)}finally{t.event=i}},f.header=function(n,t){return(n=(n+"").toLowerCase(),arguments.length<2)?o[n]:(t==null?delete o[n]:o[n]=t+"",f)},f.mimeType=function(n){return arguments.length?(i=n==null?null:n+"",f):i},f.responseType=function(n){return arguments.length?(h=n,f):h},f.response=function(n){return r=n,f},["get","post"].forEach(function(n){f[n]=function(){return f.send.apply(f,[n].concat(ot(arguments)))}}),f.send=function(t,r,u){if(arguments.length===2&&typeof r=="function"&&(u=r,r=null),e.open(t,n,!0),i==null||"accept"in o||(o.accept=i+",*/*"),e.setRequestHeader)for(var c in o)e.setRequestHeader(c,o[c]);if(i!=null&&e.overrideMimeType&&e.overrideMimeType(i),h!=null&&(e.responseType=h),u!=null)f.on("error",u).on("load",function(n){u(null,n)});return s.beforesend.call(f,e),e.send(r==null?null:r),f},f.abort=function(){return e.abort(),f},t.rebind(f,s,"on"),u==null?f:f.get(od(u))}function od(n){return n.length===1?function(t,i){n(t==null?i:null)}:n}function sd(n){var t=n.responseType;return t&&t!=="text"?n.response:n.responseText}function df(n,t,i){var u=arguments.length,f,r;return u<2&&(t=0),u<3&&(i=Date.now()),f=i+t,r={c:n,t:f,n:null},wf?wf.n=r:pf=r,wf=r,bf||(kf=clearTimeout(kf),bf=1,bs(ks)),r}function ks(){var t=bv(),n=kv()-t;n>24?(isFinite(n)&&(clearTimeout(kf),kf=setTimeout(ks,n)),bf=0):(bf=1,bs(ks))}function bv(){for(var t=Date.now(),n=pf;n;)t>=n.t&&n.c(t-n.t)&&(n.c=null),n=n.n;return t}function kv(){for(var t,n=pf,i=Infinity;n;)n.c?(n.t<i&&(i=n.t),n=(t=n).n):n=t?t.n=n.n:pf=n.n;return wf=t,i}function ds(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function hd(n,t){var i=Math.pow(10,f(8-t)*3);return{scale:t>8?function(n){return n/i}:function(n){return n*i},symbol:n}}function cd(n){var e=n.decimal,r=n.thousands,i=n.grouping,u=n.currency,f=i&&r?function(n,t){for(var f=n.length,o=[],s=0,u=i[0],e=0;f>0&&u>0;){if(e+u+1>t&&(u=Math.max(1,t-e)),o.push(n.substring(f-=u,f+u)),(e+=u+1)>t)break;u=i[s=(s+1)%i.length]}return o.reverse().join(r)}:p;return function(n){var o=gs.exec(n),y=o[1]||" ",s=o[2]||">",b=o[3]||"-",k=o[4]||"",l=o[5],p=+o[6],w=o[7],r=o[8],i=o[9],h=1,a="",c="",d=!1,g=!0,v;r&&(r=+r.substring(1));(l||y==="0"&&s==="=")&&(l=y="0",s="=");switch(i){case"n":w=!0;i="g";break;case"%":h=100;c="%";i="f";break;case"p":h=100;c="%";i="r";break;case"b":case"o":case"x":case"X":k==="#"&&(a="0"+i.toLowerCase());case"c":g=!1;case"d":d=!0;r=0;break;case"s":h=-1;i="r"}return k==="$"&&(a=u[0],c=u[1]),i!="r"||r||(i="g"),r!=null&&(i=="g"?r=Math.max(1,Math.min(21,r)):(i=="e"||i=="f")&&(r=Math.max(0,Math.min(20,r)))),i=gv.get(i)||ld,v=l&&w,function(n){var ft=c,k,ut,it,u,nt,rt,tt,o;return d&&n%1?"":(k=n<0||n===0&&1/n<0?(n=-n,"-"):b==="-"?"":b,h<0?(ut=t.formatPrefix(n,r),n=ut.scale(n),ft=ut.symbol+c):n*=h,n=i(n,r),it=n.lastIndexOf("."),it<0?(rt=g?n.lastIndexOf("e"):-1,rt<0?(u=n,nt=""):(u=n.substring(0,rt),nt=n.substring(rt))):(u=n.substring(0,it),nt=e+n.substring(it+1)),!l&&w&&(u=f(u,Infinity)),tt=a.length+u.length+nt.length+(v?0:k.length),o=tt<p?new Array(tt=p-tt+1).join(y):"",v&&(u=f(o+u,o.length?p-nt.length:Infinity)),k+=a,n=u+nt,(s==="<"?k+n+o:s===">"?o+k+n:s==="^"?o.substring(0,tt>>=1)+k+n+o.substring(tt):k+(v?n:o+n))+ft)}}}function ld(n){return n+""}function wt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function ai(n,t,i){function e(t){var i=n(t),r=f(i,1);return t-i<r-t?i:r}function u(i){return t(i=n(new w(i-1)),1),i}function f(n,i){return t(n=new w(+n),i),n}function o(n,r,f){var e=u(n),o=[];if(f>1)while(e<r)i(e)%f||o.push(new Date(+e)),t(e,1);else while(e<r)o.push(new Date(+e)),t(e,1);return o}function s(n,t,i){try{w=wt;var r=new wt;return r._=n,o(r,t,i)}finally{w=Date}}n.floor=n;n.round=e;n.ceil=u;n.offset=f;n.range=o;var r=n.utc=gf(n);return r.floor=r,r.round=gf(e),r.ceil=gf(u),r.offset=gf(f),r.range=s,n}function gf(n){return function(t,i){try{w=wt;var r=new wt;return r._=t,n(r,i)._}finally{w=Date}}}function ad(n){function i(n){function t(t){for(var e=[],u=-1,o=0,f,s,h;++u<i;)n.charCodeAt(u)===37&&(e.push(n.slice(o,u)),(s=ny[f=n.charAt(++u)])!=null&&(f=n.charAt(++u)),(h=r[f])&&(f=h(t,s==null?f==="e"?" ":"0":s)),e.push(f),o=u+1);return e.push(n.slice(o,u)),e.join("")}var i=n.length;return t.parse=function(t){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=f(i,n,t,0),u,r;return e!=t.length?null:("p"in i&&(i.H=i.H%12+i.p*12),u=i.Z!=null&&w!==wt,r=new(u?wt:w),"j"in i?r.setFullYear(i.y,0,i.j):"W"in i||"U"in i?("w"in i||(i.w="W"in i?1:0),r.setFullYear(i.y,0,1),r.setFullYear(i.y,0,"W"in i?(i.w+6)%7+i.W*7-(r.getDay()+5)%7:i.w+i.U*7-(r.getDay()+6)%7)):r.setFullYear(i.y,i.m,i.d),r.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),u?r._:r)},t.toString=function(){return n},t}function f(n,t,i,r){for(var f,e,o,u=0,s=t.length,h=i.length;u<s;){if(r>=h)return-1;if(f=t.charCodeAt(u++),f===37){if(o=t.charAt(u++),e=b[o in ny?t.charAt(u++):o],!e||(r=e(n,i,r))<0)return-1}else if(f!=i.charCodeAt(r++))return-1}return r}function ft(n,t,i){v.lastIndex=0;var r=v.exec(t.slice(i));return r?(n.w=it.get(r[0].toLowerCase()),i+r[0].length):-1}function et(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i));return r?(n.w=tt.get(r[0].toLowerCase()),i+r[0].length):-1}function ot(n,t,i){p.lastIndex=0;var r=p.exec(t.slice(i));return r?(n.m=ut.get(r[0].toLowerCase()),i+r[0].length):-1}function st(n,t,i){y.lastIndex=0;var r=y.exec(t.slice(i));return r?(n.m=rt.get(r[0].toLowerCase()),i+r[0].length):-1}function ht(n,t,i){return f(n,r.c.toString(),t,i)}function ct(n,t,i){return f(n,r.x.toString(),t,i)}function lt(n,t,i){return f(n,r.X.toString(),t,i)}function at(n,t,i){var r=l.get(t.slice(i,i+=2).toLowerCase());return r==null?-1:(n.p=r,i)}var d=n.dateTime,g=n.date,nt=n.time,c=n.periods,e=n.days,o=n.shortDays,s=n.months,h=n.shortMonths,r,b;i.utc=function(n){function r(n){try{w=wt;var i=new w;return i._=n,t(i)}finally{w=Date}}var t=i(n);return r.parse=function(n){try{w=wt;var i=t.parse(n);return i&&i._}finally{w=Date}},r.toString=t.toString,r};i.multi=i.utc.multi=eg;var l=t.map(),a=ne(e),tt=te(e),v=ne(o),it=te(o),y=ne(s),rt=te(s),p=ne(h),ut=te(h);return c.forEach(function(n,t){l.set(n.toLowerCase(),t)}),r={a:function(n){return o[n.getDay()]},A:function(n){return e[n.getDay()]},b:function(n){return h[n.getMonth()]},B:function(n){return s[n.getMonth()]},c:i(d),d:function(n,t){return k(n.getDate(),t,2)},e:function(n,t){return k(n.getDate(),t,2)},H:function(n,t){return k(n.getHours(),t,2)},I:function(n,t){return k(n.getHours()%12||12,t,2)},j:function(n,t){return k(1+u.dayOfYear(n),t,3)},L:function(n,t){return k(n.getMilliseconds(),t,3)},m:function(n,t){return k(n.getMonth()+1,t,2)},M:function(n,t){return k(n.getMinutes(),t,2)},p:function(n){return c[+(n.getHours()>=12)]},S:function(n,t){return k(n.getSeconds(),t,2)},U:function(n,t){return k(u.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return k(u.mondayOfYear(n),t,2)},x:i(g),X:i(nt),y:function(n,t){return k(n.getFullYear()%100,t,2)},Y:function(n,t){return k(n.getFullYear()%1e4,t,4)},Z:ug,"%":function(){return"%"}},b={a:ft,A:et,b:ot,B:st,c:ht,d:iy,e:iy,H:ry,I:ry,j:ng,L:rg,m:gd,M:tg,p:at,S:ig,U:yd,w:vd,W:pd,x:ct,X:lt,y:bd,Y:wd,Z:kd,"%":fg},i}function k(n,t,i){var u=n<0?"-":"",r=(u?-n:n)+"",f=r.length;return u+(f<i?new Array(i-f+1).join(t)+r:r)}function ne(n){return new RegExp("^(?:"+n.map(t.requote).join("|")+")","i")}function te(n){for(var i=new yt,t=-1,r=n.length;++t<r;)i.set(n[t].toLowerCase(),t);return i}function vd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+1));return r?(n.w=+r[0],i+r[0].length):-1}function yd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i));return r?(n.U=+r[0],i+r[0].length):-1}function pd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i));return r?(n.W=+r[0],i+r[0].length):-1}function wd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+4));return r?(n.y=+r[0],i+r[0].length):-1}function bd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.y=dd(+r[0]),i+r[0].length):-1}function kd(n,t,i){return/^[+-]\d{4}$/.test(t=t.slice(i,i+5))?(n.Z=-t,i+5):-1}function dd(n){return n+(n>68?1900:2e3)}function gd(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.m=r[0]-1,i+r[0].length):-1}function iy(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.d=+r[0],i+r[0].length):-1}function ng(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+3));return r?(n.j=+r[0],i+r[0].length):-1}function ry(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.H=+r[0],i+r[0].length):-1}function tg(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.M=+r[0],i+r[0].length):-1}function ig(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+2));return r?(n.S=+r[0],i+r[0].length):-1}function rg(n,t,i){a.lastIndex=0;var r=a.exec(t.slice(i,i+3));return r?(n.L=+r[0],i+r[0].length):-1}function ug(n){var t=n.getTimezoneOffset(),i=t>0?"-":"+",r=f(t)/60|0,u=f(t)%60;return i+k(r,"0",2)+k(u,"0",2)}function fg(n,t,i){ty.lastIndex=0;var r=ty.exec(t.slice(i,i+1));return r?i+r[0].length:-1}function eg(n){for(var i=n.length,t=-1;++t<i;)n[t][0]=this(n[t][0]);return function(t){for(var r=0,i=n[r];!i[1](t);)i=n[++r];return i[0](t)}}function th(){}function uy(n,t,i){var r=i.s=n+t,u=r-n,f=r-u;i.t=n-f+(t-u)}function ie(n,t){n&&rh.hasOwnProperty(n.type)&&rh[n.type](n,t)}function uh(n,t,i){var u=-1,f=n.length-i,r;for(t.lineStart();++u<f;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function fy(n,t){var i=-1,r=n.length;for(t.polygonStart();++i<r;)uh(n[i],t,1);t.polygonEnd()}function og(){function f(r,u){r*=e;u=u*e/2+o/4;var f=r-n,s=f>=0?1:-1,h=s*f,c=Math.cos(u),l=Math.sin(u),a=i*l,v=t*c+a*Math.cos(h),y=a*s*Math.sin(h);ri.add(Math.atan2(y,v));n=r;t=c;i=l}var r,u,n,t,i;g.point=function(s,h){g.point=f;n=(r=s)*e;t=Math.cos(h=(u=h)*e/2+o/4);i=Math.sin(h)};g.lineEnd=function(){f(r,u)}}function vi(n){var t=n[0],i=n[1],r=Math.cos(i);return[r*Math.cos(t),r*Math.sin(t),Math.sin(i)]}function ue(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function rr(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function fh(n,t){n[0]+=t[0];n[1]+=t[1];n[2]+=t[2]}function fe(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function ee(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t;n[1]/=t;n[2]/=t}function oe(n){return[Math.atan2(n[1],n[0]),ii(n[2])]}function se(n,t){return f(n[0]-t[0])<r&&f(n[1]-t[1])<r}function eh(n,t){n*=e;var i=Math.cos(t*=e);nu(i*Math.cos(n),i*Math.sin(n),Math.sin(t))}function nu(n,t,i){++gr;yi+=(n-yi)/gr;pi+=(t-pi)/gr;bt+=(i-bt)/gr}function ey(){function r(r,u){r*=e;var c=Math.cos(u*=e),o=c*Math.cos(r),s=c*Math.sin(r),h=Math.sin(u),f=Math.atan2(Math.sqrt((f=t*h-i*s)*f+(f=i*o-n*h)*f+(f=n*s-t*o)*f),n*o+t*s+i*h);he+=f;ui+=f*(n+(n=o));fi+=f*(t+(t=s));lt+=f*(i+(i=h));nu(n,t,i)}var n,t,i;tt.point=function(u,f){u*=e;var o=Math.cos(f*=e);n=o*Math.cos(u);t=o*Math.sin(u);i=Math.sin(f);tt.point=r;nu(n,t,i)}}function oy(){tt.point=eh}function sg(){function f(r,u){r*=e;var p=Math.cos(u*=e),f=p*Math.cos(r),o=p*Math.sin(r),s=Math.sin(u),c=t*s-i*o,l=i*f-n*s,a=n*o-t*f,v=Math.sqrt(c*c+l*l+a*a),w=n*f+t*o+i*s,y=v&&-uv(w)/v,h=Math.atan2(v,w);ur+=y*c;fr+=y*l;ei+=y*a;he+=h;ui+=h*(n+(n=f));fi+=h*(t+(t=o));lt+=h*(i+(i=s));nu(n,t,i)}var r,u,n,t,i;tt.point=function(o,s){r=o;u=s;tt.point=f;o*=e;var h=Math.cos(s*=e);n=h*Math.cos(o);t=h*Math.sin(o);i=Math.sin(s);nu(n,t,i)};tt.lineEnd=function(){f(r,u);tt.lineEnd=oy;tt.point=eh}}function sy(n,t){function i(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(i.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),i}function tu(){return!0}function hy(n,t,i,r,u){var h=[],s=[],v,o,l,f,c,a,e;if(n.forEach(function(n){var o,i,f,e,t,r;if(!((o=n.length-1)<=0)){if(i=n[0],f=n[o],se(i,f)){for(u.lineStart(),e=0;e<o;++e)u.point((i=n[e])[0],i[1]);u.lineEnd();return}t=new ce(i,n,null,!0);r=new ce(i,null,t,!1);t.o=r;h.push(t);s.push(r);t=new ce(f,n,null,!1);r=new ce(f,null,t,!0);t.o=r;h.push(t);s.push(r)}}),s.sort(t),cy(h),cy(s),h.length){for(var e=0,y=i,a=s.length;e<a;++e)s[e].e=y=!y;for(v=h[0];;){for(f=v,c=!0;f.v;)if((f=f.n)===v)return;o=f.z;u.lineStart();do{if(f.v=f.o.v=!0,f.e){if(c)for(e=0,a=o.length;e<a;++e)u.point((l=o[e])[0],l[1]);else r(f.x,f.n.x,1,u);f=f.n}else{if(c)for(o=f.p.z,e=o.length-1;e>=0;--e)u.point((l=o[e])[0],l[1]);else r(f.x,f.p.x,-1,u);f=f.p}f=f.o;o=f.z;c=!c}while(!f.v);u.lineEnd()}}}function cy(n){if(r=n.length){for(var r,u=0,t=n[0],i;++u<r;)t.n=i=n[u],i.p=t,t=i;t.n=i=n[0];i.p=t}}function ce(n,t,i,r){this.x=n;this.z=t;this.o=i;this.e=r;this.v=!1;this.n=this.p=null}function ly(n,i,r,u){return function(f,e){function y(t,i){var r=f(t,i);n(t=r[0],i=r[1])&&e.point(t,i)}function g(n,t){var i=f(n,t);v.point(i[0],i[1])}function p(){o.point=g;v.lineStart()}function w(){o.point=y;v.lineEnd()}function k(n,t){c.push([n,t]);var i=f(n,t);l.point(i[0],i[1])}function nt(){l.lineStart();c=[]}function tt(){var t,r,f;k(c[0][0],c[0][1]);l.lineEnd();var u=l.clean(),n=b.buffer(),i,t=n.length;if(c.pop(),a.push(c),c=null,t){if(u&1){if(i=n[0],t=i.length-1,r=-1,t>0){for(s||(e.polygonStart(),s=!0),e.lineStart();++r<t;)e.point((f=i[r])[0],f[1]);e.lineEnd()}return}t>1&&u&2&&n.push(n.pop().concat(n.shift()));h.push(n.filter(hg))}}var v=i(e),d=f.invert(u[0],u[1]),o={point:y,lineStart:p,lineEnd:w,polygonStart:function(){o.point=k;o.lineStart=nt;o.lineEnd=tt;h=[];a=[]},polygonEnd:function(){o.point=y;o.lineStart=p;o.lineEnd=w;h=t.merge(h);var n=yg(d,a);h.length?(s||(e.polygonStart(),s=!0),hy(h,cg,n,r,e)):n&&(s||(e.polygonStart(),s=!0),e.lineStart(),r(null,null,1,e),e.lineEnd());s&&(e.polygonEnd(),s=!1);h=a=null},sphere:function(){e.polygonStart();e.lineStart();r(null,null,1,e);e.lineEnd();e.polygonEnd()}},h,b=ay(),l=i(b),s=!1,a,c;return o}}function hg(n){return n.length>1}function ay(){var n=[],t;return{lineStart:function(){n.push(t=[])},point:function(n,i){t.push([n,i])},lineEnd:v,buffer:function(){var i=n;return n=[],t=null,i},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function cg(n,t){return((n=n.x)[0]<0?n[1]-l-r:l-n[1])-((t=t.x)[0]<0?t[1]-l-r:l-t[1])}function lg(n){var i=NaN,t=NaN,u=NaN,e;return{lineStart:function(){n.lineStart();e=1},point:function(s,h){var c=s>0?o:-o,a=f(s-i);f(a-o)<r?(n.point(i,t=(t+h)/2>0?l:-l),n.point(u,t),n.lineEnd(),n.lineStart(),n.point(c,t),n.point(s,t),e=0):u!==c&&a>=o&&(f(i-u)<r&&(i-=u*r),f(s-c)<r&&(s-=c*r),t=ag(i,t,s,h),n.point(u,t),n.lineEnd(),n.lineStart(),n.point(c,t),e=0);n.point(i=s,t=h);u=c},lineEnd:function(){n.lineEnd();i=t=NaN},clean:function(){return 2-e}}}function ag(n,t,i,u){var e,o,s=Math.sin(n-i);return f(s)>r?Math.atan((Math.sin(t)*(o=Math.cos(u))*Math.sin(i)-Math.sin(u)*(e=Math.cos(t))*Math.sin(n))/(e*o*s)):(t+u)/2}function vg(n,t,i,u){var e,s;n==null?(e=i*l,u.point(-o,e),u.point(0,e),u.point(o,e),u.point(o,0),u.point(o,-e),u.point(0,-e),u.point(-o,-e),u.point(-o,0),u.point(-o,e)):f(n[0]-t[0])>r?(s=n[0]<t[0]?o:-o,e=i*s/2,u.point(-s,e),u.point(0,e),u.point(s,e)):u.point(t[0],t[1])}function yg(n,t){var f=n[0],g=n[1],ct=[Math.sin(f),-Math.cos(f),0],a=0,tt=0,e,it,s,v,u,k,d;for(ri.reset(),e=0,it=t.length;e<it;++e)if(s=t[e],v=s.length,v)for(var h=s[0],y=h[0],rt=h[1]/2+o/4,ut=Math.sin(rt),ft=Math.cos(rt),c=1;;){c===v&&(c=0);n=s[c];var p=n[0],et=n[1]/2+o/4,ot=Math.sin(et),st=Math.cos(et),i=p-y,w=i>=0?1:-1,b=w*i,l=b>o,ht=ut*ot;if(ri.add(Math.atan2(ht*w*Math.sin(b),ft*st+ht*Math.cos(b))),a+=l?i+w*nt:i,l^y>=f^p>=f&&(u=rr(vi(h),vi(n)),ee(u),k=rr(ct,u),ee(k),d=(l^i>=0?-1:1)*ii(k[2]),(g>d||g===d&&(u[0]||u[1]))&&(tt+=l^i>=0?1:-1)),!c++)break;y=p;ut=ot;ft=st;h=n}return(a<-r||a<r&&ri<0)^tt&1}function pg(n){function s(n,i){return Math.cos(n)*Math.cos(i)>t}function a(n){var t,a,f,l,e;return{lineStart:function(){l=f=!1;e=1},point:function(v,y){var p=[v,y],w,b=s(v,y),d=i?b?0:h(v,y):b?h(v+(v<0?o:-o),y):0,k;!t&&(l=f=b)&&n.lineStart();b!==f&&(w=u(t,p),(se(t,w)||se(p,w))&&(p[0]+=r,p[1]+=r,b=s(p[0],p[1])));b!==f?(e=0,b?(n.lineStart(),w=u(p,t),n.point(w[0],w[1])):(w=u(t,p),n.point(w[0],w[1]),n.lineEnd()),t=w):c&&t&&i^b&&(d&a||!(k=u(p,t,!0))||(e=0,i?(n.lineStart(),n.point(k[0][0],k[0][1]),n.point(k[1][0],k[1][1]),n.lineEnd()):(n.point(k[1][0],k[1][1]),n.lineEnd(),n.lineStart(),n.point(k[0][0],k[0][1]))));!b||t&&se(t,p)||n.point(p[0],p[1]);t=p;f=b;a=d},lineEnd:function(){f&&n.lineEnd();t=null},clean:function(){return e|(l&&f)<<1}}}function u(n,i,u){var et=vi(n),ot=vi(i),rt=[1,0,0],a=rr(et,ot),ut=ue(a,a),b=a[0],k=ut-b*b,g,e,it;if(!k)return!u&&n;var st=t*ut/k,ht=-t*b/k,ct=rr(rt,a),s=fe(rt,st),lt=fe(a,ht);fh(s,lt);var v=ct,p=ue(s,v),d=ue(v,v),ft=p*p-d*(ue(s,s)-1);if(!(ft<0)){if(g=Math.sqrt(ft),e=fe(v,(-p-g)/d),fh(e,s),e=oe(e),!u)return e;var h=n[0],y=i[0],c=n[1],l=i[1],w;y<h&&(w=h,h=y,y=w);var nt=y-h,tt=f(nt-o)<r,at=tt||nt<r;return!tt&&l<c&&(w=c,c=l,l=w),(at?tt?c+l>0^e[1]<(f(e[0]-h)<r?c:l):c<=e[1]&&e[1]<=l:nt>o^(h<=e[0]&&e[0]<=y))?(it=fe(v,(-p+g)/d),fh(it,s),[e,oe(it)]):void 0}}function h(t,r){var f=i?n:o-n,u=0;return t<-f?u|=1:t>f&&(u|=2),r<-f?u|=4:r>f&&(u|=8),u}var t=Math.cos(n),i=t>0,c=f(t)>r,l=vh(n,6*e);return ly(s,a,l,i?[0,-n]:[-o,n-o])}function vy(n,t,i,r){return function(u){var a=u.a,v=u.b,c=a.x,l=a.y,y=v.x,p=v.y,e=0,o=1,s=y-c,h=p-l,f;if(f=n-c,s||!(f>0)){if(f/=s,s<0){if(f<e)return;f<o&&(o=f)}else if(s>0){if(f>o)return;f>e&&(e=f)}if(f=i-c,s||!(f<0)){if(f/=s,s<0){if(f>o)return;f>e&&(e=f)}else if(s>0){if(f<e)return;f<o&&(o=f)}if(f=t-l,h||!(f>0)){if(f/=h,h<0){if(f<e)return;f<o&&(o=f)}else if(h>0){if(f>o)return;f>e&&(e=f)}if(f=r-l,h||!(f<0)){if(f/=h,h<0){if(f>o)return;f>e&&(e=f)}else if(h>0){if(f<e)return;f<o&&(o=f)}return e>0&&(u.a={x:c+e*s,y:l+e*h}),o<1&&(u.b={x:c+o*s,y:l+o*h}),u}}}}}}function yy(n,i,u,e){function o(t,e){return f(t[0]-n)<r?e>0?0:3:f(t[0]-u)<r?e>0?2:1:f(t[1]-i)<r?e>0?1:0:e>0?3:2}function h(n,t){return s(n.x,t.x)}function s(n,t){var i=o(n,1),r=o(t,1);return i!==r?i-r:i===0?t[1]-n[1]:i===1?n[0]-t[0]:i===2?n[1]-t[1]:t[0]-n[0]}return function(r){function ot(n){for(var r=0,s=c.length,u=n[1],f=0;f<s;++f)for(var e=1,o=c[f],h=o.length,i=o[0],t;e<h;++e)t=o[e],i[1]<=u?t[1]>u&&us(i,t,n)>0&&++r:t[1]<=u&&us(i,t,n)<0&&--r,i=t;return r!==0}function d(t,r,f,h){var c=0,l=0;if(t==null||(c=o(t,f))!==(l=o(r,f))||s(t,r)<0^f>0){do h.point(c===0||c===3?n:u,c>1?e:i);while((c=(c+f+4)%4)!==l)}else h.point(r[0],r[1])}function g(t,r){return n<=t&&t<=u&&i<=r&&r<=e}function nt(n,t){g(n,t)&&r.point(n,t)}function st(){p.point=ut;c&&c.push(y=[]);k=!0;l=!1;w=b=NaN}function ht(){f&&(ut(tt,it),rt&&l&&v.rejoin(),f.push(v.buffer()));p.point=nt;l&&r.lineEnd()}function ut(n,t){var i,u;n=Math.max(-iu,Math.min(iu,n));t=Math.max(-iu,Math.min(iu,t));i=g(n,t);c&&y.push([n,t]);k?(tt=n,it=t,rt=i,k=!1,i&&(r.lineStart(),r.point(n,t))):i&&l?r.point(n,t):(u={a:{x:w,y:b},b:{x:n,y:t}},et(u)?(l||(r.lineStart(),r.point(u.a.x,u.a.y)),r.point(u.b.x,u.b.y),i||r.lineEnd(),a=!1):i&&(r.lineStart(),r.point(n,t),a=!1));w=n;b=t;l=i}var ft=r,v=ay(),et=vy(n,i,u,e),f,c,y,p={point:nt,lineStart:st,lineEnd:ht,polygonStart:function(){r=v;f=[];c=[];a=!0},polygonEnd:function(){r=ft;f=t.merge(f);var i=ot([n,e]),u=a&&i,o=f.length;(u||o)&&(r.polygonStart(),u&&(r.lineStart(),d(null,null,1,r),r.lineEnd()),o&&hy(f,h,i,d,r),r.polygonEnd());f=c=y=null}},tt,it,rt,w,b,l,k,a;return p}}function sh(n){var t=0,i=o/3,r=lh(n),u=r(t,i);return u.parallels=function(n){return arguments.length?r(t=n[0]*o/180,i=n[1]*o/180):[t/o*180,i/o*180]},u}function py(n,t){function e(n,t){var r=Math.sqrt(u-2*i*Math.sin(t))/i;return[r*Math.sin(n*=i),f-r*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),f=Math.sqrt(u)/i;return e.invert=function(n,t){var r=f-t;return[Math.atan2(n,r)/i,ii((u-(n*n+r*r)*i*i)/(2*i))]},e}function wg(){function u(i,r){ch+=t*i-n*r;n=i;t=r}var i,r,n,t;kt.point=function(f,e){kt.point=u;i=n=f;r=t=e};kt.lineEnd=function(){u(i,r)}}function bg(n,t){n<le&&(le=n);n>ve&&(ve=n);t<ae&&(ae=t);t>ye&&(ye=t)}function kg(){function i(n,i){t.push("M",n,",",i,r)}function f(i,r){t.push("M",i,",",r);n.point=e}function e(n,i){t.push("L",n,",",i)}function u(){n.point=i}function o(){t.push("Z")}var r=by(4.5),t=[],n={point:i,lineStart:function(){n.point=f},lineEnd:u,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=u;n.point=i},pointRadius:function(t){return r=by(t),n},result:function(){if(t.length){var n=t.join("");return t=[],n}}};return n}function by(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function wi(n,t){yi+=n;pi+=t;++bt}function ky(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ui+=u*(n+i)/2;fi+=u*(t+r)/2;lt+=u;wi(n=i,t=r)}var n,t;it.point=function(r,u){it.point=i;wi(n=r,t=u)}}function dy(){it.point=wi}function dg(){function u(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ui+=u*(n+i)/2;fi+=u*(t+r)/2;lt+=u;u=t*i-n*r;ur+=u*(n+i);fr+=u*(t+r);ei+=u*3;wi(n=i,t=r)}var i,r,n,t;it.point=function(f,e){it.point=u;wi(i=n=f,r=t=e)};it.lineEnd=function(){u(i,r)}}function gg(n){function r(t,r){n.moveTo(t+i,r);n.arc(t,r,i,0,nt)}function f(i,r){n.moveTo(i,r);t.point=e}function e(t,i){n.lineTo(t,i)}function u(){t.point=r}function o(){n.closePath()}var i=4.5,t={point:r,lineStart:function(){t.point=f},lineEnd:u,polygonStart:function(){t.lineEnd=o},polygonEnd:function(){t.lineEnd=u;t.point=r},pointRadius:function(n){return i=n,t},result:v};return t}function gy(n){function o(n){return(i?c:h)(n)}function h(t){return tp(t,function(i,r){i=n(i,r);t.point(i[0],i[1])})}function c(t){function g(i,r){i=n(i,r);t.point(i[0],i[1])}function l(){f=NaN;r.point=a;t.lineStart()}function a(r,l){var a=vi([r,l]),v=n(r,l);u(f,e,c,o,s,h,f=v[0],e=v[1],c=r,o=a[0],s=a[1],h=a[2],i,t);t.point(f,e)}function v(){r.point=g;t.lineEnd()}function tt(){l();r.point=it;r.lineEnd=rt}function it(n,t){a(y=n,nt=t);p=f;w=e;b=o;k=s;d=h;r.point=a}function rt(){u(f,e,c,o,s,h,p,w,y,b,k,d,i,t);r.lineEnd=v;v()}var y,nt,p,w,b,k,d,c,f,e,o,s,h,r={point:g,lineStart:l,lineEnd:v,polygonStart:function(){t.polygonStart();r.lineStart=tt},polygonEnd:function(){t.polygonEnd();r.lineStart=l}};return r}function u(i,e,o,h,c,l,a,v,y,p,w,b,k,d){var it=a-i,rt=v-e,et=it*it+rt*rt;if(et>4*t&&k--){var nt=h+p,tt=c+w,g=l+b,ot=Math.sqrt(nt*nt+tt*tt+g*g),vt=Math.asin(g/=ot),st=f(f(g)-1)<r||f(o-y)<r?(o+y)/2:Math.atan2(tt,nt),ht=n(st,vt),ut=ht[0],ft=ht[1],ct=ut-i,lt=ft-e,at=rt*ct-it*lt;(at*at/et>t||f((it*ct+rt*lt)/et-.5)>.3||h*p+c*w+l*b<s)&&(u(i,e,o,h,c,l,ut,ft,st,nt/=ot,tt/=ot,g,k,d),d.point(ut,ft),u(ut,ft,st,nt,tt,g,a,v,y,p,w,b,k,d))}}var t=.5,s=Math.cos(30*e),i=16;return o.precision=function(n){return arguments.length?(i=(t=n*n)>0&&16,o):Math.sqrt(t)},o}function nn(n){var t=gy(function(t,i){return n([t*c,i*c])});return function(n){return ip(t(n))}}function np(n){this.stream=n}function tp(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function oi(n){return lh(function(){return n})()}function lh(n){function r(n){return n=l(n[0]*e,n[1]*e),[n[0]*i+s,h-n[1]*i]}function et(n){return n=l.invert((n[0]-s)/i,(h-n[1])/i),n&&[n[0]*c,n[1]*c]}function o(){l=sy(tt=ah(b,k,d),f);var n=f(y,w);return s=a-n[0]*i,h=v+n[1]*i,nt()}function nt(){return u&&(u.valid=!1,u=null),r}var f,tt,l,it=gy(function(n,t){return n=f(n,t),[n[0]*i+s,h-n[1]*i]}),i=150,a=480,v=250,y=0,w=0,b=0,k=0,d=0,s,h,rt=oh,ut=p,g=null,ft=null,u;return r.stream=function(n){return u&&(u.valid=!1),u=ip(rt(tt,it(ut(n)))),u.valid=!0,u},r.clipAngle=function(n){return arguments.length?(rt=n==null?(g=n,oh):pg((g=+n)*e),nt()):g},r.clipExtent=function(n){return arguments.length?(ft=n,ut=n?yy(n[0][0],n[0][1],n[1][0],n[1][1]):p,nt()):ft},r.scale=function(n){return arguments.length?(i=+n,o()):i},r.translate=function(n){return arguments.length?(a=+n[0],v=+n[1],o()):[a,v]},r.center=function(n){return arguments.length?(y=n[0]%360*e,w=n[1]%360*e,o()):[y*c,w*c]},r.rotate=function(n){return arguments.length?(b=n[0]%360*e,k=n[1]%360*e,d=n.length>2?n[2]%360*e:0,o()):[b*c,k*c,d*c]},t.rebind(r,it,"precision"),function(){return f=n.apply(this,arguments),r.invert=f.invert&&et,o()}}function ip(n){return tp(n,function(t,i){n.point(t*e,i*e)})}function ru(n,t){return[n,t]}function rp(n,t){return[n>o?n-nt:n<-o?n+nt:n,t]}function ah(n,t,i){return n?t||i?sy(fp(n),ep(t,i)):fp(n):t||i?ep(t,i):rp}function up(n){return function(t,i){return t+=n,[t>o?t-nt:t<-o?t+nt:t,i]}}function fp(n){var t=up(n);return t.invert=up(-n),t}function ep(n,t){function e(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*i+o*r;return[Math.atan2(s*u-c*f,o*i-h*r),ii(c*u+s*f)]}var i=Math.cos(n),r=Math.sin(n),u=Math.cos(t),f=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*u-s*f;return[Math.atan2(s*u+h*f,o*i+c*r),ii(c*i-o*r)]},e}function vh(n,t){var i=Math.cos(n),r=Math.sin(n);return function(u,f,e,o){var h=e*t,c,s;for(u!=null?(u=op(i,u),f=op(i,f),(e>0?u<f:u>f)&&(u+=e*nt)):(u=n+e*nt,f=n-.5*h),s=u;e>0?s>f:s<f;s-=h)o.point((c=oe([i,-r*Math.cos(s),-r*Math.sin(s)]))[0],c[1])}}function op(n,t){var i=vi(t),u;return i[0]-=n,ee(i),u=uv(-i[1]),((-i[2]<0?-u:u)+2*Math.PI-r)%(2*Math.PI)}function sp(n,i,u){var f=t.range(n,i-r,u).concat(i);return function(n){return f.map(function(t){return[n,t]})}}function hp(n,i,u){var f=t.range(n,i-r,u).concat(i);return function(n){return f.map(function(t){return[t,n]})}}function yh(n){return n.source}function ph(n){return n.target}function tn(n,t,i,r){var f=Math.cos(t),h=Math.sin(t),e=Math.cos(r),l=Math.sin(r),a=f*Math.cos(n),v=f*Math.sin(n),y=e*Math.cos(i),p=e*Math.sin(i),u=2*Math.asin(Math.sqrt(ev(r-t)+f*e*ev(i-n))),o=1/Math.sin(u),s=u?function(n){var t=Math.sin(n*=u)*o,i=Math.sin(u-n)*o,r=i*a+t*y,f=i*v+t*p,e=i*h+t*l;return[Math.atan2(f,r)*c,Math.atan2(e,Math.sqrt(r*r+f*f))*c]}:function(){return[n*c,t*c]};return s.distance=u,s}function rn(){function r(r,u){var h=Math.sin(u*=e),s=Math.cos(u),o=f((r*=e)-i),c=Math.cos(o);wh+=Math.atan2(Math.sqrt((o=s*Math.sin(o))*o+(o=t*h-n*s*c)*o),n*h+t*s*c);i=r;n=h;t=s}var i,n,t;bi.point=function(u,f){i=u*e;n=Math.sin(f*=e);t=Math.cos(f);bi.point=r};bi.lineEnd=function(){bi.point=bi.lineEnd=v}}function uu(n,t){function i(t,i){var f=Math.cos(t),r=Math.cos(i),u=n(f*r);return[u*r*Math.sin(t),u*Math.sin(i)]}return i.invert=function(n,i){var r=Math.sqrt(n*n+i*i),u=t(r),f=Math.sin(u),e=Math.cos(u);return[Math.atan2(n*f,r*e),Math.asin(r&&i*f/r)]},i}function cp(n,t){function s(n,t){u>0?t<-l+r&&(t=-l+r):t>l-r&&(t=l-r);var e=u/Math.pow(f(t),i);return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}var e=Math.cos(n),f=function(n){return Math.tan(o/4+n/2)},i=n===t?Math.sin(n):Math.log(e/Math.cos(t))/Math.log(f(t)/f(n)),u=e*Math.pow(f(n),i)/i;return i?(s.invert=function(n,t){var r=u-t,f=rv(i)*Math.sqrt(n*n+r*r);return[Math.atan2(n,r)/i,2*Math.atan(Math.pow(u/f,1/i))-l]},s):pe}function lp(n,t){function o(n,t){var r=u-t;return[r*Math.sin(i*n),u-r*Math.cos(i*n)]}var e=Math.cos(n),i=n===t?Math.sin(n):(e-Math.cos(t))/(t-n),u=e/i+n;return f(i)<r?ru:(o.invert=function(n,t){var r=u-t;return[Math.atan2(n,r)/i,u-rv(i)*Math.sqrt(n*n+r*r)]},o)}function pe(n,t){return[n,Math.log(Math.tan(o/4+t/2))]}function ap(n){var t=oi(n),r=t.scale,u=t.translate,f=t.clipExtent,i;return t.scale=function(){var n=r.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.translate=function(){var n=u.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.clipExtent=function(n){var h=f.apply(t,arguments),e,s;return h===t?(i=n==null)&&(e=o*r(),s=u(),f([[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]])):i&&(h=null),h},t.clipExtent(null)}function tc(n,t){return[Math.log(Math.tan(o/4+t/2)),-n]}function er(n){return n[0]}function fu(n){return n[1]}function vp(n){for(var u=n.length,i=[0,1],t=2,r=2;r<u;r++){while(t>1&&us(n[i[t-2]],n[i[t-1]],n[r])<=0)--t;i[t++]=r}return i.slice(0,t)}function un(n,t){return n[0]-t[0]||n[1]-t[1]}function ic(n,t,i){return(i[0]-t[0])*(n[1]-t[1])<(i[1]-t[1])*(n[0]-t[0])}function rc(n,t,i,r){var u=n[0],e=i[0],o=t[0]-u,s=r[0]-e,f=n[1],h=i[1],c=t[1]-f,l=r[1]-h,a=(s*(f-h)-l*(u-e))/(l*o-s*c);return[u+a*o,f+a*c]}function yp(n){var t=n[0],i=n[n.length-1];return!(t[0]-i[0]||t[1]-i[1])}function fn(){ke(this);this.edge=this.site=this.circle=null}function pp(n){var t=uc.pop()||new fn;return t.site=n,t}function oc(n){cr(n);sr.remove(n);uc.push(n);ke(n)}function en(n){var a=n.circle,o=a.x,s=a.cy,v={x:o,y:s},h=n.P,c=n.N,u=[n],i,t,l,e;for(oc(n),i=h;i.circle&&f(o-i.circle.x)<r&&f(s-i.circle.cy)<r;)h=i.P,u.unshift(i),oc(i),i=h;for(u.unshift(i),cr(i),t=c;t.circle&&f(o-t.circle.x)<r&&f(s-t.circle.cy)<r;)c=t.N,u.push(t),oc(t),t=c;for(u.push(t),cr(t),l=u.length,e=1;e<l;++e)t=u[e],i=u[e-1],we(t.edge,i.site,t.site,v);i=u[0];t=u[l-1];t.edge=su(i.site,t.site,null,v);hr(i);hr(t)}function on(n){for(var b=n.x,k=n.y,t,i,a,v,u=sr._,f;u;)if(a=wp(u,k)-b,a>r)u=u.L;else if(v=b-sn(u,k),v>r){if(!u.R){t=u;break}u=u.R}else{a>-r?(t=u.P,i=u):v>-r?(t=u,i=u.N):t=i=u;break}if(f=pp(n),sr.insert(t,f),t||i){if(t===i){cr(t);i=pp(t.site);sr.insert(f,i);f.edge=i.edge=su(t.site,f.site);hr(t);hr(i);return}if(!i){f.edge=su(t.site,f.site);return}cr(t);cr(i);var e=t.site,y=e.x,p=e.y,o=n.x-y,s=n.y-p,h=i.site,c=h.x-y,l=h.y-p,d=2*(o*l-s*c),g=o*o+s*s,nt=c*c+l*l,w={x:(l*g-s*nt)/d+y,y:(o*nt-c*g)/d+p};we(i.edge,e,h,w);f.edge=su(e,n,null,w);i.edge=su(n,h,null,w);hr(t);hr(i)}}function wp(n,t){var i=n.site,u=i.x,l=i.y,f=l-t,e;if(!f)return u;if(e=n.P,!e)return-Infinity;i=e.site;var o=i.x,a=i.y,r=a-t;if(!r)return o;var s=o-u,h=1/f-1/r,c=s/r;return h?(-c+Math.sqrt(c*c-2*h*(s*s/(-2*r)-a+r/2+l-f/2)))/h+u:(u+o)/2}function sn(n,t){var r=n.N,i;return r?wp(r,t):(i=n.site,i.y===t?i.x:Infinity)}function bp(n){this.site=n;this.edges=[]}function hn(n){for(var s=n[0][0],h=n[1][0],c=n[0][1],l=n[1][1],t,i,u,e,b=ki,k=b.length,o,a,v,y,w,p;k--;)if(o=b[k],o&&o.prepare())for(v=o.edges,y=v.length,a=0;a<y;)p=v[a].end(),u=p.x,e=p.y,w=v[++a%y].start(),t=w.x,i=w.y,(f(u-t)>r||f(e-i)>r)&&(v.splice(a,0,new be(vn(o.site,p,f(u-s)<r&&l-e>r?{x:s,y:f(t-s)<r?i:l}:f(e-l)<r&&h-u>r?{x:f(i-l)<r?t:h,y:l}:f(u-h)<r&&e-c>r?{x:h,y:f(t-h)<r?i:c}:f(e-c)<r&&u-s>r?{x:f(i-c)<r?t:s,y:c}:null),o.site,null)),++y)}function kp(n,t){return t.angle-n.angle}function cn(){ke(this);this.x=this.y=this.arc=this.site=this.cy=null}function hr(n){var w=n.P,b=n.N,u,t;if(w&&b){var s=w.site,h=n.site,c=b.site;if(s!==c){var l=h.x,a=h.y,f=s.x-l,e=s.y-a,o=c.x-l,r=c.y-a,v=2*(f*r-e*o);if(!(v>=-sf)){var k=f*f+e*e,d=o*o+r*r,y=(r*k-e*d)/v,p=(f*d-o*k)/v,r=p+a,i=ec.pop()||new cn;for(i.arc=n,i.site=h,i.x=y+l,i.y=r+Math.sqrt(y*y+p*p),i.cy=r,n.circle=i,u=null,t=ou._;t;)if(i.y<t.y||i.y===t.y&&i.x<=t.x)if(t.L)t=t.L;else{u=t.P;break}else if(t.R)t=t.R;else{u=t;break}ou.insert(u,i);u||(fc=i)}}}}function cr(n){var t=n.circle;t&&(t.P||(fc=t.N),ou.remove(t),ec.push(t),ke(t),n.circle=null)}function ln(n){for(var i=or,e=vy(n[0][0],n[0][1],n[1][0],n[1][1]),u=i.length,t;u--;)t=i[u],(!an(t,n)||!e(t)||f(t.a.x-t.b.x)<r&&f(t.a.y-t.b.y)<r)&&(t.a=t.b=null,i.splice(u,1))}function an(n,t){var f=n.b;if(f)return!0;var i=n.a,h=t[0][0],c=t[1][0],e=t[0][1],o=t[1][1],p=n.l,w=n.r,l=p.x,a=p.y,v=w.x,y=w.y,s=(l+v)/2,b=(a+y)/2,r,u;if(y===a){if(s<h||s>=c)return;if(l>v){if(i){if(i.y>=o)return}else i={x:s,y:e};f={x:s,y:o}}else{if(i){if(i.y<e)return}else i={x:s,y:o};f={x:s,y:e}}}else if(r=(l-v)/(y-a),u=b-r*s,r<-1||r>1)if(l>v){if(i){if(i.y>=o)return}else i={x:(e-u)/r,y:e};f={x:(o-u)/r,y:o}}else{if(i){if(i.y<e)return}else i={x:(o-u)/r,y:o};f={x:(e-u)/r,y:e}}else if(a<y){if(i){if(i.x>=c)return}else i={x:h,y:r*h+u};f={x:c,y:r*c+u}}else{if(i){if(i.x<h)return}else i={x:c,y:r*c+u};f={x:h,y:r*h+u}}return n.a=i,n.b=f,!0}function dp(n,t){this.l=n;this.r=t;this.a=this.b=null}function su(n,t,i,r){var u=new dp(n,t);return or.push(u),i&&we(u,n,t,i),r&&we(u,t,n,r),ki[n.i].edges.push(new be(u,n,t)),ki[t.i].edges.push(new be(u,t,n)),u}function vn(n,t,i){var r=new dp(n,null);return r.a=t,r.b=i,or.push(r),r}function we(n,t,i,r){n.a||n.b?n.l===i?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=i)}function be(n,t,i){var r=n.a,u=n.b;this.edge=n;this.site=t;this.angle=i?Math.atan2(i.y-t.y,i.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function sc(){this._=null}function ke(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function hu(n,t){var i=t,r=t.R,u=i.U;u?u.L===i?u.L=r:u.R=r:n._=r;r.U=u;i.U=r;i.R=r.L;i.R&&(i.R.U=i);r.L=i}function cu(n,t){var i=t,r=t.L,u=i.U;u?u.L===i?u.L=r:u.R=r:n._=r;r.U=u;i.U=r;i.L=r.R;i.L&&(i.L.U=i);r.R=i}function gp(n){while(n.L)n=n.L;return n}function hc(n,t){var i=n.sort(yn).pop(),u,f,r,e;for(or=[],ki=new Array(n.length),sr=new sc,ou=new sc;;)if(r=fc,i&&(!r||i.y<r.y||i.y===r.y&&i.x<r.x))(i.x!==u||i.y!==f)&&(ki[i.i]=new bp(i),on(i),u=i.x,f=i.y),i=n.pop();else if(r)en(r.arc);else break;return t&&(ln(t),hn(t)),e={cells:ki,edges:or},sr=ou=or=ki=null,e}function yn(n,t){return t.y-n.y||t.x-n.x}function pn(n,t,i){return(n.x-i.x)*(t.y-n.y)-(n.x-t.x)*(i.y-n.y)}function wn(n){return n.x}function bn(n){return n.y}function nw(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function au(n,t,i,r,u,f){if(!n(t,i,r,u,f)){var o=(i+u)*.5,s=(r+f)*.5,e=t.nodes;e[0]&&au(n,e[0],i,r,o,s);e[1]&&au(n,e[1],o,r,u,s);e[2]&&au(n,e[2],i,s,o,f);e[3]&&au(n,e[3],o,s,u,f)}}function kn(n,t,i,r,u,f,e){var s=Infinity,h;return function o(n,c,l,a,v){var p,y,tt;if(!(c>f)&&!(l>e)&&!(a<r)&&!(v<u)){if(k=n.point){var k,d=t-n.x,g=i-n.y,nt=d*d+g*g;nt<s&&(p=Math.sqrt(s=nt),r=t-p,u=i-p,f=t+p,e=i+p,h=k)}var it=n.nodes,w=(c+a)*.5,b=(l+v)*.5,rt=t>=w,ut=i>=b;for(y=ut<<1|rt,tt=y+4;y<tt;++y)if(n=it[y&3])switch(y&3){case 0:o(n,c,l,w,b);break;case 1:o(n,w,l,a,b);break;case 2:o(n,c,b,w,v);break;case 3:o(n,w,b,a,v)}}}(n,r,u,f,e),h}function cc(n,i){n=t.rgb(n);i=t.rgb(i);var r=n.r,u=n.g,f=n.b,e=i.r-r,o=i.g-u,s=i.b-f;return function(n){return"#"+ir(Math.round(r+e*n))+ir(Math.round(u+o*n))+ir(Math.round(f+s*n))}}function tw(n,t){var u={},r={};for(var i in n)i in t?u[i]=di(n[i],t[i]):r[i]=n[i];for(i in t)i in n||(r[i]=t[i]);return function(n){for(i in u)r[i]=u[i](n);return r}}function dt(n,t){return n=+n,t=+t,function(i){return n*(1-i)+t*i}}function iw(n,t){var e=de.lastIndex=ge.lastIndex=0,s,f,u,r=-1,i=[],o=[];for(n=n+"",t=t+"";(s=de.exec(n))&&(f=ge.exec(t));)(u=f.index)>e&&(u=t.slice(e,u),i[r]?i[r]+=u:i[++r]=u),(s=s[0])===(f=f[0])?i[r]?i[r]+=f:i[++r]=f:(i[++r]=null,o.push({i:r,x:dt(s,f)})),e=ge.lastIndex;return e<t.length&&(u=t.slice(e),i[r]?i[r]+=u:i[++r]=u),i.length<2?o[0]?(t=o[0].x,function(n){return t(n)+""}):function(){return t}:(t=o.length,function(n){for(var r=0,u;r<t;++r)i[(u=o[r]).i]=u.x(n);return i.join("")})}function di(n,i){for(var r=t.interpolators.length,u;--r>=0&&!(u=t.interpolators[r](n,i)););return u}function no(n,t){for(var u=[],r=[],e=n.length,o=t.length,f=Math.min(n.length,t.length),i=0;i<f;++i)u.push(di(n[i],t[i]));for(;i<e;++i)r[i]=n[i];for(;i<o;++i)r[i]=t[i];return function(n){for(i=0;i<f;++i)r[i]=u[i](n);return r}}function ntt(n){return function(t){return t<=0?0:t>=1?1:n(t)}}function uw(n){return function(t){return 1-n(1-t)}}function fw(n){return function(t){return.5*(t<.5?n(2*t):2-n(2-2*t))}}function ttt(n){return n*n}function itt(n){return n*n*n}function rtt(n){if(n<=0)return 0;if(n>=1)return 1;var t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function utt(n){return function(t){return Math.pow(t,n)}}function ftt(n){return 1-Math.cos(n*l)}function ett(n){return Math.pow(2,10*(n-1))}function ott(n){return 1-Math.sqrt(1-n*n)}function stt(n,t){var i;return arguments.length<2&&(t=.45),arguments.length?i=t/nt*Math.asin(1/n):(n=1,i=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-i)*nt/t)}}function htt(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function ctt(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function ltt(n,i){n=t.hcl(n);i=t.hcl(i);var u=n.h,f=n.c,o=n.l,r=i.h-u,e=i.c-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.c:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:r<-180&&(r+=360),function(n){return hs(u+r*n,f+e*n,o+s*n)+""}}function att(n,i){n=t.hsl(n);i=t.hsl(i);var u=n.h,f=n.s,o=n.l,r=i.h-u,e=i.s-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.s:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:r<-180&&(r+=360),function(n){return ss(u+r*n,f+e*n,o+s*n)+""}}function vtt(n,i){n=t.lab(n);i=t.lab(i);var r=n.l,u=n.a,f=n.b,e=i.l-r,o=i.a-u,s=i.b-f;return function(n){return lv(r+e*n,u+o*n,f+s*n)+""}}function ew(n,t){return t-=n,function(i){return Math.round(n+t*i)}}function ow(n){var t=[n.a,n.b],i=[n.c,n.d],r=hw(t),u=sw(t,i),f=hw(ytt(i,t,-u))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1);this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*c;this.translate=[n.e,n.f];this.scale=[r,f];this.skew=f?Math.atan2(u,f)*c:0}function sw(n,t){return n[0]*t[0]+n[1]*t[1]}function hw(n){var t=Math.sqrt(sw(n,n));return t&&(n[0]/=t,n[1]/=t),t}function ytt(n,t,i){return n[0]+=i*t[0],n[1]+=i*t[1],n}function lr(n){return n.length?n.pop()+",":""}function ptt(n,t,i,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=i.push("translate(",null,",",null,")");r.push({i:u-4,x:dt(n[0],t[0])},{i:u-2,x:dt(n[1],t[1])})}else(t[0]||t[1])&&i.push("translate("+t+")")}function wtt(n,t,i,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:i.push(lr(i)+"rotate(",null,")")-2,x:dt(n,t)})):t&&i.push(lr(i)+"rotate("+t+")")}function btt(n,t,i,r){n!==t?r.push({i:i.push(lr(i)+"skewX(",null,")")-2,x:dt(n,t)}):t&&i.push(lr(i)+"skewX("+t+")")}function ktt(n,t,i,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=i.push(lr(i)+"scale(",null,",",null,")");r.push({i:u-4,x:dt(n[0],t[0])},{i:u-2,x:dt(n[1],t[1])})}else(t[0]!==1||t[1]!==1)&&i.push(lr(i)+"scale("+t+")")}function lw(n,i){var r=[],u=[];return n=t.transform(n),i=t.transform(i),ptt(n.translate,i.translate,r,u),wtt(n.rotate,i.rotate,r,u),btt(n.skew,i.skew,r,u),ktt(n.scale,i.scale,r,u),n=i=null,function(n){for(var t=-1,f=u.length,i;++t<f;)r[(i=u[t]).i]=i.x(n);return r.join("")}}function dtt(n,t){return t=(t-=n=+n)||1/t,function(i){return(i-n)/t}}function gtt(n,t){return t=(t-=n=+n)||1/t,function(i){return Math.max(0,Math.min(1,(i-n)/t))}}function nit(n){for(var t=n.source,i=n.target,u=tit(t,i),r=[t],f;t!==u;)t=t.parent,r.push(t);for(f=r.length;i!==u;)r.splice(f,0,i),i=i.parent;return r}function aw(n){for(var i=[],t=n.parent;t!=null;)i.push(n),n=t,t=t.parent;return i.push(n),i}function tit(n,t){if(n===t)return n;for(var r=aw(n),u=aw(t),i=r.pop(),f=u.pop(),e=null;i===f;)e=i,i=r.pop(),f=u.pop();return e}function iit(n){n.fixed|=2}function rit(n){n.fixed&=-7}function uit(n){n.fixed|=4;n.px=n.x;n.py=n.y}function fit(n){n.fixed&=-5}function vw(n,t,i){var f=0,e=0,u;if(n.charge=0,!n.leaf)for(var o=n.nodes,h=o.length,s=-1,r;++s<h;)(r=o[s],r!=null)&&(vw(r,t,i),n.charge+=r.charge,f+=r.charge*r.cx,e+=r.charge*r.cy);n.point&&(n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5),u=t*i[n.point.index],n.charge+=n.pointCharge=u,f+=u*n.point.x,e+=u*n.point.y);n.cx=f/n.charge;n.cy=e/n.charge}function vu(n,i){return t.rebind(n,i,"sort","children","value"),n.nodes=n,n.links=ait,n}function yu(n,t){for(var u=[n],i,r;(n=u.pop())!=null;)if(t(n),(r=n.children)&&(i=r.length))while(--i>=0)u.push(r[i])}function at(n,t){for(var u=[n],f=[],i,e,r;(n=u.pop())!=null;)if(f.push(n),(r=n.children)&&(e=r.length))for(i=-1;++i<e;)u.push(r[i]);while((n=f.pop())!=null)t(n)}function hit(n){return n.children}function cit(n){return n.value}function lit(n,t){return t.value-n.value}function ait(n){return t.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function vit(n){return n.x}function yit(n){return n.y}function pit(n,t,i){n.y0=t;n.y=i}function ac(n){return t.range(n.length)}function vc(n){for(var t=-1,r=n[0].length,i=[];++t<r;)i[t]=0;return i}function wit(n){for(var t=1,i=0,r=n[0][1],u,f=n.length;t<f;++t)(u=n[t][1])>r&&(i=t,r=u);return i}function bit(n){return n.reduce(kit,0)}function kit(n,t){return n+t[1]}function dit(n,t){return ww(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ww(n,t){for(var i=-1,r=+n[0],f=(n[1]-r)/t,u=[];++i<=t;)u[i]=f*i+r;return u}function git(n){return[t.min(n),t.max(n)]}function nrt(n,t){return n.value-t.value}function yc(n,t){var i=n._pack_next;n._pack_next=t;t._pack_prev=n;t._pack_next=i;i._pack_prev=t}function bw(n,t){n._pack_next=t;t._pack_prev=n}function kw(n,t){var i=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>i*i+r*r}function dw(n){function h(n){c=Math.min(n.x-n.r,c);l=Math.max(n.x+n.r,l);a=Math.min(n.y-n.r,a);v=Math.max(n.y+n.r,v)}if((u=n.children)&&(s=u.length)){var u,c=Infinity,l=-Infinity,a=Infinity,v=-Infinity,i,r,t,f,e,o,s;if(u.forEach(trt),i=u[0],i.x=-i.r,i.y=0,h(i),s>1&&(r=u[1],r.x=r.r,r.y=0,h(r),s>2))for(t=u[2],nb(i,r,t),h(t),yc(i,t),i._pack_prev=t,yc(t,r),r=i._pack_next,f=3;f<s;f++){nb(i,r,t=u[f]);var y=0,p=1,w=1;for(e=r._pack_next;e!==r;e=e._pack_next,p++)if(kw(e,t)){y=1;break}if(y==1)for(o=i._pack_prev;o!==e._pack_prev;o=o._pack_prev,w++)if(kw(o,t))break;y?(p<w||p==w&&r.r<i.r?bw(i,r=e):bw(i=o,r),f--):(yc(i,t),r=t,h(t))}var k=(c+l)/2,d=(a+v)/2,b=0;for(f=0;f<s;f++)t=u[f],t.x-=k,t.y-=d,b=Math.max(b,t.r+Math.sqrt(t.x*t.x+t.y*t.y));n.r=b;u.forEach(irt)}}function trt(n){n._pack_next=n._pack_prev=n}function irt(n){delete n._pack_next;delete n._pack_prev}function gw(n,t,i,r){var u=n.children,f,e;if(n.x=t+=r*n.x,n.y=i+=r*n.y,n.r*=r,u)for(f=-1,e=u.length;++f<e;)gw(u[f],t,i,r)}function nb(n,t,i){var r=n.r+i.r,f=t.x-n.x,e=t.y-n.y,u,o,s,h;r&&(f||e)?(u=t.r+i.r,o=f*f+e*e,u*=u,r*=r,s=.5+(r-u)/(2*o),h=Math.sqrt(Math.max(0,2*u*(r+o)-(r-=o)*r-u*u))/(2*o),i.x=n.x+s*f+h*e,i.y=n.y+s*e-h*f):(i.x=n.x+r,i.y=n.y)}function tb(n,t){return n.parent==t.parent?1:2}function pc(n){var t=n.children;return t.length?t[0]:n.t}function wc(n){var t=n.children,i;return(i=t.length)?t[i-1]:n.t}function rrt(n,t,i){var r=i/(t.i-n.i);t.c-=r;t.s+=i;n.c+=r;t.z+=i;t.m+=i}function urt(n){for(var i=0,f=0,r=n.children,u=r.length,t;--u>=0;)t=r[u],t.z+=i,t.m+=i,i+=t.s+(f+=t.c)}function frt(n,t,i){return n.a.parent===t.parent?n.a:i}function ert(n){return 1+t.max(n,function(n){return n.y})}function ort(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function ib(n){var t=n.children;return t&&t.length?ib(t[0]):n}function rb(n){var t=n.children,i;return t&&(i=t.length)?rb(t[i-1]):n}function bc(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function ub(n,t){var u=n.x+t[3],f=n.y+t[0],i=n.dx-t[1]-t[3],r=n.dy-t[0]-t[2];return i<0&&(u+=i/2,i=0),r<0&&(f+=r/2,r=0),{x:u,y:f,dx:i,dy:r}}function ar(n){var t=n[0],i=n[n.length-1];return t<i?[t,i]:[i,t]}function to(n){return n.rangeExtent?n.rangeExtent():ar(n.range())}function srt(n,t,i,r){var u=i(n[0],n[1]),f=r(t[0],t[1]);return function(n){return f(u(n))}}function io(n,t){var i=0,r=n.length-1,u=n[i],f=n[r],e;return f<u&&(e=i,i=r,r=e,e=u,u=f,f=e),n[i]=t.floor(u),n[r]=t.ceil(f),n}function fb(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:eb}function hrt(n,i,r,u){var o=[],s=[],f=0,e=Math.min(n.length,i.length)-1;for(n[e]<n[0]&&(n=n.slice().reverse(),i=i.slice().reverse());++f<=e;)o.push(r(n[f-1],n[f])),s.push(u(i[f-1],i[f]));return function(i){var r=t.bisect(n,i,1,e)-1;return s[r](o[r](i))}}function ob(n,t,i,r){function f(){var f=Math.min(n.length,t.length)>2?hrt:srt,s=r?gtt:dtt;return e=f(n,t,s,i),o=f(t,n,s,di),u}function u(n){return e(n)}var e,o;return u.invert=function(n){return o(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),f()):n},u.range=function(n){return arguments.length?(t=n,f()):t},u.rangeRound=function(n){return u.range(n).interpolate(ew)},u.clamp=function(n){return arguments.length?(r=n,f()):r},u.interpolate=function(n){return arguments.length?(i=n,f()):i},u.ticks=function(t){return dc(n,t)},u.tickFormat=function(t,i){return gc(n,t,i)},u.nice=function(t){return sb(n,t),f()},u.copy=function(){return ob(n,t,i,r)},f()}function kc(n,i){return t.rebind(n,i,"range","rangeRound","interpolate","clamp")}function sb(n,t){return io(n,fb(vr(n,t)[2])),io(n,fb(vr(n,t)[2])),n}function vr(n,t){t==null&&(t=10);var r=ar(n),f=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(f/t)/Math.LN10)),u=t/f*i;return u<=.15?i*=10:u<=.35?i*=5:u<=.75&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+i*.5,r[2]=i,r}function dc(n,i){return t.range.apply(t,vr(n,i))}function gc(n,i,r){var e=vr(n,i),u,o;if(r){if(u=gs.exec(r),u.shift(),u[8]==="s")return o=t.formatPrefix(Math.max(f(e[0]),f(e[1]))),u[7]||(u[7]="."+ro(o.scale(e[2]))),u[8]="f",r=t.format(u.join("")),function(n){return r(o.scale(n))+o.symbol};u[7]||(u[7]="."+crt(u[8],e));r=u.join("")}else r=",."+ro(e[2])+"f";return t.format(r)}function ro(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function crt(n,t){var i=ro(t[2]);return n in hb?Math.abs(i-ro(Math.max(f(t[0]),f(t[1]))))+ +(n!=="e"):i-(n==="%")*2}function cb(n,i,r,u){function e(n){return(r?Math.log(n<0?0:n):-Math.log(n>0?0:-n))/Math.log(i)}function o(n){return r?Math.pow(i,n):-Math.pow(i,-n)}function f(t){return n(e(t))}return f.invert=function(t){return o(n.invert(t))},f.domain=function(t){return arguments.length?(r=t[0]>=0,n.domain((u=t.map(Number)).map(e)),f):u},f.base=function(t){return arguments.length?(i=+t,n.domain(u.map(e)),f):i},f.nice=function(){var t=io(u.map(e),r?Math:lb);return n.domain(t),u=t.map(o),f},f.ticks=function(){var h=ar(u),t=[],c=h[0],l=h[1],n=Math.floor(e(c)),s=Math.ceil(e(l)),a=i%1?2:i,f;if(isFinite(s-n)){if(r){for(;n<s;n++)for(f=1;f<a;f++)t.push(o(n)*f);t.push(o(n))}else for(t.push(o(n));n++<s;)for(f=a-1;f>0;f--)t.push(o(n)*f);for(n=0;t[n]<c;n++);for(s=t.length;t[s-1]>l;s--);t=t.slice(n,s)}return t},f.tickFormat=function(n,r){if(!arguments.length)return nl;arguments.length<2?r=nl:typeof r!="function"&&(r=t.format(r));var u=Math.max(1,i*n/f.ticks().length);return function(n){var t=n/o(Math.round(e(n)));return t*i<i-.5&&(t*=i),t<=u?r(n):""}},f.copy=function(){return cb(n.copy(),i,r,u)},kc(f,n)}function ab(n,t,i){function r(t){return n(u(t))}var u=uo(t),f=uo(1/t);return r.invert=function(t){return f(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((i=t.map(Number)).map(u)),r):i},r.ticks=function(n){return dc(i,n)},r.tickFormat=function(n,t){return gc(i,n,t)},r.nice=function(n){return r.domain(sb(i,n))},r.exponent=function(e){return arguments.length?(u=uo(t=e),f=uo(1/t),n.domain(i.map(u)),r):t},r.copy=function(){return ab(n.copy(),t,i)},kc(r,n)}function uo(n){return function(t){return t<0?-Math.pow(-t,n):Math.pow(t,n)}}function vb(n,i){function r(t){return u[((e.get(t)||(i.t==="range"?e.set(t,n.push(t)):NaN))-1)%u.length]}function o(i,r){return t.range(n.length).map(function(n){return i+r*n})}var e,u,f;return r.domain=function(t){if(!arguments.length)return n;n=[];e=new yt;for(var f=-1,o=t.length,u;++f<o;)e.has(u=t[f])||e.set(u,n.push(u));return r[i.t].apply(r,i.a)},r.range=function(n){return arguments.length?(u=n,f=0,i={t:"range",a:arguments},r):u},r.rangePoints=function(t,e){arguments.length<2&&(e=0);var s=t[0],h=t[1],c=n.length<2?(s=(s+h)/2,0):(h-s)/(n.length-1+e);return u=o(s+c*e/2,c),f=0,i={t:"rangePoints",a:arguments},r},r.rangeRoundPoints=function(t,e){arguments.length<2&&(e=0);var s=t[0],h=t[1],c=n.length<2?(s=h=Math.round((s+h)/2),0):(h-s)/(n.length-1+e)|0;return u=o(s+Math.round(c*e/2+(h-s-(n.length-1+e)*c)/2),c),f=0,i={t:"rangeRoundPoints",a:arguments},r},r.rangeBands=function(t,e,s){arguments.length<2&&(e=0);arguments.length<3&&(s=e);var h=t[1]<t[0],l=t[+h],a=t[1-h],c=(a-l)/(n.length-e+2*s);return u=o(l+c*s,c),h&&u.reverse(),f=c*(1-e),i={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(t,e,s){arguments.length<2&&(e=0);arguments.length<3&&(s=e);var h=t[1]<t[0],c=t[+h],a=t[1-h],l=Math.floor((a-c)/(n.length-e+2*s));return u=o(c+Math.round((a-c-(n.length-e)*l)/2),l),h&&u.reverse(),f=Math.round(l*(1-e)),i={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return f},r.rangeExtent=function(){return ar(i.a[0])},r.copy=function(){return vb(n,i)},r.domain(n)}function yb(n,i){function f(){var f=0,e=i.length;for(r=[];++f<e;)r[f-1]=t.quantile(n,f/e);return u}function u(n){if(!isNaN(n=+n))return i[t.bisect(r,n)]}var r;return u.domain=function(t){return arguments.length?(n=t.map(hi).filter(vt).sort(tr),f()):n},u.range=function(n){return arguments.length?(i=n,f()):i},u.quantiles=function(){return r},u.invertExtent=function(t){return t=i.indexOf(t),t<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},u.copy=function(){return yb(n,i)},f()}function pb(n,t,i){function r(t){return i[Math.max(0,Math.min(e,Math.floor(u*(t-n))))]}function f(){return u=i.length/(t-n),e=i.length-1,r}var u,e;return r.domain=function(i){return arguments.length?(n=+i[0],t=+i[i.length-1],f()):[n,t]},r.range=function(n){return arguments.length?(i=n,f()):i},r.invertExtent=function(t){return t=i.indexOf(t),t=t<0?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return pb(n,t,i)},f()}function wb(n,i){function r(r){if(r<=r)return i[t.bisect(n,r)]}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(n){return arguments.length?(i=n,r):i},r.invertExtent=function(t){return t=i.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return wb(n,i)},r}function bb(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=i.map(t),t):n},t.ticks=function(t){return dc(n,t)},t.tickFormat=function(t,i){return gc(n,t,i)},t.copy=function(){return bb(n)},t}function prt(){return 0}function wrt(n){return n.innerRadius}function brt(n){return n.outerRadius}function kb(n){return n.startAngle}function db(n){return n.endAngle}function krt(n){return n&&n.padAngle}function fo(n,t,i,r){return(n-i)*t-(t-r)*n>0?0:1}function eo(n,t,i,r,u){var v=n[0]-t[0],y=n[1]-t[1],nt=(u?r:-r)/Math.sqrt(v*v+y*y),p=nt*y,w=-nt*v,b=n[0]+p,k=n[1]+w,d=t[0]+p,g=t[1]+w,tt=(b+d)/2,it=(k+g)/2,e=d-b,f=g-k,s=e*e+f*f,h=i-r,o=b*g-d*k,c=(f<0?-1:1)*Math.sqrt(Math.max(0,h*h*s-o*o)),l=(o*f-e*c)/s,a=(-o*e-f*c)/s,rt=(o*f+e*c)/s,ut=(-o*e+f*c)/s,ft=l-tt,et=a-it,ot=rt-tt,st=ut-it;return ft*ft+et*et>ot*ot+st*st&&(l=rt,a=ut),[[l-p,a-w],[l*i/h,a*i/h]]}function gb(n){function t(t){function a(){c.push("M",i(n(e),o))}for(var c=[],e=[],s=-1,v=t.length,l,y=h(r),p=h(u);++s<v;)f.call(this,l=t[s],s)?e.push([+y.call(this,l,s),+p.call(this,l,s)]):e.length&&(a(),e=[]);return e.length&&a(),c.length?c.join(""):null}var r=er,u=fu,f=tu,i=et,e=i.key,o=.7;return t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(f=n,t):f},t.interpolate=function(n){return arguments.length?(e=typeof n=="function"?i=n:(i=oo.get(n)||et).key,t):e},t.tension=function(n){return arguments.length?(o=n,t):o},t}function et(n){return n.length>1?n.join("L"):n+"Z"}function nk(n){return n.join("L")+"Z"}function drt(n){for(var r=0,u=n.length,t=n[0],i=[t[0],",",t[1]];++r<u;)i.push("H",(t[0]+(t=n[r])[0])/2,"V",t[1]);return u>1&&i.push("H",t[0]),i.join("")}function tl(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("V",(t=n[i])[1],"H",t[0]);return r.join("")}function il(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("H",(t=n[i])[0],"V",t[1]);return r.join("")}function grt(n,t){return n.length<4?et(n):n[1]+so(n.slice(1,-1),rl(n,t))}function nut(n,t){return n.length<3?nk(n):n[0]+so((n.push(n[0]),n),rl([n[n.length-2]].concat(n,[n[1]]),t))}function tut(n,t){return n.length<3?et(n):n[0]+so(n,rl(n,t))}function so(n,t){var o,h;if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return et(n);var c=n.length!=t.length,f="",s=n[0],i=n[1],e=t[0],r=e,u=1;if(c&&(f+="Q"+(i[0]-e[0]*2/3)+","+(i[1]-e[1]*2/3)+","+i[0]+","+i[1],s=n[1],u=2),t.length>1)for(r=t[1],i=n[u],u++,f+="C"+(s[0]+e[0])+","+(s[1]+e[1])+","+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1],o=2;o<t.length;o++,u++)i=n[u],r=t[o],f+="S"+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1];return c&&(h=n[u],f+="Q"+(i[0]+r[0]*2/3)+","+(i[1]+r[1]*2/3)+","+h[0]+","+h[1]),f}function rl(n,t){for(var u=[],f=(1-t)/2,r,e=n[0],i=n[1],o=1,s=n.length;++o<s;)r=e,e=i,i=n[o],u.push([f*(i[0]-r[0]),f*(i[1]-r[1])]);return u}function tk(n){if(n.length<3)return et(n);var o=1,s=n.length,t=n[0],i=t[0],r=t[1],u=[i,i,i,(t=n[1])[0]],f=[r,r,r,t[1]],e=[i,",",r,"L",rt(si,u),",",rt(si,f)];for(n.push(n[s-1]);++o<=s;)t=n[o],u.shift(),u.push(t[0]),f.shift(),f.push(t[1]),ul(e,u,f);return n.pop(),e.push("L",t),e.join("")}function iut(n){if(n.length<4)return et(n);for(var f=[],i=-1,e=n.length,t,r=[0],u=[0];++i<3;)t=n[i],r.push(t[0]),u.push(t[1]);for(f.push(rt(si,r)+","+rt(si,u)),--i;++i<e;)t=n[i],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),ul(f,r,u);return f.join("")}function rut(n){for(var f,i=-1,e=n.length,o=e+4,t,r=[],u=[];++i<4;)t=n[i%e],r.push(t[0]),u.push(t[1]);for(f=[rt(si,r),",",rt(si,u)],--i;++i<o;)t=n[i%e],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),ul(f,r,u);return f.join("")}function uut(n,t){var i=n.length-1;if(i)for(var e=n[0][0],o=n[0][1],s=n[i][0]-e,h=n[i][1]-o,u=-1,r,f;++u<=i;)r=n[u],f=u/i,r[0]=t*r[0]+(1-t)*(e+f*s),r[1]=t*r[1]+(1-t)*(o+f*h);return tk(n)}function rt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function ul(n,t,i){n.push("C",rt(ik,t),",",rt(ik,i),",",rt(rk,t),",",rt(rk,i),",",rt(si,t),",",rt(si,i))}function fl(n,t){return(t[1]-n[1])/(t[0]-n[0])}function fut(n){for(var t=0,e=n.length-1,i=[],f=n[0],r=n[1],u=i[0]=fl(f,r);++t<e;)i[t]=(u+(u=fl(f=r,r=n[t+1])))/2;return i[t]=u,i}function eut(n){for(var c=[],e,o,s,i,u=fut(n),t=-1,h=n.length-1;++t<h;)e=fl(n[t],n[t+1]),f(e)<r?u[t]=u[t+1]=0:(o=u[t]/e,s=u[t+1]/e,i=o*o+s*s,i>9&&(i=e*3/Math.sqrt(i),u[t]=i*o,u[t+1]=i*s));for(t=-1;++t<=h;)i=(n[Math.min(h,t+1)][0]-n[Math.max(0,t-1)][0])/(6*(1+u[t]*u[t])),c.push([i||0,u[t]*i||0]);return c}function out(n){return n.length<3?et(n):n[0]+so(n,eut(n))}function uk(n){for(var t,u=-1,f=n.length,i,r;++u<f;)t=n[u],i=t[0],r=t[1]-l,t[0]=i*Math.cos(r),t[1]=i*Math.sin(r);return n}function fk(n){function t(t){function d(){p.push("M",i(n(w),o),a,l(n(v.reverse()),o),"Z")}for(var p=[],v=[],w=[],c=-1,g=t.length,y,nt=h(f),tt=h(e),it=f===r?function(){return b}:h(r),rt=e===u?function(){return k}:h(u),b,k;++c<g;)s.call(this,y=t[c],c)?(v.push([b=+nt.call(this,y,c),k=+tt.call(this,y,c)]),w.push([+it.call(this,y,c),+rt.call(this,y,c)])):v.length&&(d(),v=[],w=[]);return v.length&&d(),p.length?p.join(""):null}var f=er,r=er,e=0,u=fu,s=tu,i=et,c=i.key,l=i,a="L",o=.7;return t.x=function(n){return arguments.length?(f=r=n,t):r},t.x0=function(n){return arguments.length?(f=n,t):f},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(e=u=n,t):u},t.y0=function(n){return arguments.length?(e=n,t):e},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(s=n,t):s},t.interpolate=function(n){return arguments.length?(c=typeof n=="function"?i=n:(i=oo.get(n)||et).key,l=i.reverse||i,a=i.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(o=n,t):o},t}function sut(n){return n.radius}function ek(n){return[n.x,n.y]}function hut(n){return function(){var t=n.apply(this,arguments),i=t[0],r=t[1]-l;return[i*Math.cos(r),i*Math.sin(r)]}}function cut(){return 64}function lut(){return"circle"}function ok(n){var t=Math.sqrt(n/o);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function sk(n){return function(){var t,r,i;(t=this[n])&&(i=t[r=t.active])&&(i.timer.c=null,i.timer.t=NaN,--t.count?delete t[r]:delete this[n],t.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ku(n,t,i){return pr(n,y),n.namespace=t,n.id=i,n}function hl(n,t,i,r){var u=n.id,f=n.namespace;return pt(n,typeof i=="function"?function(n,e,o){n[f][u].tween.set(t,r(i.call(n,n.__data__,e,o)))}:(i=r(i),function(n){n[f][u].tween.set(t,i)}))}function aut(n){return n==null&&(n=""),function(){this.textContent=n}}function cl(n){return n==null?"__transition__":"__transition_"+n+"__"}function co(n,t,i,r,u){function y(n){var t=e.delay;if(o.t=t+s,t<=n)return a(n-t);o.c=a}function a(i){var p=f.active,u=f[p],a,y;u&&(u.timer.c=null,u.timer.t=NaN,--f.count,delete f[p],u.event&&u.event.interrupt.call(n,n.__data__,u.index));for(a in f)+a<r&&(y=f[a],y.timer.c=null,y.timer.t=NaN,--f.count,delete f[a]);o.c=v;df(function(){return o.c&&v(i||1)&&(o.c=null,o.t=NaN),1},0,s);f.active=r;e.event&&e.event.start.call(n,n.__data__,t);h=[];e.tween.forEach(function(i,r){(r=r.call(n,n.__data__,t))&&h.push(r)});l=e.ease;c=e.duration}function v(u){for(var o=u/c,a=l(o),s=h.length;s>0;)h[--s].call(n,a);if(o>=1)return e.event&&e.event.end.call(n,n.__data__,t),--f.count?delete f[r]:delete n[i],1}var f=n[i]||(n[i]={active:0,count:0}),e=f[r],s,o,c,l,h;e||(s=u.time,o=df(y,0,s),e=f[r]={tween:new yt,time:s,timer:o,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++f.count)}function vut(n,t,i){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:i(n))+",0)"})}function yut(n,t,i){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:i(n))+")"})}function yl(n){return n.toISOString()}function pl(n,i,r){function u(t){return n(t)}function f(n,r){var e=n[1]-n[0],f=e/r,u=t.bisect(lo,f);return u==lo.length?[i.year,vr(n.map(function(n){return n/31536e6}),r)[2]]:u?i[f/lo[u-1]<lo[u]/f?u-1:u]:[but,vr(n,r)[2]]}return u.invert=function(t){return nr(n.invert(t))},u.domain=function(t){return arguments.length?(n.domain(t),u):n.domain().map(nr)},u.nice=function(n,t){function o(i){return!isNaN(i)&&!n.range(i,nr(+i+1),t).length}var r=u.domain(),e=ar(r),i=n==null?f(e,10):typeof n=="number"&&f(e,n);return i&&(n=i[0],t=i[1]),u.domain(io(r,t>1?{floor:function(t){while(o(t=n.floor(t)))t=nr(t-1);return t},ceil:function(t){while(o(t=n.ceil(t)))t=nr(+t+1);return t}}:n))},u.ticks=function(n,t){var i=ar(u.domain()),r=n==null?f(i,10):typeof n=="number"?f(i,n):!n.range&&[{range:n},t];return r&&(n=r[0],t=r[1]),n.range(i[0],nr(+i[1]+1),t<1?1:t)},u.tickFormat=function(){return r},u.copy=function(){return pl(n.copy(),i,r)},kc(u,n)}function nr(n){return new Date(n)}function kut(n){return JSON.parse(n.responseText)}function dut(n){var t=b.createRange();return t.selectNode(b.body),t.createContextualFragment(n.responseText)}var t={version:"3.5.16"},kl=[].slice,ot=function(n){return kl.call(n)},b=this.document,ao,f,ia,gu,po,ha,pr,s,rf,uf,st,ff,ci,iv,of,es,hf,os,cf,lf,br,kr,pf,wf,bf,kf,bs,dv,gs,gv,u,w,ct,nh,dr,ih,rh,re,ri,g,gr,he,yi,pi,bt,ui,fi,lt,ur,fr,ei,tt,oh,iu,hh,ch,kt,le,ae,ve,ye,wy,it,wh,bi,bh,kh,dh,gh,nc,eu,or,ki,sr,uc,fc,ou,ec,lu,de,ge,cw,lc,yw,pw,eb,hb,nl,lb,pu,oo,el,wu,ol,bu,y,sl,gi,ho,ll,hk,bl,ak;if(b)try{ot(b.documentElement.childNodes)[0].nodeType}catch(gut){ot=function(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i}}if(Date.now||(Date.now=function(){return+new Date}),b)try{b.createElement("DIV").style.setProperty("opacity",0,"")}catch(nft){var du=this.Element.prototype,vk=du.setAttribute,yk=du.setAttributeNS,gl=this.CSSStyleDeclaration.prototype,pk=gl.setProperty;du.setAttribute=function(n,t){vk.call(this,n,t+"")};du.setAttributeNS=function(n,t,i){yk.call(this,n,t,i+"")};gl.setProperty=function(n,t,i){pk.call(this,n,t+"",i)}}t.ascending=tr;t.descending=function(n,t){return t<n?-1:t>n?1:t>=n?0:NaN};t.min=function(n,t){var r=-1,f=n.length,u,i;if(arguments.length===1){while(++r<f)if((i=n[r])!=null&&i>=i){u=i;break}while(++r<f)(i=n[r])!=null&&u>i&&(u=i)}else{while(++r<f)if((i=t.call(n,n[r],r))!=null&&i>=i){u=i;break}while(++r<f)(i=t.call(n,n[r],r))!=null&&u>i&&(u=i)}return u};t.max=function(n,t){var r=-1,f=n.length,u,i;if(arguments.length===1){while(++r<f)if((i=n[r])!=null&&i>=i){u=i;break}while(++r<f)(i=n[r])!=null&&i>u&&(u=i)}else{while(++r<f)if((i=t.call(n,n[r],r))!=null&&i>=i){u=i;break}while(++r<f)(i=t.call(n,n[r],r))!=null&&i>u&&(u=i)}return u};t.extent=function(n,t){var r=-1,e=n.length,u,i,f;if(arguments.length===1){while(++r<e)if((i=n[r])!=null&&i>=i){u=f=i;break}while(++r<e)(i=n[r])!=null&&(u>i&&(u=i),f<i&&(f=i))}else{while(++r<e)if((i=t.call(n,n[r],r))!=null&&i>=i){u=f=i;break}while(++r<e)(i=t.call(n,n[r],r))!=null&&(u>i&&(u=i),f<i&&(f=i))}return[u,f]};t.sum=function(n,t){var u=0,f=n.length,r,i=-1;if(arguments.length===1)while(++i<f)vt(r=+n[i])&&(u+=r);else while(++i<f)vt(r=+t.call(n,n[i],i))&&(u+=r);return u};t.mean=function(n,t){var f=0,e=n.length,r,i=-1,u=e;if(arguments.length===1)while(++i<e)vt(r=hi(n[i]))?f+=r:--u;else while(++i<e)vt(r=hi(t.call(n,n[i],i)))?f+=r:--u;if(u)return f/u};t.quantile=function(n,t){var u=(n.length-1)*t+1,i=Math.floor(u),r=+n[i-1],f=u-i;return f?r+f*(n[i]-r):r};t.median=function(n,i){var u=[],e=n.length,f,r=-1;if(arguments.length===1)while(++r<e)vt(f=hi(n[r]))&&u.push(f);else while(++r<e)vt(f=hi(i.call(n,n[r],r)))&&u.push(f);if(u.length)return t.quantile(u.sort(tr),.5)};t.variance=function(n,t){var s=n.length,i=0,r,u,o=0,f=-1,e=0;if(arguments.length===1)while(++f<s)vt(r=hi(n[f]))&&(u=r-i,i+=u/++e,o+=u*(r-i));else while(++f<s)vt(r=hi(t.call(n,n[f],f)))&&(u=r-i,i+=u/++e,o+=u*(r-i));if(e>1)return o/(e-1)};t.deviation=function(){var n=t.variance.apply(this,arguments);return n?Math.sqrt(n):n};ao=na(tr);t.bisectLeft=ao.left;t.bisect=t.bisectRight=ao.right;t.bisector=function(n){return na(n.length===1?function(t,i){return tr(n(t),i)}:n)};t.shuffle=function(n,t,i){(r=arguments.length)<3&&(i=n.length,r<2&&(t=0));for(var r=i-t,f,u;r;)u=Math.random()*r--|0,f=n[r+t],n[r+t]=n[u+t],n[u+t]=f;return n};t.permute=function(n,t){for(var i=t.length,r=new Array(i);i--;)r[i]=n[t[i]];return r};t.pairs=function(n){for(var t=0,i=n.length-1,f,r=n[0],u=new Array(i<0?0:i);t<i;)u[t]=[f=r,r=n[++t]];return u};t.transpose=function(n){var i,u,o;if(!(u=n.length))return[];for(var r=-1,f=t.min(n,wk),e=new Array(f);++r<f;)for(i=-1,o=e[r]=new Array(u);++i<u;)o[i]=n[i][r];return e};t.zip=function(){return t.transpose(arguments)};t.keys=function(n){var t=[];for(var i in n)t.push(i);return t};t.values=function(n){var t=[];for(var i in n)t.push(n[i]);return t};t.entries=function(n){var t=[];for(var i in n)t.push({key:i,value:n[i]});return t};t.merge=function(n){for(var t=n.length,i,e=-1,r=0,u,f;++e<t;)r+=n[e].length;for(u=new Array(r);--t>=0;)for(f=n[t],i=f.length;--i>=0;)u[--r]=f[i];return u};f=Math.abs;t.range=function(n,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=n,n=0)),(t-n)/i==Infinity)throw new Error("infinite range");var e=[],r=bk(f(i)),o=-1,u;if(n*=r,t*=r,i*=r,i<0)while((u=n+i*++o)>t)e.push(u/r);else while((u=n+i*++o)<t)e.push(u/r);return e};t.map=function(n,t){var r=new yt,i,u,e,f;if(n instanceof yt)n.forEach(function(n,t){r.set(n,t)});else if(Array.isArray(n))if(i=-1,u=n.length,arguments.length===1)while(++i<u)r.set(i,n[i]);else while(++i<u)r.set(t.call(n,e=n[i],i),e);else for(f in n)r.set(f,n[f]);return r};ia="__proto__";gu="\x00";ta(yt,{has:ra,get:function(n){return this._[yr(n)]},set:function(n,t){return this._[yr(n)]=t},remove:ua,keys:fa,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:nf(t),value:this._[t]});return n},size:ea,empty:oa,forEach:function(n){for(var t in this._)n.call(this,nf(t),this._[t])}});t.nest=function(){function r(t,e,o){if(o>=i.length)return f?f.call(n,e):u?e.sort(u):e;for(var l=-1,y=e.length,p=i[o++],a,s,h,c=new yt,v;++l<y;)(v=c.get(a=p(s=e[l])))?v.push(s):c.set(a,[s]);return t?(s=t(),h=function(n,i){s.set(n,r(t,i,o))}):(s={},h=function(n,i){s[n]=r(t,i,o)}),c.forEach(h),s}function o(n,t){if(t>=i.length)return n;var r=[],u=e[t++];return n.forEach(function(n,i){r.push({key:n,values:o(i,t)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var n={},i=[],e=[],u,f;return n.map=function(n,t){return r(t,n,0)},n.entries=function(n){return o(r(t.map,n,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return e[i.length-1]=t,n},n.sortValues=function(t){return u=t,n},n.rollup=function(t){return f=t,n},n};t.set=function(n){var i=new vo,t,r;if(n)for(t=0,r=n.length;t<r;++t)i.add(n[t]);return i};ta(vo,{has:ra,add:function(n){return this._[yr(n+="")]=!0,n},remove:ua,values:fa,size:ea,empty:oa,forEach:function(n){for(var t in this._)n.call(this,nf(t))}});t.behavior={};t.rebind=function(n,t){for(var i=1,u=arguments.length,r;++i<u;)n[r=arguments[i]]=kk(n,t,t[r]);return n};po=["webkit","ms","moz","Moz","o","O"];t.dispatch=function(){for(var n=new wo,t=-1,i=arguments.length;++t<i;)n[arguments[t]]=sa(n);return n};wo.prototype.on=function(n,t){var r=n.indexOf("."),i="";if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n)return arguments.length<2?this[n].on(i):this[n].on(i,t);if(arguments.length===2){if(t==null)for(n in this)if(this.hasOwnProperty(n))this[n].on(i,null);return this}};t.event=null;t.requote=function(n){return n.replace(ha,"\\$&")};ha=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;pr={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)n[i]=t[i]};var go=function(n,t){return t.querySelector(n)},ns=function(n,t){return t.querySelectorAll(n)},tf=function(n,t){var i=n.matches||n[yo(n,"matchesSelector")];return tf=function(n,t){return i.call(n,t)},tf(n,t)};typeof Sizzle=="function"&&(go=function(n,t){return Sizzle(n,t)[0]||null},ns=Sizzle,tf=Sizzle.matchesSelector);t.selection=function(){return t.select(b.documentElement)};s=t.selection.prototype=[];s.select=function(n){var o=[],i,f,e,t,r,s,u,h;for(n=ts(n),r=-1,s=this.length;++r<s;)for(o.push(i=[]),i.parentNode=(e=this[r]).parentNode,u=-1,h=e.length;++u<h;)(t=e[u])?(i.push(f=n.call(t,t.__data__,u,r)),f&&"__data__"in t&&(f.__data__=t.__data__)):i.push(null);return ti(o)};s.selectAll=function(n){var u=[],f,t,i,e;for(n=ca(n),i=-1,e=this.length;++i<e;)for(var o=this[i],r=-1,s=o.length;++r<s;)(t=o[r])&&(u.push(f=ot(n.call(t,t.__data__,r,i))),f.parentNode=t);return ti(u)};rf="http://www.w3.org/1999/xhtml";uf={svg:"http://www.w3.org/2000/svg",xhtml:rf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};t.ns={prefix:uf,qualify:function(n){var t=n.indexOf(":"),i=n;return t>=0&&(i=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),uf.hasOwnProperty(i)?{space:uf[i],local:n}:n}};s.attr=function(n,i){if(arguments.length<2){if(typeof n=="string"){var r=this.node();return n=t.ns.qualify(n),n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}for(i in n)this.each(la(i,n[i]));return this}return this.each(la(n,i))};s.classed=function(n,t){if(arguments.length<2){if(typeof n=="string"){var r=this.node(),u=(n=ya(n)).length,i=-1;if(t=r.classList){while(++i<u)if(!t.contains(n[i]))return!1}else for(t=r.getAttribute("class");++i<u;)if(!va(n[i]).test(t))return!1;return!0}for(t in n)this.each(pa(t,n[t]));return this}return this.each(pa(n,t))};s.style=function(n,t,i){var r=arguments.length,u;if(r<3){if(typeof n!="string"){r<2&&(t="");for(i in n)this.each(wa(i,n[i],t));return this}if(r<2)return u=this.node(),gt(u).getComputedStyle(u,null).getPropertyValue(n);i=""}return this.each(wa(n,t,i))};s.property=function(n,t){if(arguments.length<2){if(typeof n=="string")return this.node()[n];for(t in n)this.each(ba(t,n[t]));return this}return this.each(ba(n,t))};s.text=function(n){return arguments.length?this.each(typeof n=="function"?function(){var t=n.apply(this,arguments);this.textContent=t==null?"":t}:n==null?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent};s.html=function(n){return arguments.length?this.each(typeof n=="function"?function(){var t=n.apply(this,arguments);this.innerHTML=t==null?"":t}:n==null?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML};s.append=function(n){return n=ka(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})};s.insert=function(n,t){return n=ka(n),t=ts(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})};s.remove=function(){return this.each(gk)};s.data=function(n,t){function o(n,i){var r,e=n.length,a=i.length,b=Math.min(e,a),v=new Array(a),o=new Array(a),y=new Array(e),u,c,l,w,p;if(t){for(l=new yt,w=new Array(e),r=-1;++r<e;)(u=n[r])&&(l.has(p=t.call(u,u.__data__,r))?y[r]=u:l.set(p,u),w[r]=p);for(r=-1;++r<a;)(u=l.get(p=t.call(i,c=i[r],r)))?u!==!0&&(v[r]=u,u.__data__=c):o[r]=is(c),l.set(p,!0);for(r=-1;++r<e;)r in w&&l.get(w[r])!==!0&&(y[r]=n[r])}else{for(r=-1;++r<b;)u=n[r],c=i[r],u?(u.__data__=c,v[r]=u):o[r]=is(c);for(;r<a;++r)o[r]=is(i[r]);for(;r<e;++r)y[r]=n[r]}o.update=v;o.parentNode=v.parentNode=y.parentNode=n.parentNode;s.push(o);f.push(v);h.push(y)}var i=-1,u=this.length,r,e;if(!arguments.length){for(n=new Array(u=(r=this[0]).length);++i<u;)(e=r[i])&&(n[i]=e.__data__);return n}var s=ga([]),f=ti([]),h=ti([]);if(typeof n=="function")while(++i<u)o(r=this[i],n.call(r,r.parentNode.__data__,i));else while(++i<u)o(r=this[i],n);return f.enter=function(){return s},f.exit=function(){return h},f};s.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")};s.filter=function(n){var e=[],u,f,r,t,o,i,s;for(typeof n!="function"&&(n=da(n)),t=0,o=this.length;t<o;t++)for(e.push(u=[]),u.parentNode=(f=this[t]).parentNode,i=0,s=f.length;i<s;i++)(r=f[i])&&n.call(r,r.__data__,i,t)&&u.push(r);return ti(e)};s.order=function(){for(var i=-1,f=this.length;++i<f;)for(var r=this[i],u=r.length-1,n=r[u],t;--u>=0;)(t=r[u])&&(n&&n!==t.nextSibling&&n.parentNode.insertBefore(t,n),n=t);return this};s.sort=function(n){n=nd.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(n);return this.order()};s.each=function(n){return pt(this,function(t,i,r){n.call(t,t.__data__,i,r)})};s.call=function(n){var t=ot(arguments);return n.apply(t[0]=this,t),this};s.empty=function(){return!this.node()};s.node=function(){for(var i,n=0,r=this.length;n<r;n++)for(var u=this[n],t=0,f=u.length;t<f;t++)if(i=u[t],i)return i;return null};s.size=function(){var n=0;return pt(this,function(){++n}),n};st=[];t.selection.enter=ga;t.selection.enter.prototype=st;st.append=s.append;st.empty=s.empty;st.node=s.node;st.call=s.call;st.size=s.size;st.select=function(n){for(var i,h,e=[],r,o,s,t,u,f=-1,c=this.length;++f<c;)for(s=(t=this[f]).update,e.push(r=[]),r.parentNode=t.parentNode,i=-1,h=t.length;++i<h;)(u=t[i])?(r.push(s[i]=o=n.call(t.parentNode,u.__data__,i,f)),o.__data__=u.__data__):r.push(null);return ti(e)};st.insert=function(n,t){return arguments.length<2&&(t=td(this)),s.insert.call(this,n,t)};t.select=function(n){var t;return typeof n=="string"?(t=[go(n,b)],t.parentNode=b.documentElement):(t=[n],t.parentNode=dl(n)),ti([t])};t.selectAll=function(n){var t;return typeof n=="string"?(t=ot(ns(n,b)),t.parentNode=b.documentElement):(t=ot(n),t.parentNode=null),ti([t])};s.on=function(n,t,i){var r=arguments.length;if(r<3){if(typeof n!="string"){r<2&&(t=!1);for(i in n)this.each(nv(i,n[i],t));return this}if(r<2)return(r=this.node()["__on"+n])&&r._;i=!1}return this.each(nv(n,t,i))};ff=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});b&&ff.forEach(function(n){"on"+n in b&&ff.remove(n)});iv=0;t.mouse=function(n){return rs(n,bo())};of=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;t.touch=function(n,t,i){if(arguments.length<3&&(i=t,t=bo().changedTouches),t)for(var r=0,f=t.length,u;r<f;++r)if((u=t[r]).identifier===i)return rs(n,u)};t.behavior.drag=function(){function i(){this.on("mousedown.drag",f).on("touchstart.drag",e)}function u(i,u,f,e,o){return function(){function d(){var n=u(v,h),t,i;n&&(t=n[0]-c[0],i=n[1]-c[1],w|=t|i,c=n,y({type:"drag",x:n[0]+s[0],y:n[1]+s[1],dx:t,dy:i}))}function g(){if(u(v,h)){b.on(e+l,null).on(o+l,null);k(w);y({type:"dragend"})}}var a=this,p=t.event.target.correspondingElement||t.event.target,v=a.parentNode,y=r.of(a,arguments),w=0,h=i(),l=".drag"+(h==null?"":"-"+h),s,b=t.select(f(p)).on(e+l,d).on(o+l,g),k=ef(p),c=u(v,h);n?(s=n.apply(a,arguments),s=[s.x-c[0],s.y-c[1]]):s=[0,0];y({type:"dragstart"})}}var r=ko(i,"drag","dragstart","dragend"),n=null,f=u(v,t.mouse,gt,"mousemove","mouseup"),e=u(rd,t.touch,p,"touchmove","touchend");return i.origin=function(t){return arguments.length?(n=t,i):n},t.rebind(i,r,"on")};t.touches=function(n,t){return arguments.length<2&&(t=bo().touches),t?ot(t).map(function(t){var i=rs(n,t);return i.identifier=t.identifier,i}):[]};var r=1e-6,sf=r*r,o=Math.PI,nt=2*o,ud=nt-r,l=o/2,e=o/180,c=180/o;var wr=Math.SQRT2,fs=2,ov=4;t.interpolateZoom=function(n,t){var c=n[0],l=n[1],i=n[2],p=t[0],w=t[1],r=t[2],e=p-c,o=w-l,s=e*e+o*o,h,u;if(s<sf)u=Math.log(r/i)/wr,h=function(n){return[c+n*e,l+n*o,i*Math.exp(wr*n*u)]};else{var a=Math.sqrt(s),v=(r*r-i*i+ov*s)/(2*i*fs*a),y=(r*r-i*i-ov*s)/(2*r*fs*a),f=Math.log(Math.sqrt(v*v+1)-v),b=Math.log(Math.sqrt(y*y+1)-y);u=(b-f)/wr;h=function(n){var t=n*u,r=fv(f),s=i/(fs*a)*(r*ed(wr*t+f)-fd(f));return[c+s*e,l+s*o,i*r/fv(wr*t+f)]}}return h.duration=u*1e3,h};t.behavior.zoom=function(){function i(n){n.on(d,ht).on(os+".zoom",at).on("dblclick.zoom",vt).on(g,ct)}function y(t){return[(t[0]-n.x)/n.k,(t[1]-n.y)/n.k]}function lt(t){return[t[0]*n.k+n.x,t[1]*n.k+n.y]}function p(t){n.k=Math.max(h[0],Math.min(h[1],t))}function w(t,i){i=lt(i);n.x+=t[0]-i[0];n.y+=t[1]-i[1]}function st(u,f,e,o){u.__chart__={x:n.x,y:n.y,k:n.k};p(Math.pow(2,o));w(r=f,e);u=t.select(u);c>0&&(u=u.transition().duration(c));u.call(i.event)}function rt(){a&&a.domain(tt.range().map(function(t){return(t-n.x)/n.k}).map(tt.invert));v&&v.domain(it.range().map(function(t){return(t-n.y)/n.k}).map(it.invert))}function e(n){ft++||n({type:"zoomstart"})}function o(t){rt();t({type:"zoom",scale:n.k,translate:[n.x,n.y]})}function u(n){--ft||(n({type:"zoomend"}),r=null)}function ht(){function l(){r=1;w(t.mouse(n),h);o(i)}function a(){s.on(et,null).on(ot,null);c(r);u(i)}var n=this,i=f.of(n,arguments),r=0,s=t.select(gt(n)).on(et,l).on(ot,a),h=y(t.mouse(n)),c=ef(n);bu.call(n);e(i)}function ct(){function b(){var u=t.touches(i);return l=n.k,u.forEach(function(n){n.identifier in r&&(r[n.identifier]=y(n))}),u}function k(){var c=t.event.target,o,e,l,u,s,f;t.select(c).on(tt,ut).on(it,ft);for(a.push(c),o=t.event.changedTouches,e=0,l=o.length;e<l;++e)r[o[e].identifier]=null;if(u=b(),s=Date.now(),u.length===1)s-nt<500&&(f=u[0],st(i,f,r[f.identifier],Math.floor(Math.log(n.k)/Math.LN2)+1),ni()),nt=s;else if(u.length>1){var f=u[0],v=u[1],y=f[0]-v[0],p=f[1]-v[1];h=y*y+p*p}}function ut(){var v=t.touches(i),n,f,u,e,a,y,c,b;for(bu.call(i),a=0,y=v.length;a<y;++a,e=null)if(u=v[a],e=r[u.identifier]){if(f)break;n=u;f=e}e&&(c=(c=u[0]-n[0])*c+(c=u[1]-n[1])*c,b=h&&Math.sqrt(c/h),n=[(n[0]+u[0])/2,(n[1]+u[1])/2],f=[(f[0]+e[0])/2,(f[1]+e[1])/2],p(b*l));nt=null;w(n,f);o(s)}function ft(){var i,n,f,e;if(t.event.touches.length){for(i=t.event.changedTouches,n=0,f=i.length;n<f;++n)delete r[i[n].identifier];for(e in r)return void b()}t.selectAll(a).on(c,null);v.on(d,ht).on(g,ct);rt();u(s)}var i=this,s=f.of(i,arguments),r={},h=0,l,c=".zoom-"+t.event.changedTouches[0].identifier,tt="touchmove"+c,it="touchend"+c,a=[],v=t.select(i),rt=ef(i);k();e(s);v.on(d,null).on(g,k)}function at(){var i=f.of(this,arguments);l?clearTimeout(l):(bu.call(this),ut=y(r=k||t.mouse(this)),e(i));l=setTimeout(function(){l=null;u(i)},50);ni();p(Math.pow(2,hf()*.002)*n.k);w(r,ut);o(i)}function vt(){var i=t.mouse(this),r=Math.log(n.k)/Math.LN2;st(this,i,y(i),t.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)}var n={x:0,y:0,k:1},ut,r,k,s=[960,500],h=es,c=250,ft=0,d="mousedown.zoom",et="mousemove.zoom",ot="mouseup.zoom",l,g="touchstart.zoom",nt,f=ko(i,"zoomstart","zoom","zoomend"),tt,a,it,v;return os||(os="onwheel"in b?(hf=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in b?(hf=function(){return t.event.wheelDelta},"mousewheel"):(hf=function(){return-t.event.detail},"MozMousePixelScroll")),i.event=function(i){i.each(function(){var i=f.of(this,arguments),h=n;gi?t.select(this).transition().each("start.zoom",function(){n=this.__chart__||{x:0,y:0,k:1};e(i)}).tween("zoom:zoom",function(){var u=s[0],c=s[1],f=r?r[0]:u/2,e=r?r[1]:c/2,l=t.interpolateZoom([(f-n.x)/n.k,(e-n.y)/n.k,u/n.k],[(f-h.x)/h.k,(e-h.y)/h.k,u/h.k]);return function(t){var r=l(t),s=u/r[2];this.__chart__=n={x:f-r[0]*s,y:e-r[1]*s,k:s};o(i)}}).each("interrupt.zoom",function(){u(i)}).each("end.zoom",function(){u(i)}):(this.__chart__=n,e(i),o(i),u(i))})},i.translate=function(t){return arguments.length?(n={x:+t[0],y:+t[1],k:n.k},rt(),i):[n.x,n.y]},i.scale=function(t){return arguments.length?(n={x:n.x,y:n.y,k:null},p(+t),rt(),i):n.k},i.scaleExtent=function(n){return arguments.length?(h=n==null?es:[+n[0],+n[1]],i):h},i.center=function(n){return arguments.length?(k=n&&[+n[0],+n[1]],i):k},i.size=function(n){return arguments.length?(s=n&&[+n[0],+n[1]],i):s},i.duration=function(n){return arguments.length?(c=+n,i):c},i.x=function(t){return arguments.length?(a=t,tt=t.copy(),n={x:0,y:0,k:1},i):a},i.y=function(t){return arguments.length?(v=t,it=t.copy(),n={x:0,y:0,k:1},i):v},t.rebind(i,f,"on")};es=[0,Infinity];t.color=li;li.prototype.toString=function(){return this.rgb()+""};t.hsl=ht;cf=ht.prototype=new li;cf.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ht(this.h,this.s,this.l/n)};cf.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ht(this.h,this.s,n*this.l)};cf.rgb=function(){return ss(this.h,this.s,this.l)};t.hcl=ut;lf=ut.prototype=new li;lf.brighter=function(n){return new ut(this.h,this.c,Math.min(100,this.l+af*(arguments.length?n:1)))};lf.darker=function(n){return new ut(this.h,this.c,Math.max(0,this.l-af*(arguments.length?n:1)))};lf.rgb=function(){return hs(this.h,this.c,this.l).rgb()};t.lab=ft;var af=18,sv=.95047,hv=1,cv=1.08883,cs=ft.prototype=new li;cs.brighter=function(n){return new ft(Math.min(100,this.l+af*(arguments.length?n:1)),this.a,this.b)};cs.darker=function(n){return new ft(Math.max(0,this.l-af*(arguments.length?n:1)),this.a,this.b)};cs.rgb=function(){return lv(this.l,this.a,this.b)};t.rgb=d;br=d.prototype=new li;br.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var i=this.r,r=this.g,u=this.b,t=30;return!i&&!r&&!u?new d(t,t,t):(i&&i<t&&(i=t),r&&r<t&&(r=t),u&&u<t&&(u=t),new d(Math.min(255,i/n),Math.min(255,r/n),Math.min(255,u/n)))};br.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new d(n*this.r,n*this.g,n*this.b)};br.hsl=function(){return pv(this.r,this.g,this.b)};br.toString=function(){return"#"+ir(this.r)+ir(this.g)+ir(this.b)};kr=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});kr.forEach(function(n,t){kr.set(n,vv(t))});t.functor=h;t.xhr=ws(p);t.dsv=function(n,t){function i(n,i,r){arguments.length<3&&(r=i,i=null);var e=yf(n,t,i==null?u:f(i),r);return e.row=function(n){return arguments.length?e.response((i=n)==null?u:f(n)):i},e}function u(n){return i.parse(n.responseText)}function f(n){return function(t){return i.parse(t.responseText,n)}}function s(t){return t.map(r).join(n)}function r(n){return e.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var e=new RegExp('["'+n+"\n]"),o=n.charCodeAt(0);return i.parse=function(n,t){var r;return i.parseRows(n,function(n,i){if(r)return r(n,i-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,i){return t(u(n),i)}:u})},i.parseRows=function(n,t){function l(){var f,t,u,c;if(i>=s)return e;if(r)return r=!1,h;if(f=i,n.charCodeAt(f)===34){for(t=f;t++<s;)if(n.charCodeAt(t)===34){if(n.charCodeAt(t+1)!==34)break;++t}return i=t+2,u=n.charCodeAt(t+1),u===13?(r=!0,n.charCodeAt(t+2)===10&&++i):u===10&&(r=!0),n.slice(f+1,t).replace(/""/g,'"')}while(i<s){if(u=n.charCodeAt(i++),c=1,u===10)r=!0;else if(u===13)r=!0,n.charCodeAt(i)===10&&(++i,++c);else if(u!==o)continue;return n.slice(f,i-c)}return n.slice(f)}for(var h={},e={},c=[],s=n.length,i=0,a=0,u,r,f;(u=l())!==e;){for(f=[];u!==h&&u!==e;)f.push(u),u=l();t&&(f=t(f,a++))==null||c.push(f)}return c},i.format=function(t){if(Array.isArray(t[0]))return i.formatRows(t);var f=new vo,u=[];return t.forEach(function(n){for(var t in n)f.has(t)||u.push(f.add(t))}),[u.map(r).join(n)].concat(t.map(function(t){return u.map(function(n){return r(t[n])}).join(n)})).join("\n")},i.formatRows=function(n){return n.map(s).join("\n")},i};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");bs=this[yo(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};t.timer=function(){df.apply(this,arguments)};t.timer.flush=function(){bv();kv()};t.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};dv=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(hd);t.formatPrefix=function(n,i){var r=0;return(n=+n)&&(n<0&&(n*=-1),i&&(n=t.round(n,ds(n,i))),r=1+Math.floor(1e-12+Math.log(n)/Math.LN10),r=Math.max(-24,Math.min(24,Math.floor((r-1)/3)*3))),dv[8+r/3]};gs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;gv=t.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,i){return(n=t.round(n,ds(n,i))).toFixed(Math.max(0,Math.min(20,ds(n*(1+1e-15),i))))}});u=t.time={};w=Date;wt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ct.setUTCDate.apply(this._,arguments)},setDay:function(){ct.setUTCDay.apply(this._,arguments)},setFullYear:function(){ct.setUTCFullYear.apply(this._,arguments)},setHours:function(){ct.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ct.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ct.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ct.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ct.setUTCSeconds.apply(this._,arguments)},setTime:function(){ct.setTime.apply(this._,arguments)}};ct=Date.prototype;u.year=ai(function(n){return n=u.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()});u.years=u.year.range;u.years.utc=u.year.utc.range;u.day=ai(function(n){var t=new w(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1});u.days=u.day.range;u.days.utc=u.day.utc.range;u.dayOfYear=function(n){var t=u.year(n);return Math.floor((n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var i=u[n]=ai(function(n){return(n=u.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+Math.floor(t)*7)},function(n){var i=u.year(n).getDay();return Math.floor((u.dayOfYear(n)+(i+t)%7)/7)-(i!==t)});u[n+"s"]=i.range;u[n+"s"].utc=i.utc.range;u[n+"OfYear"]=function(n){var i=u.year(n).getDay();return Math.floor((u.dayOfYear(n)+(i+t)%7)/7)}});u.week=u.sunday;u.weeks=u.sunday.range;u.weeks.utc=u.sunday.utc.range;u.weekOfYear=u.sundayOfYear;var ny={"-":"",_:" ","0":"0"},a=/^\s*\d+/,ty=/^%/;t.locale=function(n){return{numberFormat:cd(n),timeFormat:ad(n)}};nh=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});t.format=nh.numberFormat;t.geo={};th.prototype={s:0,t:0,add:function(n){uy(n,this.t,dr);uy(dr.s,this.s,this);this.s?this.t+=dr.t:this.s=dr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};dr=new th;t.geo.stream=function(n,t){n&&ih.hasOwnProperty(n.type)?ih[n.type](n,t):ie(n,t)};ih={Feature:function(n,t){ie(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,r=-1,u=i.length;++r<u;)ie(i[r].geometry,t)}};rh={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates;t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)n=i[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){uh(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)uh(i[r],t,0)},Polygon:function(n,t){fy(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)fy(i[r],t)},GeometryCollection:function(n,t){for(var i=n.geometries,r=-1,u=i.length;++r<u;)ie(i[r],t)}};t.geo.area=function(n){return re=0,t.geo.stream(n,g),re};ri=new th;g={sphere:function(){re+=4*o},point:v,lineStart:v,lineEnd:v,polygonStart:function(){ri.reset();g.lineStart=og},polygonEnd:function(){var n=2*ri;re+=n<0?4*o+n:n;g.lineStart=g.lineEnd=g.point=v}};t.geo.bounds=function(){function w(t,r){v.push(l=[n=t,i=t]);r<o&&(o=r);r>s&&(s=r)}function d(t,r){var d=vi([t*e,r*e]),v;if(y){var b=rr(y,d),nt=[b[1],-b[0],0],h=rr(nt,b);ee(h);h=oe(h);var g=t-a,p=g>0?1:-1,l=h[0]*c*p,k=f(g)>180;k^(p*a<l&&l<p*t)?(v=h[1]*c,v>s&&(s=v)):(l=(l+360)%360-180,k^(p*a<l&&l<p*t))?(v=-h[1]*c,v<o&&(o=v)):(r<o&&(o=r),r>s&&(s=r));k?t<a?u(n,t)>u(n,i)&&(i=t):u(t,i)>u(n,i)&&(n=t):i>=n?(t<n&&(n=t),t>i&&(i=t)):t>a?u(n,t)>u(n,i)&&(i=t):u(t,i)>u(n,i)&&(n=t)}else w(t,r);y=d;a=t}function nt(){h.point=d}function tt(){l[0]=n;l[1]=i;h.point=w;y=null}function it(n,t){if(y){var i=n-a;p+=f(i)>180?i+(i>0?360:-360):i}else b=n,k=t;g.point(n,t);d(n,t)}function ut(){g.lineStart()}function ft(){it(b,k);g.lineEnd();f(p)>r&&(n=-(i=180));l[0]=n;l[1]=i;y=null}function u(n,t){return(t-=n)<0?t+360:t}function et(n,t){return n[0]-t[0]}function rt(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var n,o,i,s,a,b,k,y,p,v,l,h={point:w,lineStart:nt,lineEnd:tt,polygonStart:function(){h.point=it;h.lineStart=ut;h.lineEnd=ft;p=0;g.polygonStart()},polygonEnd:function(){g.polygonEnd();h.point=w;h.lineStart=nt;h.lineEnd=tt;ri<0?(n=-(i=180),o=-(s=90)):p>r?s=90:p<-r&&(o=-90);l[0]=n;l[1]=i}};return function(r){var a,p,w;if(s=i=-(n=o=Infinity),v=[],t.geo.stream(r,h),a=v.length,a){v.sort(et);for(var c=1,f=v[0],e,y=[f];c<a;++c)e=v[c],rt(e[0],f)||rt(e[1],f)?(u(f[0],e[1])>u(f[0],f[1])&&(f[1]=e[1]),u(e[0],f[1])>u(f[0],f[1])&&(f[0]=e[0])):y.push(f=e);p=-Infinity;for(var a=y.length-1,c=0,f=y[a],e;c<=a;f=e,++c)e=y[c],(w=u(f[1],e[0]))>p&&(p=w,n=e[0],i=f[1])}return v=l=null,n===Infinity||o===Infinity?[[NaN,NaN],[NaN,NaN]]:[[n,o],[i,s]]}}();t.geo.centroid=function(n){gr=he=yi=pi=bt=ui=fi=lt=ur=fr=ei=0;t.geo.stream(n,tt);var i=ur,u=fr,f=ei,e=i*i+u*u+f*f;return e<sf&&(i=ui,u=fi,f=lt,he<r&&(i=yi,u=pi,f=bt),e=i*i+u*u+f*f,e<sf)?[NaN,NaN]:[Math.atan2(u,i)*c,ii(f/Math.sqrt(e))*c]};tt={sphere:v,point:eh,lineStart:ey,lineEnd:oy,polygonStart:function(){tt.lineStart=sg},polygonEnd:function(){tt.lineStart=ey}};oh=ly(tu,lg,vg,[-o,-o/2]);iu=1e9;t.geo.clipExtent=function(){var t,i,r,u,n,f,e={stream:function(t){return n&&(n.valid=!1),n=f(t),n.valid=!0,n},extent:function(o){return arguments.length?(f=yy(t=+o[0][0],i=+o[0][1],r=+o[1][0],u=+o[1][1]),n&&(n.valid=!1,n=null),e):[[t,i],[r,u]]}};return e.extent([[0,0],[960,500]])};(t.geo.conicEqualArea=function(){return sh(py)}).raw=py;t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};t.geo.albersUsa=function(){function i(n){var t=n[0],i=n[1];return e=null,(s(t,i),e)||(h(t,i),e)||c(t,i),e}var n=t.geo.albers(),u=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),e,o={point:function(n,t){e=[n,t]}},s,h,c;return i.invert=function(t){var e=n.scale(),o=n.translate(),i=(t[0]-o[0])/e,r=(t[1]-o[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?u:r>=.166&&r<.234&&i>=-.214&&i<-.115?f:n).invert(t)},i.stream=function(t){var i=n.stream(t),r=u.stream(t),e=f.stream(t);return{point:function(n,t){i.point(n,t);r.point(n,t);e.point(n,t)},sphere:function(){i.sphere();r.sphere();e.sphere()},lineStart:function(){i.lineStart();r.lineStart();e.lineStart()},lineEnd:function(){i.lineEnd();r.lineEnd();e.lineEnd()},polygonStart:function(){i.polygonStart();r.polygonStart();e.polygonStart()},polygonEnd:function(){i.polygonEnd();r.polygonEnd();e.polygonEnd()}}},i.precision=function(t){return arguments.length?(n.precision(t),u.precision(t),f.precision(t),i):n.precision()},i.scale=function(t){return arguments.length?(n.scale(t),u.scale(t*.35),f.scale(t),i.translate(n.translate())):n.scale()},i.translate=function(t){if(!arguments.length)return n.translate();var e=n.scale(),l=+t[0],a=+t[1];return s=n.translate(t).clipExtent([[l-.455*e,a-.238*e],[l+.455*e,a+.238*e]]).stream(o).point,h=u.translate([l-.307*e,a+.201*e]).clipExtent([[l-.425*e+r,a+.12*e+r],[l-.214*e-r,a+.234*e-r]]).stream(o).point,c=f.translate([l-.205*e,a+.212*e]).clipExtent([[l-.214*e+r,a+.166*e+r],[l-.115*e-r,a+.234*e-r]]).stream(o).point,i},i.scale(1070)};kt={point:v,lineStart:v,lineEnd:v,polygonStart:function(){ch=0;kt.lineStart=wg},polygonEnd:function(){kt.lineStart=kt.lineEnd=kt.point=v;hh+=f(ch/2)}};wy={point:bg,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v};it={point:wi,lineStart:ky,lineEnd:dy,polygonStart:function(){it.lineStart=dg},polygonEnd:function(){it.point=wi;it.lineStart=ky;it.lineEnd=dy}};t.geo.path=function(){function n(n){return n&&(typeof i=="function"&&r.pointRadius(+i.apply(this,arguments)),f&&f.valid||(f=u(r)),t.geo.stream(n,f)),r.result()}function s(){return f=null,n}var i=4.5,e,o,u,r,f;return n.area=function(n){return hh=0,t.geo.stream(n,u(kt)),hh},n.centroid=function(n){return yi=pi=bt=ui=fi=lt=ur=fr=ei=0,t.geo.stream(n,u(it)),ei?[ur/ei,fr/ei]:lt?[ui/lt,fi/lt]:bt?[yi/bt,pi/bt]:[NaN,NaN]},n.bounds=function(n){return ve=ye=-(le=ae=Infinity),t.geo.stream(n,u(wy)),[[le,ae],[ve,ye]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||nn(n):p,s()):e},n.context=function(n){return arguments.length?(r=(o=n)==null?new kg:new gg(n),typeof i!="function"&&r.pointRadius(i),s()):o},n.pointRadius=function(t){return arguments.length?(i=typeof t=="function"?t:(r.pointRadius(+t),+t),n):i},n.projection(t.geo.albersUsa()).context(null)};t.geo.transform=function(n){return{stream:function(t){var i=new np(t);for(var r in n)i[r]=n[r];return i}}};np.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};t.geo.projection=oi;t.geo.projectionMutator=lh;(t.geo.equirectangular=function(){return oi(ru)}).raw=ru.invert=ru;t.geo.rotation=function(n){function t(t){return t=n(t[0]*e,t[1]*e),t[0]*=c,t[1]*=c,t}return n=ah(n[0]%360*e,n[1]*e,n.length>2?n[2]*e:0),t.invert=function(t){return t=n.invert(t[0]*e,t[1]*e),t[0]*=c,t[1]*=c,t},t};rp.invert=ru;t.geo.circle=function(){function n(){var n=typeof t=="function"?t.apply(this,arguments):t,r=ah(-n[0]*e,-n[1]*e,0).invert,i=[];return u(null,null,1,{point:function(n,t){i.push(n=r(n,t));n[0]*=c;n[1]*=c}}),{type:"Polygon",coordinates:[i]}}var t=[0,0],i,r=6,u;return n.origin=function(i){return arguments.length?(t=i,n):t},n.angle=function(t){return arguments.length?(u=vh((i=+t)*e,r*e),n):i},n.precision=function(t){return arguments.length?(u=vh(i*e,(r=+t)*e),n):r},n.angle(90)};t.geo.distance=function(n,t){var u=(t[0]-n[0])*e,f=n[1]*e,o=t[1]*e,a=Math.sin(u),s=Math.cos(u),h=Math.sin(f),c=Math.cos(f),l=Math.sin(o),r=Math.cos(o),i;return Math.atan2(Math.sqrt((i=r*a)*i+(i=c*l-h*r*s)*i),h*l+c*r*s)};t.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:nt()}}function nt(){return t.range(Math.ceil(u/v)*v,i,v).map(b).concat(t.range(Math.ceil(o/y)*y,e,y).map(k)).concat(t.range(Math.ceil(h/a)*a,s,a).filter(function(n){return f(n%v)>r}).map(d)).concat(t.range(Math.ceil(l/w)*w,c,w).filter(function(n){return f(n%y)>r}).map(g))}var s,h,i,u,c,l,e,o,a=10,w=a,v=90,y=360,d,g,b,k,p=2.5;return n.lines=function(){return nt().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[b(u).concat(k(e).slice(1),b(i).reverse().slice(1),k(o).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(u=+t[0][0],i=+t[1][0],o=+t[0][1],e=+t[1][1],u>i&&(t=u,u=i,i=t),o>e&&(t=o,o=e,e=t),n.precision(p)):[[u,o],[i,e]]},n.minorExtent=function(t){return arguments.length?(h=+t[0][0],s=+t[1][0],l=+t[0][1],c=+t[1][1],h>s&&(t=h,h=s,s=t),l>c&&(t=l,l=c,c=t),n.precision(p)):[[h,l],[s,c]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(v=+t[0],y=+t[1],n):[v,y]},n.minorStep=function(t){return arguments.length?(a=+t[0],w=+t[1],n):[a,w]},n.precision=function(t){return arguments.length?(p=+t,d=sp(l,c,90),g=hp(h,s,p),b=sp(o,e,90),k=hp(u,i,p),n):p},n.majorExtent([[-180,-90+r],[180,90-r]]).minorExtent([[-180,-80-r],[180,80+r]])};t.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[u||i.apply(this,arguments),f||r.apply(this,arguments)]}}var i=yh,u,r=ph,f;return n.distance=function(){return t.geo.distance(u||i.apply(this,arguments),f||r.apply(this,arguments))},n.source=function(t){return arguments.length?(i=t,u=typeof t=="function"?null:t,n):i},n.target=function(t){return arguments.length?(r=t,f=typeof t=="function"?null:t,n):r},n.precision=function(){return arguments.length?n:0},n};t.geo.interpolate=function(n,t){return tn(n[0]*e,n[1]*e,t[0]*e,t[1]*e)};t.geo.length=function(n){return wh=0,t.geo.stream(n,bi),wh};bi={sphere:v,point:v,lineStart:rn,lineEnd:v,polygonStart:v,polygonEnd:v};bh=uu(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(t.geo.azimuthalEqualArea=function(){return oi(bh)}).raw=bh;kh=uu(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},p);(t.geo.azimuthalEquidistant=function(){return oi(kh)}).raw=kh;(t.geo.conicConformal=function(){return sh(cp)}).raw=cp;(t.geo.conicEquidistant=function(){return sh(lp)}).raw=lp;dh=uu(function(n){return 1/n},Math.atan);(t.geo.gnomonic=function(){return oi(dh)}).raw=dh;pe.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-l]};(t.geo.mercator=function(){return ap(pe)}).raw=pe;gh=uu(function(){return 1},Math.asin);(t.geo.orthographic=function(){return oi(gh)}).raw=gh;nc=uu(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(t.geo.stereographic=function(){return oi(nc)}).raw=nc;tc.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-l]};(t.geo.transverseMercator=function(){var n=ap(tc),i=n.center,t=n.rotate;return n.center=function(n){return n?i([-n[1],n[0]]):(n=i(),[n[1],-n[0]])},n.rotate=function(n){return n?t([n[0],n[1],n.length>2?n[2]+90:90]):(n=t(),[n[0],n[1],n[2]-90])},t([0,0,90])}).raw=tc;t.geom={};t.geom.hull=function(n){function t(n){if(n.length<3)return[];for(var l=h(i),a=h(r),s=n.length,u=[],c=[],t=0;t<s;t++)u.push([+l.call(this,n[t],t),+a.call(this,n[t],t),t]);for(u.sort(un),t=0;t<s;t++)c.push([u[t][0],-u[t][1]]);var f=vp(u),e=vp(c),v=e[0]===f[0],y=e[e.length-1]===f[f.length-1],o=[];for(t=f.length-1;t>=0;--t)o.push(n[u[f[t]][2]]);for(t=+v;t<e.length-y;++t)o.push(n[u[e[t]][2]]);return o}var i=er,r=fu;return arguments.length?t(n):(t.x=function(n){return arguments.length?(i=n,t):i},t.y=function(n){return arguments.length?(r=n,t):r},t)};t.geom.polygon=function(n){return pr(n,eu),n};eu=t.geom.polygon.prototype=[];eu.area=function(){for(var i=-1,r=this.length,t,n=this[r-1],u=0;++i<r;)t=n,n=this[i],u+=t[1]*n[0]-t[0]*n[1];return u*.5};eu.centroid=function(n){var u=-1,f=this.length,e=0,o=0,i,t=this[f-1],r;for(arguments.length||(n=-1/(6*this.area()));++u<f;)i=t,t=this[u],r=i[0]*t[1]-t[0]*i[1],e+=(i[0]+t[0])*r,o+=(i[1]+t[1])*r;return[e*n,o*n]};eu.clip=function(n){for(var f,o=yp(n),s=-1,h=this.length-yp(this),e,c,i=this[h-1],t,r,u;++s<h;){for(f=n.slice(),n.length=0,t=this[s],r=f[(c=f.length-o)-1],e=-1;++e<c;)u=f[e],ic(u,i,t)?(ic(r,i,t)||n.push(rc(r,u,i,t)),n.push(u)):ic(r,i,t)&&n.push(rc(r,u,i,t)),r=u;o&&n.push(n[0]);i=t}return n};uc=[];ec=[];bp.prototype.prepare=function(){for(var n=this.edges,t=n.length,i;t--;)i=n[t].edge,i.b&&i.a||n.splice(t,1);return n.sort(kp),n.length};be.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};sc.prototype={insert:function(n,t){var i,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;i=n}else this._?(n=gp(this._),t.P=null,t.N=n,n.P=n.L=t,i=n):(t.P=t.N=null,this._=t,i=null);for(t.L=t.R=null,t.U=i,t.C=!0,n=t;i&&i.C;)r=i.U,i===r.L?(u=r.R,u&&u.C?(i.C=u.C=!1,r.C=!0,n=r):(n===i.R&&(hu(this,i),n=i,i=n.U),i.C=!1,r.C=!0,cu(this,r))):(u=r.L,u&&u.C?(i.C=u.C=!1,r.C=!0,n=r):(n===i.L&&(cu(this,i),n=i,i=n.U),i.C=!1,r.C=!0,hu(this,r))),i=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P);n.P&&(n.P.N=n.N);n.N=n.P=null;var i=n.U,t,f=n.L,u=n.R,r,e;if(r=f?u?gp(u):f:u,i?i.L===n?i.L=r:i.R=r:this._=r,f&&u?(e=r.C,r.C=n.C,r.L=f,f.U=r,r!==u?(i=r.U,r.U=n.U,n=r.R,i.L=n,r.R=u,u.U=r):(r.U=i,i=r,n=r.R)):(e=n.C,n=r),n&&(n.U=i),!e){if(n&&n.C){n.C=!1;return}do{if(n===this._)break;if(n===i.L){if(t=i.R,t.C&&(t.C=!1,i.C=!0,hu(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,cu(this,t),t=i.R);t.C=i.C;i.C=t.R.C=!1;hu(this,i);n=this._;break}}else if(t=i.L,t.C&&(t.C=!1,i.C=!0,cu(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,hu(this,t),t=i.L);t.C=i.C;i.C=t.L.C=!1;cu(this,i);n=this._;break}t.C=!0;n=i;i=i.U}while(!n.C);n&&(n.C=!1)}}};t.geom.voronoi=function(n){function t(n){var o=new Array(n.length),t=i[0][0],r=i[0][1],u=i[1][0],f=i[1][1];return hc(e(n),i).cells.forEach(function(i,e){var h=i.edges,s=i.site,c=o[e]=h.length?h.map(function(n){var t=n.start();return[t.x,t.y]}):s.x>=t&&s.x<=u&&s.y>=r&&s.y<=f?[[t,f],[u,f],[u,r],[t,r]]:[];c.point=n[e]}),o}function e(n){return n.map(function(n,t){return{x:Math.round(o(n,t)/r)*r,y:Math.round(s(n,t)/r)*r,i:t}})}var u=er,f=fu,o=u,s=f,i=lu;return n?t(n):(t.links=function(n){return hc(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return hc(e(n)).cells.forEach(function(i,r){for(var o=i.site,s=i.edges.sort(kp),h=-1,c=s.length,l,e,u=s[c-1].edge,f=u.l===o?u.r:u.l;++h<c;)l=u,e=f,u=s[h].edge,f=u.l===o?u.r:u.l,r<e.i&&r<f.i&&pn(o,e,f)<0&&t.push([n[r],n[e.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(o=h(u=n),t):u},t.y=function(n){return arguments.length?(s=h(f=n),t):f},t.clipExtent=function(n){return arguments.length?(i=n==null?lu:n,t):i===lu?null:i},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):i===lu?null:i&&i[1]},t)};lu=[[-1e6,-1e6],[1e6,1e6]];t.geom.delaunay=function(n){return t.geom.voronoi().triangles(n)};t.geom.quadtree=function(n,t,i,r,u){function e(n){function ut(n,t,i,r,u,e,o,s){var h,c,l;isNaN(i)||isNaN(r)||(n.leaf?(h=n.x,c=n.y,h!=null?f(h-i)+f(c-r)<.01?tt(n,t,i,r,u,e,o,s):(l=n.point,n.x=n.y=n.point=null,tt(n,l,h,c,u,e,o,s),tt(n,t,i,r,u,e,o,s)):(n.x=i,n.y=r,n.point=t)):tt(n,t,i,r,u,e,o,s))}function tt(n,t,i,r,u,f,e,o){var s=(u+e)*.5,h=(f+o)*.5,c=i>=s,l=r>=h,a=l<<1|c;n.leaf=!1;n=n.nodes[a]||(n.nodes[a]=nw());c?u=s:e=s;l?f=h:o=h;ut(n,t,i,r,u,f,e,o)}var l,ft=h(o),et=h(s),d,g,e,nt,a,v,y,p,b,k,it,rt,w;if(t!=null)a=t,v=i,y=r,p=u;else if(y=p=-(a=v=Infinity),d=[],g=[],nt=n.length,c)for(e=0;e<nt;++e)l=n[e],l.x<a&&(a=l.x),l.y<v&&(v=l.y),l.x>y&&(y=l.x),l.y>p&&(p=l.y),d.push(l.x),g.push(l.y);else for(e=0;e<nt;++e)b=+ft(l=n[e],e),k=+et(l,e),b<a&&(a=b),k<v&&(v=k),b>y&&(y=b),k>p&&(p=k),d.push(b),g.push(k);if(it=y-a,rt=p-v,it>rt?p=v+it:y=a+rt,w=nw(),w.add=function(n){ut(w,n,+ft(n,++e),+et(n,e),a,v,y,p)},w.visit=function(n){au(n,w,a,v,y,p)},w.find=function(n){return kn(w,n[0],n[1],a,v,y,p)},e=-1,t==null){while(++e<nt)ut(w,n[e],d[e],g[e],a,v,y,p);--e}else n.forEach(w.add);return d=g=n=l=null,w}var o=er,s=fu,c;return(c=arguments.length)?(o=wn,s=bn,c===3&&(u=i,r=t,i=t=0),e(n)):(e.x=function(n){return arguments.length?(o=n,e):o},e.y=function(n){return arguments.length?(s=n,e):s},e.extent=function(n){return arguments.length?(n==null?t=i=r=u=null:(t=+n[0][0],i=+n[0][1],r=+n[1][0],u=+n[1][1]),e):t==null?null:[[t,i],[r,u]]},e.size=function(n){return arguments.length?(n==null?t=i=r=u=null:(t=i=0,r=+n[0],u=+n[1]),e):t==null?null:[r-t,u-i]},e)};t.interpolateRgb=cc;t.interpolateObject=tw;t.interpolateNumber=dt;t.interpolateString=iw;de=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;ge=new RegExp(de.source,"g");t.interpolate=di;t.interpolators=[function(n,t){var i=typeof t;return(i==="string"?kr.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?cc:iw:t instanceof li?cc:Array.isArray(t)?no:i==="object"&&isNaN(t)?tw:dt)(n,t)}];t.interpolateArray=no;var rw=function(){return p},dn=t.map({linear:rw,poly:utt,quad:function(){return ttt},cubic:function(){return itt},sin:function(){return ftt},exp:function(){return ett},circle:function(){return ott},elastic:stt,back:htt,bounce:function(){return ctt}}),gn=t.map({"in":p,out:uw,"in-out":fw,"out-in":function(n){return fw(uw(n))}});t.ease=function(n){var t=n.indexOf("-"),i=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return i=dn.get(i)||rw,r=gn.get(r)||p,ntt(r(i.apply(null,kl.call(arguments,1))))};t.interpolateHcl=ltt;t.interpolateHsl=att;t.interpolateLab=vtt;t.interpolateRound=ew;t.transform=function(n){var i=b.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(n){if(n!=null){i.setAttribute("transform",n);var t=i.transform.baseVal.consolidate()}return new ow(t?t.matrix:cw)})(n)};ow.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};cw={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=lw;t.layout={};t.layout.bundle=function(){return function(n){for(var t=[],i=-1,r=n.length;++i<r;)t.push(nit(n[i]));return t}};t.layout.chord=function(){function c(){var k={},b=[],tt=t.range(r),d=[],y,c,it,n,a,p,w;for(i=[],u=[],y=0,n=-1;++n<r;){for(c=0,a=-1;++a<r;)c+=f[n][a];b.push(c);d.push(t.range(r));y+=c}for(o&&tt.sort(function(n,t){return o(b[n],b[t])}),s&&d.forEach(function(n,t){n.sort(function(n,i){return s(f[t][n],f[t][i])})}),y=(nt-e*r)/y,c=0,n=-1;++n<r;){for(it=c,a=-1;++a<r;){var v=tt[n],g=d[v][a],rt=f[v][g],ut=c,ft=c+=rt*y;k[v+"-"+g]={index:v,subindex:g,startAngle:ut,endAngle:ft,value:rt}}u[v]={index:v,startAngle:it,endAngle:c,value:b[v]};c+=e}for(n=-1;++n<r;)for(a=n-1;++a<r;)p=k[n+"-"+a],w=k[a+"-"+n],(p.value||w.value)&&i.push(p.value<w.value?{source:w,target:p}:{source:p,target:w});h&&l()}function l(){i.sort(function(n,t){return h((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},i,u,f,r,e=0,o,s,h;return n.matrix=function(t){return arguments.length?(r=(f=t)&&f.length,i=u=null,n):f},n.padding=function(t){return arguments.length?(e=t,i=u=null,n):e},n.sortGroups=function(t){return arguments.length?(o=t,i=u=null,n):o},n.sortSubgroups=function(t){return arguments.length?(s=t,i=null,n):s},n.sortChords=function(t){return arguments.length?(h=t,i&&l(),n):h},n.chords=function(){return i||c(),i},n.groups=function(){return u||c(),u},n};t.layout.force=function(){function g(n){return function(t,i,r,u){var e;if(t.point!==n){var o=t.cx-n.x,s=t.cy-n.y,h=u-i,f=o*o+s*s;if(h*h/d<f)return f<v&&(e=t.charge/f,n.px-=o*e,n.py-=s*e),!0;t.point&&f&&f<v&&(e=t.pointCharge/f,n.px-=o*e,n.py-=s*e)}return!t.charge}}function nt(i){i.px=t.event.x;i.py=t.event.y;n.resume()}var n={},o=t.dispatch("start","tick","end"),s,f=[1,1],l,r,a=.9,h=eit,c=oit,e=-30,v=sit,k=.1,d=.64,i=[],u=[],y,w,b;return n.tick=function(){if((r*=.99)<.005)return s=null,o.end({type:"end",alpha:r=0}),!0;for(var tt=i.length,rt=u.length,it,n,l,d,nt,c,v,p,h=0;h<rt;++h)n=u[h],l=n.source,d=n.target,v=d.x-l.x,p=d.y-l.y,(nt=v*v+p*p)&&(nt=r*w[h]*((nt=Math.sqrt(nt))-y[h])/nt,v*=nt,p*=nt,d.x-=v*(c=l.weight+d.weight?l.weight/(l.weight+d.weight):.5),d.y-=p*c,l.x+=v*(c=1-c),l.y+=p*c);if((c=r*k)&&(v=f[0]/2,p=f[1]/2,h=-1,c))while(++h<tt)n=i[h],n.x+=(v-n.x)*c,n.y+=(p-n.y)*c;if(e)for(vw(it=t.geom.quadtree(i),r,b),h=-1;++h<tt;)(n=i[h]).fixed||it.visit(g(n));for(h=-1;++h<tt;)n=i[h],n.fixed?(n.x=n.px,n.y=n.py):(n.x-=(n.px-(n.px=n.x))*a,n.y-=(n.py-(n.py=n.y))*a);o.tick({type:"tick",alpha:r})},n.nodes=function(t){return arguments.length?(i=t,n):i},n.links=function(t){return arguments.length?(u=t,n):u},n.size=function(t){return arguments.length?(f=t,n):f},n.linkDistance=function(t){return arguments.length?(h=typeof t=="function"?t:+t,n):h},n.distance=n.linkDistance,n.linkStrength=function(t){return arguments.length?(c=typeof t=="function"?t:+t,n):c},n.friction=function(t){return arguments.length?(a=+t,n):a},n.charge=function(t){return arguments.length?(e=typeof t=="function"?t:+t,n):e},n.chargeDistance=function(t){return arguments.length?(v=t*t,n):Math.sqrt(v)},n.gravity=function(t){return arguments.length?(k=+t,n):k},n.theta=function(t){return arguments.length?(d=t*t,n):Math.sqrt(d)},n.alpha=function(t){return arguments.length?(t=+t,r?t>0?r=t:(s.c=null,s.t=NaN,s=null,o.end({type:"end",alpha:r=0})):t>0&&(o.start({type:"start",alpha:r=t}),s=df(n.tick)),n):r},n.start=function(){function a(n,i){var f;if(!l){for(l=new Array(o),r=0;r<o;++r)l[r]=[];for(r=0;r<s;++r)f=u[r],l[f.source.index].push(f.target),l[f.target.index].push(f.source)}for(var e=l[t],r=-1,c=e.length,h;++r<c;)if(!isNaN(h=e[r][n]))return h;return Math.random()*i}for(var o=i.length,s=u.length,v=f[0],p=f[1],l,r,t=0;t<o;++t)(r=i[t]).index=t,r.weight=0;for(t=0;t<s;++t)r=u[t],typeof r.source=="number"&&(r.source=i[r.source]),typeof r.target=="number"&&(r.target=i[r.target]),++r.source.weight,++r.target.weight;for(t=0;t<o;++t)r=i[t],isNaN(r.x)&&(r.x=a("x",v)),isNaN(r.y)&&(r.y=a("y",p)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(y=[],typeof h=="function")for(t=0;t<s;++t)y[t]=+h.call(this,u[t],t);else for(t=0;t<s;++t)y[t]=h;if(w=[],typeof c=="function")for(t=0;t<s;++t)w[t]=+c.call(this,u[t],t);else for(t=0;t<s;++t)w[t]=c;if(b=[],typeof e=="function")for(t=0;t<o;++t)b[t]=+e.call(this,i[t],t);else for(t=0;t<o;++t)b[t]=e;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){if(l||(l=t.behavior.drag().origin(p).on("dragstart.force",iit).on("drag.force",nt).on("dragend.force",rit)),!arguments.length)return l;this.on("mouseover.force",uit).on("mouseout.force",fit).call(l)},t.rebind(n,o,"on")};var eit=20,oit=1,sit=Infinity;t.layout.hierarchy=function(){function n(u){var h=[u],c=[],f,o,e,s;for(u.depth=0;(f=h.pop())!=null;)if(c.push(f),(e=r.call(n,f,f.depth))&&(o=e.length)){while(--o>=0)h.push(s=e[o]),s.parent=f,s.depth=f.depth+1;t&&(f.value=0);f.children=e}else t&&(f.value=+t.call(n,f,f.depth)||0),delete f.children;return at(u,function(n){var r,u;i&&(r=n.children)&&r.sort(i);t&&(u=n.parent)&&(u.value+=n.value)}),c}var i=lit,r=hit,t=cit;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(i){return arguments.length?(t=i,n):t},n.revalue=function(i){return t&&(yu(i,function(n){n.children&&(n.value=0)}),at(i,function(i){var r;i.children||(i.value=+t.call(n,i,i.depth)||0);(r=i.parent)&&(r.value+=i.value)})),i},n};t.layout.partition=function(){function u(n,t,i,r){var f=n.children,e,o,s,h;if(n.x=t,n.y=n.depth*r,n.dx=i,n.dy=r,f&&(o=f.length))for(e=-1,i=n.value?i/n.value:0;++e<o;)u(s=f[e],t,h=s.value*i,r),t+=h}function f(n){var t=n.children,i=0,r,u;if(t&&(u=t.length))for(r=-1;++r<u;)i=Math.max(i,f(t[r]));return 1+i}function i(t,i){var e=r.call(this,t,i);return u(e[0],0,n[0],n[1]/f(e[0])),e}var r=t.layout.hierarchy(),n=[1,1];return i.size=function(t){return arguments.length?(n=t,i):n},vu(i,r)};t.layout.pie=function(){function n(o){var h=o.length,s=o.map(function(t,i){return+e.call(n,t,i)}),c=+(typeof r=="function"?r.apply(this,arguments):r),l=(typeof u=="function"?u.apply(this,arguments):u)-c,a=Math.min(Math.abs(l)/h,+(typeof f=="function"?f.apply(this,arguments):f)),v=a*(l<0?-1:1),y=t.sum(s),k=y?(l-h*v)/y:0,p=t.range(h),w=[],b;return i!=null&&p.sort(i===lc?function(n,t){return s[t]-s[n]}:function(n,t){return i(o[n],o[t])}),p.forEach(function(n){w[n]={data:o[n],value:b=s[n],startAngle:c,endAngle:c+=b*k+v,padAngle:a}}),w}var e=Number,i=lc,r=0,u=nt,f=0;return n.value=function(t){return arguments.length?(e=t,n):e},n.sort=function(t){return arguments.length?(i=t,n):i},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n.padAngle=function(t){return arguments.length?(f=t,n):f},n};lc={};t.layout.stack=function(){function n(s,h){var p,w,b,v,c,k;if(!(b=s.length))return s;var a=s.map(function(t,i){return r.call(n,t,i)}),l=a.map(function(t){return t.map(function(t,i){return[e.call(n,t,i),o.call(n,t,i)]})}),y=u.call(n,l,h);for(a=t.permute(a,y),l=t.permute(l,y),p=f.call(n,l,h),w=a[0].length,c=0;c<w;++c)for(i.call(n,a[0][c],k=p[c],l[0][c][1]),v=1;v<b;++v)i.call(n,a[v][c],k+=l[v-1][c][1],l[v][c][1]);return s}var r=p,u=ac,f=vc,i=pit,e=vit,o=yit;return n.values=function(t){return arguments.length?(r=t,n):r},n.order=function(t){return arguments.length?(u=typeof t=="function"?t:yw.get(t)||ac,n):u},n.offset=function(t){return arguments.length?(f=typeof t=="function"?t:pw.get(t)||vc,n):f},n.x=function(t){return arguments.length?(e=t,n):e},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(i=t,n):i},n};yw=t.map({"inside-out":function(n){for(var u=n.length,i,f=n.map(wit),e=n.map(bit),l=t.range(u).sort(function(n,t){return f[n]-f[t]}),o=0,s=0,h=[],c=[],r=0;r<u;++r)i=l[r],o<s?(o+=e[i],h.push(i)):(s+=e[i],c.push(i));return c.reverse().concat(h)},reverse:function(n){return t.range(n.length).reverse()},"default":ac});pw=t.map({silhouette:function(n){for(var s=n.length,f=n[0].length,e=[],u=0,r,i,o=[],t=0;t<f;++t){for(r=0,i=0;r<s;r++)i+=n[r][t][1];i>u&&(u=i);e.push(i)}for(t=0;t<f;++t)o[t]=(u-e[t])/2;return o},wiggle:function(n){var a=n.length,h=n[0],v=h.length,i,t,r,u,c,l,f,e,o,s=[];for(s[0]=e=o=0,t=1;t<v;++t){for(i=0,u=0;i<a;++i)u+=n[i][t][1];for(i=0,c=0,f=h[t][0]-h[t-1][0];i<a;++i){for(r=0,l=(n[i][t][1]-n[i][t-1][1])/(2*f);r<i;++r)l+=(n[r][t][1]-n[r][t-1][1])/f;c+=l*n[i][t][1]}s[t]=e-=u?c/u*f:0;e<o&&(o=e)}for(t=0;t<v;++t)s[t]-=o;return s},expand:function(n){for(var r=n.length,f=n[0].length,o=1/r,t,u,e=[],i=0;i<f;++i){for(t=0,u=0;t<r;t++)u+=n[t][i][1];if(u)for(t=0;t<r;t++)n[t][i][1]/=u;else for(t=0;t<r;t++)n[t][i][1]=o}for(i=0;i<f;++i)e[i]=0;return e},zero:vc});t.layout.histogram=function(){function n(n,e){for(var l=[],s=n.map(r,this),a=u.call(this,s,e),h=f.call(this,a,s,e),o,e=-1,y=s.length,v=h.length-1,p=i?1:1/y,c;++e<v;)o=l[e]=[],o.dx=h[e+1]-(o.x=h[e]),o.y=0;if(v>0)for(e=-1;++e<y;)c=s[e],c>=a[0]&&c<=a[1]&&(o=l[t.bisect(h,c,1,v)-1],o.y+=p,o.push(n[e]));return l}var i=!0,r=Number,u=git,f=dit;return n.value=function(t){return arguments.length?(r=t,n):r},n.range=function(t){return arguments.length?(u=h(t),n):u},n.bins=function(t){return arguments.length?(f=typeof t=="number"?function(n){return ww(n,t)}:h(t),n):f},n.frequency=function(t){return arguments.length?(i=!!t,n):i},n};t.layout.pack=function(){function i(t,i){var c=f.call(this,t,i),e=c[0],o=u[0],s=u[1],l=n==null?Math.sqrt:typeof n=="function"?n:function(){return n},h;return e.x=e.y=0,at(e,function(n){n.r=+l(n.value)}),at(e,dw),r&&(h=r*(n?1:Math.max(2*e.r/o,2*e.r/s))/2,at(e,function(n){n.r+=h}),at(e,dw),at(e,function(n){n.r-=h})),gw(e,o/2,s/2,n?1:1/Math.max(2*e.r/o,2*e.r/s)),c}var f=t.layout.hierarchy().sort(nrt),r=0,u=[1,1],n;return i.size=function(n){return arguments.length?(u=n,i):u},i.radius=function(t){return arguments.length?(n=t==null||typeof t=="function"?t:+t,i):n},i.padding=function(n){return arguments.length?(r=+n,i):r},vu(i,f)};t.layout.tree=function(){function r(t,r){var p=e.call(this,t,r),c=p[0],v=o(c);if(at(v,s),v.parent.m=-v.z,yu(v,h),u)yu(c,f);else{var l=c,a=c,y=c;yu(c,function(n){n.x<l.x&&(l=n);n.x>a.x&&(a=n);n.depth>y.depth&&(y=n)});var w=i(l,a)/2-l.x,b=n[0]/(a.x+i(a,l)/2+w),k=n[1]/(y.depth||1);yu(c,function(n){n.x=(n.x+w)*b;n.y=n.depth*k})}return p}function o(n){for(var f={A:null,children:[n]},e=[f],u;(u=e.pop())!=null;)for(var i=u.children,r,t=0,o=i.length;t<o;++t)e.push((i[t]=r={_:i[t],parent:u,children:(r=i[t].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:t}).a=r);return f.children[0]}function s(n){var r=n.children,f=n.parent.children,t=n.i?f[n.i-1]:null,u;r.length?(urt(n),u=(r[0].z+r[r.length-1].z)/2,t?(n.z=t.z+i(n._,t._),n.m=n.z-u):n.z=u):t&&(n.z=t.z+i(n._,t._));n.parent.A=c(n,t,n.parent.A||f[0])}function h(n){n._.x=n.z+n.parent.m;n.m+=n.parent.m}function c(n,t,r){if(t){for(var u=n,e=n,f=t,o=u.parent.children[0],h=u.m,c=e.m,l=f.m,a=o.m,s;f=wc(f),u=pc(u),f&&u;)o=pc(o),e=wc(e),e.a=n,s=f.z+l-u.z-h+i(f._,u._),s>0&&(rrt(frt(f,n,r),n,s),h+=s,c+=s),l+=f.m,h+=u.m,a+=o.m,c+=e.m;f&&!wc(e)&&(e.t=f,e.m+=l-c);u&&!pc(o)&&(o.t=u,o.m+=h-a,r=n)}return r}function f(t){t.x*=n[0];t.y=t.depth*n[1]}var e=t.layout.hierarchy().sort(null).value(null),i=tb,n=[1,1],u=null;return r.separation=function(n){return arguments.length?(i=n,r):i},r.size=function(t){return arguments.length?(u=(n=t)==null?f:null,r):u?null:n},r.nodeSize=function(t){return arguments.length?(u=(n=t)==null?null:f,r):u?n:null},vu(r,e)};t.layout.cluster=function(){function i(t,i){var c=f.call(this,t,i),e=c[0],o,a=0;at(e,function(n){var t=n.children;t&&t.length?(n.x=ort(t),n.y=ert(t)):(n.x=o?a+=r(n,o):0,n.y=0,o=n)});var s=ib(e),h=rb(e),l=s.x-r(s,h)/2,v=h.x+r(h,s)/2;return at(e,u?function(t){t.x=(t.x-e.x)*n[0];t.y=(e.y-t.y)*n[1]}:function(t){t.x=(t.x-l)/(v-l)*n[0];t.y=(1-(e.y?t.y/e.y:1))*n[1]}),c}var f=t.layout.hierarchy().sort(null).value(null),r=tb,n=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(t){return arguments.length?(u=(n=t)==null,i):u?null:n},i.nodeSize=function(t){return arguments.length?(u=(n=t)!=null,i):u?n:null},vu(i,f)};t.layout.treemap=function(){function c(n,t){for(var r=-1,f=n.length,u,i;++r<f;)i=(u=n[r]).value*(t<0?0:t),u.area=isNaN(i)||i<=0?0:i}function v(n){var u=n.children;if(u&&u.length){var r=s(n),t=[],f=u.slice(),h,o=Infinity,a,e=i==="slice"?r.dx:i==="dice"?r.dy:i==="slice-dice"?n.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),y;for(c(f,r.dx*r.dy/n.value),t.area=0;(y=f.length)>0;)t.push(h=f[y-1]),t.area+=h.area,i!=="squarify"||(a=p(t,e))<=o?(f.pop(),o=a):(t.area-=t.pop().area,l(t,e,r,!1),e=Math.min(r.dx,r.dy),t.length=t.area=0,o=Infinity);t.length&&(l(t,e,r,!0),t.length=t.area=0);u.forEach(v)}}function y(n){var u=n.children;if(u&&u.length){var i=s(n),f=u.slice(),r,t=[];for(c(f,i.dx*i.dy/n.value),t.area=0;r=f.pop();)t.push(r),t.area+=r.area,r.z!=null&&(l(t,r.z?i.dx:i.dy,i,!f.length),t.length=t.area=0);u.forEach(y)}}function p(n,t){for(var i=n.area,r,u=0,f=Infinity,o=-1,s=n.length;++o<s;)(r=n[o].area)&&(r<f&&(f=r),r>u&&(u=r));return i*=i,t*=t,i?Math.max(t*u*e/i,i/(t*f*e)):Infinity}function l(n,t,i,u){var h=-1,c=n.length,o=i.x,s=i.y,e=t?r(n.area/t):0,f;if(t==i.dx){for((u||e>i.dy)&&(e=i.dy);++h<c;)f=n[h],f.x=o,f.y=s,f.dy=e,o+=f.dx=Math.min(i.x+i.dx-o,e?r(f.area/e):0);f.z=!0;f.dx+=i.x+i.dx-o;i.y+=e;i.dy-=e}else{for((u||e>i.dx)&&(e=i.dx);++h<c;)f=n[h],f.x=o,f.y=s,f.dx=e,s+=f.dy=Math.min(i.y+i.dy-s,e?r(f.area/e):0);f.z=!1;f.dy+=i.y+i.dy-s;i.x+=e;i.dx-=e}}function n(n){var i=u||o(n),t=i[0];return t.x=t.y=0,t.value?(t.dx=f[0],t.dy=f[1]):t.dx=t.dy=0,u&&o.revalue(t),c([t],t.dx*t.dy/t.value),(u?y:v)(t),h&&(u=i),i}var o=t.layout.hierarchy(),r=Math.round,f=[1,1],a=null,s=bc,h=!1,u,i="squarify",e=.5*(1+Math.sqrt(5));return n.size=function(t){return arguments.length?(f=t,n):f},n.padding=function(t){function u(i){var r=t.call(n,i,i.depth);return r==null?bc(i):ub(i,typeof r=="number"?[r,r,r,r]:r)}function i(n){return ub(n,t)}if(!arguments.length)return a;var r;return s=(a=t)==null?bc:(r=typeof t)=="function"?u:r==="number"?(t=[t,t,t,t],i):i,n},n.round=function(t){return arguments.length?(r=t?Math.round:Number,n):r!=Number},n.sticky=function(t){return arguments.length?(h=t,u=null,n):h},n.ratio=function(t){return arguments.length?(e=t,n):e},n.mode=function(t){return arguments.length?(i=t+"",n):i},vu(n,o)};t.random={normal:function(n,t){var i=arguments.length;return i<2&&(t=1),i<1&&(n=0),function(){var r,u,i;do r=Math.random()*2-1,u=Math.random()*2-1,i=r*r+u*u;while(!i||i>1);return n+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var n=t.random.normal.apply(t,arguments);return function(){return Math.exp(n())}},bates:function(n){var i=t.random.irwinHall(n);return function(){return i()/n}},irwinHall:function(n){return function(){for(var t=0,i=0;i<n;i++)t+=Math.random();return t}}};t.scale={};eb={floor:p,ceil:p};t.scale.linear=function(){return ob([0,1],[0,1],di,!1)};hb={s:1,g:1,p:1,r:1,e:1};t.scale.log=function(){return cb(t.scale.linear().domain([0,1]),10,!0,[1,10])};nl=t.format(".0e");lb={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};t.scale.pow=function(){return ab(t.scale.linear(),1,[0,1])};t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return vb([],{t:"range",a:[[]]})};t.scale.category10=function(){return t.scale.ordinal().range(lrt)};t.scale.category20=function(){return t.scale.ordinal().range(art)};t.scale.category20b=function(){return t.scale.ordinal().range(vrt)};t.scale.category20c=function(){return t.scale.ordinal().range(yrt)};var lrt=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vf),art=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vf),vrt=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vf),yrt=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vf);t.scale.quantile=function(){return yb([],[])};t.scale.quantize=function(){return pb(0,1,[0,1])};t.scale.threshold=function(){return wb([.5],[0,1])};t.scale.identity=function(){return bb([0,1])};t.svg={};t.svg.arc=function(){function n(){var n=Math.max(0,+t.apply(this,arguments)),h=Math.max(0,+i.apply(this,arguments)),it=f.apply(this,arguments)-l,rt=e.apply(this,arguments)-l,pt=Math.abs(rt-it),v=it>rt?0:1,kt,dt,gt,ni,nt,tt,lt,at,vt,yt;if(h<n&&(ut=h,h=n,n=ut),pt>=ud)return a(h,v)+(n?a(n,1-v):"")+"Z";var ut,st,wt,bt,ht=0,ft=0,y,p,w,et,k,d,g,ct,b=[];if((bt=(+c.apply(this,arguments)||0)/2)&&(wt=u===pu?Math.sqrt(n*n+h*h):+u.apply(this,arguments),v||(ft*=-1),h&&(ft=ii(wt/h*Math.sin(bt))),n&&(ht=ii(wt/n*Math.sin(bt)))),h?(y=h*Math.cos(it+ft),p=h*Math.sin(it+ft),w=h*Math.cos(rt-ft),et=h*Math.sin(rt-ft),kt=Math.abs(rt-it-2*ft)<=o?0:1,ft&&fo(y,p,w,et)===v^kt&&(dt=(it+rt)/2,y=h*Math.cos(dt),p=h*Math.sin(dt),w=et=null)):y=p=0,n?(k=n*Math.cos(rt-ht),d=n*Math.sin(rt-ht),g=n*Math.cos(it+ht),ct=n*Math.sin(it+ht),gt=Math.abs(it-rt+2*ht)<=o?0:1,ht&&fo(k,d,g,ct)===1-v^gt&&(ni=(it+rt)/2,k=n*Math.cos(ni),d=n*Math.sin(ni),g=ct=null)):k=d=0,pt>r&&(ut=Math.min(Math.abs(h-n)/2,+s.apply(this,arguments)))>.001){if(st=n<h^v?0:1,nt=ut,tt=ut,pt<o){var ot=g==null?[k,d]:w==null?[y,p]:rc([y,p],[g,ct],[w,et],[k,d]),ti=y-ot[0],ri=p-ot[1],ui=w-ot[0],fi=et-ot[1],ei=1/Math.sin(Math.acos((ti*ui+ri*fi)/(Math.sqrt(ti*ti+ri*ri)*Math.sqrt(ui*ui+fi*fi)))/2),oi=Math.sqrt(ot[0]*ot[0]+ot[1]*ot[1]);tt=Math.min(ut,(n-oi)/(ei-1));nt=Math.min(ut,(h-oi)/(ei+1))}w!=null?(lt=eo(g==null?[k,d]:[g,ct],[y,p],h,nt,v),at=eo([w,et],[k,d],h,nt,v),ut===nt?b.push("M",lt[0],"A",nt,",",nt," 0 0,",st," ",lt[1],"A",h,",",h," 0 ",1-v^fo(lt[1][0],lt[1][1],at[1][0],at[1][1]),",",v," ",at[1],"A",nt,",",nt," 0 0,",st," ",at[0]):b.push("M",lt[0],"A",nt,",",nt," 0 1,",st," ",at[0])):b.push("M",y,",",p);g!=null?(vt=eo([y,p],[g,ct],n,-tt,v),yt=eo([k,d],w==null?[y,p]:[w,et],n,-tt,v),ut===tt?b.push("L",yt[0],"A",tt,",",tt," 0 0,",st," ",yt[1],"A",n,",",n," 0 ",v^fo(yt[1][0],yt[1][1],vt[1][0],vt[1][1]),",",1-v," ",vt[1],"A",tt,",",tt," 0 0,",st," ",vt[0]):b.push("L",yt[0],"A",tt,",",tt," 0 0,",st," ",vt[0])):b.push("L",k,",",d)}else b.push("M",y,",",p),w!=null&&b.push("A",h,",",h," 0 ",kt,",",v," ",w,",",et),b.push("L",k,",",d),g!=null&&b.push("A",n,",",n," 0 ",gt,",",1-v," ",g,",",ct);return b.push("Z"),b.join("")}function a(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var t=wrt,i=brt,s=prt,u=pu,f=kb,e=db,c=krt;return n.innerRadius=function(i){return arguments.length?(t=h(i),n):t},n.outerRadius=function(t){return arguments.length?(i=h(t),n):i},n.cornerRadius=function(t){return arguments.length?(s=h(t),n):s},n.padRadius=function(t){return arguments.length?(u=t==pu?pu:h(t),n):u},n.startAngle=function(t){return arguments.length?(f=h(t),n):f},n.endAngle=function(t){return arguments.length?(e=h(t),n):e},n.padAngle=function(t){return arguments.length?(c=h(t),n):c},n.centroid=function(){var n=(+t.apply(this,arguments)+ +i.apply(this,arguments))/2,r=(+f.apply(this,arguments)+ +e.apply(this,arguments))/2-l;return[Math.cos(r)*n,Math.sin(r)*n]},n};pu="auto";t.svg.line=function(){return gb(p)};oo=t.map({linear:et,"linear-closed":nk,step:drt,"step-before":tl,"step-after":il,basis:tk,"basis-open":iut,"basis-closed":rut,bundle:uut,cardinal:tut,"cardinal-open":grt,"cardinal-closed":nut,monotone:out});oo.forEach(function(n,t){t.key=n;t.closed=/-closed$/.test(n)});var ik=[0,2/3,1/3,0],rk=[0,1/3,2/3,0],si=[0,1/6,2/3,1/6];t.svg.line.radial=function(){var n=gb(uk);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n};tl.reverse=il;il.reverse=tl;t.svg.area=function(){return fk(p)};t.svg.area.radial=function(){var n=fk(uk);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n};t.svg.chord=function(){function n(n,r){var u=s(this,t,n,r),f=s(this,i,n,r);return"M"+u.p0+c(u.r,u.p1,u.a1-u.a0)+(a(u,f)?e(u.r,u.p1,u.r,u.p0):e(u.r,u.p1,f.r,f.p0)+c(f.r,f.p1,f.a1-f.a0)+e(f.r,f.p1,u.r,u.p0))+"Z"}function s(n,t,i,e){var s=t.call(n,i,e),o=r.call(n,s,e),h=u.call(n,s,e)-l,c=f.call(n,s,e)-l;return{r:o,a0:h,a1:c,p0:[o*Math.cos(h),o*Math.sin(h)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function a(n,t){return n.a0==t.a0&&n.a1==t.a1}function c(n,t,i){return"A"+n+","+n+" 0 "+ +(i>o)+",1 "+t}function e(n,t,i,r){return"Q 0,0 "+r}var t=yh,i=ph,r=sut,u=kb,f=db;return n.radius=function(t){return arguments.length?(r=h(t),n):r},n.source=function(i){return arguments.length?(t=h(i),n):t},n.target=function(t){return arguments.length?(i=h(t),n):i},n.startAngle=function(t){return arguments.length?(u=h(t),n):u},n.endAngle=function(t){return arguments.length?(f=h(t),n):f},n};t.svg.diagonal=function(){function n(n,u){var e=t.call(this,n,u),o=i.call(this,n,u),s=(e.y+o.y)/2,f=[e,{x:e.x,y:s},{x:o.x,y:s},o];return f=f.map(r),"M"+f[0]+"C"+f[1]+" "+f[2]+" "+f[3]}var t=yh,i=ph,r=ek;return n.source=function(i){return arguments.length?(t=h(i),n):t},n.target=function(t){return arguments.length?(i=h(t),n):i},n.projection=function(t){return arguments.length?(r=t,n):r},n};t.svg.diagonal.radial=function(){var n=t.svg.diagonal(),i=ek,r=n.projection;return n.projection=function(n){return arguments.length?r(hut(i=n)):i},n};t.svg.symbol=function(){function n(n,r){return(el.get(t.call(this,n,r))||ok)(i.call(this,n,r))}var t=lut,i=cut;return n.type=function(i){return arguments.length?(t=h(i),n):t},n.size=function(t){return arguments.length?(i=h(t),n):i},n};el=t.map({circle:ok,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*ol)),i=t*ol;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/wu),i=t*wu/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/wu),i=t*wu/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});t.svg.symbolTypes=el.keys();wu=Math.sqrt(3);ol=Math.tan(30*e);s.transition=function(n){for(var r=gi||++sl,u=cl(n),f=[],e,t,h=ho||{time:Date.now(),ease:rtt,delay:0,duration:250},o=-1,c=this.length;++o<c;){f.push(e=[]);for(var s=this[o],i=-1,l=s.length;++i<l;)(t=s[i])&&co(t,i,u,r,h),e.push(t)}return ku(f,u,r)};s.interrupt=function(n){return this.each(n==null?bu:sk(cl(n)))};bu=sk(cl());y=[];sl=0;y.call=s.call;y.empty=s.empty;y.node=s.node;y.size=s.size;t.transition=function(n,i){return n&&n.transition?gi?n.transition(i):n:t.selection().transition(n)};t.transition.prototype=y;y.select=function(n){var f=this.id,e=this.namespace,s=[],o,i,t,r,h;for(n=ts(n),r=-1,h=this.length;++r<h;){s.push(o=[]);for(var c=this[r],u=-1,l=c.length;++u<l;)(t=c[u])&&(i=n.call(t,t.__data__,u,r))?("__data__"in t&&(i.__data__=t.__data__),co(i,u,e,f,t[e][f]),o.push(i)):o.push(null)}return ku(s,e,f)};y.selectAll=function(n){var u=this.id,f=this.namespace,h=[],c,e,t,o,l,i,a,r,y;for(n=ca(n),i=-1,a=this.length;++i<a;)for(var v=this[i],s=-1,p=v.length;++s<p;)if(t=v[s])for(l=t[f][u],e=n.call(t,t.__data__,s,i),h.push(c=[]),r=-1,y=e.length;++r<y;)(o=e[r])&&co(o,r,f,u,l),c.push(o);return ku(h,f,u)};y.filter=function(n){var u=[],f,e,i,t,o;for(typeof n!="function"&&(n=da(n)),t=0,o=this.length;t<o;t++){u.push(f=[]);for(var e=this[t],r=0,s=e.length;r<s;r++)(i=e[r])&&n.call(i,i.__data__,r,t)&&f.push(i)}return ku(u,this.namespace,this.id)};y.tween=function(n,t){var i=this.id,r=this.namespace;return arguments.length<2?this.node()[r][i].tween.get(n):pt(this,t==null?function(t){t[r][i].tween.remove(n)}:function(u){u[r][i].tween.set(n,t)})};y.attr=function(n,i){function f(){this.removeAttribute(r)}function e(){this.removeAttributeNS(r.space,r.local)}function o(n){return n==null?f:(n+="",function(){var t=this.getAttribute(r),i;return t!==n&&(i=u(t,n),function(n){this.setAttribute(r,i(n))})})}function s(n){return n==null?e:(n+="",function(){var t=this.getAttributeNS(r.space,r.local),i;return t!==n&&(i=u(t,n),function(n){this.setAttributeNS(r.space,r.local,i(n))})})}if(arguments.length<2){for(i in n)this.attr(i,n[i]);return this}var u=n=="transform"?lw:di,r=t.ns.qualify(n);return hl(this,"attr."+n,i,r.local?s:o)};y.attrTween=function(n,i){function u(n,t){var u=i.call(this,n,t,this.getAttribute(r));return u&&function(n){this.setAttribute(r,u(n))}}function f(n,t){var u=i.call(this,n,t,this.getAttributeNS(r.space,r.local));return u&&function(n){this.setAttributeNS(r.space,r.local,u(n))}}var r=t.ns.qualify(n);return this.tween("attr."+n,r.local?f:u)};y.style=function(n,t,i){function u(){this.style.removeProperty(n)}function f(t){return t==null?u:(t+="",function(){var r=gt(this).getComputedStyle(this,null).getPropertyValue(n),u;return r!==t&&(u=di(r,t),function(t){this.style.setProperty(n,u(t),i)})})}var r=arguments.length;if(r<3){if(typeof n!="string"){r<2&&(t="");for(i in n)this.style(i,n[i],t);return this}i=""}return hl(this,"style."+n,t,f)};y.styleTween=function(n,t,i){function r(r,u){var f=t.call(this,r,u,gt(this).getComputedStyle(this,null).getPropertyValue(n));return f&&function(t){this.style.setProperty(n,f(t),i)}}return arguments.length<3&&(i=""),this.tween("style."+n,r)};y.text=function(n){return hl(this,"text",n,aut)};y.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})};y.ease=function(n){var i=this.id,r=this.namespace;return arguments.length<1?this.node()[r][i].ease:(typeof n!="function"&&(n=t.ease.apply(t,arguments)),pt(this,function(t){t[r][i].ease=n}))};y.delay=function(n){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].delay:pt(this,typeof n=="function"?function(r,u,f){r[i][t].delay=+n.call(r,r.__data__,u,f)}:(n=+n,function(r){r[i][t].delay=n}))};y.duration=function(n){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].duration:pt(this,typeof n=="function"?function(r,u,f){r[i][t].duration=Math.max(1,n.call(r,r.__data__,u,f))}:(n=Math.max(1,n),function(r){r[i][t].duration=n}))};y.each=function(n,i){var r=this.id,u=this.namespace,f,e;if(arguments.length<2){f=ho;e=gi;try{gi=r;pt(this,function(t,i,f){ho=t[u][r];n.call(t,t.__data__,i,f)})}finally{ho=f;gi=e}}else pt(this,function(f){var e=f[u][r];(e.event||(e.event=t.dispatch("start","end","interrupt"))).on(n,i)});return this};y.transition=function(){for(var h=this.id,f=++sl,r=this.namespace,e=[],o,s,t,n,u=0,c=this.length;u<c;u++){e.push(o=[]);for(var s=this[u],i=0,l=s.length;i<l;i++)(t=s[i])&&(n=t[r][h],co(t,i,r,f,{time:n.time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration})),o.push(t)}return ku(e,r,f)};t.svg.axis=function(){function n(n){n.each(function(){var rt=t.select(this),a=this.__chart__||e,n=this.__chart__=e.copy(),ht=s==null?n.ticks?n.ticks.apply(n,o):n.domain():s,ct=h==null?n.tickFormat?n.tickFormat.apply(n,o):p:h,w=rt.selectAll(".tick").data(ht,n),v=w.enter().insert("g",".domain").attr("class","tick").style("opacity",r),lt=t.transition(w.exit()).style("opacity",r).remove(),g=t.transition(w.order()).style("opacity",1),ut=Math.max(i,0)+c,y,b=to(n),ft=rt.selectAll(".domain").data([0]),et=(ft.enter().append("path").attr("class","domain"),t.transition(ft)),it,st;v.append("line");v.append("text");var at=v.select("line"),vt=g.select("line"),ot=w.select("text").text(ct),yt=v.select("text"),pt=g.select("text"),l=f==="top"||f==="left"?-1:1,nt,tt,k,d;f==="bottom"||f==="top"?(y=vut,nt="x",k="y",tt="x2",d="y2",ot.attr("dy",l<0?"0em":".71em").style("text-anchor","middle"),et.attr("d","M"+b[0]+","+l*u+"V0H"+b[1]+"V"+l*u)):(y=yut,nt="y",k="x",tt="y2",d="x2",ot.attr("dy",".32em").style("text-anchor",l<0?"end":"start"),et.attr("d","M"+l*u+","+b[0]+"H0V"+b[1]+"H"+l*u));at.attr(d,l*i);yt.attr(k,l*ut);vt.attr(tt,0).attr(d,l*i);pt.attr(nt,0).attr(k,l*ut);n.rangeBand?(it=n,st=it.rangeBand()/2,a=n=function(n){return it(n)+st}):a.rangeBand?a=n:lt.call(y,n,a);v.call(y,a,n);g.call(y,n,n)})}var e=t.scale.linear(),f=ll,i=6,u=6,c=3,o=[10],s=null,h;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(f=t in hk?t+"":ll,n):f},n.ticks=function(){return arguments.length?(o=ot(arguments),n):o},n.tickValues=function(t){return arguments.length?(s=t,n):s},n.tickFormat=function(t){return arguments.length?(h=t,n):h},n.tickSize=function(t){var r=arguments.length;return r?(i=+t,u=+arguments[r-1],n):i},n.innerTickSize=function(t){return arguments.length?(i=+t,n):i},n.outerTickSize=function(t){return arguments.length?(u=+t,n):u},n.tickPadding=function(t){return arguments.length?(c=+t,n):c},n.tickSubdivide=function(){return arguments.length&&n},n};ll="bottom";hk={top:1,right:1,bottom:1,left:1};t.svg.brush=function(){function f(n){n.each(function(){var i=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",w).on("touchstart.brush",w),h=i.selectAll(".background").data([0]),e,o,s,n;h.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");e=i.selectAll(".resize").data(l,p);e.exit().remove();e.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return put[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");e.style("display",f.empty()?"none":null);o=t.transition(i);s=t.transition(h);r&&(n=to(r),s.attr("x",n[0]).attr("width",n[1]-n[0]),v(o));u&&(n=to(u),s.attr("y",n[0]).attr("height",n[1]-n[0]),y(o));a(o)})}function a(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+n[+/e$/.test(t)]+","+i[+/^s/.test(t)]+")"})}function v(t){t.select(".extent").attr("x",n[0]);t.selectAll(".extent,.n>rect,.s>rect").attr("width",n[1]-n[0])}function y(n){n.select(".extent").attr("y",i[0]);n.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function w(){function lt(){t.event.keyCode==32&&(p||(w=null,l[0]-=n[1],l[1]-=i[1],p=2),ni())}function at(){t.event.keyCode==32&&p==2&&(l[0]+=n[1],l[1]+=i[1],p=0,ni())}function nt(){var f=t.mouse(b),e=!1;g&&(f[0]+=g[0],f[1]+=g[1]);p||(t.event.altKey?(w||(w=[(n[0]+n[1])/2,(i[0]+i[1])/2]),l[0]=n[+(f[0]<w[0])],l[1]=i[+(f[1]<w[1])]):w=null);st&&et(f,r,0)&&(v(k),e=!0);ht&&et(f,u,1)&&(y(k),e=!0);e&&(a(k),it({type:"brush",mode:p?"move":"resize"}))}function et(t,r,u){var k=to(r),y=k[0],b=k[1],c=l[u],a=u?i:n,d=a[1]-a[0],f,v;return p&&(y-=c,b-=d+c),f=(u?h:s)?Math.max(y,Math.min(b,t[u])):t[u],p?v=(f+=c)+d:(w&&(c=Math.max(y,Math.min(b,2*w[u]-f))),c<f?(v=f,f=c):v=c),a[0]!=f||a[1]!=v?(u?o=null:e=null,a[0]=f,a[1]=v,!0):void 0}function ot(){nt();k.style("pointer-events","all").selectAll(".resize").style("display",f.empty()?"none":null);t.select("body").style("cursor",null);rt.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);ct();it({type:"brushend"})}var b=this,tt=t.select(t.event.target),it=c.of(b,arguments),k=t.select(b),d=tt.datum(),st=!/^(n|s)$/.test(d)&&r,ht=!/^(e|w)$/.test(d)&&u,p=tt.classed("extent"),ct=ef(b),w,l=t.mouse(b),g,rt=t.select(gt(b)).on("keydown.brush",lt).on("keyup.brush",at),ut,ft;if(t.event.changedTouches)rt.on("touchmove.brush",nt).on("touchend.brush",ot);else rt.on("mousemove.brush",nt).on("mouseup.brush",ot);k.interrupt().selectAll("*").interrupt();p?(l[0]=n[0]-l[0],l[1]=i[0]-l[1]):d?(ut=+/w$/.test(d),ft=+/^n/.test(d),g=[n[1-ut]-l[0],i[1-ft]-l[1]],l[0]=n[ut],l[1]=i[ft]):t.event.altKey&&(w=l.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null);t.select("body").style("cursor",tt.style("cursor"));it({type:"brushstart"});nt()}var c=ko(f,"brushstart","brush","brushend"),r=null,u=null,n=[0,0],i=[0,0],e,o,s=!0,h=!0,l=al[0];return f.event=function(r){r.each(function(){var u=c.of(this,arguments),r={x:n,y:i,i:e,j:o},f=this.__chart__||r;this.__chart__=r;gi?t.select(this).transition().each("start.brush",function(){e=f.i;o=f.j;n=f.x;i=f.y;u({type:"brushstart"})}).tween("brush:brush",function(){var t=no(n,r.x),f=no(i,r.y);return e=o=null,function(e){n=r.x=t(e);i=r.y=f(e);u({type:"brush",mode:"resize"})}}).each("end.brush",function(){e=r.i;o=r.j;u({type:"brush",mode:"resize"});u({type:"brushend"})}):(u({type:"brushstart"}),u({type:"brush",mode:"resize"}),u({type:"brushend"}))})},f.x=function(n){return arguments.length?(r=n,l=al[!r<<1|!u],f):r},f.y=function(n){return arguments.length?(u=n,l=al[!r<<1|!u],f):u},f.clamp=function(n){return arguments.length?(r&&u?(s=!!n[0],h=!!n[1]):r?s=!!n:u&&(h=!!n),f):r&&u?[s,h]:r?s:u?h:null},f.extent=function(t){var s,h,c,l,a;return arguments.length?(r&&(s=t[0],h=t[1],u&&(s=s[0],h=h[0]),e=[s,h],r.invert&&(s=r(s),h=r(h)),h<s&&(a=s,s=h,h=a),(s!=n[0]||h!=n[1])&&(n=[s,h])),u&&(c=t[0],l=t[1],r&&(c=c[1],l=l[1]),o=[c,l],u.invert&&(c=u(c),l=u(l)),l<c&&(a=c,c=l,l=a),(c!=i[0]||l!=i[1])&&(i=[c,l])),f):(r&&(e?(s=e[0],h=e[1]):(s=n[0],h=n[1],r.invert&&(s=r.invert(s),h=r.invert(h)),h<s&&(a=s,s=h,h=a))),u&&(o?(c=o[0],l=o[1]):(c=i[0],l=i[1],u.invert&&(c=u.invert(c),l=u.invert(l)),l<c&&(a=c,c=l,l=a))),r&&u?[[s,c],[h,l]]:r?[s,h]:u&&[c,l])},f.clear=function(){return f.empty()||(n=[0,0],i=[0,0],e=o=null),f},f.empty=function(){return!!r&&n[0]==n[1]||!!u&&i[0]==i[1]},t.rebind(f,c,"on")};var put={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},al=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],vl=u.format=nh.timeFormat,ck=vl.utc,lk=ck("%Y-%m-%dT%H:%M:%S.%LZ");vl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?yl:lk;yl.parse=function(n){var t=new Date(n);return isNaN(t)?null:t};yl.toString=lk.toString;u.second=ai(function(n){return new w(Math.floor(n/1e3)*1e3)},function(n,t){n.setTime(n.getTime()+Math.floor(t)*1e3)},function(n){return n.getSeconds()});u.seconds=u.second.range;u.seconds.utc=u.second.utc.range;u.minute=ai(function(n){return new w(Math.floor(n/6e4)*6e4)},function(n,t){n.setTime(n.getTime()+Math.floor(t)*6e4)},function(n){return n.getMinutes()});u.minutes=u.minute.range;u.minutes.utc=u.minute.utc.range;u.hour=ai(function(n){var t=n.getTimezoneOffset()/60;return new w((Math.floor(n/36e5-t)+t)*36e5)},function(n,t){n.setTime(n.getTime()+Math.floor(t)*36e5)},function(n){return n.getHours()});u.hours=u.hour.range;u.hours.utc=u.hour.utc.range;u.month=ai(function(n){return n=u.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()});u.months=u.month.range;u.months.utc=u.month.utc.range;var lo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],wl=[[u.second,1],[u.second,5],[u.second,15],[u.second,30],[u.minute,1],[u.minute,5],[u.minute,15],[u.minute,30],[u.hour,1],[u.hour,3],[u.hour,6],[u.hour,12],[u.day,1],[u.day,2],[u.week,1],[u.month,1],[u.month,3],[u.year,1]],wut=vl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&n.getDate()!=1}],["%b %d",function(n){return n.getDate()!=1}],["%B",function(n){return n.getMonth()}],["%Y",tu]]),but={range:function(n,i,r){return t.range(Math.ceil(n/r)*r,+i,r).map(nr)},floor:p,ceil:p};wl.year=u.year;u.scale=function(){return pl(t.scale.linear(),wl,wut)};bl=wl.map(function(n){return[n[0].utc,n[1]]});ak=ck.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&n.getUTCDate()!=1}],["%b %d",function(n){return n.getUTCDate()!=1}],["%B",function(n){return n.getUTCMonth()}],["%Y",tu]]);bl.year=u.year.utc;u.scale.utc=function(){return pl(t.scale.linear(),bl,ak)};t.text=ws(function(n){return n.responseText});t.json=function(n,t){return yf(n,"application/json",kut,t)};t.html=function(n,t){return yf(n,"text/html",dut,t)};t.xml=ws(function(n){return n.responseXML});typeof n=="function"&&n.amd?(this.d3=t,n(t)):typeof i=="object"&&i.exports?i.exports=t:this.d3=t}()},{}],130:[function(n,t){"use strict";function u(n,t){this.point=n;this.index=t}function f(n,t){for(var r,u=n.point,f=t.point,e=u.length,i=0;i<e;++i)if(r=f[i]-u[i],r)return r;return 0}function e(n,t,i){var f,r,u,e,o;if(n===1)return i?[[-1,0]]:[];for(f=t.map(function(n,t){return[n[0],t]}),f.sort(function(n,t){return n[0]-t[0]}),r=new Array(n-1),u=1;u<n;++u)e=f[u-1],o=f[u],r[u-1]=[e[1],o[1]];return i&&r.push([-1,r[0][1],],[r[n-1][1],-1]),r}function o(n,t){var h=n.length,s,v,w,y,b,a,o,l,c;if(h===0)return[];if(s=n[0].length,s<1)return[];if(s===1)return e(h,n,t);for(v=new Array(h),w=1,o=0;o<h;++o){var nt=n[o],c=new Array(s+1),g=0;for(y=0;y<s;++y)b=nt[y],c[y]=b,g+=b*b;c[s]=g;v[o]=new u(c,o);w=Math.max(g,w)}r(v,f);h=v.length;var k=new Array(h+s+1),p=new Array(h+s+1),tt=(s+1)*(s+1)*w,d=new Array(s+1);for(o=0;o<=s;++o)d[o]=0;for(d[s]=tt,k[0]=d.slice(),p[0]=-1,o=0;o<=s;++o)c=d.slice(),c[o]=1,k[o+1]=c,p[o+1]=-1;for(o=0;o<h;++o)l=v[o],k[o+s+1]=l.point,p[o+s+1]=l.index;if(a=i(k,!1),a=t?a.filter(function(n){for(var i,r=0,t=0;t<=s;++t){if(i=p[n[t]],i<0&&++r>=2)return!1;n[t]=i}return!0}):a.filter(function(n){for(var i,t=0;t<=s;++t){if(i=p[n[t]],i<0)return!1;n[t]=i}return!0}),s&1)for(o=0;o<a.length;++o)l=a[o],c=l[0],l[0]=l[1],l[1]=c;return a}var i=n("incremental-convex-hull"),r=n("uniq");t.exports=o},{"incremental-convex-hull":315,uniq:551}],131:[function(n,t){"use strict";function i(n,t,r){var f=n[r]|0,e,u;if(f<=0)return[];if(e=new Array(f),r===n.length-1)for(u=0;u<f;++u)e[u]=t;else for(u=0;u<f;++u)e[u]=i(n,t,r+1);return e}function r(n,t){for(var r=new Array(n),i=0;i<n;++i)r[i]=t;return r}function u(n,t){typeof t=="undefined"&&(t=0);switch(typeof n){case"number":if(n>0)return r(n|0,t);break;case"object":if(typeof n.length=="number")return i(n,t,0)}return[]}t.exports=u},{}],132:[function(t,i){(function(r,u){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.1.2
 */
(function(){"use strict";function ri(n){return typeof n=="function"||typeof n=="object"&&n!==null}function ot(n){return typeof n=="function"}function fi(n){ut=n}function ei(n){s=n}function hi(){return function(){r.nextTick(y)}}function ci(){return function(){ht(y)}}function li(){var n=0,i=new at(y),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function ai(){var n=new MessageChannel;return n.port1.onmessage=y,function(){n.port2.postMessage(0)}}function vt(){return function(){setTimeout(y,1)}}function y(){for(var t,i,n=0;n<v;n+=2)t=h[n],i=h[n+1],t(i),h[n]=undefined,h[n+1]=undefined;v=0}function vi(){try{var i=t,n=i("vertx");return ht=n.runOnLoop||n.runOnContext,ci()}catch(r){return vt()}}function yi(n,t){var u=this,i=u._state,r,f,e;return i===p&&!n||i===a&&!t?this:(r=new this.constructor(c),f=u._result,i?(e=arguments[i-1],s(function(){kt(i,r,e,f)})):nt(u,r,n,t),r)}function pi(n){var i=this,t;return n&&typeof n=="object"&&n.constructor===i?n:(t=new i(c),w(t,n),t)}function c(){}function wi(){return new TypeError("You cannot resolve a promise with itself")}function bi(){return new TypeError("A promises callback cannot return that same promise.")}function pt(n){try{return n.then}catch(t){return g.error=t,g}}function ki(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function di(n,t,i){s(function(n){var r=!1,u=ki(i,t,function(i){r||(r=!0,t!==i?w(n,i):o(n,i))},function(t){r||(r=!0,f(n,t))},"Settle: "+(n._label||" unknown promise"));!r&&u&&(r=!0,f(n,u))},n)}function gi(n,t){t._state===p?o(n,t._result):t._state===a?f(n,t._result):nt(t,undefined,function(t){w(n,t)},function(t){f(n,t)})}function wt(n,t,i){t.constructor===n.constructor&&i===k&&constructor.resolve===d?gi(n,t):i===g?f(n,g.error):i===undefined?o(n,t):ot(i)?di(n,t,i):o(n,t)}function w(n,t){n===t?f(n,wi()):ri(t)?wt(n,t,pt(t)):o(n,t)}function nr(n){n._onerror&&n._onerror(n._result);ft(n)}function o(n,t){n._state===l&&(n._result=t,n._state=p,n._subscribers.length!==0&&s(ft,n))}function f(n,t){n._state===l&&(n._state=a,n._result=t,s(nr,n))}function nt(n,t,i,r){var u=n._subscribers,f=u.length;n._onerror=null;u[f]=t;u[f+p]=i;u[f+a]=r;f===0&&n._state&&s(ft,n)}function ft(n){var i=n._subscribers,e=n._state,r,u,f,t;if(i.length!==0){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?kt(e,r,u,f):u(f);n._subscribers.length=0}}function bt(){this.error=null}function tr(n,t){try{return n(t)}catch(i){return tt.error=i,tt}}function kt(n,t,i,r){var s=ot(i),u,h,e,c;if(s){if(u=tr(i,r),u===tt?(c=!0,h=u.error,u=null):e=!0,t===u){f(t,bi());return}}else u=r,e=!0;t._state!==l||(s&&e?w(t,u):c?f(t,h):n===p?o(t,u):n===a&&f(t,u))}function ir(n,t){try{t(function(t){w(n,t)},function(t){f(n,t)})}catch(i){f(n,i)}}function rr(n){return new ii(this,n).promise}function ur(n){function e(n){w(t,n)}function o(n){f(t,n)}var r=this,t=new r(c),u,i;if(!ui(n))return f(t,new TypeError("You must pass an array to race.")),t;for(u=n.length,i=0;t._state===l&&i<u;i++)nt(r.resolve(n[i]),undefined,e,o);return t}function fr(n){var i=this,t=new i(c);return f(t,n),t}function er(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function or(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function e(n){this._id=ti++;this._state=undefined;this._result=undefined;this._subscribers=[];c!==n&&(typeof n!="function"&&er(),this instanceof e?ir(this,n):or())}function b(n,t){this._instanceConstructor=n;this.promise=new n(c);Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),this.length===0?o(this.promise,this._result):(this.length=this.length||0,this._enumerate(),this._remaining===0&&o(this.promise,this._result))):f(this.promise,this._validationError())}function sr(){var n,t;if(typeof u!="undefined")n=u;else if(typeof self!="undefined")n=self;else try{n=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment");}(t=n.Promise,!t||Object.prototype.toString.call(t.resolve())!=="[object Promise]"||t.cast)&&(n.Promise=it)}var st,h,yt,k,d,tt,dt,gt,ni,ti,it,ii,et,rt;st=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"};var ui=st,v=0,ht,ut,s=function(n,t){h[v]=n;h[v+1]=t;v+=2;v===2&&(ut?ut(y):yt())};var ct=typeof window!="undefined"?window:undefined,lt=ct||{},at=lt.MutationObserver||lt.WebKitMutationObserver,oi=typeof r!="undefined"&&{}.toString.call(r)==="[object process]",si=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";h=new Array(1e3);yt=oi?hi():at?li():si?ai():ct===undefined&&typeof t=="function"?vi():vt();k=yi;d=pi;var l=void 0,p=1,a=2,g=new bt;tt=new bt;dt=rr;gt=ur;ni=fr;ti=0;it=e;e.all=dt;e.race=gt;e.resolve=d;e.reject=ni;e._setScheduler=fi;e._setAsap=ei;e._asap=s;e.prototype={constructor:e,then:k,"catch":function(n){return this.then(null,n)}};ii=b;b.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};b.prototype._enumerate=function(){for(var t=this.length,i=this._input,n=0;this._state===l&&n<t;n++)this._eachEntry(i[n],n)};b.prototype._eachEntry=function(n,t){var i=this._instanceConstructor,f=i.resolve,r,u;f===d?(r=pt(n),r===k&&n._state!==l?this._settledAt(n._state,t,n._result):typeof r!="function"?(this._remaining--,this._result[t]=n):i===it?(u=new i(c),wt(u,n,r),this._willSettleAt(u,t)):this._willSettleAt(new i(function(t){t(n)}),t)):this._willSettleAt(f(n),t)};b.prototype._settledAt=function(n,t,i){var r=this.promise;r._state===l&&(this._remaining--,n===a?f(r,i):this._result[t]=i);this._remaining===0&&o(r,this._result)};b.prototype._willSettleAt=function(n,t){var i=this;nt(n,undefined,function(n){i._settledAt(p,t,n)},function(n){i._settledAt(a,t,n)})};et=sr;rt={Promise:it,polyfill:et};typeof n=="function"&&n.amd?n(function(){return rt}):typeof i!="undefined"&&i.exports?i.exports=rt:typeof this!="undefined"&&(this.ES6Promise=rt);et()}).call(this)}).call(this,t("_process"),typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:64}],133:[function(n,t){"use strict";function i(n){for(var r=n.length,t,i=0;i<r;i++)if(t=n.charCodeAt(i),(t<9||t>13)&&t!==32&&t!==133&&t!==160&&t!==5760&&t!==6158&&(t<8192||t>8205)&&t!==8232&&t!==8233&&t!==8239&&t!==8287&&t!==8288&&t!==12288&&t!==65279)return!1;return!0}t.exports=function(n){var t=typeof n,r;if(t==="string"){if(r=n,n=+n,n===0&&i(r))return!1}else if(t!=="number")return!1;return n-n<1}},{}],134:[function(n,t){"use strict";function f(n,t,i,r,u){this.gl=n;this.type=t;this.handle=i;this.length=r;this.usage=u}function i(n,t,i,r,u,f){var e=u.length*u.BYTES_PER_ELEMENT;if(f<0)return n.bufferData(t,u,r),e;if(e+f>i)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return n.bufferSubData(t,f,u),i}function e(n,t){for(var u=r.malloc(n.length,t),f=n.length,i=0;i<f;++i)u[i]=n[i];return u}function c(n,t){for(var r=1,i=t.length-1;i>=0;--i){if(t[i]!==r)return!1;r*=n[i]}return!0}function l(n,t,i,r){if(i=i||n.ARRAY_BUFFER,r=r||n.DYNAMIC_DRAW,i!==n.ARRAY_BUFFER&&i!==n.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(r!==n.DYNAMIC_DRAW&&r!==n.STATIC_DRAW&&r!==n.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var e=n.createBuffer(),u=new f(n,i,e,0,r);return u.update(t),u}var r=n("typedarray-pool"),o=n("ndarray-ops"),s=n("ndarray"),h=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],u=f.prototype;u.bind=function(){this.gl.bindBuffer(this.type,this.handle)};u.unbind=function(){this.gl.bindBuffer(this.type,null)};u.dispose=function(){this.gl.deleteBuffer(this.handle)};u.update=function(n,t){var u,a,f,v,l;if(typeof t!="number"&&(t=-1),this.bind(),typeof n=="object"&&typeof n.shape!="undefined")u=n.dtype,h.indexOf(u)<0&&(u="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(a=gl.getExtension("OES_element_index_uint"),u=a&&u!=="uint16"?"uint32":"uint16"),u===n.dtype&&c(n.shape,n.stride)?this.length=n.offset===0&&n.data.length===n.shape[0]?i(this.gl,this.type,this.length,this.usage,n.data,t):i(this.gl,this.type,this.length,this.usage,n.data.subarray(n.offset,n.shape[0]),t):(f=r.malloc(n.size,u),v=s(f,n.shape),o.assign(v,n),this.length=t<0?i(this.gl,this.type,this.length,this.usage,f,t):i(this.gl,this.type,this.length,this.usage,f.subarray(0,n.size),t),r.free(f));else if(Array.isArray(n))l=this.type===this.gl.ELEMENT_ARRAY_BUFFER?e(n,"uint16"):e(n,"float32"),this.length=t<0?i(this.gl,this.type,this.length,this.usage,l,t):i(this.gl,this.type,this.length,this.usage,l.subarray(0,n.length),t),r.free(l);else if(typeof n=="object"&&typeof n.length=="number")this.length=i(this.gl,this.type,this.length,this.usage,n,t);else if(typeof n=="number"||n===undefined){if(t>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");n=n|0;n<=0&&(n=1);this.gl.bufferData(this.type,n|0,this.usage);this.length=n}else throw new Error("gl-buffer: Invalid data type");};t.exports=l},{ndarray:525,"ndarray-ops":524,"typedarray-pool":550}],135:[function(n,t){"use strict";function e(n,t,i){this.plot=n;this.shader=t;this.buffer=i;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.numPoints=0;this.color=[0,0,0,1]}function h(n,t){var r=o(n.gl,f.vertex,f.fragment),u=s(n.gl),i=new e(n,r,u);return i.update(t),n.addObject(i),i}var o=n("gl-shader"),s=n("gl-buffer"),u=n("typedarray-pool"),f=n("./lib/shaders"),r,i;t.exports=h;r=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];i=e.prototype;i.draw=function(){var n=[1,0,0,0,1,0,0,0,1],t=[1,1];return function(){var e=this.plot,i=this.shader,p=this.buffer,u=this.bounds,h=this.numPoints,v,y;if(h){var o=e.gl,f=e.dataBox,s=e.viewBox,c=e.pixelRatio,w=u[2]-u[0],b=u[3]-u[1],l=f[2]-f[0],a=f[3]-f[1];n[0]=2*w/l;n[4]=2*b/a;n[6]=2*(u[0]-f[0])/l-1;n[7]=2*(u[1]-f[1])/a-1;v=s[2]-s[0];y=s[3]-s[1];t[0]=2*c/v;t[1]=2*c/y;p.bind();i.bind();i.uniforms.viewTransform=n;i.uniforms.pixelScale=t;i.uniforms.color=this.color;i.attributes.position.pointer(o.FLOAT,!1,16,0);i.attributes.pixelOffset.pointer(o.FLOAT,!1,16,8);o.drawArrays(o.TRIANGLES,0,h*r.length)}}}();i.drawPick=function(n){return n};i.pick=function(){return null};i.update=function(n){var y,t,p,b;n=n||{};var i,o,s,h=n.positions||[],v=n.errors||[],c=1;for(("lineWidth"in n)&&(c=+n.lineWidth),y=5,("capSize"in n)&&(y=+n.capSize),this.color=(n.color||[0,0,0,1]).slice(),t=this.bounds=[Infinity,Infinity,-Infinity,-Infinity],p=this.numPoints=h.length>>1,i=0;i<p;++i)o=h[i*2],s=h[i*2+1],t[0]=Math.min(o,t[0]),t[1]=Math.min(s,t[1]),t[2]=Math.max(o,t[2]),t[3]=Math.max(s,t[3]);t[2]===t[0]&&(t[2]+=1);t[3]===t[1]&&(t[3]+=1);var k=1/(t[2]-t[0]),d=1/(t[3]-t[1]),g=t[0],nt=t[1],f=u.mallocFloat32(p*r.length*4),w=0;for(i=0;i<p;++i){o=h[2*i];s=h[2*i+1];var tt=v[4*i],it=v[4*i+1],rt=v[4*i+2],ut=v[4*i+3];for(b=0;b<r.length;++b){var e=r[b],l=e[0],a=e[1];l<0?l*=tt:l>0&&(l*=it);a<0?a*=rt:a>0&&(a*=ut);f[w++]=k*(o-g+l);f[w++]=d*(s-nt+a);f[w++]=c*e[2]+(y+c)*e[4];f[w++]=c*e[3]+(y+c)*e[5]}}this.buffer.update(f);u.free(f)};i.dispose=function(){this.plot.removeObject(this);this.shader.dispose();this.buffer.dispose()}},{"./lib/shaders":136,"gl-buffer":134,"gl-shader":277,"typedarray-pool":550}],136:[function(n,t){t.exports={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec2 pixelOffset;\n\nuniform mat3 viewTransform;\nuniform vec2 pixelScale;\n\nvoid main() {\n  vec3 scrPosition = viewTransform * vec3(position, 1);\n  gl_Position = vec4(\n    scrPosition.xy + scrPosition.z * pixelScale * pixelOffset,\n    0,\n    scrPosition.z);\n}\n",fragment:"precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n"}},{}],137:[function(n,t){"use strict";function u(n,t,i,r){this.gl=n;this.shader=r;this.buffer=t;this.vao=i;this.pixelRatio=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[10,10,10];this.lineCount=[0,0,0];this.lineOffset=[0,0,0];this.opacity=1}function f(n,t){for(var i=0;i<3;++i)n[0][i]=Math.min(n[0][i],t[i]),n[1][i]=Math.max(n[1][i],t[i])}function o(n,t,i,r){for(var u,f=e[r],o=0;o<f.length;++o)u=f[o],n.push(t[0],t[1],t[2],i[0],i[1],i[2],i[3],u[0],u[1],u[2]);return f.length}function l(n){var t=n.gl,i=s(t),e=h(t,[{buffer:i,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:i,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:i,type:t.FLOAT,size:3,offset:28,stride:40}]),r=c(t),f;return r.attributes.position.location=0,r.attributes.color.location=1,r.attributes.offset.location=2,f=new u(t,i,e,r),f.update(n),f}var i,e;t.exports=l;var s=n("gl-buffer"),h=n("gl-vao"),c=n("./shaders/index"),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];i=u.prototype;i.isOpaque=function(){return this.opacity>=1};i.isTransparent=function(){return this.opacity<1};i.drawTransparent=i.draw=function(n){var e=this.gl,i=this.shader.uniforms,u,f,t;this.shader.bind();u=i.view=n.view||r;f=i.projection=n.projection||r;i.model=n.model||r;i.clipBounds=this.clipBounds;i.opacity=this.opacity;var o=u[12],s=u[13],h=u[14],c=u[15],l=this.pixelRatio*(f[3]*o+f[7]*s+f[11]*h+f[15]*c)/e.drawingBufferHeight;for(this.vao.bind(),t=0;t<3;++t)e.lineWidth(this.lineWidth[t]),i.capSize=this.capSize[t]*l,e.drawArrays(e.LINES,this.lineOffset[t],this.lineCount[t]);this.vao.unbind()};e=function(){for(var r,t,i,e,u,f=new Array(3),n=0;n<3;++n){for(r=[],t=1;t<=2;++t)for(i=-1;i<=1;i+=2)e=(t+n)%3,u=[0,0,0],u[e]=i,r.push(u);f[n]=r}return f}();i.update=function(n){var i,h,u,l,s,t,r;n=n||{};"lineWidth"in n&&(this.lineWidth=n.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]));"capSize"in n&&(this.capSize=n.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize]));"opacity"in n&&(this.opacity=n.opacity);var e=n.color||[[0,0,0],[0,0,0],[0,0,0]],v=n.position,y=n.error;if(Array.isArray(e[0])||(e=[e,e,e]),v&&y){var c=[],p=v.length,a=0;for(this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]],this.lineCount=[0,0,0],i=0;i<3;++i){this.lineOffset[i]=a;n:for(h=0;h<p;++h){for(u=v[h],l=0;l<3;++l)if(isNaN(u[l])||!isFinite(u[l]))continue n;(s=y[h],t=e[i],Array.isArray(t[0])&&(t=e[h]),t.length===3&&(t=[t[0],t[1],t[2],1]),isNaN(s[0][i])||isNaN(s[1][i]))||(s[0][i]<0&&(r=u.slice(),r[i]+=s[0][i],c.push(u[0],u[1],u[2],t[0],t[1],t[2],t[3],0,0,0,r[0],r[1],r[2],t[0],t[1],t[2],t[3],0,0,0),f(this.bounds,r),a+=2+o(c,r,t,i)),s[1][i]>0&&(r=u.slice(),r[i]+=s[1][i],c.push(u[0],u[1],u[2],t[0],t[1],t[2],t[3],0,0,0,r[0],r[1],r[2],t[0],t[1],t[2],t[3],0,0,0),f(this.bounds,r),a+=2+o(c,r,t,i)))}this.lineCount[i]=a-this.lineOffset[i]}this.buffer.update(c)}};i.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()}},{"./shaders/index":138,"gl-buffer":134,"gl-vao":306}],138:[function(n,t){"use strict";var i=n("gl-shader"),r="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}",u="precision mediump float;\n#define GLSLIFY 1\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(fragPosition, clipBounds[0])) || any(greaterThan(fragPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = opacity * fragColor;\n}";t.exports=function(n){return i(n,r,u,null,[{name:"position",type:"vec3"},{name:"offset",type:"vec3"},{name:"color",type:"vec4"}])}},{"gl-shader":277}],139:[function(n,t){"use strict";function a(n){var t=n.getParameter(n.FRAMEBUFFER_BINDING),i=n.getParameter(n.RENDERBUFFER_BINDING),r=n.getParameter(n.TEXTURE_BINDING_2D);return[t,i,r]}function r(n,t){n.bindFramebuffer(n.FRAMEBUFFER,t[0]);n.bindRenderbuffer(n.RENDERBUFFER,t[1]);n.bindTexture(n.TEXTURE_2D,t[2])}function w(n,t){var f=n.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL),u,e,r;for(i=new Array(f+1),u=0;u<=f;++u){for(e=new Array(f),r=0;r<u;++r)e[r]=n.COLOR_ATTACHMENT0+r;for(r=u;r<f;++r)e[r]=n.NONE;i[u]=e}}function v(n){switch(n){case e:throw new Error("gl-fbo: Framebuffer unsupported");case h:throw new Error("gl-fbo: Framebuffer incomplete attachment");case c:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case l:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason");}}function o(n,t,i,r,u,f){if(!r)return null;var e=p(n,t,i,u,r);return e.magFilter=n.NEAREST,e.minFilter=n.NEAREST,e.mipSamples=1,e.bind(),n.framebufferTexture2D(n.FRAMEBUFFER,f,n.TEXTURE_2D,e.handle,0),e}function u(n,t,i,r,u){var f=n.createRenderbuffer();return n.bindRenderbuffer(n.RENDERBUFFER,f),n.renderbufferStorage(n.RENDERBUFFER,r,t,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,u,n.RENDERBUFFER,f),f}function b(n){var b=a(n.gl),t=n.gl,k=n.handle=t.createFramebuffer(),e=n._shape[0],s=n._shape[1],h=n.color.length,c=n._ext,l=n._useStencil,y=n._useDepth,d=n._colorType,p,w,f;for(t.bindFramebuffer(t.FRAMEBUFFER,k),f=0;f<h;++f)n.color[f]=o(t,e,s,d,t.RGBA,t.COLOR_ATTACHMENT0+f);if(h===0?(n._color_rb=u(t,e,s,t.RGBA4,t.COLOR_ATTACHMENT0),c&&c.drawBuffersWEBGL(i[0])):h>1&&c.drawBuffersWEBGL(i[h]),p=t.getExtension("WEBGL_depth_texture"),p?l?n.depth=o(t,e,s,p.UNSIGNED_INT_24_8_WEBGL,t.DEPTH_STENCIL,t.DEPTH_STENCIL_ATTACHMENT):y&&(n.depth=o(t,e,s,t.UNSIGNED_SHORT,t.DEPTH_COMPONENT,t.DEPTH_ATTACHMENT)):y&&l?n._depth_rb=u(t,e,s,t.DEPTH_STENCIL,t.DEPTH_STENCIL_ATTACHMENT):y?n._depth_rb=u(t,e,s,t.DEPTH_COMPONENT16,t.DEPTH_ATTACHMENT):l&&(n._depth_rb=u(t,e,s,t.STENCIL_INDEX,t.STENCIL_ATTACHMENT)),w=t.checkFramebufferStatus(t.FRAMEBUFFER),w!==t.FRAMEBUFFER_COMPLETE){for(n._destroyed=!0,t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(n.handle),n.handle=null,n.depth&&(n.depth.dispose(),n.depth=null),n._depth_rb&&(t.deleteRenderbuffer(n._depth_rb),n._depth_rb=null),f=0;f<n.color.length;++f)n.color[f].dispose(),n.color[f]=null;n._color_rb&&(t.deleteRenderbuffer(n._color_rb),n._color_rb=null);r(t,b);v(w)}r(t,b)}function y(n,t,i,r,u,f,e,o){var h,s,c;for(this.gl=n,this._shape=[t|0,i|0],this._destroyed=!1,this._ext=o,this.color=new Array(u),h=0;h<u;++h)this.color[h]=null;this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=r;this._useDepth=f;this._useStencil=e;s=this;c=[t|0,i|0];Object.defineProperties(c,{0:{get:function(){return s._shape[0]},set:function(n){return s.width=n}},1:{get:function(){return s._shape[1]},set:function(n){return s.height=n}}});this._shapeVector=c;b(this)}function s(n,t,i){var u,e,o,f,s;if(n._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(n._shape[0]!==t||n._shape[1]!==i){if(u=n.gl,e=u.getParameter(u.MAX_RENDERBUFFER_SIZE),t<0||t>e||i<0||i>e)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");for(n._shape[0]=t,n._shape[1]=i,o=a(u),f=0;f<n.color.length;++f)n.color[f].shape=n._shape;n._color_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,n._color_rb),u.renderbufferStorage(u.RENDERBUFFER,u.RGBA4,n._shape[0],n._shape[1]));n.depth&&(n.depth.shape=n._shape);n._depth_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,n._depth_rb),n._useDepth&&n._useStencil?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,n._shape[0],n._shape[1]):n._useDepth?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_COMPONENT16,n._shape[0],n._shape[1]):n._useStencil&&u.renderbufferStorage(u.RENDERBUFFER,u.STENCIL_INDEX,n._shape[0],n._shape[1]));u.bindFramebuffer(u.FRAMEBUFFER,n.handle);s=u.checkFramebufferStatus(u.FRAMEBUFFER);s!==u.FRAMEBUFFER_COMPLETE&&(n.dispose(),r(u,o),v(s));r(u,o)}}function k(n,t,r,u){var o,a,f,s,v,p,b;if(e||(e=n.FRAMEBUFFER_UNSUPPORTED,h=n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,c=n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,l=n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT),o=n.getExtension("WEBGL_draw_buffers"),!i&&o&&w(n,o),Array.isArray(t)&&(u=r,r=t[1]|0,t=t[0]|0),typeof t!="number")throw new Error("gl-fbo: Missing shape parameter");if(a=n.getParameter(n.MAX_RENDERBUFFER_SIZE),t<0||t>a||r<0||r>a)throw new Error("gl-fbo: Parameters are too large for FBO");if(u=u||{},f=1,"color"in u){if(f=Math.max(u.color|0,0),f<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(f>1)if(o){if(f>n.getParameter(o.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+f+" draw buffers");}else throw new Error("gl-fbo: Multiple draw buffer extension not supported");}if(s=n.UNSIGNED_BYTE,v=n.getExtension("OES_texture_float"),u.float&&f>0){if(!v)throw new Error("gl-fbo: Context does not support floating point textures");s=n.FLOAT}else u.preferFloat&&f>0&&v&&(s=n.FLOAT);return p=!0,"depth"in u&&(p=!!u.depth),b=!1,"stencil"in u&&(b=!!u.stencil),new y(n,t,r,s,f,p,b,o)}var p=n("gl-texture2d"),i,e,h,c,l,f;t.exports=k;i=null;f=y.prototype;Object.defineProperties(f,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(n){if(Array.isArray(n)||(n=[n|0,n|0]),n.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var t=n[0]|0,i=n[1]|0;return s(this,t,i),[t,i]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(n){return n=n|0,s(this,n,this._shape[1]),n},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(n){return n=n|0,s(this,this._shape[0],n),n},enumerable:!1}});f.bind=function(){if(!this._destroyed){var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,this.handle);n.viewport(0,0,this._shape[0],this._shape[1])}};f.dispose=function(){var t,n;if(!this._destroyed){for(this._destroyed=!0,t=this.gl,t.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(t.deleteRenderbuffer(this._depth_rb),this._depth_rb=null),n=0;n<this.color.length;++n)this.color[n].dispose(),this.color[n]=null;this._color_rb&&(t.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":302}],140:[function(n,t,i){i.lineVertex="precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse_1_0(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse_1_0(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse_1_0(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse_1_0(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\n\nattribute vec2 a, d;\n\nuniform mat3 matrix;\nuniform vec2 screenShape;\nuniform float width;\n\nvarying vec2 direction;\n\nvoid main() {\n  vec2 dir = (matrix * vec3(d, 0)).xy;\n  vec3 base = matrix * vec3(a, 1);\n  vec2 n = 0.5 * width *\n    normalize(screenShape.yx * vec2(dir.y, -dir.x)) / screenShape.xy;\n  vec2 tangent = normalize(screenShape.xy * dir);\n  if(dir.x < 0.0 || (dir.x == 0.0 && dir.y < 0.0)) {\n    direction = -tangent;\n  } else {\n    direction = tangent;\n  }\n  gl_Position = vec4(base.xy/base.z + n, 0, 1);\n}\n";i.lineFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nuniform vec2 screenShape;\nuniform sampler2D dashPattern;\nuniform float dashLength;\n\nvarying vec2 direction;\n\nvoid main() {\n  float t = fract(dot(direction, gl_FragCoord.xy) / dashLength);\n  vec4 pcolor = color * texture2D(dashPattern, vec2(t, 0.0)).r;\n  gl_FragColor = vec4(pcolor.rgb * pcolor.a, pcolor.a);\n}\n";i.mitreVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 p;\n\nuniform mat3  matrix;\nuniform vec2 screenShape;\nuniform float radius;\n\nvoid main() {\n  vec3 pp = matrix * vec3(p, 1);\n  gl_Position  = vec4(pp.xy, 0, pp.z);\n  gl_PointSize = radius;\n}\n";i.mitreFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  if(length(gl_PointCoord.xy - 0.5) > 0.25) {\n    discard;\n  }\n  gl_FragColor = vec4(color.rgb, color.a);\n}\n";i.pickVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 a, d;\nattribute vec4 pick0, pick1;\n\nuniform mat3 matrix;\nuniform vec2 screenShape;\nuniform float width;\n\nvarying vec4 pickA, pickB;\n\nfloat inverse_1_0(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse_1_0(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse_1_0(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse_1_0(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\n\nvoid main() {\n  vec3 base = matrix * vec3(a, 1);\n  vec2 n = width *\n    normalize(screenShape.yx * vec2(d.y, -d.x)) / screenShape.xy;\n  gl_Position = vec4(base.xy/base.z + n, 0, 1);\n  pickA = pick0;\n  pickB = pick1;\n}\n";i.pickFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 pickOffset;\n\nvarying vec4 pickA, pickB;\n\nvoid main() {\n  vec4 fragId = vec4(pickA.xyz, 0.0);\n  if(pickB.w > pickA.w) {\n    fragId.xyz = pickB.xyz;\n  }\n\n  fragId += pickOffset;\n\n  fragId.y += floor(fragId.x / 256.0);\n  fragId.x -= floor(fragId.x / 256.0) * 256.0;\n\n  fragId.z += floor(fragId.y / 256.0);\n  fragId.y -= floor(fragId.y / 256.0) * 256.0;\n\n  fragId.w += floor(fragId.z / 256.0);\n  fragId.z -= floor(fragId.z / 256.0) * 256.0;\n\n  gl_FragColor = fragId / 255.0;\n}\n";i.fillVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 a, d;\n\nuniform mat3 matrix;\nuniform vec2 projectAxis;\nuniform float projectValue;\nuniform float depth;\n\nvoid main() {\n  vec3 base = matrix * vec3(a, 1);\n  vec2 p = base.xy / base.z;\n  if(d.y < 0.0 || (d.y == 0.0 && d.x < 0.0)) {\n    if(dot(p, projectAxis) < projectValue) {\n      p = p * (1.0 - abs(projectAxis)) + projectAxis * projectValue;\n    }\n  }\n  gl_Position = vec4(p, depth, 1);\n}\n";i.fillFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n"},{}],141:[function(n,t){"use strict";function s(n,t,i,r,u,f,e,o){this.plot=n;this.dashPattern=t;this.lineBuffer=i;this.pickBuffer=r;this.lineShader=u;this.mitreShader=f;this.fillShader=e;this.pickShader=o;this.usingDashes=!1;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.width=1;this.color=[0,0,1,1];this.fill=[!1,!1,!1,!1];this.fillColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.data=null;this.numPoints=0;this.vertCount=0;this.pickOffset=0;this.lodBuffer=[]}function c(n){return n.map(function(n){return n.slice()})}function l(n,t){var r=n.gl,h=e(r),c=e(r),l=o(r,[1,1]),a=f(r,i.lineVertex,i.lineFragment),v=f(r,i.mitreVertex,i.mitreFragment),y=f(r,i.fillVertex,i.fillFragment),p=f(r,i.pickVertex,i.pickFragment),u=new s(n,l,h,c,a,v,y,p);return n.addObject(u),u.update(t),u}var u;t.exports=l;var f=n("gl-shader"),e=n("gl-buffer"),o=n("gl-texture2d"),h=n("ndarray"),r=n("typedarray-pool"),i=n("./lib/shaders");u=s.prototype;u.draw=function(){var n=[1,0,0,0,1,0,0,0,1],t=[0,0],i=[1,0],r=[-1,0],u=[0,1],f=[0,-1];return function(){var v=this.plot,rt=this.color,g=this.width,lt=this.numPoints,l=this.bounds,h=this.vertCount,et,s,b,o,tt,y,k,c,it,d,p;if(h){var e=v.gl,w=v.viewBox,a=v.dataBox,nt=v.pixelRatio,ot=l[2]-l[0],st=l[3]-l[1],ut=a[2]-a[0],ft=a[3]-a[1],ht=w[2]-w[0],ct=w[3]-w[1];n[0]=2*ot/ut;n[4]=2*st/ft;n[6]=2*(l[0]-a[0])/ut-1;n[7]=2*(l[1]-a[1])/ft-1;t[0]=ht;t[1]=ct;et=this.lineBuffer;et.bind();s=this.fill;(s[0]||s[1]||s[2]||s[3])&&(b=this.fillShader,b.bind(),o=b.uniforms,o.matrix=n,o.depth=v.nextDepthValue(),tt=b.attributes,tt.a.pointer(e.FLOAT,!1,16,0),tt.d.pointer(e.FLOAT,!1,16,8),e.depthMask(!0),e.enable(e.DEPTH_TEST),y=this.fillColor,s[0]&&(o.color=y[0],o.projectAxis=r,o.projectValue=1,e.drawArrays(e.TRIANGLES,0,h)),s[1]&&(o.color=y[1],o.projectAxis=f,o.projectValue=1,e.drawArrays(e.TRIANGLES,0,h)),s[2]&&(o.color=y[2],o.projectAxis=i,o.projectValue=1,e.drawArrays(e.TRIANGLES,0,h)),s[3]&&(o.color=y[3],o.projectAxis=u,o.projectValue=1,e.drawArrays(e.TRIANGLES,0,h)),e.depthMask(!1),e.disable(e.DEPTH_TEST));k=this.lineShader;k.bind();c=k.uniforms;c.matrix=n;c.color=rt;c.width=g*nt;c.screenShape=t;c.dashPattern=this.dashPattern.bind();c.dashLength=this.dashLength*nt;it=k.attributes;it.a.pointer(e.FLOAT,!1,16,0);it.d.pointer(e.FLOAT,!1,16,8);e.drawArrays(e.TRIANGLES,0,h);g>2&&!this.usingDashes&&(d=this.mitreShader,d.bind(),p=d.uniforms,p.matrix=n,p.color=rt,p.screenShape=t,p.radius=g*nt,d.attributes.p.pointer(e.FLOAT,!1,48,0),e.drawArrays(e.POINTS,0,h/3|0))}}}();u.drawPick=function(){var n=[1,0,0,0,1,0,0,0,1],i=[0,0],t=[0,0,0,0];return function(r){var h=this.plot,l=this.pickShader,w=this.lineBuffer,b=this.pickBuffer,k=this.width,a=this.numPoints,u=this.bounds,v=this.vertCount,f=h.gl,c=h.viewBox,e=h.dataBox,d=h.pickPixelRatio,g=u[2]-u[0],nt=u[3]-u[1],y=e[2]-e[0],p=e[3]-e[1],tt=c[2]-c[0],it=c[3]-c[1],o,s;return(this.pickOffset=r,!v)?r+a:(n[0]=2*g/y,n[4]=2*nt/p,n[6]=2*(u[0]-e[0])/y-1,n[7]=2*(u[1]-e[1])/p-1,i[0]=tt,i[1]=it,t[0]=r&255,t[1]=r>>>8&255,t[2]=r>>>16&255,t[3]=r>>>24,l.bind(),o=l.uniforms,o.matrix=n,o.width=k*d,o.pickOffset=t,o.screenShape=i,s=l.attributes,w.bind(),s.a.pointer(f.FLOAT,!1,16,0),s.d.pointer(f.FLOAT,!1,16,8),b.bind(),s.pick0.pointer(f.UNSIGNED_BYTE,!1,8,0),s.pick1.pointer(f.UNSIGNED_BYTE,!1,8,4),f.drawArrays(f.TRIANGLES,0,v),r+a)}}();u.pick=function(n,t,i){var u=this.pickOffset,e=this.numPoints,r,f;return i<u||i>=u+e?null:(r=i-u,f=this.data,{object:this,pointId:r,dataCoord:[f[2*r],f[2*r+1]]})};u.update=function(n){var it,at,w,g,ut,v,t,b,e,l,a;for(n=n||{},it=this.plot.gl,at=!!n.connectGaps,this.color=(n.color||[0,0,1,1]).slice(),this.width=+(n.width||1),this.fill=(n.fill||[!1,!1,!1,!1]).slice(),this.fillColor=c(n.fillColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),w=n.dashes||[1],g=0,e=0;e<w.length;++e)g+=w[e];var rt=r.mallocUint8(g),nt=0,ht=255;for(e=0;e<w.length;++e){for(ut=0;ut<w[e];++ut)rt[nt++]=ht;ht^=255}if(this.dashPattern.dispose(),this.usingDashes=w.length>1,this.dashPattern=o(it,h(rt,[g,1,4],[1,0,0])),this.dashPattern.minFilter=it.NEAREST,this.dashPattern.magFilter=it.NEAREST,this.dashLength=g,r.free(rt),v=n.positions,this.data=v,t=this.bounds,t[0]=t[1]=Infinity,t[2]=t[3]=-Infinity,b=this.numPoints=v.length>>>1,b!==0){for(e=0;e<b;++e)(l=v[2*e],a=v[2*e+1],isNaN(l)||isNaN(a))||(t[0]=Math.min(t[0],l),t[1]=Math.min(t[1],a),t[2]=Math.max(t[2],l),t[3]=Math.max(t[3],a));t[0]===t[2]&&(t[2]+=1);t[3]===t[1]&&(t[3]+=1);for(var i=r.mallocFloat32(24*(b-1)),f=r.mallocUint32(12*(b-1)),u=i.length,s=f.length,nt=b,ct=0;nt>1;){var tt=--nt,l=v[2*nt],a=v[2*nt+1],lt=tt-1,y=v[2*lt],p=v[2*lt+1];if(!isNaN(l)&&!isNaN(a)&&!isNaN(y)&&!isNaN(p)){ct+=1;l=(l-t[0])/(t[2]-t[0]);a=(a-t[1])/(t[3]-t[1]);y=(y-t[0])/(t[2]-t[0]);p=(p-t[1])/(t[3]-t[1]);var k=y-l,d=p-a,ft=tt|16777216,et=tt-1,ot=tt,st=tt-1|16777216;i[--u]=-d;i[--u]=-k;i[--u]=a;i[--u]=l;f[--s]=ft;f[--s]=et;i[--u]=d;i[--u]=k;i[--u]=p;i[--u]=y;f[--s]=ot;f[--s]=st;i[--u]=-d;i[--u]=-k;i[--u]=p;i[--u]=y;f[--s]=ot;f[--s]=st;i[--u]=d;i[--u]=k;i[--u]=p;i[--u]=y;f[--s]=ot;f[--s]=st;i[--u]=-d;i[--u]=-k;i[--u]=a;i[--u]=l;f[--s]=ft;f[--s]=et;i[--u]=d;i[--u]=k;i[--u]=a;i[--u]=l;f[--s]=ft;f[--s]=et}}this.vertCount=6*ct;this.lineBuffer.update(i.subarray(u));this.pickBuffer.update(f.subarray(s));r.free(i);r.free(f)}};u.dispose=function(){this.plot.removeObject(this);this.lineBuffer.dispose();this.pickBuffer.dispose();this.lineShader.dispose();this.mitreShader.dispose();this.fillShader.dispose();this.pickShader.dispose();this.dashPattern.dispose()}},{"./lib/shaders":140,"gl-buffer":134,"gl-shader":277,"gl-texture2d":302,ndarray:525,"typedarray-pool":550}],142:[function(n,t,i){var r=n("gl-shader"),u="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvoid main() {\n  vec4 projected = projection * view * model * vec4(position, 1.0);\n  vec4 tangentClip = projection * view * model * vec4(nextPosition - position, 0.0);\n  vec2 tangent = normalize(screenShape * tangentClip.xy);\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(tangent.y, -tangent.x) / screenShape;\n\n  gl_Position = vec4(projected.xy + projected.w * offset, projected.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n",e="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n",o="precision mediump float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1_0(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\n\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId/255.0, encode_float_1_0(pixelArcLength).xyz);\n}",f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];i.createShader=function(n){return r(n,u,e,null,f)};i.createPickShader=function(n){return r(n,u,o,null,f)}},{"gl-shader":277}],143:[function(n,t){"use strict";function w(n,t){for(var r,u=0,i=0;i<3;++i)r=n[i]-t[i],u+=r*r;return Math.sqrt(u)}function o(n){for(var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],t=0;t<3;++t)i[0][t]=Math.max(n[0][t],i[0][t]),i[1][t]=Math.min(n[1][t],i[1][t]);return i}function s(n,t,i,r){this.arcLength=n;this.position=t;this.index=i;this.dataCoordinate=r}function h(n,t,i,r,u,f){this.gl=n;this.shader=t;this.pickShader=i;this.buffer=r;this.vao=u;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=f;this.dashScale=1;this.opacity=1;this.dirty=!0;this.pixelRatio=1}function b(n){var t=n.gl||n.scene&&n.scene.gl,r=y(t),i,e,o,s;r.attributes.position.location=0;r.attributes.nextPosition.location=1;r.attributes.arcLength.location=2;r.attributes.lineWidth.location=3;r.attributes.color.location=4;i=p(t);i.attributes.position.location=0;i.attributes.nextPosition.location=1;i.attributes.arcLength.location=2;i.attributes.lineWidth.location=3;i.attributes.color.location=4;var u=c(t),w=l(t,[{buffer:u,size:3,offset:0,stride:48},{buffer:u,size:3,offset:12,stride:48},{buffer:u,size:1,offset:24,stride:48},{buffer:u,size:1,offset:28,stride:48},{buffer:u,size:4,offset:32,stride:48}]),v=f(new Array(1024),[256,1,4]);for(e=0;e<1024;++e)v.data[e]=255;return o=a(t,v),o.wrap=t.REPEAT,s=new h(t,r,i,u,w,o),s.update(n),s}var i;t.exports=b;var c=n("gl-buffer"),l=n("gl-vao"),a=n("gl-texture2d"),v=n("glsl-read-float"),u=n("binary-search-bounds"),f=n("ndarray"),e=n("./lib/shaders"),y=e.createShader,p=e.createPickShader,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];i=h.prototype;i.isTransparent=function(){return this.opacity<1};i.isOpaque=function(){return this.opacity>=1};i.pickSlots=1;i.setPickBase=function(n){this.pickId=n};i.drawTransparent=i.draw=function(n){var t=this.gl,i=this.shader,u=this.vao;i.bind();i.uniforms={model:n.model||r,view:n.view||r,projection:n.projection||r,clipBounds:o(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};u.bind();u.draw(t.TRIANGLE_STRIP,this.vertexCount)};i.drawPick=function(n){var t=this.gl,i=this.pickShader,u=this.vao;i.bind();i.uniforms={model:n.model||r,view:n.view||r,projection:n.projection||r,pickId:this.pickId,clipBounds:o(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};u.bind();u.draw(t.TRIANGLE_STRIP,this.vertexCount)};i.update=function(n){var r,t,ut,c,i,e,rt,o,s,v,d,ft,h,p;if(this.dirty=!0,ut=!!n.connectGaps,"dashScale"in n&&(this.dashScale=n.dashScale),"opacity"in n&&(this.opacity=+n.opacity),c=n.position||n.positions,c){var b=n.color||n.colors||[0,0,0,1],g=n.lineWidth||1,l=[],nt=[],tt=[],a=0,k=0,y=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]],it=!1;n:for(r=1;r<c.length;++r){for(i=c[r-1],e=c[r],nt.push(a),tt.push(i.slice()),t=0;t<3;++t){if(isNaN(i[t])||isNaN(e[t])||!isFinite(i[t])||!isFinite(e[t])){if(!ut&&l.length>0){for(rt=0;rt<24;++rt)l.push(l[l.length-12]);k+=2;it=!0}continue n}y[0][t]=Math.min(y[0][t],i[t],e[t]);y[1][t]=Math.max(y[1][t],i[t],e[t])}if(Array.isArray(b[0])?(o=b[r-1],s=b[r]):o=s=b,o.length===3&&(o=[o[0],o[1],o[2],1]),s.length===3&&(s=[s[0],s[1],s[2],1]),v=Array.isArray(g)?g[r-1]:g,d=a,a+=w(i,e),it){for(t=0;t<2;++t)l.push(i[0],i[1],i[2],e[0],e[1],e[2],d,v,o[0],o[1],o[2],o[3]);k+=2;it=!1}l.push(i[0],i[1],i[2],e[0],e[1],e[2],d,v,o[0],o[1],o[2],o[3],i[0],i[1],i[2],e[0],e[1],e[2],d,-v,o[0],o[1],o[2],o[3],e[0],e[1],e[2],i[0],i[1],i[2],a,-v,s[0],s[1],s[2],s[3],e[0],e[1],e[2],i[0],i[1],i[2],a,v,s[0],s[1],s[2],s[3]);k+=4}if(this.buffer.update(l),nt.push(a),tt.push(c[c.length-1].slice()),this.bounds=y,this.vertexCount=k,this.points=tt,this.arcLength=nt,"dashes"in n){for(ft=n.dashes,h=ft.slice(),h.unshift(0),r=1;r<h.length;++r)h[r]=h[r-1]+h[r];for(p=f(new Array(1024),[256,1,4]),r=0;r<256;++r){for(t=0;t<4;++t)p.set(r,0,t,0);u.le(h,h[h.length-1]*r/255)&1?p.set(r,0,0,0):p.set(r,0,0,255)}this.texture.setPixels(p)}}};i.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};i.pick=function(n){var r,t,i,e;if(!n||n.id!==this.pickId||(r=v(n.value[0],n.value[1],n.value[2],0),t=u.le(this.arcLength,r),t<0))return null;if(t===this.arcLength.length-1)return new s(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),t);var h=this.points[t],c=this.points[Math.min(t+1,this.points.length-1)],f=(r-this.arcLength[t])/(this.arcLength[t+1]-this.arcLength[t]),l=1-f,o=[0,0,0];for(i=0;i<3;++i)o[i]=l*h[i]+f*c[i];return e=Math.min(f<.5?t:t+1,this.points.length-1),new s(r,o,e,this.points[e])}},{"./lib/shaders":142,"binary-search-bounds":144,"gl-buffer":134,"gl-texture2d":302,"gl-vao":306,"glsl-read-float":145,ndarray:525}],144:[function(n,t,i){arguments[4][27][0].apply(i,arguments)},{dup:27}],145:[function(n,t){function u(n,t,u,f){return i[0]=f,i[1]=u,i[2]=t,i[3]=n,r[0]}t.exports=u;var i=new Uint8Array(4),r=new Float32Array(i.buffer)},{}],146:[function(n,t){function i(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],h=t[6],c=t[7],l=t[8],a=l*o-s*c,v=-l*e+s*h,y=c*e-o*h,i=r*a+u*v+f*y;return i?(i=1/i,n[0]=a*i,n[1]=(-l*u+f*c)*i,n[2]=(s*u-f*o)*i,n[3]=v*i,n[4]=(l*r-f*h)*i,n[5]=(-s*r+f*e)*i,n[6]=y*i,n[7]=(-c*r+u*h)*i,n[8]=(o*r-u*e)*i,n):null}t.exports=i},{}],147:[function(n,t){function i(n){var t=new Float32Array(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}t.exports=i},{}],148:[function(n,t){function i(){var n=new Float32Array(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}t.exports=i},{}],149:[function(n,t){function i(n){var t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=n[5],o=n[6],s=n[7],h=n[8],c=n[9],l=n[10],a=n[11],v=n[12],y=n[13],p=n[14],w=n[15],b=t*e-i*f,k=t*o-r*f,d=t*s-u*f,g=i*o-r*e,nt=i*s-u*e,tt=r*s-u*o,it=h*y-c*v,rt=h*p-l*v,ut=h*w-a*v,ft=c*p-l*y,et=c*w-a*y,ot=l*w-a*p;return b*ot-k*et+d*ft+g*ut-nt*rt+tt*it}t.exports=i},{}],150:[function(n,t){function i(n,t){var f=t[0],r=t[1],i=t[2],e=t[3],u=f+f,o=r+r,s=i+i,h=f*u,c=r*u,l=r*o,a=i*u,v=i*o,y=i*s,p=e*u,w=e*o,b=e*s;return n[0]=1-l-y,n[1]=c+b,n[2]=a-w,n[3]=0,n[4]=c-b,n[5]=1-h-y,n[6]=v+p,n[7]=0,n[8]=a+w,n[9]=v-p,n[10]=1-h-l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}t.exports=i},{}],151:[function(n,t){function i(n,t,i){var r=t[0],u=t[1],e=t[2],o=t[3],h=r+r,s=u+u,f=e+e,c=r*h,l=r*s,a=r*f,v=u*s,y=u*f,p=e*f,w=o*h,b=o*s,k=o*f;return n[0]=1-(v+p),n[1]=l+k,n[2]=a-b,n[3]=0,n[4]=l-k,n[5]=1-(c+p),n[6]=y+w,n[7]=0,n[8]=a+b,n[9]=y-w,n[10]=1-(c+v),n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}t.exports=i},{}],152:[function(n,t){function i(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}t.exports=i},{}],153:[function(n,t){function i(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],h=t[6],c=t[7],l=t[8],a=t[9],v=t[10],y=t[11],p=t[12],w=t[13],b=t[14],k=t[15],d=r*s-u*o,g=r*h-f*o,nt=r*c-e*o,tt=u*h-f*s,it=u*c-e*s,rt=f*c-e*h,ut=l*w-a*p,ft=l*b-v*p,et=l*k-y*p,ot=a*b-v*w,st=a*k-y*w,ht=v*k-y*b,i=d*ht-g*st+nt*ot+tt*et-it*ft+rt*ut;return i?(i=1/i,n[0]=(s*ht-h*st+c*ot)*i,n[1]=(f*st-u*ht-e*ot)*i,n[2]=(w*rt-b*it+k*tt)*i,n[3]=(v*it-a*rt-y*tt)*i,n[4]=(h*et-o*ht-c*ft)*i,n[5]=(r*ht-f*et+e*ft)*i,n[6]=(b*nt-p*rt-k*g)*i,n[7]=(l*rt-v*nt+y*g)*i,n[8]=(o*st-s*et+c*ut)*i,n[9]=(u*et-r*st-e*ut)*i,n[10]=(p*it-w*nt+k*d)*i,n[11]=(a*nt-l*it-y*d)*i,n[12]=(s*ft-o*ot-h*ut)*i,n[13]=(r*ot-u*ft+f*ut)*i,n[14]=(w*g-p*tt-b*d)*i,n[15]=(l*tt-a*g+v*d)*i,n):null}t.exports=i},{}],154:[function(n,t){function r(n,t,r,u){var h,c,l,a,v,y,e,o,s,f,p=t[0],w=t[1],b=t[2],k=u[0],d=u[1],g=u[2],nt=r[0],tt=r[1],it=r[2];return Math.abs(p-nt)<1e-6&&Math.abs(w-tt)<1e-6&&Math.abs(b-it)<1e-6?i(n):(e=p-nt,o=w-tt,s=b-it,f=1/Math.sqrt(e*e+o*o+s*s),e*=f,o*=f,s*=f,h=d*s-g*o,c=g*e-k*s,l=k*o-d*e,f=Math.sqrt(h*h+c*c+l*l),f?(f=1/f,h*=f,c*=f,l*=f):(h=0,c=0,l=0),a=o*l-s*c,v=s*h-e*l,y=e*c-o*h,f=Math.sqrt(a*a+v*v+y*y),f?(f=1/f,a*=f,v*=f,y*=f):(a=0,v=0,y=0),n[0]=h,n[1]=a,n[2]=e,n[3]=0,n[4]=c,n[5]=v,n[6]=o,n[7]=0,n[8]=l,n[9]=y,n[10]=s,n[11]=0,n[12]=-(h*p+c*w+l*b),n[13]=-(a*p+v*w+y*b),n[14]=-(e*p+o*w+s*b),n[15]=1,n)}var i=n("./identity");t.exports=r},{"./identity":152}],155:[function(n,t){function i(n,t,i){var o=t[0],s=t[1],h=t[2],c=t[3],l=t[4],a=t[5],v=t[6],y=t[7],p=t[8],w=t[9],b=t[10],k=t[11],d=t[12],g=t[13],nt=t[14],tt=t[15],r=i[0],u=i[1],f=i[2],e=i[3];return n[0]=r*o+u*l+f*p+e*d,n[1]=r*s+u*a+f*w+e*g,n[2]=r*h+u*v+f*b+e*nt,n[3]=r*c+u*y+f*k+e*tt,r=i[4],u=i[5],f=i[6],e=i[7],n[4]=r*o+u*l+f*p+e*d,n[5]=r*s+u*a+f*w+e*g,n[6]=r*h+u*v+f*b+e*nt,n[7]=r*c+u*y+f*k+e*tt,r=i[8],u=i[9],f=i[10],e=i[11],n[8]=r*o+u*l+f*p+e*d,n[9]=r*s+u*a+f*w+e*g,n[10]=r*h+u*v+f*b+e*nt,n[11]=r*c+u*y+f*k+e*tt,r=i[12],u=i[13],f=i[14],e=i[15],n[12]=r*o+u*l+f*p+e*d,n[13]=r*s+u*a+f*w+e*g,n[14]=r*h+u*v+f*b+e*nt,n[15]=r*c+u*y+f*k+e*tt,n}t.exports=i},{}],156:[function(n,t){function i(n,t,i,r,u){var f=1/Math.tan(t/2),e=1/(r-u);return n[0]=f/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=f,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(u+r)*e,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*u*r*e,n[15]=0,n}t.exports=i},{}],157:[function(n,t){function i(n,t,i,r){var u=r[0],f=r[1],e=r[2],h=Math.sqrt(u*u+f*f+e*e),s,c,o,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,l,a,v,y,p,w,b,k,d;return Math.abs(h)<1e-6?null:(h=1/h,u*=h,f*=h,e*=h,s=Math.sin(i),c=Math.cos(i),o=1-c,g=t[0],nt=t[1],tt=t[2],it=t[3],rt=t[4],ut=t[5],ft=t[6],et=t[7],ot=t[8],st=t[9],ht=t[10],ct=t[11],l=u*u*o+c,a=f*u*o+e*s,v=e*u*o-f*s,y=u*f*o-e*s,p=f*f*o+c,w=e*f*o+u*s,b=u*e*o+f*s,k=f*e*o-u*s,d=e*e*o+c,n[0]=g*l+rt*a+ot*v,n[1]=nt*l+ut*a+st*v,n[2]=tt*l+ft*a+ht*v,n[3]=it*l+et*a+ct*v,n[4]=g*y+rt*p+ot*w,n[5]=nt*y+ut*p+st*w,n[6]=tt*y+ft*p+ht*w,n[7]=it*y+et*p+ct*w,n[8]=g*b+rt*k+ot*d,n[9]=nt*b+ut*k+st*d,n[10]=tt*b+ft*k+ht*d,n[11]=it*b+et*k+ct*d,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)}t.exports=i},{}],158:[function(n,t){function i(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[4],e=t[5],o=t[6],s=t[7],h=t[8],c=t[9],l=t[10],a=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=f*u+h*r,n[5]=e*u+c*r,n[6]=o*u+l*r,n[7]=s*u+a*r,n[8]=h*u-f*r,n[9]=c*u-e*r,n[10]=l*u-o*r,n[11]=a*u-s*r,n}t.exports=i},{}],159:[function(n,t){function i(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[0],e=t[1],o=t[2],s=t[3],h=t[8],c=t[9],l=t[10],a=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*u-h*r,n[1]=e*u-c*r,n[2]=o*u-l*r,n[3]=s*u-a*r,n[8]=f*r+h*u,n[9]=e*r+c*u,n[10]=o*r+l*u,n[11]=s*r+a*u,n}t.exports=i},{}],160:[function(n,t){function i(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],l=t[6],a=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*u+h*r,n[1]=e*u+c*r,n[2]=o*u+l*r,n[3]=s*u+a*r,n[4]=h*u-f*r,n[5]=c*u-e*r,n[6]=l*u-o*r,n[7]=a*u-s*r,n}t.exports=i},{}],161:[function(n,t){function i(n,t,i){var r=i[0],u=i[1],f=i[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*u,n[5]=t[5]*u,n[6]=t[6]*u,n[7]=t[7]*u,n[8]=t[8]*f,n[9]=t[9]*f,n[10]=t[10]*f,n[11]=t[11]*f,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}t.exports=i},{}],162:[function(n,t){function i(n,t,i){var r=i[0],u=i[1],f=i[2],e,o,s,h,c,l,a,v,y,p,w,b;return t===n?(n[12]=t[0]*r+t[4]*u+t[8]*f+t[12],n[13]=t[1]*r+t[5]*u+t[9]*f+t[13],n[14]=t[2]*r+t[6]*u+t[10]*f+t[14],n[15]=t[3]*r+t[7]*u+t[11]*f+t[15]):(e=t[0],o=t[1],s=t[2],h=t[3],c=t[4],l=t[5],a=t[6],v=t[7],y=t[8],p=t[9],w=t[10],b=t[11],n[0]=e,n[1]=o,n[2]=s,n[3]=h,n[4]=c,n[5]=l,n[6]=a,n[7]=v,n[8]=y,n[9]=p,n[10]=w,n[11]=b,n[12]=e*r+c*u+y*f+t[12],n[13]=o*r+l*u+p*f+t[13],n[14]=s*r+a*u+w*f+t[14],n[15]=h*r+v*u+b*f+t[15]),n}t.exports=i},{}],163:[function(n,t){function i(n,t){if(n===t){var i=t[1],r=t[2],u=t[3],f=t[6],e=t[7],o=t[11];n[1]=t[4];n[2]=t[8];n[3]=t[12];n[4]=i;n[6]=t[9];n[7]=t[13];n[8]=r;n[9]=f;n[11]=t[14];n[12]=u;n[13]=e;n[14]=o}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n}t.exports=i},{}],164:[function(n,t){"use strict";function i(n,t){for(var i,u=[0,0,0,0],r=0;r<4;++r)for(i=0;i<4;++i)u[i]+=n[4*r+i]*t[r];return u}function f(n,t,r,u,f){for(var e=i(u,i(r,i(t,[n[0],n[1],n[2],1]))),o=0;o<3;++o)e[o]/=e[3];return[.5*f[0]*(1+e[0]),.5*f[1]*(1-e[1])]}function e(n,t){var i,f,e,o;if(n.length===2){for(i=0,f=0,e=0;e<2;++e)i+=Math.pow(t[e]-n[0][e],2),f+=Math.pow(t[e]-n[1][e],2);return(i=Math.sqrt(i),f=Math.sqrt(f),i+f<1e-6)?[1,0]:[f/(i+f),i/(f+i)]}return n.length===3?(o=[0,0],u(n[0],n[1],n[2],t,o),r(n,o)):[]}function o(n,t){for(var f,e,i,u=[0,0,0],r=0;r<n.length;++r)for(f=n[r],e=t[r],i=0;i<3;++i)u[i]+=e*f[i];return u}function s(n,t,i,r,u,s){var l,y,p,v,a,c,w,h;if(n.length===1)return[0,n[0].slice()];for(l=new Array(n.length),h=0;h<n.length;++h)l[h]=f(n[h],i,r,u,s);for(y=0,p=Infinity,h=0;h<l.length;++h){for(v=0,a=0;a<2;++a)v+=Math.pow(l[h][a]-t[a],2);v<p&&(p=v,y=h)}for(c=e(l,t),w=0,h=0;h<3;++h){if(c[h]<-.001||c[h]>1.0001)return null;w+=c[h]}return Math.abs(w-1)>.001?null:[y,o(n,c),c]}var r=n("barycentric"),u=n("polytope-closest-point/lib/closest_point_2d.js");t.exports=s},{barycentric:167,"polytope-closest-point/lib/closest_point_2d.js":169}],165:[function(n,t,i){var r="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}";i.meshShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec4 m_position  = model * vec4(position, 1.0);\n  vec4 t_position  = view * m_position;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = position;\n  f_eyeDirection   = eyePosition   - position;\n  f_lightDirection = lightPosition - position;\n  f_uv             = uv;\n}",fragment:"precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution_2_0(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\n\n\nfloat cookTorranceSpecular_1_1(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution_2_0(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular_1_1(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}",attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};i.wireShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}",fragment:"precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}",attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};i.pointShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}",fragment:"precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5,0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}",attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]};i.pickShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}",fragment:r,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]};i.pointPickShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}",fragment:r,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]};i.contourShader={vertex:"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}",fragment:"precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor,1);\n}\n",attributes:[{name:"position",type:"vec3"}]}},{}],166:[function(n,t){"use strict";function v(n,t,i,r,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){this.gl=n;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=!0;this.triShader=i;this.lineShader=r;this.pointShader=f;this.pickShader=e;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=h;this.triangleColors=l;this.triangleNormals=v;this.triangleUVs=a;this.triangleIds=c;this.triangleVAO=y;this.triangleCount=0;this.lineWidth=1;this.edgePositions=p;this.edgeColors=b;this.edgeUVs=k;this.edgeIds=w;this.edgeVAO=d;this.edgeCount=0;this.pointPositions=g;this.pointColors=tt;this.pointUVs=it;this.pointSizes=rt;this.pointIds=nt;this.pointVAO=ut;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=ft;this.contourVAO=et;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=!0;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this._model=u;this._view=u;this._projection=u;this._resolution=[1,1]}function ft(n){for(var u,i,f=b({colormap:n,nshades:256,format:"rgba"}),r=new Uint8Array(1024),t=0;t<256;++t){for(u=f[t],i=0;i<3;++i)r[4*t+i]=u[i];r[4*t+3]=u[3]*255}return l(r,[256,256,4],[4,0,1])}function et(n,t,i){for(var o,e,u,f=new Array(t),r=0;r<t;++r)f[r]=0;for(o=n.length,r=0;r<o;++r)for(e=n[r],u=0;u<e.length;++u)f[e[u]]=i[r];return f}function ot(n){for(var i=n.length,r=new Array(i),t=0;t<i;++t)r[t]=n[t][2];return r}function st(n){var t=f(n,g);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.normal.location=4,t}function ht(n){var t=f(n,nt);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t}function ct(n){var t=f(n,tt);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.pointSize.location=4,t}function lt(n){var t=f(n,it);return t.attributes.position.location=0,t.attributes.id.location=1,t}function at(n){var t=f(n,rt);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.pointSize.location=4,t}function vt(n){var t=f(n,ut);return t.attributes.position.location=0,t}function yt(n){var t=n.gl,rt=st(t),ut=ht(t),ft=ct(t),et=lt(t),ot=at(t),yt=vt(t),r=s(t,l(new Uint8Array([255,255,255,255]),[1,1,4]));r.generateMipmap();r.minFilter=t.LINEAR_MIPMAP_LINEAR;r.magFilter=t.LINEAR;var u=i(t),f=i(t),e=i(t),h=i(t),c=i(t),pt=o(t,[{buffer:u,type:t.FLOAT,size:3},{buffer:c,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:f,type:t.FLOAT,size:4},{buffer:e,type:t.FLOAT,size:2},{buffer:h,type:t.FLOAT,size:3}]),a=i(t),y=i(t),p=i(t),w=i(t),wt=o(t,[{buffer:a,type:t.FLOAT,size:3},{buffer:w,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:y,type:t.FLOAT,size:4},{buffer:p,type:t.FLOAT,size:2}]),b=i(t),k=i(t),d=i(t),g=i(t),nt=i(t),bt=o(t,[{buffer:b,type:t.FLOAT,size:3},{buffer:nt,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:k,type:t.FLOAT,size:4},{buffer:d,type:t.FLOAT,size:2},{buffer:g,type:t.FLOAT,size:1}]),tt=i(t),kt=o(t,[{buffer:tt,type:t.FLOAT,size:3}]),it=new v(t,r,rt,ut,ft,et,ot,yt,u,c,f,e,h,pt,a,w,y,p,wt,b,nt,k,d,g,bt,tt,kt);return it.update(n),it}var y=1e-6,p=1e-6,f=n("gl-shader"),i=n("gl-buffer"),o=n("gl-vao"),s=n("gl-texture2d"),h=n("normals"),c=n("gl-mat4/multiply"),w=n("gl-mat4/invert"),l=n("ndarray"),b=n("colormap"),k=n("simplicial-complex-contour"),a=n("typedarray-pool"),e=n("./lib/shaders"),d=n("./lib/closest-point"),g=e.meshShader,nt=e.wireShader,tt=e.pointShader,it=e.pickShader,rt=e.pointPickShader,ut=e.contourShader,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=v.prototype;r.isOpaque=function(){return this.opacity>=1};r.isTransparent=function(){return this.opacity<1};r.pickSlots=1;r.setPickBase=function(n){this.pickId=n};r.highlight=function(n){var r,u,f,t,i;if(!n||!this.contourEnable){this.contourCount=0;return}var e=k(this.cells,this.intensity,n.intensity),h=e.cells,c=e.vertexIds,y=e.vertexWeights,l=h.length,o=a.mallocFloat32(6*l),s=0;for(r=0;r<l;++r)for(u=h[r],f=0;f<2;++f){t=u[0];u.length===2&&(t=u[f]);var p=c[t][0],w=c[t][1],v=y[t],b=1-v,d=this.positions[p],g=this.positions[w];for(i=0;i<3;++i)o[s++]=v*d[i]+b*g[i]}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));a.free(o)};r.update=function(n){var rt,k,o,w,pt,fi,t,nt,v,i,e,r,u,b,ht;if(n=n||{},rt=this.gl,this.dirty=!0,"contourEnable"in n&&(this.contourEnable=n.contourEnable),"contourColor"in n&&(this.contourColor=n.contourColor),"lineWidth"in n&&(this.lineWidth=n.lineWidth),"lightPosition"in n&&(this.lightPosition=n.lightPosition),"opacity"in n&&(this.opacity=n.opacity),"ambient"in n&&(this.ambientLight=n.ambient),"diffuse"in n&&(this.diffuseLight=n.diffuse),"specular"in n&&(this.specularLight=n.specular),"roughness"in n&&(this.roughness=n.roughness),"fresnel"in n&&(this.fresnel=n.fresnel),n.texture?(this.texture.dispose(),this.texture=s(rt,n.texture)):n.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=rt.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=rt.LINEAR,this.texture.setPixels(ft(n.colormap)),this.texture.generateMipmap()),k=n.cells,o=n.positions,o&&k){var wt=[],ct=[],bt=[],kt=[],dt=[],gt=[],lt=[],ni=[],ti=[],ii=[],at=[],ri=[],vt=[],ui=[];this.cells=k;this.positions=o;var ut=n.vertexNormals,st=n.cellNormals,hi=n.vertexNormalsEpsilon===void 0?y:n.vertexNormalsEpsilon,ci=n.faceNormalsEpsilon===void 0?p:n.faceNormalsEpsilon;n.useFacetNormals&&!st&&(st=h.faceNormals(k,o,ci));st||ut||(ut=h.vertexNormals(k,o,hi));var tt=n.vertexColors,it=n.cellColors,yt=n.meshColor||[1,1,1,1],d=n.vertexUVs,l=n.vertexIntensity,g=n.cellUVs,a=n.cellIntensity,f=Infinity,c=-Infinity;if(!d&&!g)if(l)for(t=0;t<l.length;++t)w=l[t],f=Math.min(f,w),c=Math.max(c,w);else if(a)for(t=0;t<a.length;++t)w=a[t],f=Math.min(f,w),c=Math.max(c,w);else for(t=0;t<o.length;++t)w=o[t][2],f=Math.min(f,w),c=Math.max(c,w);for(this.intensity=l?l:a?et(k,o.length,a):ot(o),pt=n.pointSizes,fi=n.pointSize||1,this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]],t=0;t<o.length;++t)for(r=o[t],i=0;i<3;++i)!isNaN(r[i])&&isFinite(r[i])&&(this.bounds[0][i]=Math.min(this.bounds[0][i],r[i]),this.bounds[1][i]=Math.max(this.bounds[1][i],r[i]));var ei=0,oi=0,si=0;n:for(t=0;t<k.length;++t){nt=k[t];switch(nt.length){case 1:for(e=nt[0],r=o[e],i=0;i<3;++i)if(isNaN(r[i])||!isFinite(r[i]))continue n;ii.push(r[0],r[1],r[2]);u=tt?tt[e]:it?it[t]:yt;u.length===3?at.push(u[0],u[1],u[2],1):at.push(u[0],u[1],u[2],u[3]);b=d?d[e]:l?[(l[e]-f)/(c-f),0]:g?g[t]:a?[(a[t]-f)/(c-f),0]:[(r[2]-f)/(c-f),0];ri.push(b[0],b[1]);pt?vt.push(pt[e]):vt.push(fi);ui.push(t);si+=1;break;case 2:for(i=0;i<2;++i)for(e=nt[i],r=o[e],v=0;v<3;++v)if(isNaN(r[v])||!isFinite(r[v]))continue n;for(i=0;i<2;++i)e=nt[i],r=o[e],gt.push(r[0],r[1],r[2]),u=tt?tt[e]:it?it[t]:yt,u.length===3?lt.push(u[0],u[1],u[2],1):lt.push(u[0],u[1],u[2],u[3]),b=d?d[e]:l?[(l[e]-f)/(c-f),0]:g?g[t]:a?[(a[t]-f)/(c-f),0]:[(r[2]-f)/(c-f),0],ni.push(b[0],b[1]),ti.push(t);oi+=1;break;case 3:for(i=0;i<3;++i)for(e=nt[i],r=o[e],v=0;v<3;++v)if(isNaN(r[v])||!isFinite(r[v]))continue n;for(i=0;i<3;++i)e=nt[i],r=o[e],wt.push(r[0],r[1],r[2]),u=tt?tt[e]:it?it[t]:yt,u.length===3?ct.push(u[0],u[1],u[2],1):ct.push(u[0],u[1],u[2],u[3]),b=d?d[e]:l?[(l[e]-f)/(c-f),0]:g?g[t]:a?[(a[t]-f)/(c-f),0]:[(r[2]-f)/(c-f),0],kt.push(b[0],b[1]),ht=ut?ut[e]:st[t],bt.push(ht[0],ht[1],ht[2]),dt.push(t);ei+=1}}this.pointCount=si;this.edgeCount=oi;this.triangleCount=ei;this.pointPositions.update(ii);this.pointColors.update(at);this.pointUVs.update(ri);this.pointSizes.update(vt);this.pointIds.update(new Uint32Array(ui));this.edgePositions.update(gt);this.edgeColors.update(lt);this.edgeUVs.update(ni);this.edgeIds.update(new Uint32Array(ti));this.trianglePositions.update(wt);this.triangleColors.update(ct);this.triangleUVs.update(kt);this.triangleNormals.update(bt);this.triangleIds.update(new Uint32Array(dt))}};r.drawTransparent=r.draw=function(n){var f,i,h,t,l,s,r;n=n||{};var e=this.gl,a=n.model||u,v=n.view||u,y=n.projection||u,o=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(t=0;t<3;++t)o[0][t]=Math.max(o[0][t],this.clipBounds[0][t]),o[1][t]=Math.min(o[1][t],this.clipBounds[1][t]);for(f={model:a,view:v,projection:y,clipBounds:o,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,contourColor:this.contourColor,texture:0},this.texture.bind(0),i=new Array(16),c(i,f.view,f.model),c(i,f.projection,i),w(i,i),t=0;t<3;++t)f.eyePosition[t]=i[12+t]/i[15];for(h=i[15],t=0;t<3;++t)h+=this.lightPosition[t]*i[4*t+3];for(t=0;t<3;++t){for(l=i[12+t],s=0;s<3;++s)l+=i[4*s+t]*this.lightPosition[s];f.lightPosition[t]=l/h}this.triangleCount>0&&(r=this.triShader,r.bind(),r.uniforms=f,this.triangleVAO.bind(),e.drawArrays(e.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind());this.edgeCount>0&&this.lineWidth>0&&(r=this.lineShader,r.bind(),r.uniforms=f,this.edgeVAO.bind(),e.lineWidth(this.lineWidth),e.drawArrays(e.LINES,0,this.edgeCount*2),this.edgeVAO.unbind());this.pointCount>0&&(r=this.pointShader,r.bind(),r.uniforms=f,this.pointVAO.bind(),e.drawArrays(e.POINTS,0,this.pointCount),this.pointVAO.unbind());this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&(r=this.contourShader,r.bind(),r.uniforms=f,this.contourVAO.bind(),e.drawArrays(e.LINES,0,this.contourCount),this.contourVAO.unbind())};r.drawPick=function(n){var i,e,r;n=n||{};var t=this.gl,o=n.model||u,s=n.view||u,h=n.projection||u,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(i=0;i<3;++i)f[0][i]=Math.max(f[0][i],this.clipBounds[0][i]),f[1][i]=Math.min(f[1][i],this.clipBounds[1][i]);this._model=[].slice.call(o);this._view=[].slice.call(s);this._projection=[].slice.call(h);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];e={model:o,view:s,projection:h,clipBounds:f,pickId:this.pickId/255};r=this.pickShader;r.bind();r.uniforms=e;this.triangleCount>0&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind());this.edgeCount>0&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,this.edgeCount*2),this.edgeVAO.unbind());this.pointCount>0&&(r=this.pointPickShader,r.bind(),r.uniforms=e,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind())};r.pick=function(n){var r,o,u,t;if(!n||n.id!==this.pickId)return null;var f=n.value[0]+256*n.value[1]+65536*n.value[2],i=this.cells[f],s=this.positions,e=new Array(i.length);for(t=0;t<i.length;++t)e[t]=s[i[t]];if(r=d(e,[n.coord[0],this._resolution[1]-n.coord[1]],this._model,this._view,this._projection,this._resolution),!r)return null;for(o=r[2],u=0,t=0;t<i.length;++t)u+=o[t]*this.intensity[i[t]];return{position:r[1],index:i[r[0]],cell:i,cellId:f,intensity:u,dataCoordinate:this.positions[i[r[0]]]}};r.dispose=function(){this.texture.dispose();this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose();this.contourShader.dispose()};t.exports=yt},{"./lib/closest-point":164,"./lib/shaders":165,colormap:116,"gl-buffer":134,"gl-mat4/invert":153,"gl-mat4/multiply":155,"gl-shader":277,"gl-texture2d":302,"gl-vao":306,ndarray:525,normals:168,"simplicial-complex-contour":170,"typedarray-pool":550}],167:[function(n,t){"use strict";function i(n){for(var i=0,t=0;t<n.length;++t)i+=n[t];return i}function u(n,t){for(var c,e,s,l,h,a,f=t.length,o=new Array(f+1),u=0;u<f;++u){for(c=new Array(f+1),e=0;e<=f;++e)c[e]=n[e][u];o[u]=c}for(o[f]=new Array(f+1),u=0;u<=f;++u)o[f][u]=1;for(s=new Array(f+1),u=0;u<f;++u)s[u]=t[u];for(s[f]=1,l=r(o,s),h=i(l[f+1]),h===0&&(h=1),a=new Array(f+1),u=0;u<=f;++u)a[u]=i(l[u])/h;return a}t.exports=u;var r=n("robust-linear-solve")},{"robust-linear-solve":528}],168:[function(n,t,i){var r=1e-6,u=1e-6;i.vertexNormals=function(n,t,i){for(var a,d,g,e,y,v,u,p=t.length,c=new Array(p),nt=i===void 0?r:i,f=0;f<p;++f)c[f]=[0,0,0];for(f=0;f<n.length;++f){var o=n[f],tt=0,l=o[o.length-1],w=o[0];for(a=0;a<o.length;++a){tt=l;l=w;w=o[(a+1)%o.length];var rt=t[tt],it=t[l],ut=t[w],s=new Array(3),b=0,h=new Array(3),k=0;for(u=0;u<3;++u)s[u]=rt[u]-it[u],b+=s[u]*s[u],h[u]=ut[u]-it[u],k+=h[u]*h[u];if(b*k>nt)for(e=c[l],v=1/Math.sqrt(b*k),u=0;u<3;++u)d=(u+1)%3,g=(u+2)%3,e[u]+=v*(h[d]*s[g]-h[g]*s[d])}}for(f=0;f<p;++f){for(e=c[f],y=0,u=0;u<3;++u)y+=e[u]*e[u];if(y>nt)for(v=1/Math.sqrt(y),u=0;u<3;++u)e[u]*=v;else for(u=0;u<3;++u)e[u]=0}return c};i.faceNormals=function(n,t,i){for(var p,f,h,c,e,o,l,a,r,v=n.length,y=new Array(v),w=i===void 0?u:i,s=0;s<v;++s){for(p=n[s],f=new Array(3),r=0;r<3;++r)f[r]=t[p[r]];for(h=new Array(3),c=new Array(3),r=0;r<3;++r)h[r]=f[1][r]-f[0][r],c[r]=f[2][r]-f[0][r];for(e=new Array(3),o=0,r=0;r<3;++r)l=(r+1)%3,a=(r+2)%3,e[r]=h[l]*c[a]-h[a]*c[l],o+=e[r]*e[r];for(o=o>w?1/Math.sqrt(o):0,r=0;r<3;++r)e[r]*=o;y[s]=e}return y}},{}],169:[function(n,t){"use strict";function f(n,t,f,e,o){var ut,nt,g,k,d,et,y;for(i.length<e.length&&(i=new Float64Array(e.length),r=new Float64Array(e.length),u=new Float64Array(e.length)),y=0;y<e.length;++y)i[y]=n[y]-e[y],r[y]=t[y]-n[y],u[y]=f[y]-n[y];var w=0,b=0,p=0,l=0,a=0,v=0;for(y=0;y<e.length;++y){var tt=r[y],it=u[y],rt=i[y];w+=tt*tt;b+=tt*it;p+=it*it;l+=rt*tt;a+=rt*it;v+=rt*rt}var ft=Math.abs(w*p-b*b),h=b*a-p*l,s=b*l-w*a,c;for(h+s<=ft?h<0?s<0?l<0?(s=0,-l>=w?(h=1,c=w+2*l+v):(h=-l/w,c=l*h+v)):(h=0,a>=0?(s=0,c=v):-a>=p?(s=1,c=p+2*a+v):(s=-a/p,c=a*s+v)):(h=0,a>=0?(s=0,c=v):-a>=p?(s=1,c=p+2*a+v):(s=-a/p,c=a*s+v)):s<0?(s=0,l>=0?(h=0,c=v):-l>=w?(h=1,c=w+2*l+v):(h=-l/w,c=l*h+v)):(ut=1/ft,h*=ut,s*=ut,c=h*(w*h+b*s+2*l)+s*(b*h+p*s+2*a)+v):h<0?(nt=b+l,g=p+a,g>nt?(k=g-nt,d=w-2*b+p,k>=d?(h=1,s=0,c=w+2*l+v):(h=k/d,s=1-h,c=h*(w*h+b*s+2*l)+s*(b*h+p*s+2*a)+v)):(h=0,g<=0?(s=1,c=p+2*a+v):a>=0?(s=0,c=v):(s=-a/p,c=a*s+v))):s<0?(nt=b+a,g=w+l,g>nt?(k=g-nt,d=w-2*b+p,k>=d?(s=1,h=0,c=p+2*a+v):(s=k/d,h=1-s,c=h*(w*h+b*s+2*l)+s*(b*h+p*s+2*a)+v)):(s=0,g<=0?(h=1,c=w+2*l+v):l>=0?(h=0,c=v):(h=-l/w,c=l*h+v))):(k=p+a-b-l,k<=0?(h=0,s=1,c=p+2*a+v):(d=w-2*b+p,k>=d?(h=1,s=0,c=w+2*l+v):(h=k/d,s=1-h,c=h*(w*h+b*s+2*l)+s*(b*h+p*s+2*a)+v))),et=1-h-s,y=0;y<e.length;++y)o[y]=et*n[y]+h*t[y]+s*f[y];return c<0?0:c}var i=new Float64Array(4),r=new Float64Array(4),u=new Float64Array(4);t.exports=f},{}],170:[function(n,t){"use strict";function e(n){for(var r=n.length,t=0,i=0;i<r;++i)t=Math.max(t,n[i].length)|0;return t-1}function o(n,t){for(var u=n.length,f=i.mallocUint8(u),r=0;r<u;++r)f[r]=n[r]<t|0;return f}function s(n,t){for(var h,t,o,c,a,v,p,l,y=n.length,w=t*(t+1)/2*y|0,f=i.mallocUint32(w*2),s=0,e=0;e<y;++e)for(h=n[e],t=h.length,o=0;o<t;++o)for(c=0;c<o;++c)a=h[c],v=h[o],f[s++]=Math.min(a,v)|0,f[s++]=Math.max(a,v)|0;for(p=s/2|0,u(r(f,[p,2])),l=2,e=2;e<s;e+=2)(f[e-2]!==f[e]||f[e-1]!==f[e+1])&&(f[l++]=f[e],f[l++]=f[e+1]);return r(f,[l/2|0,2])}function h(n,t,u,f){for(var h,c,y,l,o=n.data,a=n.shape[0],v=i.mallocDouble(a),e=0,s=0;s<a;++s)(h=o[2*s],c=o[2*s+1],u[h]!==u[c])&&(y=t[h],l=t[c],o[2*e]=h,o[2*e+1]=c,v[e++]=(l-f)/(l-y));return n.shape[0]=e,r(v,[e])}function c(n,t){var u=i.mallocInt32(t*2),e=n.shape[0],s=n.data,r,f,o;for(u[0]=0,r=0,f=0;f<e;++f)if(o=s[2*f],o!==r){for(u[2*r+1]=f;++r<o;)u[2*r]=f,u[2*r+1]=f;u[2*r]=f}for(u[2*r+1]=e;++r<t;)u[2*r]=u[2*r+1]=e;return u}function l(n){for(var i=n.shape[0]|0,r=n.data,u=new Array(i),t=0;t<i;++t)u[t]=[r[2*t],r[2*t+1]];return u}function a(n,t,r,u){var p;if(r=r||0,typeof u=="undefined"&&(u=e(n)),p=n.length,p===0||u<1)return{cells:[],vertexIds:[],vertexWeights:[]};var v=o(t,+r),a=s(n,u),y=h(a,t,v,+r),w=c(a,t.length|0),b=f(u)(n,a.data,w,v),k=l(a),d=[].slice.call(y.data,0,y.shape[0]);return i.free(v),i.free(a.data),i.free(y.data),i.free(w),{cells:b,vertexIds:k,vertexWeights:d}}t.exports=a;var r=n("ndarray"),i=n("typedarray-pool"),u=n("ndarray-sort"),f=n("./lib/codegen")},{"./lib/codegen":171,ndarray:525,"ndarray-sort":174,"typedarray-pool":550}],171:[function(n,t){"use strict";function f(n){function l(n){var i,u,r,f;if(!(n.length<=0)){for(t.push("R.push("),i=0;i<n.length;++i){for(u=n[i],i>0&&t.push(","),t.push("["),r=0;r<u.length;++r)f=u[r],r>0&&t.push(","),t.push("B(C,E,c[",f[0],"],c[",f[1],"])");t.push("]")}t.push(");")}}var h=0,o=new Array(n+1),t,i,s,e,f,c;for(o[0]=[[]],i=1;i<=n;++i)for(e=o[i]=u(i),f=0;f<e.length;++f)h=Math.max(h,e[i].length);for(t=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",n,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"],i=n+1;i>1;--i){for(i<n+1&&t.push("else "),t.push("if(l===",i,"){"),s=[],f=0;f<i;++f)s.push("(S[c["+f+"]]<<"+f+")");for(t.push("var M=",s.join("+"),";if(M===0||M===",(1<<i)-1,"){continue}switch(M){"),e=o[i-1],f=0;f<e.length;++f)t.push("case ",f,":"),l(e[f]),t.push("break;");t.push("}}")}return t.push("}return R;};return getContour",n,"d"),c=new Function("pool",t.join("")),c(r)}function e(n){var t=i[n];return t||(t=i[n]=f(n)),t}t.exports=e;var r=n("typedarray-pool"),u=n("marching-simplex-table"),i={}},{"marching-simplex-table":172,"typedarray-pool":550}],172:[function(n,t){"use strict";function i(n,t,i){for(var u=new Array(n),r=0;r<n;++r)u[r]=0,r===t&&(u[r]+=.5),r===i&&(u[r]+=.5);return u}function u(n,t){var o,e,h,c,u,s,l,f;if(t===0||t===(1<<n+1)-1)return[];for(o=[],e=[],u=0;u<=n;++u)if(t&1<<u)for(o.push(i(n,u-1,u-1)),e.push(null),f=0;f<=n;++f)~t&1<<f&&(o.push(i(n,u-1,f-1)),e.push([u,f]));h=r(o);c=[];n:for(u=0;u<h.length;++u){for(s=h[u],l=[],f=0;f<s.length;++f){if(!e[s[f]])continue n;l.push(e[s[f]].slice())}c.push(l)}return c}function f(n){for(var i=1<<n+1,r=new Array(i),t=0;t<i;++t)r[t]=u(n,t);return r}t.exports=f;var r=n("convex-hull")},{"convex-hull":118}],173:[function(n,t){"use strict";function f(n){switch(n){case"uint8":return[i.mallocUint8,i.freeUint8];case"uint16":return[i.mallocUint16,i.freeUint16];case"uint32":return[i.mallocUint32,i.freeUint32];case"int8":return[i.mallocInt8,i.freeInt8];case"int16":return[i.mallocInt16,i.freeInt16];case"int32":return[i.mallocInt32,i.freeInt32];case"float32":return[i.mallocFloat,i.freeFloat];case"float64":return[i.mallocDouble,i.freeDouble];default:return null}}function r(n){for(var i=[],t=0;t<n;++t)i.push("s"+t);for(t=0;t<n;++t)i.push("n"+t);for(t=1;t<n;++t)i.push("d"+t);for(t=1;t<n;++t)i.push("e"+t);for(t=1;t<n;++t)i.push("f"+t);return i}function e(n,t){function s(n){return t==="generic"?["data.get(",n,")"].join(""):["data[",n,"]"].join("")}function l(n,i){return t==="generic"?["data.set(",n,",",i,")"].join(""):["data[",n,"]=",i].join("")}var e=["'use strict'"],v=["ndarrayInsertionSort",n.join("d"),t].join(""),y=["left","right","data","offset"].concat(r(n.length)),h=f(t),o=["i,j,cptr,ptr=left*s0+offset"],c,i,u,a;if(n.length>1){for(c=[],i=1;i<n.length;++i)o.push("i"+i),c.push("n"+i);h?o.push("scratch=malloc("+c.join("*")+")"):o.push("scratch=new Array("+c.join("*")+")");o.push("dptr","sptr","a","b")}else o.push("scratch");if(e.push(["function ",v,"(",y.join(","),"){var ",o.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),n.length>1){for(e.push("dptr=0;sptr=ptr"),i=n.length-1;i>=0;--i)(u=n[i],u!==0)&&e.push(["for(i",u,"=0;i",u,"<n",u,";++i",u,"){"].join(""));for(e.push("scratch[dptr++]=",s("sptr")),i=0;i<n.length;++i)(u=n[i],u!==0)&&e.push("sptr+=d"+u,"}");for(e.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0"),i=1;i<n.length;++i)i===1&&e.push("__l:"),e.push(["for(i",i,"=0;i",i,"<n",i,";++i",i,"){"].join(""));for(e.push(["a=",s("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join("")),i=n.length-1;i>=1;--i)e.push("sptr+=e"+i,"dptr+=f"+i,"}");for(e.push("dptr=cptr;sptr=cptr-s0"),i=n.length-1;i>=0;--i)(u=n[i],u!==0)&&e.push(["for(i",u,"=0;i",u,"<n",u,";++i",u,"){"].join(""));for(e.push(l("dptr",s("sptr"))),i=0;i<n.length;++i)(u=n[i],u!==0)&&e.push(["dptr+=d",u,";sptr+=d",u].join(""),"}");for(e.push("cptr-=s0\n}"),e.push("dptr=cptr;sptr=0"),i=n.length-1;i>=0;--i)(u=n[i],u!==0)&&e.push(["for(i",u,"=0;i",u,"<n",u,";++i",u,"){"].join(""));for(e.push(l("dptr","scratch[sptr++]")),i=0;i<n.length;++i)(u=n[i],u!==0)&&e.push("dptr+=d"+u,"}")}else e.push("scratch="+s("ptr"),"while((j-->left)&&("+s("cptr-s0")+">scratch)){",l("cptr",s("cptr-s0")),"cptr-=s0","}",l("cptr","scratch"));return e.push("}"),n.length>1&&h&&e.push("free(scratch)"),e.push("} return "+v),h?(a=new Function("malloc","free",e.join("\n")),a(h[0],h[1])):(a=new Function(e.join("\n")),a())}function o(n,t,i){function s(n){return["(offset+",n,"*s0)"].join("")}function o(n){return t==="generic"?["data.get(",n,")"].join(""):["data[",n,"]"].join("")}function h(n,i){return t==="generic"?["data.set(",n,",",i,")"].join(""):["data[",n,"]=",i].join("")}function y(t,i,r){var u,f;if(t.length===1)e.push("ptr0="+s(t[0]));else for(u=0;u<t.length;++u)e.push(["b_ptr",u,"=s0*",t[u]].join(""));for(i&&e.push("pivot_ptr=0"),e.push("ptr_shift=offset"),u=n.length-1;u>=0;--u)(f=n[u],f!==0)&&e.push(["for(i",f,"=0;i",f,"<n",f,";++i",f,"){"].join(""));if(t.length>1)for(u=0;u<t.length;++u)e.push(["ptr",u,"=b_ptr",u,"+ptr_shift"].join(""));for(e.push(r),i&&e.push("++pivot_ptr"),u=0;u<n.length;++u)(f=n[u],f!==0)&&(t.length>1?e.push("ptr_shift+=d"+f):e.push("ptr0+=d"+f),e.push("}"))}function rt(t,i,r,u){var f;if(i.length===1)e.push("ptr0="+s(i[0]));else{for(f=0;f<i.length;++f)e.push(["b_ptr",f,"=s0*",i[f]].join(""));e.push("ptr_shift=offset")}for(r&&e.push("pivot_ptr=0"),t&&e.push(t+":"),f=1;f<n.length;++f)e.push(["for(i",f,"=0;i",f,"<n",f,";++i",f,"){"].join(""));if(i.length>1)for(f=0;f<i.length;++f)e.push(["ptr",f,"=b_ptr",f,"+ptr_shift"].join(""));for(e.push(u),f=n.length-1;f>=1;--f)r&&e.push("pivot_ptr+=f"+f),i.length>1?e.push("ptr_shift+=e"+f):e.push("ptr0+=e"+f),e.push("}")}function ut(){n.length>1&&p&&e.push("free(pivot1)","free(pivot2)")}function a(t,i){var r="el"+t,u="el"+i,f;n.length>1?(f="__l"+ ++w,rt(f,[r,u],!1,["comp=",o("ptr0"),"-",o("ptr1"),"\n","if(comp>0){tmp0=",r,";",r,"=",u,";",u,"=tmp0;break ",f,"}\n","if(comp<0){break ",f,"}"].join(""))):e.push(["if(",o(s(r)),">",o(s(u)),"){tmp0=",r,";",r,"=",u,";",u,"=tmp0}"].join(""))}function ft(t,i){n.length>1?y([t,i],!1,h("ptr0",o("ptr1"))):e.push(h(s(t),o(s(i))))}function c(t,i,r){if(n.length>1){var u="__l"+ ++w;rt(u,[i],!0,[t,"=",o("ptr0"),"-pivot",r,"[pivot_ptr]\n","if(",t,"!==0){break ",u,"}"].join(""))}else e.push([t,"=",o(s(i)),"-pivot",r].join(""))}function b(t,i){n.length>1?y([t,i],!1,["tmp=",o("ptr0"),"\n",h("ptr0",o("ptr1")),"\n",h("ptr1","tmp")].join("")):e.push(["ptr0=",s(t),"\n","ptr1=",s(i),"\n","tmp=",o("ptr0"),"\n",h("ptr0",o("ptr1")),"\n",h("ptr1","tmp")].join(""))}function nt(t,i,r){n.length>1?(y([t,i,r],!1,["tmp=",o("ptr0"),"\n",h("ptr0",o("ptr1")),"\n",h("ptr1",o("ptr2")),"\n",h("ptr2","tmp")].join("")),e.push("++"+i,"--"+r)):e.push(["ptr0=",s(t),"\n","ptr1=",s(i),"\n","ptr2=",s(r),"\n","++",i,"\n","--",r,"\n","tmp=",o("ptr0"),"\n",h("ptr0",o("ptr1")),"\n",h("ptr1",o("ptr2")),"\n",h("ptr2","tmp")].join(""))}function tt(n,t){b(n,t);e.push("--"+t)}function et(t,i,r){n.length>1?y([t,i],!0,[h("ptr0",o("ptr1")),"\n",h("ptr1",["pivot",r,"[pivot_ptr]"].join(""))].join("")):e.push(h(s(t),o(s(i))),h(s(i),"pivot"+r))}function it(t,i){e.push(["if((",i,"-",t,")<=",u,"){\n","insertionSort(",t,",",i,",data,offset,",r(n.length).join(","),")\n","}else{\n",d,"(",t,",",i,",data,offset,",r(n.length).join(","),")\n","}"].join(""))}function ot(t,i,r){n.length>1?(e.push(["__l",++w,":while(true){"].join("")),y([t],!0,["if(",o("ptr0"),"!==pivot",i,"[pivot_ptr]){break __l",w,"}"].join("")),e.push(r,"}")):e.push(["while(",o(s(t)),"===pivot",i,"){",r,"}"].join(""))}var e=["'use strict'"],d=["ndarrayQuickSort",n.join("d"),t].join(""),st=["left","right","data","offset"].concat(r(n.length)),p=f(t),w=0,v,g,l,k;if(e.push(["function ",d,"(",st.join(","),"){"].join("")),v=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"],n.length>1){for(g=[],l=1;l<n.length;++l)g.push("n"+l),v.push("i"+l);for(l=0;l<8;++l)v.push("b_ptr"+l);v.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+g.join("*"));p?v.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):v.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else v.push("pivot1","pivot2");return(e.push("var "+v.join(",")),a(1,2),a(4,5),a(1,3),a(2,3),a(1,4),a(3,4),a(2,5),a(2,3),a(4,5),n.length>1?y(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",o("ptr1"),"\n","pivot2[pivot_ptr]=",o("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",o("ptr0"),"\n","y=",o("ptr2"),"\n","z=",o("ptr4"),"\n",h("ptr5","x"),"\n",h("ptr6","y"),"\n",h("ptr7","z")].join("")):e.push(["pivot1=",o(s("el2")),"\n","pivot2=",o(s("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",o(s("el1")),"\n","y=",o(s("el3")),"\n","z=",o(s("el5")),"\n",h(s("index1"),"x"),"\n",h(s("index3"),"y"),"\n",h(s("index5"),"z")].join("")),ft("index2","left"),ft("index4","right"),e.push("if(pivots_are_equal){"),e.push("for(k=less;k<=great;++k){"),c("comp","k",1),e.push("if(comp===0){continue}"),e.push("if(comp<0){"),e.push("if(k!==less){"),b("k","less"),e.push("}"),e.push("++less"),e.push("}else{"),e.push("while(true){"),c("comp","great",1),e.push("if(comp>0){"),e.push("great--"),e.push("}else if(comp<0){"),nt("k","less","great"),e.push("break"),e.push("}else{"),tt("k","great"),e.push("break"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),e.push("}else{"),e.push("for(k=less;k<=great;++k){"),c("comp_pivot1","k",1),e.push("if(comp_pivot1<0){"),e.push("if(k!==less){"),b("k","less"),e.push("}"),e.push("++less"),e.push("}else{"),c("comp_pivot2","k",2),e.push("if(comp_pivot2>0){"),e.push("while(true){"),c("comp","great",2),e.push("if(comp>0){"),e.push("if(--great<k){break}"),e.push("continue"),e.push("}else{"),c("comp","great",1),e.push("if(comp<0){"),nt("k","less","great"),e.push("}else{"),tt("k","great"),e.push("}"),e.push("break"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),et("left","(less-1)",1),et("right","(great+1)",2),it("left","(less-2)"),it("(great+2)","right"),e.push("if(pivots_are_equal){"),ut(),e.push("return"),e.push("}"),e.push("if(less<index1&&great>index5){"),ot("less",1,"++less"),ot("great",2,"--great"),e.push("for(k=less;k<=great;++k){"),c("comp_pivot1","k",1),e.push("if(comp_pivot1===0){"),e.push("if(k!==less){"),b("k","less"),e.push("}"),e.push("++less"),e.push("}else{"),c("comp_pivot2","k",2),e.push("if(comp_pivot2===0){"),e.push("while(true){"),c("comp","great",2),e.push("if(comp===0){"),e.push("if(--great<k){break}"),e.push("continue"),e.push("}else{"),c("comp","great",1),e.push("if(comp<0){"),nt("k","less","great"),e.push("}else{"),tt("k","great"),e.push("}"),e.push("break"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),e.push("}"),ut(),it("less","great"),e.push("}return "+d),n.length>1&&p)?(k=new Function("insertionSort","malloc","free",e.join("\n")),k(i,p[0],p[1])):(k=new Function("insertionSort",e.join("\n")),k(i))}function s(n,t){var l=["'use strict'"],w=["ndarraySortWrapper",n.join("d"),t].join(""),s,v,y,a,h,i,c,f,p;for(l.push(["function ",w,"(","array","){"].join("")),s=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],i=0;i<n.length;++i)s.push(["s",i,"=stride[",i,"]|0,n",i,"=shape[",i,"]|0"].join(""));for(v=new Array(n.length),y=[],i=0;i<n.length;++i)(f=n[i],f!==0)&&(v[f]=y.length===0?"1":y.join("*"),y.push("n"+f));for(a=-1,h=-1,i=0;i<n.length;++i)c=n[i],c!==0&&(a>0?s.push(["d",c,"=s",c,"-d",a,"*n",a].join("")):s.push(["d",c,"=s",c].join("")),a=c),f=n.length-1-i,f!==0&&(h>0?s.push(["e",f,"=s",f,"-e",h,"*n",h,",f",f,"=",v[f],"-f",h,"*n",h].join("")):s.push(["e",f,"=s",f,",f",f,"=",v[f]].join("")),h=f);l.push("var "+s.join(","));p=["0","n0-1","data","offset"].concat(r(n.length));l.push(["if(n0<=",u,"){","insertionSort(",p.join(","),")}else{","quickSort(",p.join(","),")}"].join(""));l.push("}return "+w);var k=new Function("insertionSort","quickSort",l.join("\n")),b=e(n,t),d=o(n,t,b);return k(b,d)}var i=n("typedarray-pool"),u=32;t.exports=s},{"typedarray-pool":550}],174:[function(n,t){"use strict";function u(n){var u=n.order,f=n.dtype,o=[u,f],e=o.join(":"),t=i[e];return t||(i[e]=t=r(u,f)),t(n),n}var r=n("./lib/compile_sort.js"),i={};t.exports=u},{"./lib/compile_sort.js":173}],175:[function(n,t){"use strict";function u(n,t,i){this.plot=n;this.vbo=t;this.shader=i}function o(n){var t=n.gl,i=f(t,[0,0,0,1,1,0,1,1]),o=e(t,r.boxVert,r.lineFrag);return new u(n,i,o)}var i;t.exports=o;var f=n("gl-buffer"),e=n("gl-shader"),r=n("./shaders");i=u.prototype;i.bind=function(){var n=this.shader;this.vbo.bind();this.shader.bind();n.attributes.coord.pointer();n.uniforms.screenBox=this.plot.screenBox};i.drawBox=function(){var n=[0,0],t=[0,0];return function(i,r,u,f,e){var h=this.plot,o=this.shader,s=h.gl;n[0]=i;n[1]=r;t[0]=u;t[1]=f;o.uniforms.lo=n;o.uniforms.hi=t;o.uniforms.color=e;s.drawArrays(s.TRIANGLE_STRIP,0,4)}}();i.dispose=function(){this.vbo.dispose();this.shader.dispose()}},{"./shaders":178,"gl-buffer":134,"gl-shader":181}],176:[function(n,t){"use strict";function o(n,t,i,r){this.plot=n;this.vbo=t;this.shader=i;this.tickShader=r;this.ticks=[[],[]]}function f(n,t){return n-t}function h(n){var t=n.gl,i=s(t),r=e(t,u.gridVert,u.gridFrag),f=e(t,u.tickVert,u.gridFrag);return new o(n,i,r,f)}var i;t.exports=h;var s=n("gl-buffer"),e=n("gl-shader"),r=n("binary-search-bounds"),u=n("./shaders");i=o.prototype;i.draw=function(){var t=[0,0],i=[0,0],n=[0,0];return function(){for(var s,o,u=this.plot,y=this.vbo,f=this.shader,p=this.ticks,h=u.gl,c=u._tickBounds,e=u.dataBox,l=u.viewBox,w=u.gridLineWidth,b=u.gridLineColor,k=u.gridLineEnable,d=u.pixelRatio,r=0;r<2;++r){var a=c[r],g=c[r+2],nt=g-a,tt=.5*(e[r+2]+e[r]),v=e[r+2]-e[r];i[r]=2*nt/v;t[r]=2*(a-tt)/v}for(f.bind(),y.bind(),f.attributes.dataCoord.pointer(),f.uniforms.dataShift=t,f.uniforms.dataScale=i,s=0,r=0;r<2;++r)n[0]=n[1]=0,n[r]=1,f.uniforms.dataAxis=n,f.uniforms.lineWidth=w[r]/(l[r+2]-l[r])*d,f.uniforms.color=b[r],o=p[r].length*6,k[r]&&o&&h.drawArrays(h.TRIANGLES,s,o),s+=o}}();i.drawTickMarks=function(){var i=[0,0],u=[0,0],e=[1,0],o=[0,1],n=[0,0],t=[0,0];return function(){for(var s,y=this.plot,vt=this.vbo,ut=this.tickShader,p=this.ticks,w=y.gl,c=y._tickBounds,b=y.dataBox,h=y.viewBox,k=y.pixelRatio,g=y.screenBox,l=g[2]-g[0],a=g[3]-g[1],ft=h[2]-h[0],et=h[3]-h[1],v=0;v<2;++v){var ot=c[v],yt=c[v+2],pt=yt-ot,wt=.5*(b[v+2]+b[v]),st=b[v+2]-b[v];u[v]=2*pt/st;i[v]=2*(ot-wt)/st}u[0]*=ft/l;i[0]*=ft/l;u[1]*=et/a;i[1]*=et/a;ut.bind();vt.bind();ut.attributes.dataCoord.pointer();s=ut.uniforms;s.dataShift=i;s.dataScale=u;var d=y.tickMarkLength,nt=y.tickMarkWidth,tt=y.tickMarkColor,bt=p[0].length*6,ht=Math.min(r.ge(p[0],(b[0]-c[0])/(c[2]-c[0]),f),p[0].length),kt=Math.min(r.gt(p[0],(b[2]-c[0])/(c[2]-c[0]),f),p[0].length),ct=0+6*ht,it=6*Math.max(0,kt-ht),lt=Math.min(r.ge(p[1],(b[1]-c[1])/(c[3]-c[1]),f),p[1].length),dt=Math.min(r.gt(p[1],(b[3]-c[1])/(c[3]-c[1]),f),p[1].length),at=bt+6*lt,rt=6*Math.max(0,dt-lt);n[0]=2*(h[0]-d[1])/l-1;n[1]=(h[3]+h[1])/a-1;t[0]=d[1]*k/l;t[1]=nt[1]*k/a;rt&&(s.color=tt[1],s.tickScale=t,s.dataAxis=o,s.screenOffset=n,w.drawArrays(w.TRIANGLES,at,rt));n[0]=(h[2]+h[0])/l-1;n[1]=2*(h[1]-d[0])/a-1;t[0]=nt[0]*k/l;t[1]=d[0]*k/a;it&&(s.color=tt[0],s.tickScale=t,s.dataAxis=e,s.screenOffset=n,w.drawArrays(w.TRIANGLES,ct,it));n[0]=2*(h[2]+d[3])/l-1;n[1]=(h[3]+h[1])/a-1;t[0]=d[3]*k/l;t[1]=nt[3]*k/a;rt&&(s.color=tt[3],s.tickScale=t,s.dataAxis=o,s.screenOffset=n,w.drawArrays(w.TRIANGLES,at,rt));n[0]=(h[2]+h[0])/l-1;n[1]=2*(h[3]+d[2])/a-1;t[0]=nt[2]*k/l;t[1]=d[2]*k/a;it&&(s.color=tt[2],s.tickScale=t,s.dataAxis=e,s.screenOffset=n,w.drawArrays(w.TRIANGLES,ct,it))}}();i.update=function(){var n=[1,1,-1,-1,1,-1],t=[1,-1,1,1,-1,-1];return function(i){for(var e,h,u,o=i.ticks,c=i.bounds,f=new Float32Array(18*(o[0].length+o[1].length)),w=this.plot.zeroLineEnable,s=0,l=[[],[]],r=0;r<2;++r){var y=l[r],a=o[r],v=c[r],p=c[r+2];for(e=0;e<a.length;++e)for(h=(a[e].x-v)/(p-v),y.push(h),u=0;u<6;++u)f[s++]=h,f[s++]=n[u],f[s++]=t[u]}this.ticks=l;this.vbo.update(f)}}();i.dispose=function(){this.vbo.dispose();this.shader.dispose();this.tickShader.dispose()}},{"./shaders":178,"binary-search-bounds":180,"gl-buffer":134,"gl-shader":181}],177:[function(n,t){"use strict";function u(n,t,i){this.plot=n;this.vbo=t;this.shader=i}function o(n){var t=n.gl,i=f(t,[-1,-1,-1,1,1,-1,1,1]),o=e(t,r.lineVert,r.lineFrag);return new u(n,i,o)}var i;t.exports=o;var f=n("gl-buffer"),e=n("gl-shader"),r=n("./shaders");i=u.prototype;i.bind=function(){var n=this.shader;this.vbo.bind();this.shader.bind();n.attributes.coord.pointer();n.uniforms.screenBox=this.plot.screenBox};i.drawLine=function(){var n=[0,0],t=[0,0];return function(i,r,u,f,e,o){var h=this.plot,s=this.shader,c=h.gl;n[0]=i;n[1]=r;t[0]=u;t[1]=f;s.uniforms.start=n;s.uniforms.end=t;s.uniforms.width=e*h.pixelRatio;s.uniforms.color=o;c.drawArrays(c.TRIANGLE_STRIP,0,4)}}();i.dispose=function(){this.vbo.dispose();this.shader.dispose()}},{"./shaders":178,"gl-buffer":134,"gl-shader":181}],178:[function(n,t){"use strict";var i="precision lowp float;\n#define GLSLIFY 1\r\nuniform vec4 color;\r\nvoid main() {\r\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\r\n}\r\n";t.exports={lineVert:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec2 coord;\r\n\r\nuniform vec4 screenBox;\r\nuniform vec2 start, end;\r\nuniform float width;\r\n\r\nvec2 perp(vec2 v) {\r\n  return vec2(v.y, -v.x);\r\n}\r\n\r\nvec2 screen(vec2 v) {\r\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\r\n}\r\n\r\nvoid main() {\r\n  vec2 delta = normalize(perp(start - end));\r\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\r\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\r\n}\r\n",lineFrag:i,textVert:"#define GLSLIFY 1\nattribute vec3 textCoordinate;\r\n\r\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\r\nuniform float angle;\r\n\r\nvoid main() {\r\n  float dataOffset  = textCoordinate.z;\r\n  vec2 glyphOffset  = textCoordinate.xy;\r\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\r\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\r\n    glyphMatrix * glyphOffset * textScale + screenOffset;\r\n  gl_Position = vec4(screenCoordinate, 0, 1);\r\n}\r\n",textFrag:i,gridVert:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec3 dataCoord;\r\n\r\nuniform vec2 dataAxis, dataShift, dataScale;\r\nuniform float lineWidth;\r\n\r\nvoid main() {\r\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\r\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\r\n  gl_Position = vec4(pos, 0, 1);\r\n}\r\n",gridFrag:i,boxVert:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec2 coord;\r\n\r\nuniform vec4 screenBox;\r\nuniform vec2 lo, hi;\r\n\r\nvec2 screen(vec2 v) {\r\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\r\n}\r\n\r\nvoid main() {\r\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\r\n}\r\n",tickVert:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec3 dataCoord;\r\n\r\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\r\n\r\nvoid main() {\r\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\r\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\r\n}\r\n"}},{}],179:[function(n,t){"use strict";function e(n,t,i){this.plot=n;this.vbo=t;this.shader=i;this.tickOffset=[[],[]];this.tickX=[[],[]];this.labelOffset=[0,0];this.labelCount=[0,0]}function h(n){var t=n.gl,i=o(t),r=s(t,f.textVert,f.textFrag);return new e(n,i,r)}var i;t.exports=h;var o=n("gl-buffer"),s=n("gl-shader"),r=n("text-cache"),u=n("binary-search-bounds"),f=n("./shaders");i=e.prototype;i.drawTicks=function(){var t=[0,0],n=[0,0],i=[0,0];return function(r){var e=this.plot,f=this.shader,w=this.tickX[r],o=this.tickOffset[r],s=e.gl,a=e.viewBox,b=e.dataBox,v=e.screenBox,y=e.pixelRatio,k=e.tickEnable,d=e.tickPad,g=e.tickColor,nt=e.tickAngle,et=e.tickMarkLength,tt=e.labelEnable,it=e.labelPad,rt=e.labelColor,ut=e.labelAngle,ft=this.labelOffset[r],p=this.labelCount[r],h=u.lt(w,b[r]),l=u.le(w,b[r+2]),c;t[0]=t[1]=0;t[r]=1;n[r]=(a[2+r]+a[r])/(v[2+r]-v[r])-1;c=2/v[2+(r^1)]-v[r^1];n[r^1]=c*a[r^1]-1;k[r]&&(n[r^1]-=c*y*d[r],h<l&&o[l]>o[h]&&(f.uniforms.dataAxis=t,f.uniforms.screenOffset=n,f.uniforms.color=g[r],f.uniforms.angle=nt[r],s.drawArrays(s.TRIANGLES,o[h],o[l]-o[h])));tt[r]&&p&&(n[r^1]-=c*y*it[r],f.uniforms.dataAxis=i,f.uniforms.screenOffset=n,f.uniforms.color=rt[r],f.uniforms.angle=ut[r],s.drawArrays(s.TRIANGLES,ft,p));n[r^1]=c*a[2+(r^1)]-1;k[r+2]&&(n[r^1]+=c*y*d[r+2],h<l&&o[l]>o[h]&&(f.uniforms.dataAxis=t,f.uniforms.screenOffset=n,f.uniforms.color=g[r+2],f.uniforms.angle=nt[r+2],s.drawArrays(s.TRIANGLES,o[h],o[l]-o[h])));tt[r+2]&&p&&(n[r^1]+=c*y*it[r+2],f.uniforms.dataAxis=i,f.uniforms.screenOffset=n,f.uniforms.color=rt[r+2],f.uniforms.angle=ut[r+2],s.drawArrays(s.TRIANGLES,ft,p))}}();i.drawTitle=function(){var t=[0,0],n=[0,0];return function(){var r=this.plot,u=this.shader,e=r.gl,f=r.screenBox,o=r.titleCenter,s=r.titleAngle,h=r.titleColor,o=r.titleCenter,c=r.pixelRatio,i;if(this.titleCount){for(i=0;i<2;++i)n[i]=2*(o[i]*c-f[i])/(f[2+i]-f[i])-1;u.bind();u.uniforms.dataAxis=t;u.uniforms.screenOffset=n;u.uniforms.angle=s;u.uniforms.color=h;e.drawArrays(e.TRIANGLES,this.titleOffset,this.titleCount)}}}();i.bind=function(){var t=[0,0],i=[0,0],n=[0,0];return function(){var f=this.plot,e=this.shader,s=f._tickBounds,o=f.dataBox,u=f.screenBox,h=f.viewBox,r;for(e.bind(),r=0;r<2;++r){var c=s[r],y=s[r+2],p=y-c,w=.5*(o[r+2]+o[r]),l=o[r+2]-o[r],b=h[r],k=h[r+2],a=k-b,d=u[r],g=u[r+2],v=g-d;i[r]=2*p/l*a/v;t[r]=2*(c-w)/l*a/v}n[1]=2*f.pixelRatio/(u[3]-u[1]);n[0]=n[1]*(u[3]-u[1])/(u[2]-u[0]);e.uniforms.dataScale=i;e.uniforms.dataShift=t;e.uniforms.textScale=n;this.vbo.bind();e.attributes.textCoordinate.pointer()}}();i.update=function(n){for(var o,u,e,i,f=[],y=n.ticks,h=n.bounds,t=0;t<2;++t){var c=[Math.floor(f.length/3)],l=[-Infinity],a=y[t];for(i=0;i<a.length;++i){var s=a[i],v=s.x,p=s.text,w=s.font||"sans-serif",e=s.fontSize||12,u=r(w,p).data,b=1/(h[t+2]-h[t]),k=h[t];for(o=0;o<u.length;o+=2)f.push(u[o]*e,-u[o+1]*e,(v-k)*b);c.push(Math.floor(f.length/3));l.push(v)}this.tickOffset[t]=c;this.tickX[t]=l}for(t=0;t<2;++t){for(this.labelOffset[t]=Math.floor(f.length/3),u=r(n.labelFont[t],n.labels[t]).data,e=n.labelSize[t],i=0;i<u.length;i+=2)f.push(u[i]*e,-u[i+1]*e,0);this.labelCount[t]=Math.floor(f.length/3)-this.labelOffset[t]}for(this.titleOffset=Math.floor(f.length/3),u=r(n.titleFont,n.title).data,e=n.titleSize,i=0;i<u.length;i+=2)f.push(u[i]*e,-u[i+1]*e,0);this.titleCount=Math.floor(f.length/3)-this.titleOffset;this.vbo.update(f)};i.dispose=function(){this.vbo.dispose();this.shader.dispose()}},{"./shaders":178,"binary-search-bounds":180,"gl-buffer":134,"gl-shader":181,"text-cache":545}],180:[function(n,t,i){arguments[4][78][0].apply(i,arguments)},{dup:78}],181:[function(n,t){"use strict";function e(n){this.gl=n;this.gl.lastAttribCount=0;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function c(n,t){return n.name<t.name?-1:1}function l(n,t,i,r,u){var f=new e(n);return f.update(t,i,r,u),f}var o=n("./lib/create-uniforms"),s=n("./lib/create-attributes"),u=n("./lib/reflect"),i=n("./lib/shader-cache"),f=n("./lib/runtime-reflect"),h=n("./lib/GLError"),r=e.prototype;r.bind=function(){this.program||this._relink();var n,t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),i=this.gl.lastAttribCount;if(t>i)for(n=i;n<t;n++)this.gl.enableVertexAttribArray(n);else if(i>t)for(n=t;n<i;n++)this.gl.disableVertexAttribArray(n);this.gl.lastAttribCount=t;this.gl.useProgram(this.program)};r.dispose=function(){for(var t=this.gl.lastAttribCount,n=0;n<t;n++)this.gl.disableVertexAttribArray(n);this.gl.lastAttribCount=0;this._fref&&this._fref.dispose();this._vref&&this._vref.dispose();this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};r.update=function(n,t,r,e){function ot(){l.program=i.program(a,l._vref,l._fref,rt,y);for(var n=0;n<r.length;++n)ft[n]=a.getUniformLocation(l.program,r[n].name)}var k,nt,p,tt,v,d,ut,b,g,ft;t&&arguments.length!==1||(k=n,n=k.vertex,t=k.fragment,r=k.uniforms,e=k.attributes);var l=this,a=l.gl,et=l._vref;if(l._vref=i.shader(a,a.VERTEX_SHADER,n),et&&et.dispose(),l.vertShader=l._vref.shader,nt=this._fref,l._fref=i.shader(a,a.FRAGMENT_SHADER,t),nt&&nt.dispose(),l.fragShader=l._fref.shader,!r||!e){if(p=a.createProgram(),a.attachShader(p,l.fragShader),a.attachShader(p,l.vertShader),a.linkProgram(p),!a.getProgramParameter(p,a.LINK_STATUS)){tt=a.getProgramInfoLog(p);throw new h(tt,"Error linking program:"+tt);}r=r||f.uniforms(a,p);e=e||f.attributes(a,p);a.deleteProgram(p)}e=e.slice();e.sort(c);for(var it=[],rt=[],y=[],w=0;w<e.length;++w)if(v=e[w],v.type.indexOf("mat")>=0){for(d=v.type.charAt(v.type.length-1)|0,ut=new Array(d),b=0;b<d;++b)ut[b]=y.length,rt.push(v.name+"["+b+"]"),typeof v.location=="number"?y.push(v.location+b):Array.isArray(v.location)&&v.location.length===d&&typeof v.location[b]=="number"?y.push(v.location[b]|0):y.push(-1);it.push({name:v.name,type:v.type,locations:ut})}else it.push({name:v.name,type:v.type,locations:[y.length]}),rt.push(v.name),typeof v.location=="number"?y.push(v.location|0):y.push(-1);for(g=0,w=0;w<y.length;++w)if(y[w]<0){while(y.indexOf(g)>=0)g+=1;y[w]=g}ft=new Array(r.length);ot();l._relink=ot;l.types={uniforms:u(r),attributes:u(e)};l.attributes=s(a,l,it,y);Object.defineProperty(l,"uniforms",o(a,l,r,ft))};t.exports=l},{"./lib/GLError":182,"./lib/create-attributes":183,"./lib/create-uniforms":184,"./lib/reflect":185,"./lib/runtime-reflect":186,"./lib/shader-cache":187}],182:[function(n,t){function i(n,t,i){this.shortMessage=t||"";this.longMessage=i||"";this.rawError=n||"";this.message="gl-shader: "+(t||n||"")+(i?"\n"+i:"");this.stack=(new Error).stack}i.prototype=new Error;i.prototype.name="GLError";i.prototype.constructor=i;t.exports=i},{}],183:[function(n,t){"use strict";function f(n,t,i,r,u,f){this._gl=n;this._wrapper=t;this._index=i;this._locations=r;this._dimension=u;this._constFunc=f}function u(n,t,i,r,u,e,o){for(var c,a,h=["gl","v"],l=[],s=0;s<u;++s)h.push("x"+s),l.push("x"+s);h.push("if(x0.length===void 0){return gl.vertexAttrib"+u+"f(v,"+l.join()+")}else{return gl.vertexAttrib"+u+"fv(v,x0)}");c=Function.apply(null,h);a=new f(n,t,i,r,u,c);Object.defineProperty(e,o,{set:function(t){return n.disableVertexAttribArray(r[i]),c(n,r[i],t),t},get:function(){return a},enumerable:!0})}function e(n,t,i,r,f,e,o){for(var l,a,h=new Array(f),c=new Array(f),s=0;s<f;++s)u(n,t,i[s],r,f,h,s),c[s]=h[s];Object.defineProperty(h,"location",{set:function(n){var t;if(Array.isArray(n))for(t=0;t<f;++t)c[t].location=n[t];else for(t=0;t<f;++t)c[t].location=n+t;return n},get:function(){for(var t=new Array(f),n=0;n<f;++n)t[n]=r[i[n]];return t},enumerable:!0});h.pointer=function(t,u,e,o){var s,h;for(t=t||n.FLOAT,u=!!u,e=e||f*f,o=o||0,s=0;s<f;++s)h=r[i[s]],n.vertexAttribPointer(h,f,t,u,e,o+s*f),n.enableVertexAttribArray(h)};l=new Array(f);a=n["vertexAttrib"+f+"fv"];Object.defineProperty(e,o,{set:function(t){for(var o,e,u=0;u<f;++u)if(o=r[i[u]],n.disableVertexAttribArray(o),Array.isArray(t[0]))a.call(n,o,t[u]);else{for(e=0;e<f;++e)l[e]=t[f*u+e];a.call(n,o,l)}return t},get:function(){return h},enumerable:!0})}function o(n,t,r,f){for(var s,c={},l=0,y=r.length;l<y;++l){var a=r[l],h=a.name,o=a.type,v=a.locations;switch(o){case"bool":case"int":case"float":u(n,t,v[0],f,1,c,h);break;default:if(o.indexOf("vec")>=0){if(s=o.charCodeAt(o.length-1)-48,s<2||s>4)throw new i("","Invalid data type for attribute "+h+": "+o);u(n,t,v[0],f,s,c,h)}else if(o.indexOf("mat")>=0){if(s=o.charCodeAt(o.length-1)-48,s<2||s>4)throw new i("","Invalid data type for attribute "+h+": "+o);e(n,t,v,f,s,c,h)}else throw new i("","Unknown data type for attribute "+h+": "+o);}}return c}var i,r;t.exports=o;i=n("./GLError");r=f.prototype;r.pointer=function(n,t,i,r){var u=this,f=u._gl,e=u._locations[u._index];f.vertexAttribPointer(e,u._dimension,n||f.FLOAT,!!t,i||0,r||0);f.enableVertexAttribArray(e)};r.set=function(n,t,i,r){return this._constFunc(this._locations[this._index],n,t,i,r)};Object.defineProperty(r,"location",{get:function(){return this._locations[this._index]},set:function(n){return n!==this._locations[this._index]&&(this._locations[this._index]=n|0,this._wrapper.program=null),n|0}})},{"./GLError":182}],184:[function(n,t){"use strict";function u(n){var t=new Function("y","return function(){return y}");return t(n)}function r(n,t){for(var r=new Array(n),i=0;i<n;++i)r[i]=t;return r}function e(n,t,e,o){function v(i){var r=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+i+"])}");return r(n,t,o)}function y(n,t,r){var f,u;switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+n+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+n+")";default:if(f=r.indexOf("vec"),0<=f&&f<=1&&r.length===4+f){if(u=r.charCodeAt(r.length-1)-48,u<2||u>4)throw new i("","Invalid data type");switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+u+"iv(locations["+t+"],obj"+n+")";case"v":return"gl.uniform"+u+"fv(locations["+t+"],obj"+n+")";default:throw new i("","Unrecognized data type for vector "+name+": "+r);}}else{if(r.indexOf("mat")===0&&r.length===4){if(u=r.charCodeAt(r.length-1)-48,u<2||u>4)throw new i("","Invalid uniform dimension type for matrix "+name+": "+r);return"gl.uniformMatrix"+u+"fv(locations["+t+"],false,obj"+n+")"}throw new i("","Unknown uniform data type for "+name+": "+r);}}}function h(n,t){var r,i,u,f;if(typeof t!="object")return[[n,t]];r=[];for(i in t)u=t[i],f=n,f+=parseInt(i)+""===i?"["+i+"]":"."+i,typeof u=="object"?r.push.apply(r,h(f,u)):r.push([f,u]);return r}function s(t){for(var c,i=["return function updateProperty(obj){"],f=h("",t),r=0;r<f.length;++r){var s=f[r],l=s[0],u=s[1];o[u]&&i.push(y(l,u,e[u].type))}return i.push("return obj}"),c=new Function("gl","locations",i.join("\n")),c(n,o)}function p(n){var u,t;switch(n){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:if(u=n.indexOf("vec"),0<=u&&u<=1&&n.length===4+u){if(t=n.charCodeAt(n.length-1)-48,t<2||t>4)throw new i("","Invalid data type");return n.charAt(0)==="b"?r(t,!1):r(t,0)}if(n.indexOf("mat")===0&&n.length===4){if(t=n.charCodeAt(n.length-1)-48,t<2||t>4)throw new i("","Invalid uniform dimension type for matrix "+name+": "+n);return r(t*t,0)}throw new i("","Unknown uniform data type for "+name+": "+n);}}function c(n,t,i){if(typeof i=="object"){var r=l(i);Object.defineProperty(n,t,{get:u(r),set:s(i),enumerable:!0,configurable:!1})}else o[i]?Object.defineProperty(n,t,{get:v(i),set:s(i),enumerable:!0,configurable:!1}):n[t]=p(e[i].type)}function l(n){var t,i,r;if(Array.isArray(n))for(t=new Array(n.length),i=0;i<n.length;++i)c(t,i,n[i]);else{t={};for(r in n)c(t,r,n[r])}return t}var a=f(e,!0);return{get:u(l(a)),set:s(a),enumerable:!0,configurable:!0}}var f=n("./reflect"),i=n("./GLError");t.exports=e},{"./GLError":182,"./reflect":185}],185:[function(n,t){"use strict";function i(n,t){for(var f,r,e,o,h={},u=0;u<n.length;++u){var c=n[u].name,s=c.split("."),i=h;for(f=0;f<s.length;++f)if(r=s[f].split("["),r.length>1)for((r[0]in i)||(i[r[0]]=[]),i=i[r[0]],e=1;e<r.length;++e)o=parseInt(r[e]),e<r.length-1||f<s.length-1?(o in i||(i[o]=e<r.length-1?[]:{}),i=i[o]):i[o]=t?u:n[u].type;else f<s.length-1?(r[0]in i||(i[r[0]]={}),i=i[r[0]]):i[r[0]]=t?u:n[u].type}return h}t.exports=i},{}],186:[function(n,t,i){"use strict";function f(n,t){var f,i,e;if(!r)for(f=Object.keys(u),r={},i=0;i<f.length;++i)e=f[i],r[n[e]]=u[e];return r[t]}function e(n,t){for(var i,o,r,s=n.getProgramParameter(t,n.ACTIVE_UNIFORMS),u=[],e=0;e<s;++e)if(i=n.getActiveUniform(t,e),i)if(o=f(n,i.type),i.size>1)for(r=0;r<i.size;++r)u.push({name:i.name.replace("[0]","["+r+"]"),type:o});else u.push({name:i.name,type:o});return u}function o(n,t){for(var i,e=n.getProgramParameter(t,n.ACTIVE_ATTRIBUTES),u=[],r=0;r<e;++r)i=n.getActiveAttrib(t,r),i&&u.push({name:i.name,type:f(n,i.type)});return u}i.uniforms=e;i.attributes=o;var u={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},r=null},{}],187:[function(n,t,i){"use strict";function e(n,t,i,r,u,f,e){this.id=n;this.src=t;this.type=i;this.shader=r;this.count=f;this.programs=[];this.cache=e}function o(n){this.gl=n;this.shaders=[{},{}];this.programs={}}function a(n,t,i){var u=n.createShader(t),f,e;if(n.shaderSource(u,i),n.compileShader(u),!n.getShaderParameter(u,n.COMPILE_STATUS)){f=n.getShaderInfoLog(u);try{e=h(f,i,t)}catch(o){console.warn("Failed to format compiler error: "+o);throw new r(f,"Error compiling shader:\n"+f);}throw new r(f,e.short,e.long);}return u}function v(n,t,i,u,f){var e=n.createProgram(),o,s;for(n.attachShader(e,t),n.attachShader(e,i),o=0;o<u.length;++o)n.bindAttribLocation(e,f[o],u[o]);if(n.linkProgram(e),!n.getProgramParameter(e,n.LINK_STATUS)){s=n.getProgramInfoLog(e);throw new r(s,"Error linking program: "+s);}return e}function s(n){var t=f.get(n);return t||(t=new o(n),f.set(n,t)),t}function y(n,t,i){return s(n).getShaderReference(t,i)}function p(n,t,i,r,u){return s(n).getProgram(t,i,r,u)}var u;i.shader=y;i.program=p;var r=n("./GLError"),h=n("gl-format-compiler-error"),c=typeof WeakMap=="undefined"?n("weakmap-shim"):WeakMap,f=new c,l=0;e.prototype.dispose=function(){var n,f,r;if(--this.count==0){var t=this.cache,i=t.gl,u=this.programs;for(n=0,f=u.length;n<f;++n)r=t.programs[u[n]],r&&(delete t.programs[n],i.deleteProgram(r));i.deleteShader(this.shader);delete t.shaders[this.type===i.FRAGMENT_SHADER|0][this.src]}};u=o.prototype;u.getShaderReference=function(n,t){var r=this.gl,u=this.shaders[n===r.FRAGMENT_SHADER|0],i=u[t],f;return i&&r.isShader(i.shader)?i.count+=1:(f=a(r,n,t),i=u[t]=new e(l++,t,n,f,[],1,this)),i};u.getProgram=function(n,t,i,r){var u=[n.id,t.id,i.join(":"),r.join(":")].join("@"),f=this.programs[u];return f&&this.gl.isProgram(f)||(this.programs[u]=f=v(this.gl,n.shader,t.shader,i,r),n.programs.push(u),t.programs.push(u)),f}},{"./GLError":182,"gl-format-compiler-error":188,"weakmap-shim":198}],188:[function(n,t){function e(n,t,e){"use strict";var b=u(t)||"of unknown name (see npm glsl-shader-name)",y="unknown type",h,a,v,o,w,c;e!==undefined&&(y=e===r.FRAGMENT_SHADER?"fragment":"vertex");var l=i("Error compiling %s shader %s:\n",y,b),k=i("%s%s",l,n),p=n.split("\n"),s={};for(o=0;o<p.length;o++)if(h=p[o],h!==""){if(a=parseInt(h.split(":")[2]),isNaN(a))throw new Error(i("Could not parse error: %s",h));s[a]=h}for(v=f(t).split("\n"),o=0;o<v.length;o++)(s[o+3]||s[o+2]||s[o+1])&&(w=v[o],l+=w+"\n",s[o+1]&&(c=s[o+1],c=c.substr(c.split(":",3).join(":").length+1).trim(),l+=i("^^^ %s\n\n",c)));return{long:l.trim(),short:k.trim()}}var i=n("sprintf-js").sprintf,r=n("gl-constants/lookup"),u=n("glsl-shader-name"),f=n("add-line-numbers");t.exports=e},{"add-line-numbers":189,"gl-constants/lookup":192,"glsl-shader-name":193,"sprintf-js":195}],189:[function(n,t){function r(n,t,r){t=typeof t=="number"?t:1;r=r||": ";var u=n.split(/\r?\n/),f=String(u.length+t-1).length;return u.map(function(n,u){var e=u+t,o=String(e).length,s=i(e,f-o);return s+r+n}).join("\n")}var i=n("pad-left");t.exports=r},{"pad-left":190}],190:[function(n,t){
/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */
"use strict";var i=n("repeat-string");t.exports=function(n,t,r){return r=typeof r!="undefined"?r+"":" ",i(r,t)+n}},{"repeat-string":526}],191:[function(n,t){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],192:[function(n,t){var i=n("./1.0/numbers");t.exports=function(n){return i[n]}},{"./1.0/numbers":191}],193:[function(n,t){function u(n){for(var f,t,s,e,o=Array.isArray(n)?n:i(n),u=0;u<o.length;u++)if((f=o[u],f.type==="preprocessor")&&(t=f.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/),t)&&t[2])return s=t[1],e=t[2],(s?r(e):e).trim()}var i=n("glsl-tokenizer"),r=n("atob-lite");t.exports=u},{"atob-lite":194,"glsl-tokenizer":314}],194:[function(n,t){t.exports=function(n){return atob(n)}},{}],195:[function(t,i,r){(function(t){function u(){var n=arguments[0],t=u.cache;return t[n]&&t.hasOwnProperty(n)||(t[n]=u.parse(n)),u.format.call(null,t[n],arguments)}function e(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}function o(n,t){return Array(t+1).join(n)}var i={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/},f;u.format=function(n,t){for(var b=1,k=n.length,v="",r,s=[],c,f,a,y,p,w=!0,l="",h=0;h<k;h++)if(v=e(n[h]),v==="string")s[s.length]=n[h];else if(v==="array"){if(f=n[h],f[2])for(r=t[b],c=0;c<f[2].length;c++){if(!r.hasOwnProperty(f[2][c]))throw new Error(u("[sprintf] property '%s' does not exist",f[2][c]));r=r[f[2][c]]}else r=f[1]?t[f[1]]:t[b++];if(e(r)=="function"&&(r=r()),i.not_string.test(f[8])&&i.not_json.test(f[8])&&e(r)!="number"&&isNaN(r))throw new TypeError(u("[sprintf] expecting number but found %s",e(r)));i.number.test(f[8])&&(w=r>=0);switch(f[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,f[6]?parseInt(f[6]):0);break;case"e":r=f[7]?r.toExponential(f[7]):r.toExponential();break;case"f":r=f[7]?parseFloat(r).toFixed(f[7]):parseFloat(r);break;case"g":r=f[7]?parseFloat(r).toPrecision(f[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&f[7]?r.substring(0,f[7]):r;break;case"u":r=r>>>0;break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}i.json.test(f[8])?s[s.length]=r:(i.number.test(f[8])&&(!w||f[3])?(l=w?"+":"-",r=r.toString().replace(i.sign,"")):l="",y=f[4]?f[4]==="0"?"0":f[4].charAt(1):" ",p=f[6]-(l+r).length,a=f[6]?p>0?o(y,p):"":"",s[s.length]=f[5]?l+r+a:y==="0"?l+a+r:a+l+r)}return s.join("")};u.cache={};u.parse=function(n){for(var e=n,t=[],r=[],s=0;e;){if((t=i.text.exec(e))!==null)r[r.length]=t[0];else if((t=i.modulo.exec(e))!==null)r[r.length]="%";else if((t=i.placeholder.exec(e))!==null){if(t[2]){s|=1;var u=[],o=t[2],f=[];if((f=i.key.exec(o))!==null)for(u[u.length]=f[1];(o=o.substring(f[0].length))!=="";)if((f=i.key_access.exec(o))!==null)u[u.length]=f[1];else if((f=i.index_access.exec(o))!==null)u[u.length]=f[1];else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");t[2]=u}else s|=2;if(s===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r[r.length]=t}else throw new SyntaxError("[sprintf] unexpected placeholder");e=e.substring(t[0].length)}return r};f=function(n,t,i){return i=(t||[]).slice(0),i.splice(0,0,n),u.apply(null,i)};typeof r!="undefined"?(r.sprintf=u,r.vsprintf=f):(t.sprintf=u,t.vsprintf=f,typeof n=="function"&&n.amd&&n(function(){return{sprintf:u,vsprintf:f}}))})(typeof window=="undefined"?this:window)},{}],196:[function(n,t){function r(){var n={};return function(t){if((typeof t!="object"||t===null)&&typeof t!="function")throw new Error("Weakmap-shim: Key must be object");var r=t.valueOf(n);return r&&r.identity===n?r:i(t,n)}}var i=n("./hidden-store.js");t.exports=r},{"./hidden-store.js":197}],197:[function(n,t){function i(n,t){var i={identity:t},r=n.valueOf;return Object.defineProperty(n,"valueOf",{value:function(n){return n!==t?r.apply(this,arguments):i},writable:!0}),i}t.exports=i},{}],198:[function(n,t){function r(){var n=i();return{get:function(t,i){var r=n(t);return r.hasOwnProperty("value")?r.value:i},set:function(t,i){n(t).value=i},has:function(t){return"value"in n(t)},"delete":function(t){return delete n(t).value}}}var i=n("./create-store.js");t.exports=r},{"./create-store.js":196}],199:[function(n,t){"use strict";function u(n,t){this.gl=n;this.pickBuffer=t;this.screenBox=[0,0,n.drawingBufferWidth,n.drawingBufferHeight];this.viewBox=[0,0,0,0];this.dataBox=[-10,-10,10,10];this.gridLineEnable=[!0,!0];this.gridLineWidth=[1,1];this.gridLineColor=[[0,0,0,1],[0,0,0,1]];this.pixelRatio=1;this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickEnable=[!0,!0,!0,!0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[15,15,15,15];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelEnable=[!0,!0,!0,!0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.titleCenter=[0,0];this.titleEnable=!0;this.titleAngle=0;this.titleColor=[0,0,0,1];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.zeroLineEnable=[!0,!0];this.zeroLineWidth=[4,4];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderLineEnable=[!0,!0,!0,!0];this.borderLineWidth=[2,2,2,2];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.grid=null;this.text=null;this.line=null;this.box=null;this.objects=[];this.overlays=[];this._tickBounds=[Infinity,Infinity,-Infinity,-Infinity];this.static=!1;this.dirty=!1;this.pickDirty=!1;this.pickDelay=120;this.pickRadius=10;this._pickTimeout=null;this._drawPick=this.drawPick.bind(this);this._depthCounter=0}function r(n){for(var t=n.slice(),i=0;i<t.length;++i)t[i]=t[i].slice();return t}function c(n,t){return n.x-t.x}function l(n){var i=n.gl,r=f(i,[i.drawingBufferWidth,i.drawingBufferHeight]),t=new u(i,r);return t.grid=e(t),t.text=o(t),t.line=s(t),t.box=h(t),t.update(n),t}var i;t.exports=l;var f=n("gl-select-static"),e=n("./lib/grid"),o=n("./lib/text"),s=n("./lib/line"),h=n("./lib/box");i=u.prototype;i.setDirty=function(){this.dirty=this.pickDirty=!0};i.setOverlayDirty=function(){this.dirty=!0};i.nextDepthValue=function(){return this._depthCounter++/65536};i.draw=function(){return function(){var n=this.gl,r=this.screenBox,i=this.viewBox,h=this.dataBox,f=this.pixelRatio,d=this.grid,e=this.line,v=this.text,w=this.objects,o,s,c,p,t;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){this.dirty=!1;n.bindFramebuffer(n.FRAMEBUFFER,null);n.enable(n.SCISSOR_TEST);n.disable(n.DEPTH_TEST);n.depthFunc(n.LESS);n.depthMask(!1);n.enable(n.BLEND);n.blendEquation(n.FUNC_ADD,n.FUNC_ADD);n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA);n.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);o=this.borderColor;n.clearColor(o[0]*o[3],o[1]*o[3],o[2]*o[3],o[3]);n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);n.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]);n.viewport(i[0],i[1],i[2]-i[0],i[3]-i[1]);s=this.backgroundColor;n.clearColor(s[0]*s[3],s[1]*s[3],s[2]*s[3],s[3]);n.clear(n.COLOR_BUFFER_BIT);d.draw();var y=this.zeroLineEnable,b=this.zeroLineColor,k=this.zeroLineWidth;if(y[0]||y[1])for(e.bind(),t=0;t<2;++t)y[t]&&h[t]<=0&&h[t+2]>=0&&(c=r[t]-h[t]*(r[t+2]-r[t])/(h[t+2]-h[t]),t===0?e.drawLine(c,r[1],c,r[3],k[t],b[t]):e.drawLine(r[0],c,r[2],c,k[t],b[t]));for(t=0;t<w.length;++t)w[t].draw();n.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]);n.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);this.grid.drawTickMarks();e.bind();var l=this.borderLineEnable,u=this.borderLineWidth,a=this.borderLineColor;for(l[1]&&e.drawLine(i[0],i[1]-.5*u[1]*f,i[0],i[3]+.5*u[3]*f,u[1],a[1]),l[0]&&e.drawLine(i[0]-.5*u[0]*f,i[1],i[2]+.5*u[2]*f,i[1],u[0],a[0]),l[3]&&e.drawLine(i[2],i[1]-.5*u[1]*f,i[2],i[3]+.5*u[3]*f,u[3],a[3]),l[2]&&e.drawLine(i[0]-.5*u[0]*f,i[3],i[2]+.5*u[2]*f,i[3],u[2],a[2]),v.bind(),t=0;t<2;++t)v.drawTicks(t);for(this.titleEnable&&v.drawTitle(),p=this.overlays,t=0;t<p.length;++t)p[t].draw();n.disable(n.SCISSOR_TEST);n.disable(n.BLEND);n.depthMask(!0)}}}();i.drawPick=function(){return function(){var t,u,i,r,n;if(!this.static){for(t=this.pickBuffer,u=this.gl,this._pickTimeout=null,t.begin(),i=1,r=this.objects,n=0;n<r.length;++n)i=r[n].drawPick(i);t.end()}}}();i.pick=function(){return function(n,t){var l,u,r,f;if(!this.static){var e=this.pixelRatio,o=this.pickPixelRatio,s=this.viewBox,h=Math.round((n-s[0]/e)*o)|0,c=Math.round((t-s[1]/e)*o)|0,i=this.pickBuffer.query(h,c,this.pickRadius);if(!i)return null;for(l=i.id+(i.value[0]<<8)+(i.value[1]<<16)+(i.value[2]<<24),u=this.objects,r=0;r<u.length;++r)if(f=u[r].pick(h,c,l),f)return f;return null}}}();i.setScreenBox=function(n){var t=this.screenBox,i=this.pixelRatio;t[0]=Math.round(n[0]*i)|0;t[1]=Math.round(n[1]*i)|0;t[2]=Math.round(n[2]*i)|0;t[3]=Math.round(n[3]*i)|0;this.setDirty()};i.setDataBox=function(n){var t=this.dataBox,i=t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3];i&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],this.setDirty())};i.setViewBox=function(n){var t=this.pixelRatio,i=this.viewBox,r;i[0]=Math.round(n[0]*t)|0;i[1]=Math.round(n[1]*t)|0;i[2]=Math.round(n[2]*t)|0;i[3]=Math.round(n[3]*t)|0;r=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((n[2]-n[0])*r)|0,Math.round((n[3]-n[1])*r)|0];this.setDirty()};i.update=function(n){var s,i,l,u,h,o,t,f,e;for(n=n||{},s=this.gl,this.pixelRatio=n.pixelRatio||1,i=this.pixelRatio,this.pickPixelRatio=Math.max(i,1),this.setScreenBox(n.screenBox||[0,0,s.drawingBufferWidth/i,s.drawingBufferHeight/i]),l=this.screenBox,this.setViewBox(n.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/i,.125*(this.screenBox[3]-this.screenBox[1])/i,.875*(this.screenBox[2]-this.screenBox[0])/i,.875*(this.screenBox[3]-this.screenBox[1])/i]),u=this.viewBox,h=(u[2]-u[0])/(u[3]-u[1]),this.setDataBox(n.dataBox||[-10,-10/h,10,10/h]),this.borderColor=(n.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(n.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(n.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(n.gridLineWidth||[1,1]).slice(),this.gridLineColor=r(n.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(n.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(n.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=r(n.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(n.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(n.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=r(n.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(n.titleCenter||[.5*(u[0]+u[2])/i,(u[3]+120)/i]).slice(),this.titleEnable=!("titleEnable"in n)||!!n.titleEnable,this.titleAngle=n.titleAngle||0,this.titleColor=(n.titleColor||[0,0,0,1]).slice(),this.labelPad=(n.labelPad||[15,15,15,15]).slice(),this.labelAngle=(n.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(n.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=r(n.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(n.tickPad||[15,15,15,15]).slice(),this.tickAngle=(n.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(n.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=r(n.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(n.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(n.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=r(n.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),o=n.ticks||[[],[]],t=this._tickBounds,t[0]=t[1]=Infinity,t[2]=t[3]=-Infinity,f=0;f<2;++f)(e=o[f].slice(0),e.length!==0)&&(e.sort(c),t[f]=Math.min(t[f],e[0].x),t[f+2]=Math.max(t[f+2],e[e.length-1].x));this.grid.update({bounds:t,ticks:o});this.text.update({bounds:t,ticks:o,labels:n.labels||["x","y"],labelSize:n.labelSize||[12,12],labelFont:n.labelFont||["sans-serif","sans-serif"],title:n.title||"",titleSize:n.titleSize||18,titleFont:n.titleFont||"sans-serif"});this.static=!!n.static;this.setDirty()};i.dispose=function(){var n;for(this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose(),n=this.objects.length-1;n>=0;--n)this.objects[n].dispose();for(this.objects.length=0,n=this.overlays.length-1;n>=0;--n)this.overlays[n].dispose();this.overlays.length=0;this.gl=null};i.addObject=function(n){this.objects.indexOf(n)<0&&(this.objects.push(n),this.setDirty())};i.removeObject=function(n){for(var i=this.objects,t=0;t<i.length;++t)if(i[t]===n){i.splice(t,1);this.setDirty();break}};i.addOverlay=function(n){this.overlays.indexOf(n)<0&&(this.overlays.push(n),this.setOverlayDirty())};i.removeOverlay=function(n){for(var i=this.overlays,t=0;t<i.length;++t)if(i[t]===n){i.splice(t,1);this.setOverlayDirty();break}}},{"./lib/box":175,"./lib/grid":176,"./lib/line":177,"./lib/text":179,"gl-select-static":276}],200:[function(n,t){var i=n("gl-shader"),r="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}",u="precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}";t.exports=function(n){return i(n,r,u,null,[{name:"position",type:"vec2"}])}},{"gl-shader":277}],201:[function(n,t){"use strict";function e(n,t){var s,c,l;n=n||document.body;t=t||{};s=[.01,Infinity];"distanceLimits"in t&&(s[0]=t.distanceLimits[0],s[1]=t.distanceLimits[1]);"zoomMin"in t&&(s[0]=t.zoomMin);"zoomMax"in t&&(s[1]=t.zoomMax);var e=r({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:s}),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0,v=n.clientWidth,y=n.clientHeight,o={view:e,element:n,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:e.modes,tick:function(){var u=i(),f=this.delay,s,r,o,t,c;for(e.idle(u-f),e.flush(u-(100+f*2)),s=u-2*f,e.recalcMatrix(s),r=!0,o=e.computedMatrix,t=0;t<16;++t)r=r&&a[t]===o[t],a[t]=o[t];return(c=n.clientWidth===v&&n.clientHeight===y,v=n.clientWidth,y=n.clientHeight,r)?!c:(h=Math.exp(e.computedRadius[0]),!0)},lookAt:function(n,t,i){e.lookAt(e.lastT(),n,t,i)},rotate:function(n,t,i){e.rotate(e.lastT(),n,t,i)},pan:function(n,t,i){e.pan(e.lastT(),n,t,i)},translate:function(n,t,i){e.translate(e.lastT(),n,t,i)}};return Object.defineProperties(o,{matrix:{get:function(){return e.computedMatrix},set:function(n){return e.setMatrix(e.lastT(),n),e.computedMatrix},enumerable:!0},mode:{get:function(){return e.getMode()},set:function(n){return e.setMode(n),e.getMode()},enumerable:!0},center:{get:function(){return e.computedCenter},set:function(n){return e.lookAt(e.lastT(),n),e.computedCenter},enumerable:!0},eye:{get:function(){return e.computedEye},set:function(n){return e.lookAt(e.lastT(),null,n),e.computedEye},enumerable:!0},up:{get:function(){return e.computedUp},set:function(n){return e.lookAt(e.lastT(),null,null,n),e.computedUp},enumerable:!0},distance:{get:function(){return h},set:function(n){return e.setDistance(e.lastT(),n),n},enumerable:!0},distanceLimits:{get:function(){return e.getDistanceLimits(s)},set:function(n){return e.setDistanceLimits(n),n},enumerable:!0}}),n.addEventListener("contextmenu",function(n){return n.preventDefault(),!1}),c=0,l=0,u(n,function(t,r,u,f){var p=1/n.clientHeight,a=p*(r-c),v=p*(u-l),b=o.flipX?1:-1,k=o.flipY?1:-1,y=Math.PI*o.rotateSpeed,s=i(),w;t&1?f.shift?e.rotate(s,0,0,-a*y):e.rotate(s,b*y*a,-k*y*v,0):t&2?e.pan(s,-o.translateSpeed*a*h,o.translateSpeed*v*h,0):t&4&&(w=o.zoomSpeed*v/window.innerHeight*(s-e.lastT())*50,e.pan(s,0,0,h*(Math.exp(w)-1)));c=r;l=u}),f(n,function(n,t){var f=o.flipX?1:-1,s=o.flipY?1:-1,r=i(),u;Math.abs(n)>Math.abs(t)?e.rotate(r,0,0,-n*f*Math.PI*o.rotateSpeed/window.innerWidth):(u=o.zoomSpeed*s*t/window.innerHeight*(r-e.lastT())/100,e.pan(r,0,0,h*(Math.exp(u)-1)))},!0),o}t.exports=e;var i=n("right-now"),r=n("3d-view"),u=n("mouse-change"),f=n("mouse-wheel")},{"3d-view":45,"mouse-change":513,"mouse-wheel":517,"right-now":527}],202:[function(n,t){(function(){"use strict";function s(n){n.permitHostObjects___&&n.permitHostObjects___(s)}function p(n){return!(n.substr(0,o.length)==o&&n.substr(n.length-3)==="___")}function r(n){if(n!==Object(n))throw new TypeError("Not an object: "+n);var t=n[l];if(t&&t.key===n)return t;if(!g(n))return void 0;t={key:n};try{return u(n,l,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(i){return void 0}}function i(n){return n.prototype=null,Object.freeze(n)}function b(){v||typeof console=="undefined"||(v=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var f,e,h,c,y,a,w,v,k,n;if(typeof ses=="undefined"||!ses.ok||ses.ok()){if(typeof ses!="undefined"&&(ses.weakMapPermitHostObjects=s),f=!1,typeof WeakMap=="function"&&(e=WeakMap,typeof navigator=="undefined"||!/Firefox/.test(navigator.userAgent)))if(h=new e,c=Object.freeze({}),h.set(c,1),h.get(c)!==1)f=!0;else{t.exports=WeakMap;return}var nt=Object.prototype.hasOwnProperty,d=Object.getOwnPropertyNames,u=Object.defineProperty,g=Object.isExtensible,o="weakmap:",l=o+"ident:"+Math.random()+"___";typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"&&(y=new ArrayBuffer(25),a=new Uint8Array(y),crypto.getRandomValues(a),l=o+"rand:"+Array.prototype.map.call(a,function(n){return(n%36).toString(36)}).join("")+"___");u(Object,"getOwnPropertyNames",{value:function(n){return d(n).filter(p)}});"getPropertyNames"in Object&&(w=Object.getPropertyNames,u(Object,"getPropertyNames",{value:function(n){return w(n).filter(p)}})),function(){var i=Object.freeze,n,t;u(Object,"freeze",{value:function(n){return r(n),i(n)}});n=Object.seal;u(Object,"seal",{value:function(t){return r(t),n(t)}});t=Object.preventExtensions;u(Object,"preventExtensions",{value:function(n){return r(n),t(n)}})}();v=!1;k=0;n=function(){function e(n,i){var e,o=r(n);return o?f in o?o[f]:i:(e=t.indexOf(n),e>=0?u[e]:i)}function o(n){var i=r(n);return i?f in i:t.indexOf(n)>=0}function s(n,i){var e,o=r(n);return o?o[f]=i:(e=t.indexOf(n),e>=0?u[e]=i:(e=t.length,u[e]=i,t[e]=n)),this}function h(n){var o=r(n),i,e;return o?f in o&&delete o[f]:(i=t.indexOf(n),i<0)?!1:(e=t.length-1,t[i]=void 0,u[i]=u[e],t[i]=t[e],t.length=e,u.length=e,!0)}this instanceof n||b();var t=[],u=[],f=k++;return Object.create(n.prototype,{get___:{value:i(e)},has___:{value:i(o)},set___:{value:i(s)},delete___:{value:i(h)}})};n.prototype=Object.create(Object.prototype,{get:{value:function(n,t){return this.get___(n,t)},writable:!0,configurable:!0},has:{value:function(n){return this.has___(n)},writable:!0,configurable:!0},set:{value:function(n,t){return this.set___(n,t)},writable:!0,configurable:!0},"delete":{value:function(n){return this.delete___(n)},writable:!0,configurable:!0}});typeof e=="function"?function(){function r(){function h(n,i){return t?r.has(n)?r.get(n):t.get___(n,i):r.get(n,i)}function c(n){return r.has(n)||(t?t.has___(n):!1)}function l(n){var i=!!r["delete"](n);return t?t.delete___(n)||i:i}var o;this instanceof n||b();var r=new e,t=undefined,u=!1;return o=f?function(i,u){return r.set(i,u),r.has(i)||(t||(t=new n),t.set(i,u)),this}:function(i,f){if(u)try{r.set(i,f)}catch(e){t||(t=new n);t.set___(i,f)}else r.set(i,f);return this},Object.create(n.prototype,{get___:{value:i(h)},has___:{value:i(c)},set___:{value:i(o)},delete___:{value:i(l)},permitHostObjects___:{value:i(function(n){if(n===s)u=!0;else throw new Error("bogus call to permitHostObjects___");})}})}f&&typeof Proxy!="undefined"&&(Proxy=undefined);r.prototype=n.prototype;t.exports=r;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy!="undefined"&&(Proxy=undefined),t.exports=n)}})()},{}],203:[function(n,t){"use strict";function e(n){var t=i.get(n),r;t&&n.isBuffer(t._triangleBuffer.buffer)||(r=u(n,new Float32Array([-1,-1,-1,4,4,-1])),t=f(n,[{buffer:r,type:n.FLOAT,size:2}]),t._triangleBuffer=r,i.set(n,t));t.bind();n.drawArrays(n.TRIANGLES,0,3);t.unbind()}var r=typeof WeakMap=="undefined"?n("weak-map"):WeakMap,u=n("gl-buffer"),f=n("gl-vao"),i=new r;t.exports=e},{"gl-buffer":134,"gl-vao":306,"weak-map":202}],204:[function(n,t){"use strict";function u(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function s(n){this.gl=n;this.pixelRatio=1;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=!0;this.tickSpacing=[1,1,1];this.tickEnable=[!0,!0,!0];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[10,10,10];this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]};this.labels=["x","y","z"];this.labelEnable=[!0,!0,!0];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[10,10,10];this.lineEnable=[!0,!0,!0];this.lineMirror=[!1,!1,!1];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[!0,!0,!0];this.lineTickMirror=[!1,!1,!1];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[!0,!0,!0];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[!0,!0,!0];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[!1,!1,!1];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=!0;this._text=null;this._lines=null;this._background=v(n)}function f(){this.primalOffset=[0,0,0];this.primalMinor=[0,0,0];this.mirrorOffset=[0,0,0];this.mirrorMinor=[0,0,0]}function p(n,t,i,r,u){for(var s=n.primalOffset,h=n.primalMinor,c=n.mirrorOffset,l=n.mirrorMinor,y=r[t],f=0;f<3;++f)if(t!==f){var a=s,v=c,e=h,o=l;y&1<<f&&(a=c,v=s,e=l,o=h);a[f]=i[0][f];v[f]=i[1][f];u[f]>0?(e[f]=-1,o[f]=0):(e[f]=0,o[f]=1)}}function d(n,t){var i=new s(n);return i.update(t),i}var i,e,h,c;t.exports=d;var l=n("./lib/text.js"),a=n("./lib/lines.js"),v=n("./lib/background.js"),y=n("./lib/cube.js"),o=n("./lib/ticks.js"),r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);i=s.prototype;i.update=function(n){function h(t,i,r){var u,o,e,f;if(r in n)for(u=n[r],o=this[r],this[r]=(t?Array.isArray(u)&&Array.isArray(u[0]):Array.isArray(u))?e=[i(u[0]),i(u[1]),i(u[2])]:e=[i(u),i(u),i(u)],f=0;f<3;++f)if(e[f]!==o[f])return!0;return!1}var y,e,t,p;n=n||{};var i=h.bind(this,!1,Number),r=h.bind(this,!1,Boolean),v=h.bind(this,!1,String),f=h.bind(this,!0,function(n){if(Array.isArray(n)){if(n.length===3)return[+n[0],+n[1],+n[2],1];if(n.length===4)return[+n[0],+n[1],+n[2],+n[3]]}return[0,0,0,1]}),s,u=!1,c=!1;if("bounds"in n)for(y=n.bounds,t=0;t<2;++t)for(e=0;e<3;++e)y[t][e]!==this.bounds[t][e]&&(c=!0),this.bounds[t][e]=y[t][e];if("ticks"in n)for(s=n.ticks,u=!0,this.autoTicks=!1,t=0;t<3;++t)this.tickSpacing[t]=0;else i("tickSpacing")&&(this.autoTicks=!0,c=!0);if(this._firstInit&&("ticks"in n||"tickSpacing"in n||(this.autoTicks=!0),c=!0,u=!0,this._firstInit=!1),c&&this.autoTicks&&(s=o.create(this.bounds,this.tickSpacing),u=!0),u){for(t=0;t<3;++t)s[t].sort(function(n,t){return n.x-t.x});o.equal(s,this.ticks)?u=!1:this.ticks=s}r("tickEnable");v("tickFont")&&(u=!0);i("tickSize");i("tickAngle");i("tickPad");f("tickColor");p=v("labels");v("labelFont")&&(p=!0);r("labelEnable");i("labelSize");i("labelPad");f("labelColor");r("lineEnable");r("lineMirror");i("lineWidth");f("lineColor");r("lineTickEnable");r("lineTickMirror");i("lineTickLength");i("lineTickWidth");f("lineTickColor");r("gridEnable");i("gridWidth");f("gridColor");r("zeroEnable");f("zeroLineColor");i("zeroLineWidth");r("backgroundEnable");f("backgroundColor");this._text?this._text&&(p||u)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=l(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont);this._lines&&u&&(this._lines.dispose(),this._lines=null);this._lines||(this._lines=a(this.gl,this.bounds,this.ticks))};e=[new f,new f,new f];h=[0,0,0];c={model:r,view:r,projection:r};i.isOpaque=function(){return!0};i.isTransparent=function(){return!1};i.drawTransparent=function(){};var w=[0,0,0],b=[0,0,0],k=[0,0,0];i.draw=function(n){var f,et,ut,it,d,o,ft,t,rt,g,i;n=n||c;var et=this.gl,s=n.model||r,l=n.view||r,a=n.projection||r,v=this.bounds,ot=y(s,l,a,v),st=ot.cubeEdges,nt=ot.axis,at=l[12],vt=l[13],yt=l[14],pt=l[15],tt=this.pixelRatio*(a[3]*at+a[7]*vt+a[11]*yt+a[15]*pt)/et.drawingBufferHeight;for(t=0;t<3;++t)this.lastCubeProps.cubeEdges[t]=st[t],this.lastCubeProps.axis[t]=nt[t];for(f=e,t=0;t<3;++t)p(e[t],t,this.bounds,st,nt);for(et=this.gl,ut=h,t=0;t<3;++t)ut[t]=this.backgroundEnable[t]?nt[t]:0;for(this._background.draw(s,l,a,v,ut,this.backgroundColor),this._lines.bind(s,l,a,this),t=0;t<3;++t){for(it=[0,0,0],it[t]=nt[t]>0?v[1][t]:v[0][t],i=0;i<2;++i)d=(t+1+i)%3,o=(t+1+(i^1))%3,this.gridEnable[d]&&this._lines.drawGrid(d,o,this.bounds,it,this.gridColor[d],this.gridWidth[d]*this.pixelRatio);for(i=0;i<2;++i)d=(t+1+i)%3,o=(t+1+(i^1))%3,this.zeroEnable[o]&&v[0][o]<=0&&v[1][o]>=0&&this._lines.drawZero(d,o,this.bounds,it,this.zeroLineColor[o],this.zeroLineWidth[o]*this.pixelRatio)}for(t=0;t<3;++t){this.lineEnable[t]&&this._lines.drawAxisLine(t,this.bounds,f[t].primalOffset,this.lineColor[t],this.lineWidth[t]*this.pixelRatio);this.lineMirror[t]&&this._lines.drawAxisLine(t,this.bounds,f[t].mirrorOffset,this.lineColor[t],this.lineWidth[t]*this.pixelRatio);var ht=u(w,f[t].primalMinor),ct=u(b,f[t].mirrorMinor),lt=this.lineTickLength;for(i=0;i<3;++i)ft=tt/s[5*i],ht[i]*=lt[i]*ft,ct[i]*=lt[i]*ft;this.lineTickEnable[t]&&this._lines.drawAxisTicks(t,f[t].primalOffset,ht,this.lineTickColor[t],this.lineTickWidth[t]*this.pixelRatio);this.lineTickMirror[t]&&this._lines.drawAxisTicks(t,f[t].mirrorOffset,ct,this.lineTickColor[t],this.lineTickWidth[t]*this.pixelRatio)}for(this._text.bind(s,l,a,this.pixelRatio),t=0;t<3;++t){for(rt=f[t].primalMinor,g=u(k,f[t].primalOffset),i=0;i<3;++i)this.lineTickEnable[t]&&(g[i]+=tt*rt[i]*Math.max(this.lineTickLength[i],0)/s[5*i]);if(this.tickEnable[t]){for(i=0;i<3;++i)g[i]+=tt*rt[i]*this.tickPad[i]/s[5*i];this._text.drawTicks(t,this.tickSize[t],this.tickAngle[t],g,this.tickColor[t])}if(this.labelEnable[t]){for(i=0;i<3;++i)g[i]+=tt*rt[i]*this.labelPad[i]/s[5*i];g[t]+=.5*(v[0][t]+v[1][t]);this._text.drawLabel(t,this.labelSize[t],this.labelAngle[t],g,this.labelColor[t])}}};i.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose();this._lines=null;this._text=null;this._background=null;this.gl=null}},{"./lib/background.js":205,"./lib/cube.js":206,"./lib/lines.js":207,"./lib/text.js":209,"./lib/ticks.js":210}],205:[function(n,t){"use strict";function u(n,t,i,r){this.gl=n;this.buffer=t;this.vao=i;this.shader=r}function o(n){for(var s,c,l,k,w=[],b=[],t=0,i=0;i<3;++i){var a=(i+1)%3,v=(i+2)%3,o=[0,0,0],h=[0,0,0];for(s=-1;s<=1;s+=2){for(b.push(t,t+2,t+1,t+1,t+2,t+3),o[i]=s,h[i]=s,c=-1;c<=1;c+=2)for(o[a]=c,l=-1;l<=1;l+=2)o[v]=l,w.push(o[0],o[1],o[2],h[0],h[1],h[2]),t+=1;k=a;a=v;v=k}}var y=r(n,new Float32Array(w)),d=r(n,new Uint16Array(b),n.ELEMENT_ARRAY_BUFFER),g=f(n,[{buffer:y,type:n.FLOAT,size:3,offset:0,stride:24},{buffer:y,type:n.FLOAT,size:3,offset:12,stride:24}],d),p=e(n);return p.attributes.position.location=0,p.attributes.normal.location=1,new u(n,y,g,p)}var i;t.exports=o;var r=n("gl-buffer"),f=n("gl-vao"),e=n("./shaders").bg;i=u.prototype;i.draw=function(n,t,i,r,u,f){for(var e,o=!1,s=0;s<3;++s)o=o||u[s];o&&(e=this.gl,e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:n,view:t,projection:i,bounds:r,enable:u,colors:f},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),e.disable(e.POLYGON_OFFSET_FILL))};i.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()}},{"./shaders":208,"gl-buffer":134,"gl-vao":306}],206:[function(n,t){"use strict";function y(n,t,i){for(var u,r=0;r<4;++r)for(n[r]=i[12+r],u=0;u<3;++u)n[r]+=t[u]*i[4*u+r]}function p(n){for(var t=0;t<o.length;++t)if(n=l.positive(n,o[t]),n.length<3)return 0;var i=n[0],f=i[0]/i[3],e=i[1]/i[3],s=0;for(t=1;t+1<n.length;++t){var r=n[t],u=n[t+1],h=r[0]/r[3],c=r[1]/r[3],a=u[0]/u[3],v=u[1]/u[3],y=h-f,p=c-e,w=a-f,b=v-e;s+=Math.abs(y*b-p*w)}return s}function b(n,t,o,l){var pt,vt,yt,d,wt,st,k,at,tt,it,rt,b,nt,ut,ft,et,gt,ni,g;for(s(f,t,n),s(f,o,f),pt=0,b=0;b<2;++b)for(e[2]=l[b][2],vt=0;vt<2;++vt)for(e[1]=l[vt][1],yt=0;yt<2;++yt)e[0]=l[yt][0],y(r[pt],e,f),pt+=1;for(d=-1,b=0;b<8;++b){for(wt=r[b][3],st=0;st<3;++st)i[b][st]=r[b][st]/wt;wt<0&&(d<0?d=b:i[b][2]<i[d][2]&&(d=b))}if(d<0)for(d=0,g=0;g<3;++g){var ht=(g+2)%3,ut=(g+1)%3,ct=-1,lt=-1;for(k=0;k<2;++k){var ot=k<<g,bt=ot+(k<<ht)+(1-k<<ut),kt=ot+(1-k<<ht)+(k<<ut);a(i[ot],i[bt],i[kt],v)<0||(k?ct=1:lt=1)}if(ct<0||lt<0){lt>ct&&(d|=1<<g);continue}for(k=0;k<2;++k){var ot=k<<g,bt=ot+(k<<ht)+(1-k<<ut),kt=ot+(1-k<<ht)+(k<<ut),dt=p([r[ot],r[bt],r[kt],r[ot+(1<<ht)+(1<<ut)]]);k?ct=dt:lt=dt}if(lt>ct){d|=1<<g;continue}}for(at=7^d,tt=-1,b=0;b<8;++b)b!==d&&b!==at&&(tt<0?tt=b:i[tt][1]>i[b][1]&&(tt=b));for(it=-1,b=0;b<3;++b)(nt=tt^1<<b,nt!==d&&nt!==at)&&(it<0&&(it=nt),ut=i[nt],ut[0]<i[it][0]&&(it=nt));for(rt=-1,b=0;b<3;++b)(nt=tt^1<<b,nt!==d&&nt!==at&&nt!==it)&&(rt<0&&(rt=nt),ut=i[nt],ut[0]>i[rt][0]&&(rt=nt));for(ft=h,ft[0]=ft[1]=ft[2]=0,ft[u.log2(it^tt)]=tt&it,ft[u.log2(tt^rt)]=tt&rt,et=rt^7,et===d||et===at?(et=it^7,ft[u.log2(rt^et)]=et&rt):ft[u.log2(it^et)]=et&it,gt=c,ni=d,g=0;g<3;++g)gt[g]=ni&1<<g?-1:1;return w}var o;t.exports=b;var u=n("bit-twiddle"),s=n("gl-mat4/multiply"),k=n("gl-mat4/invert"),l=n("split-polygon"),a=n("robust-orientation"),f=new Array(16),d=new Array(16),r=new Array(8),i=new Array(8),e=new Array(3),v=[0,0,0];(function(){for(var n=0;n<8;++n)r[n]=[1,1,1,1],i[n]=[1,1,1]})();o=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];var h=[1,1,1],c=[0,0,0],w={cubeEdges:h,axis:c}},{"bit-twiddle":56,"gl-mat4/invert":153,"gl-mat4/multiply":155,"robust-orientation":531,"split-polygon":212}],207:[function(n,t){"use strict";function i(n){return n[0]=n[1]=n[2]=0,n}function s(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function c(n,t,i,r,u,f,e,o){this.gl=n;this.vertBuffer=t;this.vao=i;this.shader=r;this.tickCount=u;this.tickOffset=f;this.gridCount=e;this.gridOffset=o}function y(n,t,i){var f=[],y=[0,0,0],p=[0,0,0],w=[0,0,0],b=[0,0,0],u,o,e,h,r,s;for(f.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1),u=0;u<3;++u){for(e=f.length/3|0,o=0;o<i[u].length;++o)r=+i[u][o].x,f.push(r,0,1,r,1,1,r,0,-1,r,0,-1,r,1,1,r,1,-1);for(s=f.length/3|0,y[u]=e,p[u]=s-e,e=f.length/3|0,h=0;h<i[u].length;++h)r=+i[u][h].x,f.push(r,0,1,r,1,1,r,0,-1,r,0,-1,r,1,1,r,1,-1);s=f.length/3|0;w[u]=e;b[u]=s-e}var k=l(n,new Float32Array(f)),g=a(n,[{buffer:k,type:n.FLOAT,size:3,stride:0,offset:0}]),d=v(n);return d.attributes.position.location=0,new c(n,k,g,d,p,y,b,w)}var r;t.exports=y;var l=n("gl-buffer"),a=n("gl-vao"),v=n("./shaders").line,h=[0,0,0],f=[0,0,0],u=[0,0,0],e=[0,0,0],o=[1,1];r=c.prototype;r.bind=function(n,t,i){this.shader.bind();this.shader.uniforms.model=n;this.shader.uniforms.view=t;this.shader.uniforms.projection=i;o[0]=this.gl.drawingBufferWidth;o[1]=this.gl.drawingBufferHeight;this.shader.uniforms.screenShape=o;this.vao.bind()};r.drawAxisLine=function(n,t,r,o,h){var a=i(f),l,c;this.shader.uniforms.majorAxis=f;a[n]=t[1][n]-t[0][n];this.shader.uniforms.minorAxis=a;l=s(e,r);l[n]+=t[0][n];this.shader.uniforms.offset=l;this.shader.uniforms.lineWidth=h;this.shader.uniforms.color=o;c=i(u);c[(n+2)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6);c=i(u);c[(n+1)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6)};r.drawAxisTicks=function(n,t,r,f,e){var o,s;this.tickCount[n]&&(o=i(h),o[n]=1,this.shader.uniforms.majorAxis=o,this.shader.uniforms.offset=t,this.shader.uniforms.minorAxis=r,this.shader.uniforms.color=f,this.shader.uniforms.lineWidth=e,s=i(u),s[n]=1,this.shader.uniforms.screenAxis=s,this.vao.draw(this.gl.TRIANGLES,this.tickCount[n],this.tickOffset[n]))};r.drawGrid=function(n,t,r,o,c,l){var a,v,y,p;this.gridCount[n]&&(a=i(f),a[t]=r[1][t]-r[0][t],this.shader.uniforms.minorAxis=a,v=s(e,o),v[t]+=r[0][t],this.shader.uniforms.offset=v,y=i(h),y[n]=1,this.shader.uniforms.majorAxis=y,p=i(u),p[n]=1,this.shader.uniforms.screenAxis=p,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=c,this.vao.draw(this.gl.TRIANGLES,this.gridCount[n],this.gridOffset[n]))};r.drawZero=function(n,t,r,o,h,c){var l=i(f),a,v;this.shader.uniforms.majorAxis=l;l[n]=r[1][n]-r[0][n];this.shader.uniforms.minorAxis=l;a=s(e,o);a[n]+=r[0][n];this.shader.uniforms.offset=a;v=i(u);v[t]=1;this.shader.uniforms.screenAxis=v;this.shader.uniforms.lineWidth=c;this.shader.uniforms.color=h;this.vao.draw(this.gl.TRIANGLES,6)};r.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()}},{"./shaders":208,"gl-buffer":134,"gl-vao":306}],208:[function(n,t,i){"use strict";var r=n("gl-shader"),s="#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n",h="precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}",u,f,e,o;i.line=function(n){return r(n,s,h,null,[{name:"position",type:"vec3"}])};u="#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvoid main() {  \n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n  mat2 planeXform = scale * mat2(cos(angle), sin(angle),\n                                -sin(angle), cos(angle));\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n  vec4 worldPosition = model * vec4(dataPosition, 1);\n  \n  //Compute clip position\n  vec4 viewPosition = view * worldPosition;\n  vec4 clipPosition = projection * viewPosition;\n  clipPosition /= clipPosition.w;\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec4(viewOffset, 0, 0);\n\n  //Done\n  gl_Position = clipPosition;\n}";f="precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}";i.text=function(n){return r(n,u,f,null,[{name:"position",type:"vec3"}])};e="#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  if(dot(normal, enable) > 0.0) {\n    vec3 nPosition = mix(bounds[0], bounds[1], 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n  colorChannel = abs(normal);\n}";o="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] + \n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}";i.bg=function(n){return r(n,e,o,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":277}],209:[function(n,t){(function(i){"use strict";function s(n,t,i,r){this.gl=n;this.shader=t;this.buffer=i;this.vao=r;this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}function w(n,t){try{return v(n,t)}catch(i){return console.warn("error vectorizing text:",i),{cells:[],positions:[]}}}function b(n,t,i,r,u,f){var o=l(n),c=a(n,[{buffer:o,size:3}]),h=y(n),e;return h.attributes.position.location=0,e=new s(n,h,o,c),e.update(t,i,r,u,f),e}var r,p,u,f,h,c;t.exports=b;var l=n("gl-buffer"),a=n("gl-vao"),v=n("vectorize-text"),y=n("./shaders").text,e=window||i.global||{},o=e.__TEXT_CACHE||{};e.__TEXT_CACHE={};r=3;p=r*4;u=s.prototype;f=[0,0];u.bind=function(n,t,i,r){this.vao.bind();this.shader.bind();var u=this.shader.uniforms;u.model=n;u.view=t;u.projection=i;u.pixelScale=r;f[0]=this.gl.drawingBufferWidth;f[1]=this.gl.drawingBufferHeight;this.shader.uniforms.resolution=f};u.update=function(n,t,i,u,f){function a(n,t,i,r){var f=o[i],u,e,v,y,s,c;f||(f=o[i]={});u=f[t];u||(u=f[t]=w(t,{triangles:!0,font:i,textAlign:"center",textBaseline:"middle"}));var l=(r||12)/12,p=u.positions,a=u.cells;for(e=0,v=a.length;e<v;++e)for(y=a[e],s=2;s>=0;--s)c=p[y[s]],h.push(l*c[0],-l*c[1],n)}for(var s,p=this.gl,h=[],c=[0,0,0],v=[0,0,0],l=[0,0,0],y=[0,0,0],e=0;e<3;++e){for(l[e]=h.length/r|0,a(.5*(n[0][e]+n[1][e]),t[e],i),y[e]=(h.length/r|0)-l[e],c[e]=h.length/r|0,s=0;s<u[e].length;++s)u[e][s].text&&a(u[e][s].x,u[e][s].text,u[e][s].font||f,u[e][s].fontSize||12);v[e]=(h.length/r|0)-c[e]}this.buffer.update(h);this.tickOffset=c;this.tickCount=v;this.labelOffset=l;this.labelCount=y};h=[0,0,0];u.drawTicks=function(n,t,i,r,u){if(this.tickCount[n]){var f=h;f[0]=f[1]=f[2]=0;f[n]=1;this.shader.uniforms.axis=f;this.shader.uniforms.color=u;this.shader.uniforms.angle=i;this.shader.uniforms.scale=t;this.shader.uniforms.offset=r;this.vao.draw(this.gl.TRIANGLES,this.tickCount[n],this.tickOffset[n])}};c=[0,0,0];u.drawLabel=function(n,t,i,r,u){this.labelCount[n]&&(this.shader.uniforms.axis=c,this.shader.uniforms.color=u,this.shader.uniforms.angle=i,this.shader.uniforms.scale=t,this.shader.uniforms.offset=r,this.vao.draw(this.gl.TRIANGLES,this.labelCount[n],this.labelOffset[n]))};u.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()}}).call(this,n("_process"))},{"./shaders":208,_process:64,"gl-buffer":134,"gl-vao":306,"vectorize-text":552}],210:[function(n,t,i){"use strict";function r(n,t){var h=n+"",c=h.indexOf("."),o=0,i,r,f,e;c>=0&&(o=h.length-c-1);var s=Math.pow(10,o),u=Math.round(n*t*s),l=u+"";if(l.indexOf("e")>=0)return l;if(i=u/s,r=u%s,u<0?(i=-Math.ceil(i)|0,r=-r|0):(i=Math.floor(i)|0,r=r|0),f=""+i,u<0&&(f="-"+f),o){for(e=""+r;e.length<o;)e="0"+e;return f+"."+e}return f}function u(n,t){for(var f,o,u,e=[],i=0;i<3;++i){for(f=[],o=.5*(n[0][i]+n[1][i]),u=0;u*t[i]<=n[1][i];++u)f.push({x:u*t[i],text:r(t[i],u)});for(u=-1;u*t[i]>=n[0][i];--u)f.push({x:u*t[i],text:r(t[i],u)});e.push(f)}return e}function f(n,t){for(var f,r,u,i=0;i<3;++i){if(n[i].length!==t[i].length)return!1;for(f=0;f<n[i].length;++f)if(r=n[i][f],u=t[i][f],r.x!==u.x||r.text!==u.text||r.font!==u.font||r.fontColor!==u.fontColor||r.fontSize!==u.fontSize||r.dx!==u.dx||r.dy!==u.dy)return!1}return!0}i.create=u;i.equal=f},{}],211:[function(n,t){"use strict";function i(n,t,i){var r=t||0,u=i||1;return[[n[12]+n[0],n[13]+n[1],n[14]+n[2],n[15]+n[3]],[n[12]-n[0],n[13]-n[1],n[14]-n[2],n[15]-n[3]],[n[12]+n[4],n[13]+n[5],n[14]+n[6],n[15]+n[7]],[n[12]-n[4],n[13]-n[5],n[14]-n[6],n[15]-n[7]],[r*n[12]+n[8],r*n[13]+n[9],r*n[14]+n[10],r*n[15]+n[11]],[u*n[12]-n[8],u*n[13]-n[9],u*n[14]-n[10],u*n[15]-n[11]]]}t.exports=i},{}],212:[function(n,t){"use strict";function i(n,t){var i=f(u(n,t),[t[t.length-1]]);return i[i.length-1]}function r(n,t,i,r){var s=r-t,u=-t/s,f;u<0?u=0:u>1&&(u=1);var h=1-u,e=n.length,o=new Array(e);for(f=0;f<e;++f)o[f]=u*n[f]+h*i[f];return o}function e(n,t){for(var f,c,e=[],o=[],s=i(n[n.length-1],t),l=n[n.length-1],u=n[0],h=0;h<n.length;++h,l=u)u=n[h],f=i(u,t),(s<0&&f>0||s>0&&f<0)&&(c=r(l,f,u,s),e.push(c),o.push(c.slice())),f<0?o.push(u.slice()):f>0?e.push(u.slice()):(e.push(u.slice()),o.push(u.slice())),s=f;return{positive:e,negative:o}}function o(n,t){for(var u,o=[],e=i(n[n.length-1],t),h=n[n.length-1],f=n[0],s=0;s<n.length;++s,h=f)f=n[s],u=i(f,t),(e<0&&u>0||e>0&&u<0)&&o.push(r(h,u,f,e)),u>=0&&o.push(f.slice()),e=u;return o}function s(n,t){for(var u,o=[],e=i(n[n.length-1],t),h=n[n.length-1],f=n[0],s=0;s<n.length;++s,h=f)f=n[s],u=i(f,t),(e<0&&u>0||e>0&&u<0)&&o.push(r(h,u,f,e)),u<=0&&o.push(f.slice()),e=u;return o}var u=n("robust-dot-product"),f=n("robust-sum");t.exports=e;t.exports.positive=o;t.exports.negative=s},{"robust-dot-product":213,"robust-sum":534}],213:[function(n,t){"use strict";function u(n,t){for(var f=i(n[0],t[0]),u=1;u<n.length;++u)f=r(f,i(n[u],t[u]));return f}var i=n("two-product"),r=n("robust-sum");t.exports=u},{"robust-sum":534,"two-product":548}],214:[function(n,t){"use strict";function u(n,t,i){this.lo=n;this.hi=t;this.pixelsPerDataUnit=i}function p(n,t,i,r,u){for(var f,e,l,a,v,o=0;o<3;++o){for(f=h,e=c,l=0;l<3;++l)e[l]=f[l]=i[l];e[3]=f[3]=1;e[o]+=1;s(e,e,t);e[3]<0&&(n[o]=Infinity);f[o]-=1;s(f,f,t);f[3]<0&&(n[o]=Infinity);a=(f[0]/f[3]-e[0]/e[3])*r;v=(f[1]/f[3]-e[1]/e[3])*u;n[o]=.25*Math.sqrt(a*a+v*v)}return n}function w(n,t,u,s,h){var ut=t.model||r,ft=t.view||r,et=t.projection||r,tt=n.bounds,h=h||y(ut,ft,et,tt),ht=h.axis,ct=h.edges,k,rt,d,w,g,b,nt,st,c;for(e(i,ft,ut),e(i,et,i),k=l,w=0;w<3;++w)k[w].lo=Infinity,k[w].hi=-Infinity,k[w].pixelsPerDataUnit=Infinity;for(rt=a(o(i,i)),o(i,i),d=0;d<3;++d){var ot=(d+1)%3,nt=(d+2)%3,it=f;n:for(w=0;w<2;++w)if(g=[],ht[d]<0!=!!w){for(it[d]=tt[w][d],b=0;b<2;++b)for(it[ot]=tt[b^w][ot],c=0;c<2;++c)it[nt]=tt[c^b^w][nt],g.push(it.slice());for(b=0;b<rt.length;++b){if(g.length===0)continue n;g=v.positive(g,rt[b])}for(b=0;b<g.length;++b)for(nt=g[b],st=p(f,i,nt,u,s),c=0;c<3;++c)k[c].lo=Math.min(k[c].lo,nt[c]),k[c].hi=Math.max(k[c].hi,nt[c]),c!==d&&(k[c].pixelsPerDataUnit=Math.min(k[c].pixelsPerDataUnit,Math.abs(st[c])))}}return k}var h,c,l,f;t.exports=w;var a=n("extract-frustum-planes"),v=n("split-polygon"),y=n("./lib/cube.js"),e=n("gl-mat4/multiply"),o=n("gl-mat4/transpose"),s=n("gl-vec4/transformMat4"),r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);h=[0,0,0,1];c=[0,0,0,1];l=[new u(Infinity,-Infinity,Infinity),new u(Infinity,-Infinity,Infinity),new u(Infinity,-Infinity,Infinity)];f=[0,0,0]},{"./lib/cube.js":206,"extract-frustum-planes":211,"gl-mat4/multiply":155,"gl-mat4/transpose":163,"gl-vec4/transformMat4":307,"split-polygon":212}],215:[function(n,t){"use strict";var i=n("gl-shader"),r="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n",u="precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}";t.exports=function(n){return i(n,r,u,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":277}],216:[function(n,t){"use strict";function f(n,t,i,r){this.gl=n;this.buffer=t;this.vao=i;this.shader=r;this.pixelRatio=1;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[!0,!0,!0];this.drawSides=[!0,!0,!0];this.axes=null}function l(n,t){function r(n,t,r,u,f,e){var o=[n,t,r,0,0,0,1];o[u+3]=1;o[u]=f;i.push.apply(i,o);o[6]=-1;i.push.apply(i,o);o[u]=e;i.push.apply(i,o);i.push.apply(i,o);o[6]=1;i.push.apply(i,o);o[u]=f;i.push.apply(i,o)}var i=[],c;r(0,0,0,0,0,1);r(0,0,0,1,0,1);r(0,0,0,2,0,1);r(1,0,0,1,-1,1);r(1,0,0,2,-1,1);r(0,1,0,0,-1,1);r(0,1,0,2,-1,1);r(0,0,1,0,-1,1);r(0,0,1,1,-1,1);var u=e(n,i),l=o(n,[{type:n.FLOAT,buffer:u,size:3,offset:0,stride:28},{type:n.FLOAT,buffer:u,size:3,offset:12,stride:28},{type:n.FLOAT,buffer:u,size:1,offset:24,stride:28}]),h=s(n);return h.attributes.position.location=0,h.attributes.color.location=1,h.attributes.weight.location=2,c=new f(n,u,l,h),c.update(t),c}var e=n("gl-buffer"),o=n("gl-vao"),s=n("./shaders/index"),r;t.exports=l;r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var i=f.prototype,h=[0,0,0],c=[0,0,0],u=[0,0];i.isTransparent=function(){return!1};i.drawTransparent=function(){};i.draw=function(n){var f=this.gl,e=this.vao,i=this.shader,o,s,t;e.bind();i.bind();var a=n.model||r,v=n.view||r,y=n.projection||r,l;for(this.axes&&(l=this.axes.lastCubeProps.axis),o=h,s=c,t=0;t<3;++t)l&&l[t]<0?(o[t]=this.bounds[0][t],s[t]=this.bounds[1][t]):(o[t]=this.bounds[1][t],s[t]=this.bounds[0][t]);for(u[0]=f.drawingBufferWidth,u[1]=f.drawingBufferHeight,i.uniforms.model=a,i.uniforms.view=v,i.uniforms.projection=y,i.uniforms.coordinates=[this.position,o,s],i.uniforms.colors=this.colors,i.uniforms.screenShape=u,t=0;t<3;++t)i.uniforms.lineWidth=this.lineWidth[t]*this.pixelRatio,this.enabled[t]&&(e.draw(f.TRIANGLES,6,6*t),this.drawSides[t]&&e.draw(f.TRIANGLES,12,18+12*t));e.unbind()};i.update=function(n){n&&("bounds"in n&&(this.bounds=n.bounds),"position"in n&&(this.position=n.position),"lineWidth"in n&&(this.lineWidth=n.lineWidth),"colors"in n&&(this.colors=n.colors),"enabled"in n&&(this.enabled=n.enabled),"drawSides"in n&&(this.drawSides=n.drawSides))};i.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()}},{"./shaders/index":215,"gl-buffer":134,"gl-vao":306}],217:[function(n,t){"use strict";function v(){this.mouse=[-1,-1];this.screen=null;this.distance=Infinity;this.index=null;this.dataCoordinate=null;this.dataPosition=null;this.object=null;this.data=null}function y(n,t){var i=null;try{i=n.getContext("webgl",t);i||(i=n.getContext("experimental-webgl",t))}catch(r){return null}return i}function p(n){var i=Math.round(Math.log(Math.abs(n))/Math.log(10)),t;return i<0?(t=Math.round(Math.pow(10,-i)),Math.ceil(n*t)/t):i>0?(t=Math.round(Math.pow(10,i)),Math.ceil(n/t)*t):Math.ceil(n)}function i(n){return typeof n=="boolean"?n:!0}function w(n){function yt(){var u,f,n;if(!rt&&w.autoResize){var t=g.parentNode,i=1,r=1;t&&t!==document.body?(i=t.clientWidth,r=t.clientHeight):(i=window.innerWidth,r=window.innerHeight);u=Math.ceil(i*w.pixelRatio)|0;f=Math.ceil(r*w.pixelRatio)|0;(u!==g.width||f!==g.height)&&(g.width=u,g.height=f,n=g.style,n.position=n.position||"absolute",n.left="0px",n.top="0px",n.width=i+"px",n.height=r+"px",nt=!0)}}function ti(){for(var f,u,i,e,s=k.length,r=ft.length,n=0;n<r;++n)ot[n]=0;n:for(n=0;n<s;++n){if(f=k[n],u=f.pickSlots,!u){et[n]=-1;continue}for(i=0;i<r;++i)if(ot[i]+u<255){et[n]=i;f.setPickBase(ot[i]+1);ot[i]+=u;continue n}e=o(t,ht);et[n]=r;ft.push(e);ot.push(u);f.setPickBase(1);r+=1}while(r>0&&ot[r-1]===0)ot.pop(),ft.pop().dispose()}function bt(){if(w.contextLost)return!0;t.isContextLost()&&(w.contextLost=!0,w.mouseListener.enabled=!1,w.selection.object=null,w.oncontextloss&&w.oncontextloss())}function oi(){var f,e,n,r,i,u;if(!bt())for(t.colorMask(!0,!0,!0,!0),t.depthMask(!0),t.disable(t.BLEND),t.enable(t.DEPTH_TEST),f=k.length,e=ft.length,n=0;n<e;++n){for(r=ft[n],r.shape=vt,r.begin(),i=0;i<f;++i)et[i]===n&&(u=k[i],u.drawPick&&(u.pixelRatio=1,u.drawPick(it)));r.end()}}function ii(){var et,rt,wt,dt,u,ot,c,i,pt,a,v,ft,y,g,r,n;if(!bt()){yt();et=w.camera.tick();it.view=w.camera.matrix;nt=nt||et;tt=tt||et;d.pixelRatio=w.pixelRatio;ut.pixelRatio=w.pixelRatio;var s=k.length,e=ct[0],o=ct[1];for(e[0]=e[1]=e[2]=Infinity,o[0]=o[1]=o[2]=-Infinity,n=0;n<s;++n)if(r=k[n],r.pixelRatio=w.pixelRatio,r.axes=w.axes,nt=nt||!!r.dirty,tt=tt||!!r.dirty,rt=r.bounds,rt)for(wt=rt[0],dt=rt[1],i=0;i<3;++i)e[i]=Math.min(e[i],wt[i]),o[i]=Math.max(o[i],dt[i]);if(u=w.bounds,w.autoBounds)for(i=0;i<3;++i)o[i]<e[i]?(e[i]=-1,o[i]=1):(e[i]===o[i]&&(e[i]-=1,o[i]+=1),ot=.05*(o[i]-e[i]),e[i]=e[i]-ot,o[i]=o[i]+ot),u[0][i]=e[i],u[1][i]=o[i];for(c=!1,i=0;i<3;++i)c=c||lt[0][i]!==u[0][i]||lt[1][i]!==u[1][i],lt[0][i]=u[0][i],lt[1][i]=u[1][i];if(c){for(pt=[0,0,0],n=0;n<3;++n)pt[n]=p((u[1][n]-u[0][n])/10);d.autoTicks?d.update({bounds:u,tickSpacing:pt}):d.update({bounds:u})}for(tt=tt||c,nt=nt||c,a=t.drawingBufferWidth,v=t.drawingBufferHeight,ht[0]=a,ht[1]=v,vt[0]=Math.max(a/w.pixelRatio,1)|0,vt[1]=Math.max(v/w.pixelRatio,1)|0,l(ni,w.fovy,a/v,w.zNear,w.zFar),n=0;n<16;++n)st[n]=0;for(st[15]=1,ft=0,n=0;n<3;++n)ft=Math.max(ft,u[1][n]-u[0][n]);for(n=0;n<3;++n)st[5*n]=w.autoScale?w.aspect[n]/(u[1][n]-u[0][n]):1/ft,w.autoCenter&&(st[12+n]=-st[5*n]*.5*(u[0][n]+u[1][n]));for(n=0;n<s;++n)r=k[n],r.axesBounds=u,w.clipToBounds&&(r.clipBounds=u);if(b.object&&(ut.position=w.snapToData?b.dataCoordinate:b.dataPosition,ut.bounds=u),tt&&(tt=!1,oi()),nt){for(w.axesPixels=f(w.axes,it,a,v),w.onrender&&w.onrender(),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,a,v),y=w.clearColor,t.clearColor(y[0],y[1],y[2],y[3]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.depthMask(!0),t.colorMask(!0,!0,!0,!0),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.disable(t.BLEND),t.disable(t.CULL_FACE),g=!1,d.enable&&(g=g||d.isTransparent(),d.draw(it)),ut.axes=d,b.object&&ut.draw(it),t.disable(t.CULL_FACE),n=0;n<s;++n)r=k[n],r.axes=d,r.pixelRatio=w.pixelRatio,r.isOpaque&&r.isOpaque()&&r.draw(it),r.isTransparent&&r.isTransparent()&&(g=!0);if(g){for(at.shape=ht,at.bind(),t.clear(t.DEPTH_BUFFER_BIT),t.colorMask(!1,!1,!1,!1),t.depthMask(!0),t.depthFunc(t.LESS),d.enable&&d.isTransparent()&&d.drawTransparent(it),n=0;n<s;++n)r=k[n],r.isOpaque&&r.isOpaque()&&r.draw(it);for(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.colorMask(!0,!0,!0,!0),t.depthMask(!1),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),d.isTransparent()&&d.drawTransparent(it),n=0;n<s;++n)r=k[n],r.isTransparent&&r.isTransparent()&&r.drawTransparent(it);t.bindFramebuffer(t.FRAMEBUFFER,null);t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA);t.disable(t.DEPTH_TEST);kt.bind();at.color[0].bind(0);kt.uniforms.accumBuffer=0;h(t);t.disable(t.BLEND)}for(nt=!1,n=0;n<s;++n)k[n].dirty=!1}}}function ri(){rt||w.contextLost||(requestAnimationFrame(ri),ii())}var dt,t,pt,wt,ct,lt;n=n||{};var rt=!1,si=n.pixelRatio||parseFloat(window.devicePixelRatio),g=n.canvas;if(g||(g=document.createElement("canvas"),n.container?(dt=n.container,dt.appendChild(g)):document.body.appendChild(g)),t=n.gl,t||(t=y(g,n.glOptions||{premultipliedAlpha:!0,antialias:!0})),!t)throw new Error("webgl not supported");var ui=n.bounds||[[-10,-10,-10],[10,10,10]],b=new v,at=s(t,[t.drawingBufferWidth,t.drawingBufferHeight],{preferFloat:!0}),kt=a(t),fi=n.camera||{eye:[2,0,0],center:[0,0,0],up:[0,1,0],zoomMin:.1,zoomMax:100,mode:"turntable"},gt=n.axes||{},d=u(t,gt);d.enable=!gt.disable;var ei=n.spikes||{},ut=e(t,ei),k=[],et=[],ot=[],ft=[],nt=!0,tt=!0,ni=new Array(16),st=new Array(16),it={view:null,projection:ni,model:st},tt=!0,ht=[t.drawingBufferWidth,t.drawingBufferHeight],w={gl:t,contextLost:!1,pixelRatio:n.pixelRatio||parseFloat(window.devicePixelRatio),canvas:g,selection:b,camera:r(g,fi),axes:d,axesPixels:null,spikes:ut,bounds:ui,objects:k,shape:ht,aspect:n.aspectRatio||[1,1,1],pickRadius:n.pickRadius||10,zNear:n.zNear||.01,zFar:n.zFar||1e3,fovy:n.fovy||Math.PI/4,clearColor:n.clearColor||[0,0,0,0],autoResize:i(n.autoResize),autoBounds:i(n.autoBounds),autoScale:!!n.autoScale,autoCenter:i(n.autoCenter),clipToBounds:i(n.clipToBounds),snapToData:!!n.snapToData,onselect:n.onselect||null,onrender:n.onrender||null,onclick:n.onclick||null,cameraParams:it,oncontextloss:null,mouseListener:null},vt=[t.drawingBufferWidth/w.pixelRatio|0,t.drawingBufferHeight/w.pixelRatio|0];return w.autoResize&&yt(),window.addEventListener("resize",yt),w.update=function(n){rt||(n=n||{},nt=!0,tt=!0)},w.add=function(n){rt||(n.axes=d,k.push(n),et.push(-1),nt=!0,tt=!0,ti())},w.remove=function(n){if(!rt){var t=k.indexOf(n);t<0||(k.splice(t,1),et.pop(),nt=!0,tt=!0,ti())}},w.dispose=function(){var n;if(!rt&&(rt=!0,window.removeEventListener("resize",yt),g.removeEventListener("webglcontextlost",bt),w.mouseListener.enabled=!1,!w.contextLost)){for(d.dispose(),ut.dispose(),n=0;n<k.length;++n)k[n].dispose();for(at.dispose(),n=0;n<ft.length;++n)ft[n].dispose();kt.dispose();t=null;d=null;ut=null;k=[]}},pt=!1,wt=0,w.mouseListener=c(g,function(n,t,i){var e,o,r,s,h,u;if(!rt){var c=ft.length,l=k.length,f=b.object;if(b.distance=Infinity,b.mouse[0]=t,b.mouse[1]=i,b.object=null,b.screen=null,b.dataCoordinate=b.dataPosition=null,e=!1,n&&wt)pt=!0;else for(pt&&(tt=!0),pt=!1,o=0;o<c;++o)if(r=ft[o].query(t,vt[1]-i-1,w.pickRadius),r){if(r.distance>b.distance)continue;for(s=0;s<l;++s)(h=k[s],et[s]===o)&&(u=h.pick(r),u&&(b.buttons=n,b.screen=r.coord,b.distance=r.distance,b.object=h,b.index=u.distance,b.dataPosition=u.position,b.dataCoordinate=u.dataCoordinate,b.data=u,e=!0))}if(f&&f!==b.object&&(f.highlight&&f.highlight(null),nt=!0),b.object&&(b.object.highlight&&b.object.highlight(b.data),nt=!0),e=e||b.object!==f,e&&w.onselect)w.onselect(b);if(n&1&&!(wt&1)&&w.onclick)w.onclick(b);wt=n}}),g.addEventListener("webglcontextlost",bt),ct=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]],lt=[ct[0].slice(),ct[1].slice()],ri(),w.redraw=function(){rt||(nt=!0,ii())},w}t.exports=w;var r=n("3d-view-controls"),u=n("gl-axes3d"),f=n("gl-axes3d/properties"),e=n("gl-spikes3d"),o=n("gl-select-static"),s=n("gl-fbo"),h=n("a-big-triangle"),c=n("mouse-change"),l=n("gl-mat4/perspective"),a=n("./lib/shader")},{"./lib/shader":200,"3d-view-controls":201,"a-big-triangle":203,"gl-axes3d":204,"gl-axes3d/properties":214,"gl-fbo":139,"gl-mat4/perspective":156,"gl-select-static":276,"gl-spikes3d":216,"mouse-change":513}],218:[function(n,t,i){i.pointVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}";i.pointFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n";i.pickVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n";i.pickFragment="precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"},{}],219:[function(n,t,i){arguments[4][181][0].apply(i,arguments)},{"./lib/GLError":220,"./lib/create-attributes":221,"./lib/create-uniforms":222,"./lib/reflect":223,"./lib/runtime-reflect":224,"./lib/shader-cache":225,dup:181}],220:[function(n,t,i){arguments[4][182][0].apply(i,arguments)},{dup:182}],221:[function(n,t,i){arguments[4][183][0].apply(i,arguments)},{"./GLError":220,dup:183}],222:[function(n,t,i){arguments[4][184][0].apply(i,arguments)},{"./GLError":220,"./reflect":223,dup:184}],223:[function(n,t,i){arguments[4][185][0].apply(i,arguments)},{dup:185}],224:[function(n,t,i){arguments[4][186][0].apply(i,arguments)},{dup:186}],225:[function(n,t,i){arguments[4][187][0].apply(i,arguments)},{"./GLError":220,dup:187,"gl-format-compiler-error":226,"weakmap-shim":244}],226:[function(n,t,i){arguments[4][188][0].apply(i,arguments)},{"add-line-numbers":227,dup:188,"gl-constants/lookup":231,"glsl-shader-name":232,"sprintf-js":241}],227:[function(n,t,i){arguments[4][189][0].apply(i,arguments)},{dup:189,"pad-left":228}],228:[function(n,t,i){arguments[4][190][0].apply(i,arguments)},{dup:190,"repeat-string":229}],229:[function(n,t){
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */
function u(n,t){if(typeof n!="string")throw new TypeError("repeat-string expects a string.");if(t===1)return n;if(t===2)return n+n;var u=n.length*t;for((r!==n||typeof r=="undefined")&&(r=n,i="");u>i.length&&t>0;){if(t&1&&(i+=n),t>>=1,!t)break;n+=n}return i.substr(0,u)}"use strict";var i="",r;t.exports=u},{}],230:[function(n,t,i){arguments[4][191][0].apply(i,arguments)},{dup:191}],231:[function(n,t,i){arguments[4][192][0].apply(i,arguments)},{"./1.0/numbers":230,dup:192}],232:[function(n,t,i){arguments[4][193][0].apply(i,arguments)},{"atob-lite":233,dup:193,"glsl-tokenizer":240}],233:[function(n,t,i){arguments[4][194][0].apply(i,arguments)},{dup:194}],234:[function(n,t){function tt(n){function ft(n){n.length&&ht.push({type:nt[rt],data:n,position:et,line:yt,column:ct})}function dt(n){tt=0;st+=n;bt=st.length;for(var e;t=st[tt],tt<bt;){e=tt;switch(rt){case u:tt=ri();break;case f:tt=ii();break;case s:tt=kt();break;case h:tt=ui();break;case c:tt=ei();break;case a:tt=fi();break;case r:tt=oi();break;case o:tt=si();break;case l:tt=ti();break;case i:tt=ni()}if(e!==tt)switch(st[e]){case"\n":ct=0;++yt;break;default:++ct}}return ot+=tt,st=st.slice(tt),ht}function gt(){return it.length&&ft(it.join("")),rt=g,ft("(eof)"),ht}function ni(){return(it=it.length?[]:it,ut==="/"&&t==="*")?(et=ot+tt-1,rt=u,ut=t,tt+1):ut==="/"&&t==="/"?(et=ot+tt-1,rt=f,ut=t,tt+1):t==="#"?(rt=s,et=ot+tt,tt):/\s/.test(t)?(rt=l,et=ot+tt,tt):(pt=/\d/.test(t),wt=/[^\w_]/.test(t),et=ot+tt,rt=pt?c:wt?h:o,tt)}function ti(){return/[^\s]/g.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function kt(){return(t==="\r"||t==="\n")&&ut!=="\\"?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function ii(){return kt()}function ri(){return t==="/"&&ut==="*"?(it.push(t),ft(it.join("")),rt=i,tt+1):(it.push(t),ut=t,tt+1)}function ui(){if(ut==="."&&/\d/.test(t))return rt=r,tt;if(ut==="/"&&t==="*")return rt=u,tt;if(ut==="/"&&t==="/")return rt=f,tt;if(t==="."&&it.length){while(vt(it));return rt=r,tt}if(t===";"||t===")"||t==="("){if(it.length)while(vt(it));return ft(t),rt=i,tt+1}var n=it.length===2&&t!=="=";if(/[\w_\d\s]/.test(t)||n){while(vt(it));return rt=i,tt}return it.push(t),ut=t,tt+1}function vt(n){var r=0,i,t;do{if(i=e.indexOf(n.slice(0,n.length+r).join("")),t=e[i],i===-1){if(r--+n.length>0)continue;t=n.slice(0,1).join("")}return ft(t),et+=t.length,it=it.slice(t.length),it.length}while(1)}function fi(){return/[^a-fA-F0-9]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function ei(){return t==="."?(it.push(t),rt=r,ut=t,tt+1):/[eE]/.test(t)?(it.push(t),rt=r,ut=t,tt+1):t==="x"&&it.length===1&&it[0]==="0"?(rt=a,it.push(t),ut=t,tt+1):/[^\d]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function oi(){return(t==="f"&&(it.push(t),ut=t,tt+=1),/[eE]/.test(t))?(it.push(t),ut=t,tt+1):t==="-"&&/[eE]/.test(ut)?(it.push(t),ut=t,tt+1):/[^\d]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function si(){if(/[^\d\w_]/.test(t)){var n=it.join("");return rt=at.indexOf(n)>-1?d:lt.indexOf(n)>-1?k:b,ft(it.join("")),rt=i,tt}return it.push(t),ut=t,tt+1}var tt=0,ot=0,rt=i,t,ut,it=[],ht=[],yt=1,ct=0,et=0,pt=!1,wt=!1,st="",bt,lt,at;return n=n||{},lt=y,at=v,n.version==="300 es"&&(lt=w,at=p),function(n){return(ht=[],n!==null)?dt(n.replace?n.replace(/\r\n/g,"\n"):n):gt()}}t.exports=tt;var v=n("./lib/literals"),e=n("./lib/operators"),y=n("./lib/builtins"),p=n("./lib/literals-300es"),w=n("./lib/builtins-300es"),i=999,o=9999,u=0,f=1,s=2,h=3,c=4,r=5,b=6,k=7,d=8,l=9,g=10,a=11,nt=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":236,"./lib/builtins-300es":235,"./lib/literals":238,"./lib/literals-300es":237,"./lib/operators":239}],235:[function(n,t){var i=n("./builtins");i=i.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)});t.exports=i.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":236}],236:[function(n,t){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],237:[function(n,t){var i=n("./literals");t.exports=i.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":238}],238:[function(n,t){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],239:[function(n,t){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],240:[function(n,t){function r(n,t){var u=i(t),r=[];return r=r.concat(u(n)),r.concat(u(null))}var i=n("./index");t.exports=r},{"./index":234}],241:[function(n,t,i){arguments[4][195][0].apply(i,arguments)},{dup:195}],242:[function(n,t,i){arguments[4][196][0].apply(i,arguments)},{"./hidden-store.js":243,dup:196}],243:[function(n,t,i){arguments[4][197][0].apply(i,arguments)},{dup:197}],244:[function(n,t,i){arguments[4][198][0].apply(i,arguments)},{"./create-store.js":242,dup:198}],245:[function(n,t){"use strict";function o(n,t,i,r,u){this.plot=n;this.offsetBuffer=t;this.pickBuffer=i;this.shader=r;this.pickShader=u;this.sizeMin=.5;this.sizeMinCap=2;this.sizeMax=20;this.areaRatio=1;this.pointCount=0;this.color=[1,0,0,1];this.borderColor=[0,0,0,1];this.blend=!1;this.pickOffset=0;this.points=null}function s(n,t){for(var f=0,e=n.length>>>1,r,u,i=0;i<e;i++)r=n[i*2],u=n[i*2+1],r>=t[0]&&r<=t[2]&&u>=t[1]&&u<=t[3]&&f++;return f}function h(n,t){var i=n.gl,s=e(i),h=e(i),c=f(i,u.pointVertex,u.pointFragment),l=f(i,u.pickVertex,u.pickFragment),r=new o(n,s,h,c,l);return r.update(t),n.addObject(r),r}var f=n("gl-shader"),e=n("gl-buffer"),r=n("typedarray-pool"),u=n("./lib/shader"),i;t.exports=h;i=o.prototype;i.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.offsetBuffer.dispose();this.pickBuffer.dispose();this.plot.removeObject(this)};i.update=function(n){function t(t,i){return t in n?n[t]:i}var i;n=n||{};this.sizeMin=t("sizeMin",.5);this.sizeMax=t("sizeMax",20);this.color=t("color",[1,0,0,1]).slice();this.areaRatio=t("areaRatio",1);this.borderColor=t("borderColor",[0,0,0,1]).slice();this.blend=t("blend",!1);var f=n.positions.length>>>1,o=n.positions instanceof Float32Array,s=n.idToIndex instanceof Int32Array&&n.idToIndex.length>=f,u=n.positions,e=o?u:r.mallocFloat32(u.length),h=s?n.idToIndex:r.mallocInt32(f);if(o||e.set(u),!s)for(e.set(u),i=0;i<f;i++)h[i]=i;this.points=u;this.offsetBuffer.update(e);this.pickBuffer.update(h);o||r.free(e);s||r.free(h);this.pointCount=f;this.pickOffset=0};i.unifiedDraw=function(){var n=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(i){var h=i!==void 0,u=h?this.pickShader:this.shader,r=this.plot.gl,f=this.plot.dataBox,e,o;if(this.pointCount===0)return i;var c=f[2]-f[0],l=f[3]-f[1],v=s(this.points,f),a=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(v,.33333)));return n[0]=2/c,n[4]=2/l,n[6]=-2*f[0]/c-1,n[7]=-2*f[1]/l-1,this.offsetBuffer.bind(),u.bind(),u.attributes.position.pointer(),u.uniforms.matrix=n,u.uniforms.color=this.color,u.uniforms.borderColor=this.borderColor,u.uniforms.pointCloud=a<5,u.uniforms.pointSize=a,u.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),h&&(t[0]=i&255,t[1]=i>>8&255,t[2]=i>>16&255,t[3]=i>>24&255,this.pickBuffer.bind(),u.attributes.pickId.pointer(r.UNSIGNED_BYTE),u.uniforms.pickOffset=t,this.pickOffset=i),e=r.getParameter(r.BLEND),o=r.getParameter(r.DITHER),e&&!this.blend&&r.disable(r.BLEND),o&&r.disable(r.DITHER),r.drawArrays(r.POINTS,0,this.pointCount),e&&!this.blend&&r.enable(r.BLEND),o&&r.enable(r.DITHER),i+this.pointCount}}();i.draw=i.unifiedDraw;i.drawPick=i.unifiedDraw;i.pick=function(n,t,i){var u=this.pickOffset,e=this.pointCount,r,f;return i<u||i>=u+e?null:(r=i-u,f=this.points,{object:this,pointId:r,dataCoord:[f[2*r],f[2*r+1]]})}},{"./lib/shader":218,"gl-buffer":134,"gl-shader":219,"typedarray-pool":550}],246:[function(n,t){"use strict";t.exports={vertex:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec2 position;\r\nattribute vec2 offset;\r\nattribute vec4 color;\r\n\r\nuniform mat3 viewTransform;\r\nuniform vec2 pixelScale;\r\n\r\nvarying vec4 fragColor;\r\n\r\nvec4 computePosition_1_0(vec2 position, vec2 offset, mat3 view, vec2 scale) {\r\n  vec3 xposition = view * vec3(position, 1.0);\r\n  return vec4(\r\n    xposition.xy + scale * offset * xposition.z,\r\n    0,\r\n    xposition.z);\r\n}\r\n\r\n\n\n\r\nvoid main() {\r\n  fragColor = color;\r\n\r\n  gl_Position = computePosition_1_0(\r\n    position,\r\n    offset,\r\n    viewTransform,\r\n    pixelScale);\r\n}\r\n",fragment:"precision lowp float;\n#define GLSLIFY 1\r\nvarying vec4 fragColor;\r\nvoid main() {\r\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\r\n}\r\n",pickVertex:"precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec2 position;\r\nattribute vec2 offset;\r\nattribute vec4 id;\r\n\r\nuniform mat3 viewTransform;\r\nuniform vec2 pixelScale;\r\nuniform vec4 pickOffset;\r\n\r\nvarying vec4 fragColor;\r\n\r\nvec4 computePosition_1_0(vec2 position, vec2 offset, mat3 view, vec2 scale) {\r\n  vec3 xposition = view * vec3(position, 1.0);\r\n  return vec4(\r\n    xposition.xy + scale * offset * xposition.z,\r\n    0,\r\n    xposition.z);\r\n}\r\n\r\n\n\n\r\nvoid main() {\r\n  vec4 fragId = id + pickOffset;\r\n\r\n  fragId.y += floor(fragId.x / 256.0);\r\n  fragId.x -= floor(fragId.x / 256.0) * 256.0;\r\n\r\n  fragId.z += floor(fragId.y / 256.0);\r\n  fragId.y -= floor(fragId.y / 256.0) * 256.0;\r\n\r\n  fragId.w += floor(fragId.z / 256.0);\r\n  fragId.z -= floor(fragId.z / 256.0) * 256.0;\r\n\r\n  fragColor = fragId / 255.0;\r\n\r\n  gl_Position = computePosition_1_0(\r\n    position,\r\n    offset,\r\n    viewTransform,\r\n    pixelScale);\r\n}\r\n",pickFragment:"precision lowp float;\n#define GLSLIFY 1\r\nvarying vec4 fragColor;\r\nvoid main() {\r\n  gl_FragColor = fragColor;\r\n}\r\n"}},{}],247:[function(n,t,i){arguments[4][181][0].apply(i,arguments)},{"./lib/GLError":248,"./lib/create-attributes":249,"./lib/create-uniforms":250,"./lib/reflect":251,"./lib/runtime-reflect":252,"./lib/shader-cache":253,dup:181}],248:[function(n,t,i){arguments[4][182][0].apply(i,arguments)},{dup:182}],249:[function(n,t,i){arguments[4][183][0].apply(i,arguments)},{"./GLError":248,dup:183}],250:[function(n,t,i){arguments[4][184][0].apply(i,arguments)},{"./GLError":248,"./reflect":251,dup:184}],251:[function(n,t,i){arguments[4][185][0].apply(i,arguments)},{dup:185}],252:[function(n,t,i){arguments[4][186][0].apply(i,arguments)},{dup:186}],253:[function(n,t,i){arguments[4][187][0].apply(i,arguments)},{"./GLError":248,dup:187,"gl-format-compiler-error":254,"weakmap-shim":264}],254:[function(n,t,i){arguments[4][188][0].apply(i,arguments)},{"add-line-numbers":255,dup:188,"gl-constants/lookup":258,"glsl-shader-name":259,"sprintf-js":261}],255:[function(n,t,i){arguments[4][189][0].apply(i,arguments)},{dup:189,"pad-left":256}],256:[function(n,t,i){arguments[4][190][0].apply(i,arguments)},{dup:190,"repeat-string":526}],257:[function(n,t,i){arguments[4][191][0].apply(i,arguments)},{dup:191}],258:[function(n,t,i){arguments[4][192][0].apply(i,arguments)},{"./1.0/numbers":257,dup:192}],259:[function(n,t,i){arguments[4][193][0].apply(i,arguments)},{"atob-lite":260,dup:193,"glsl-tokenizer":314}],260:[function(n,t,i){arguments[4][194][0].apply(i,arguments)},{dup:194}],261:[function(n,t,i){arguments[4][195][0].apply(i,arguments)},{dup:195}],262:[function(n,t,i){arguments[4][196][0].apply(i,arguments)},{"./hidden-store.js":263,dup:196}],263:[function(n,t,i){arguments[4][197][0].apply(i,arguments)},{dup:197}],264:[function(n,t,i){arguments[4][198][0].apply(i,arguments)},{"./create-store.js":262,dup:198}],265:[function(n,t){"use strict";function h(n){var u,f,r;if(n in e)return e[n];var o=a(n,{polygons:!0,font:"sans-serif",textAlign:"left",textBaseline:"alphabetic"}),t=[],i=[];for(o.forEach(function(n){n.forEach(function(n){for(var s=0;s<n.length;++s){var e=n[(s+n.length-1)%n.length],r=n[s],o=n[(s+1)%n.length],l=n[(s+2)%n.length],u=r[0]-e[0],f=r[1]-e[1],a=Math.sqrt(u*u+f*f);u/=a;f/=a;t.push(e[0],e[1]+1.4);i.push(f,-u);t.push(e[0],e[1]+1.4);i.push(-f,u);t.push(r[0],r[1]+1.4);i.push(-f,u);t.push(r[0],r[1]+1.4);i.push(-f,u);t.push(e[0],e[1]+1.4);i.push(f,-u);t.push(r[0],r[1]+1.4);i.push(f,-u);var h=l[0]-o[0],c=l[1]-o[1],v=Math.sqrt(h*h+c*c);h/=v;c/=v;t.push(r[0],r[1]+1.4);i.push(f,-u);t.push(r[0],r[1]+1.4);i.push(-f,u);t.push(o[0],o[1]+1.4);i.push(-c,h);t.push(o[0],o[1]+1.4);i.push(-c,h);t.push(r[0],r[1]+1.4);i.push(c,-h);t.push(o[0],o[1]+1.4);i.push(c,-h)}})}),u=[Infinity,Infinity,-Infinity,-Infinity],f=0;f<t.length;f+=2)for(r=0;r<2;++r)u[r]=Math.min(u[r],t[f+r]),u[2+r]=Math.max(u[2+r],t[f+r]);return e[n]={coords:t,normals:i,bounds:u}}function l(n,t,i,r,u,f,e){this.plot=n;this.shader=t;this.pickShader=i;this.positionBuffer=r;this.offsetBuffer=u;this.colorBuffer=f;this.idBuffer=e;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.numPoints=0;this.numVertices=0;this.pickOffset=0;this.points=null}function y(n,t){var i=n.gl,e=o(i,f.vertex,f.fragment),s=o(i,f.pickVertex,f.pickFragment),h=u(i),c=u(i),a=u(i),v=u(i),r=new l(n,e,s,h,c,a,v);return r.update(t),n.addObject(r),r}var c,v,r;t.exports=y;var o=n("gl-shader"),u=n("gl-buffer"),s=n("text-cache"),i=n("typedarray-pool"),a=n("vectorize-text"),f=n("./lib/shaders"),e={};c=9;v=c*4;r=l.prototype,function(){function u(){var f=this.plot,i=this.bounds,u=f.viewBox,r=f.dataBox,e=f.pixelRatio,l=i[2]-i[0],a=i[3]-i[1],o=r[2]-r[0],s=r[3]-r[1],h,c;n[0]=2*l/o;n[4]=2*a/s;n[6]=2*(i[0]-r[0])/o-1;n[7]=2*(i[1]-r[1])/s-1;h=u[2]-u[0];c=u[3]-u[1];t[0]=2*e/h;t[1]=2*e/c}var n=[1,0,0,0,1,0,0,0,1],t=[1,1],i;r.draw=function(){var e=this.plot,i=this.shader,f=this.numVertices,r;f&&(r=e.gl,u.call(this),i.bind(),i.uniforms.pixelScale=t,i.uniforms.viewTransform=n,this.positionBuffer.bind(),i.attributes.position.pointer(),this.offsetBuffer.bind(),i.attributes.offset.pointer(),this.colorBuffer.bind(),i.attributes.color.pointer(r.UNSIGNED_BYTE,!0),r.drawArrays(r.TRIANGLES,0,f))};i=[0,0,0,0];r.drawPick=function(r){var h=this.plot,f=this.pickShader,s=this.numVertices,o=h.gl,e;if(this.pickOffset=r,!s)return r;for(e=0;e<4;++e)i[e]=r>>e*8&255;return u.call(this),f.bind(),f.uniforms.pixelScale=t,f.uniforms.viewTransform=n,f.uniforms.pickOffset=i,this.positionBuffer.bind(),f.attributes.position.pointer(),this.offsetBuffer.bind(),f.attributes.offset.pointer(),this.idBuffer.bind(),f.attributes.id.pointer(o.UNSIGNED_BYTE,!1),o.drawArrays(o.TRIANGLES,0,s),r+this.numPoints}}();r.pick=function(n,t,i){var u=this.pickOffset,e=this.numPoints,r,f;return i<u||i>=u+e?null:(r=i-u,f=this.points,{object:this,pointId:r,dataCoord:[f[2*r],f[2*r+1]]})};r.update=function(n){var f,l,t,rt,r;n=n||{};var y=n.positions||[],p=n.colors||[],c=n.glyphs||[],st=n.sizes||[],ht=n.borderWidths||[],w=n.borderColors||[];for(this.points=y,f=this.bounds=[Infinity,Infinity,-Infinity,-Infinity],l=0,t=0;t<c.length;++t)for(l+=s("sans-serif",c[t]).data.length+h(c[t]).coords.length>>1,r=0;r<2;++r)f[r]=Math.min(f[r],y[2*t+r]),f[2+r]=Math.max(f[2+r],y[2*t+r]);f[0]===f[2]&&(f[2]+=1);f[3]===f[1]&&(f[3]+=1);var ct=1/(f[2]-f[0]),lt=1/(f[3]-f[1]),at=f[0],vt=f[1],a=i.mallocFloat32(2*l),v=i.mallocFloat32(2*l),e=i.mallocUint8(4*l),b=i.mallocUint32(l),u=0;for(t=0;t<c.length;++t){var d=s("sans-serif",c[t]),o=h(c[t]),ut=ct*(y[2*t]-at),ft=lt*(y[2*t+1]-vt),k=st[t],g=p[4*t]*255,nt=p[4*t+1]*255,tt=p[4*t+2]*255,it=p[4*t+3]*255,et=.5*(o.bounds[0]+o.bounds[2]),ot=.5*(o.bounds[1]+o.bounds[3]);for(r=0;r<d.data.length;r+=2)a[2*u]=ut,a[2*u+1]=ft,v[2*u]=-k*(d.data[r]-et),v[2*u+1]=-k*(d.data[r+1]-ot),e[4*u]=g,e[4*u+1]=nt,e[4*u+2]=tt,e[4*u+3]=it,b[u]=t,u+=1;for(rt=ht[t],g=w[4*t]*255,nt=w[4*t+1]*255,tt=w[4*t+2]*255,it=w[4*t+3]*255,r=0;r<o.coords.length;r+=2)a[2*u]=ut,a[2*u+1]=ft,v[2*u]=-(k*(o.coords[r]-et)+rt*o.normals[r]),v[2*u+1]=-(k*(o.coords[r+1]-ot)+rt*o.normals[r+1]),e[4*u]=g,e[4*u+1]=nt,e[4*u+2]=tt,e[4*u+3]=it,b[u]=t,u+=1}this.numPoints=c.length;this.numVertices=l;this.positionBuffer.update(a);this.offsetBuffer.update(v);this.colorBuffer.update(e);this.idBuffer.update(b);i.free(a);i.free(v);i.free(e);i.free(b)};r.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.positionBuffer.dispose();this.offsetBuffer.dispose();this.colorBuffer.dispose();this.idBuffer.dispose();this.plot.removeObject(this)}},{"./lib/shaders":246,"gl-buffer":134,"gl-shader":247,"text-cache":545,"typedarray-pool":550,"vectorize-text":552}],266:[function(n,t,i){i.pointVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute float weight;\n\nuniform mat3 matrix;\nuniform float pointSize, useWeight;\n\nvarying float fragWeight;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n  fragWeight = mix(1.0, weight, useWeight);\n}\n";i.pointFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\n\nvarying float fragWeight;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float radius = length(2.0*gl_PointCoord.xy-1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  vec4 baseColor = mix(borderColor, color, smoothStep(radius, centerFraction));\n  float alpha = 1.0 - pow(1.0 - baseColor.a, fragWeight);\n  gl_FragColor = vec4(baseColor.rgb * alpha, alpha);\n}\n";i.pickVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n";i.pickFragment="precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0*gl_PointCoord.xy-1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"},{}],267:[function(n,t,i){arguments[4][78][0].apply(i,arguments)},{dup:78}],268:[function(n,t){"use strict";function c(n,t,i,f,o){o<=4*r?u(0,o-1,n,t,i,f):e(0,o-1,n,t,i,f)}function u(n,t,i,r,u,f){for(var s,h,o=n+1;o<=t;++o){for(var c=i[o],l=r[2*o],a=r[2*o+1],v=u[o],y=f[o],e=o;e>n;){if(s=i[e-1],h=r[2*(e-1)],(s-c||l-h)>=0)break;i[e]=s;r[2*e]=h;r[2*e+1]=r[2*e-1];u[e]=u[e-1];f[e]=f[e-1];e-=1}i[e]=c;r[2*e]=l;r[2*e+1]=a;u[e]=v;f[e]=y}}function o(n,t,i,r,u,f){var e=i[n],o=r[2*n],s=r[2*n+1],h=u[n],c=f[n];i[n]=i[t];r[2*n]=r[2*t];r[2*n+1]=r[2*t+1];u[n]=u[t];f[n]=f[t];i[t]=e;r[2*t]=o;r[2*t+1]=s;u[t]=h;f[t]=c}function s(n,t,i,r,u,f){i[n]=i[t];r[2*n]=r[2*t];r[2*n+1]=r[2*t+1];u[n]=u[t];f[n]=f[t]}function l(n,t,i,r,u,f,e){var o=r[n],s=u[2*n],h=u[2*n+1],c=f[n],l=e[n];r[n]=r[t];u[2*n]=u[2*t];u[2*n+1]=u[2*t+1];f[n]=f[t];e[n]=e[t];r[t]=r[i];u[2*t]=u[2*i];u[2*t+1]=u[2*i+1];f[t]=f[i];e[t]=e[i];r[i]=o;u[2*i]=s;u[2*i+1]=h;f[i]=c;e[i]=l}function h(n,t,i,r,u,f,e,o,s,h,c){o[n]=o[t];s[2*n]=s[2*t];s[2*n+1]=s[2*t+1];h[n]=h[t];c[n]=c[t];o[t]=i;s[2*t]=r;s[2*t+1]=u;h[t]=f;c[t]=e}function i(n,t,i,r,u){return(i[n]-i[t]||r[2*t]-r[2*n]||u[n]-u[t])<0}function f(n,t,i,r,u,f,e,o){return(t-f[n]||e[2*n]-i||u-o[n])<0}function e(n,t,c,a,v,y){var ut=(t-n+1)/6|0,gt=n+ut,ni=t-ut,ft=n+t>>1,ti=ft-ut,ii=ft+ut,nt=gt,w=ti,d=ft,b=ii,tt=ni,g=n+1,k=t-1,p=0,rt,it;i(nt,w,c,a,v,y)&&(p=nt,nt=w,w=p);i(b,tt,c,a,v,y)&&(p=b,b=tt,tt=p);i(nt,d,c,a,v,y)&&(p=nt,nt=d,d=p);i(w,d,c,a,v,y)&&(p=w,w=d,d=p);i(nt,b,c,a,v,y)&&(p=nt,nt=b,b=p);i(d,b,c,a,v,y)&&(p=d,d=b,b=p);i(w,tt,c,a,v,y)&&(p=w,w=tt,tt=p);i(w,d,c,a,v,y)&&(p=w,w=d,d=p);i(b,tt,c,a,v,y)&&(p=b,b=tt,tt=p);var at=c[w],vt=a[2*w],yt=a[2*w+1],pt=v[w],ri=y[w],wt=c[b],bt=a[2*b],kt=a[2*b+1],dt=v[b],ui=y[b],et=nt,ot=d,st=tt,ht=gt,ct=ft,lt=ni,fi=c[et],ei=c[ot],oi=c[st];for(c[ht]=fi,c[ct]=ei,c[lt]=oi,rt=0;rt<2;++rt){var si=a[2*et+rt],hi=a[2*ot+rt],ci=a[2*st+rt];a[2*ht+rt]=si;a[2*ct+rt]=hi;a[2*lt+rt]=ci}var li=v[et],ai=v[ot],vi=v[st];v[ht]=li;v[ct]=ai;v[lt]=vi;var yi=y[et],pi=y[ot],wi=y[st];for(y[ht]=yi,y[ct]=pi,y[lt]=wi,s(ti,n,c,a,v,y),s(ii,t,c,a,v,y),it=g;it<=k;++it)if(f(it,at,vt,yt,pt,c,a,v))it!==g&&o(it,g,c,a,v,y),++g;else if(!f(it,wt,bt,kt,dt,c,a,v))for(;;)if(f(k,wt,bt,kt,dt,c,a,v)){f(k,at,vt,yt,pt,c,a,v)?(l(it,g,k,c,a,v,y),++g,--k):(o(it,k,c,a,v,y),--k);break}else{if(--k<it)break;continue}h(n,g-1,at,vt,yt,pt,ri,c,a,v,y);h(t,k+1,wt,bt,kt,dt,ui,c,a,v,y);g-2-n<=r?u(n,g-2,c,a,v,y):e(n,g-2,c,a,v,y);t-(k+2)<=r?u(k+2,t,c,a,v,y):e(k+2,t,c,a,v,y);k-g<=r?u(g,k,c,a,v,y):e(g,k,c,a,v,y)}t.exports=c;var r=32},{}],269:[function(n,t){"use strict";function f(n,t,i,r,u,f,e,o){for(var s=i,h=i;h<r;++h){var c=n[2*h],l=n[2*h+1],a=t[h];u<=c&&c<=e&&f<=l&&l<=o&&(h===s?s+=1:(n[2*h]=n[2*s],n[2*h+1]=n[2*s+1],t[h]=t[s],n[2*s]=c,n[2*s+1]=l,t[s]=a,s+=1))}return s}function r(n,t,i){this.pixelSize=n;this.offset=t;this.count=i}function e(n,t,e,o){function g(i,r,u,o,h,c){var a=u*.5,l=o+1,nt=h-o,v,y,d;for(e[s]=nt,p[s++]=c,v=0;v<2;++v)for(y=0;y<2;++y){var w=i+v*a,b=r+y*a,k=f(n,t,l,h,w,b,w+a,b+a);k!==l&&(k-l>=Math.max(.9*nt,32)&&(d=h+o>>>1,g(w,b,a,l,d,c+1),l=d),g(w,b,a,l,k,c+1),l=k)}}var a=n.length>>>1,y,b,k,p,s,w;if(a<1)return[];var c=Infinity,l=Infinity,h=-Infinity,v=-Infinity;for(y=0;y<a;++y)b=n[2*y],k=n[2*y+1],c=Math.min(c,b),h=Math.max(h,b),l=Math.min(l,k),v=Math.max(v,k),t[y]=y;c===h&&(h+=1+Math.abs(h));l===v&&(v+=1+Math.abs(h));var rt=1/(h-c),ut=1/(v-l),d=Math.max(h-c,v-l);o=o||[0,0,0,0];o[0]=c;o[1]=l;o[2]=h;o[3]=v;p=i.mallocInt32(a);s=0;g(c,l,d,0,a,0);u(p,n,t,e,a);var nt=[],it=0,tt=a;for(s=a-1;s>=0;--s)(n[2*s]=(n[2*s]-c)*rt,n[2*s+1]=(n[2*s+1]-l)*ut,w=p[s],w!==it)&&(nt.push(new r(d*Math.pow(.5,w),s+1,tt-(s+1))),tt=s+1,it=w);return nt.push(new r(d*Math.pow(.5,w+1),0,tt)),i.free(p),nt}var i=n("typedarray-pool"),u=n("./lib/sort");t.exports=e},{"./lib/sort":268,"typedarray-pool":550}],270:[function(n,t){"use strict";function s(n,t,i,r,u,f){this.plot=n;this.offsetBuffer=t;this.pickBuffer=i;this.weightBuffer=r;this.shader=u;this.pickShader=f;this.scales=[];this.size=12;this.borderSize=1;this.pointCount=0;this.color=[1,0,0,1];this.borderColor=[0,0,0,1];this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.pickOffset=0;this.points=null;this.xCoords=null}function c(n,t){var i=n.gl,u=e(i),h=e(i),c=e(i),l=o(i,f.pointVertex,f.pointFragment),a=o(i,f.pickVertex,f.pickFragment),r=new s(n,u,h,c,l,a);return r.update(t),n.addObject(r),r}var o=n("gl-shader"),e=n("gl-buffer"),u=n("binary-search-bounds"),h=n("snap-points-2d"),i=n("typedarray-pool"),f=n("./lib/shader"),r;t.exports=c;r=s.prototype;r.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.offsetBuffer.dispose();this.pickBuffer.dispose();this.xCoords&&i.free(this.xCoords);this.plot.removeObject(this)};r.update=function(n){function u(t,i){return t in n?n[t]:i}var f,s,e,c;n=n||{};this.size=u("size",12);this.color=u("color",[1,0,0,1]).slice();this.borderSize=u("borderSize",1);this.borderColor=u("borderColor",[0,0,0,1]).slice();this.xCoords&&i.free(this.xCoords);var t=n.positions,r=i.mallocFloat32(t.length),o=i.mallocInt32(t.length>>>1);for(r.set(t),f=i.mallocFloat32(t.length),this.points=t,this.scales=h(r,o,f,this.bounds),this.offsetBuffer.update(r),this.pickBuffer.update(o),this.weightBuffer.update(f),s=i.mallocFloat32(t.length>>>1),e=0,c=0;e<t.length;e+=2,++c)s[c]=r[e];i.free(o);i.free(r);i.free(f);this.xCoords=s;this.pointCount=t.length>>>1;this.pickOffset=0};r.drawPick=function(){var n=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(i){var o=this.plot,r=this.pickShader,d=this.scales,ut=this.offsetBuffer,ft=this.pickBuffer,f=this.bounds,s=this.size,g=this.borderSize,p=o.gl,h=o.pickPixelRatio,l=o.viewBox,e=o.dataBox,c,v;if(this.pointCount===0)return i;var w=f[2]-f[0],et=f[3]-f[1],b=e[2]-e[0],k=e[3]-e[1],ot=(l[2]-l[0])*h/o.pixelRatio,st=(l[3]-l[1])*h/o.pixelRatio,a=Math.min(b/ot,k/st),lt=a;n[0]=2*w/b;n[4]=2*et/k;n[6]=2*(f[0]-e[0])/b-1;n[7]=2*(f[1]-e[1])/k-1;this.pickOffset=i;t[0]=i&255;t[1]=i>>8&255;t[2]=i>>16&255;t[3]=i>>24&255;r.bind();r.uniforms.matrix=n;r.uniforms.color=this.color;r.uniforms.borderColor=this.borderColor;r.uniforms.pointSize=h*(s+g);r.uniforms.pickOffset=t;r.uniforms.centerFraction=this.borderSize===0?2:s/(s+g+1.25);ut.bind();r.attributes.position.pointer();ft.bind();r.attributes.pickId.pointer(p.UNSIGNED_BYTE);var nt=this.xCoords,ht=(e[0]-f[0]-a*s*h)/w,ct=(e[2]-f[0]+a*s*h)/w;for(c=d.length-1;c>=0;--c)if(v=d[c],!(v.pixelSize<a)||!(c>1)){var tt=v.offset,it=v.count+tt,y=u.ge(nt,ht,tt,it-1),rt=u.lt(nt,ct,y,it-1)+1;rt>y&&p.drawArrays(p.POINTS,y,rt-y)}return i+this.pointCount}}();r.draw=function(){var n=[1,0,0,0,1,0,0,0,1];return function(){var o=this.plot,t=this.shader,w=this.scales,rt=this.offsetBuffer,i=this.bounds,f=this.size,b=this.borderSize,k=o.gl,a=o.pixelRatio,s=o.viewBox,r=o.dataBox,e,c;if(this.pointCount!==0){var v=i[2]-i[0],ut=i[3]-i[1],y=r[2]-r[0],p=r[3]-r[1],ft=s[2]-s[0],et=s[3]-s[1],h=Math.min(y/ft,p/et),ht=h;n[0]=2*v/y;n[4]=2*ut/p;n[6]=2*(i[0]-r[0])/y-1;n[7]=2*(i[1]-r[1])/p-1;t.bind();t.uniforms.matrix=n;t.uniforms.color=this.color;t.uniforms.borderColor=this.borderColor;t.uniforms.pointSize=a*(f+b);t.uniforms.useWeight=1;t.uniforms.centerFraction=this.borderSize===0?2:f/(f+b+1.25);rt.bind();t.attributes.position.pointer();this.weightBuffer.bind();t.attributes.weight.pointer();var d=this.xCoords,ot=(r[0]-i[0]-h*f*a)/v,st=(r[2]-i[0]+h*f*a)/v,g=!0;for(e=w.length-1;e>=0;--e)if(c=w[e],!(c.pixelSize<h)||!(e>1)){var nt=c.offset,tt=c.count+nt,l=u.ge(d,ot,nt,tt-1),it=u.lt(d,st,l,tt-1)+1;it>l&&k.drawArrays(k.POINTS,l,it-l);g&&(g=!1,t.uniforms.useWeight=0)}}}}();r.pick=function(n,t,i){var u=this.pickOffset,e=this.pointCount,r,f;return i<u||i>=u+e?null:(r=i-u,f=this.points,{object:this,pointId:r,dataCoord:[f[2*r],f[2*r+1]]})}},{"./lib/shader":266,"binary-search-bounds":267,"gl-buffer":134,"gl-shader":277,"snap-points-2d":269,"typedarray-pool":550}],271:[function(n,t){"use strict";function u(n,t){var f=i[t],o,h,u;if(f||(f=i[t]={}),n in f)return f[n];var s=r(n,{textAlign:"center",textBaseline:"middle",lineHeight:1,font:t}),c=r(n,{triangles:!0,textAlign:"center",textBaseline:"middle",lineHeight:1,font:t}),e=[[Infinity,Infinity],[-Infinity,-Infinity]];for(o=0;o<s.positions.length;++o)for(h=s.positions[o],u=0;u<2;++u)e[0][u]=Math.min(e[0][u],h[u]),e[1][u]=Math.max(e[1][u],h[u]);return f[n]=[c,s,e]}var r=n("vectorize-text"),i;t.exports=u;i={}},{"vectorize-text":552}],272:[function(n,t,i){function u(n,t){var r=c(n,t),i=r.attributes;return i.position.location=0,i.color.location=1,i.glyph.location=2,i.id.location=3,r}var c=n("gl-shader"),o="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   || \n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n    \n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}",s="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    \n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}",h="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   ||\n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n",f="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   ||\n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n}\n",e="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   || \n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = vec4(pickGroup, pickId.bgr);\n  }\n}",r=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],l={vertex:o,fragment:f,attributes:r},a={vertex:s,fragment:f,attributes:r},v={vertex:h,fragment:f,attributes:r},y={vertex:o,fragment:e,attributes:r},p={vertex:s,fragment:e,attributes:r},w={vertex:h,fragment:e,attributes:r};i.createPerspective=function(n){return u(n,l)};i.createOrtho=function(n){return u(n,a)};i.createProject=function(n){return u(n,v)};i.createPickPerspective=function(n){return u(n,y)};i.createPickOrtho=function(n){return u(n,p)};i.createPickProject=function(n){return u(n,w)}},{"gl-shader":277}],273:[function(n,t){"use strict";function h(n,t){var i=n[0],r=n[1],u=n[2],f=n[3];return n[0]=t[0]*i+t[4]*r+t[8]*u+t[12]*f,n[1]=t[1]*i+t[5]*r+t[9]*u+t[13]*f,n[2]=t[2]*i+t[6]*r+t[10]*u+t[14]*f,n[3]=t[3]*i+t[7]*r+t[11]*u+t[15]*f,n}function l(n,t,i,r){return h(r,r,i),h(r,r,t),h(r,r,n)}function d(n,t){this.index=n;this.dataCoordinate=this.position=t}function a(n,t,i,r,u,f,e,o,s,h,c,l){this.gl=n;this.pixelRatio=1;this.shader=t;this.orthoShader=i;this.projectShader=r;this.pointBuffer=u;this.colorBuffer=f;this.glyphBuffer=e;this.idBuffer=o;this.vao=s;this.vertexCount=0;this.lineVertexCount=0;this.opacity=1;this.lineWidth=0;this.projectScale=[2/3,2/3,2/3];this.projectOpacity=[1,1,1];this.pickId=0;this.pickPerspectiveShader=h;this.pickOrthoShader=c;this.pickProjectShader=l;this.points=[];this._selectResult=new d(0,[0,0,0]);this.useOrtho=!0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[!0,!0,!0];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightId=[1,1,1,1];this.highlightScale=2;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.dirty=!0}function y(n){return n[0]=n[1]=n[2]=0,n}function p(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n}function w(n,t,i,r){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[i]=r,n}function ft(n){for(var t,r=ut,i=0;i<2;++i)for(t=0;t<3;++t)r[i][t]=Math.max(Math.min(n[i][t],1e8),-1e8);return r}function et(n,t,i,r){var kt=t.axesProject,ut=t.gl,e=n.uniforms,et=i.model||u,ct=i.view||u,lt=i.projection||u,pt=t.axesBounds,at=ft(t.clipBounds),wt,f,h,ot,st,ht,bt,vt,yt,s;for(wt=t.axes?t.axes.lastCubeProps.axis:[1,1,1],o[0]=2/ut.drawingBufferWidth,o[1]=2/ut.drawingBufferHeight,n.bind(),e.view=ct,e.projection=lt,e.screenSize=o,e.highlightId=t.highlightId,e.highlightScale=t.highlightScale,e.clipBounds=at,e.pickGroup=t.pickId/255,e.pixelRatio=t.pixelRatio,f=0;f<3;++f)if(kt[f]&&t.projectOpacity[f]<1===r){for(e.scale=t.projectScale[f],e.opacity=t.projectOpacity[f],h=rt,s=0;s<16;++s)h[s]=0;for(s=0;s<4;++s)h[5*s]=1;h[5*f]=0;h[12+f]=wt[f]<0?pt[0][f]:pt[1][f];k(h,et,h);e.model=h;var b=(f+1)%3,d=(f+2)%3,c=y(g),a=y(nt);for(c[b]=1,a[d]=1,ot=l(lt,ct,et,p(tt,c)),st=l(lt,ct,et,p(it,a)),Math.abs(ot[1])>Math.abs(st[1])&&(ht=ot,ot=st,st=ht,ht=c,c=a,a=ht,bt=b,b=d,d=bt),ot[0]<0&&(c[b]=-1),st[1]>0&&(a[d]=-1),vt=0,yt=0,s=0;s<4;++s)vt+=Math.pow(et[4*b+s],2),yt+=Math.pow(et[4*d+s],2);c[b]/=Math.sqrt(vt);a[d]/=Math.sqrt(yt);e.axes[0]=c;e.axes[1]=a;e.fragClipBounds[0]=w(v,at[0],f,-1e8);e.fragClipBounds[1]=w(v,at[1],f,1e8);t.vao.draw(ut.TRIANGLES,t.vertexCount);t.lineWidth>0&&(ut.lineWidth(t.lineWidth),t.vao.draw(ut.LINES,t.lineVertexCount,t.vertexCount))}}function c(n,t,i,r,f,e){var h=i.gl,s;i.vao.bind();(f===i.opacity<1||e)&&(n.bind(),s=n.uniforms,s.model=r.model||u,s.view=r.view||u,s.projection=r.projection||u,o[0]=2/h.drawingBufferWidth,o[1]=2/h.drawingBufferHeight,s.screenSize=o,s.highlightId=i.highlightId,s.highlightScale=i.highlightScale,s.fragClipBounds=ot,s.clipBounds=i.axes.bounds,s.opacity=i.opacity,s.pickGroup=i.pickId/255,s.pixelRatio=i.pixelRatio,i.vao.draw(h.TRIANGLES,i.vertexCount),i.lineWidth>0&&(h.lineWidth(i.lineWidth),i.vao.draw(h.LINES,i.lineVertexCount,i.vertexCount)));et(t,i,r,f,e);i.vao.unbind()}function st(n){var t=n.gl,h=f.createPerspective(t),c=f.createOrtho(t),l=f.createProject(t),v=f.createPickPerspective(t),y=f.createPickOrtho(t),p=f.createPickProject(t),i=s(t),r=s(t),u=s(t),e=s(t),w=b(t,[{buffer:i,size:3,type:t.FLOAT},{buffer:r,size:4,type:t.FLOAT},{buffer:u,size:2,type:t.FLOAT},{buffer:e,size:4,type:t.UNSIGNED_BYTE,normalized:!0}]),o=new a(t,h,c,l,i,r,u,e,w,v,y,p);return o.update(n),o}var s=n("gl-buffer"),b=n("gl-vao"),r=n("typedarray-pool"),k=n("gl-mat4/multiply"),f=n("./lib/shaders"),e=n("./lib/glyphs"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i;t.exports=st;i=a.prototype;i.pickSlots=1;i.setPickBase=function(n){this.pickId=n};i.isTransparent=function(){if(this.opacity<1)return!0;for(var n=0;n<3;++n)if(this.axesProject[n]&&this.projectOpacity[n]<1)return!0;return!1};i.isOpaque=function(){if(this.opacity>=1)return!0;for(var n=0;n<3;++n)if(this.axesProject[n]&&this.projectOpacity[n]>=1)return!0;return!1};var o=[0,0],g=[0,0,0],nt=[0,0,0],tt=[0,0,0,1],it=[0,0,0,1],rt=u.slice(),v=[0,0,0],ut=[[0,0,0],[0,0,0]];var ot=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];i.draw=function(n){var t=this.useOrtho?this.orthoShader:this.shader;c(t,this.projectShader,this,n,!1,!1)};i.drawTransparent=function(n){var t=this.useOrtho?this.orthoShader:this.shader;c(t,this.projectShader,this,n,!0,!1)};i.drawPick=function(n){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;c(t,this.pickProjectShader,this,n,!1,!0)};i.pick=function(n){var i,u,r,t;if(!n||n.id!==this.pickId||(i=n.value[2]+(n.value[1]<<8)+(n.value[0]<<16),i>=this.pointCount||i<0))return null;for(u=this.points[i],r=this._selectResult,r.index=i,t=0;t<3;++t)r.position[t]=r.dataCoordinate[t]=u[t];return r};i.highlight=function(n){if(n){var t=n.index,i=t&255,r=t>>8&255,u=t>>16&255;this.highlightId=[i/255,r/255,u/255,0]}else this.highlightId=[1,1,1,1]};i.update=function(n){var st,h,c,u,f,a,o,p,ot,tt,dt,t,gt,w,i,s;if(n=n||{},"perspective"in n&&(this.useOrtho=!n.perspective),"orthographic"in n&&(this.useOrtho=!!n.orthographic),"lineWidth"in n&&(this.lineWidth=n.lineWidth),"project"in n&&(Array.isArray(n.project)?this.axesProject=n.project:(st=!!n.project,this.axesProject=[st,st,st])),"projectScale"in n&&(Array.isArray(n.projectScale)?this.projectScale=n.projectScale.slice():(h=+n.projectScale,this.projectScale=[h,h,h])),"projectOpacity"in n&&(Array.isArray(n.projectOpacity)?this.projectOpacity=n.projectOpacity.slice():(h=+n.projectOpacity,this.projectOpacity=[h,h,h])),"opacity"in n&&(this.opacity=n.opacity),this.dirty=!0,c=n.position,c){var b=n.font||"normal",it=n.alignment||[0,0],rt=[Infinity,Infinity,Infinity],ut=[-Infinity,-Infinity,-Infinity],l=n.glyph,ft=n.color,ht=n.size,ct=n.angle,et=n.lineColor,lt=0,at=0,ni=0,ri=c.length;n:for(u=0;u<ri;++u){for(f=c[u],t=0;t<3;++t)if(isNaN(f[t])||!isFinite(f[t]))continue n;a=Array.isArray(l)?e(l[u],b):l?e(l,b):e("●",b);var ti=a[0],ii=a[1],ui=a[2];at+=ti.cells.length*3;ni+=ii.edges.length*2}var vt=at+ni,yt=r.mallocFloat(3*vt),pt=r.mallocFloat(4*vt),k=r.mallocFloat(2*vt),wt=r.mallocUint32(vt),d=[0,it[1]],g=0,nt=at,v=[0,0,0,1],y=[0,0,0,1],fi=Array.isArray(ft)&&Array.isArray(ft[0]),ei=Array.isArray(et)&&Array.isArray(et[0]);n:for(u=0;u<ri;++u){for(f=c[u],t=0;t<3;++t){if(isNaN(f[t])||!isFinite(f[t])){lt+=1;continue n}ut[t]=Math.max(ut[t],f[t]);rt[t]=Math.min(rt[t],f[t])}a=Array.isArray(l)?e(l[u],b):l?e(l,b):e("●",b);var ti=a[0],ii=a[1],ui=a[2];if(Array.isArray(ft)){if(o=fi?ft[u]:ft,o.length===3){for(t=0;t<3;++t)v[t]=o[t];v[3]=1}else if(o.length===4)for(t=0;t<4;++t)v[t]=o[t]}else v[0]=v[1]=v[2]=0,v[3]=1;if(Array.isArray(et)){if(o=ei?et[u]:et,o.length===3){for(t=0;t<3;++t)y[t]=o[t];y[t]=1}else if(o.length===4)for(t=0;t<4;++t)y[t]=o[t]}else y[0]=y[1]=y[2]=0,y[3]=1;p=.5;Array.isArray(ht)?p=+ht[u]:ht?p=+ht:this.useOrtho&&(p=12);ot=0;Array.isArray(ct)?ot=+ct[u]:ct&&(ot=+ct);var bt=Math.cos(ot),kt=Math.sin(ot),f=c[u];for(t=0;t<3;++t)ut[t]=Math.max(ut[t],f[t]),rt[t]=Math.min(rt[t],f[t]);for(it[0]<0?d[0]=it[0]*(1+ui[1][0]):it[0]>0&&(d[0]=-it[0]*(1+ui[0][0])),tt=ti.cells,dt=ti.positions,t=0;t<tt.length;++t)for(gt=tt[t],w=0;w<3;++w){for(i=0;i<3;++i)yt[3*g+i]=f[i];for(i=0;i<4;++i)pt[4*g+i]=v[i];wt[g]=lt;s=dt[gt[w]];k[2*g]=p*(bt*s[0]-kt*s[1]+d[0]);k[2*g+1]=p*(kt*s[0]+bt*s[1]+d[1]);g+=1}for(tt=ii.edges,dt=ii.positions,t=0;t<tt.length;++t)for(gt=tt[t],w=0;w<2;++w){for(i=0;i<3;++i)yt[3*nt+i]=f[i];for(i=0;i<4;++i)pt[4*nt+i]=y[i];wt[nt]=lt;s=dt[gt[w]];k[2*nt]=p*(bt*s[0]-kt*s[1]+d[0]);k[2*nt+1]=p*(kt*s[0]+bt*s[1]+d[1]);nt+=1}lt+=1}this.vertexCount=at;this.lineVertexCount=ni;this.pointBuffer.update(yt);this.colorBuffer.update(pt);this.glyphBuffer.update(k);this.idBuffer.update(new Uint32Array(wt));r.free(yt);r.free(pt);r.free(k);r.free(wt);this.bounds=[rt,ut];this.points=c;this.pointCount=c.length}};i.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()}},{"./lib/glyphs":271,"./lib/shaders":272,"gl-buffer":134,"gl-mat4/multiply":155,"gl-vao":306,"typedarray-pool":550}],274:[function(n,t,i){"use strict";i.boxVertex="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n";i.boxFragment="precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"},{}],275:[function(n,t){"use strict";function u(n,t,i){this.plot=n;this.boxBuffer=t;this.boxShader=i;this.enabled=!0;this.selectBox=[Infinity,Infinity,-Infinity,-Infinity];this.borderColor=[0,0,0,1];this.innerFill=!1;this.innerColor=[0,0,0,.25];this.outerFill=!0;this.outerColor=[0,0,0,.5];this.borderWidth=10}function o(n,t){var o=n.gl,s=e(o,[0,0,0,1,1,0,1,1]),h=f(o,r.boxVertex,r.boxFragment),i=new u(n,s,h);return i.update(t),n.addOverlay(i),i}var f=n("gl-shader"),e=n("gl-buffer"),r=n("./lib/shaders"),i;t.exports=o;i=u.prototype;i.draw=function(){var v,p,n;if(this.enabled){var s=this.plot,h=this.selectBox,y=this.borderWidth,k=this.innerFill,w=this.innerColor,d=this.outerFill,c=this.outerColor,l=this.borderColor,f=s.box,a=s.screenBox,i=s.dataBox,t=s.viewBox,b=s.pixelRatio,e=(h[0]-i[0])*(t[2]-t[0])/(i[2]-i[0])+t[0],r=(h[1]-i[1])*(t[3]-t[1])/(i[3]-i[1])+t[1],o=(h[2]-i[0])*(t[2]-t[0])/(i[2]-i[0])+t[0],u=(h[3]-i[1])*(t[3]-t[1])/(i[3]-i[1])+t[1];(e=Math.max(e,t[0]),r=Math.max(r,t[1]),o=Math.min(o,t[2]),u=Math.min(u,t[3]),o<e||u<r)||(f.bind(),v=a[2]-a[0],p=a[3]-a[1],this.outerFill&&(f.drawBox(0,0,v,r,c),f.drawBox(0,r,e,u,c),f.drawBox(0,u,v,p,c),f.drawBox(o,r,v,u,c)),this.innerFill&&f.drawBox(e,r,o,u,w),y>0&&(n=y*b,f.drawBox(e-n,r-n,o+n,r+n,l),f.drawBox(e-n,u-n,o+n,u+n,l),f.drawBox(e-n,r-n,e+n,u+n,l),f.drawBox(o-n,r-n,o+n,u+n,l)))}};i.update=function(n){n=n||{};this.innerFill=!!n.innerFill;this.outerFill=!!n.outerFill;this.innerColor=(n.innerColor||[0,0,0,.5]).slice();this.outerColor=(n.outerColor||[0,0,0,.5]).slice();this.borderColor=(n.borderColor||[0,0,0,1]).slice();this.borderWidth=n.borderWidth||0;this.selectBox=(n.selectBox||this.selectBox).slice()};i.dispose=function(){this.boxBuffer.dispose();this.boxShader.dispose();this.plot.removeOverlay(this)}},{"./lib/shaders":274,"gl-buffer":134,"gl-shader":277}],276:[function(n,t){"use strict";function h(n,t,i,r,u){this.coord=[n,t];this.id=i;this.value=r;this.distance=u}function u(n,t,i){this.gl=n;this.fbo=t;this.buffer=i;this._readTimeout=null;var r=this;this._readCallback=function(){r.gl&&(t.bind(),n.readPixels(0,0,t.shape[0],t.shape[1],n.RGBA,n.UNSIGNED_BYTE,r.buffer),r._readTimeout=null)}}function c(n,t){var i=f(n,t),e=r.mallocUint8(t[0]*t[1]*4);return new u(n,i,e)}var i;t.exports=c;var f=n("gl-fbo"),r=n("typedarray-pool"),e=n("ndarray"),o=n("bit-twiddle").nextPow2,s=n("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(255>_inline_46_arg0_||255>_inline_46_arg1_||255>_inline_46_arg2_||255>_inline_46_arg3_){var _inline_46_l=_inline_46_arg4_-_inline_46_arg6_[0],_inline_46_a=_inline_46_arg5_-_inline_46_arg6_[1],_inline_46_f=_inline_46_l*_inline_46_l+_inline_46_a*_inline_46_a;_inline_46_f<this_closestD2&&(this_closestD2=_inline_46_f,this_closestX=_inline_46_arg6_[0],this_closestY=_inline_46_arg6_[1])}}",args:[{name:"_inline_46_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_46_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_46_a","_inline_46_f","_inline_46_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});i=u.prototype;Object.defineProperty(i,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(n){var t,i,f,u;if(this.gl){if(this.fbo.shape=n,t=this.fbo.shape[0],i=this.fbo.shape[1],i*t*4>this.buffer.length)for(r.free(this.buffer),f=this.buffer=r.mallocUint8(o(i*t*4)),u=0;u<i*t*4;++u)f[u]=255;return n}}});i.begin=function(){var n=this.gl,t=this.shape;n&&(this.fbo.bind(),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT))};i.end=function(){var n=this.gl;n&&(n.bindFramebuffer(n.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))};i.query=function(n,t,i){var r;if(!this.gl)return null;r=this.fbo.shape.slice();n=n|0;t=t|0;typeof i!="number"&&(i=1);var c=Math.min(Math.max(n-i,0),r[0])|0,y=Math.min(Math.max(n+i,0),r[0])|0,l=Math.min(Math.max(t-i,0),r[1])|0,p=Math.min(Math.max(t+i,0),r[1])|0;if(y<=c||p<=l)return null;var a=[y-c,p-l],f=e(this.buffer,[a[0],a[1],4],[4,r[0]*4,1],4*(c+r[0]*l)),v=s(f.hi(a[0],a[1],1),i,i),u=v[0],o=v[1];if(u<0||Math.pow(this.radius,2)<v[2])return null;var w=f.get(u,o,0),b=f.get(u,o,1),k=f.get(u,o,2),d=f.get(u,o,3);return new h(u+c|0,o+l|0,w,[b,k,d],Math.sqrt(v[2]))};i.dispose=function(){this.gl&&(this.fbo.dispose(),r.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":56,"cwise/lib/wrapper":128,"gl-fbo":139,ndarray:525,"typedarray-pool":550}],277:[function(n,t){"use strict";function e(n){this.gl=n;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function c(n,t){return n.name<t.name?-1:1}function l(n,t,i,r,u){var f=new e(n);return f.update(t,i,r,u),f}var o=n("./lib/create-uniforms"),s=n("./lib/create-attributes"),u=n("./lib/reflect"),i=n("./lib/shader-cache"),f=n("./lib/runtime-reflect"),h=n("./lib/GLError"),r=e.prototype;r.bind=function(){this.program||this._relink();this.gl.useProgram(this.program)};r.dispose=function(){this._fref&&this._fref.dispose();this._vref&&this._vref.dispose();this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};r.update=function(n,t,r,e){function ot(){l.program=i.program(a,l._vref,l._fref,rt,y);for(var n=0;n<r.length;++n)ft[n]=a.getUniformLocation(l.program,r[n].name)}var k,nt,p,tt,v,d,ut,b,g,w,ft;t&&arguments.length!==1||(k=n,n=k.vertex,t=k.fragment,r=k.uniforms,e=k.attributes);var l=this,a=l.gl,et=l._vref;if(l._vref=i.shader(a,a.VERTEX_SHADER,n),et&&et.dispose(),l.vertShader=l._vref.shader,nt=this._fref,l._fref=i.shader(a,a.FRAGMENT_SHADER,t),nt&&nt.dispose(),l.fragShader=l._fref.shader,!r||!e){if(p=a.createProgram(),a.attachShader(p,l.fragShader),a.attachShader(p,l.vertShader),a.linkProgram(p),!a.getProgramParameter(p,a.LINK_STATUS)){tt=a.getProgramInfoLog(p);throw new h(tt,"Error linking program:"+tt);}r=r||f.uniforms(a,p);e=e||f.attributes(a,p);a.deleteProgram(p)}e=e.slice();e.sort(c);var it=[],rt=[],y=[];for(w=0;w<e.length;++w)if(v=e[w],v.type.indexOf("mat")>=0){for(d=v.type.charAt(v.type.length-1)|0,ut=new Array(d),b=0;b<d;++b)ut[b]=y.length,rt.push(v.name+"["+b+"]"),typeof v.location=="number"?y.push(v.location+b):Array.isArray(v.location)&&v.location.length===d&&typeof v.location[b]=="number"?y.push(v.location[b]|0):y.push(-1);it.push({name:v.name,type:v.type,locations:ut})}else it.push({name:v.name,type:v.type,locations:[y.length]}),rt.push(v.name),typeof v.location=="number"?y.push(v.location|0):y.push(-1);for(g=0,w=0;w<y.length;++w)if(y[w]<0){while(y.indexOf(g)>=0)g+=1;y[w]=g}ft=new Array(r.length);ot();l._relink=ot;l.types={uniforms:u(r),attributes:u(e)};l.attributes=s(a,l,it,y);Object.defineProperty(l,"uniforms",o(a,l,r,ft))};t.exports=l},{"./lib/GLError":278,"./lib/create-attributes":279,"./lib/create-uniforms":280,"./lib/reflect":281,"./lib/runtime-reflect":282,"./lib/shader-cache":283}],278:[function(n,t,i){arguments[4][182][0].apply(i,arguments)},{dup:182}],279:[function(n,t,i){arguments[4][183][0].apply(i,arguments)},{"./GLError":278,dup:183}],280:[function(n,t,i){arguments[4][184][0].apply(i,arguments)},{"./GLError":278,"./reflect":281,dup:184}],281:[function(n,t,i){arguments[4][185][0].apply(i,arguments)},{dup:185}],282:[function(n,t,i){arguments[4][186][0].apply(i,arguments)},{dup:186}],283:[function(n,t,i){arguments[4][187][0].apply(i,arguments)},{"./GLError":278,dup:187,"gl-format-compiler-error":284,"weakmap-shim":294}],284:[function(n,t,i){arguments[4][188][0].apply(i,arguments)},{"add-line-numbers":285,dup:188,"gl-constants/lookup":288,"glsl-shader-name":289,"sprintf-js":291}],285:[function(n,t,i){arguments[4][189][0].apply(i,arguments)},{dup:189,"pad-left":286}],286:[function(n,t,i){arguments[4][190][0].apply(i,arguments)},{dup:190,"repeat-string":526}],287:[function(n,t,i){arguments[4][191][0].apply(i,arguments)},{dup:191}],288:[function(n,t,i){arguments[4][192][0].apply(i,arguments)},{"./1.0/numbers":287,dup:192}],289:[function(n,t,i){arguments[4][193][0].apply(i,arguments)},{"atob-lite":290,dup:193,"glsl-tokenizer":314}],290:[function(n,t,i){arguments[4][194][0].apply(i,arguments)},{dup:194}],291:[function(n,t,i){arguments[4][195][0].apply(i,arguments)},{dup:195}],292:[function(n,t,i){arguments[4][196][0].apply(i,arguments)},{"./hidden-store.js":293,dup:196}],293:[function(n,t,i){arguments[4][197][0].apply(i,arguments)},{dup:197}],294:[function(n,t,i){arguments[4][198][0].apply(i,arguments)},{"./create-store.js":292,dup:198}],295:[function(n,t){"use strict";function r(n){this.plot=n;this.enable=[!0,!0,!1,!1];this.width=[1,1,1,1];this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.center=[Infinity,Infinity]}function u(n,t){var i=new r(n);return i.update(t),n.addOverlay(i),i}t.exports=u;var i=r.prototype;i.update=function(n){n=n||{};this.enable=(n.enable||[!0,!0,!1,!1]).slice();this.width=(n.width||[1,1,1,1]).slice();this.color=(n.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(n){return n.slice()});this.center=(n.center||[Infinity,Infinity]).slice();this.plot.setOverlayDirty()};i.draw=function(){var e=this.enable,o=this.width,s=this.color,u=this.center,h=this.plot,f=h.line,n=h.dataBox,t=h.viewBox,i,r;f.bind();n[0]<=u[0]&&u[0]<=n[2]&&n[1]<=u[1]&&u[1]<=n[3]&&(i=t[0]+(u[0]-n[0])/(n[2]-n[0])*(t[2]-t[0]),r=t[1]+(u[1]-n[1])/(n[3]-n[1])*(t[3]-t[1]),e[0]&&f.drawLine(i,r,t[0],r,o[0],s[0]),e[1]&&f.drawLine(i,r,i,t[1],o[1],s[1]),e[2]&&f.drawLine(i,r,t[2],r,o[2],s[2]),e[3]&&f.drawLine(i,r,i,t[3],o[3],s[3]))};i.dispose=function(){this.plot.removeOverlay(this)}},{}],296:[function(n,t,i){var r=n("gl-shader"),u="precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec4 uv;\r\nattribute vec3 f;\r\nattribute vec3 normal;\r\n\r\nuniform mat4 model, view, projection, inverseModel;\r\nuniform vec3 lightPosition, eyePosition;\r\nuniform sampler2D colormap;\r\n\r\nvarying float value, kill;\r\nvarying vec3 worldCoordinate;\r\nvarying vec2 planeCoordinate;\r\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  worldCoordinate = vec3(uv.zw, f.x);\r\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\r\n  vec4 clipPosition = projection * view * worldPosition;\r\n  gl_Position = clipPosition;\r\n  kill = f.y;\r\n  value = f.z;\r\n  planeCoordinate = uv.xy;\r\n\r\n  vColor = texture2D(colormap, vec2(value, value));\r\n\r\n  //Lighting geometry parameters\r\n  vec4 cameraCoordinate = view * worldPosition;\r\n  cameraCoordinate.xyz /= cameraCoordinate.w;\r\n  lightDirection = lightPosition - cameraCoordinate.xyz;\r\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\r\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\r\n}\r\n",f="precision mediump float;\n#define GLSLIFY 1\r\n\r\nfloat beckmannDistribution_2_0(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\n\n\nfloat beckmannSpecular_1_1(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution_2_0(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\n\n\r\nuniform vec3 lowerBound, upperBound;\r\nuniform float contourTint;\r\nuniform vec4 contourColor;\r\nuniform sampler2D colormap;\r\nuniform vec3 clipBounds[2];\r\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\r\nuniform float vertexColor;\r\n\r\nvarying float value, kill;\r\nvarying vec3 worldCoordinate;\r\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  if (kill > 0.0 ||\r\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\r\n    discard;\r\n  }\r\n\r\n  vec3 N = normalize(surfaceNormal);\r\n  vec3 V = normalize(eyeDirection);\r\n  vec3 L = normalize(lightDirection);\r\n\r\n  if(gl_FrontFacing) {\r\n    N = -N;\r\n  }\r\n\r\n  float specular = beckmannSpecular_1_1(L, V, N, roughness);\r\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\r\n\r\n  //decide how to interpolate color — in vertex or in fragment\r\n  vec4 surfaceColor = step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) + step(.5, vertexColor) * vColor;\r\n\r\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\r\n\r\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\r\n}\r\n",e="precision mediump float;\n#define GLSLIFY 1\r\n\r\nattribute vec4 uv;\r\nattribute float f;\r\n\r\nuniform mat3 permutation;\r\nuniform mat4 model, view, projection;\r\nuniform float height, zOffset;\r\nuniform sampler2D colormap;\r\n\r\nvarying float value, kill;\r\nvarying vec3 worldCoordinate;\r\nvarying vec2 planeCoordinate;\r\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\r\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\r\n\r\n  vec4 clipPosition = projection * view * worldPosition;\r\n  clipPosition.z = clipPosition.z + zOffset;\r\n\r\n  gl_Position = clipPosition;\r\n  value = f;\r\n  kill = -1.0;\r\n  worldCoordinate = dataCoordinate;\r\n  planeCoordinate = uv.zw;\r\n\r\n  vColor = texture2D(colormap, vec2(value, value));\r\n\r\n  //Don't do lighting for contours\r\n  surfaceNormal   = vec3(1,0,0);\r\n  eyeDirection    = vec3(0,1,0);\r\n  lightDirection  = vec3(0,0,1);\r\n}\r\n",o="precision mediump float;\n#define GLSLIFY 1\r\n\r\nuniform vec2 shape;\r\nuniform vec3 clipBounds[2];\r\nuniform float pickId;\r\n\r\nvarying float value, kill;\r\nvarying vec3 worldCoordinate;\r\nvarying vec2 planeCoordinate;\r\nvarying vec3 surfaceNormal;\r\n\r\nvec2 splitFloat(float v) {\r\n  float vh = 255.0 * v;\r\n  float upper = floor(vh);\r\n  float lower = fract(vh);\r\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\r\n}\r\n\r\nvoid main() {\r\n  if(kill > 0.0 ||\r\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\r\n    discard;\r\n  }\r\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\r\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\r\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\r\n}\r\n";i.createShader=function(n){var t=r(n,u,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t};i.createPickShader=function(n){var t=r(n,u,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t};i.createContourShader=function(n){var t=r(n,e,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t};i.createPickContourShader=function(n){var t=r(n,e,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t}},{"gl-shader":277}],297:[function(n,t,i){arguments[4][27][0].apply(i,arguments)},{dup:27}],298:[function(n,t){"use strict";function h(n){var h,e,s,t,o;if(n in r)return r[n];for(h=[],t=0;t<n;++t)h.push("out",t,"s=0.5*(inp",t,"l-inp",t,"r);");for(e=["array"],s=["junk"],t=0;t<n;++t)e.push("array"),s.push("out"+t+"s"),o=u(n),o[t]=-1,e.push({array:0,offset:o.slice()}),o[t]=1,e.push({array:0,offset:o.slice()}),s.push("inp"+t+"l","inp"+t+"r");return r[n]=f({args:e,pre:i,post:i,body:{body:h.join(""),args:s.map(function(n){return{name:n,lvalue:n.indexOf("out")===0,rvalue:n.indexOf("inp")===0,count:n!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+n})}function c(n){function k(i){for(var o,u,h,a,v,c,l,s=f-i.length,y=[],p=[],e=[],r=0;r<f;++r)i.indexOf(r+1)>=0?e.push("0"):i.indexOf(-(r+1))>=0?e.push("s["+r+"]-1"):(e.push("-1"),y.push("1"),p.push("s["+r+"]-2"));if(o=".lo("+y.join()+").hi("+p.join()+")",y.length===0&&(o=""),s>0){for(t.push("if(1"),r=0;r<f;++r)i.indexOf(r+1)>=0||i.indexOf(-(r+1))>=0||t.push("&&s[",r,"]>2");for(t.push("){grad",s,"(src.pick(",e.join(),")",o),r=0;r<f;++r)i.indexOf(r+1)>=0||i.indexOf(-(r+1))>=0||t.push(",dst.pick(",e.join(),",",r,")",o);t.push(");")}for(r=0;r<i.length;++r){u=Math.abs(i[r])-1;h="dst.pick("+e.join()+","+u+")"+o;switch(n[u]){case"clamp":a=e.slice();v=e.slice();i[r]<0?a[u]="s["+u+"]-2":v[u]="1";s===0?t.push("if(s[",u,"]>1){dst.set(",e.join(),",",u,",0.5*(src.get(",a.join(),")-src.get(",v.join(),")))}else{dst.set(",e.join(),",",u,",0)};"):t.push("if(s[",u,"]>1){diff(",h,",src.pick(",a.join(),")",o,",src.pick(",v.join(),")",o,");}else{zero(",h,");};");break;case"mirror":s===0?t.push("dst.set(",e.join(),",",u,",0);"):t.push("zero(",h,");");break;case"wrap":c=e.slice();l=e.slice();i[r]<0?(c[u]="s["+u+"]-2",l[u]="0"):(c[u]="s["+u+"]-1",l[u]="1");s===0?t.push("if(s[",u,"]>2){dst.set(",e.join(),",",u,",0.5*(src.get(",c.join(),")-src.get(",l.join(),")))}else{dst.set(",e.join(),",",u,",0)};"):t.push("if(s[",u,"]>2){diff(",h,",src.pick(",c.join(),")",o,",src.pick(",l.join(),")",o,");}else{zero(",h,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition");}}s>0&&t.push("};")}var w=n.join(),c=e[w],f,t,l,a,v,i,y,p,u,b;if(c)return c;for(f=n.length,t=["function gradient(dst,src){var s=src.shape.slice();"],u=0;u<1<<f;++u){for(l=[],i=0;i<f;++i)u&1<<i&&l.push(i+1);for(a=0;a<1<<l.length;++a){for(v=l.slice(),i=0;i<l.length;++i)a&1<<i&&(v[i]=-v[i]);k(v)}}for(t.push("return dst;};return gradient"),y=["diff","zero"],p=[o,s],u=1;u<=f;++u)y.push("grad"+u),p.push(h(u));return y.push(t.join("")),b=Function.apply(void 0,y),c=b.apply(void 0,p),r[w]=c,c}function l(n,t,i){var r,f;if(Array.isArray(i)){if(i.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions");}else i=typeof i=="string"?u(t.dimension,i):u(t.dimension,"clamp");if(n.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(n.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(r=0;r<t.dimension;++r)if(n.shape[r]!==t.shape[r])throw new Error("ndarray-gradient: shape mismatch");return t.size===0?n:t.dimension<=0?(n.set(0),n):(f=c(i),f(n,t))}t.exports=l;var u=n("dup"),f=n("cwise-compiler"),r={},e={},i={body:"",args:[],thisVars:[],localVars:[]},o=f({args:["array","array","array"],pre:i,post:i,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),s=f({args:["array"],pre:i,post:i,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"})},{"cwise-compiler":125,dup:131}],299:[function(n,t){"use strict";var i=n("ndarray"),r=n("./doConvert.js");t.exports=function(n,t){for(var f=[],u=n,e=1;Array.isArray(u);)f.push(u.length),e*=u.length,u=u[0];return f.length===0?i():(t||(t=i(new Float64Array(e),f)),r(t,n),t)}},{"./doConvert.js":300,ndarray:525}],300:[function(n,t){t.exports=n("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":125}],301:[function(n,t){"use strict";function bt(n,t,i,r,u){this.position=n;this.index=t;this.uv=i;this.level=r;this.dataCoordinate=u}function kt(n){var t=ct([ht({colormap:n,nshades:w,format:"rgba"}).map(function(n){return[n[0],n[1],n[2],255*n[3]]})]);return o.divseq(t,255),t}function tt(n,t,r,u,e,o,s,h,c,l,a,v,y,p){this.gl=n;this.shape=t;this.bounds=r;this.intensityBounds=[];this._shader=u;this._pickShader=e;this._coordinateBuffer=o;this._vao=s;this._colorMap=h;this._contourShader=c;this._contourPickShader=l;this._contourBuffer=a;this._contourVAO=v;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._pickResult=new bt([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]);this._dynamicBuffer=y;this._dynamicVAO=p;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[1],[1],[1]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=!0;this.showSurface=!0;this.enableHighlight=[!0,!0,!0];this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.enableDynamic=[!0,!0,!0];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[!1,!1,!1];this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]];this.colorBounds=[!1,!1];this._field=[f(i.mallocFloat(1024),[0,0]),f(i.mallocFloat(1024),[0,0]),f(i.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.snapToData=!1;this.opacity=1;this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.vertexColor=0;this.dirty=!0}function rt(n,t){for(var i,f,c=t.axes&&t.axes.lastCubeProps.axis||it,o=t.showSurface,s=t.showContour,u,e,r=0;r<3;++r)for(o=o||t.surfaceProject[r],i=0;i<3;++i)s=s||t.contourProject[r][i];for(r=0;r<3;++r){for(u=h.projections[r],i=0;i<16;++i)u[i]=0;for(i=0;i<4;++i)u[5*i]=1;for(u[5*r]=0,u[12+r]=t.axesBounds[+(c[r]>0)][r],y(u,n.model,u),e=h.clipBounds[r],f=0;f<2;++f)for(i=0;i<3;++i)e[f][i]=n.clipBounds[f][i];e[0][r]=-1e8;e[1][r]=1e8}return h.showSurface=o,h.showContour=s,h}function ft(n,t){var o,f,i,w,u,h,v,p,c,e,l,a;for(n=n||{},o=this.gl,o.disable(o.CULL_FACE),this._colorMap.bind(0),f=dt,f.model=n.model||r,f.view=n.view||r,f.projection=n.projection||r,f.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],f.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],f.contourColor=this.contourColor[0],f.inverseModel=g(f.inverseModel,f.model),i=0;i<2;++i)for(w=f.clipBounds[i],u=0;u<3;++u)w[u]=Math.min(Math.max(this.clipBounds[i][u],-1e8),1e8);for(f.kambient=this.ambientLight,f.kdiffuse=this.diffuseLight,f.kspecular=this.specularLight,f.roughness=this.roughness,f.fresnel=this.fresnel,f.opacity=this.opacity,f.height=0,f.permutation=ut,f.vertexColor=this.vertexColor,h=gt,y(h,f.view,f.model),y(h,f.projection,h),g(h,h),i=0;i<3;++i)f.eyePosition[i]=h[12+i]/h[15];for(v=h[15],i=0;i<3;++i)v+=this.lightPosition[i]*h[4*i+3];for(i=0;i<3;++i){for(p=h[12+i],u=0;u<3;++u)p+=h[4*u+i]*this.lightPosition[u];f.lightPosition[i]=p/v}if(c=rt(f,this),c.showSurface&&t===this.opacity<1){for(this._shader.bind(),this._shader.uniforms=f,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(o.TRIANGLES,this._vertexCount),i=0;i<3;++i)this.surfaceProject[i]&&this.vertexCount&&(this._shader.uniforms.model=c.projections[i],this._shader.uniforms.clipBounds=c.clipBounds[i],this._vao.draw(o.TRIANGLES,this._vertexCount));this._vao.unbind()}if(c.showContour&&!t){for(e=this._contourShader,f.kambient=1,f.kdiffuse=0,f.kspecular=0,f.opacity=1,e.bind(),e.uniforms=f,l=this._contourVAO,l.bind(),i=0;i<3;++i)for(e.uniforms.permutation=s[i],o.lineWidth(this.contourWidth[i]),u=0;u<this.contourLevels[i].length;++u)this._contourCounts[i][u]&&(u===this.highlightLevel[i]?(e.uniforms.contourColor=this.highlightColor[i],e.uniforms.contourTint=this.highlightTint[i]):(u===0||u-1===this.highlightLevel[i])&&(e.uniforms.contourColor=this.contourColor[i],e.uniforms.contourTint=this.contourTint[i]),e.uniforms.height=this.contourLevels[i][u],l.draw(o.LINES,this._contourCounts[i][u],this._contourOffsets[i][u]));for(i=0;i<3;++i)for(e.uniforms.model=c.projections[i],e.uniforms.clipBounds=c.clipBounds[i],u=0;u<3;++u)if(this.contourProject[i][u])for(e.uniforms.permutation=s[u],o.lineWidth(this.contourWidth[u]),a=0;a<this.contourLevels[u].length;++a)a===this.highlightLevel[u]?(e.uniforms.contourColor=this.highlightColor[u],e.uniforms.contourTint=this.highlightTint[u]):(a===0||a-1===this.highlightLevel[u])&&(e.uniforms.contourColor=this.contourColor[u],e.uniforms.contourTint=this.contourTint[u]),e.uniforms.height=this.contourLevels[u][a],l.draw(o.LINES,this._contourCounts[u][a],this._contourOffsets[u][a]);for(l=this._dynamicVAO,l.bind(),i=0;i<3;++i)if(this._dynamicCounts[i]!==0)for(e.uniforms.model=f.model,e.uniforms.clipBounds=f.clipBounds,e.uniforms.permutation=s[i],o.lineWidth(this.dynamicWidth[i]),e.uniforms.contourColor=this.dynamicColor[i],e.uniforms.contourTint=this.dynamicTint[i],e.uniforms.height=this.dynamicLevel[i],l.draw(o.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]),u=0;u<3;++u)this.contourProject[u][i]&&(e.uniforms.model=c.projections[u],e.uniforms.clipBounds=c.clipBounds[u],l.draw(o.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]));l.unbind()}}function b(n,t){var i=t.shape.slice(),r=n.shape.slice();o.assign(n.lo(1,1).hi(i[0],i[1]),t);o.assign(n.lo(1).hi(i[0],1),t.hi(i[0],1));o.assign(n.lo(1,r[1]-1).hi(i[0],1),t.lo(0,i[1]-1).hi(i[0],1));o.assign(n.lo(0,1).hi(1,i[1]),t.hi(1));o.assign(n.lo(r[0]-1,1).hi(1,i[1]),t.lo(i[0]-1));n.set(0,0,t.get(0,0));n.set(0,r[1]-1,t.get(0,i[1]-1));n.set(r[0]-1,0,t.get(i[0]-1,0));n.set(r[0]-1,r[1]-1,t.get(i[0]-1,i[1]-1))}function e(n,t){return Array.isArray(n)?[t(n[0]),t(n[1]),t(n[2])]:[t(n),t(n),t(n)]}function l(n){return Array.isArray(n)?n.length===3?[n[0],n[1],n[2],1]:[n[0],n[1],n[2],n[3]]:[0,0,0,1]}function ot(n){if(Array.isArray(n)){if(Array.isArray(n))return[l(n[0]),l(n[1]),l(n[2])];var t=l(n);return[t.slice(),t.slice(),t.slice()]}}function ni(n){var t=n.gl,h=vt(t),c=pt(t),l=yt(t),y=wt(t),r=a(t),b=v(t,[{buffer:r,size:4,stride:p,offset:0},{buffer:r,size:3,stride:p,offset:16},{buffer:r,size:3,stride:p,offset:28}]),u=a(t),k=v(t,[{buffer:u,size:4,stride:20,offset:0},{buffer:u,size:1,stride:20,offset:16}]),s=a(t),d=v(t,[{buffer:s,size:2,type:t.FLOAT}]),f=st(t,1,w,t.RGBA,t.UNSIGNED_BYTE),e,i,o;f.minFilter=t.LINEAR;f.magFilter=t.LINEAR;e=new tt(t,[0,0],[[0,0,0],[0,0,0]],h,c,r,b,f,l,y,u,k,s,d);i={levels:[[],[],[]]};for(o in n)i[o]=n[o];return i.colormap=i.colormap||"jet",e.update(i),e}var w,u,it,h,et;t.exports=ni;var k=n("bit-twiddle"),a=n("gl-buffer"),v=n("gl-vao"),st=n("gl-texture2d"),i=n("typedarray-pool"),ht=n("colormap"),o=n("ndarray-ops"),ct=n("ndarray-pack"),f=n("ndarray"),d=n("surface-nets"),y=n("gl-mat4/multiply"),g=n("gl-mat4/invert"),lt=n("binary-search-bounds"),at=n("ndarray-gradient"),c=n("./lib/shaders"),vt=c.createShader,yt=c.createContourShader,pt=c.createPickShader,wt=c.createPickContourShader,p=40,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nt=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],s=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var n=0;n<3;++n){var t=s[n],i=(n+1)%3,r=(n+2)%3;t[i+0]=1;t[r+3]=1;t[n+6]=1}})();w=256;u=tt.prototype;u.isTransparent=function(){return this.opacity<1};u.isOpaque=function(){if(this.opacity>=1)return!0;for(var n=0;n<3;++n)if(this._contourCounts[n].length>0||this._dynamicCounts[n]>0)return!0;return!1};u.pickSlots=1;u.setPickBase=function(n){this.pickId=n};it=[0,0,0];h={showSurface:!1,showContour:!1,projections:[r.slice(),r.slice(),r.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};var dt={model:r,view:r,projection:r,inverseModel:r.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-.0001,kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},gt=r.slice(),ut=[1,0,0,0,1,0,0,0,1];u.draw=function(n){return ft.call(this,n,!1)};u.drawTransparent=function(n){return ft.call(this,n,!0)};et={model:r,view:r,projection:r,inverseModel:r,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};u.drawPick=function(n){var f,u,i,l,t,o,e,c,h;for(n=n||{},f=this.gl,f.disable(f.CULL_FACE),u=et,u.model=n.model||r,u.view=n.view||r,u.projection=n.projection||r,u.shape=this._field[2].shape,u.pickId=this.pickId/255,u.lowerBound=this.bounds[0],u.upperBound=this.bounds[1],u.permutation=ut,i=0;i<2;++i)for(l=u.clipBounds[i],t=0;t<3;++t)l[t]=Math.min(Math.max(this.clipBounds[i][t],-1e8),1e8);if(o=rt(u,this),o.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=u,this._vao.bind(),this._vao.draw(f.TRIANGLES,this._vertexCount),i=0;i<3;++i)this.surfaceProject[i]&&(this._pickShader.uniforms.model=o.projections[i],this._pickShader.uniforms.clipBounds=o.clipBounds[i],this._vao.draw(f.TRIANGLES,this._vertexCount));this._vao.unbind()}if(o.showContour){for(e=this._contourPickShader,e.bind(),e.uniforms=u,c=this._contourVAO,c.bind(),t=0;t<3;++t)for(f.lineWidth(this.contourWidth[t]),e.uniforms.permutation=s[t],i=0;i<this.contourLevels[t].length;++i)this._contourCounts[t][i]&&(e.uniforms.height=this.contourLevels[t][i],c.draw(f.LINES,this._contourCounts[t][i],this._contourOffsets[t][i]));for(i=0;i<3;++i)for(e.uniforms.model=o.projections[i],e.uniforms.clipBounds=o.clipBounds[i],t=0;t<3;++t)if(this.contourProject[i][t])for(e.uniforms.permutation=s[t],f.lineWidth(this.contourWidth[t]),h=0;h<this.contourLevels[t].length;++h)this._contourCounts[t][h]&&(e.uniforms.height=this.contourLevels[t][h],c.draw(f.LINES,this._contourCounts[t][h],this._contourOffsets[t][h]));c.unbind()}};u.pick=function(n){var u,s,p,h,i,f,t,w,b;if(!n||n.id!==this.pickId)return null;var c=this._field[2].shape,r=this._pickResult,l=c[0]*(n.value[0]+(n.value[2]>>4)/16)/255,e=Math.floor(l),a=l-e,v=c[1]*(n.value[1]+(n.value[2]&15)/16)/255,o=Math.floor(v),y=v-o;for(e+=1,o+=1,u=r.position,u[0]=u[1]=u[2]=0,s=0;s<2;++s)for(p=s?a:1-a,h=0;h<2;++h){var k=h?y:1-y,d=e+s,g=o+h,nt=p*k;for(i=0;i<3;++i)u[i]+=this._field[i].get(d,g)*nt}for(f=this._pickResult.level,t=0;t<3;++t)f[t]=lt.le(this.contourLevels[t],u[t]),f[t]<0?this.contourLevels[t].length>0&&(f[t]=0):f[t]<this.contourLevels[t].length-1&&(w=this.contourLevels[t][f[t]],b=this.contourLevels[t][f[t]+1],Math.abs(w-u[t])>Math.abs(b-u[t])&&(f[t]+=1));for(r.index[0]=a<.5?e:e+1,r.index[1]=y<.5?o:o+1,r.uv[0]=l/c[0],r.uv[1]=v/c[1],i=0;i<3;++i)r.dataCoordinate[i]=this._field[i].get(r.index[0],r.index[1]);return r};u.update=function(n){var p,bt,oi,u,t,ti,si,ii,it,ri,hi,r,dt,w,rt,g,tt,h,l,gt,o,vt,ut,ui,nr,yt,sr,hr,cr,lr,ai,ei;if(n=n||{},this.dirty=!0,"contourWidth"in n&&(this.contourWidth=e(n.contourWidth,Number)),"showContour"in n&&(this.showContour=e(n.showContour,Boolean)),"showSurface"in n&&(this.showSurface=!!n.showSurface),"contourTint"in n&&(this.contourTint=e(n.contourTint,Boolean)),"contourColor"in n&&(this.contourColor=ot(n.contourColor)),"contourProject"in n&&(this.contourProject=e(n.contourProject,function(n){return e(n,Boolean)})),"surfaceProject"in n&&(this.surfaceProject=n.surfaceProject),"dynamicColor"in n&&(this.dynamicColor=ot(n.dynamicColor)),"dynamicTint"in n&&(this.dynamicTint=e(n.dynamicTint,Number)),"dynamicWidth"in n&&(this.dynamicWidth=e(n.dynamicWidth,Number)),"opacity"in n&&(this.opacity=n.opacity),"colorBounds"in n&&(this.colorBounds=n.colorBounds),"vertexColor"in n&&(this.vertexColor=n.vertexColor?1:0),p=n.field||n.coords&&n.coords[2]||null,bt=!1,p||(p=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in n||"coords"in n){for(oi=(p.shape[0]+2)*(p.shape[1]+2),oi>this._field[2].data.length&&(i.freeFloat(this._field[2].data),this._field[2].data=i.mallocFloat(k.nextPow2(oi))),this._field[2]=f(this._field[2].data,[p.shape[0]+2,p.shape[1]+2]),b(this._field[2],p),this.shape=p.shape.slice(),u=this.shape,t=0;t<2;++t)this._field[2].size>this._field[t].data.length&&(i.freeFloat(this._field[t].data),this._field[t].data=i.mallocFloat(this._field[2].size)),this._field[t]=f(this._field[t].data,[u[0]+2,u[1]+2]);if(n.coords){if(ti=n.coords,!Array.isArray(ti)||ti.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(t=0;t<2;++t){for(si=ti[t],r=0;r<2;++r)if(si.shape[r]!==u[r])throw new Error("gl-surface: coords have incorrect shape");b(this._field[t],si)}}else if(n.ticks){if(ii=n.ticks,!Array.isArray(ii)||ii.length!==2)throw new Error("gl-surface: invalid ticks");for(t=0;t<2;++t){if(it=ii[t],(Array.isArray(it)||it.length)&&(it=f(it)),it.shape[0]!==u[t])throw new Error("gl-surface: invalid tick length");ri=f(it.data,u);ri.stride[t]=it.stride[0];ri.stride[t^1]=0;b(this._field[t],ri)}}else{for(t=0;t<2;++t)hi=[0,0],hi[t]=1,this._field[t]=f(this._field[t].data,[u[0]+2,u[1]+2],hi,0);for(this._field[0].set(0,0,0),r=0;r<u[0];++r)this._field[0].set(r+1,0,r);for(this._field[0].set(u[0]+1,0,u[0]-1),this._field[1].set(0,0,0),r=0;r<u[1];++r)this._field[1].set(0,r+1,r);this._field[1].set(0,u[1]+1,u[1]-1)}for(dt=this._field,w=f(i.mallocFloat(dt[2].size*6),[3,u[0]+2,u[1]+2,2]),t=0;t<3;++t)at(w.pick(t),dt[t],"mirror");for(rt=f(i.mallocFloat(dt[2].size*3),[u[0]+2,u[1]+2,3]),t=0;t<u[0]+2;++t)for(r=0;r<u[1]+2;++r){var vi=w.get(0,t,r,0),yi=w.get(0,t,r,1),pi=w.get(1,t,r,0),wi=w.get(1,t,r,1),bi=w.get(2,t,r,0),ki=w.get(2,t,r,1),ft=pi*ki-wi*bi,et=bi*yi-ki*vi,st=vi*wi-yi*pi,a=Math.sqrt(ft*ft+et*et+st*st);a<1e-8?(a=Math.max(Math.abs(ft),Math.abs(et),Math.abs(st)),a<1e-8?(st=1,et=ft=0,a=1):a=1/a):a=1/Math.sqrt(a);rt.set(t,r,0,ft*a);rt.set(t,r,1,et*a);rt.set(t,r,2,st*a)}i.free(w.data);var ht=[Infinity,Infinity,Infinity],ct=[-Infinity,-Infinity,-Infinity],lt=Infinity,pt=-Infinity,ar=(u[0]-1)*(u[1]-1)*6,s=i.mallocFloat(k.nextPow2(10*ar)),c=0,wt=0;for(t=0;t<u[0]-1;++t)n:for(r=0;r<u[1]-1;++r){for(g=0;g<2;++g)for(tt=0;tt<2;++tt)for(h=0;h<3;++h)if(l=this._field[h].get(1+t+g,1+r+tt),isNaN(l)||!isFinite(l))continue n;for(h=0;h<6;++h){var v=t+nt[h][0],y=r+nt[h][1],ci=this._field[0].get(v+1,y+1),li=this._field[1].get(v+1,y+1);l=this._field[2].get(v+1,y+1);gt=l;ft=rt.get(v+1,y+1,0);et=rt.get(v+1,y+1,1);st=rt.get(v+1,y+1,2);n.intensity&&(gt=n.intensity.get(v,y));s[c++]=v;s[c++]=y;s[c++]=ci;s[c++]=li;s[c++]=l;s[c++]=0;s[c++]=gt;s[c++]=ft;s[c++]=et;s[c++]=st;ht[0]=Math.min(ht[0],ci);ht[1]=Math.min(ht[1],li);ht[2]=Math.min(ht[2],l);lt=Math.min(lt,gt);ct[0]=Math.max(ct[0],ci);ct[1]=Math.max(ct[1],li);ct[2]=Math.max(ct[2],l);pt=Math.max(pt,gt);wt+=1}}for(n.intensityBounds&&(lt=+n.intensityBounds[0],pt=+n.intensityBounds[1]),t=6;t<c;t+=10)s[t]=(s[t]-lt)/(pt-lt);this._vertexCount=wt;this._coordinateBuffer.update(s.subarray(0,c));i.freeFloat(s);i.free(rt.data);this.bounds=[ht,ct];this.intensity=n.intensity||this._field[2];(this.intensityBounds[0]!==lt||this.intensityBounds[1]!==pt)&&(bt=!0);this.intensityBounds=[lt,pt]}if("levels"in n){for(o=n.levels,o=Array.isArray(o[0])?o.slice():[[],[],o],t=0;t<3;++t)o[t]=o[t].slice(),o.sort(function(n,t){return n-t});n:for(t=0;t<3;++t){if(o[t].length!==this.contourLevels[t].length){bt=!0;break}for(r=0;r<o[t].length;++r)if(o[t][r]!==this.contourLevels[t][r]){bt=!0;break n}}this.contourLevels=o}if(bt){for(dt=this._field,u=this.shape,vt=[],ut=0;ut<3;++ut){o=this.contourLevels[ut];var di=[],gi=[],ni=[0,0,0];for(t=0;t<o.length;++t){ui=d(this._field[ut],o[t]);di.push(vt.length/5|0);wt=0;n:for(r=0;r<ui.cells.length;++r)for(nr=ui.cells[r],h=0;h<2;++h){var fi=ui.positions[nr[h]],tr=fi[0],ir=Math.floor(tr)|0,rr=tr-ir,ur=fi[1],fr=Math.floor(ur)|0,er=ur-fr,or=!1;t:for(yt=0;yt<3;++yt)for(ni[yt]=0,sr=(ut+yt+1)%3,g=0;g<2;++g)for(hr=g?rr:1-rr,v=Math.min(Math.max(ir+g,0),u[0])|0,tt=0;tt<2;++tt){if(cr=tt?er:1-er,y=Math.min(Math.max(fr+tt,0),u[1])|0,l=yt<2?this._field[sr].get(v,y):(this.intensity.get(v,y)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(l)||isNaN(l)){or=!0;break t}lr=hr*cr;ni[yt]+=lr*l}if(or){if(h>0){for(ai=0;ai<5;++ai)vt.pop();wt-=1}continue n}else vt.push(ni[0],ni[1],fi[0],fi[1],ni[2]),wt+=1}gi.push(wt)}this._contourOffsets[ut]=di;this._contourCounts[ut]=gi}for(ei=i.mallocFloat(vt.length),t=0;t<vt.length;++t)ei[t]=vt[t];this._contourBuffer.update(ei);i.freeFloat(ei)}n.colormap&&this._colorMap.setPixels(kt(n.colormap))};u.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var n=0;n<3;++n)i.freeFloat(this._field[n].data)};u.highlight=function(n){var r,f,t,g,s;if(!n){this._dynamicCounts=[0,0,0];this.dyanamicLevel=[NaN,NaN,NaN];this.highlightLevel=[-1,-1,-1];return}for(r=0;r<3;++r)this.highlightLevel[r]=this.enableHighlight[r]?n.level[r]:-1;if(f=this.snapToData?n.dataCoordinate:n.position,this.enableDynamic[0]&&f[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&f[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&f[2]!==this.dynamicLevel[2]){var u=0,h=this.shape,c=i.mallocFloat(12*h[0]*h[1]);for(t=0;t<3;++t){if(!this.enableDynamic[t]){this.dynamicLevel[t]=NaN;this._dynamicCounts[t]=0;continue}this.dynamicLevel[t]=f[t];var lt=(t+1)%3,at=(t+2)%3,vt=this._field[t],l=this._field[lt],a=this._field[at],pt=this.intensity,b=d(vt,f[t]),k=b.cells,yt=b.positions;for(this._dynamicOffsets[t]=u,r=0;r<k.length;++r)for(g=k[r],s=0;s<2;++s){var nt=yt[g[s]],tt=+nt[0],e=tt|0,v=Math.min(e+1,h[0])|0,p=tt-e,it=1-p,rt=+nt[1],o=rt|0,y=Math.min(o+1,h[1])|0,w=rt-o,ut=1-w,ft=it*ut,et=it*w,ot=p*ut,st=p*w,ht=ft*l.get(e,o)+et*l.get(e,y)+ot*l.get(v,o)+st*l.get(v,y),ct=ft*a.get(e,o)+et*a.get(e,y)+ot*a.get(v,o)+st*a.get(v,y);if(isNaN(ht)||isNaN(ct)){s&&(u-=1);break}c[2*u+0]=ht;c[2*u+1]=ct;u+=1}this._dynamicCounts[t]=u-this._dynamicOffsets[t]}this._dynamicBuffer.update(c.subarray(0,2*u));i.freeFloat(c)}}},{"./lib/shaders":296,"binary-search-bounds":297,"bit-twiddle":56,colormap:116,"gl-buffer":134,"gl-mat4/invert":153,"gl-mat4/multiply":155,"gl-texture2d":302,"gl-vao":306,ndarray:525,"ndarray-gradient":298,"ndarray-ops":524,"ndarray-pack":299,"surface-nets":544,"typedarray-pool":550}],302:[function(n,t){"use strict";function p(n){f=[n.LINEAR,n.NEAREST_MIPMAP_LINEAR,n.LINEAR_MIPMAP_NEAREST,n.LINEAR_MIPMAP_NEAREST];h=[n.NEAREST,n.LINEAR,n.NEAREST_MIPMAP_NEAREST,n.NEAREST_MIPMAP_LINEAR,n.LINEAR_MIPMAP_NEAREST,n.LINEAR_MIPMAP_LINEAR];e=[n.REPEAT,n.CLAMP_TO_EDGE,n.MIRRORED_REPEAT]}function l(n,t,i){var r=n.gl,u=r.getParameter(r.MAX_TEXTURE_SIZE);if(t<0||t>u||i<0||i>u)throw new Error("gl-texture2d: Invalid texture size");return n._shape=[t,i],n.bind(),r.texImage2D(r.TEXTURE_2D,0,n.format,t,i,0,n.format,n.type,null),n._mipLevels=[0],n}function o(n,t,i,r,u,f){var e,o,s;this.gl=n;this.handle=t;this.format=u;this.type=f;this._shape=[i,r];this._mipLevels=[0];this._magFilter=n.NEAREST;this._minFilter=n.NEAREST;this._wrapS=n.CLAMP_TO_EDGE;this._wrapT=n.CLAMP_TO_EDGE;this._anisoSamples=1;e=this;o=[this._wrapS,this._wrapT];Object.defineProperties(o,[{get:function(){return e._wrapS},set:function(n){return e.wrapS=n}},{get:function(){return e._wrapT},set:function(n){return e.wrapT=n}}]);this._wrapVector=o;s=[this._shape[0],this._shape[1]];Object.defineProperties(s,[{get:function(){return e._shape[0]},set:function(n){return e.width=n}},{get:function(){return e._shape[1]},set:function(n){return e.height=n}}]);this._shapeVector=s}function v(n,t){return n.length===3?t[2]===1&&t[1]===n[0]*n[2]&&t[0]===n[2]:t[0]===1&&t[1]===n[0]}function w(n,t,r,f,e,o,h,l){var k=l.dtype,a=l.shape.slice(),tt,p,d,b,nt;if(a.length<2||a.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var w=0,y=0,g=v(a,l.stride.slice());if(k==="float32"?w=n.FLOAT:k==="float64"?(w=n.FLOAT,g=!1,k="float32"):k==="uint8"?w=n.UNSIGNED_BYTE:(w=n.UNSIGNED_BYTE,g=!1,k="uint8"),tt=1,a.length===2)y=n.LUMINANCE,a=[a[0],a[1],1],l=u(l.data,a,[l.stride[0],l.stride[1],1],l.offset);else if(a.length===3){if(a[2]===1)y=n.ALPHA;else if(a[2]===2)y=n.LUMINANCE_ALPHA;else if(a[2]===3)y=n.RGB;else if(a[2]===4)y=n.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");tt=a[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((y===n.LUMINANCE||y===n.ALPHA)&&(e===n.LUMINANCE||e===n.ALPHA)&&(y=e),y!==e)throw new Error("gl-texture2d: Incompatible texture format for setPixels");p=l.size;d=h.indexOf(f)<0;d&&h.push(f);w===o&&g?l.offset===0&&l.data.length===p?d?n.texImage2D(n.TEXTURE_2D,f,e,a[0],a[1],0,e,o,l.data):n.texSubImage2D(n.TEXTURE_2D,f,t,r,a[0],a[1],e,o,l.data):d?n.texImage2D(n.TEXTURE_2D,f,e,a[0],a[1],0,e,o,l.data.subarray(l.offset,l.offset+p)):n.texSubImage2D(n.TEXTURE_2D,f,t,r,a[0],a[1],e,o,l.data.subarray(l.offset,l.offset+p)):(b=o===n.FLOAT?i.mallocFloat32(p):i.mallocUint8(p),nt=u(b,a,[a[2],a[2]*a[0],1]),w===n.FLOAT&&o===n.UNSIGNED_BYTE?c(nt,l):s.assign(nt,l),d?n.texImage2D(n.TEXTURE_2D,f,e,a[0],a[1],0,e,o,b.subarray(0,p)):n.texSubImage2D(n.TEXTURE_2D,f,t,r,a[0],a[1],e,o,b.subarray(0,p)),o===n.FLOAT?i.freeFloat32(b):i.freeUint8(b))}function a(n){var t=n.createTexture();return n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),t}function y(n,t,i,r,u){var f=n.getParameter(n.MAX_TEXTURE_SIZE),e;if(t<0||t>f||i<0||i>f)throw new Error("gl-texture2d: Invalid texture shape");if(u===n.FLOAT&&!n.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");return e=a(n),n.texImage2D(n.TEXTURE_2D,0,r,t,i,0,r,u,null),new o(n,e,t,i,r,u)}function b(n,t,i,r){var u=a(n);return n.texImage2D(n.TEXTURE_2D,0,i,i,r,t),new o(n,u,t.width|0,t.height|0,i,r)}function k(n,t){var h=t.dtype,r=t.shape.slice(),k=n.getParameter(n.MAX_TEXTURE_SIZE),l,f,e,w,p,y,d,b,g;if(r[0]<0||r[0]>k||r[1]<0||r[1]>k)throw new Error("gl-texture2d: Invalid texture size");if(l=v(r,t.stride.slice()),f=0,h==="float32"?f=n.FLOAT:h==="float64"?(f=n.FLOAT,l=!1,h="float32"):h==="uint8"?f=n.UNSIGNED_BYTE:(f=n.UNSIGNED_BYTE,l=!1,h="uint8"),e=0,r.length===2)e=n.LUMINANCE,r=[r[0],r[1],1],t=u(t.data,r,[t.stride[0],t.stride[1],1],t.offset);else if(r.length===3)if(r[2]===1)e=n.ALPHA;else if(r[2]===2)e=n.LUMINANCE_ALPHA;else if(r[2]===3)e=n.RGB;else if(r[2]===4)e=n.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");return f!==n.FLOAT||n.getExtension("OES_texture_float")||(f=n.UNSIGNED_BYTE,l=!1),y=t.size,l?w=t.offset===0&&t.data.length===y?t.data:t.data.subarray(t.offset,t.offset+y):(d=[r[2],r[2]*r[0],1],p=i.malloc(y,h),b=u(p,r,d,0),(h==="float32"||h==="float64")&&f===n.UNSIGNED_BYTE?c(b,t):s.assign(b,t),w=p.subarray(0,y)),g=a(n),n.texImage2D(n.TEXTURE_2D,0,e,r[0],r[1],0,e,f,w),l||i.free(p),new o(n,g,r[0],r[1],e,f)}function d(n){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(f||p(n),typeof arguments[1]=="number")return y(n,arguments[1],arguments[2],arguments[3]||n.RGBA,arguments[4]||n.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return y(n,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||n.RGBA,arguments[3]||n.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData)return b(n,t,arguments[2]||n.RGBA,arguments[3]||n.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return k(n,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor");}var u=n("ndarray"),s=n("ndarray-ops"),i=n("typedarray-pool"),c,r;t.exports=d;var f=null,h=null,e=null;c=function(n,t){s.muls(n,t,255)};r=o.prototype;Object.defineProperties(r,{minFilter:{get:function(){return this._minFilter},set:function(n){this.bind();var t=this.gl;if(this.type===t.FLOAT&&f.indexOf(n)>=0&&(t.getExtension("OES_texture_float_linear")||(n=t.NEAREST)),h.indexOf(n)<0)throw new Error("gl-texture2d: Unknown filter mode "+n);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),this._minFilter=n}},magFilter:{get:function(){return this._magFilter},set:function(n){this.bind();var t=this.gl;if(this.type===t.FLOAT&&f.indexOf(n)>=0&&(t.getExtension("OES_texture_float_linear")||(n=t.NEAREST)),h.indexOf(n)<0)throw new Error("gl-texture2d: Unknown filter mode "+n);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),this._magFilter=n}},mipSamples:{get:function(){return this._anisoSamples},set:function(n){var i=this._anisoSamples,t;return this._anisoSamples=Math.max(n,1)|0,i!==this._anisoSamples&&(t=gl.getExtension("EXT_texture_filter_anisotropic"),t&&this.gl.texParameterf(this.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)),this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(n){if(this.bind(),e.indexOf(n)<0)throw new Error("gl-texture2d: Unknown wrap mode "+n);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,n),this._wrapS=n}},wrapT:{get:function(){return this._wrapT},set:function(n){if(this.bind(),e.indexOf(n)<0)throw new Error("gl-texture2d: Unknown wrap mode "+n);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,n),this._wrapT=n}},wrap:{get:function(){return this._wrapVector},set:function(n){var i,t;if(Array.isArray(n)||(n=[n,n]),n.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(i=0;i<2;++i)if(e.indexOf(n[i])<0)throw new Error("gl-texture2d: Unknown wrap mode "+n);return this._wrapS=n[0],this._wrapT=n[1],t=this.gl,this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this._wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this._wrapT),n}},shape:{get:function(){return this._shapeVector},set:function(n){if(Array.isArray(n)){if(n.length!==2)throw new Error("gl-texture2d: Invalid texture shape");}else n=[n|0,n|0];return l(this,n[0]|0,n[1]|0),[n[0]|0,n[1]|0]}},width:{get:function(){return this._shape[0]},set:function(n){return n=n|0,l(this,n,this._shape[1]),n}},height:{get:function(){return this._shape[1]},set:function(n){return n=n|0,l(this,this._shape[0],n),n}}});r.bind=function(n){var t=this.gl;return(n!==undefined&&t.activeTexture(t.TEXTURE0+(n|0)),t.bindTexture(t.TEXTURE_2D,this.handle),n!==undefined)?n|0:t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};r.dispose=function(){this.gl.deleteTexture(this.handle)};r.generateMipmap=function(){var t,n;for(this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D),t=Math.min(this._shape[0],this._shape[1]),n=0;t>0;++n,t>>>=1)this._mipLevels.indexOf(n)<0&&this._mipLevels.push(n)};r.setPixels=function(n,t,i,r){var u=this.gl,f;if(this.bind(),Array.isArray(t)?(r=i,i=t[1]|0,t=t[0]|0):(t=t||0,i=i||0),r=r||0,n instanceof HTMLCanvasElement||n instanceof ImageData||n instanceof HTMLImageElement||n instanceof HTMLVideoElement)f=this._mipLevels.indexOf(r)<0,f?(u.texImage2D(u.TEXTURE_2D,0,this.format,this.format,this.type,n),this._mipLevels.push(r)):u.texSubImage2D(u.TEXTURE_2D,r,t,i,this.format,this.type,n);else if(n.shape&&n.stride&&n.data){if(n.shape.length<2||t+n.shape[1]>this._shape[1]>>>r||i+n.shape[0]>this._shape[0]>>>r||t<0||i<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");w(u,t,i,r,this.format,this.type,this._mipLevels,n)}else throw new Error("gl-texture2d: Unsupported data type");}},{ndarray:525,"ndarray-ops":524,"typedarray-pool":550}],303:[function(n,t){"use strict";function i(n,t,i){var f,r,u;if(t?t.bind():n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),f=n.getParameter(n.MAX_VERTEX_ATTRIBS)|0,i){if(i.length>f)throw new Error("gl-vao: Too many vertex attributes");for(u=0;u<i.length;++u)if(r=i[u],r.buffer){var e=r.buffer,o=r.size||4,s=r.type||n.FLOAT,h=!!r.normalized,c=r.stride||0,l=r.offset||0;e.bind();n.enableVertexAttribArray(u);n.vertexAttribPointer(u,o,s,h,c,l)}else{if(typeof r=="number")n.vertexAttrib1f(u,r);else if(r.length===1)n.vertexAttrib1f(u,r[0]);else if(r.length===2)n.vertexAttrib2f(u,r[0],r[1]);else if(r.length===3)n.vertexAttrib3f(u,r[0],r[1],r[2]);else if(r.length===4)n.vertexAttrib4f(u,r[0],r[1],r[2],r[3]);else throw new Error("gl-vao: Invalid vertex attribute");n.disableVertexAttribArray(u)}for(;u<f;++u)n.disableVertexAttribArray(u)}else for(n.bindBuffer(n.ARRAY_BUFFER,null),u=0;u<f;++u)n.disableVertexAttribArray(u)}t.exports=i},{}],304:[function(n,t){"use strict";function i(n){this.gl=n;this._elements=null;this._attributes=null;this._elementsType=n.UNSIGNED_SHORT}function u(n){return new i(n)}var r=n("./do-bind.js");i.prototype.bind=function(){r(this.gl,this._elements,this._attributes)};i.prototype.update=function(n,t,i){this._elements=t;this._attributes=n;this._elementsType=i||this.gl.UNSIGNED_SHORT};i.prototype.dispose=function(){};i.prototype.unbind=function(){};i.prototype.draw=function(n,t,i){i=i||0;var r=this.gl;this._elements?r.drawElements(n,t,this._elementsType,i):r.drawArrays(n,i,t)};t.exports=u},{"./do-bind.js":303}],305:[function(n,t){"use strict";function r(n,t,i,r,u,f){this.location=n;this.dimension=t;this.a=i;this.b=r;this.c=u;this.d=f}function i(n,t,i){this.gl=n;this._ext=t;this.handle=i;this._attribs=[];this._useElements=!1;this._elementsType=n.UNSIGNED_SHORT}function f(n,t){return new i(n,t,t.createVertexArrayOES())}var u=n("./do-bind.js");r.prototype.bind=function(n){switch(this.dimension){case 1:n.vertexAttrib1f(this.location,this.a);break;case 2:n.vertexAttrib2f(this.location,this.a,this.b);break;case 3:n.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:n.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}};i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var n=0;n<this._attribs.length;++n)this._attribs[n].bind(this.gl)};i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};i.prototype.update=function(n,t,i){var e,f;if(this.bind(),u(this.gl,t,n),this.unbind(),this._attribs.length=0,n)for(e=0;e<n.length;++e)f=n[e],typeof f=="number"?this._attribs.push(new r(e,1,f)):Array.isArray(f)&&this._attribs.push(new r(e,f.length,f[0],f[1],f[2],f[3]));this._useElements=!!t;this._elementsType=i||this.gl.UNSIGNED_SHORT};i.prototype.draw=function(n,t,i){i=i||0;var r=this.gl;this._useElements?r.drawElements(n,t,this._elementsType,i):r.drawArrays(n,i,t)};t.exports=f},{"./do-bind.js":303}],306:[function(n,t){"use strict";function u(n,t,u,f){var o=n.getExtension("OES_vertex_array_object"),e;return e=o?i(n,o):r(n),e.update(t,u,f),e}var i=n("./lib/vao-native.js"),r=n("./lib/vao-emulated.js");t.exports=u},{"./lib/vao-emulated.js":304,"./lib/vao-native.js":305}],307:[function(n,t){function i(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3];return n[0]=i[0]*r+i[4]*u+i[8]*f+i[12]*e,n[1]=i[1]*r+i[5]*u+i[9]*f+i[13]*e,n[2]=i[2]*r+i[6]*u+i[10]*f+i[14]*e,n[3]=i[3]*r+i[7]*u+i[11]*f+i[15]*e,n}t.exports=i},{}],308:[function(n,t){function tt(n){function ft(n){n.length&&ht.push({type:nt[rt],data:n,position:et,line:yt,column:ct})}function dt(n){tt=0;st+=n;bt=st.length;for(var e;t=st[tt],tt<bt;){e=tt;switch(rt){case u:tt=ri();break;case f:tt=ii();break;case s:tt=kt();break;case h:tt=ui();break;case c:tt=ei();break;case a:tt=fi();break;case r:tt=oi();break;case o:tt=si();break;case l:tt=ti();break;case i:tt=ni()}if(e!==tt)switch(st[e]){case"\n":ct=0;++yt;break;default:++ct}}return ot+=tt,st=st.slice(tt),ht}function gt(){return it.length&&ft(it.join("")),rt=g,ft("(eof)"),ht}function ni(){return(it=it.length?[]:it,ut==="/"&&t==="*")?(et=ot+tt-1,rt=u,ut=t,tt+1):ut==="/"&&t==="/"?(et=ot+tt-1,rt=f,ut=t,tt+1):t==="#"?(rt=s,et=ot+tt,tt):/\s/.test(t)?(rt=l,et=ot+tt,tt):(pt=/\d/.test(t),wt=/[^\w_]/.test(t),et=ot+tt,rt=pt?c:wt?h:o,tt)}function ti(){return/[^\s]/g.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function kt(){return t==="\n"&&ut!=="\\"?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function ii(){return kt()}function ri(){return t==="/"&&ut==="*"?(it.push(t),ft(it.join("")),rt=i,tt+1):(it.push(t),ut=t,tt+1)}function ui(){if(ut==="."&&/\d/.test(t))return rt=r,tt;if(ut==="/"&&t==="*")return rt=u,tt;if(ut==="/"&&t==="/")return rt=f,tt;if(t==="."&&it.length){while(vt(it));return rt=r,tt}if(t===";"||t===")"||t==="("){if(it.length)while(vt(it));return ft(t),rt=i,tt+1}var n=it.length===2&&t!=="=";if(/[\w_\d\s]/.test(t)||n){while(vt(it));return rt=i,tt}return it.push(t),ut=t,tt+1}function vt(n){var r=0,i,t;do{if(i=e.indexOf(n.slice(0,n.length+r).join("")),t=e[i],i===-1){if(r--+n.length>0)continue;t=n.slice(0,1).join("")}return ft(t),et+=t.length,it=it.slice(t.length),it.length}while(1)}function fi(){return/[^a-fA-F0-9]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function ei(){return t==="."?(it.push(t),rt=r,ut=t,tt+1):/[eE]/.test(t)?(it.push(t),rt=r,ut=t,tt+1):t==="x"&&it.length===1&&it[0]==="0"?(rt=a,it.push(t),ut=t,tt+1):/[^\d]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function oi(){return(t==="f"&&(it.push(t),ut=t,tt+=1),/[eE]/.test(t))?(it.push(t),ut=t,tt+1):t==="-"&&/[eE]/.test(ut)?(it.push(t),ut=t,tt+1):/[^\d]/.test(t)?(ft(it.join("")),rt=i,tt):(it.push(t),ut=t,tt+1)}function si(){if(/[^\d\w_]/.test(t)){var n=it.join("");return rt=at.indexOf(n)>-1?d:lt.indexOf(n)>-1?k:b,ft(it.join("")),rt=i,tt}return it.push(t),ut=t,tt+1}var tt=0,ot=0,rt=i,t,ut,it=[],ht=[],yt=1,ct=0,et=0,pt=!1,wt=!1,st="",bt,lt,at;return n=n||{},lt=y,at=v,n.version==="300 es"&&(lt=w,at=p),function(n){return(ht=[],n!==null)?dt(n):gt()}}t.exports=tt;var v=n("./lib/literals"),e=n("./lib/operators"),y=n("./lib/builtins"),p=n("./lib/literals-300es"),w=n("./lib/builtins-300es"),i=999,o=9999,u=0,f=1,s=2,h=3,c=4,r=5,b=6,k=7,d=8,l=9,g=10,a=11,nt=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":310,"./lib/builtins-300es":309,"./lib/literals":312,"./lib/literals-300es":311,"./lib/operators":313}],309:[function(n,t,i){arguments[4][235][0].apply(i,arguments)},{"./builtins":310,dup:235}],310:[function(n,t,i){arguments[4][236][0].apply(i,arguments)},{dup:236}],311:[function(n,t,i){arguments[4][237][0].apply(i,arguments)},{"./literals":312,dup:237}],312:[function(n,t,i){arguments[4][238][0].apply(i,arguments)},{dup:238}],313:[function(n,t,i){arguments[4][239][0].apply(i,arguments)},{dup:239}],314:[function(n,t,i){arguments[4][240][0].apply(i,arguments)},{"./index":308,dup:240}],315:[function(n,t){"use strict";function u(n,t,i){this.vertices=n;this.adjacent=t;this.boundary=i;this.lastVisited=-1}function s(n,t,i){this.vertices=n;this.cell=t;this.index=i}function h(n,t){return e(n.vertices,t.vertices)}function c(n){for(var f,u,t=["function orient(){var tuple=this.tuple;return test("],i=0;i<=n;++i)i>0&&t.push(","),t.push("tuple[",i,"]");return t.push(")}return orient"),f=new Function("test",t.join("")),u=r[n+1],u||(u=r),f(u)}function o(n,t,i){var r,u;for(this.dimension=n,this.vertices=t,this.simplices=i,this.interior=i.filter(function(n){return!n.boundary}),this.tuple=new Array(n+1),r=0;r<=n;++r)this.tuple[r]=this.vertices[r];u=f[n];u||(u=f[n]=c(n));this.orient=u}function l(n,t){var a=n.length,f,v,y,h,nt,b,s,k,e,d,l,g,tt,i;if(a===0)throw new Error("Must have at least d+1 points");if(f=n[0].length,a<=f)throw new Error("Must input at least d+1 points");if(v=n.slice(0,f+1),y=r.apply(void 0,v),y===0)throw new Error("Input not in general position");for(h=new Array(f+1),i=0;i<=f;++i)h[i]=i;y<0&&(h[0]=1,h[1]=0);var p=new u(h,new Array(f+1),!1),c=p.adjacent,w=new Array(f+2);for(i=0;i<=f;++i){for(s=h.slice(),e=0;e<=f;++e)e===i&&(s[e]=-1);nt=s[0];s[0]=s[1];s[1]=nt;b=new u(s,new Array(f+1),!0);c[i]=b;w[i]=b}for(w[f+1]=p,i=0;i<=f;++i)for(s=c[i].vertices,k=c[i].adjacent,e=0;e<=f;++e){if(d=s[e],d<0){k[e]=p;continue}for(l=0;l<=f;++l)c[l].vertices.indexOf(d)<0&&(k[e]=c[l])}for(g=new o(f,v,w),tt=!!t,i=f+1;i<a;++i)g.insert(n[i],tt);return g.boundary()}var r,e,f,i;t.exports=l;r=n("robust-orientation");e=n("simplicial-complex").compareCells;u.prototype.flip=function(){var t=this.vertices[0],n;this.vertices[0]=this.vertices[1];this.vertices[1]=t;n=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=n};f=[];i=o.prototype;i.handleBoundaryDegeneracy=function(n,t){var h=this.dimension,f=this.vertices.length-1,a=this.tuple,v=this.vertices,e=[n],y,c,u,i,l,r,o,s;for(n.lastVisited=-f;e.length>0;)for(n=e.pop(),y=n.vertices,c=n.adjacent,u=0;u<=h;++u)if(i=c[u],i.boundary&&!(i.lastVisited<=-f)){for(l=i.vertices,r=0;r<=h;++r)o=l[r],a[r]=o<0?t:v[o];if(s=this.orient(),s>0)return i;i.lastVisited=-f;s===0&&e.push(i)}return null};i.walk=function(n,t){var f=this.vertices.length-1,o=this.dimension,a=this.vertices,e=this.tuple,v=t?this.interior.length*Math.random()|0:this.interior.length-1,r=this.interior[v],s,h,i,u,c,l;n:while(!r.boundary){for(s=r.vertices,h=r.adjacent,i=0;i<=o;++i)e[i]=a[s[i]];for(r.lastVisited=f,i=0;i<=o;++i)if(u=h[i],!(u.lastVisited>=f))if(c=e[i],e[i]=n,l=this.orient(),e[i]=c,l<0){r=u;continue n}else u.lastVisited=u.boundary?-f:f;return}return r};i.addPeaks=function(n,t){var e=this.vertices.length-1,c=this.dimension,lt=this.vertices,ft=this.tuple,et=this.interior,at=this.simplices,b=[t],o,f,v,g,st,tt,i,it,rt,ct,a,ut,r;for(t.lastVisited=e,t.vertices[t.vertices.indexOf(-1)]=e,t.boundary=!1,et.push(t),o=[];b.length>0;){var t=b.pop(),ot=t.vertices,k=t.adjacent,d=ot.indexOf(e);if(!(d<0))for(r=0;r<=c;++r)if(r!==d&&(f=k[r],f.boundary&&!(f.lastVisited>=e))){if(v=f.vertices,f.lastVisited!==-e){for(g=0,i=0;i<=c;++i)v[i]<0?(g=i,ft[i]=n):ft[i]=lt[v[i]];if(st=this.orient(),st>0){v[g]=e;f.boundary=!1;et.push(f);b.push(f);f.lastVisited=e;continue}else f.lastVisited=-e}var ht=f.adjacent,y=ot.slice(),nt=k.slice(),l=new u(y,nt,!0);if(at.push(l),tt=ht.indexOf(t),!(tt<0))for(ht[tt]=l,nt[d]=f,y[r]=-1,nt[r]=t,k[r]=l,l.flip(),i=0;i<=c;++i)if(it=y[i],!(it<0)&&it!==e){for(rt=new Array(c-1),ct=0,a=0;a<=c;++a)(ut=y[a],ut<0||a===i)||(rt[ct++]=ut);o.push(new s(rt,l,i))}}}for(o.sort(h),r=0;r+1<o.length;r+=2){var p=o[r],w=o[r+1],vt=p.index,yt=w.index;vt<0||yt<0||(p.cell.adjacent[p.index]=w.cell,w.cell.adjacent[w.index]=p.cell)}};i.insert=function(n,t){var o=this.vertices,i,s,u,r,f,e;if(o.push(n),i=this.walk(n,t),i){for(s=this.dimension,u=this.tuple,r=0;r<=s;++r)f=i.vertices[r],u[r]=f<0?n:o[f];(e=this.orient(u),e<0)||(e!==0||(i=this.handleBoundaryDegeneracy(i,n),i))&&this.addPeaks(n,i)}};i.boundary=function(){for(var u,t,h,i=this.dimension,f=[],e=this.simplices,c=e.length,r=0;r<c;++r)if(u=e[r],u.boundary){var n=new Array(i),o=u.vertices,l=0,s=0;for(t=0;t<=i;++t)o[t]>=0?n[l++]=o[t]:s=t&1;s===(i&1)&&(h=n[0],n[0]=n[1],n[1]=h);f.push(n)}return f}},{"robust-orientation":531,"simplicial-complex":318}],316:[function(n,t,i){arguments[4][56][0].apply(i,arguments)},{dup:56}],317:[function(n,t,i){arguments[4][113][0].apply(i,arguments)},{dup:113}],318:[function(n,t,i){"use strict";"use restrict";function l(n){for(var t=0,r=Math.max,i=0,u=n.length;i<u;++i)t=r(t,n[i].length);return t-1}function a(n){for(var u,t,f,i=-1,e=Math.max,r=0,o=n.length;r<o;++r)for(u=n[r],t=0,f=u.length;t<f;++t)i=e(i,u[t]);return i+1}function v(n){for(var i=new Array(n.length),t=0,r=n.length;t<r;++t)i[t]=n[t].slice(0);return i}function r(n,t){var c=n.length,u=n.length-t.length,i=Math.min,r,e,o,s,h,f;if(u)return u;switch(c){case 0:return 0;case 1:return n[0]-t[0];case 2:return(r=n[0]+n[1]-t[0]-t[1],r)?r:i(n[0],n[1])-i(t[0],t[1]);case 3:if(e=n[0]+n[1],o=t[0]+t[1],r=e+n[2]-(o+t[2]),r)return r;var l=i(n[0],n[1]),a=i(t[0],t[1]),r=i(l,n[2])-i(a,t[2]);return r?r:i(l+n[2],e)-i(a+t[2],o);default:for(s=n.slice(0),s.sort(),h=t.slice(0),h.sort(),f=0;f<c;++f)if(u=s[f]-h[f],u)return u;return 0}}function y(n,t){return r(n[0],t[0])}function u(n,t){var f,u,i;if(t){for(f=n.length,u=new Array(f),i=0;i<f;++i)u[i]=[n[i],t[i]];for(u.sort(y),i=0;i<f;++i)n[i]=u[i][0],t[i]=u[i][1];return n}return n.sort(r),n}function e(n){var i,f,t,u;if(n.length===0)return[];for(i=1,f=n.length,t=1;t<f;++t)if(u=n[t],r(u,n[t-1])){if(t===i){i++;continue}n[i++]=u}return n.length=i,n}function f(n,t){for(var f=0,e=n.length-1,o=-1,i,u;f<=e;)i=f+e>>1,u=r(n[i],t),u<=0?(u===0&&(o=i),f=i+1):u>0&&(e=i-1);return o}function c(n,t){for(var u,v,l,a,e,y,p,o,h,c=new Array(n.length),i=0,w=c.length;i<w;++i)c[i]=[];for(u=[],i=0,v=t.length;i<v;++i)for(l=t[i],a=l.length,e=1,y=1<<a;e<y;++e){for(u.length=s.popCount(e),p=0,o=0;o<a;++o)e&1<<o&&(u[p++]=l[o]);if(h=f(n,u),!(h<0))for(;;)if(c[h++].push(i),h>=n.length||r(n[h],u)!==0)break}return c}function p(n,t){var r,i,s,f,u,h;if(!t)return c(e(o(n,0)),n,0);for(r=new Array(t),i=0;i<t;++i)r[i]=[];for(i=0,s=n.length;i<s;++i)for(f=n[i],u=0,h=f.length;u<h;++u)r[f[u]].push(i);return r}function w(n){for(var f,e,i,h,o,t,s=[],r=0,c=n.length;r<c;++r)for(f=n[r],e=f.length|0,i=1,h=1<<e;i<h;++i){for(o=[],t=0;t<e;++t)i>>>t&1&&o.push(f[t]);s.push(o)}return u(s)}function o(n,t){var o,c,f,e,i,h,l,r;if(t<0)return[];for(o=[],c=(1<<t+1)-1,f=0;f<n.length;++f)for(e=n[f],i=c;i<1<<e.length;i=s.nextCombination(i)){for(h=new Array(t+1),l=0,r=0;r<e.length;++r)i&1<<r&&(h[l++]=e[r]);o.push(h)}return u(o)}function b(n){for(var i,r,e,o,t,h,s=[],f=0,c=n.length;f<c;++f)for(i=n[f],r=0,e=i.length;r<e;++r){for(o=new Array(i.length-1),t=0,h=0;t<e;++t)t!==r&&(o[h++]=i[t]);s.push(o)}return u(s)}function k(n,t){for(var u,f,o,e,r,s,c=new h(t),i=0;i<n.length;++i)for(u=n[i],f=0;f<u.length;++f)for(o=f+1;o<u.length;++o)c.link(u[f],u[o]);for(e=[],r=c.ranks,i=0;i<r.length;++i)r[i]=-1;for(i=0;i<n.length;++i)s=c.find(n[i][0]),r[s]<0?(r[s]=e.length,e.push([n[i].slice(0)])):e[r[s]].push(n[i].slice(0));return e}function d(n){for(var r,s,p,a,c,i,v,l=e(u(o(n,0))),y=new h(l.length),t=0;t<n.length;++t)for(r=n[t],s=0;s<r.length;++s)for(p=f(l,[r[s]]),a=s+1;a<r.length;++a)y.link(p,f(l,[r[a]]));for(c=[],i=y.ranks,t=0;t<i.length;++t)i[t]=-1;for(t=0;t<n.length;++t)v=y.find(f(l,[n[t][0]])),i[v]<0?(i[v]=c.length,c.push([n[t].slice(0)])):c[i[v]].push(n[t].slice(0));return c}function g(n,t){return t?k(n,t):d(n)}var s=n("bit-twiddle"),h=n("union-find");i.dimension=l;i.countVertices=a;i.cloneCells=v;i.compareCells=r;i.normalize=u;i.unique=e;i.findCell=f;i.incidence=c;i.dual=p;i.explode=w;i.skeleton=o;i.boundary=b;i.connectedComponents=g},{"bit-twiddle":316,"union-find":317}],319:[function(n,t){"use strict";function i(n){for(var i=new Array(n),t=0;t<n;++t)i[t]=t;return i}t.exports=i},{}],320:[function(n,t){t.exports=function(n){return!!(n!=null&&(n._isBuffer||n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)))}},{}],321:[function(n,t){"use strict";function i(n){var u=n.layoutVertexArrayType,t,i;this.layoutVertexArray=new u;t=n.elementArrayType;t&&(this.elementArray=new t);i=n.elementArrayType2;i&&(this.elementArray2=new i);this.paintVertexArrays=r.mapObject(n.paintVertexArrayTypes,function(n){return new n})}var r=n("../util/util");t.exports=i;i.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;i.prototype.hasCapacityFor=function(n){return this.layoutVertexArray.length+n<=i.MAX_VERTEX_ARRAY_LENGTH};i.prototype.isEmpty=function(){return this.layoutVertexArray.length===0};i.prototype.trim=function(){this.layoutVertexArray.trim();this.elementArray&&this.elementArray.trim();this.elementArray2&&this.elementArray2.trim();for(var n in this.paintVertexArrays)this.paintVertexArrays[n].trim()};i.prototype.serialize=function(){return{layoutVertexArray:this.layoutVertexArray.serialize(),elementArray:this.elementArray&&this.elementArray.serialize(),elementArray2:this.elementArray2&&this.elementArray2.serialize(),paintVertexArrays:r.mapObject(this.paintVertexArrays,function(n){return n.serialize()})}};i.prototype.getTransferables=function(n){n.push(this.layoutVertexArray.arrayBuffer);this.elementArray&&n.push(this.elementArray.arrayBuffer);this.elementArray2&&n.push(this.elementArray2.arrayBuffer);for(var t in this.paintVertexArrays)n.push(this.paintVertexArrays[t].arrayBuffer)}},{"../util/util":435}],322:[function(n,t){"use strict";function i(n){if(this.zoom=n.zoom,this.overscaling=n.overscaling,this.layer=n.layer,this.childLayers=n.childLayers,this.type=this.layer.type,this.features=[],this.id=this.layer.id,this.index=n.index,this.sourceLayer=this.layer.sourceLayer,this.sourceLayerIndex=n.sourceLayerIndex,this.minZoom=this.layer.minzoom,this.maxZoom=this.layer.maxzoom,this.paintAttributes=c(this),n.arrays){var t=this.programInterfaces;this.bufferGroups=r.mapObject(n.arrays,function(i,r){var u=t[r],f=n.paintVertexArrayTypes[r];return i.map(function(n){return new h(n,{layoutVertexArrayType:u.layoutVertexArrayType.serialize(),elementArrayType:u.elementArrayType&&u.elementArrayType.serialize(),elementArrayType2:u.elementArrayType2&&u.elementArrayType2.serialize(),paintVertexArrayTypes:f})})})}}function c(n){var et={},tt,it,v,ot,y,o,s,p,i,w,st,rt,g,nt,ut,ft,h;for(tt in n.programInterfaces){for(it=et[tt]={},v=0;v<n.childLayers.length;v++)ot=n.childLayers[v],it[ot.id]={attributes:[],uniforms:[],defines:[],vertexPragmas:{define:{},initialize:{}},fragmentPragmas:{define:{},initialize:{}}};if(y=n.programInterfaces[tt],y.paintAttributes)for(o="{precision}",s="{type}",p=0;p<y.paintAttributes.length;p++)for(i=y.paintAttributes[p],i.multiplier=i.multiplier||1,w=0;w<n.childLayers.length;w++){var b=n.childLayers[w],u=it[b.id],f=i.name,t=i.name.slice(2),c;if(u.fragmentPragmas.initialize[t]="",b.isPaintValueFeatureConstant(i.paintProperty))u.uniforms.push(i),u.fragmentPragmas.define[t]=u.vertexPragmas.define[t]=["uniform",o,s,f].join(" ")+";",u.fragmentPragmas.initialize[t]=u.vertexPragmas.initialize[t]=[o,s,t,"=",f].join(" ")+";\n";else if(b.isPaintValueZoomConstant(i.paintProperty))u.attributes.push(r.extend({},i,{name:f})),c=["varying",o,s,t].join(" ")+";\n",st=[u.fragmentPragmas.define[t],"attribute",o,s,f].join(" ")+";\n",u.fragmentPragmas.define[t]=c,u.vertexPragmas.define[t]=c+st,u.vertexPragmas.initialize[t]=[t,"=",f,"/",i.multiplier.toFixed(1)].join(" ")+";\n";else{for(var k="u_"+f.slice(2)+"_t",a=b.getPaintValueStopZoomLevels(i.paintProperty),d=0;d<a.length&&a[d]<n.zoom;)d++;for(rt=Math.max(0,Math.min(a.length-4,d-2)),g=[],nt=0;nt<4;nt++)g.push(a[Math.min(rt+nt,a.length-1)]);if(c=["varying",o,s,t].join(" ")+";\n",u.vertexPragmas.define[t]=c+["uniform","lowp","float",k].join(" ")+";\n",u.fragmentPragmas.define[t]=c,u.uniforms.push(r.extend({},i,{name:k,getValue:l(i,rt),components:1})),ut=i.components,ut===1)u.attributes.push(r.extend({},i,{getValue:e(i,g),isFunction:!0,components:ut*4})),u.vertexPragmas.define[t]+=["attribute",o,"vec4",f].join(" ")+";\n",u.vertexPragmas.initialize[t]=[t,"=","evaluate_zoom_function_1("+f+", "+k+")","/",i.multiplier.toFixed(1)].join(" ")+";\n";else{for(ft=[],h=0;h<4;h++)ft.push(f+h),u.attributes.push(r.extend({},i,{getValue:e(i,[g[h]]),isFunction:!0,name:f+h})),u.vertexPragmas.define[t]+=["attribute",o,s,f+h].join(" ")+";\n";u.vertexPragmas.initialize[t]=[t," = ","evaluate_zoom_function_4("+ft.join(", ")+", "+k+")","/",i.multiplier.toFixed(1)].join(" ")+";\n"}}}}return et}function e(n,t){return function(i,u,f){var o,e,s;if(t.length===1)return n.getValue(i,r.extend({},u,{zoom:t[0]}),f);for(o=[],e=0;e<t.length;e++)s=t[e],o.push(n.getValue(i,r.extend({},u,{zoom:s}),f)[0]);return o}}function l(n,t){return function(i,r){var u=i.getPaintInterpolationT(n.paintProperty,r.zoom);return[Math.max(0,Math.min(4,u-t))]}}var o=n("feature-filter"),s=n("./array_group"),h=n("./buffer_group"),r=n("../util/util"),u=n("../util/struct_array"),f;t.exports=i;i.create=function(t){var i={fill:n("./bucket/fill_bucket"),line:n("./bucket/line_bucket"),circle:n("./bucket/circle_bucket"),symbol:n("./bucket/symbol_bucket")};return new i[t.layer.type](t)};i.EXTENT=8192;i.prototype.populateArrays=function(){this.createArrays();this.recalculateStyleLayers();for(var n=0;n<this.features.length;n++)this.addFeature(this.features[n]);this.trimArrays()};i.prototype.prepareArrayGroup=function(n,t){var r=this.arrayGroups[n],i=r.length&&r[r.length-1];return i&&i.hasCapacityFor(t)||(i=new s({layoutVertexArrayType:this.programInterfaces[n].layoutVertexArrayType,elementArrayType:this.programInterfaces[n].elementArrayType,elementArrayType2:this.programInterfaces[n].elementArrayType2,paintVertexArrayTypes:this.paintVertexArrayTypes[n]}),i.index=r.length,r.push(i)),i};i.prototype.createArrays=function(){var n,u,t,r;this.arrayGroups={};this.paintVertexArrayTypes={};for(n in this.programInterfaces){this.arrayGroups[n]=[];u=this.paintVertexArrayTypes[n]={};t=this.paintAttributes[n];for(r in t)u[r]=new i.VertexArrayType(t[r].attributes)}};i.prototype.destroy=function(n){var r,i,t;for(r in this.bufferGroups)for(i=this.bufferGroups[r],t=0;t<i.length;t++)i[t].destroy(n)};i.prototype.trimArrays=function(){var i,t,n;for(i in this.arrayGroups)for(t=this.arrayGroups[i],n=0;n<t.length;n++)t[n].trim()};i.prototype.isEmpty=function(){var i,t,n;for(i in this.arrayGroups)for(t=this.arrayGroups[i],n=0;n<t.length;n++)if(!t[n].isEmpty())return!1;return!0};i.prototype.getTransferables=function(n){var r,i,t;for(r in this.arrayGroups)for(i=this.arrayGroups[r],t=0;t<i.length;t++)i[t].getTransferables(n)};i.prototype.setUniforms=function(n,t,i,r,u){for(var f,s,o=this.paintAttributes[t][r.id].uniforms,e=0;e<o.length;e++)f=o[e],s=i[f.name],n["uniform"+f.components+"fv"](s,f.getValue(r,u))};i.prototype.serialize=function(){return{layerId:this.layer.id,zoom:this.zoom,arrays:r.mapObject(this.arrayGroups,function(n){return n.map(function(n){return n.serialize()})}),paintVertexArrayTypes:r.mapObject(this.paintVertexArrayTypes,function(n){return r.mapObject(n,function(n){return n.serialize()})}),childLayerIds:this.childLayers.map(function(n){return n.id})}};i.prototype.createFilter=function(){this.filter||(this.filter=o(this.layer.filter))};f={lastIntegerZoom:Infinity,lastIntegerZoomTime:0,lastZoom:0};i.prototype.recalculateStyleLayers=function(){for(var n=0;n<this.childLayers.length;n++)this.childLayers[n].recalculate(this.zoom,f)};i.prototype.populatePaintArrays=function(n,t,i,r,u){for(var h,a,f,v,c,l,k,o,d,s=0;s<this.childLayers.length;s++)for(h=this.childLayers[s],a=this.arrayGroups[n],f=r.index;f<a.length;f++){var y=a[f],p=y.layoutVertexArray.length,w=y.paintVertexArrays[h.id];for(w.resize(p),v=this.paintAttributes[n][h.id].attributes,c=0;c<v.length;c++){var e=v[c],g=e.getValue(h,t,i),nt=e.multiplier||1,b=e.components||1,tt=f===r.index?u:0;for(l=tt;l<p;l++)for(k=w.get(l),o=0;o<b;o++)d=b>1?e.name+o:e.name,k[d]=g[o]*nt}}};i.VertexArrayType=function(n){return new u({members:n,alignment:4})};i.ElementArrayType=function(n){return new u({members:[{type:"Uint16",name:"vertices",components:n||3}]})}},{"../util/struct_array":433,"../util/util":435,"./array_group":321,"./bucket/circle_bucket":323,"./bucket/fill_bucket":324,"./bucket/line_bucket":325,"./bucket/symbol_bucket":326,"./buffer_group":328,"feature-filter":439}],323:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var i=n("../bucket"),f=n("../../util/util"),e=n("../load_geometry"),u=i.EXTENT;t.exports=r;r.prototype=f.inherit(i,{});r.prototype.addCircleVertex=function(n,t,i,r,u){return n.emplaceBack(t*2+(r+1)/2,i*2+(u+1)/2)};r.prototype.programInterfaces={circle:{layoutVertexArrayType:new i.VertexArrayType([{name:"a_pos",components:2,type:"Int16"}]),elementArrayType:new i.ElementArrayType,paintAttributes:[{name:"a_color",components:4,type:"Uint8",getValue:function(n,t,i){return n.getPaintValue("circle-color",t,i)},multiplier:255,paintProperty:"circle-color"},{name:"a_radius",components:1,type:"Uint16",isLayerConstant:!1,getValue:function(n,t,i){return[n.getPaintValue("circle-radius",t,i)]},multiplier:10,paintProperty:"circle-radius"},{name:"a_blur",components:1,type:"Uint16",isLayerConstant:!1,getValue:function(n,t,i){return[n.getPaintValue("circle-blur",t,i)]},multiplier:10,paintProperty:"circle-blur"},{name:"a_opacity",components:1,type:"Uint16",isLayerConstant:!1,getValue:function(n,t,i){return[n.getPaintValue("circle-opacity",t,i)]},multiplier:255,paintProperty:"circle-opacity"}]}};r.prototype.addFeature=function(n){for(var o,t,i,a={zoom:this.zoom},s=e(n),l=this.prepareArrayGroup("circle",0),v=l.layoutVertexArray.length,f=0;f<s.length;f++)for(o=0;o<s[f].length;o++)if(t=s[f][o].x,i=s[f][o].y,!(t<0)&&!(t>=u)&&!(i<0)&&!(i>=u)){var c=this.prepareArrayGroup("circle",4),h=c.layoutVertexArray,r=this.addCircleVertex(h,t,i,-1,-1);this.addCircleVertex(h,t,i,1,-1);this.addCircleVertex(h,t,i,1,1);this.addCircleVertex(h,t,i,-1,1);c.elementArray.emplaceBack(r,r+1,r+2);c.elementArray.emplaceBack(r,r+3,r+2)}this.populatePaintArrays("circle",a,n.properties,l,v)}},{"../../util/util":435,"../bucket":322,"../load_geometry":330}],324:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var i=n("../bucket"),u=n("../../util/util"),f=n("../load_geometry"),e=n("earcut"),o=n("../../util/classify_rings"),s=500;t.exports=r;r.prototype=u.inherit(i,{});r.prototype.programInterfaces={fill:{layoutVertexArrayType:new i.VertexArrayType([{name:"a_pos",components:2,type:"Int16"}]),elementArrayType:new i.ElementArrayType(1),elementArrayType2:new i.ElementArrayType(2),paintAttributes:[{name:"a_color",components:4,type:"Uint8",getValue:function(n,t,i){return n.getPaintValue("fill-color",t,i)},multiplier:255,paintProperty:"fill-color"},{name:"a_outline_color",components:4,type:"Uint8",getValue:function(n,t,i){return n.getPaintValue("fill-outline-color",t,i)},multiplier:255,paintProperty:"fill-outline-color"},{name:"a_opacity",components:1,type:"Uint8",getValue:function(n,t,i){return[n.getPaintValue("fill-opacity",t,i)]},multiplier:255,paintProperty:"fill-opacity"}]}};r.prototype.addFeature=function(n){for(var u=f(n),i=o(u,s),r=this.prepareArrayGroup("fill",0),e=r.layoutVertexArray.length,t=0;t<i.length;t++)this.addPolygon(i[t]);this.populatePaintArrays("fill",{zoom:this.zoom},n.properties,r,e)};r.prototype.addPolygon=function(n){for(var t,h,i,r,c,l,o,a=0,s=0;s<n.length;s++)a+=n[s].length;var u=this.prepareArrayGroup("fill",a),f=[],v=[],y=u.layoutVertexArray.length;for(t=0;t<n.length;t++)for(h=n[t],t>0&&v.push(f.length/2),i=0;i<h.length;i++)r=h[i],c=u.layoutVertexArray.emplaceBack(r.x,r.y),i>=1&&u.elementArray2.emplaceBack(c-1,c),f.push(r.x),f.push(r.y);for(l=e(f,v),o=0;o<l.length;o++)u.elementArray.emplaceBack(l[o]+y)}},{"../../util/classify_rings":423,"../../util/util":435,"../bucket":322,"../load_geometry":330,earcut:438}],325:[function(n,t){"use strict";function i(){r.apply(this,arguments)}var r=n("../bucket"),o=n("../../util/util"),s=n("../load_geometry"),h=r.EXTENT,f=63,c=Math.cos(75/2*(Math.PI/180)),l=15,e=15,u=1/2,a=Math.pow(2,e-1)/u;t.exports=i;i.prototype=o.inherit(r,{});i.prototype.addLineVertex=function(n,t,i,r,e,o,s){return n.emplaceBack(t.x<<1|r,t.y<<1|e,Math.round(f*i.x)+128,Math.round(f*i.y)+128,(o===0?0:o<0?-1:1)+1|(s*u&63)<<2,s*u>>6)};i.prototype.programInterfaces={line:{layoutVertexArrayType:new r.VertexArrayType([{name:"a_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}]),elementArrayType:new r.ElementArrayType}};i.prototype.addFeature=function(n){for(var i=s(n,e),t=0;t<i.length;t++)this.addLine(i[t],this.layer.layout["line-join"],this.layer.layout["line-cap"],this.layer.layout["line-miter-limit"],this.layer.layout["line-round-limit"])};i.prototype.addLine=function(n,t,i,r,u){for(var v=n.length,w,ct,ut,lt,s,wt,bt,d,at,g,ft,et,ot,vt,st;v>2&&n[v-1].equals(n[v-2]);)v--;if(!(n.length<2)){t==="bevel"&&(r=1.05);var nt=l*(h/(512*this.overscaling)),yt=n[0],kt=n[v-1],tt=yt.equals(kt);if(this.prepareArrayGroup("line",v*10),v!==2||!tt){this.distance=0;var dt=i,gt=tt?"butt":i,k=!0,f,p,a,o,e,it,rt;for(this.e1=this.e2=this.e3=-1,tt&&(f=n[v-2],e=yt.sub(f)._unit()._perp()),w=0;w<v;w++)if(a=tt&&w===v-1?n[1]:n[w+1],!a||!n[w].equals(a)){e&&(o=e);f&&(p=f);f=n[w];e=a?a.sub(f)._unit()._perp():o;o=o||e;var b=o.add(e)._unit(),ht=b.x*e.x+b.y*e.y,y=1/ht,pt=ht<c&&p&&a;if(pt&&w>0&&(ct=f.dist(p),ct>2*nt&&(ut=f.sub(f.sub(p)._mult(nt/ct)._round()),this.distance+=ut.dist(p),this.addCurrentVertex(ut,this.distance,o.mult(1),0,0,!1),p=ut)),lt=p&&a,s=lt?t:a?dt:gt,lt&&s==="round"&&(y<u?s="miter":y<=2&&(s="fakeround")),s==="miter"&&y>r&&(s="bevel"),s==="bevel"&&(y>2&&(s="flipbevel"),y<r&&(s="miter")),p&&(this.distance+=f.dist(p)),s==="miter")b._mult(y),this.addCurrentVertex(f,this.distance,b,0,0,!1);else if(s==="flipbevel")y>100?b=e.clone():(wt=o.x*e.y-o.y*e.x>0?-1:1,bt=y*o.add(e).mag()/o.sub(e).mag(),b._perp()._mult(bt*wt)),this.addCurrentVertex(f,this.distance,b,0,0,!1),this.addCurrentVertex(f,this.distance,b.mult(-1),0,0,!1);else if(s==="bevel"||s==="fakeround"){if(d=o.x*e.y-o.y*e.x>0,at=-Math.sqrt(y*y-1),d?(rt=0,it=at):(it=0,rt=at),k||this.addCurrentVertex(f,this.distance,o,it,rt,!1),s==="fakeround"){for(g=Math.floor((.5-(ht-.5))*8),et=0;et<g;et++)ft=e.mult((et+1)/(g+1))._add(o)._unit(),this.addPieSliceVertex(f,this.distance,ft,d);for(this.addPieSliceVertex(f,this.distance,b,d),ot=g-1;ot>=0;ot--)ft=o.mult((ot+1)/(g+1))._add(e)._unit(),this.addPieSliceVertex(f,this.distance,ft,d)}a&&this.addCurrentVertex(f,this.distance,e,-it,-rt,!1)}else s==="butt"?(k||this.addCurrentVertex(f,this.distance,o,0,0,!1),a&&this.addCurrentVertex(f,this.distance,e,0,0,!1)):s==="square"?(k||(this.addCurrentVertex(f,this.distance,o,1,1,!1),this.e1=this.e2=-1),a&&this.addCurrentVertex(f,this.distance,e,-1,-1,!1)):s==="round"&&(k||(this.addCurrentVertex(f,this.distance,o,0,0,!1),this.addCurrentVertex(f,this.distance,o,1,1,!0),this.e1=this.e2=-1),a&&(this.addCurrentVertex(f,this.distance,e,-1,-1,!0),this.addCurrentVertex(f,this.distance,e,0,0,!1)));pt&&w<v-1&&(vt=f.dist(a),vt>2*nt&&(st=f.add(a.sub(f)._mult(nt/vt)._round()),this.distance+=st.dist(f),this.addCurrentVertex(st,this.distance,e.mult(1),0,0,!1),f=st));k=!1}}}};i.prototype.addCurrentVertex=function(n,t,i,r,u,f){var o=f?1:0,e,s=this.arrayGroups.line[this.arrayGroups.line.length-1],h=s.layoutVertexArray,c=s.elementArray;e=i.clone();r&&e._sub(i.perp()._mult(r));this.e3=this.addLineVertex(h,n,e,o,0,r,t);this.e1>=0&&this.e2>=0&&c.emplaceBack(this.e1,this.e2,this.e3);this.e1=this.e2;this.e2=this.e3;e=i.mult(-1);u&&e._sub(i.perp()._mult(u));this.e3=this.addLineVertex(h,n,e,o,1,-u,t);this.e1>=0&&this.e2>=0&&c.emplaceBack(this.e1,this.e2,this.e3);this.e1=this.e2;this.e2=this.e3;t>a/2&&(this.distance=0,this.addCurrentVertex(n,this.distance,i,r,u,f))};i.prototype.addPieSliceVertex=function(n,t,i,r){var f=r?1:0;i=i.mult(r?-1:1);var u=this.arrayGroups.line[this.arrayGroups.line.length-1],e=u.layoutVertexArray,o=u.elementArray;this.e3=this.addLineVertex(e,n,i,0,f,0,t);this.e1>=0&&this.e2>=0&&o.emplaceBack(this.e1,this.e2,this.e3);r?this.e2=this.e3:this.e1=this.e3}},{"../../util/util":435,"../bucket":322,"../load_geometry":330}],326:[function(n,t){"use strict";function i(n){r.apply(this,arguments);this.showCollisionBoxes=n.showCollisionBoxes;this.overscaling=n.overscaling;this.collisionBoxArray=n.collisionBoxArray;this.symbolQuadsArray=n.symbolQuadsArray;this.symbolInstancesArray=n.symbolInstancesArray;this.sdfIcons=n.sdfIcons;this.iconsNeedLinear=n.iconsNeedLinear;this.adjustedTextSize=n.adjustedTextSize;this.adjustedIconSize=n.adjustedIconSize;this.fontstack=n.fontstack}function e(n,t,i,r,u,f,e,o,s,h,c){return n.emplaceBack(t,i,Math.round(r*64),Math.round(u*64),f/4,e/4,(h||0)*10,c,(o||0)*10,Math.min(s||25,25)*10)}var f=n("point-geometry"),r=n("../bucket"),y=n("../../symbol/anchor"),p=n("../../symbol/get_anchors"),h=n("../../util/token"),c=n("../../symbol/quads"),l=n("../../symbol/shaping"),w=n("../../symbol/resolve_text"),b=n("../../symbol/mergelines"),k=n("../../symbol/clip_line"),a=n("../../util/util"),d=n("../load_geometry"),v=n("../../symbol/collision_feature"),g=l.shapeText,nt=l.shapeIcon,tt=c.getGlyphQuads,it=c.getIconQuads,u=r.EXTENT,o,s;t.exports=i;i.prototype=a.inherit(r,{});i.prototype.serialize=function(){var n=r.prototype.serialize.apply(this);return n.sdfIcons=this.sdfIcons,n.iconsNeedLinear=this.iconsNeedLinear,n.adjustedTextSize=this.adjustedTextSize,n.adjustedIconSize=this.adjustedIconSize,n.fontstack=this.fontstack,n};o=new r.VertexArrayType([{name:"a_pos",components:2,type:"Int16"},{name:"a_offset",components:2,type:"Int16"},{name:"a_texture_pos",components:2,type:"Uint16"},{name:"a_data",components:4,type:"Uint8"}]);s=new r.ElementArrayType;i.prototype.addCollisionBoxVertex=function(n,t,i,r,u){return n.emplaceBack(t.x,t.y,Math.round(i.x),Math.round(i.y),r*10,u*10)};i.prototype.programInterfaces={glyph:{layoutVertexArrayType:o,elementArrayType:s},icon:{layoutVertexArrayType:o,elementArrayType:s},collisionBox:{layoutVertexArrayType:new r.VertexArrayType([{name:"a_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}])}};i.prototype.populateArrays=function(n,t,i){var l={lastIntegerZoom:Infinity,lastIntegerZoomTime:0,lastZoom:0},rt,y,p,it,w,f,ut,o;this.adjustedTextMaxSize=this.layer.getLayoutValue("text-size",{zoom:18,zoomHistory:l});this.adjustedTextSize=this.layer.getLayoutValue("text-size",{zoom:this.zoom+1,zoomHistory:l});this.adjustedIconMaxSize=this.layer.getLayoutValue("icon-size",{zoom:18,zoomHistory:l});this.adjustedIconSize=this.layer.getLayoutValue("icon-size",{zoom:this.zoom+1,zoomHistory:l});rt=512*this.overscaling;this.tilePixelRatio=u/rt;this.compareText={};this.iconsNeedLinear=!1;this.symbolInstancesStartIndex=this.symbolInstancesArray.length;var r=this.layer.layout,e=this.features,v=this.textFeatures,k=.5,tt=.5;switch(r["text-anchor"]){case"right":case"top-right":case"bottom-right":k=1;break;case"left":case"top-left":case"bottom-left":k=0}switch(r["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":tt=1;break;case"top":case"top-right":case"top-left":tt=0}var ft=r["text-justify"]==="right"?1:r["text-justify"]==="left"?0:.5,s=24,et=r["text-line-height"]*s,ot=r["symbol-placement"]!=="line"?r["text-max-width"]*s:0,st=r["text-letter-spacing"]*s,ht=[r["text-offset"][0]*s,r["text-offset"][1]*s],ct=this.fontstack=r["text-font"].join(","),c=[];for(y=0;y<e.length;y++)c.push(d(e[y]));for(r["symbol-placement"]==="line"&&(p=b(e,v,c),c=p.geometries,e=p.features,v=p.textFeatures),f=0;f<e.length;f++)c[f]&&(it=v[f]?g(v[f],t[ct],ot,et,k,tt,ft,st,ht):null,r["icon-image"]?(ut=h(e[f].properties,r["icon-image"]),o=i[ut],w=nt(o,r),o&&(this.sdfIcons===undefined?this.sdfIcons=o.sdf:this.sdfIcons!==o.sdf&&a.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),o.pixelRatio!==1?this.iconsNeedLinear=!0:r["icon-rotate"]===0&&this.layer.isLayoutValueFeatureConstant("icon-rotate")||(this.iconsNeedLinear=!0))):w=null,(it||w)&&this.addFeature(c[f],it,w,e[f]));this.symbolInstancesEndIndex=this.symbolInstancesArray.length;this.placeFeatures(n,this.showCollisionBoxes);this.trimArrays()};i.prototype.addFeature=function(n,t,i,r){var f=this.layer.layout,c=24,g=this.adjustedTextSize/c,nt=this.adjustedTextMaxSize!==undefined?this.adjustedTextMaxSize:this.adjustedTextSize,tt=this.tilePixelRatio*g,it=this.tilePixelRatio*nt/c,rt=this.tilePixelRatio*this.adjustedIconSize,w=this.tilePixelRatio*f["symbol-spacing"],ut=f["symbol-avoid-edges"],ft=f["text-padding"]*this.tilePixelRatio,et=f["icon-padding"]*this.tilePixelRatio,ot=f["text-max-angle"]/180*Math.PI,st=f["text-rotation-alignment"]==="map"&&f["symbol-placement"]==="line",ht=f["icon-rotation-alignment"]==="map"&&f["symbol-placement"]==="line",ct=f["text-allow-overlap"]||f["icon-allow-overlap"]||f["text-ignore-placement"]||f["icon-ignore-placement"],l=f["symbol-placement"]==="line",lt=w/2,s,o,a,h,b,e,v,d;for(l&&(n=k(n,0,0,u,u)),s=0;s<n.length;s++)for(o=n[s],a=l?p(o,w,ot,t,i,c,it,this.overscaling,u):[new y(o[0].x,o[0].y,0)],h=0,b=a.length;h<b;h++)(e=a[h],t&&l&&this.anchorIsTooClose(t.text,lt,e))||(v=!(e.x<0||e.x>u||e.y<0||e.y>u),!ut||v)&&(d=v||ct,this.addSymbolInstance(e,o,t,i,this.layer,d,this.symbolInstancesArray.length,this.collisionBoxArray,r.index,this.sourceLayerIndex,this.index,tt,ft,st,rt,et,ht,{zoom:this.zoom},r.properties))};i.prototype.anchorIsTooClose=function(n,t,i){var r=this.compareText,f,u;if(n in r){for(f=r[n],u=f.length-1;u>=0;u--)if(i.dist(f[u])<t)return!0}else r[n]=[];return r[n].push(i),!1};i.prototype.placeFeatures=function(n,t){var e;this.recalculateStyleLayers();this.createArrays();var i=this.layer.layout,h=n.maxScale,b=i["text-rotation-alignment"]==="map"&&i["symbol-placement"]==="line",k=i["icon-rotation-alignment"]==="map"&&i["symbol-placement"]==="line",d=i["text-allow-overlap"]||i["icon-allow-overlap"]||i["text-ignore-placement"]||i["icon-ignore-placement"];if(d){var g=this.symbolInstancesArray.toArray(this.symbolInstancesStartIndex,this.symbolInstancesEndIndex),c=n.angle,l=Math.sin(c),a=Math.cos(c);this.sortedSymbolInstances=g.sort(function(n,t){var i=l*n.anchorPointX+a*n.anchorPointY|0,r=l*t.anchorPointX+a*t.anchorPointY|0;return i-r||t.index-n.index})}for(e=this.symbolInstancesStartIndex;e<this.symbolInstancesEndIndex;e++){var r=this.sortedSymbolInstances?this.sortedSymbolInstances[e-this.symbolInstancesStartIndex]:this.symbolInstancesArray.get(e),v={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex},y={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex},o=!(r.textBoxStartIndex===r.textBoxEndIndex),s=!(r.iconBoxStartIndex===r.iconBoxEndIndex),p=i["text-optional"]||!o,w=i["icon-optional"]||!s,u=o?n.placeCollisionFeature(v,i["text-allow-overlap"],i["symbol-avoid-edges"]):n.minScale,f=s?n.placeCollisionFeature(y,i["icon-allow-overlap"],i["symbol-avoid-edges"]):n.minScale;p||w?!w&&u?u=Math.max(f,u):!p&&f&&(f=Math.max(f,u)):f=u=Math.max(f,u);o&&(n.insertCollisionFeature(v,u,i["text-ignore-placement"]),u<=h&&this.addSymbols("glyph",r.glyphQuadStartIndex,r.glyphQuadEndIndex,u,i["text-keep-upright"],b,n.angle));s&&(n.insertCollisionFeature(y,f,i["icon-ignore-placement"]),f<=h&&this.addSymbols("icon",r.iconQuadStartIndex,r.iconQuadEndIndex,f,i["icon-keep-upright"],k,n.angle))}t&&this.addToDebugBuffers(n)};i.prototype.addSymbols=function(n,t,i,r,u,f,o){for(var h,d,p,a,g=this.prepareArrayGroup(n,4*(i-t)),nt=g.elementArray,w=g.layoutVertexArray,b=this.zoom,v=Math.max(Math.log(r)/Math.LN2+b,0),k=t;k<i;k++)if(h=this.symbolQuadsArray.get(k).SymbolQuad,d=(h.anchorAngle+o+Math.PI)%(Math.PI*2),!u||!f||!(d<=Math.PI/2||d>Math.PI*3/2)){var tt=h.tl,it=h.tr,rt=h.bl,ut=h.br,s=h.tex,c=h.anchorPoint,l=Math.max(b+Math.log(h.minScale)/Math.LN2,v),y=Math.min(b+Math.log(h.maxScale)/Math.LN2,25);y<=l||(l===v&&(l=0),p=Math.round(h.glyphAngle/(Math.PI*2)*256),a=e(w,c.x,c.y,tt.x,tt.y,s.x,s.y,l,y,v,p),e(w,c.x,c.y,it.x,it.y,s.x+s.w,s.y,l,y,v,p),e(w,c.x,c.y,rt.x,rt.y,s.x,s.y+s.h,l,y,v,p),e(w,c.x,c.y,ut.x,ut.y,s.x+s.w,s.y+s.h,l,y,v,p),nt.emplaceBack(a,a+1,a+2),nt.emplaceBack(a+1,a+2,a+3))}};i.prototype.updateIcons=function(n){var i,t,r;if(this.recalculateStyleLayers(),i=this.layer.layout["icon-image"],i)for(t=0;t<this.features.length;t++)r=h(this.features[t].properties,i),r&&(n[r]=!0)};i.prototype.updateFont=function(n){this.recalculateStyleLayers();var t=this.layer.layout["text-font"],i=n[t]=n[t]||{};this.textFeatures=w(this.features,this.layer.layout,i)};i.prototype.addToDebugBuffers=function(n){for(var r,c,l,a,k=this.prepareArrayGroup("collisionBox",0),i=k.layoutVertexArray,s=-n.angle,h=n.yStretch,v=this.symbolInstancesStartIndex;v<this.symbolInstancesEndIndex;v++)for(r=this.symbolInstancesArray.get(v),r.textCollisionFeature={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex},r.iconCollisionFeature={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex},c=0;c<2;c++)if(l=r[c===0?"textCollisionFeature":"iconCollisionFeature"],l)for(a=l.boxStartIndex;a<l.boxEndIndex;a++){var t=this.collisionBoxArray.get(a),u=t.anchorPoint,y=new f(t.x1,t.y1*h)._rotate(s),p=new f(t.x2,t.y1*h)._rotate(s),w=new f(t.x1,t.y2*h)._rotate(s),b=new f(t.x2,t.y2*h)._rotate(s),e=Math.max(0,Math.min(25,this.zoom+Math.log(t.maxScale)/Math.LN2)),o=Math.max(0,Math.min(25,this.zoom+Math.log(t.placementScale)/Math.LN2));this.addCollisionBoxVertex(i,u,y,e,o);this.addCollisionBoxVertex(i,u,p,e,o);this.addCollisionBoxVertex(i,u,p,e,o);this.addCollisionBoxVertex(i,u,b,e,o);this.addCollisionBoxVertex(i,u,b,e,o);this.addCollisionBoxVertex(i,u,w,e,o);this.addCollisionBoxVertex(i,u,w,e,o);this.addCollisionBoxVertex(i,u,y,e,o)}};i.prototype.addSymbolInstance=function(n,t,i,r,u,f,e,o,s,h,c,l,a,y,p,w,b,k,d){var et,ot,st,ht,g,nt,rt,ut,ft,ct,lt,at,vt;if(i&&(rt=f?tt(n,i,l,t,u,y):[],g=new v(o,t,n,s,h,c,i,l,a,y,!1)),et=this.symbolQuadsArray.length,rt&&rt.length)for(ft=0;ft<rt.length;ft++)this.addSymbolQuad(rt[ft]);return ot=this.symbolQuadsArray.length,ct=g?g.boxStartIndex:this.collisionBoxArray.length,lt=g?g.boxEndIndex:this.collisionBoxArray.length,r&&(ut=f?it(n,r,p,t,u,b,i,k,d):[],nt=new v(o,t,n,s,h,c,r,p,w,b,!0)),st=this.symbolQuadsArray.length,ut&&ut.length===1&&this.addSymbolQuad(ut[0]),ht=this.symbolQuadsArray.length,at=nt?nt.boxStartIndex:this.collisionBoxArray.length,vt=nt?nt.boxEndIndex:this.collisionBoxArray.length,this.symbolInstancesArray.emplaceBack(ct,lt,at,vt,et,ot,st,ht,n.x,n.y,e)};i.prototype.addSymbolQuad=function(n){return this.symbolQuadsArray.emplaceBack(n.anchorPoint.x,n.anchorPoint.y,n.tl.x,n.tl.y,n.tr.x,n.tr.y,n.bl.x,n.bl.y,n.br.x,n.br.y,n.tex.h,n.tex.w,n.tex.x,n.tex.y,n.anchorAngle,n.glyphAngle,n.maxScale,n.minScale)}},{"../../symbol/anchor":384,"../../symbol/clip_line":386,"../../symbol/collision_feature":388,"../../symbol/get_anchors":390,"../../symbol/mergelines":393,"../../symbol/quads":394,"../../symbol/resolve_text":395,"../../symbol/shaping":396,"../../util/token":434,"../../util/util":435,"../bucket":322,"../load_geometry":330,"point-geometry":493}],327:[function(n,t){"use strict";function i(n,t,i){this.arrayBuffer=n.arrayBuffer;this.length=n.length;this.attributes=t.members;this.itemSize=t.bytesPerElement;this.type=i;this.arrayType=t}t.exports=i;i.prototype.bind=function(n){var t=n[this.type];this.buffer?n.bindBuffer(t,this.buffer):(this.buffer=n.createBuffer(),n.bindBuffer(t,this.buffer),n.bufferData(t,this.arrayBuffer,n.STATIC_DRAW),this.arrayBuffer=null)};var r={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT"};i.prototype.setVertexAttribPointers=function(n,t){for(var i,f,u=0;u<this.attributes.length;u++)i=this.attributes[u],f=t[i.name],f!==undefined&&n.vertexAttribPointer(f,i.components,n[r[i.type]],!1,this.arrayType.bytesPerElement,i.offset)};i.prototype.destroy=function(n){this.buffer&&n.deleteBuffer(this.buffer)};i.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"}},{}],328:[function(n,t){"use strict";function u(n,t){this.layoutVertexBuffer=new i(n.layoutVertexArray,t.layoutVertexArrayType,i.BufferType.VERTEX);n.elementArray&&(this.elementBuffer=new i(n.elementArray,t.elementArrayType,i.BufferType.ELEMENT));var e=this.vaos={},u;n.elementArray2&&(this.elementBuffer2=new i(n.elementArray2,t.elementArrayType2,i.BufferType.ELEMENT),u=this.secondVaos={});this.paintVertexBuffers=f.mapObject(n.paintVertexArrays,function(f,o){return e[o]=new r,n.elementArray2&&(u[o]=new r),new i(f,t.paintVertexArrayTypes[o],i.BufferType.VERTEX)})}var f=n("../util/util"),i=n("./buffer"),r=n("../render/vertex_array_object");t.exports=u;u.prototype.destroy=function(n){var t,i,r;this.layoutVertexBuffer.destroy(n);this.elementBuffer&&this.elementBuffer.destroy(n);this.elementBuffer2&&this.elementBuffer2.destroy(n);for(t in this.paintVertexBuffers)this.paintVertexBuffers[t].destroy(n);for(i in this.vaos)this.vaos[i].destroy(n);for(r in this.secondVaos)this.secondVaos[r].destroy(n)}},{"../render/vertex_array_object":350,"../util/util":435,"./buffer":327}],329:[function(n,t){"use strict";function i(n,t,i){if(n.grid){var r=n,u=t;n=r.coord;t=r.overscaling;this.grid=new h(r.grid);this.featureIndexArray=new c(r.featureIndexArray);this.rawTileData=u;this.bucketLayerIDs=r.bucketLayerIDs}else this.grid=new h(s,16,0),this.featureIndexArray=new c;this.coord=n;this.overscaling=t;this.x=n.x;this.y=n.y;this.z=n.z-Math.log(t)/Math.LN2;this.setCollisionTile(i)}function f(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function tt(n,t){return t-n}function l(n){return n["line-gap-width"]>0?n["line-gap-width"]+2*n["line-width"]:n["line-width"]}function e(n,t,i,u,f){var s,e,h,c,o;if(!t[0]&&!t[1])return n;for(t=r.convert(t),i==="viewport"&&t._rotate(-u),s=[],e=0;e<n.length;e++){for(h=n[e],c=[],o=0;o<h.length;o++)c.push(h[o].sub(t._mult(f)));s.push(c)}return s}function it(n,t){for(var u,o,i,c=[],l=new r(0,0),e=0;e<n.length;e++){for(u=n[e],o=[],i=0;i<u.length;i++){var a=u[i-1],s=u[i],v=u[i+1],y=i===0?l:s.sub(a)._unit()._perp(),h=i===u.length-1?l:v.sub(s)._unit()._perp(),f=y._add(h)._unit(),p=f.x*h.x+f.y*h.y;f._mult(1/p);o.push(f._mult(t)._add(s))}c.push(o)}return c}var r=n("point-geometry"),o=n("./load_geometry"),s=n("./bucket").EXTENT,a=n("feature-filter"),v=n("../util/struct_array"),h=n("grid-index"),y=n("../util/dictionary_coder"),p=n("vector-tile"),w=n("pbf"),b=n("../util/vectortile_to_geojson"),k=n("../util/util").arraysIntersect,u=n("../util/intersection_tests"),d=u.multiPolygonIntersectsBufferedMultiPoint,g=u.multiPolygonIntersectsMultiPolygon,nt=u.multiPolygonIntersectsBufferedMultiLine,c=new v({members:[{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]});t.exports=i;i.prototype.insert=function(n,t,i,r){var l=this.featureIndexArray.length,h,e,c,u,s,f;for(this.featureIndexArray.emplaceBack(t,i,r),h=o(n),e=0;e<h.length;e++){for(c=h[e],u=[Infinity,Infinity,-Infinity,-Infinity],s=0;s<c.length;s++)f=c[s],u[0]=Math.min(u[0],f.x),u[1]=Math.min(u[1],f.y),u[2]=Math.max(u[2],f.x),u[3]=Math.max(u[3],f.y);this.grid.insert(l,u[0],u[1],u[2],u[3])}};i.prototype.setCollisionTile=function(n){this.collisionTile=n};i.prototype.serialize=function(){var n={coord:this.coord,overscaling:this.overscaling,grid:this.grid.toArrayBuffer(),featureIndexArray:this.featureIndexArray.serialize(),bucketLayerIDs:this.bucketLayerIDs};return{data:n,transferables:[n.grid,n.featureIndexArray.arrayBuffer]}};i.prototype.query=function(n,t){var ht,g,ft,nt,e,et,ot;this.vtLayers||(this.vtLayers=new p.VectorTile(new w(new Uint8Array(this.rawTileData))).layers,this.sourceLayerCoder=new y(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));var it={},rt=n.params||{},ut=s/n.tileSize/n.scale,st=a(rt.filter),i=0;for(ht in t){var o=t[ht],u=o.paint,h=0;o.type==="line"?h=l(u)/2+Math.abs(u["line-offset"])+f(u["line-translate"]):o.type==="fill"?h=f(u["fill-translate"]):o.type==="circle"&&(h=u["circle-radius"]+f(u["circle-translate"]));i=Math.max(i,h*ut)}var c=n.queryGeometry.map(function(n){return n.map(function(n){return new r(n.x,n.y)})}),v=Infinity,b=Infinity,k=-Infinity,d=-Infinity;for(g=0;g<c.length;g++)for(ft=c[g],nt=0;nt<ft.length;nt++)e=ft[nt],v=Math.min(v,e.x),b=Math.min(b,e.y),k=Math.max(k,e.x),d=Math.max(d,e.y);return et=this.grid.query(v-i,b-i,k+i,d+i),et.sort(tt),this.filterMatching(it,et,this.featureIndexArray,c,st,rt.layers,t,n.bearing,ut),ot=this.collisionTile.queryRenderedSymbols(v,b,k,d,n.scale),ot.sort(),this.filterMatching(it,ot,this.collisionTile.collisionBoxArray,c,st,rt.layers,t,n.bearing,ut),it};i.prototype.filterMatching=function(n,t,i,r,u,f,s,h,c){for(var tt,rt,ut,v,ft,w,y,p,a,lt,at,ht,et,ct,ot=0;ot<t.length;ot++)if((tt=t[ot],tt!==ct)&&(ct=tt,rt=i.get(tt),ut=this.bucketLayerIDs[rt.bucketIndex],!f||k(f,ut))){var vt=this.sourceLayerCoder.decode(rt.sourceLayerIndex),yt=this.vtLayers[vt],st=yt.feature(rt.featureIndex);if(u(st))for(v=null,ft=0;ft<ut.length;ft++)if((w=ut[ft],!f||!(f.indexOf(w)<0))&&(y=s[w],y)){if(y.type!=="symbol")if(v||(v=o(st)),a=y.paint,y.type==="line"){if(p=e(r,a["line-translate"],a["line-translate-anchor"],h,c),lt=l(a)/2*c,a["line-offset"]&&(v=it(v,a["line-offset"]*c)),!nt(p,v,lt))continue}else if(y.type==="fill"){if(p=e(r,a["fill-translate"],a["fill-translate-anchor"],h,c),!g(p,v))continue}else if(y.type==="circle"&&(p=e(r,a["circle-translate"],a["circle-translate-anchor"],h,c),at=a["circle-radius"]*c,!d(p,v,at)))continue;ht=new b(st,this.z,this.x,this.y);ht.layer=y.serialize({includeRefProperties:!0});et=n[w];et===undefined&&(et=n[w]=[]);et.push(ht)}}}},{"../util/dictionary_coder":425,"../util/intersection_tests":430,"../util/struct_array":433,"../util/util":435,"../util/vectortile_to_geojson":436,"./bucket":322,"./load_geometry":330,"feature-filter":439,"grid-index":461,pbf:491,"point-geometry":493,"vector-tile":503}],330:[function(n,t){"use strict";function i(n){return{min:-1*Math.pow(2,n-1),max:Math.pow(2,n-1)-1}}var r=n("../util/util"),u=n("./bucket").EXTENT,f={15:i(15),16:i(16)};t.exports=function(n,t){for(var c,o,i,e=f[t||16],l=u/n.extent,s=n.loadGeometry(),h=0;h<s.length;h++)for(c=s[h],o=0;o<c.length;o++)i=c[o],i.x=Math.round(i.x*l),i.y=Math.round(i.y*l),(i.x<e.min||i.x>e.max||i.y<e.min||i.y>e.max)&&r.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size");return s}},{"../util/util":435,"./bucket":322}],331:[function(n,t){"use strict";function i(n,t,i){this.column=n;this.row=t;this.zoom=i}t.exports=i;i.prototype={clone:function(){return new i(this.column,this.row,this.zoom)},zoomTo:function(n){return this.clone()._zoomTo(n)},sub:function(n){return this.clone()._sub(n)},_zoomTo:function(n){var t=Math.pow(2,n-this.zoom);return this.column*=t,this.row*=t,this.zoom=n,this},_sub:function(n){return n=n.zoomTo(this.zoom),this.column-=n.column,this.row-=n.row,this}}},{}],332:[function(n,t){"use strict";function i(n,t){if(isNaN(n)||isNaN(t))throw new Error("Invalid LngLat object: ("+n+", "+t+")");if(this.lng=+n,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");}t.exports=i;var r=n("../util/util").wrap;i.prototype.wrap=function(){return new i(r(this.lng,-180,180),this.lat)};i.prototype.toArray=function(){return[this.lng,this.lat]};i.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"};i.convert=function(n){return n instanceof i?n:Array.isArray(n)?new i(n[0],n[1]):n}},{"../util/util":435}],333:[function(n,t){"use strict";function r(n,t){if(n)t?this.extend(n).extend(t):n.length===4?this.extend([n[0],n[1]]).extend([n[2],n[3]]):this.extend(n[0]).extend(n[1]);else return}t.exports=r;var i=n("./lng_lat");r.prototype={extend:function(n){var f=this._sw,e=this._ne,t,u;if(n instanceof i)t=n,u=n;else if(n instanceof r){if(t=n._sw,u=n._ne,!t||!u)return this}else return n?this.extend(i.convert(n)||r.convert(n)):this;return f||e?(f.lng=Math.min(t.lng,f.lng),f.lat=Math.min(t.lat,f.lat),e.lng=Math.max(u.lng,e.lng),e.lat=Math.max(u.lat,e.lat)):(this._sw=new i(t.lng,t.lat),this._ne=new i(u.lng,u.lat)),this},getCenter:function(){return new i((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new i(this.getWest(),this.getNorth())},getSouthEast:function(){return new i(this.getEast(),this.getSouth())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat},toArray:function(){return[this._sw.toArray(),this._ne.toArray()]},toString:function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"}};r.convert=function(n){return!n||n instanceof r?n:new r(n)}},{"./lng_lat":332}],334:[function(n,t){"use strict";function a(n,t){this.tileSize=512;this._minZoom=n||0;this._maxZoom=t||22;this.latRange=[-85.05113,85.05113];this.width=0;this.height=0;this._center=new u(0,0);this.zoom=0;this.angle=0;this._altitude=1.5;this._pitch=0;this._unmodified=!0}var u=n("./lng_lat"),r=n("point-geometry"),o=n("./coordinate"),v=n("../util/util").wrap,s=n("../util/interpolate"),h=n("../source/tile_coord"),c=n("../data/bucket").EXTENT,f=n("gl-matrix"),e=f.vec4,i=f.mat4,l=f.mat2;t.exports=a;a.prototype={get minZoom(){return this._minZoom},set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},get maxZoom(){return this._maxZoom},set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new r(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(n){var t=-v(n,-180,180)*Math.PI/180;this.angle!==t&&(this._unmodified=!1,this.angle=t,this._calcMatrices(),this.rotationMatrix=l.create(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},get pitch(){return this._pitch/Math.PI*180},set pitch(n){var t=Math.min(60,n)/180*Math.PI;this._pitch!==t&&(this._unmodified=!1,this._pitch=t,this._calcMatrices())},get altitude(){return this._altitude},set altitude(n){var t=Math.max(.75,n);this._altitude!==t&&(this._unmodified=!1,this._altitude=t,this._calcMatrices())},get zoom(){return this._zoom},set zoom(n){var t=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._calcMatrices(),this._constrain())},get center(){return this._center},set center(n){(n.lat!==this._center.lat||n.lng!==this._center.lng)&&(this._unmodified=!1,this._center=n,this._calcMatrices(),this._constrain())},coveringZoomLevel:function(n){return(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize))},coveringTiles:function(n){var t=this.coveringZoomLevel(n),e=t;if(t<n.minzoom)return[];t>n.maxzoom&&(t=n.maxzoom);var i=this,u=i.locationCoordinate(i.center)._zoomTo(t),f=new r(u.column-.5,u.row-.5);return h.cover(t,[i.pointCoordinate(new r(0,0))._zoomTo(t),i.pointCoordinate(new r(i.width,0))._zoomTo(t),i.pointCoordinate(new r(i.width,i.height))._zoomTo(t),i.pointCoordinate(new r(0,i.height))._zoomTo(t)],n.reparseOverscaled?e:t).sort(function(n,t){return f.dist(n)-f.dist(t)})},resize:function(n,t){this.width=n;this.height=t;this.pixelsToGLUnits=[2/n,-2/t];this._calcMatrices();this._constrain()},get unmodified(){return this._unmodified},zoomScale:function(n){return Math.pow(2,n)},scaleZoom:function(n){return Math.log(n)/Math.LN2},project:function(n,t){return new r(this.lngX(n.lng,t),this.latY(n.lat,t))},unproject:function(n,t){return new u(this.xLng(n.x,t),this.yLat(n.y,t))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new r(this.x,this.y)},lngX:function(n,t){return(180+n)*(t||this.worldSize)/360},latY:function(n,t){var i=180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360));return(180-i)*(t||this.worldSize)/360},xLng:function(n,t){return n*360/(t||this.worldSize)-180},yLat:function(n,t){var i=180-n*360/(t||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90},panBy:function(n){var t=this.centerPoint._add(n);this.center=this.pointLocation(t)},setLocationAtPoint:function(n,t){var i=this.locationCoordinate(n),r=this.pointCoordinate(t),u=this.pointCoordinate(this.centerPoint),f=r._sub(i);this._unmodified=!1;this.center=this.coordinateLocation(u._sub(f))},locationPoint:function(n){return this.coordinatePoint(this.locationCoordinate(n))},pointLocation:function(n){return this.coordinateLocation(this.pointCoordinate(n))},locationCoordinate:function(n){var t=this.zoomScale(this.tileZoom)/this.worldSize,i=u.convert(n);return new o(this.lngX(i.lng)*t,this.latY(i.lat)*t,this.tileZoom)},coordinateLocation:function(n){var t=this.zoomScale(n.zoom);return new u(this.xLng(n.column,t),this.yLat(n.row,t))},pointCoordinate:function(n){var t=[n.x,n.y,0,1],i=[n.x,n.y,1,1];e.transformMat4(t,t,this.pixelMatrixInverse);e.transformMat4(i,i,this.pixelMatrixInverse);var r=t[3],u=i[3],a=t[0]/r,v=i[0]/u,y=t[1]/r,p=i[1]/u,f=t[2]/r,h=i[2]/u,c=f===h?0:(0-f)/(h-f),l=this.worldSize/this.zoomScale(this.tileZoom);return new o(s(a,v,c)/l,s(y,p,c)/l,this.tileZoom)},coordinatePoint:function(n){var i=this.worldSize/this.zoomScale(n.zoom),t=[n.column*i,n.row*i,0,1];return e.transformMat4(t,t,this.pixelMatrix),new r(t[0]/t[3],t[1]/t[3])},calculatePosMatrix:function(n,t){t===undefined&&(t=Infinity);n instanceof h&&(n=n.toCoordinate(t));var f=Math.min(n.zoom,t),u=this.worldSize/Math.pow(2,f),r=new Float64Array(16);return i.identity(r),i.translate(r,r,[n.column*u,n.row*u,0]),i.scale(r,r,[u/c,u/c,1]),i.multiply(r,this.projMatrix,r),new Float32Array(r)},_constrain:function(){var t,i,u,f,c,l,e,o,n,a,v,y,s,p,h;if(this.center&&this.width&&this.height&&!this._constraining){if(this._constraining=!0,n=this.size,a=this._unmodified,this.latRange&&(t=this.latY(this.latRange[1]),i=this.latY(this.latRange[0]),c=i-t<n.y?n.y/(i-t):0),this.lngRange&&(u=this.lngX(this.lngRange[0]),f=this.lngX(this.lngRange[1]),l=f-u<n.x?n.x/(f-u):0),v=Math.max(l||0,c||0),v){this.center=this.unproject(new r(l?(f+u)/2:this.x,c?(i+t)/2:this.y));this.zoom+=this.scaleZoom(v);this._unmodified=a;this._constraining=!1;return}this.latRange&&(y=this.y,s=n.y/2,y-s<t&&(o=t+s),y+s>i&&(o=i-s));this.lngRange&&(p=this.x,h=n.x/2,p-h<u&&(e=u+h),p+h>f&&(e=f-h));(e!==undefined||o!==undefined)&&(this.center=this.unproject(new r(e!==undefined?e:this.x,o!==undefined?o:this.y)));this._unmodified=a;this._constraining=!1}},_calcMatrices:function(){if(this.height){var t=Math.atan(.5/this.altitude),r=Math.sin(t)*this.altitude/Math.sin(Math.PI/2-this._pitch-t),u=Math.cos(Math.PI/2-this._pitch)*r+this.altitude,n=new Float64Array(16);if(i.perspective(n,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,u),i.translate(n,n,[0,0,-this.altitude]),i.scale(n,n,[1,-1,1/this.height]),i.rotateX(n,n,this._pitch),i.rotateZ(n,n,this.angle),i.translate(n,n,[-this.x,-this.y,0]),this.projMatrix=n,n=i.create(),i.scale(n,n,[this.width/2,-this.height/2,1]),i.translate(n,n,[1,-1,0]),this.pixelMatrix=i.multiply(new Float64Array(16),n,this.projMatrix),n=i.invert(new Float64Array(16),this.pixelMatrix),!n)throw new Error("failed to invert matrix");this.pixelMatrixInverse=n}}}},{"../data/bucket":322,"../source/tile_coord":362,"../util/interpolate":429,"../util/util":435,"./coordinate":331,"./lng_lat":332,"gl-matrix":451,"point-geometry":493}],335:[function(n,t){"use strict";var i={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],"0":[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],"1":[20,[6,17,8,18,11,21,11,0]],"2":[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],"3":[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],"4":[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],"5":[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],"6":[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],"7":[20,[17,21,7,0,-1,-1,3,21,17,21]],"8":[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],"9":[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};t.exports=function(n,t,r,u){u=u||1;for(var l=[],e,v,f,h,c,o,s=0,a=n.length;s<a;s++)if(f=i[n[s]],f){for(o=null,e=0,v=f[1].length;e<v;e+=2)f[1][e]===-1&&f[1][e+1]===-1?o=null:(h=t+f[1][e]*u,c=r-f[1][e+1]*u,o&&l.push(o.x,o.y,h,c),o={x:h,y:c});t+=f[0]*u}return l}},{}],336:[function(n,t){"use strict";var i=t.exports={},u,r;i.version=n("../package.json").version;i.Map=n("./ui/map");i.Control=n("./ui/control/control");i.Navigation=n("./ui/control/navigation");i.Geolocate=n("./ui/control/geolocate");i.Attribution=n("./ui/control/attribution");i.Popup=n("./ui/popup");i.Marker=n("./ui/marker");i.Style=n("./style/style");i.LngLat=n("./geo/lng_lat");i.LngLatBounds=n("./geo/lng_lat_bounds");i.Point=n("point-geometry");i.Evented=n("./util/evented");i.util=n("./util/util");i.supported=n("./util/browser").supported;u=n("./util/ajax");i.util.getJSON=u.getJSON;i.util.getArrayBuffer=u.getArrayBuffer;r=n("./util/config");i.config=r;Object.defineProperty(i,"accessToken",{get:function(){return r.ACCESS_TOKEN},set:function(n){r.ACCESS_TOKEN=n}})},{"../package.json":512,"./geo/lng_lat":332,"./geo/lng_lat_bounds":333,"./style/style":371,"./ui/control/attribution":402,"./ui/control/control":403,"./ui/control/geolocate":404,"./ui/control/navigation":405,"./ui/map":414,"./ui/marker":415,"./ui/popup":416,"./util/ajax":418,"./util/browser":419,"./util/config":424,"./util/evented":427,"./util/util":435,"point-geometry":493}],337:[function(n,t){"use strict";t.exports=function(n){for(var t,u,i={define:{},initialize:{}},r=0;r<n.length;r++)t=n[r],u="{precision} "+(t.components===1?"float":"vec"+t.components),i.define[t.name.slice(2)]="uniform "+u+" "+t.name+";\n",i.initialize[t.name.slice(2)]=u+" "+t.name.slice(2)+" = "+t.name+";\n";return i}},{}],338:[function(n,t){"use strict";function f(n,t,f){var e=n.gl,nt=n.transform,w=f.paint["background-color"],s=f.paint["background-pattern"],b=f.paint["background-opacity"],o,c=s?n.spriteAtlas.getPosition(s.from,!0):null,l=s?n.spriteAtlas.getPosition(s.to,!0):null,y,p,a,v,h;if(n.setDepthSublayer(0),c&&l){if(n.isOpaquePass)return;o=n.useProgram("pattern");e.uniform1i(o.u_image,0);e.uniform2fv(o.u_pattern_tl_a,c.tl);e.uniform2fv(o.u_pattern_br_a,c.br);e.uniform2fv(o.u_pattern_tl_b,l.tl);e.uniform2fv(o.u_pattern_br_b,l.br);e.uniform1f(o.u_opacity,b);e.uniform1f(o.u_mix,s.t);e.uniform2fv(o.u_pattern_size_a,c.size);e.uniform2fv(o.u_pattern_size_b,l.size);e.uniform1f(o.u_scale_a,s.fromScale);e.uniform1f(o.u_scale_b,s.toScale);e.activeTexture(e.TEXTURE0);n.spriteAtlas.bind(e,!0);n.tileExtentPatternVAO.bind(e,o,n.tileExtentBuffer)}else{if(n.isOpaquePass!==(w[3]===1))return;y=u([{name:"u_color",components:4},{name:"u_opacity",components:1}]);o=n.useProgram("fill",[],y,y);e.uniform4fv(o.u_color,w);e.uniform1f(o.u_opacity,b);n.tileExtentVAO.bind(e,o,n.tileExtentBuffer)}for(e.disable(e.STENCIL_TEST),p=nt.coveringTiles({tileSize:i}),a=0;a<p.length;a++){if(v=p[a],c&&l){h={coord:v,tileSize:i};e.uniform1f(o.u_tile_units_to_pixels,1/r(h,1,n.transform.tileZoom));var k=h.tileSize*Math.pow(2,n.transform.tileZoom-h.coord.z),d=k*(h.coord.x+v.w*Math.pow(2,h.coord.z)),g=k*h.coord.y;e.uniform2f(o.u_pixel_coord_upper,d>>16,g>>16);e.uniform2f(o.u_pixel_coord_lower,d&65535,g&65535)}e.uniformMatrix4fv(o.u_matrix,!1,n.transform.calculatePosMatrix(v));e.drawArrays(e.TRIANGLE_STRIP,0,n.tileExtentBuffer.length)}e.stencilMask(0);e.stencilFunc(e.EQUAL,128,128)}var r=n("../source/pixels_to_tile_units"),u=n("./create_uniform_pragmas"),i=512;t.exports=f},{"../source/pixels_to_tile_units":356,"./create_uniform_pragmas":337}],339:[function(n,t){"use strict";function r(n,t,r,u){var f,s,c,l,e,a,o;if(!n.isOpaquePass)for(f=n.gl,n.setDepthSublayer(0),n.depthMask(!1),f.disable(f.STENCIL_TEST),s=0;s<u.length;s++){var v=u[s],y=t.getTile(v),h=y.getBucket(r);if(h&&(c=h.bufferGroups.circle,c))for(l=h.paintAttributes.circle[r.id],e=n.useProgram("circle",l.defines,l.vertexPragmas,l.fragmentPragmas),r.paint["circle-pitch-scale"]==="map"?(f.uniform1i(e.u_scale_with_map,!0),f.uniform2f(e.u_extrude_scale,n.transform.pixelsToGLUnits[0]*n.transform.altitude,n.transform.pixelsToGLUnits[1]*n.transform.altitude)):(f.uniform1i(e.u_scale_with_map,!1),f.uniform2fv(e.u_extrude_scale,n.transform.pixelsToGLUnits)),f.uniform1f(e.u_devicepixelratio,i.devicePixelRatio),f.uniformMatrix4fv(e.u_matrix,!1,n.translatePosMatrix(v.posMatrix,y,r.paint["circle-translate"],r.paint["circle-translate-anchor"])),h.setUniforms(f,"circle",e,r,{zoom:n.transform.zoom}),a=0;a<c.length;a++)o=c[a],o.vaos[r.id].bind(f,e,o.layoutVertexBuffer,o.elementBuffer,o.paintVertexBuffers[r.id]),f.drawElements(f.TRIANGLES,o.elementBuffer.length*3,f.UNSIGNED_SHORT,0)}}var i=n("../util/browser");t.exports=r},{"../util/browser":419}],340:[function(n,t){"use strict";function i(n,t,i,r){var u=n.gl,f,o,s,e;for(u.enable(u.STENCIL_TEST),f=n.useProgram("collisionbox"),o=0;o<r.length;o++){var h=r[o],c=t.getTile(h),l=c.getBucket(i);l&&(s=l.bufferGroups.collisionBox,s&&s.length)&&(e=s[0],e.layoutVertexBuffer.length!==0)&&(u.uniformMatrix4fv(f.u_matrix,!1,h.posMatrix),n.enableTileClippingMask(h),n.lineWidth(1),u.uniform1f(f.u_scale,Math.pow(2,n.transform.zoom-c.coord.z)),u.uniform1f(f.u_zoom,n.transform.zoom*10),u.uniform1f(f.u_maxzoom,(c.coord.z+1)*10),e.vaos[i.id].bind(u,f,e.layoutVertexBuffer),u.drawArrays(u.LINES,0,e.layoutVertexBuffer.length))}}t.exports=i},{}],341:[function(n,t){"use strict";function s(n,t,i){if(!n.isOpaquePass&&n.options.debug)for(var r=0;r<i.length;r++)h(n,t,i[r])}function h(n,t,s){var h=n.gl,a,c,v,w,l,y,k,p,b;for(h.disable(h.STENCIL_TEST),n.lineWidth(1*u.devicePixelRatio),a=s.posMatrix,c=n.useProgram("debug"),h.uniformMatrix4fv(c.u_matrix,!1,a),h.uniform4f(c.u_color,1,0,0,1),n.debugVAO.bind(h,c,n.debugBuffer),h.drawArrays(h.LINE_STRIP,0,n.debugBuffer.length),v=r(s.toString(),50,200,5),w=new n.PosArray,l=0;l<v.length;l+=2)w.emplaceBack(v[l],v[l+1]);y=new i(w.serialize(),n.PosArray.serialize(),i.BufferType.VERTEX);k=new o;k.bind(h,c,y);h.uniform4f(c.u_color,1,1,1,1);var nt=t.getTile(s).tileSize,d=e/(Math.pow(2,n.transform.zoom-s.z)*nt),g=[[-1,-1],[-1,1],[1,-1],[1,1]];for(p=0;p<g.length;p++)b=g[p],h.uniformMatrix4fv(c.u_matrix,!1,f.translate([],a,[d*b[0],d*b[1],0])),h.drawArrays(h.LINES,0,y.length);h.uniform4f(c.u_color,0,0,0,1);h.uniformMatrix4fv(c.u_matrix,!1,a);h.drawArrays(h.LINES,0,y.length)}var r=n("../lib/debugtext"),u=n("../util/browser"),f=n("gl-matrix").mat4,e=n("../data/bucket").EXTENT,i=n("../data/buffer"),o=n("./vertex_array_object");t.exports=s},{"../data/bucket":322,"../data/buffer":327,"../lib/debugtext":335,"../util/browser":419,"./vertex_array_object":350,"gl-matrix":451}],342:[function(n,t){"use strict";function u(n,t,i,r){var h=n.gl,c,u,s,o;if(h.enable(h.STENCIL_TEST),c=i.paint["fill-pattern"]?!1:i.isPaintValueFeatureConstant("fill-color")&&i.isPaintValueFeatureConstant("fill-opacity")&&i.paint["fill-color"][3]===1&&i.paint["fill-opacity"]===1,n.isOpaquePass===c)for(n.setDepthSublayer(1),u=0;u<r.length;u++)f(n,t,i,r[u]);if(!n.isOpaquePass&&i.paint["fill-antialias"])for(n.lineWidth(2),n.depthMask(!1),s=i.getPaintProperty("fill-outline-color"),s||!i.paint["fill-pattern"]?s?n.setDepthSublayer(2):n.setDepthSublayer(0):n.setDepthSublayer(0),o=0;o<r.length;o++)e(n,t,i,r[o])}function f(n,t,r,u){var a=t.getTile(u),s=a.getBucket(r),h,f,v,e,c,l,o;if(s&&(h=s.bufferGroups.fill,h))for(f=n.gl,v=r.paint["fill-pattern"],v?(e=n.useProgram("pattern"),i(v,r.paint["fill-opacity"],a,u,n,e),f.activeTexture(f.TEXTURE0),n.spriteAtlas.bind(f,!0)):(c=s.paintAttributes.fill[r.id],e=n.useProgram("fill",c.defines,c.vertexPragmas,c.fragmentPragmas),s.setUniforms(f,"fill",e,r,{zoom:n.transform.zoom})),f.uniformMatrix4fv(e.u_matrix,!1,n.translatePosMatrix(u.posMatrix,a,r.paint["fill-translate"],r.paint["fill-translate-anchor"])),n.enableTileClippingMask(u),l=0;l<h.length;l++)o=h[l],o.vaos[r.id].bind(f,e,o.layoutVertexBuffer,o.elementBuffer,o.paintVertexBuffers[r.id]),f.drawElements(f.TRIANGLES,o.elementBuffer.length,f.UNSIGNED_SHORT,0)}function e(n,t,r,u){var l=t.getTile(u),s=l.getBucket(r),h,c,o;if(s){var f=n.gl,v=s.bufferGroups.fill,a=r.paint["fill-pattern"],y=r.paint["fill-opacity"],p=r.getPaintProperty("fill-outline-color"),e;for(a&&!p?(e=n.useProgram("outlinepattern"),f.uniform2f(e.u_world,f.drawingBufferWidth,f.drawingBufferHeight)):(h=s.paintAttributes.fill[r.id],e=n.useProgram("outline",h.defines,h.vertexPragmas,h.fragmentPragmas),f.uniform2f(e.u_world,f.drawingBufferWidth,f.drawingBufferHeight),f.uniform1f(e.u_opacity,y),s.setUniforms(f,"fill",e,r,{zoom:n.transform.zoom})),f.uniformMatrix4fv(e.u_matrix,!1,n.translatePosMatrix(u.posMatrix,l,r.paint["fill-translate"],r.paint["fill-translate-anchor"])),a&&i(a,y,l,u,n,e),n.enableTileClippingMask(u),c=0;c<v.length;c++)o=v[c],o.secondVaos[r.id].bind(f,e,o.layoutVertexBuffer,o.elementBuffer2,o.paintVertexBuffers[r.id]),f.drawElements(f.LINES,o.elementBuffer2.length*2,f.UNSIGNED_SHORT,0)}}function i(n,t,i,u,f,e){var o=f.gl,s=f.spriteAtlas.getPosition(n.from,!0),h=f.spriteAtlas.getPosition(n.to,!0);if(s&&h){o.uniform1i(e.u_image,0);o.uniform2fv(e.u_pattern_tl_a,s.tl);o.uniform2fv(e.u_pattern_br_a,s.br);o.uniform2fv(e.u_pattern_tl_b,h.tl);o.uniform2fv(e.u_pattern_br_b,h.br);o.uniform1f(e.u_opacity,t);o.uniform1f(e.u_mix,n.t);o.uniform1f(e.u_tile_units_to_pixels,1/r(i,1,f.transform.tileZoom));o.uniform2fv(e.u_pattern_size_a,s.size);o.uniform2fv(e.u_pattern_size_b,h.size);o.uniform1f(e.u_scale_a,n.fromScale);o.uniform1f(e.u_scale_b,n.toScale);var c=i.tileSize*Math.pow(2,f.transform.tileZoom-i.coord.z),l=c*(i.coord.x+u.w*Math.pow(2,i.coord.z)),a=c*i.coord.y;o.uniform2f(e.u_pixel_coord_upper,l>>16,a>>16);o.uniform2f(e.u_pixel_coord_lower,l&65535,a&65535);o.activeTexture(o.TEXTURE0);f.spriteAtlas.bind(o,!0)}}var r=n("../source/pixels_to_tile_units");t.exports=u},{"../source/pixels_to_tile_units":356}],343:[function(n,t){"use strict";var u=n("../util/browser"),r=n("gl-matrix").mat2,i=n("../source/pixels_to_tile_units");t.exports=function(n,t,f,e){var o,g,nt,ht,tt,it,w;if(!n.isOpaquePass&&(n.setDepthSublayer(0),n.depthMask(!1),o=n.gl,o.enable(o.STENCIL_TEST),!(f.paint["line-width"]<=0))){var b=1/u.devicePixelRatio,rt=f.paint["line-blur"]+b,et=f.paint["line-color"],h=n.transform,c=r.create();r.scale(c,c,[1,Math.cos(h._pitch)]);r.rotate(c,c,n.transform.angle);var ot=Math.sqrt(h.height*h.height/4*(1+h.altitude*h.altitude)),at=h.height/2*Math.tan(h._pitch),ut=(ot+at)/ot-1,l=f.paint["line-dasharray"],a=f.paint["line-pattern"],s,k,d,p,v;if(l)s=n.useProgram("linesdfpattern"),o.uniform1f(s.u_linewidth,f.paint["line-width"]/2),o.uniform1f(s.u_gapwidth,f.paint["line-gap-width"]/2),o.uniform1f(s.u_antialiasing,b/2),o.uniform1f(s.u_blur,rt),o.uniform4fv(s.u_color,et),o.uniform1f(s.u_opacity,f.paint["line-opacity"]),k=n.lineAtlas.getDash(l.from,f.layout["line-cap"]==="round"),d=n.lineAtlas.getDash(l.to,f.layout["line-cap"]==="round"),o.uniform1i(s.u_image,0),o.activeTexture(o.TEXTURE0),n.lineAtlas.bind(o),o.uniform1f(s.u_tex_y_a,k.y),o.uniform1f(s.u_tex_y_b,d.y),o.uniform1f(s.u_mix,l.t),o.uniform1f(s.u_extra,ut),o.uniform1f(s.u_offset,-f.paint["line-offset"]),o.uniformMatrix2fv(s.u_antialiasingmatrix,!1,c);else if(a){if(p=n.spriteAtlas.getPosition(a.from,!0),v=n.spriteAtlas.getPosition(a.to,!0),!p||!v)return;s=n.useProgram("linepattern");o.uniform1i(s.u_image,0);o.activeTexture(o.TEXTURE0);n.spriteAtlas.bind(o,!0);o.uniform1f(s.u_linewidth,f.paint["line-width"]/2);o.uniform1f(s.u_gapwidth,f.paint["line-gap-width"]/2);o.uniform1f(s.u_antialiasing,b/2);o.uniform1f(s.u_blur,rt);o.uniform2fv(s.u_pattern_tl_a,p.tl);o.uniform2fv(s.u_pattern_br_a,p.br);o.uniform2fv(s.u_pattern_tl_b,v.tl);o.uniform2fv(s.u_pattern_br_b,v.br);o.uniform1f(s.u_fade,a.t);o.uniform1f(s.u_opacity,f.paint["line-opacity"]);o.uniform1f(s.u_extra,ut);o.uniform1f(s.u_offset,-f.paint["line-offset"]);o.uniformMatrix2fv(s.u_antialiasingmatrix,!1,c)}else s=n.useProgram("line"),o.uniform1f(s.u_linewidth,f.paint["line-width"]/2),o.uniform1f(s.u_gapwidth,f.paint["line-gap-width"]/2),o.uniform1f(s.u_antialiasing,b/2),o.uniform1f(s.u_blur,rt),o.uniform1f(s.u_extra,ut),o.uniform1f(s.u_offset,-f.paint["line-offset"]),o.uniformMatrix2fv(s.u_antialiasingmatrix,!1,c),o.uniform4fv(s.u_color,et),o.uniform1f(s.u_opacity,f.paint["line-opacity"]);for(g=0;g<e.length;g++){var ft=e[g],y=t.getTile(ft),st=y.getBucket(f);if(st&&(nt=st.bufferGroups.line,nt)){if(n.enableTileClippingMask(ft),ht=n.translatePosMatrix(ft.posMatrix,y,f.paint["line-translate"],f.paint["line-translate-anchor"]),o.uniformMatrix4fv(s.u_matrix,!1,ht),tt=1/i(y,1,n.transform.zoom),l){var ct=k.width*l.fromScale,lt=d.width*l.toScale,vt=[1/i(y,ct,n.transform.tileZoom),-k.height/2],yt=[1/i(y,lt,n.transform.tileZoom),-d.height/2],pt=n.lineAtlas.width/(Math.min(ct,lt)*256*u.devicePixelRatio)/2;o.uniform1f(s.u_ratio,tt);o.uniform2fv(s.u_patternscale_a,vt);o.uniform2fv(s.u_patternscale_b,yt);o.uniform1f(s.u_sdfgamma,pt)}else a?(o.uniform1f(s.u_ratio,tt),o.uniform2fv(s.u_pattern_size_a,[i(y,p.size[0]*a.fromScale,n.transform.tileZoom),v.size[1]]),o.uniform2fv(s.u_pattern_size_b,[i(y,v.size[0]*a.toScale,n.transform.tileZoom),v.size[1]])):o.uniform1f(s.u_ratio,tt);for(it=0;it<nt.length;it++)w=nt[it],w.vaos[f.id].bind(o,s,w.layoutVertexBuffer,w.elementBuffer),o.drawElements(o.TRIANGLES,w.elementBuffer.length*3,o.UNSIGNED_SHORT,0)}}}}},{"../source/pixels_to_tile_units":356,"../util/browser":419,"gl-matrix":451}],344:[function(n,t){"use strict";function r(n,t,i,r){var u,s,e,o;if(!n.isOpaquePass){for(u=n.gl,u.enable(u.DEPTH_TEST),n.depthMask(!0),u.depthFunc(u.LESS),s=r.length&&r[0].z,e=0;e<r.length;e++)o=r[e],n.setDepthSublayer(o.z-s),f(n,t,i,o);u.depthFunc(u.LEQUAL)}}function f(n,t,i,r){var u=n.gl,l,a,v,p,y,w;u.disable(u.STENCIL_TEST);var c=t.getTile(r),b=n.transform.calculatePosMatrix(r,t.maxzoom),f=n.useProgram("raster");u.uniformMatrix4fv(f.u_matrix,!1,b);u.uniform1f(f.u_brightness_low,i.paint["raster-brightness-min"]);u.uniform1f(f.u_brightness_high,i.paint["raster-brightness-max"]);u.uniform1f(f.u_saturation_factor,s(i.paint["raster-saturation"]));u.uniform1f(f.u_contrast_factor,o(i.paint["raster-contrast"]));u.uniform3fv(f.u_spin_weights,e(i.paint["raster-hue-rotate"]));l=c.source&&c.source.findLoadedParent(r,0,{});a=h(c,l,i,n.transform);u.activeTexture(u.TEXTURE0);u.bindTexture(u.TEXTURE_2D,c.texture);u.activeTexture(u.TEXTURE1);l?(u.bindTexture(u.TEXTURE_2D,l.texture),v=Math.pow(2,l.coord.z-c.coord.z),p=[c.coord.x*v%1,c.coord.y*v%1]):(u.bindTexture(u.TEXTURE_2D,c.texture),a[1]=0);u.uniform2fv(f.u_tl_parent,p||[0,0]);u.uniform1f(f.u_scale_parent,v||1);u.uniform1f(f.u_buffer_scale,1);u.uniform1f(f.u_opacity0,a[0]);u.uniform1f(f.u_opacity1,a[1]);u.uniform1i(f.u_image0,0);u.uniform1i(f.u_image1,1);y=c.boundsBuffer||n.rasterBoundsBuffer;w=c.boundsVAO||n.rasterBoundsVAO;w.bind(u,f,y);u.drawArrays(u.TRIANGLE_STRIP,0,y.length)}function e(n){n*=Math.PI/180;var i=Math.sin(n),t=Math.cos(n);return[(2*t+1)/3,(-Math.sqrt(3)*i-t+1)/3,(Math.sqrt(3)*i-t+1)/3]}function o(n){return n>0?1/(1-n):1+n}function s(n){return n>0?1-1/(1.001-n):-n}function h(n,t,r,u){var f=[1,0],e=r.paint["raster-fade-duration"],o;if(n.source&&e>0){var s=(new Date).getTime(),c=(s-n.timeAdded)/e,l=t?(s-t.timeAdded)/e:-1,h=u.coveringZoomLevel(n.source),a=t?Math.abs(t.coord.z-h)>Math.abs(n.coord.z-h):!1;!t||a?(f[0]=i.clamp(c,0,1),f[1]=1-f[0]):(f[0]=i.clamp(1-l,0,1),f[1]=1-f[0])}return o=r.paint["raster-opacity"],f[0]*=o,f[1]*=o,f}var i=n("../util/util"),u=n("../util/struct_array");t.exports=r;r.RasterBoundsArray=new u({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]})},{"../util/struct_array":433,"../util/util":435}],345:[function(n,t){"use strict";function e(n,t,i,f){if(!n.isOpaquePass){var o=!(i.layout["text-allow-overlap"]||i.layout["icon-allow-overlap"]||i.layout["text-ignore-placement"]||i.layout["icon-ignore-placement"]),e=n.gl;o?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST);n.setDepthSublayer(0);n.depthMask(!1);e.disable(e.DEPTH_TEST);r(n,t,i,f,!1,i.paint["icon-translate"],i.paint["icon-translate-anchor"],i.layout["icon-rotation-alignment"],i.layout["icon-rotation-alignment"],i.layout["icon-size"],i.paint["icon-halo-width"],i.paint["icon-halo-color"],i.paint["icon-halo-blur"],i.paint["icon-opacity"],i.paint["icon-color"]);r(n,t,i,f,!0,i.paint["text-translate"],i.paint["text-translate-anchor"],i.layout["text-rotation-alignment"],i.layout["text-pitch-alignment"],i.layout["text-size"],i.paint["text-halo-width"],i.paint["text-halo-color"],i.paint["text-halo-blur"],i.paint["text-opacity"],i.paint["text-color"]);e.enable(e.DEPTH_TEST);t.map.showCollisionBoxes&&u(n,t,i,f)}}function r(n,t,i,r,u,f,e,s,h,c,l,a,v,y,p){for(var k,w,d,g,b=0;b<r.length;b++)(k=t.getTile(r[b]),w=k.getBucket(i),w)&&(d=w.bufferGroups,g=u?d.glyph:d.icon,g.length)&&(n.enableTileClippingMask(r[b]),o(n,i,r[b].posMatrix,k,w,g,u,u||w.sdfIcons,!u&&w.iconsNeedLinear,u?w.adjustedTextSize:w.adjustedIconSize,w.fontstack,f,e,s,h,c,l,a,v,y,p))}function o(n,t,r,u,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){var it=n.gl,ft=n.transform,dt=p==="map",vt=w==="map",pt=s?24:1,ot=b/pt,yt,et,ht,rt,st,wt,ut,ct,lt,at;if(vt?(et=f(u,1,n.transform.zoom)*ot,ht=1/Math.cos(ft._pitch),yt=[et,et]):(et=n.transform.altitude*ot,ht=1,yt=[ft.pixelsToGLUnits[0]*et,ft.pixelsToGLUnits[1]*et]),s||n.style.sprite.loaded()){if(rt=n.useProgram(h?"sdf":"icon"),it.uniformMatrix4fv(rt.u_matrix,!1,n.translatePosMatrix(r,u,v,y)),it.uniform1i(rt.u_rotate_with_map,dt),it.uniform1i(rt.u_pitch_with_map,vt),it.uniform2fv(rt.u_extrude_scale,yt),it.activeTexture(it.TEXTURE0),it.uniform1i(rt.u_texture,0),s){if(st=a&&n.glyphSource.getGlyphAtlas(a),!st)return;st.updateTexture(it);it.uniform2f(rt.u_texsize,st.width/4,st.height/4)}else{var gt=n.options.rotating||n.options.zooming,ni=ot!==1||i.devicePixelRatio!==n.spriteAtlas.pixelRatio||c,ti=vt||n.transform.pitch;n.spriteAtlas.bind(it,h||gt||ni||ti);it.uniform2f(rt.u_texsize,n.spriteAtlas.width/4,n.spriteAtlas.height/4)}if(wt=Math.log(b/l)/Math.LN2||0,it.uniform1f(rt.u_zoom,(n.transform.zoom-wt)*10),it.activeTexture(it.TEXTURE1),n.frameHistory.bind(it),it.uniform1i(rt.u_fadetexture,1),h){var bt=8,kt=.105*pt/b/i.devicePixelRatio;if(k)for(it.uniform1f(rt.u_gamma,(g*1.19/ot/bt+kt)*ht),it.uniform4fv(rt.u_color,d),it.uniform1f(rt.u_opacity,nt),it.uniform1f(rt.u_buffer,(6-k/ot)/bt),ct=0;ct<o.length;ct++)ut=o[ct],ut.vaos[t.id].bind(it,rt,ut.layoutVertexBuffer,ut.elementBuffer),it.drawElements(it.TRIANGLES,ut.elementBuffer.length*3,it.UNSIGNED_SHORT,0);for(it.uniform1f(rt.u_gamma,kt*ht),it.uniform4fv(rt.u_color,tt),it.uniform1f(rt.u_opacity,nt),it.uniform1f(rt.u_buffer,192/256),it.uniform1f(rt.u_pitch,ft.pitch/180*Math.PI),it.uniform1f(rt.u_bearing,ft.bearing/180*Math.PI),it.uniform1f(rt.u_aspect_ratio,ft.width/ft.height),lt=0;lt<o.length;lt++)ut=o[lt],ut.vaos[t.id].bind(it,rt,ut.layoutVertexBuffer,ut.elementBuffer),it.drawElements(it.TRIANGLES,ut.elementBuffer.length*3,it.UNSIGNED_SHORT,0)}else for(it.uniform1f(rt.u_opacity,nt),at=0;at<o.length;at++)ut=o[at],ut.vaos[t.id].bind(it,rt,ut.layoutVertexBuffer,ut.elementBuffer),it.drawElements(it.TRIANGLES,ut.elementBuffer.length*3,it.UNSIGNED_SHORT,0)}}var i=n("../util/browser"),u=n("./draw_collision_debug"),f=n("../source/pixels_to_tile_units");t.exports=e},{"../source/pixels_to_tile_units":356,"../util/browser":419,"./draw_collision_debug":340}],346:[function(n,t){"use strict";function i(){this.changeTimes=new Float64Array(256);this.changeOpacities=new Uint8Array(256);this.opacities=new Uint8ClampedArray(256);this.array=new Uint8Array(this.opacities.buffer);this.fadeDuration=300;this.previousZoom=0;this.firstFrame=!0}t.exports=i;i.prototype.record=function(n){var i=Date.now(),t,u,r;if(this.firstFrame&&(i=0,this.firstFrame=!1),n=Math.floor(n*10),n<this.previousZoom)for(t=n+1;t<=this.previousZoom;t++)this.changeTimes[t]=i,this.changeOpacities[t]=this.opacities[t];else for(t=n;t>this.previousZoom;t--)this.changeTimes[t]=i,this.changeOpacities[t]=this.opacities[t];for(t=0;t<256;t++)u=i-this.changeTimes[t],r=u/this.fadeDuration*255,this.opacities[t]=t<=n?this.changeOpacities[t]+r:this.changeOpacities[t]-r;this.changed=!0;this.previousZoom=n};i.prototype.bind=function(n){this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.changed&&(n.texSubImage2D(n.TEXTURE_2D,0,0,0,256,1,n.ALPHA,n.UNSIGNED_BYTE,this.array),this.changed=!1)):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,256,1,0,n.ALPHA,n.UNSIGNED_BYTE,this.array))}},{}],347:[function(n,t){"use strict";function i(n,t){this.width=n;this.height=t;this.nextRow=0;this.bytes=4;this.data=new Uint8Array(this.width*this.height*this.bytes);this.positions={}}var r=n("../util/util");t.exports=i;i.prototype.setSprite=function(n){this.sprite=n};i.prototype.getDash=function(n,t){var i=n.join(",")+t;return this.positions[i]||(this.positions[i]=this.addDash(n,t)),this.positions[i]};i.prototype.addDash=function(n,t){var i=t?7:0,w=2*i+1,s,h,e,u,v,p,g;if(this.nextRow+w>this.height)return r.warnOnce("LineAtlas out of space"),null;for(s=0,h=0;h<n.length;h++)s+=n[h];var c=this.width/s,y=c/2,b=n.length%2==1;for(e=-i;e<=i;e++){var nt=this.nextRow+i+e,tt=this.width*nt,k=b?-n[n.length-1]:0,f=n[0],l=1;for(u=0;u<this.width;u++){while(f<u/c)k=f,f=f+n[l],b&&l===n.length-1&&(f+=n[0]),l++;var it=Math.abs(u-k*c),rt=Math.abs(u-f*c),o=Math.min(it,rt),d=l%2==1,a;t?(v=i?e/i*(y+1):0,d?(p=y-Math.abs(v),a=Math.sqrt(o*o+p*p)):a=y-Math.sqrt(o*o+v*v)):a=(d?1:-1)*o;this.data[3+(tt+u)*4]=Math.max(0,Math.min(255,a+128))}}return g={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:s},this.nextRow+=w,this.dirty=!0,g};i.prototype.bind=function(n){this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.RGBA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,this.data))}},{"../util/util":435}],348:[function(n,t){"use strict";function i(n,t){this.gl=n;this.transform=t;this.reusableTextures={};this.preFbos={};this.frameHistory=new v;this.setup();this.numSublayers=s.maxUnderzooming+s.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.lineWidthRange=n.getParameter(n.ALIASED_LINE_WIDTH_RANGE)}var o=n("../util/browser"),a=n("gl-matrix").mat4,v=n("./frame_history"),s=n("../source/source_cache"),r=n("../data/bucket").EXTENT,h=n("../source/pixels_to_tile_units"),c=n("../util/util"),y=n("../util/struct_array"),u=n("../data/buffer"),f=n("./vertex_array_object"),l=n("./draw_raster").RasterBoundsArray,p=n("./create_uniform_pragmas"),e;t.exports=i;c.extend(i.prototype,n("./painter/use_program"));i.prototype.resize=function(n,t){var i=this.gl;this.width=n*o.devicePixelRatio;this.height=t*o.devicePixelRatio;i.viewport(0,0,this.width,this.height)};i.prototype.setup=function(){var n=this.gl,o,i,t,e;n.verbose=!0;n.enable(n.BLEND);n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA);n.enable(n.STENCIL_TEST);n.enable(n.DEPTH_TEST);n.depthFunc(n.LEQUAL);this._depthMask=!1;n.depthMask(!1);o=this.PosArray=new y({members:[{name:"a_pos",type:"Int16",components:2}]});i=new o;i.emplaceBack(0,0);i.emplaceBack(r,0);i.emplaceBack(0,r);i.emplaceBack(r,r);this.tileExtentBuffer=new u(i.serialize(),o.serialize(),u.BufferType.VERTEX);this.tileExtentVAO=new f;this.tileExtentPatternVAO=new f;t=new o;t.emplaceBack(0,0);t.emplaceBack(r,0);t.emplaceBack(r,r);t.emplaceBack(0,r);t.emplaceBack(0,0);this.debugBuffer=new u(t.serialize(),o.serialize(),u.BufferType.VERTEX);this.debugVAO=new f;e=new l;e.emplaceBack(0,0,0,0);e.emplaceBack(r,0,32767,0);e.emplaceBack(0,r,0,32767);e.emplaceBack(r,r,32767,32767);this.rasterBoundsBuffer=new u(e.serialize(),l.serialize(),u.BufferType.VERTEX);this.rasterBoundsVAO=new f};i.prototype.clearColor=function(){var n=this.gl;n.clearColor(0,0,0,0);n.clear(n.COLOR_BUFFER_BIT)};i.prototype.clearStencil=function(){var n=this.gl;n.clearStencil(0);n.stencilMask(255);n.clear(n.STENCIL_BUFFER_BIT)};i.prototype.clearDepth=function(){var n=this.gl;n.clearDepth(1);this.depthMask(!0);n.clear(n.DEPTH_BUFFER_BIT)};i.prototype._renderTileClippingMasks=function(n){var t=this.gl,e,i,r,o,u,f;for(t.colorMask(!1,!1,!1,!1),this.depthMask(!1),t.disable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.stencilMask(248),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),e=1,this._tileClippingMaskIDs={},i=0;i<n.length;i++)r=n[i],o=this._tileClippingMaskIDs[r.id]=e++<<3,t.stencilFunc(t.ALWAYS,o,248),u=p([{name:"u_color",components:4},{name:"u_opacity",components:1}]),f=this.useProgram("fill",[],u,u),t.uniformMatrix4fv(f.u_matrix,!1,r.posMatrix),this.tileExtentVAO.bind(t,f,this.tileExtentBuffer),t.drawArrays(t.TRIANGLE_STRIP,0,this.tileExtentBuffer.length);t.stencilMask(0);t.colorMask(!0,!0,!0,!0);this.depthMask(!0);t.enable(t.DEPTH_TEST)};i.prototype.enableTileClippingMask=function(n){var t=this.gl;t.stencilFunc(t.EQUAL,this._tileClippingMaskIDs[n.id],248)};i.prototype.prepareBuffers=function(){};i.prototype.bindDefaultFramebuffer=function(){var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,null)};e={symbol:n("./draw_symbol"),circle:n("./draw_circle"),line:n("./draw_line"),fill:n("./draw_fill"),raster:n("./draw_raster"),background:n("./draw_background"),debug:n("./draw_debug")};i.prototype.render=function(n,t){this.style=n;this.options=t;this.lineAtlas=n.lineAtlas;this.spriteAtlas=n.spriteAtlas;this.spriteAtlas.setSprite(n.sprite);this.glyphSource=n.glyphSource;this.frameHistory.record(this.transform.zoom);this.prepareBuffers();this.clearColor();this.clearDepth();this.showOverdrawInspector(t.showOverdrawInspector);this.depthRange=(n._order.length+2)*this.numSublayers*this.depthEpsilon;this.renderPass({isOpaquePass:!0});this.renderPass({isOpaquePass:!1})};i.prototype.renderPass=function(n){var s=this.style._groups,u=n.isOpaquePass,f,h;for(this.currentLayer=u?this.style._order.length:-1,f=0;f<s.length;f++){var o=s[u?s.length-1-f:f],i=this.style.sources[o.source],t,r=[];if(i){for(r=i.getVisibleCoordinates(),t=0;t<r.length;t++)r[t].posMatrix=this.transform.calculatePosMatrix(r[t],i.maxzoom);this.clearStencil();i.prepare&&i.prepare();i.isTileClipped&&this._renderTileClippingMasks(r)}for(u?(this._showOverdrawInspector||this.gl.disable(this.gl.BLEND),this.isOpaquePass=!0):(this.gl.enable(this.gl.BLEND),this.isOpaquePass=!1,r.reverse()),t=0;t<o.length;t++)h=o[u?o.length-1-t:t],this.currentLayer+=u?-1:1,this.renderLayer(this,i,h,r);i&&e.debug(this,i,r)}};i.prototype.depthMask=function(n){n!==this._depthMask&&(this._depthMask=n,this.gl.depthMask(n))};i.prototype.renderLayer=function(n,t,i,r){i.isHidden(this.transform.zoom)||(i.type==="background"||r.length)&&(this.id=i.id,e[i.type](n,t,i,r))};i.prototype.setDepthSublayer=function(n){var t=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon,i=t-1+this.depthRange;this.gl.depthRange(i,t)};i.prototype.translatePosMatrix=function(n,t,i,r){var u,f,o,e;return!i[0]&&!i[1]?n:(r==="viewport"&&(u=Math.sin(-this.transform.angle),f=Math.cos(-this.transform.angle),i=[i[0]*f-i[1]*u,i[0]*u+i[1]*f]),o=[h(t,i[0],this.transform.zoom),h(t,i[1],this.transform.zoom),0],e=new Float32Array(16),a.translate(e,n,o),e)};i.prototype.saveTexture=function(n){var t=this.reusableTextures[n.size];t?t.push(n):this.reusableTextures[n.size]=[n]};i.prototype.getTexture=function(n){var t=this.reusableTextures[n];return t&&t.length>0?t.pop():null};i.prototype.lineWidth=function(n){this.gl.lineWidth(c.clamp(n,this.lineWidthRange[0],this.lineWidthRange[1]))};i.prototype.showOverdrawInspector=function(n){var t,r,i;(n||this._showOverdrawInspector)&&(this._showOverdrawInspector=n,t=this.gl,n?(t.blendFunc(t.CONSTANT_COLOR,t.ONE),r=8,i=1/r,t.blendColor(i,i,i,0),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT)):t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA))}},{"../data/bucket":322,"../data/buffer":327,"../source/pixels_to_tile_units":356,"../source/source_cache":360,"../util/browser":419,"../util/struct_array":433,"../util/util":435,"./create_uniform_pragmas":337,"./draw_background":338,"./draw_circle":339,"./draw_debug":341,"./draw_fill":342,"./draw_line":343,"./draw_raster":344,"./draw_symbol":345,"./frame_history":346,"./painter/use_program":349,"./vertex_array_object":350,"gl-matrix":451}],349:[function(n,t){"use strict";function r(n,t){return n.replace(/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,function(n,i,r,u,f){return t[i][f].replace(/{type}/g,u).replace(/{precision}/g,r)})}var u=n("../../util/util"),i=n("mapbox-gl-shaders"),f=i.util;t.exports._createProgram=function(n,t,e,o){for(var c,l,a,k,v,d,g,tt,y,nt,s=this.gl,h=s.createProgram(),p=i[n],w="#define MAPBOX_GL_JS;\n",b=0;b<t.length;b++)w+="#define "+t[b]+";\n";for(c=s.createShader(s.FRAGMENT_SHADER),s.shaderSource(c,r(w+p.fragmentSource,o)),s.compileShader(c),s.attachShader(h,c),l=s.createShader(s.VERTEX_SHADER),s.shaderSource(l,r(w+f+p.vertexSource,e)),s.compileShader(l),s.attachShader(h,l),s.linkProgram(h),a={},k=s.getProgramParameter(h,s.ACTIVE_ATTRIBUTES),v=0;v<k;v++)d=s.getActiveAttrib(h,v),a[d.name]=s.getAttribLocation(h,d.name);for(g={},tt=s.getProgramParameter(h,s.ACTIVE_UNIFORMS),y=0;y<tt;y++)nt=s.getActiveUniform(h,y),g[nt.name]=s.getUniformLocation(h,nt.name);return u.extend({program:h,definition:p,attributes:a,numAttributes:k},a,g)};t.exports._createProgramCached=function(n,t,i,r){this.cache=this.cache||{};var u=JSON.stringify({name:n,defines:t,vertexPragmas:i,fragmentPragmas:r});return this.cache[u]||(this.cache[u]=this._createProgram(n,t,i,r)),this.cache[u]};t.exports.useProgram=function(n,t,i,r){var e=this.gl,u,f;return t=t||[],this._showOverdrawInspector&&(t=t.concat("OVERDRAW_INSPECTOR")),u=this._createProgramCached(n,t,i,r),f=this.currentProgram,f!==u&&(e.useProgram(u.program),this.currentProgram=u),u}},{"../../util/util":435,"mapbox-gl-shaders":463}],350:[function(n,t){"use strict";function i(){this.boundProgram=null;this.boundVertexBuffer=null;this.boundVertexBuffer2=null;this.boundElementBuffer=null;this.vao=null}t.exports=i;i.prototype.bind=function(n,t,i,r,u){n.extVertexArrayObject===undefined&&(n.extVertexArrayObject=n.getExtension("OES_vertex_array_object"));var f=!this.vao||this.boundProgram!==t||this.boundVertexBuffer!==i||this.boundVertexBuffer2!==u||this.boundElementBuffer!==r;!n.extVertexArrayObject||f?this.freshBind(n,t,i,r,u):n.extVertexArrayObject.bindVertexArrayOES(this.vao)};i.prototype.freshBind=function(n,t,i,r,u){var f,s=t.numAttributes,e,o;if(n.extVertexArrayObject)this.vao&&this.destroy(n),this.vao=n.extVertexArrayObject.createVertexArrayOES(),n.extVertexArrayObject.bindVertexArrayOES(this.vao),f=0,this.boundProgram=t,this.boundVertexBuffer=i,this.boundVertexBuffer2=u,this.boundElementBuffer=r;else for(f=n.currentNumAttributes||0,e=s;e<f;e++)n.disableVertexAttribArray(e);for(o=f;o<s;o++)n.enableVertexAttribArray(o);i.bind(n);i.setVertexAttribPointers(n,t);u&&(u.bind(n),u.setVertexAttribPointers(n,t));r&&r.bind(n);n.currentNumAttributes=s};i.prototype.unbind=function(n){var t=n.extVertexArrayObject;t&&t.bindVertexArrayOES(null)};i.prototype.destroy=function(n){var t=n.extVertexArrayObject;t&&this.vao&&(t.deleteVertexArrayOES(this.vao),this.vao=null)}},{}],351:[function(n,t){"use strict";function u(n,t,u){t=t||{};this.id=n;this.dispatcher=u;this._data=t.data;t.maxzoom!==undefined&&(this.maxzoom=t.maxzoom);t.type&&(this.type=t.type);var f=r/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==undefined?t.buffer:128)*f,tolerance:(t.tolerance!==undefined?t.tolerance:.375)*f,extent:r,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:Math.min(t.clusterMaxZoom,this.maxzoom-1)||this.maxzoom-1,extent:r,radius:(t.clusterRadius||50)*f,log:!1}},t.workerOptions);this._updateWorkerData(function(n){if(n){this.fire("error",{error:n});return}this.fire("load")}.bind(this))}var f=n("../util/evented"),i=n("../util/util"),e=n("resolve-url"),r=n("../data/bucket").EXTENT;t.exports=u;u.prototype=i.inherit(f,{type:"geojson",minzoom:0,maxzoom:18,tileSize:512,isTileClipped:!0,reparseOverscaled:!0,onAdd:function(n){this.map=n},setData:function(n){return this._data=n,this._updateWorkerData(function(n){if(n)return this.fire("error",{error:n});this.fire("change")}.bind(this)),this},_updateWorkerData:function(n){var r=i.extend({},this.workerOptions),t=this._data;typeof t=="string"?r.url=typeof window!="undefined"?e(window.location.href,t):t:r.data=JSON.stringify(t);this.workerID=this.dispatcher.send(this.type+".loadData",r,function(t){this._loaded=!0;n(t)}.bind(this))},loadTile:function(n,t){var i=n.coord.z>this.maxzoom?Math.pow(2,n.coord.z-this.maxzoom):1,r={type:this.type,uid:n.uid,coord:n.coord,zoom:n.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:i,angle:this.map.transform.angle,pitch:this.map.transform.pitch,showCollisionBoxes:this.map.showCollisionBoxes};n.workerID=this.dispatcher.send("load tile",r,function(i,r){if(n.unloadVectorData(this.map.painter),!n.aborted)return i?t(i):(n.loadVectorData(r,this.map.style),n.redoWhenDone&&(n.redoWhenDone=!1,n.redoPlacement(this)),t(null))}.bind(this),this.workerID)},abortTile:function(n){n.aborted=!0},unloadTile:function(n){n.unloadVectorData(this.map.painter);this.dispatcher.send("remove tile",{uid:n.uid,source:this.id},function(){},n.workerID)},serialize:function(){return{type:this.type,data:this._data}}})},{"../data/bucket":322,"../util/evented":427,"../util/util":435,"resolve-url":495}],352:[function(n,t){"use strict";function r(n,t,r){r&&(this.loadGeoJSON=r);i.call(this,n,t)}var u=n("../util/util"),f=n("../util/ajax"),e=n("geojson-rewind"),o=n("./geojson_wrapper"),s=n("vt-pbf"),h=n("supercluster"),c=n("geojson-vt"),i=n("./vector_tile_worker_source");t.exports=r;r.prototype=u.inherit(i,{_geoJSONIndexes:{},loadVectorData:function(n,t){var e=n.source,u=n.coord,f,r,i;if(!this._geoJSONIndexes[e])return t(null,null);if(f=this._geoJSONIndexes[e].getTile(Math.min(u.z,n.maxZoom),u.x,u.y),f)r=new o(f.features),r.name="_geojsonTileLayer",i=s({layers:{_geojsonTileLayer:r}}),(i.byteOffset!==0||i.byteLength!==i.buffer.byteLength)&&(i=new Uint8Array(i)),t(null,{tile:r,rawTileData:i.buffer});else return t(null,null)},loadData:function(n,t){var i=function(i,r){if(i)return t(i);if(typeof r!="object")return t(new Error("Input data is not a valid GeoJSON object."));e(r,!0);this._indexData(r,n,function(i,r){if(i)return t(i);this._geoJSONIndexes[n.source]=r;t(null)}.bind(this))}.bind(this);this.loadGeoJSON(n,i)},loadGeoJSON:function(n,t){if(n.url)f.getJSON(n.url,t);else if(typeof n.data=="string")try{return t(null,JSON.parse(n.data))}catch(i){return t(new Error("Input data is not a valid GeoJSON object."))}else return t(new Error("Input data is not a valid GeoJSON object."))},_indexData:function(n,t,i){try{t.cluster?i(null,h(t.superclusterOptions).load(n.features)):i(null,c(n,t.geojsonVtOptions))}catch(r){return i(r)}}})},{"../util/ajax":418,"../util/util":435,"./geojson_wrapper":353,"./vector_tile_worker_source":364,"geojson-rewind":440,"geojson-vt":446,supercluster:497,"vt-pbf":507}],353:[function(n,t){"use strict";function u(n){this.features=n;this.length=n.length;this.extent=r}function i(n){if(this.type=n.type,n.type===1){this.rawGeometry=[];for(var t=0;t<n.geometry.length;t++)this.rawGeometry.push([n.geometry[t]])}else this.rawGeometry=n.geometry;this.properties=n.tags;this.extent=r}var f=n("point-geometry"),e=n("vector-tile").VectorTileFeature,r=n("../data/bucket").EXTENT;t.exports=u;u.prototype.feature=function(n){return new i(this.features[n])};i.prototype.loadGeometry=function(){var u=this.rawGeometry,t,i,r,n;for(this.geometry=[],t=0;t<u.length;t++){for(i=u[t],r=[],n=0;n<i.length;n++)r.push(new f(i[n][0],i[n][1]));this.geometry.push(r)}return this.geometry};i.prototype.bbox=function(){var t,o,i,n;this.geometry||this.loadGeometry();var s=this.geometry,r=Infinity,u=-Infinity,f=Infinity,e=-Infinity;for(t=0;t<s.length;t++)for(o=s[t],i=0;i<o.length;i++)n=o[i],r=Math.min(r,n.x),u=Math.max(u,n.x),f=Math.min(f,n.y),e=Math.max(e,n.y);return[r,f,u,e]};i.prototype.toGeoJSON=e.prototype.toGeoJSON},{"../data/bucket":322,"point-geometry":493,"vector-tile":503}],354:[function(n,t){"use strict";function e(n,t,i){this.id=n;this.dispatcher=i;this.url=t.url;this.coordinates=t.coordinates;l.getImage(t.url,function(n,i){if(n)return this.fire("error",{error:n});this.image=i;this.image.addEventListener("load",function(){this.map._rerender()}.bind(this));this._loaded=!0;this.fire("load");this.map&&this.setCoordinates(t.coordinates)}.bind(this))}var i=n("../util/util"),o=n("./tile_coord"),s=n("../geo/lng_lat"),h=n("point-geometry"),c=n("../util/evented"),l=n("../util/ajax"),r=n("../data/bucket").EXTENT,u=n("../render/draw_raster").RasterBoundsArray,f=n("../data/buffer"),a=n("../render/vertex_array_object");t.exports=e;e.prototype=i.inherit(c,{minzoom:0,maxzoom:22,tileSize:512,onAdd:function(n){this.map=n;this.image&&this.setCoordinates(this.coordinates)},setCoordinates:function(n){this.coordinates=n;var f=this.map,u=n.map(function(n){return f.transform.locationCoordinate(s.convert(n)).zoomTo(0)}),t=this.centerCoord=i.getCoordinatesCenter(u);return t.column=Math.round(t.column),t.row=Math.round(t.row),this.minzoom=this.maxzoom=t.zoom,this._coord=new o(t.zoom,t.column,t.row),this._tileCoords=u.map(function(n){var i=n.zoomTo(t.zoom);return new h(Math.round((i.column-t.column)*r),Math.round((i.row-t.row)*r))}),this.fire("change"),this},_setTile:function(n){this._prepared=!1;this.tile=n;var i=32767,t=new u;t.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0);t.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,i,0);t.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,i);t.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,i,i);this.tile.buckets={};this.tile.boundsBuffer=new f(t.serialize(),u.serialize(),f.BufferType.VERTEX);this.tile.boundsVAO=new a;this.tile.state="loaded"},prepare:function(){if(this._loaded&&this.image&&this.image.complete&&this.tile){var t=this.map.painter,n=t.gl;this._prepared?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.image)):(this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.image))}},loadTile:function(n,t){this._coord&&this._coord.toString()===n.coord.toString()?(this._setTile(n),t(null)):(n.state="errored",t(null))},serialize:function(){return{type:"image",urls:this.url,coordinates:this.coordinates}}})},{"../data/bucket":322,"../data/buffer":327,"../geo/lng_lat":332,"../render/draw_raster":344,"../render/vertex_array_object":350,"../util/ajax":418,"../util/evented":427,"../util/util":435,"./tile_coord":362,"point-geometry":493}],355:[function(n,t){"use strict";var i=n("../util/util"),r=n("../util/ajax"),u=n("../util/browser"),f=n("../util/mapbox").normalizeSourceURL;t.exports=function(n,t){var e=function(n,r){if(n)return t(n);var u=i.pick(r,["tiles","minzoom","maxzoom","attribution"]);r.vector_layers&&(u.vectorLayers=r.vector_layers,u.vectorLayerIds=u.vectorLayers.map(function(n){return n.id}));t(null,u)};n.url?r.getJSON(f(n.url),e):u.frame(e.bind(null,null,n))}},{"../util/ajax":418,"../util/browser":419,"../util/mapbox":432,"../util/util":435}],356:[function(n,t){"use strict";var i=n("../data/bucket");t.exports=function(n,t,r){return t*(i.EXTENT/(n.tileSize*Math.pow(2,r-n.coord.z)))}},{"../data/bucket":322}],357:[function(n,t,i){"use strict";function u(n,t){var i=n.coord,r=t.coord;return i.z-r.z||i.y-r.y||i.w-r.w||i.x-r.x}function f(n){for(var o,t,i,r,u,f=n[0]||{},e=1;e<n.length;e++){o=n[e];for(t in o)if(i=o[t],r=f[t],r===undefined)r=f[t]=i;else for(u=0;u<i.length;u++)r.push(i[u])}return f}var r=n("./tile_coord");i.rendered=function(n,t,i,r,e,o){var c=n.tilesIn(i),l,h,s;for(c.sort(u),l=[],h=0;h<c.length;h++)(s=c[h],s.tile.featureIndex)&&l.push(s.tile.featureIndex.query({queryGeometry:s.queryGeometry,scale:s.scale,tileSize:s.tile.tileSize,bearing:o,params:r},t));return f(l)};i.source=function(n,t){for(var i,f,e=n.renderedIDs().map(function(t){return n.getTileByID(t)}),o=[],s={},u=0;u<e.length;u++)i=e[u],f=new r(Math.min(i.sourceMaxZoom,i.coord.z),i.coord.x,i.coord.y,0).id,s[f]||(s[f]=!0,i.querySourceFeatures(o,t));return o}},{"./tile_coord":362}],358:[function(n,t){"use strict";function r(n,t,r){this.id=n;this.dispatcher=r;i.extend(this,i.pick(t,["url","scheme","tileSize"]));e(t,function(n,t){if(n)return this.fire("error",n);i.extend(this,t);this.fire("load")}.bind(this))}var i=n("../util/util"),u=n("../util/ajax"),f=n("../util/evented"),e=n("./load_tilejson"),o=n("../util/mapbox").normalizeTileURL;t.exports=r;r.prototype=i.inherit(f,{minzoom:0,maxzoom:22,roundZoom:!0,scheme:"xyz",tileSize:512,_loaded:!1,onAdd:function(n){this.map=n},serialize:function(){return{type:"raster",url:this.url,tileSize:this.tileSize}},loadTile:function(n,t){function r(i,r){if(delete n.request,!n.aborted){if(i)return t(i);var u=this.map.painter.gl;n.texture=this.map.painter.getTexture(r.width);n.texture?(u.bindTexture(u.TEXTURE_2D,n.texture),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,r)):(n.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,n.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR_MIPMAP_NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,r),n.texture.size=r.width);u.generateMipmap(u.TEXTURE_2D);this.map.animationLoop.set(this.map.style.rasterFadeDuration);n.state="loaded";t(null)}}var i=o(n.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);n.request=u.getImage(i,r.bind(this))},abortTile:function(n){n.request&&(n.request.abort(),delete n.request)},unloadTile:function(n){n.texture&&this.map.painter.saveTexture(n.texture)}})},{"../util/ajax":418,"../util/evented":427,"../util/mapbox":432,"../util/util":435,"./load_tilejson":355}],359:[function(n,t,i){"use strict";var u=n("../util/util"),r={vector:n("../source/vector_tile_source"),raster:n("../source/raster_tile_source"),geojson:n("../source/geojson_source"),video:n("../source/video_source"),image:n("../source/image_source")};i.create=function(n,t,i){if(t=new r[t.type](n,t,i),t.id!==n)throw new Error("Expected Source id to be "+n+" instead of "+t.id);return u.bindAll(["load","abort","unload","serialize","prepare"],t),t};i.getType=function(n){return r[n]};i.setType=function(n,t){r[n]=t}},{"../source/geojson_source":351,"../source/image_source":354,"../source/raster_tile_source":358,"../source/vector_tile_source":363,"../source/video_source":365,"../util/util":435}],360:[function(n,t){"use strict";function i(n,t,i){this.id=n;this.dispatcher=i;var r=this._source=s.create(n,t,i).on("load",function(){if(this.map&&this._source.onAdd)this._source.onAdd(this.map);this._sourceLoaded=!0;this.tileSize=r.tileSize;this.minzoom=r.minzoom;this.maxzoom=r.maxzoom;this.roundZoom=r.roundZoom;this.reparseOverscaled=r.reparseOverscaled;this.isTileClipped=r.isTileClipped;this.attribution=r.attribution;this.vectorLayerIds=r.vectorLayerIds;this.fire("load")}.bind(this)).on("error",function(n){this._sourceErrored=!0;this.fire("error",n)}.bind(this)).on("change",function(){this.reload();this.transform&&this.update(this.transform,this.map&&this.map.style.rasterFadeDuration);this.fire("change")}.bind(this));this._tiles={};this._cache=new l(0,this.unloadTile.bind(this));this._isIdRenderable=this._isIdRenderable.bind(this)}function f(n,t,i){var u=i.zoomTo(Math.min(n.z,t));return{x:(u.column-(n.x+n.w*Math.pow(2,n.z)))*r,y:(u.row-n.y)*r}}function a(n,t){return n%32-t%32}var s=n("./source"),h=n("./tile"),c=n("../util/evented"),u=n("./tile_coord"),l=n("../util/lru_cache"),e=n("../geo/coordinate"),o=n("../util/util"),r=n("../data/bucket").EXTENT;t.exports=i;i.maxOverzooming=10;i.maxUnderzooming=3;i.prototype=o.inherit(c,{onAdd:function(n){if(this.map=n,this._source&&this._source.onAdd)this._source.onAdd(n)},loaded:function(){var t,n;if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(t in this._tiles)if(n=this._tiles[t],n.state!=="loaded"&&n.state!=="errored")return!1;return!0},getSource:function(){return this._source},loadTile:function(n,t){return this._source.loadTile(n,t)},unloadTile:function(n){if(this._source.unloadTile)return this._source.unloadTile(n)},abortTile:function(n){if(this._source.abortTile)return this._source.abortTile(n)},serialize:function(){return this._source.serialize()},prepare:function(){if(this._sourceLoaded&&this._source.prepare)return this._source.prepare()},getIds:function(){return Object.keys(this._tiles).map(Number).sort(a)},getRenderableIds:function(){return this.getIds().filter(this._isIdRenderable)},_isIdRenderable:function(n){return this._tiles[n].isRenderable()&&!this._coveredTiles[n]},reload:function(){var n,t;this._cache.reset();for(n in this._tiles)t=this._tiles[n],t.state!=="loading"&&(t.state="reloading"),this.loadTile(this._tiles[n],this._tileLoaded.bind(this,this._tiles[n]))},_tileLoaded:function(n,t){if(t){n.state="errored";this.fire("tile.error",{tile:n,error:t});this._source.fire("tile.error",{tile:n,error:t});return}n.source=this;n.timeAdded=(new Date).getTime();this.fire("tile.load",{tile:n});this._source.fire("tile.load",{tile:n})},getTile:function(n){return this.getTileByID(n.id)},getTileByID:function(n){return this._tiles[n]},getZoom:function(n){return n.zoom+n.scaleZoom(n.tileSize/this.tileSize)},findLoadedChildren:function(n,t,i){var o=!1,u,r,f,e;for(u in this._tiles)if((r=this._tiles[u],!i[u]&&r.isRenderable()&&!(r.coord.z<=n.z)&&!(r.coord.z>t))&&(f=Math.pow(2,Math.min(r.coord.z,this.maxzoom)-Math.min(n.z,this.maxzoom)),Math.floor(r.coord.x/f)===n.x&&Math.floor(r.coord.y/f)===n.y))for(i[u]=!0,o=!0;r&&r.coord.z-1>n.z;)e=r.coord.parent(this.maxzoom).id,r=this._tiles[e],r&&r.isRenderable()&&(delete i[u],i[e]=!0);return o},findLoadedParent:function(n,t,i){for(var r,u=n.z-1;u>=t;u--){if(n=n.parent(this.maxzoom),r=this._tiles[n.id],r&&r.isRenderable())return i[n.id]=!0,r;if(this._cache.has(n.id))return this.addTile(n),i[n.id]=!0,this._tiles[n.id]}},updateCacheSize:function(n){var t=Math.ceil(n.width/n.tileSize)+1,i=Math.ceil(n.height/n.tileSize)+1,r=t*i;this._cache.setMaxSize(Math.floor(r*5))},update:function(n,t){var f,e,s,v,c,y,l,a,h,p;if(this._sourceLoaded){this.updateCacheSize(n);var w=(this.roundZoom?Math.round:Math.floor)(this.getZoom(n)),b=Math.max(w-i.maxOverzooming,this.minzoom),k=Math.max(w+i.maxUnderzooming,this.minzoom),r={},d=(new Date).getTime();for(this._coveredTiles={},v=this.used?n.coveringTiles(this._source):[],f=0;f<v.length;f++)(e=v[f],s=this.addTile(e),r[e.id]=!0,s.isRenderable())||this.findLoadedChildren(e,k,r)||this.findLoadedParent(e,b,r);for(c={},y=Object.keys(r),l=0;l<y.length;l++)a=y[l],e=u.fromID(a),s=this._tiles[a],s&&s.timeAdded>d-(t||0)&&(this.findLoadedChildren(e,k,r)&&(r[a]=!0),this.findLoadedParent(e,b,c));for(h in c)r[h]||(this._coveredTiles[h]=!0);for(h in c)r[h]=!0;for(p=o.keysDifference(this._tiles,r),f=0;f<p.length;f++)this.removeTile(+p[f]);this.transform=n}},addTile:function(n){var t=this._tiles[n.id],i,r,u;return t?t:(i=n.wrapped(),t=this._tiles[i.id],t||(t=this._cache.get(i.id),t&&this._redoPlacement&&this._redoPlacement(t)),t||(r=n.z,u=r>this.maxzoom?Math.pow(2,r-this.maxzoom):1,t=new h(i,this.tileSize*u,this.maxzoom),this.loadTile(t,this._tileLoaded.bind(this,t))),t.uses++,this._tiles[n.id]=t,this.fire("tile.add",{tile:t}),this._source.fire("tile.add",{tile:t}),t)},removeTile:function(n){var t=this._tiles[n];t&&((t.uses--,delete this._tiles[n],this.fire("tile.remove",{tile:t}),this._source.fire("tile.remove",{tile:t}),t.uses>0)||(t.isRenderable()?this._cache.add(t.coord.wrapped().id,t):(t.aborted=!0,this.abortTile(t),this.unloadTile(t))))},clearTiles:function(){for(var n in this._tiles)this.removeTile(n);this._cache.reset()},tilesIn:function(n){for(var i,o,d,l,a,g,tt,s={},v=this.getIds(),y=Infinity,p=Infinity,w=-Infinity,b=-Infinity,nt=n[0].zoom,k=0;k<n.length;k++)i=n[k],y=Math.min(y,i.column),p=Math.min(p,i.row),w=Math.max(w,i.column),b=Math.max(b,i.row);for(o=0;o<v.length;o++){var t=this._tiles[v[o]],h=u.fromID(v[o]),c=[f(h,t.sourceMaxZoom,new e(y,p,nt)),f(h,t.sourceMaxZoom,new e(w,b,nt))];if(c[0].x<r&&c[0].y<r&&c[1].x>=0&&c[1].y>=0){for(d=[],l=0;l<n.length;l++)d.push(f(h,t.sourceMaxZoom,n[l]));a=s[t.coord.id];a===undefined&&(a=s[t.coord.id]={tile:t,coord:h,queryGeometry:[],scale:Math.pow(2,this.transform.zoom-t.coord.z)});a.queryGeometry.push(d)}}g=[];for(tt in s)g.push(s[tt]);return g},redoPlacement:function(){for(var i,t=this.getIds(),n=0;n<t.length;n++)i=this.getTileByID(t[n]),i.redoPlacement(this)},getVisibleCoordinates:function(){return this.getRenderableIds().map(u.fromID)}})},{"../data/bucket":322,"../geo/coordinate":331,"../util/evented":427,"../util/lru_cache":431,"../util/util":435,"./source":359,"./tile":361,"./tile_coord":362}],361:[function(n,t){"use strict";function u(n,t,r){this.coord=n;this.uid=i.uniqueId();this.uses=0;this.tileSize=t;this.sourceMaxZoom=r;this.buckets={};this.state="loading"}function f(n,t){var u,r,f,o;if(t){for(u={},r=0;r<n.length;r++)(f=t.getLayer(n[r].layerId),f)&&(o=e.create(i.extend({layer:f,childLayers:n[r].childLayerIds.map(t.getLayer.bind(t)).filter(function(n){return n})},n[r])),u[o.id]=o);return u}}var i=n("../util/util"),e=n("../data/bucket"),o=n("../data/feature_index"),s=n("vector-tile"),h=n("pbf"),c=n("../util/vectortile_to_geojson"),l=n("feature-filter"),r=n("../symbol/collision_tile"),a=n("../symbol/collision_box"),v=n("../symbol/symbol_instances"),y=n("../symbol/symbol_quads");t.exports=u;u.prototype={loadVectorData:function(n,t){(this.state="loaded",n)&&(this.collisionBoxArray=new a(n.collisionBoxArray),this.collisionTile=new r(n.collisionTile,this.collisionBoxArray),this.symbolInstancesArray=new v(n.symbolInstancesArray),this.symbolQuadsArray=new y(n.symbolQuadsArray),this.featureIndex=new o(n.featureIndex,n.rawTileData,this.collisionTile),this.rawTileData=n.rawTileData,this.buckets=f(n.buckets,t))},reloadSymbolData:function(n,t,u){var e,o;if(this.state!=="unloaded"){this.collisionTile=new r(n.collisionTile,this.collisionBoxArray);this.featureIndex.setCollisionTile(this.collisionTile);for(e in this.buckets)o=this.buckets[e],o.type==="symbol"&&(o.destroy(t.gl),delete this.buckets[e]);i.extend(this.buckets,f(n.buckets,u))}},unloadVectorData:function(n){var t,i;for(t in this.buckets)i=this.buckets[t],i.destroy(n.gl);this.collisionBoxArray=null;this.symbolQuadsArray=null;this.symbolInstancesArray=null;this.collisionTile=null;this.featureIndex=null;this.rawTileData=null;this.buckets=null;this.state="unloaded"},redoPlacement:function(n){function t(t,i){this.reloadSymbolData(i,n.map.painter,n.map.style);n.fire("tile.load",{tile:this});this.state="loaded";this.redoWhenDone&&(this.redoPlacement(n),this.redoWhenDone=!1)}if(this.state!=="loaded"||this.state==="reloading"){this.redoWhenDone=!0;return}this.state="reloading";n.dispatcher.send("redo placement",{uid:this.uid,source:n.id,angle:n.map.transform.angle,pitch:n.map.transform.pitch,showCollisionBoxes:n.map.showCollisionBoxes},t.bind(this),this.workerID)},getBucket:function(n){return this.buckets&&this.buckets[n.ref||n.id]},querySourceFeatures:function(n,t){var i,e,o,r,u,f;if(this.rawTileData&&(this.vtLayers||(this.vtLayers=new s.VectorTile(new h(new Uint8Array(this.rawTileData))).layers),i=this.vtLayers._geojsonTileLayer||this.vtLayers[t.sourceLayer],i))for(e=l(t.filter),o={z:this.coord.z,x:this.coord.x,y:this.coord.y},r=0;r<i.length;r++)u=i.feature(r),e(u)&&(f=new c(u,this.coord.z,this.coord.x,this.coord.y),f.tile=o,n.push(f))},isRenderable:function(){return this.state==="loaded"||this.state==="reloading"}}},{"../data/bucket":322,"../data/feature_index":329,"../symbol/collision_box":387,"../symbol/collision_tile":389,"../symbol/symbol_instances":398,"../symbol/symbol_quads":399,"../util/util":435,"../util/vectortile_to_geojson":436,"feature-filter":439,pbf:491,"vector-tile":503}],362:[function(n,t){"use strict";function i(n,t,i,r){isNaN(r)&&(r=0);this.z=+n;this.x=+t;this.y=+i;this.w=+r;r*=2;r<0&&(r=r*-1-1);var u=1<<this.z;this.id=(u*u*r+u*this.y+this.x)*32+this.z;this.posMatrix=null}function s(n,t,i){for(var f="",r,u=n;u>0;u--)r=1<<u-1,f+=(t&r?1:0)+(i&r?2:0);return f}function r(n,t){if(n.row>t.row){var i=n;n=t;t=i}return{x0:n.column,y0:n.row,x1:t.column,y1:t.row,dx:t.column-n.column,dy:t.row-n.row}}function u(n,t,i,r,u){var h=Math.max(i,Math.floor(t.y0)),c=Math.min(r,Math.ceil(t.y1)),e,f,o,s;(n.x0===t.x0&&n.y0===t.y0?n.x0+t.dy/n.dy*n.dx<t.x1:n.x1-t.dy/n.dy*n.dx<t.x0)&&(e=n,n=t,t=e);var l=n.dx/n.dy,a=t.dx/t.dy,v=n.dx>0,y=t.dx<0;for(f=h;f<c;f++)o=l*Math.max(0,Math.min(n.dy,f+v-n.y0))+n.x0,s=a*Math.max(0,Math.min(t.dy,f+y-t.y0))+t.x0,u(Math.floor(s),Math.ceil(o),f)}function f(n,t,i,f,e,o){var s=r(n,t),h=r(t,i),c=r(i,n),l;s.dy>h.dy&&(l=s,s=h,h=l);s.dy>c.dy&&(l=s,s=c,c=l);h.dy>c.dy&&(l=h,h=c,c=l);s.dy&&u(c,s,f,e,o);h.dy&&u(c,h,f,e,o)}var e=n("whoots-js"),o=n("../geo/coordinate");t.exports=i;i.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};i.prototype.toCoordinate=function(n){var t=Math.min(this.z,n),i=Math.pow(2,t),r=this.y,u=this.x+i*this.w;return new o(u,r,t)};i.fromID=function(n){var u=n%32,t=1<<u,f=(n-u)/32,e=f%t,o=(f-e)/t%t,r=Math.floor(f/(t*t));return r%2!=0&&(r=r*-1-1),r/=2,new i(u,e,o,r)};i.prototype.url=function(n,t,i){var r=e.getTileBBox(this.x,this.y,this.z),u=s(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,t||this.z)).replace("{x}",this.x).replace("{y}",i==="tms"?Math.pow(2,this.z)-this.y-1:this.y).replace("{quadkey}",u).replace("{bbox-epsg-3857}",r)};i.prototype.parent=function(n){return this.z===0?null:this.z>n?new i(this.z-1,this.x,this.y,this.w):new i(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)};i.prototype.wrapped=function(){return new i(this.z,this.x,this.y,0)};i.prototype.children=function(n){if(this.z>=n)return[new i(this.z+1,this.x,this.y,this.w)];var t=this.z+1,r=this.x*2,u=this.y*2;return[new i(t,r,u,this.w),new i(t,r+1,u,this.w),new i(t,r,u+1,this.w),new i(t,r+1,u+1,this.w)]};i.cover=function(n,t,r){function o(n,t,f){var o,h,s;if(f>=0&&f<=u)for(o=n;o<t;o++)h=(o%u+u)%u,s=new i(r,h,f,Math.floor(o/u)),e[s.id]=s}var u=1<<n,e={};return f(t[0],t[1],t[2],0,u,o),f(t[2],t[3],t[0],0,u,o),Object.keys(e).map(function(n){return e[n]})}},{"../geo/coordinate":331,"whoots-js":511}],363:[function(n,t){"use strict";function r(n,t,r){if(this.id=n,this.dispatcher=r,i.extend(this,i.pick(t,["url","scheme","tileSize"])),this._options=i.extend({type:"vector"},t),this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");f(t,function(n,t){if(n){this.fire("error",n);return}i.extend(this,t);this.fire("load")}.bind(this))}var u=n("../util/evented"),i=n("../util/util"),f=n("./load_tilejson"),e=n("../util/mapbox").normalizeTileURL;t.exports=r;r.prototype=i.inherit(u,{minzoom:0,maxzoom:22,scheme:"xyz",tileSize:512,reparseOverscaled:!0,isTileClipped:!0,onAdd:function(n){this.map=n},serialize:function(){return i.extend({},this._options)},loadTile:function(n,t){function u(i,r){if(!n.aborted){if(i)return t(i);n.loadVectorData(r,this.map.style);n.redoWhenDone&&(n.redoWhenDone=!1,n.redoPlacement(this));t(null);n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)}}var r=n.coord.z>this.maxzoom?Math.pow(2,n.coord.z-this.maxzoom):1,i={url:e(n.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),uid:n.uid,coord:n.coord,zoom:n.coord.z,tileSize:this.tileSize*r,source:this.id,overscaling:r,angle:this.map.transform.angle,pitch:this.map.transform.pitch,showCollisionBoxes:this.map.showCollisionBoxes};n.workerID?n.state==="loading"?n.reloadCallback=t:(i.rawTileData=n.rawTileData,this.dispatcher.send("reload tile",i,u.bind(this),n.workerID)):n.workerID=this.dispatcher.send("load tile",i,u.bind(this))},abortTile:function(n){this.dispatcher.send("abort tile",{uid:n.uid,source:this.id},null,n.workerID)},unloadTile:function(n){n.unloadVectorData(this.map.painter);this.dispatcher.send("remove tile",{uid:n.uid,source:this.id},null,n.workerID)}})},{"../util/evented":427,"../util/mapbox":432,"../util/util":435,"./load_tilejson":355}],364:[function(n,t){"use strict";function i(n,t,i){this.actor=n;this.styleLayers=t;i&&(this.loadVectorData=i);this.loading={};this.loaded={}}var r=n("../util/ajax"),u=n("vector-tile"),f=n("pbf"),e=n("./worker_tile");t.exports=i;i.prototype={loadTile:function(n,t){function f(n,f){if(delete this.loading[i][u],n)return t(n);if(!f)return t(null,null);r.data=f.tile;r.parse(r.data,this.styleLayers.getLayerFamilies(),this.actor,f.rawTileData,t);this.loaded[i]=this.loaded[i]||{};this.loaded[i][u]=r}var i=n.source,u=n.uid,r;this.loading[i]||(this.loading[i]={});r=this.loading[i][u]=new e(n);r.abort=this.loadVectorData(n,f.bind(this))},reloadTile:function(n,t){var i=this.loaded[n.source],u=n.uid,r;i&&i[u]&&(r=i[u],r.parse(r.data,this.styleLayers.getLayerFamilies(),this.actor,n.rawTileData,t))},abortTile:function(n){var t=this.loading[n.source],i=n.uid;t&&t[i]&&t[i].abort&&(t[i].abort(),delete t[i])},removeTile:function(n){var t=this.loaded[n.source],i=n.uid;t&&t[i]&&delete t[i]},loadVectorData:function(n,t){function e(n,i){if(n)return t(n);var r=new u.VectorTile(new f(new Uint8Array(i)));t(n,{tile:r,rawTileData:i})}var i=r.getArrayBuffer(n.url,e.bind(this));return function(){i.abort()}},redoPlacement:function(n,t){var u=this.loaded[n.source],f=this.loading[n.source],i=n.uid,e,r;u&&u[i]?(e=u[i],r=e.redoPlacement(n.angle,n.pitch,n.showCollisionBoxes),r.result&&t(null,r.result,r.transferables)):f&&f[i]&&(f[i].angle=n.angle)}}},{"../util/ajax":418,"./worker_tile":367,pbf:491,"vector-tile":503}],365:[function(n,t){"use strict";function e(n,t){this.id=n;this.urls=t.urls;this.coordinates=t.coordinates;l.getVideo(t.urls,function(n,i){if(n)return this.fire("error",{error:n});this.video=i;this.video.loop=!0;var r;this.video.addEventListener("playing",function(){r=this.map.style.animationLoop.set(Infinity);this.map._rerender()}.bind(this));this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(r)}.bind(this));this.map&&(this.video.play(),this.setCoordinates(t.coordinates));this.fire("load")}.bind(this))}var i=n("../util/util"),o=n("./tile_coord"),s=n("../geo/lng_lat"),h=n("point-geometry"),c=n("../util/evented"),l=n("../util/ajax"),r=n("../data/bucket").EXTENT,u=n("../render/draw_raster").RasterBoundsArray,f=n("../data/buffer"),a=n("../render/vertex_array_object");t.exports=e;e.prototype=i.inherit(c,{minzoom:0,maxzoom:22,tileSize:512,roundZoom:!0,getVideo:function(){return this.video},onAdd:function(n){this.map||(this.map=n,this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},setCoordinates:function(n){this.coordinates=n;var f=this.map,u=n.map(function(n){return f.transform.locationCoordinate(s.convert(n)).zoomTo(0)}),t=this.centerCoord=i.getCoordinatesCenter(u);return t.column=Math.round(t.column),t.row=Math.round(t.row),this.minzoom=this.maxzoom=t.zoom,this._coord=new o(t.zoom,t.column,t.row),this._tileCoords=u.map(function(n){var i=n.zoomTo(t.zoom);return new h(Math.round((i.column-t.column)*r),Math.round((i.row-t.row)*r))}),this.fire("change"),this},_setTile:function(n){this._prepared=!1;this.tile=n;var i=32767,t=new u;t.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0);t.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,i,0);t.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,i);t.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,i,i);this.tile.buckets={};this.tile.boundsBuffer=new f(t.serialize(),u.serialize(),f.BufferType.VERTEX);this.tile.boundsVAO=new a;this.tile.state="loaded"},prepare:function(){if(!(this.video.readyState<2)&&this.tile){var n=this.map.painter.gl;this._prepared?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this._prepared=!0,this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.video));this._currentTime=this.video.currentTime}},loadTile:function(n,t){this._coord&&this._coord.toString()===n.coord.toString()?(this._setTile(n),t(null)):(n.state="errored",t(null))},serialize:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}})},{"../data/bucket":322,"../data/buffer":327,"../geo/lng_lat":332,"../render/draw_raster":344,"../render/vertex_array_object":350,"../util/ajax":418,"../util/evented":427,"../util/util":435,"./tile_coord":362,"point-geometry":493}],366:[function(n,t){"use strict";function r(n){this.self=n;this.actor=new f(n,this);var t={getLayers:function(){return this.layers}.bind(this),getLayerFamilies:function(){return this.layerFamilies}.bind(this)};this.workerSources={vector:new o(this.actor,t),geojson:new s(this.actor,t)};this.self.registerWorkerSource=function(n,i){if(this.workerSources[n])throw new Error('Worker source with name "'+n+'" already registered.');this.workerSources[n]=new i(this.actor,t)}.bind(this)}function u(n){var i={};for(var u in n){var r=n[u],t=r.ref||r.id,f=n[t];f.layout&&f.layout.visibility==="none"||(i[t]=i[t]||[],u===t?i[t].unshift(r):i[t].push(r))}return i}var f=n("../util/actor"),i=n("../style/style_layer"),e=n("../util/util"),o=n("./vector_tile_worker_source"),s=n("./geojson_worker_source");t.exports=function(n){return new r(n)};e.extend(r.prototype,{"set layers":function(n){function s(n){var t=i.create(n,n.ref&&o.layers[n.ref]);t.updatePaintTransitions({},{transition:!1});o.layers[t.id]=t}var o,f,r,t,e;for(this.layers={},o=this,f=[],r=0;r<n.length;r++)t=n[r],(t.type==="fill"||t.type==="line"||t.type==="circle"||t.type==="symbol")&&(t.ref?f.push(r):s(t));for(e=0;e<f.length;e++)s(n[f[e]]);this.layerFamilies=u(this.layers)},"update layers":function(n){function e(n){var t=r.layers[n.ref];r.layers[n.id]?r.layers[n.id].set(n,t):r.layers[n.id]=i.create(n,t);r.layers[n.id].updatePaintTransitions({},{transition:!1})}var r=this,f,t;for(f in n)t=n[f],t.ref&&e(t);for(f in n)t=n[f],t.ref||e(t);this.layerFamilies=u(this.layers)},"load tile":function(n,t){var i=n.type||"vector";this.workerSources[i].loadTile(n,t)},"reload tile":function(n,t){var i=n.type||"vector";this.workerSources[i].reloadTile(n,t)},"abort tile":function(n){var t=n.type||"vector";this.workerSources[t].abortTile(n)},"remove tile":function(n){var t=n.type||"vector";this.workerSources[t].removeTile(n)},"redo placement":function(n,t){var i=n.type||"vector";this.workerSources[i].redoPlacement(n,t)},"load worker source":function(n,t){try{this.self.importScripts(n.url);t()}catch(i){t(i)}}})},{"../style/style_layer":374,"../util/actor":417,"../util/util":435,"./geojson_worker_source":352,"./vector_tile_worker_source":364}],367:[function(n,t){"use strict";function i(n){this.coord=n.coord;this.uid=n.uid;this.zoom=n.zoom;this.tileSize=n.tileSize;this.source=n.source;this.overscaling=n.overscaling;this.angle=n.angle;this.pitch=n.pitch;this.showCollisionBoxes=n.showCollisionBoxes}function u(n){return!n.isEmpty()}function f(n){return n.serialize()}function e(n){var t=[];for(var i in n)n[i].getTransferables(t);return t}function y(n){return n.id}var o=n("../data/feature_index"),r=n("../symbol/collision_tile"),s=n("../data/bucket"),h=n("../symbol/collision_box"),c=n("../util/dictionary_coder"),l=n("../util/util"),a=n("../symbol/symbol_instances"),v=n("../symbol/symbol_quads");t.exports=i;i.prototype.parse=function(n,t,i,p,w){function at(n,t){for(var r,u,i=0;i<n.length;i++){r=n.feature(i);r.index=i;for(u in t)t[u].filter(r)&&t[u].features.push(r)}}function lt(n){if(n)return w(n);if(pt++,pt===2){for(var t=tt.length-1;t>=0;t--)wt(d,tt[t]);bt()}}function wt(n,t){var i,r;if(t.populateArrays(ot,rt,it),t.type!=="symbol")for(i=0;i<t.features.length;i++)r=t.features[i],ft.insert(r,r.index,t.sourceLayerIndex,t.index);t.features=null}function bt(){d.status="done";d.redoPlacementAfterDone&&(d.redoPlacement(d.angle,d.pitch,null),d.redoPlacementAfterDone=!1);var n=ft.serialize(),t=ot.serialize(),r=d.collisionBoxArray.serialize(),o=d.symbolInstancesArray.serialize(),s=d.symbolQuadsArray.serialize(),h=[p].concat(n.transferables).concat(t.transferables),i=vt.filter(u);w(null,{buckets:i.map(f),featureIndex:n.data,collisionTile:t.data,collisionBoxArray:r,symbolInstancesArray:o,symbolQuadsArray:s,rawTileData:p},e(i).concat(h))}var st,yt,ct;this.status="parsing";this.data=n;this.collisionBoxArray=new h;this.symbolInstancesArray=new a;this.symbolQuadsArray=new v;var ot=new r(this.angle,this.pitch,this.collisionBoxArray),ft=new o(this.coord,this.overscaling,ot,n.layers),kt=new c(n.layers?Object.keys(n.layers).sort():["_geojsonTileLayer"]),d=this,et={},ut={},g,b,nt,k,dt=0;for(st in t)(b=t[st][0],b.source===this.source)&&(b.ref||b.minzoom&&this.zoom<b.minzoom||b.maxzoom&&this.zoom>=b.maxzoom||b.layout&&b.layout.visibility==="none"||(!n.layers||n.layers[b.sourceLayer])&&(k=s.create({layer:b,index:dt++,childLayers:t[st],zoom:this.zoom,overscaling:this.overscaling,showCollisionBoxes:this.showCollisionBoxes,collisionBoxArray:this.collisionBoxArray,symbolQuadsArray:this.symbolQuadsArray,symbolInstancesArray:this.symbolInstancesArray,sourceLayerIndex:kt.encode(b.sourceLayer||"_geojsonTileLayer")}),k.createFilter(),et[b.id]=k,n.layers&&(nt=b.sourceLayer,ut[nt]=ut[nt]||{},ut[nt][b.id]=k)));if(n.layers)for(nt in ut)b.version===1&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+nt+'" does not use vector tile spec v2 and therefore may have some rendering errors.'),b=n.layers[nt],b&&at(b,ut[nt]);else at(n,et);var vt=[],tt=this.symbolBuckets=[],ht=[];ft.bucketLayerIDs={};for(yt in et)(k=et[yt],k.features.length!==0)&&(ft.bucketLayerIDs[k.index]=k.childLayers.map(y),vt.push(k),k.type==="symbol"?tt.push(k):ht.push(k));var it={},rt={},pt=0;if(tt.length>0){for(g=tt.length-1;g>=0;g--)tt[g].updateIcons(it),tt[g].updateFont(rt);for(ct in rt)rt[ct]=Object.keys(rt[ct]).map(Number);it=Object.keys(it);i.send("get glyphs",{uid:this.uid,stacks:rt},function(n,t){rt=t;lt(n)});it.length?i.send("get icons",{icons:it},function(n,t){it=t;lt(n)}):lt()}for(g=ht.length-1;g>=0;g--)wt(this,ht[g]);if(tt.length===0)return bt()};i.prototype.redoPlacement=function(n,t,i){var h,o,s,c,l;if(this.status!=="done")return this.redoPlacementAfterDone=!0,this.angle=n,{};for(h=new r(n,t,this.collisionBoxArray),o=this.symbolBuckets,s=o.length-1;s>=0;s--)o[s].placeFeatures(h,i);return c=h.serialize(),l=o.filter(u),{result:{buckets:l.map(f),collisionTile:c.data},transferables:e(l).concat(c.transferables)}}},{"../data/bucket":322,"../data/feature_index":329,"../symbol/collision_box":387,"../symbol/collision_tile":389,"../symbol/symbol_instances":398,"../symbol/symbol_quads":399,"../util/dictionary_coder":425,"../util/util":435}],368:[function(n,t){"use strict";function i(){this.n=0;this.times=[]}t.exports=i;i.prototype.stopped=function(){return this.times=this.times.filter(function(n){return n.time>=(new Date).getTime()}),!this.times.length};i.prototype.set=function(n){return this.times.push({id:this.n,time:n+(new Date).getTime()}),this.n++};i.prototype.cancel=function(n){this.times=this.times.filter(function(t){return t.id!==n})}},{}],369:[function(n,t){"use strict";function i(n){this.base=n;this.retina=f.devicePixelRatio>1;var t=this.retina?"@2x":"";u.getJSON(e(n,t,".json"),function(n,t){if(n){this.fire("error",{error:n});return}this.data=t;this.img&&this.fire("load")}.bind(this));u.getImage(e(n,t,".png"),function(n,t){var r,u,i,f;if(n){this.fire("error",{error:n});return}for(r=t.getData(),u=t.data=new Uint8Array(r.length),i=0;i<r.length;i+=4)f=r[i+3]/255,u[i+0]=r[i+0]*f,u[i+1]=r[i+1]*f,u[i+2]=r[i+2]*f,u[i+3]=r[i+3];this.img=t;this.data&&this.fire("load")}.bind(this))}function r(){}var o=n("../util/evented"),u=n("../util/ajax"),f=n("../util/browser"),e=n("../util/mapbox").normalizeSpriteURL;t.exports=i;i.prototype=Object.create(o);i.prototype.toJSON=function(){return this.base};i.prototype.loaded=function(){return!!(this.data&&this.img)};i.prototype.resize=function(){if(f.devicePixelRatio>1!==this.retina){var n=new i(this.base);n.on("load",function(){this.img=n.img;this.data=n.data;this.retina=n.retina}.bind(this))}};r.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1};i.prototype.getSpritePosition=function(n){if(!this.loaded())return new r;var t=this.data&&this.data[n];return t&&this.img?t:new r}},{"../util/ajax":418,"../util/browser":419,"../util/evented":427,"../util/mapbox":432}],370:[function(n,t){"use strict";var r=n("csscolorparser").parseCSSColor,u=n("../util/util"),f=n("./style_function"),i={};t.exports=function e(n){if(f.isFunctionDefinition(n))return u.extend({},n,{stops:n.stops.map(function(n){return[n[0],e(n[1])]})});if(typeof n=="string"){if(!i[n]){var t=r(n);if(!t)throw new Error("Invalid color "+n);i[n]=[t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]]}return i[n]}throw new Error("Invalid color "+n);}},{"../util/util":435,"./style_function":373,csscolorparser:437}],371:[function(n,t){"use strict";function o(n,t,u){this.animationLoop=t||new b;this.dispatcher=new w(u||1,this);this.spriteAtlas=new l(1024,1024);this.lineAtlas=new a(256,512);this._layers={};this._order=[];this._groups=[];this.sources={};this.zoomHistory={};i.bindAll(["_forwardSourceEvent","_forwardTileEvent","_forwardLayerEvent","_redoPlacement"],this);this._resetUpdates();var f=function(n,t){var i,u;if(n){this.fire("error",{error:n});return}if(!r.emitErrors(this,r(t))){this._loaded=!0;this.stylesheet=t;this.updateClasses();i=t.sources;for(u in i)this.addSource(u,i[u]);if(t.sprite){this.sprite=new h(t.sprite);this.sprite.on("load",this.fire.bind(this,"change"))}this.glyphSource=new c(t.glyphs);this._resolve();this.fire("load")}}.bind(this);typeof n=="string"?v.getJSON(y(n),f):p.frame(f.bind(this,null,n));this.on("source.load",function(n){var t=n.source,r,i;if(t&&t.vectorLayerIds)for(r in this._layers)i=this._layers[r],i.source===t.id&&this._validateLayer(i)})}var s=n("../util/evented"),u=n("./style_layer"),h=n("./image_sprite"),c=n("../symbol/glyph_source"),l=n("../symbol/sprite_atlas"),a=n("../render/line_atlas"),i=n("../util/util"),v=n("../util/ajax"),y=n("../util/mapbox").normalizeStyleURL,p=n("../util/browser"),w=n("../util/dispatcher"),b=n("./animation_loop"),r=n("./validate_style"),f=n("../source/source"),e=n("../source/query_features"),k=n("../source/source_cache"),d=n("./style_spec"),g=n("./style_function");t.exports=o;o.prototype=i.inherit(s,{_loaded:!1,_validateLayer:function(n){var t=this.sources[n.source];n.sourceLayer&&t&&t.vectorLayerIds&&t.vectorLayerIds.indexOf(n.sourceLayer)===-1&&this.fire("error",{error:new Error('Source layer "'+n.sourceLayer+'" does not exist on source "'+t.id+'" as specified by style layer "'+n.id+'"')})},loaded:function(){if(!this._loaded||Object.keys(this._updates.sources).length)return!1;for(var n in this.sources)if(!this.sources[n].loaded())return!1;return this.sprite&&!this.sprite.loaded()?!1:!0},_resolve:function(){var n,t,i,r,f;for(this._layers={},this._order=this.stylesheet.layers.map(function(n){return n.id}),i=0;i<this.stylesheet.layers.length;i++)if(t=this.stylesheet.layers[i],!t.ref){n=u.create(t);this._layers[n.id]=n;n.on("error",this._forwardLayerEvent)}for(r=0;r<this.stylesheet.layers.length;r++)if(t=this.stylesheet.layers[r],t.ref){f=this.getLayer(t.ref);n=u.create(t,f);this._layers[n.id]=n;n.on("error",this._forwardLayerEvent)}this._groupLayers();this._updateWorkerLayers()},_groupLayers:function(){var n,t,i;for(this._groups=[],t=0;t<this._order.length;++t)i=this._layers[this._order[t]],n&&i.source===n.source||(n=[],n.source=i.source,this._groups.push(n)),n.push(i)},_updateWorkerLayers:function(n){this.dispatcher.broadcast(n?"update layers":"set layers",this._serializeLayers(n))},_serializeLayers:function(n){var i,r,t;for(n=n||this._order,i=[],r={includeRefProperties:!0},t=0;t<n.length;t++)i.push(this._layers[n[t]].serialize(r));return i},_applyClasses:function(n,t){var r,f,i,e,u,o;if(this._loaded){n=n||[];t=t||{transition:!0};r=this.stylesheet.transition||{};f=this._updates.allPaintProps?this._layers:this._updates.paintProps;for(i in f)if(e=this._layers[i],u=this._updates.paintProps[i],this._updates.allPaintProps||u.all)e.updatePaintTransitions(n,t,r,this.animationLoop);else for(o in u)this._layers[i].updatePaintTransition(o,n,t,r,this.animationLoop)}},_recalculate:function(n){var i,r,t,u;for(i in this.sources)this.sources[i].used=!1;this._updateZoomHistory(n);this.rasterFadeDuration=300;for(r in this._layers)t=this._layers[r],t.recalculate(n,this.zoomHistory),!t.isHidden(n)&&t.source&&(this.sources[t.source].used=!0);u=300;Math.floor(this.z)!==Math.floor(n)&&this.animationLoop.set(u);this.z=n;this.fire("zoom")},_updateZoomHistory:function(n){var t=this.zoomHistory;t.lastIntegerZoom===undefined&&(t.lastIntegerZoom=Math.floor(n),t.lastIntegerZoomTime=0,t.lastZoom=n);Math.floor(t.lastZoom)<Math.floor(n)?(t.lastIntegerZoom=Math.floor(n),t.lastIntegerZoomTime=Date.now()):Math.floor(t.lastZoom)>Math.floor(n)&&(t.lastIntegerZoom=Math.floor(n+1),t.lastIntegerZoomTime=Date.now());t.lastZoom=n},_checkLoaded:function(){if(!this._loaded)throw new Error("Style is not done loading");},update:function(n,t){var r,u,i,f;if(!this._updates.changed)return this;for(this._updates.allLayers?(this._groupLayers(),this._updateWorkerLayers()):(r=Object.keys(this._updates.layers),r.length&&this._updateWorkerLayers(r)),u=Object.keys(this._updates.sources),i=0;i<u.length;i++)this._reloadSource(u[i]);for(i=0;i<this._updates.events.length;i++)f=this._updates.events[i],this.fire(f[0],f[1]);return this._applyClasses(n,t),this._updates.changed&&this.fire("change"),this._resetUpdates(),this},_resetUpdates:function(){this._updates={events:[],layers:{},sources:{},paintProps:{}}},addSource:function(n,t){if(this._checkLoaded(),this.sources[n]!==undefined)throw new Error("There is already a source with this ID");if(!t.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(t)+".");var i=["vector","raster","geojson","video","image"].indexOf(t.type)>=0;if(i&&this._handleErrors(r.source,"sources."+n,t))return this;t=new k(n,t,this.dispatcher);this.sources[n]=t;t.style=this;t.on("load",this._forwardSourceEvent).on("error",this._forwardSourceEvent).on("change",this._forwardSourceEvent).on("tile.add",this._forwardTileEvent).on("tile.load",this._forwardTileEvent).on("tile.error",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent);return this._updates.events.push(["source.add",{source:t}]),this._updates.changed=!0,this},removeSource:function(n){if(this._checkLoaded(),this.sources[n]===undefined)throw new Error("There is no source with this ID");var t=this.sources[n];return delete this.sources[n],delete this._updates.sources[n],t.off("load",this._forwardSourceEvent).off("error",this._forwardSourceEvent).off("change",this._forwardSourceEvent).off("tile.add",this._forwardTileEvent).off("tile.load",this._forwardTileEvent).off("tile.error",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent),this._updates.events.push(["source.remove",{source:t}]),this._updates.changed=!0,this},getSource:function(n){return this.sources[n]&&this.sources[n].getSource()},addLayer:function(n,t){if(this._checkLoaded(),!(n instanceof u)){if(this._handleErrors(r.layer,"layers."+n.id,n,!1,{arrayIndex:-1}))return this;var i=n.ref&&this.getLayer(n.ref);n=u.create(n,i)}this._validateLayer(n);n.on("error",this._forwardLayerEvent);return this._layers[n.id]=n,this._order.splice(t?this._order.indexOf(t):Infinity,0,n.id),this._updates.allLayers=!0,n.source&&(this._updates.sources[n.source]=!0),this._updates.events.push(["layer.add",{layer:n}]),this.updateClasses(n.id)},removeLayer:function(n){var t,i;if(this._checkLoaded(),t=this._layers[n],t===undefined)throw new Error("There is no layer with this ID");for(i in this._layers)this._layers[i].ref===n&&this.removeLayer(i);return t.off("error",this._forwardLayerEvent),delete this._layers[n],delete this._updates.layers[n],delete this._updates.paintProps[n],this._order.splice(this._order.indexOf(n),1),this._updates.allLayers=!0,this._updates.events.push(["layer.remove",{layer:t}]),this._updates.changed=!0,this},getLayer:function(n){return this._layers[n]},getReferentLayer:function(n){var t=this.getLayer(n);return t.ref&&(t=this.getLayer(t.ref)),t},setLayerZoomRange:function(n,t,i){this._checkLoaded();var r=this.getReferentLayer(n);return r.minzoom===t&&r.maxzoom===i?this:(t!=null&&(r.minzoom=t),i!=null&&(r.maxzoom=i),this._updateLayer(r))},setFilter:function(n,t){this._checkLoaded();var u=this.getReferentLayer(n);return t!==null&&this._handleErrors(r.filter,"layers."+u.id+".filter",t)?this:i.deepEqual(u.filter,t)?this:(u.filter=i.clone(t),this._updateLayer(u))},getFilter:function(n){return this.getReferentLayer(n).filter},setLayoutProperty:function(n,t,r){this._checkLoaded();var u=this.getReferentLayer(n);return i.deepEqual(u.getLayoutProperty(t),r)?this:(u.setLayoutProperty(t,r),this._updateLayer(u))},getLayoutProperty:function(n,t){return this.getReferentLayer(n).getLayoutProperty(t)},setPaintProperty:function(n,t,r,u){var f,e,o;return(this._checkLoaded(),f=this.getLayer(n),i.deepEqual(f.getPaintProperty(t,u),r))?this:(e=f.isPaintValueFeatureConstant(t),f.setPaintProperty(t,r,u),o=!(r&&g.isFunctionDefinition(r)&&r.property!=="$zoom"&&r.property!==undefined),o&&e||(this._updates.layers[n]=!0,f.source&&(this._updates.sources[f.source]=!0)),this.updateClasses(n,t))},getPaintProperty:function(n,t,i){return this.getLayer(n).getPaintProperty(t,i)},updateClasses:function(n,t){if(this._updates.changed=!0,n){var i=this._updates.paintProps;i[n]||(i[n]={});i[n][t||"all"]=!0}else this._updates.allPaintProps=!0;return this},serialize:function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sources,function(n){return n.serialize()}),layers:this._order.map(function(n){return this._layers[n].serialize()},this)},function(n){return n!==undefined})},_updateLayer:function(n){return this._updates.layers[n.id]=!0,n.source&&(this._updates.sources[n.source]=!0),this._updates.changed=!0,this},_flattenRenderedFeatures:function(n){for(var e,t,i,r,f=[],u=this._order.length-1;u>=0;u--)for(e=this._order[u],t=0;t<n.length;t++)if(i=n[t][e],i)for(r=0;r<i.length;r++)f.push(i[r]);return f},queryRenderedFeatures:function(n,t,i,u){var o,f,c,s,h,l,a;if(t&&t.filter&&this._handleErrors(r.filter,"queryRenderedFeatures.filter",t.filter,!0),o={},t&&t.layers)for(f=0;f<t.layers.length;f++)c=t.layers[f],o[this._layers[c].source]=!0;s=[];for(h in this.sources)(!t.layers||o[h])&&(l=this.sources[h],a=e.rendered(l,this._layers,n,t,i,u),s.push(a));return this._flattenRenderedFeatures(s)},querySourceFeatures:function(n,t){t&&t.filter&&this._handleErrors(r.filter,"querySourceFeatures.filter",t.filter,!0);var i=this.sources[n];return i?e.source(i,t):[]},addSourceType:function(n,t,i){if(f.getType(n))return i(new Error('A source type called "'+n+'" already exists.'));if(f.setType(n,t),!t.workerSourceURL)return i(null,null);this.dispatcher.broadcast("load worker source",{name:n,url:t.workerSourceURL},i)},_handleErrors:function(n,t,u,f,e){var o=f?r.throwErrors:r.emitErrors,s=n.call(r,i.extend({key:t,style:this.serialize(),value:u,styleSpec:d},e));return o.call(r,this,s)},_remove:function(){this.dispatcher.remove()},_reloadSource:function(n){this.sources[n].reload()},_updateSources:function(n){for(var t in this.sources)this.sources[t].update(n)},_redoPlacement:function(){for(var n in this.sources)this.sources[n].redoPlacement&&this.sources[n].redoPlacement()},_forwardSourceEvent:function(n){this.fire("source."+n.type,i.extend({source:n.target.getSource()},n))},_forwardTileEvent:function(n){this.fire(n.type,i.extend({source:n.target},n))},_forwardLayerEvent:function(n){this.fire("layer."+n.type,i.extend({layer:{id:n.target.id}},n))},"get sprite json":function(n,t){var i=this.sprite;if(i.loaded())t(null,{sprite:i.data,retina:i.retina});else i.on("load",function(){t(null,{sprite:i.data,retina:i.retina})})},"get icons":function(n,t){var i=this.sprite,r=this.spriteAtlas;if(i.loaded())r.setSprite(i),r.addIcons(n.icons,t);else i.on("load",function(){r.setSprite(i);r.addIcons(n.icons,t)})},"get glyphs":function(n,t){function e(n,i,f){n&&console.error(n);u[f]=i;r--;r===0&&t(null,u)}var i=n.stacks,r=Object.keys(i).length,u={};for(var f in i)this.glyphSource.getSimpleGlyphs(f,i[f],n.uid,e)}})},{"../render/line_atlas":347,"../source/query_features":357,"../source/source":359,"../source/source_cache":360,"../symbol/glyph_source":392,"../symbol/sprite_atlas":397,"../util/ajax":418,"../util/browser":419,"../util/dispatcher":426,"../util/evented":427,"../util/mapbox":432,"../util/util":435,"./animation_loop":368,"./image_sprite":369,"./style_function":373,"./style_layer":374,"./style_spec":381,"./validate_style":383}],372:[function(n,t){"use strict";function f(n,t){var h,f,c,o,s;if(this.value=u.clone(t),this.isFunction=i.isFunctionDefinition(t),this.json=JSON.stringify(this.value),h=n.type==="color"&&this.value?r(this.value):t,this.calculate=i[n.function||"piecewise-constant"](h),this.isFeatureConstant=this.calculate.isFeatureConstant,this.isZoomConstant=this.calculate.isZoomConstant,n.function==="piecewise-constant"&&n.transition&&(this.calculate=e(this.calculate)),!this.isFeatureConstant&&!this.isZoomConstant){for(this.stopZoomLevels=[],f=[],c=this.value.stops,o=0;o<this.value.stops.length;o++)s=c[o][0].zoom,this.stopZoomLevels.indexOf(s)<0&&(this.stopZoomLevels.push(s),f.push([s,f.length]));this.calculateInterpolationT=i.interpolated({stops:f,base:t.base})}}function e(n){return function(t,i){var r=t.zoom,h=t.zoomHistory,l=t.duration,e=r%1,c=Math.min((Date.now()-h.lastIntegerZoomTime)/l,1),o=1,s,u,f;return r>h.lastIntegerZoom?(s=e+(1-e)*c,o*=2,u=n({zoom:r-1},i),f=n({zoom:r},i)):(s=1-(1-c)*e,f=n({zoom:r},i),u=n({zoom:r+1},i),o/=2),u===undefined||f===undefined?undefined:{from:u,fromScale:o,to:f,toScale:1,t:s}}}var i=n("./style_function"),r=n("./parse_color"),u=n("../util/util");t.exports=f},{"../util/util":435,"./parse_color":370,"./style_function":373}],373:[function(n,t,i){"use strict";var r=n("mapbox-gl-function");i.interpolated=function(n){var t=r.interpolated(n),i=function(n,i){return t(n&&n.zoom,i||{})};return i.isFeatureConstant=t.isFeatureConstant,i.isZoomConstant=t.isZoomConstant,i};i["piecewise-constant"]=function(n){var t=r["piecewise-constant"](n),i=function(n,i){return t(n&&n.zoom,i||{})};return i.isFeatureConstant=t.isFeatureConstant,i.isZoomConstant=t.isZoomConstant,i};i.isFunctionDefinition=r.isFunctionDefinition},{"mapbox-gl-function":462}],374:[function(n,t){"use strict";function o(n,t){this.set(n,t)}function s(n){return n.value}var i=n("../util/util"),h=n("./style_transition"),f=n("./style_declaration"),e=n("./style_spec"),r=n("./validate_style"),c=n("./parse_color"),l=n("../util/evented"),u;t.exports=o;u="-transition";o.create=function(t,i){var r={background:n("./style_layer/background_style_layer"),circle:n("./style_layer/circle_style_layer"),fill:n("./style_layer/fill_style_layer"),line:n("./style_layer/line_style_layer"),raster:n("./style_layer/raster_style_layer"),symbol:n("./style_layer/symbol_style_layer")};return new r[(i||t).type](t,i)};o.prototype=i.inherit(l,{set:function(n,t){var i,r,u,f,o;this.id=n.id;this.ref=n.ref;this.metadata=n.metadata;this.type=(t||n).type;this.source=(t||n).source;this.sourceLayer=(t||n)["source-layer"];this.minzoom=(t||n).minzoom;this.maxzoom=(t||n).maxzoom;this.filter=(t||n).filter;this.paint={};this.layout={};this._paintSpecifications=e["paint_"+this.type];this._layoutSpecifications=e["layout_"+this.type];this._paintTransitions={};this._paintTransitionOptions={};this._paintDeclarations={};this._layoutDeclarations={};this._layoutFunctions={};for(u in n)if(f=u.match(/^paint(?:\.(.*))?$/),f){o=f[1]||"";for(i in n[u])this.setPaintProperty(i,n[u][i],o)}if(this.ref)this._layoutDeclarations=t._layoutDeclarations;else for(r in n.layout)this.setLayoutProperty(r,n.layout[r]);for(i in this._paintSpecifications)this.paint[i]=this.getPaintValue(i);for(r in this._layoutSpecifications)this._updateLayoutValue(r)},setLayoutProperty:function(n,t){if(t==null)delete this._layoutDeclarations[n];else{var i="layers."+this.id+".layout."+n;if(this._handleErrors(r.layoutProperty,i,n,t))return;this._layoutDeclarations[n]=new f(this._layoutSpecifications[n],t)}this._updateLayoutValue(n)},getLayoutProperty:function(n){return this._layoutDeclarations[n]&&this._layoutDeclarations[n].value},getLayoutValue:function(n,t,i){var u=this._layoutSpecifications[n],r=this._layoutDeclarations[n];return r?r.calculate(t,i):u.default},setPaintProperty:function(n,t,e){var o="layers."+this.id+(e?'["paint.'+e+'"].':".paint.")+n;if(i.endsWith(n,u))if(this._paintTransitionOptions[e||""]||(this._paintTransitionOptions[e||""]={}),t===null||t===undefined)delete this._paintTransitionOptions[e||""][n];else{if(this._handleErrors(r.paintProperty,o,n,t))return;this._paintTransitionOptions[e||""][n]=t}else if(this._paintDeclarations[e||""]||(this._paintDeclarations[e||""]={}),t===null||t===undefined)delete this._paintDeclarations[e||""][n];else{if(this._handleErrors(r.paintProperty,o,n,t))return;this._paintDeclarations[e||""][n]=new f(this._paintSpecifications[n],t)}},getPaintProperty:function(n,t){return t=t||"",i.endsWith(n,u)?this._paintTransitionOptions[t]&&this._paintTransitionOptions[t][n]:this._paintDeclarations[t]&&this._paintDeclarations[t][n]&&this._paintDeclarations[t][n].value},getPaintValue:function(n,t,i){var r=this._paintSpecifications[n],u=this._paintTransitions[n];return u?u.calculate(t,i):r.type==="color"&&r.default?c(r.default):r.default},getPaintValueStopZoomLevels:function(n){var t=this._paintTransitions[n];return t?t.declaration.stopZoomLevels:[]},getPaintInterpolationT:function(n,t){var i=this._paintTransitions[n];return i.declaration.calculateInterpolationT({zoom:t})},isPaintValueFeatureConstant:function(n){var t=this._paintTransitions[n];return t?t.declaration.isFeatureConstant:!0},isLayoutValueFeatureConstant:function(n){var t=this._layoutDeclarations[n];return t?t.isFeatureConstant:!0},isPaintValueZoomConstant:function(n){var t=this._paintTransitions[n];return t?t.declaration.isZoomConstant:!0},isHidden:function(n){return this.minzoom&&n<this.minzoom?!0:this.maxzoom&&n>=this.maxzoom?!0:this.layout.visibility==="none"?!0:this.paint[this.type+"-opacity"]===0?!0:!1},updatePaintTransitions:function(n,t,r,u){for(var f,e=i.extend({},this._paintDeclarations[""]),o=0;o<n.length;o++)i.extend(e,this._paintDeclarations[n[o]]);for(f in e)this._applyPaintDeclaration(f,e[f],t,r,u);for(f in this._paintTransitions)f in e||this._applyPaintDeclaration(f,null,t,r,u)},updatePaintTransition:function(n,t,i,r,u){for(var f,o=this._paintDeclarations[""][n],e=0;e<t.length;e++)f=this._paintDeclarations[t[e]],f&&f[n]&&(o=f[n]);this._applyPaintDeclaration(n,o,i,r,u)},recalculate:function(n,t){var i,r;for(i in this._paintTransitions)this.paint[i]=this.getPaintValue(i,{zoom:n,zoomHistory:t});for(r in this._layoutFunctions)this.layout[r]=this.getLayoutValue(r,{zoom:n,zoomHistory:t})},serialize:function(n){var r={id:this.id,ref:this.ref,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom},t,u;for(t in this._paintDeclarations)u=t===""?"paint":"paint."+t,r[u]=i.mapObject(this._paintDeclarations[t],s);return(!this.ref||n&&n.includeRefProperties)&&i.extend(r,{type:this.type,source:this.source,"source-layer":this.sourceLayer,filter:this.filter,layout:i.mapObject(this._layoutDeclarations,s)}),i.filterObject(r,function(n,t){return n!==undefined&&!(t==="layout"&&!Object.keys(n).length)})},_applyPaintDeclaration:function(n,t,r,e,o){var s=r.transition?this._paintTransitions[n]:undefined,l=this._paintSpecifications[n],a,c;((t===null||t===undefined)&&(t=new f(l,l.default)),s&&s.declaration.json===t.json)||(a=i.extend({duration:300,delay:0},e,this.getPaintProperty(n+u)),c=this._paintTransitions[n]=new h(l,t,s,a),c.instant()||(c.loopID=o.set(c.endTime-Date.now())),s&&o.cancel(s.loopID))},_updateLayoutValue:function(n){var t=this._layoutDeclarations[n];t&&t.isFunction?this._layoutFunctions[n]=!0:(delete this._layoutFunctions[n],this.layout[n]=this.getLayoutValue(n))},_handleErrors:function(n,t,i,u){return r.emitErrors(this,n.call(r,{key:t,layerType:this.type,objectKey:i,value:u,styleSpec:e,style:{glyphs:!0,sprite:!0}}))}})},{"../util/evented":427,"../util/util":435,"./parse_color":370,"./style_declaration":372,"./style_layer/background_style_layer":375,"./style_layer/circle_style_layer":376,"./style_layer/fill_style_layer":377,"./style_layer/line_style_layer":378,"./style_layer/raster_style_layer":379,"./style_layer/symbol_style_layer":380,"./style_spec":381,"./style_transition":382,"./validate_style":383}],375:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");t.exports=r;r.prototype=u.inherit(i,{})},{"../../util/util":435,"../style_layer":374}],376:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");t.exports=r;r.prototype=u.inherit(i,{})},{"../../util/util":435,"../style_layer":374}],377:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");r.prototype=u.inherit(i,{getPaintValue:function(n,t,r){return n==="fill-outline-color"&&this.getPaintProperty("fill-outline-color")===undefined?i.prototype.getPaintValue.call(this,"fill-color",t,r):i.prototype.getPaintValue.call(this,n,t,r)},getPaintValueStopZoomLevels:function(n){return n==="fill-outline-color"&&this.getPaintProperty("fill-outline-color")===undefined?i.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):i.prototype.getPaintValueStopZoomLevels.call(this,arguments)},getPaintInterpolationT:function(n,t){return n==="fill-outline-color"&&this.getPaintProperty("fill-outline-color")===undefined?i.prototype.getPaintInterpolationT.call(this,"fill-color",t):i.prototype.getPaintInterpolationT.call(this,n,t)},isPaintValueFeatureConstant:function(n){return n==="fill-outline-color"&&this.getPaintProperty("fill-outline-color")===undefined?i.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):i.prototype.isPaintValueFeatureConstant.call(this,n)},isPaintValueZoomConstant:function(n){return n==="fill-outline-color"&&this.getPaintProperty("fill-outline-color")===undefined?i.prototype.isPaintValueZoomConstant.call(this,"fill-color"):i.prototype.isPaintValueZoomConstant.call(this,n)}});t.exports=r},{"../../util/util":435,"../style_layer":374}],378:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");t.exports=r;r.prototype=u.inherit(i,{getPaintValue:function(n,t,r){var u=i.prototype.getPaintValue.apply(this,arguments),f;return u&&n==="line-dasharray"&&(f=Math.floor(t.zoom),this._flooredZoom!==f&&(this._flooredZoom=f,this._flooredLineWidth=this.getPaintValue("line-width",t,r)),u.fromScale*=this._flooredLineWidth,u.toScale*=this._flooredLineWidth),u}})},{"../../util/util":435,"../style_layer":374}],379:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");t.exports=r;r.prototype=u.inherit(i,{})},{"../../util/util":435,"../style_layer":374}],380:[function(n,t){"use strict";function r(){i.apply(this,arguments)}var u=n("../../util/util"),i=n("../style_layer");t.exports=r;r.prototype=u.inherit(i,{isHidden:function(){if(i.prototype.isHidden.apply(this,arguments))return!0;var n=this.paint["text-opacity"]===0||!this.layout["text-field"],t=this.paint["icon-opacity"]===0||!this.layout["icon-image"];return n&&t?!0:!1},getLayoutValue:function(n,t,r){return n!=="text-rotation-alignment"||this.getLayoutValue("symbol-placement",t,r)!=="line"||this.getLayoutProperty("text-rotation-alignment")?n!=="icon-rotation-alignment"||this.getLayoutValue("symbol-placement",t,r)!=="line"||this.getLayoutProperty("icon-rotation-alignment")?n!=="text-pitch-alignment"||this.getLayoutProperty("text-pitch-alignment")?i.prototype.getLayoutValue.apply(this,arguments):this.getLayoutValue("text-rotation-alignment"):"map":"map"}})},{"../../util/util":435,"../style_layer":374}],381:[function(n,t){"use strict";t.exports=n("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":485}],382:[function(n,t){"use strict";function r(n,t,r,e){this.declaration=t;this.startTime=this.endTime=(new Date).getTime();this.interp=n.function==="piecewise-constant"&&n.transition?f:u[n.type];this.oldTransition=r;this.duration=e.duration||0;this.delay=e.delay||0;this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=i.easeCubicInOut);r&&r.endTime<=this.startTime&&delete r.oldTransition}function f(n,t,i){return(n&&n.to)===undefined||(t&&t.to)===undefined?undefined:{from:n.to,fromScale:n.toScale,to:t.to,toScale:t.toScale,t:i}}var i=n("../util/util"),u=n("../util/interpolate");t.exports=r;r.prototype.instant=function(){return!this.oldTransition||!this.interp||this.duration===0&&this.delay===0};r.prototype.calculate=function(n,t){var r=this.declaration.calculate(i.extend({},n,{duration:this.duration}),t),u,f,e;return this.instant()?r:(u=n.time||Date.now(),u<this.endTime&&(f=this.oldTransition.calculate(i.extend({},n,{time:this.startTime}),t),e=this.ease((u-this.startTime-this.delay)/this.duration),r=this.interp(f,r,e)),r)}},{"../util/interpolate":429,"../util/util":435}],383:[function(n,t){"use strict";t.exports=n("mapbox-gl-style-spec/lib/validate_style.min");t.exports.emitErrors=function(n,t){if(t&&t.length){for(var i=0;i<t.length;i++)n.fire("error",{error:new Error(t[i].message)});return!0}return!1};t.exports.throwErrors=function(n,t){if(t)for(var i=0;i<t.length;i++)throw new Error(t[i].message);}},{"mapbox-gl-style-spec/lib/validate_style.min":484}],384:[function(n,t){"use strict";function i(n,t,i,r){this.x=n;this.y=t;this.angle=i;r!==undefined&&(this.segment=r)}var r=n("point-geometry");t.exports=i;i.prototype=Object.create(r.prototype);i.prototype.clone=function(){return new i(this.x,this.y,this.angle,this.segment)}},{"point-geometry":493}],385:[function(n,t){"use strict";function i(n,t,i,r,u){var s,h,o;if(t.segment===undefined)return!0;for(var a=t,f=t.segment+1,e=0;e>-i/2;){if(f--,f<0)return!1;e-=n[f].dist(a);a=n[f]}for(e+=n[f].dist(n[f+1]),f++,s=[],h=0;e<i/2;){var v=n[f-1],c=n[f],l=n[f+1];if(!l)return!1;for(o=v.angleTo(c)-c.angleTo(l),o=Math.abs((o+3*Math.PI)%(Math.PI*2)-Math.PI),s.push({distance:e,angleDelta:o}),h+=o;e-s[0].distance>r;)h-=s.shift().angleDelta;if(h>u)return!1;f++;e+=c.dist(l)}return!0}t.exports=i},{}],386:[function(n,t){"use strict";function r(n,t,r,u,f){for(var c,s,h,e,o,a=[],l=0;l<n.length;l++)for(c=n[l],h=0;h<c.length-1;h++){if(e=c[h],o=c[h+1],e.x<t&&o.x<t)continue;else e.x<t?e=new i(t,e.y+(o.y-e.y)*((t-e.x)/(o.x-e.x)))._round():o.x<t&&(o=new i(t,e.y+(o.y-e.y)*((t-e.x)/(o.x-e.x)))._round());if(e.y<r&&o.y<r)continue;else e.y<r?e=new i(e.x+(o.x-e.x)*((r-e.y)/(o.y-e.y)),r)._round():o.y<r&&(o=new i(e.x+(o.x-e.x)*((r-e.y)/(o.y-e.y)),r)._round());if(e.x>=u&&o.x>=u)continue;else e.x>=u?e=new i(u,e.y+(o.y-e.y)*((u-e.x)/(o.x-e.x)))._round():o.x>=u&&(o=new i(u,e.y+(o.y-e.y)*((u-e.x)/(o.x-e.x)))._round());if(e.y>=f&&o.y>=f)continue;else e.y>=f?e=new i(e.x+(o.x-e.x)*((f-e.y)/(o.y-e.y)),f)._round():o.y>=f&&(o=new i(e.x+(o.x-e.x)*((f-e.y)/(o.y-e.y)),f)._round());s&&e.equals(s[s.length-1])||(s=[e],a.push(s));s.push(o)}return a}var i=n("point-geometry");t.exports=r},{"point-geometry":493}],387:[function(n,t){"use strict";var i=n("../util/struct_array"),r=n("../util/util"),u=n("point-geometry"),f=t.exports=new i({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});r.extendAll(f.prototype.StructType.prototype,{get anchorPoint(){return new u(this.anchorPointX,this.anchorPointY)}})},{"../util/struct_array":433,"../util/util":435,"point-geometry":493}],388:[function(n,t){"use strict";function i(n,t,i,r,u,f,e,o,s,h,c){var y=e.top*o-s,p=e.bottom*o+s,w=e.left*o-s,b=e.right*o+s,l,a,v,k;this.boxStartIndex=n.length;h?(l=p-y,a=b-w,l>0&&(l=Math.max(10*o,l),c?(v=t[i.segment+1].sub(t[i.segment])._unit()._mult(a),k=[i.sub(v),i.add(v)],this._addLineCollisionBoxes(n,k,i,0,a,l,r,u,f)):this._addLineCollisionBoxes(n,t,i,i.segment,a,l,r,u,f))):n.emplaceBack(i.x,i.y,w,y,b,p,Infinity,r,u,f,0,0,0,0,0);this.boxEndIndex=n.length}t.exports=i;i.prototype._addLineCollisionBoxes=function(n,t,i,r,u,f,e,o,s){var y=f/2,g=Math.floor(u/y),w=-f/2,p=this.boxes,b=i,h=r+1,c=w,l,a,v;do{if(h--,h<0)return p;c-=t[h].dist(b);b=t[h]}while(c>-u/2);for(l=t[h].dist(t[h+1]),a=0;a<g;a++){for(v=-u/2+a*y;c+l<v;){if(c+=l,h++,h+1>=t.length)return p;l=t[h].dist(t[h+1])}var nt=v-c,k=t[h],tt=t[h+1],d=tt.sub(k)._unit()._mult(nt)._add(k)._round(),it=Math.max(Math.abs(v-w)-y/2,0),rt=u/2/it;n.emplaceBack(d.x,d.y,-f/2,-f/2,f/2,f/2,rt,e,o,s,0,0,0,0,0)}return p}},{}],389:[function(n,t){"use strict";function i(n,t,i){var e,o,s,r;typeof n=="object"?(e=n,i=t,n=e.angle,t=e.pitch,this.grid=new f(e.grid),this.ignoredGrid=new f(e.ignoredGrid)):(this.grid=new f(u,12,6),this.ignoredGrid=new f(u,12,0));this.angle=n;this.pitch=t;o=Math.sin(n);s=Math.cos(n);this.rotationMatrix=[s,-o,o,s];this.reverseRotationMatrix=[s,o,-o,s];this.yStretch=1/Math.cos(t/180*Math.PI);this.yStretch=Math.pow(this.yStretch,1.3);this.collisionBoxArray=i;i.length===0&&(i.emplaceBack(),r=32767,i.emplaceBack(0,0,0,-r,0,r,r,0,0,0,0,0,0,0,0,0),i.emplaceBack(u,0,0,-r,0,r,r,0,0,0,0,0,0,0,0,0),i.emplaceBack(0,0,-r,0,r,0,r,0,0,0,0,0,0,0,0,0),i.emplaceBack(0,u,-r,0,r,0,r,0,0,0,0,0,0,0,0,0));this.tempCollisionBox=i.get(0);this.edges=[i.get(1),i.get(2),i.get(3),i.get(4)]}var r=n("point-geometry"),u=n("../data/bucket").EXTENT,f=n("grid-index");t.exports=i;i.prototype.serialize=function(){var n={angle:this.angle,pitch:this.pitch,grid:this.grid.toArrayBuffer(),ignoredGrid:this.ignoredGrid.toArrayBuffer()};return{data:n,transferables:[n.grid,n.ignoredGrid]}};i.prototype.minScale=.25;i.prototype.maxScale=2;i.prototype.placeCollisionFeature=function(n,t,i){for(var w,o,b,ot,f,v,k,d=this.collisionBoxArray,e=this.minScale,g=this.rotationMatrix,nt=this.yStretch,y=n.boxStartIndex;y<n.boxEndIndex;y++){var u=d.get(y),p=u.anchorPoint._matMult(g),tt=p.x,it=p.y,rt=tt+u.x1,ut=it+u.y1*nt,ft=tt+u.x2,et=it+u.y2*nt;if(u.bbox0=rt,u.bbox1=ut,u.bbox2=ft,u.bbox3=et,!t)for(w=this.grid.query(rt,ut,ft,et),o=0;o<w.length;o++)if(b=d.get(w[o]),ot=b.anchorPoint._matMult(g),e=this.getPlacementScale(e,p,u,ot,b),e>=this.maxScale)return e;if(i){if(this.angle){var s=this.reverseRotationMatrix,h=new r(u.x1,u.y1).matMult(s),c=new r(u.x2,u.y1).matMult(s),l=new r(u.x1,u.y2).matMult(s),a=new r(u.x2,u.y2).matMult(s);f=this.tempCollisionBox;f.anchorPointX=u.anchorPoint.x;f.anchorPointY=u.anchorPoint.y;f.x1=Math.min(h.x,c.x,l.x,a.x);f.y1=Math.min(h.y,c.x,l.x,a.x);f.x2=Math.max(h.x,c.x,l.x,a.x);f.y2=Math.max(h.y,c.x,l.x,a.x);f.maxScale=u.maxScale}else f=u;for(v=0;v<this.edges.length;v++)if(k=this.edges[v],e=this.getPlacementScale(e,u.anchorPoint,f,k.anchorPoint,k),e>=this.maxScale)return e}}return e};i.prototype.queryRenderedSymbols=function(n,t,i,u,f){var c={},p=[],nt=this.collisionBoxArray,w=this.rotationMatrix,s=new r(n,t)._matMult(w),e=this.tempCollisionBox,a,h,d,g;e.anchorX=s.x;e.anchorY=s.y;e.x1=0;e.y1=0;e.x2=i-n;e.y2=u-t;e.maxScale=f;f=e.maxScale;var o=[s.x+e.x1/f,s.y+e.y1/f*this.yStretch,s.x+e.x2/f,s.y+e.y2/f*this.yStretch],l=this.grid.query(o[0],o[1],o[2],o[3]),b=this.ignoredGrid.query(o[0],o[1],o[2],o[3]);for(a=0;a<b.length;a++)l.push(b[a]);for(h=0;h<l.length;h++){var v=nt.get(l[h]),y=v.sourceLayerIndex,k=v.featureIndex;c[y]===undefined&&(c[y]={});c[y][k]||(d=v.anchorPoint.matMult(w),g=this.getPlacementScale(this.minScale,s,e,d,v),g>=f&&(c[y][k]=!0,p.push(l[h])))}return p};i.prototype.getPlacementScale=function(n,t,i,r,u){var c=t.x-r.x,l=t.y-r.y,e=(u.x1-i.x2)/c,o=(u.x2-i.x1)/c,s=(u.y1-i.y2)*this.yStretch/l,h=(u.y2-i.y1)*this.yStretch/l;(isNaN(e)||isNaN(o))&&(e=o=1);(isNaN(s)||isNaN(h))&&(s=h=1);var f=Math.min(Math.max(e,o),Math.max(s,h)),a=u.maxScale,v=i.maxScale;return f>a&&(f=a),f>v&&(f=v),f>n&&f>=u.placementScale&&(n=f),n};i.prototype.insertCollisionFeature=function(n,t,i){for(var r,f=i?this.ignoredGrid:this.grid,e=this.collisionBoxArray,u=n.boxStartIndex;u<n.boxEndIndex;u++)r=e.get(u),r.placementScale=t,t<this.maxScale&&f.insert(u,r.bbox0,r.bbox1,r.bbox2,r.bbox3)}},{"../data/bucket":322,"grid-index":461,"point-geometry":493}],390:[function(n,t){"use strict";function e(n,t,i,u,f,e,o,s,h){var y=u?3/5*e*o:0,c=Math.max(u?u.right-u.left:0,f?f.right-f.left:0),l=n[0].x===0||n[0].x===h||n[0].y===0||n[0].y===h,a,v;return t-c*o<t/4&&(t=c*o+t/4),a=e*2,v=l?t/2*s%t:(c/2+a)*o*s%t,r(n,v,t,y,i,c*o,l,!1,h)}function r(n,t,e,o,s,h,c,l,a){for(var v,it,rt=h/2,ut=0,p=0;p<n.length-1;p++)ut+=n[p].dist(n[p+1]);var w=0,y=t-e,b=[];for(v=0;v<n.length-1;v++){for(var k=n[v],d=n[v+1],g=k.dist(d),et=d.angleTo(k);y+e<w+g;){y+=e;var ft=(y-w)/g,nt=i(k.x,d.x,ft),tt=i(k.y,d.y,ft);nt>=0&&nt<a&&tt>=0&&tt<a&&y-rt>=0&&y+rt<=ut&&(it=new u(nt,tt,et,v)._round(),(!o||f(n,it,h,o,s))&&b.push(it))}w+=g}return l||b.length||c||(b=r(n,w/2,e,o,s,h,c,!0,a)),b}var i=n("../util/interpolate"),u=n("../symbol/anchor"),f=n("./check_max_angle");t.exports=e},{"../symbol/anchor":384,"../util/interpolate":429,"./check_max_angle":385}],391:[function(n,t){"use strict";function i(){this.width=u;this.height=u;this.bin=new e(this.width,this.height);this.index={};this.ids={};this.data=new Uint8Array(this.width*this.height)}var e=n("shelf-pack"),o=n("../util/util"),r=4,u=128,f=2048;t.exports=i;i.prototype.getGlyphs=function(){var n={},i,t,r;for(var u in this.ids)i=u.split("#"),t=i[0],r=i[1],n[t]||(n[t]=[]),n[t].push(r);return n};i.prototype.getRects=function(){var n={},i,t,r;for(var u in this.ids)i=u.split("#"),t=i[0],r=i[1],n[t]||(n[t]={}),n[t][r]=this.index[u];return n};i.prototype.addGlyph=function(n,t,i,r){var f,u,y,p,e,w,b,s;if(!i)return null;if(f=t+"#"+i.id,this.index[f])return this.ids[f].indexOf(n)<0&&this.ids[f].push(n),this.index[f];if(!i.bitmap)return null;var a=i.width+r*2,v=i.height+r*2,h=1,c=a+2*h,l=v+2*h;if(c+=4-c%4,l+=4-l%4,u=this.bin.packOne(c,l),u||(this.resize(),u=this.bin.packOne(c,l)),!u)return o.warnOnce("glyph bitmap overflow"),null;for(this.index[f]=u,this.ids[f]=[n],y=this.data,p=i.bitmap,e=0;e<v;e++)for(w=this.width*(u.y+e+h)+u.x+h,b=a*e,s=0;s<a;s++)y[w+s]=p[b+s];return this.dirty=!0,u};i.prototype.resize=function(){var i=this.width,t=this.height,u,n,e,o;if(!(i>=f)&&!(t>=f)){for(this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null),this.width*=r,this.height*=r,this.bin.resize(this.width,this.height),u=new ArrayBuffer(this.width*this.height),n=0;n<t;n++)e=new Uint8Array(this.data.buffer,t*n,i),o=new Uint8Array(u,t*n*r,i),o.set(e);this.data=new Uint8Array(u)}};i.prototype.bind=function(n){this.gl=n;this.texture?n.bindTexture(n.TEXTURE_2D,this.texture):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,null))};i.prototype.updateTexture=function(n){this.bind(n);this.dirty&&(n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data),this.dirty=!1)}},{"../util/util":435,"shelf-pack":496}],392:[function(n,t){"use strict";function i(n){this.url=n&&u(n);this.atlases={};this.stacks={};this.loading={}}function r(n,t,i){var r=1;this.advance=n.advance;this.left=n.left-i-r;this.top=n.top+i+r;this.rect=t}function h(n,t,i,r){return r=r||"abc",i.replace("{s}",r[n.length%r.length]).replace("{fontstack}",n).replace("{range}",t)}var u=n("../util/mapbox").normalizeGlyphsURL,f=n("../util/ajax").getArrayBuffer,e=n("../util/glyphs"),o=n("../symbol/glyph_atlas"),s=n("pbf");t.exports=i;i.prototype.getSimpleGlyphs=function(n,t,i,u){var a,s,v,w,b,k;this.stacks[n]===undefined&&(this.stacks[n]={});this.atlases[n]===undefined&&(this.atlases[n]=new o);var h={},y=this.stacks[n],p=this.atlases[n],c=3,f={},l=0,e;for(a=0;a<t.length;a++)s=t[a],e=Math.floor(s/256),y[e]?(v=y[e].glyphs[s],w=p.addGlyph(i,n,v,c),v&&(h[s]=new r(v,w,c))):(f[e]===undefined&&(f[e]=[],l++),f[e].push(s));l||u(undefined,h,n);b=function(t,e,o){var v,s;if(!t)for(v=this.stacks[n][e]=o.stacks[0],s=0;s<f[e].length;s++){var y=f[e][s],a=v.glyphs[y],w=p.addGlyph(i,n,a,c);a&&(h[y]=new r(a,w,c))}l--;l||u(undefined,h,n)}.bind(this);for(k in f)this.loadRange(n,k,b)};i.prototype.loadRange=function(n,t,i){var r,u,o;if(t*256>65535)return i("glyphs > 65535 not supported");this.loading[n]===undefined&&(this.loading[n]={});r=this.loading[n];r[t]?r[t].push(i):(r[t]=[i],u=t*256+"-"+(t*256+255),o=h(n,u,this.url),f(o,function(n,i){for(var f=!n&&new e(new s(new Uint8Array(i))),u=0;u<r[t].length;u++)r[t][u](n,t,f);delete r[t]}))};i.prototype.getGlyphAtlas=function(n){return this.atlases[n]}},{"../symbol/glyph_atlas":391,"../util/ajax":418,"../util/glyphs":428,"../util/mapbox":432,pbf:491}],393:[function(n,t){"use strict";t.exports=function(n,t,i){function b(u){p.push(n[u]);r.push(i[u]);w.push(t[u]);l++}function k(n,t,i){var u=e[n];return delete e[n],e[t]=u,r[u][0].pop(),r[u][0]=r[u][0].concat(i[0]),u}function d(n,t,i){var u=o[t];return delete o[t],o[n]=u,r[u][0].shift(),r[u][0]=i[0].concat(r[u][0]),u}function a(n,t,i){var r=i?t[0][t[0].length-1]:t[0][0];return n+":"+r.x+":"+r.y}for(var o={},e={},p=[],r=[],w=[],l=0,h,c,u,f,v,y,s=0;s<n.length;s++){if(h=i[s],c=t[s],!c){b(s);continue}u=a(c,h);f=a(c,h,!0);u in e&&f in o&&e[u]!==o[f]?(v=d(u,f,h),y=k(u,f,r[v]),delete o[u],delete e[f],e[a(c,r[y],!0)]=y,r[v]=null):u in e?k(u,f,h):f in o?d(u,f,h):(b(s),o[u]=l-1,e[f]=l-1)}return{features:p,textFeatures:w,geometries:r}}},{}],394:[function(n,t){"use strict";function u(n,t,i,r,u,f,e,o,s,h){this.anchorPoint=n;this.tl=t;this.tr=i;this.bl=r;this.br=u;this.tex=f;this.anchorAngle=e;this.glyphAngle=o;this.minScale=s;this.maxScale=h}function e(n,t,f,e,o,s,h,c,l){var ht=t.image.rect,a=o.layout,ct=1,nt=t.left-ct,et=nt+ht.w/t.image.pixelRatio,tt=t.top-ct,ot=tt+ht.h/t.image.pixelRatio,y,p,w,b,v,g,st;if(a["icon-text-fit"]!=="none"&&h){var lt=et-nt,at=ot-tt,it=a["text-size"]/24,k=h.left*it,ii=h.right*it,d=h.top*it,ri=h.bottom*it,vt=ii-k,yt=ri-d,pt=a["icon-text-fit-padding"][0],wt=a["icon-text-fit-padding"][1],bt=a["icon-text-fit-padding"][2],kt=a["icon-text-fit-padding"][3],rt=a["icon-text-fit"]==="width"?(yt-at)*.5:0,ut=a["icon-text-fit"]==="height"?(vt-lt)*.5:0,dt=a["icon-text-fit"]==="width"||a["icon-text-fit"]==="both"?vt:lt,gt=a["icon-text-fit"]==="height"||a["icon-text-fit"]==="both"?yt:at;y=new i(k+ut-kt,d+rt-pt);p=new i(k+ut+wt+dt,d+rt-pt);w=new i(k+ut+wt+dt,d+rt+bt+gt);b=new i(k+ut-kt,d+rt+bt+gt)}else y=new i(nt,tt),p=new i(et,tt),w=new i(et,ot),b=new i(nt,ot);if(v=o.getLayoutValue("icon-rotate",c,l)*Math.PI/180,s&&(g=e[n.segment],n.y===g.y&&n.x===g.x&&n.segment+1<e.length?(st=e[n.segment+1],v+=Math.atan2(n.y-st.y,n.x-st.x)+Math.PI):v+=Math.atan2(n.y-g.y,n.x-g.x)),v){var ni=Math.sin(v),ti=Math.cos(v),ft=[ti,-ni,ni,ti];y=y.matMult(ft);p=p.matMult(ft);b=b.matMult(ft);w=w.matMult(ft)}return[new u(new i(n.x,n.y),y,p,b,w,t.image.rect,0,0,r,Infinity)]}function o(n,t,e,o,s,h){for(var g,c,a,w,k=s.layout["text-rotate"]*Math.PI/180,at=s.layout["text-keep-upright"],et=t.positionedGlyphs,ot=[],d=0;d<et.length;d++){var v=et[d],y=v.glyph,p=y.rect;if(p){g=(v.x+y.advance/2)*e;a=r;h?(c=[],a=f(c,n,g,o,n.segment,!0),at&&(a=Math.min(a,f(c,n,g,o,n.segment,!1)))):c=[{anchorPoint:new i(n.x,n.y),offset:0,angle:0,maxScale:Infinity,minScale:r}];var nt=v.x+y.left,tt=v.y-y.top,st=nt+p.w,ht=tt+p.h,vt=new i(nt,tt),yt=new i(st,tt),pt=new i(nt,ht),wt=new i(st,ht);for(w=0;w<c.length;w++){var l=c[w],it=vt,rt=yt,ut=pt,ft=wt;if(k){var ct=Math.sin(k),lt=Math.cos(k),b=[lt,-ct,ct,lt];it=it.matMult(b);rt=rt.matMult(b);ut=ut.matMult(b);ft=ft.matMult(b)}var bt=Math.max(l.minScale,a),kt=(n.angle+l.offset+2*Math.PI)%(2*Math.PI),dt=(l.angle+l.offset+2*Math.PI)%(2*Math.PI);ot.push(new u(l.anchorPoint,it,rt,ut,ft,p,kt,dt,bt,l.maxScale))}}}return ot}function f(n,t,u,f,e,o){var w=!o,l,p;u<0&&(o=!o);o&&e++;var s=new i(t.x,t.y),h=f[e],a=Infinity;for(u=Math.abs(u),l=r;;){var v=s.dist(h),c=u/v,y=Math.atan2(h.y-s.y,h.x-s.x);if(o||(y+=Math.PI),n.push({anchorPoint:s,offset:w?Math.PI:0,minScale:c,maxScale:a,angle:(y+2*Math.PI)%(2*Math.PI)}),c<=l)break;for(s=h;s.equals(h);)if(e+=o?1:-1,h=f[e],!h)return c;p=h.sub(s)._unit();s=s.sub(p._mult(v));a=c}return l}var i=n("point-geometry"),r;t.exports={getIconQuads:e,getGlyphQuads:o,SymbolQuad:u};r=.5},{"point-geometry":493}],395:[function(n,t){"use strict";function r(n,t,r){for(var u,s,e,o=[],f=0,h=n.length;f<h;f++){if(u=i(n[f].properties,t["text-field"]),!u){o[f]=null;continue}for(u=u.toString(),s=t["text-transform"],s==="uppercase"?u=u.toLocaleUpperCase():s==="lowercase"&&(u=u.toLocaleLowerCase()),e=0;e<u.length;e++)r[u.charCodeAt(e)]=!0;o[f]=u}return o}var i=n("../util/token");t.exports=r},{"../util/token":434}],396:[function(n,t){"use strict";function r(n,t,i,r){this.codePoint=n;this.x=t;this.y=i;this.glyph=r}function u(n,t,i,r,u,f){this.positionedGlyphs=n;this.text=t;this.top=i;this.bottom=r;this.left=u;this.right=f}function f(n,t,i,f,e,o,h,c,l){for(var p,a,v=[],w=new u(v,n,l[1],l[1],l[0],l[0]),b=0,y=0;y<n.length;y++)(p=n.charCodeAt(y),a=t[p],a)&&(v.push(new r(p,b,-17,a)),b+=a.advance+c);return v.length?(s(w,t,f,i,e,o,h,l),w):!1}function s(n,t,r,u,f,s,c,l){var v=null,rt=0,g=0,k=0,y=0,a=n.positionedGlyphs,p,w,d,b,nt,tt,ut,it;if(u)for(p=0;p<a.length;p++){if(w=a[p],w.x-=rt,w.y+=r*k,w.x>u&&v!==null){for(d=a[v+1].x,y=Math.max(d,y),b=v+1;b<=p;b++)a[b].y+=r,a[b].x-=d;c&&(nt=v,e[a[v].codePoint]&&nt--,i(a,t,g,nt,c));g=v+1;v=null;rt+=d;k++}o[w.codePoint]&&(v=p)}tt=a[a.length-1];ut=tt.x+t[tt.codePoint].advance;y=Math.max(y,ut);it=(k+1)*r;i(a,t,g,a.length-1,c);h(a,c,f,s,y,r,k,l);n.top+=-s*it;n.bottom=n.top+it;n.left+=-f*y;n.right=n.left+y}function i(n,t,i,r,u){for(var e=t[n[r].codePoint].advance,o=(n[r].x+e)*u,f=i;f<=r;f++)n[f].x-=o}function h(n,t,i,r,u,f,e,o){for(var h=(t-i)*u+o[0],c=(-r*(e+1)+.5)*f+o[1],s=0;s<n.length;s++)n[s].x+=h,n[s].y+=c}function c(n,t){if(!n||!n.rect)return null;var u=t["icon-offset"][0],f=t["icon-offset"][1],i=u-n.width/2,e=i+n.width,r=f-n.height/2,o=r+n.height;return new l(n,r,o,i,e)}function l(n,t,i,r,u){this.image=n;this.top=t;this.bottom=i;this.left=r;this.right=u}t.exports={shapeText:f,shapeIcon:c};var e={32:!0,8203:!0},o={32:!0,38:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0}},{}],397:[function(n,t){"use strict";function i(n,t){this.width=n;this.height=t;this.bin=new r(n,t);this.images={};this.data=!1;this.texture=0;this.filter=0;this.pixelRatio=1;this.dirty=!0}function e(n,t,i,r,u,f,e,o,s,h,c){var y=r*t+i,v=o*f+e,l,a;if(c)for(v-=f,a=-1;a<=h;a++,y=((a+h)%h+r)*t+i,v+=f)for(l=-1;l<=s;l++)u[v+l]=n[y+(l+s)%s];else for(a=0;a<h;a++,y+=t,v+=f)for(l=0;l<s;l++)u[v+l]=n[y+l]}function o(n,t,i,r,u){this.rect=n;this.width=t;this.height=i;this.sdf=r;this.pixelRatio=u}var r=n("shelf-pack"),u=n("../util/browser"),f=n("../util/util");t.exports=i;i.prototype.allocateImage=function(n,t){n=n/this.pixelRatio;t=t/this.pixelRatio;var i=2,u=n+i+(4-(n+i)%4),e=t+i+(4-(t+i)%4),r=this.bin.packOne(u,e);return r?r:(f.warnOnce("SpriteAtlas out of space."),null)};i.prototype.getImage=function(n,t){var i,r,u;return this.images[n]?this.images[n]:this.sprite?(i=this.sprite.getSpritePosition(n),!i.width||!i.height)?null:(r=this.allocateImage(i.width,i.height),!r)?null:(u=new o(r,i.width/i.pixelRatio,i.height/i.pixelRatio,i.sdf,i.pixelRatio/this.pixelRatio),this.images[n]=u,this.copy(r,i,t),u):null};i.prototype.getPosition=function(n,t){var i=this.getImage(n,t),r=i&&i.rect;if(!r)return null;var f=i.width*i.pixelRatio,e=i.height*i.pixelRatio,u=1;return{size:[i.width,i.height],tl:[(r.x+u)/this.width,(r.y+u)/this.height],br:[(r.x+u+f)/this.width,(r.y+u+e)/this.height]}};i.prototype.allocate=function(){var t,i,n;if(!this.data)for(t=Math.floor(this.width*this.pixelRatio),i=Math.floor(this.height*this.pixelRatio),this.data=new Uint32Array(t*i),n=0;n<this.data.length;n++)this.data[n]=0};i.prototype.copy=function(n,t,i){var u,f,r;this.sprite.img.data&&(u=new Uint32Array(this.sprite.img.data.buffer),this.allocate(),f=this.data,r=1,e(u,this.sprite.img.width,t.x,t.y,f,this.width*this.pixelRatio,(n.x+r)*this.pixelRatio,(n.y+r)*this.pixelRatio,t.width,t.height,i),this.dirty=!0)};i.prototype.setSprite=function(n){n&&(this.pixelRatio=u.devicePixelRatio>1?2:1,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio));this.sprite=n};i.prototype.addIcons=function(n,t){for(var i=0;i<n.length;i++)this.getImage(n[i]);t(null,this.images)};i.prototype.bind=function(n,t){var r=!1,i;this.texture?n.bindTexture(n.TEXTURE_2D,this.texture):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r=!0);i=t?n.LINEAR:n.NEAREST;i!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,i),this.filter=i);this.dirty&&(this.allocate(),r?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,n.RGBA,n.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,n.RGBA,n.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1)}},{"../util/browser":419,"../util/util":435,"shelf-pack":496}],398:[function(n,t){"use strict";var i=n("../util/struct_array"),r=n("../util/util"),u=n("point-geometry"),f=t.exports=new i({members:[{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"glyphQuadStartIndex"},{type:"Uint16",name:"glyphQuadEndIndex"},{type:"Uint16",name:"iconQuadStartIndex"},{type:"Uint16",name:"iconQuadEndIndex"},{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int8",name:"index"}]});r.extendAll(f.prototype.StructType.prototype,{get anchorPoint(){return new u(this.anchorPointX,this.anchorPointY)}})},{"../util/struct_array":433,"../util/util":435,"point-geometry":493}],399:[function(n,t){"use strict";var r=n("../util/struct_array"),u=n("../util/util"),i=n("point-geometry"),f=n("./quads").SymbolQuad,e=t.exports=new r({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"tlX"},{type:"Float32",name:"tlY"},{type:"Float32",name:"trX"},{type:"Float32",name:"trY"},{type:"Float32",name:"blX"},{type:"Float32",name:"blY"},{type:"Float32",name:"brX"},{type:"Float32",name:"brY"},{type:"Int16",name:"texH"},{type:"Int16",name:"texW"},{type:"Int16",name:"texX"},{type:"Int16",name:"texY"},{type:"Float32",name:"anchorAngle"},{type:"Float32",name:"glyphAngle"},{type:"Float32",name:"maxScale"},{type:"Float32",name:"minScale"}]});u.extendAll(e.prototype.StructType.prototype,{get anchorPoint(){return new i(this.anchorPointX,this.anchorPointY)},get SymbolQuad(){return new f(this.anchorPoint,new i(this.tlX,this.tlY),new i(this.trX,this.trY),new i(this.blX,this.blY),new i(this.brX,this.brY),{x:this.texX,y:this.texY,h:this.texH,w:this.texW,height:this.texH,width:this.texW},this.anchorAngle,this.glyphAngle,this.minScale,this.maxScale)}})},{"../util/struct_array":433,"../util/util":435,"./quads":394,"point-geometry":493}],400:[function(n,t){"use strict";var i=n("../util/dom"),u=n("point-geometry"),r={scrollZoom:n("./handler/scroll_zoom"),boxZoom:n("./handler/box_zoom"),dragRotate:n("./handler/drag_rotate"),dragPan:n("./handler/drag_pan"),keyboard:n("./handler/keyboard"),doubleClickZoom:n("./handler/dblclick_zoom"),touchZoomRotate:n("./handler/touch_zoom_rotate")};t.exports=function(n,t){function a(n){e("mouseout",n)}function v(t){n.stop();l=i.mousePos(f,t);e("mousedown",t)}function y(t){var i=n.dragRotate&&n.dragRotate.isActive();s&&!i&&e("contextmenu",s);s=null;e("mouseup",t)}function p(t){if((!n.dragPan||!n.dragPan.isActive())&&(!n.dragRotate||!n.dragRotate.isActive())){for(var i=t.toElement||t.target;i&&i!==f;)i=i.parentNode;i===f&&e("mousemove",t)}}function w(t){(n.stop(),c("touchstart",t),!t.touches||t.touches.length>1)||(o?(clearTimeout(o),o=null,e("dblclick",t)):o=setTimeout(g,300))}function b(n){c("touchmove",n)}function k(n){c("touchend",n)}function d(n){c("touchcancel",n)}function g(){o=null}function nt(n){var t=i.mousePos(f,n);t.equals(l)&&e("click",n)}function tt(n){e("dblclick",n);n.preventDefault()}function it(n){s=n;n.preventDefault()}function e(t,r){var u=i.mousePos(f,r);return n.fire(t,{lngLat:n.unproject(u),point:u,originalEvent:r})}function c(t,r){var e=i.touchPos(f,r),o=e.reduce(function(n,t,i,r){return n.add(t.div(r.length))},new u(0,0));return n.fire(t,{lngLat:n.unproject(o),point:o,lngLats:e.map(function(t){return n.unproject(t)},this),points:e,originalEvent:r})}var f=n.getCanvasContainer(),s=null,l=null,o=null;for(var h in r)n[h]=new r[h](n,t),t.interactive&&t[h]&&n[h].enable();f.addEventListener("mouseout",a,!1);f.addEventListener("mousedown",v,!1);f.addEventListener("mouseup",y,!1);f.addEventListener("mousemove",p,!1);f.addEventListener("touchstart",w,!1);f.addEventListener("touchend",k,!1);f.addEventListener("touchmove",b,!1);f.addEventListener("touchcancel",d,!1);f.addEventListener("click",nt,!1);f.addEventListener("dblclick",tt,!1);f.addEventListener("contextmenu",it,!1)}},{"../util/dom":421,"./handler/box_zoom":406,"./handler/dblclick_zoom":407,"./handler/drag_pan":408,"./handler/drag_rotate":409,"./handler/keyboard":410,"./handler/scroll_zoom":411,"./handler/touch_zoom_rotate":412,"point-geometry":493}],401:[function(n,t){"use strict";var i=n("../util/util"),r=n("../util/interpolate"),e=n("../util/browser"),u=n("../geo/lng_lat"),o=n("../geo/lng_lat_bounds"),f=n("point-geometry"),s=t.exports=function(){};i.extend(s.prototype,{getCenter:function(){return this.transform.center},setCenter:function(n,t){return this.jumpTo({center:n},t),this},panBy:function(n,t,r){return this.panTo(this.transform.center,i.extend({offset:f.convert(n).mult(-1)},t),r),this},panTo:function(n,t,r){return this.easeTo(i.extend({center:n},t),r)},getZoom:function(){return this.transform.zoom},setZoom:function(n,t){return this.jumpTo({zoom:n},t),this},zoomTo:function(n,t,r){return this.easeTo(i.extend({zoom:n},t),r)},zoomIn:function(n,t){return this.zoomTo(this.getZoom()+1,n,t),this},zoomOut:function(n,t){return this.zoomTo(this.getZoom()-1,n,t),this},getBearing:function(){return this.transform.bearing},setBearing:function(n,t){return this.jumpTo({bearing:n},t),this},rotateTo:function(n,t,r){return this.easeTo(i.extend({bearing:n},t),r)},resetNorth:function(n,t){return this.rotateTo(0,i.extend({duration:1e3},n),t),this},snapToNorth:function(n,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,t):this},getPitch:function(){return this.transform.pitch},setPitch:function(n,t){return this.jumpTo({pitch:n},t),this},fitBounds:function(n,t,r){t=i.extend({padding:0,offset:[0,0],maxZoom:Infinity},t);n=o.convert(n);var e=f.convert(t.offset),u=this.transform,s=u.project(n.getNorthWest()),h=u.project(n.getSouthEast()),c=h.sub(s),l=(u.width-t.padding*2-Math.abs(e.x)*2)/c.x,a=(u.height-t.padding*2-Math.abs(e.y)*2)/c.y;return t.center=u.unproject(s.add(h).div(2)),t.zoom=Math.min(u.scaleZoom(u.scale*Math.min(l,a)),t.maxZoom),t.bearing=0,t.linear?this.easeTo(t,r):this.flyTo(t,r)},jumpTo:function(n,t){this.stop();var i=this.transform,r=!1,f=!1,e=!1;return"zoom"in n&&i.zoom!==+n.zoom&&(r=!0,i.zoom=+n.zoom),"center"in n&&(i.center=u.convert(n.center)),"bearing"in n&&i.bearing!==+n.bearing&&(f=!0,i.bearing=+n.bearing),"pitch"in n&&i.pitch!==+n.pitch&&(e=!0,i.pitch=+n.pitch),this.fire("movestart",t).fire("move",t),r&&this.fire("zoomstart",t).fire("zoom",t).fire("zoomend",t),f&&this.fire("rotate",t),e&&this.fire("pitch",t),this.fire("moveend",t)},easeTo:function(n,t){var a;this.stop();n=i.extend({offset:[0,0],duration:500,easing:i.ease},n);var e=this.transform,v=f.convert(n.offset),c=this.getZoom(),h=this.getBearing(),l=this.getPitch(),y="zoom"in n?+n.zoom:c,p="bearing"in n?this._normalizeBearing(n.bearing,h):h,w="pitch"in n?+n.pitch:l,o,s;return"center"in n?(o=u.convert(n.center),s=e.centerPoint.add(v)):"around"in n?(o=u.convert(n.around),s=e.locationPoint(o)):(s=e.centerPoint.add(v),o=e.pointLocation(s)),a=e.locationPoint(o),n.animate===!1&&(n.duration=0),this.zooming=y!==c,this.rotating=h!==p,this.pitching=w!==l,n.noMoveStart||this.fire("movestart",t),this.zooming&&this.fire("zoomstart",t),clearTimeout(this._onEaseEnd),this._ease(function(n){this.zooming&&(e.zoom=r(c,y,n));this.rotating&&(e.bearing=r(h,p,n));this.pitching&&(e.pitch=r(l,w,n));e.setLocationAtPoint(o,a.add(s.sub(a)._mult(n)));this.fire("move",t);this.zooming&&this.fire("zoom",t);this.rotating&&this.fire("rotate",t);this.pitching&&this.fire("pitch",t)},function(){n.delayEndEvents?this._onEaseEnd=setTimeout(this._easeToEnd.bind(this,t),n.delayEndEvents):this._easeToEnd(t)}.bind(this),n),this},_easeToEnd:function(n){var t=this.zooming;this.zooming=!1;this.rotating=!1;this.pitching=!1;t&&this.fire("zoomend",n);this.fire("moveend",n)},flyTo:function(n,t){function et(n){var t=(c*c-s*s+(n?-1:1)*y*y*l*l)/(2*(n?c:s)*y*l);return Math.log(Math.sqrt(t*t+1)-t)}function ot(n){return(Math.exp(n)-Math.exp(-n))/2}function b(n){return(Math.exp(n)+Math.exp(-n))/2}function yt(n){return ot(n)/b(n)}var ut,ft,y,ct,lt;this.stop();n=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},n);var e=this.transform,at=f.convert(n.offset),v=this.getZoom(),p=this.getBearing(),k=this.getPitch(),h="center"in n?u.convert(n.center):this.getCenter(),g="zoom"in n?+n.zoom:v,nt="bearing"in n?this._normalizeBearing(n.bearing,p):p,tt="pitch"in n?+n.pitch:k;Math.abs(e.center.lng)+Math.abs(h.lng)>180&&(e.center.lng>0&&h.lng<0?h.lng+=360:e.center.lng<0&&h.lng>0&&(h.lng-=360));var it=e.zoomScale(g-v),w=e.point,rt="center"in n?e.project(h).sub(at.div(it)):w,vt=e.worldSize,o=n.curve,s=Math.max(e.width,e.height),c=s/it,l=rt.sub(w).mag();"minZoom"in n&&(ut=i.clamp(Math.min(n.minZoom,v,g),e.minZoom,e.maxZoom),ft=s/e.zoomScale(ut-v),o=Math.sqrt(ft/l*2));y=o*o;var a=et(0),st=function(n){return b(a)/b(a+o*n)},ht=function(n){return s*((b(a)*yt(a+o*n)-ot(a))/y)/l},d=(et(1)-a)/o;if(Math.abs(l)<1e-6){if(Math.abs(s-c)<1e-6)return this.easeTo(n);ct=c<s?-1:1;d=Math.abs(Math.log(c/s))/o;ht=function(){return 0};st=function(n){return Math.exp(ct*o*n)}}return"duration"in n?n.duration=+n.duration:(lt="screenSpeed"in n?+n.screenSpeed/o:+n.speed,n.duration=1e3*d/lt),this.zooming=!0,p!==nt&&(this.rotating=!0),k!==tt&&(this.pitching=!0),this.fire("movestart",t),this.fire("zoomstart",t),this._ease(function(n){var i=n*d,u=ht(i);e.zoom=v+e.scaleZoom(1/st(i));e.center=e.unproject(w.add(rt.sub(w).mult(u)),vt);this.rotating&&(e.bearing=r(p,nt,n));this.pitching&&(e.pitch=r(k,tt,n));this.fire("move",t);this.fire("zoom",t);this.rotating&&this.fire("rotate",t);this.pitching&&this.fire("pitch",t)},function(){this.zooming=!1;this.rotating=!1;this.pitching=!1;this.fire("zoomend",t);this.fire("moveend",t)},n),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},_ease:function(n,t,i){this._finishFn=t;this._abortFn=e.timed(function(t){n.call(this,i.easing(t));t===1&&this._finishEase()},i.animate===!1?0:i.duration,this)},_finishEase:function(){delete this._abortFn;var n=this._finishFn;delete this._finishFn;n.call(this)},_normalizeBearing:function(n,t){n=i.wrap(n,-180,180);var r=Math.abs(n-t);return Math.abs(n-360-t)<r&&(n-=360),Math.abs(n+360-t)<r&&(n+=360),n},_updateEasing:function(n,t,r){var u;if(this.ease){var f=this.ease,o=(Date.now()-f.start)/f.duration,s=f.easing(o+.01)-f.easing(o),e=.27/Math.sqrt(s*s+.0001)*.01,h=Math.sqrt(.27*.27-e*e);u=i.bezier(e,h,.25,1)}else u=r?i.bezier.apply(i,r):i.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,t),duration:n,easing:u},u}})},{"../geo/lng_lat":332,"../geo/lng_lat_bounds":333,"../util/browser":419,"../util/interpolate":429,"../util/util":435,"point-geometry":493}],402:[function(n,t){"use strict";function i(n){r.setOptions(this,n)}var u=n("./control"),f=n("../../util/dom"),r=n("../../util/util");t.exports=i;i.createAttributionString=function(n){var t=[],r,i;for(r in n)i=n[r],i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution);return t.sort(function(n,t){return n.length-t.length}),t=t.filter(function(n,i){for(var r=i+1;r<t.length;r++)if(t[r].indexOf(n)>=0)return!1;return!0}),t.join(" | ")};i.prototype=r.inherit(u,{options:{position:"bottom-right"},onAdd:function(n){var t=this._container=f.create("div","mapboxgl-ctrl-attrib",n.getContainer());this._update();n.on("source.load",this._update.bind(this));n.on("source.change",this._update.bind(this));n.on("source.remove",this._update.bind(this));n.on("moveend",this._updateEditLink.bind(this));return t},_update:function(){this._map.style&&(this._container.innerHTML=i.createAttributionString(this._map.style.sources));this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0];this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var n=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+n.lng+"/"+n.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":421,"../../util/util":435,"./control":403}],403:[function(n,t){"use strict";function i(){}var r=n("../../util/util"),u=n("../../util/evented");t.exports=i;i.prototype={addTo:function(n){var t,r,i;return this._map=n,t=this._container=this.onAdd(n),this.options&&this.options.position&&(r=this.options.position,i=n._controlCorners[r],t.className+=" mapboxgl-ctrl",r.indexOf("bottom")!==-1?i.insertBefore(t,i.firstChild):i.appendChild(t)),this},remove:function(){if(this._container.parentNode.removeChild(this._container),this.onRemove)this.onRemove(this._map);return this._map=null,this}};r.extend(i.prototype,u)},{"../../util/evented":427,"../../util/util":435}],404:[function(n,t){"use strict";function f(n){r.setOptions(this,n)}var e=n("./control"),o=n("../../util/browser"),i=n("../../util/dom"),r=n("../../util/util"),u;t.exports=f;u={enableHighAccuracy:!1,timeout:6e3};f.prototype=r.inherit(e,{options:{position:"top-right"},onAdd:function(n){var t="mapboxgl-ctrl",r=this._container=i.create("div",t+"-group",n.getContainer());return o.supportsGeolocation?(this._container.addEventListener("contextmenu",this._onContextMenu.bind(this)),this._geolocateButton=i.create("button",t+"-icon "+t+"-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)),r):r},_onContextMenu:function(n){n.preventDefault()},_onClickGeolocate:function(){navigator.geolocation.getCurrentPosition(this._success.bind(this),this._error.bind(this),u);this._timeoutId=setTimeout(this._finish.bind(this),1e4)},_success:function(n){this._map.jumpTo({center:[n.coords.longitude,n.coords.latitude],zoom:17,bearing:0,pitch:0});this.fire("geolocate",n);this._finish()},_error:function(n){this.fire("error",n);this._finish()},_finish:function(){this._timeoutId&&clearTimeout(this._timeoutId);this._timeoutId=undefined}})},{"../../util/browser":419,"../../util/dom":421,"../../util/util":435,"./control":403}],405:[function(n,t){"use strict";function f(n){u.setOptions(this,n)}function r(n){return new MouseEvent(n.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:n.detail,view:n.view,screenX:n.screenX,screenY:n.screenY,clientX:n.clientX,clientY:n.clientY,movementX:n.movementX,movementY:n.movementY,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,altKey:n.altKey,metaKey:n.metaKey})}var e=n("./control"),i=n("../../util/dom"),u=n("../../util/util");t.exports=f;f.prototype=u.inherit(e,{options:{position:"top-right"},onAdd:function(n){var t="mapboxgl-ctrl",r=this._container=i.create("div",t+"-group",n.getContainer());this._container.addEventListener("contextmenu",this._onContextMenu.bind(this));this._zoomInButton=this._createButton(t+"-icon "+t+"-zoom-in",n.zoomIn.bind(n));this._zoomOutButton=this._createButton(t+"-icon "+t+"-zoom-out",n.zoomOut.bind(n));this._compass=this._createButton(t+"-icon "+t+"-compass",n.resetNorth.bind(n));this._compassArrow=i.create("div","arrow",this._compass);this._compass.addEventListener("mousedown",this._onCompassDown.bind(this));this._onCompassMove=this._onCompassMove.bind(this);this._onCompassUp=this._onCompassUp.bind(this);n.on("rotate",this._rotateCompassArrow.bind(this));return this._rotateCompassArrow(),this._el=n.getCanvasContainer(),r},_onContextMenu:function(n){n.preventDefault()},_onCompassDown:function(n){n.button===0&&(i.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._el.dispatchEvent(r(n)),n.stopPropagation())},_onCompassMove:function(n){n.button===0&&(this._el.dispatchEvent(r(n)),n.stopPropagation())},_onCompassUp:function(n){n.button===0&&(document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),i.enableDrag(),this._el.dispatchEvent(r(n)),n.stopPropagation())},_createButton:function(n,t){var r=i.create("button",n,this._container);return r.type="button",r.addEventListener("click",function(){t()}),r},_rotateCompassArrow:function(){var n="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=n}})},{"../../util/dom":421,"../../util/util":435,"./control":403}],406:[function(n,t){"use strict";function r(n){this._map=n;this._el=n.getCanvasContainer();this._container=n.getContainer();f.bindHandlers(this)}var i=n("../../util/dom"),u=n("../../geo/lng_lat_bounds"),f=n("../../util/util");t.exports=r;r.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onMouseDown,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},_onMouseDown:function(n){n.shiftKey&&n.button===0&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),i.disableDrag(),this._startPos=i.mousePos(this._el,n),this._active=!0)},_onMouseMove:function(n){var t=this._startPos,r=i.mousePos(this._el,n);this._box||(this._box=i.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var u=Math.min(t.x,r.x),e=Math.max(t.x,r.x),f=Math.min(t.y,r.y),o=Math.max(t.y,r.y);i.setTransform(this._box,"translate("+u+"px,"+f+"px)");this._box.style.width=e-u+"px";this._box.style.height=o-f+"px"},_onMouseUp:function(n){if(n.button===0){var t=this._startPos,r=i.mousePos(this._el,n),f=new u(this._map.unproject(t),this._map.unproject(r));this._finish();t.x===r.x&&t.y===r.y?this._fireEvent("boxzoomcancel",n):this._map.fitBounds(f,{linear:!0}).fire("boxzoomend",{originalEvent:n,boxZoomBounds:f})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._fireEvent("boxzoomcancel",n))},_finish:function(){this._active=!1;document.removeEventListener("mousemove",this._onMouseMove,!1);document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("mouseup",this._onMouseUp,!1);this._container.classList.remove("mapboxgl-crosshair");this._box&&(this._box.parentNode.removeChild(this._box),this._box=null);i.enableDrag()},_fireEvent:function(n,t){return this._map.fire(n,{originalEvent:t})}}},{"../../geo/lng_lat_bounds":333,"../../util/dom":421,"../../util/util":435}],407:[function(n,t){"use strict";function i(n){this._map=n;this._onDblClick=this._onDblClick.bind(this)}t.exports=i;i.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){if(!this.isEnabled()){this._map.on("dblclick",this._onDblClick);this._enabled=!0}},disable:function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},_onDblClick:function(n){this._map.zoomTo(this._map.getZoom()+(n.originalEvent.shiftKey?-1:1),{around:n.lngLat},n)}}},{}],408:[function(n,t){"use strict";function e(n){this._map=n;this._el=n.getCanvasContainer();u.bindHandlers(this)}var r=n("../../util/dom"),u=n("../../util/util");t.exports=e;var i=.3,o=u.bezier(0,0,i,1),f=1400,s=2500;e.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},_onDown:function(n){this._ignoreEvent(n)||this.isActive()||(n.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp)),this._active=!1,this._startPos=this._pos=r.mousePos(this._el,n),this._inertia=[[Date.now(),this._pos]])},_onMove:function(n){if(!this._ignoreEvent(n)){this.isActive()||(this._active=!0,this._fireEvent("dragstart",n),this._fireEvent("movestart",n));var t=r.mousePos(this._el,n),i=this._map;i.stop();this._drainInertiaBuffer();this._inertia.push([Date.now(),t]);i.transform.setLocationAtPoint(i.transform.pointLocation(this._pos),t);this._fireEvent("drag",n);this._fireEvent("move",n);this._pos=t;n.preventDefault()}},_onUp:function(n){var e,t,u,r,l,v;if(this.isActive()){if(this._active=!1,this._fireEvent("dragend",n),this._drainInertiaBuffer(),e=function(){this._fireEvent("moveend",n)}.bind(this),t=this._inertia,t.length<2){e();return}var h=t[t.length-1],c=t[0],y=h[1].sub(c[1]),a=(h[0]-c[0])/1e3;if(a===0||h[1].equals(c[1])){e();return}u=y.mult(i/a);r=u.mag();r>f&&(r=f,u._unit()._mult(r));l=r/(s*i);v=u.mult(-l/2);this._map.panBy(v,{duration:l*1e3,easing:o,noMoveStart:!0},{originalEvent:n})}},_onMouseUp:function(n){this._ignoreEvent(n)||(this._onUp(n),document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp))},_onTouchEnd:function(n){this._ignoreEvent(n)||(this._onUp(n),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd))},_fireEvent:function(n,t){return this._map.fire(n,{originalEvent:t})},_ignoreEvent:function(n){var t=this._map,i,r;return t.boxZoom&&t.boxZoom.isActive()?!0:t.dragRotate&&t.dragRotate.isActive()?!0:n.touches?n.touches.length>1:n.ctrlKey?!0:(i=1,r=0,n.type==="mousemove"?n.buttons&i===0:n.button!==r)},_drainInertiaBuffer:function(){for(var n=this._inertia,t=Date.now();n.length>0&&t-n[0][0]>160;)n.shift()}}},{"../../util/dom":421,"../../util/util":435}],409:[function(n,t){"use strict";function e(n,t){this._map=n;this._el=n.getCanvasContainer();this._bearingSnap=t.bearingSnap;u.bindHandlers(this)}var r=n("../../util/dom"),o=n("point-geometry"),u=n("../../util/util");t.exports=e;var i=.25,s=u.bezier(0,0,i,1),f=180,h=720;e.prototype={_enabled:!1,_active:!1,isEnabled:function(){return this._enabled},isActive:function(){return this._active},enable:function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},_onDown:function(n){if(!this._ignoreEvent(n)&&!this.isActive()){document.addEventListener("mousemove",this._onMove);document.addEventListener("mouseup",this._onUp);this._active=!1;this._inertia=[[Date.now(),this._map.getBearing()]];this._startPos=this._pos=r.mousePos(this._el,n);this._center=this._map.transform.centerPoint;var t=this._startPos.sub(this._center),i=t.mag();i<200&&(this._center=this._startPos.add(new o(-200,0)._rotate(t.angle())));n.preventDefault()}},_onMove:function(n){var t;if(!this._ignoreEvent(n)){this.isActive()||(this._active=!0,this._fireEvent("rotatestart",n),this._fireEvent("movestart",n));t=this._map;t.stop();var o=this._pos,u=r.mousePos(this._el,n),f=this._center,s=o.sub(f).angleWith(u.sub(f))/Math.PI*180,e=t.getBearing()-s,i=this._inertia,h=i[i.length-1];this._drainInertiaBuffer();i.push([Date.now(),t._normalizeBearing(e,h[1])]);t.transform.bearing=e;this._fireEvent("rotate",n);this._fireEvent("move",n);this._pos=u}},_onUp:function(n){var e,c,w;if(!this._ignoreEvent(n)&&(document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onUp),this.isActive())){this._active=!1;this._fireEvent("rotateend",n);this._drainInertiaBuffer();var t=this._map,l=t.getBearing(),r=this._inertia,a=function(){Math.abs(l)<this._bearingSnap?t.resetNorth({noMoveStart:!0},{originalEvent:n}):this._fireEvent("moveend",n)}.bind(this);if(r.length<2){a();return}var v=r[0],y=r[r.length-1],b=r[r.length-2],u=t._normalizeBearing(l,b[1]),o=y[1]-v[1],k=o<0?-1:1,p=(y[0]-v[0])/1e3;if(o===0||p===0){a();return}e=Math.abs(o*(i/p));e>f&&(e=f);c=e/(h*i);w=k*e*(c/2);u+=w;Math.abs(t._normalizeBearing(u,0))<this._bearingSnap&&(u=t._normalizeBearing(0,u));t.rotateTo(u,{duration:c*1e3,easing:s,noMoveStart:!0},{originalEvent:n})}},_fireEvent:function(n,t){return this._map.fire(n,{originalEvent:t})},_ignoreEvent:function(n){var t=this._map,i,r;return t.boxZoom&&t.boxZoom.isActive()?!0:t.dragPan&&t.dragPan.isActive()?!0:n.touches?n.touches.length>1:(i=n.ctrlKey?1:2,r=n.ctrlKey?0:2,n.type==="mousemove"?n.buttons&i===0:n.button!==r)},_drainInertiaBuffer:function(){for(var n=this._inertia,t=Date.now();n.length>0&&t-n[0][0]>160;)n.shift()}}},{"../../util/dom":421,"../../util/util":435,"point-geometry":493}],410:[function(n,t){"use strict";function f(n){this._map=n;this._el=n.getCanvasContainer();this._onKeyDown=this._onKeyDown.bind(this)}t.exports=f;var i=80,r=2,u=5;f.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},_onKeyDown:function(n){if(!n.altKey&&!n.ctrlKey&&!n.metaKey){var t=this._map,f={originalEvent:n};if(!t.isEasing())switch(n.keyCode){case 61:case 107:case 171:case 187:t.zoomTo(Math.round(t.getZoom())+(n.shiftKey?2:1),f);break;case 189:case 109:case 173:t.zoomTo(Math.round(t.getZoom())-(n.shiftKey?2:1),f);break;case 37:n.shiftKey?t.easeTo({bearing:t.getBearing()-r},f):(n.preventDefault(),t.panBy([-i,0],f));break;case 39:n.shiftKey?t.easeTo({bearing:t.getBearing()+r},f):(n.preventDefault(),t.panBy([i,0],f));break;case 38:n.shiftKey?t.easeTo({pitch:t.getPitch()+u},f):(n.preventDefault(),t.panBy([0,-i],f));break;case 40:n.shiftKey?t.easeTo({pitch:Math.max(t.getPitch()-u,0)},f):(n.preventDefault(),t.panBy([0,i],f))}}}}},{}],411:[function(n,t){"use strict";function u(n){this._map=n;this._el=n.getCanvasContainer();e.bindHandlers(this)}var f=n("../../util/dom"),r=n("../../util/browser"),e=n("../../util/util");t.exports=u;var i=typeof navigator!="undefined"?navigator.userAgent.toLowerCase():"",o=i.indexOf("firefox")!==-1,s=i.indexOf("safari")!==-1&&i.indexOf("chrom")===-1;u.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},_onWheel:function(n){var t,i,u;n.type==="wheel"?(t=n.deltaY,o&&n.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(t/=r.devicePixelRatio),n.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(t*=40)):n.type==="mousewheel"&&(t=-n.wheelDeltaY,s&&(t=t/3));i=r.now();u=i-(this._time||0);this._pos=f.mousePos(this._el,n);this._time=i;t!==0&&t%4.000244140625==0?(this._type="wheel",t=Math.floor(t/4)):t!==0&&Math.abs(t)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(u*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue));n.shiftKey&&t&&(t=t/4);this._type&&this._zoom(-t,n);n.preventDefault()},_onTimeout:function(){this._type="wheel";this._zoom(-this._lastValue)},_zoom:function(n,t){var i,r,u,f;n!==0&&(i=this._map,r=2/(1+Math.exp(-Math.abs(n/100))),n<0&&r!==0&&(r=1/r),u=i.ease?i.ease.to:i.transform.scale,f=i.transform.scaleZoom(u*r),i.zoomTo(f,{duration:0,around:i.unproject(this._pos),delayEndEvents:200},{originalEvent:t}))}}},{"../../util/browser":419,"../../util/dom":421,"../../util/util":435}],412:[function(n,t){"use strict";function e(n){this._map=n;this._el=n.getCanvasContainer();f.bindHandlers(this)}var i=n("../../util/dom"),f=n("../../util/util");t.exports=e;var r=.15,o=f.bezier(0,0,r,1),s=12,u=2.5,h=.15,c=4;e.prototype={_enabled:!1,isEnabled:function(){return this._enabled},enable:function(){this.isEnabled()||(this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0)},disable:function(){this.isEnabled()&&(this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},disableRotation:function(){this._rotationDisabled=!0},enableRotation:function(){this._rotationDisabled=!1},_onStart:function(n){if(n.touches.length===2){var t=i.mousePos(this._el,n.touches[0]),r=i.mousePos(this._el,n.touches[1]);this._startVec=t.sub(r);this._startScale=this._map.transform.scale;this._startBearing=this._map.transform.bearing;this._gestureIntent=undefined;this._inertia=[];document.addEventListener("touchmove",this._onMove,!1);document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(n){var a,v,r;if(n.touches.length===2){var e=i.mousePos(this._el,n.touches[0]),o=i.mousePos(this._el,n.touches[1]),s=e.add(o).div(2),u=e.sub(o),f=u.mag()/this._startVec.mag(),l=this._rotationDisabled?0:u.angleWith(this._startVec)*180/Math.PI,t=this._map;this._gestureIntent?(r={duration:0,around:t.unproject(s)},this._gestureIntent==="rotate"&&(r.bearing=this._startBearing+l),(this._gestureIntent==="zoom"||this._gestureIntent==="rotate")&&(r.zoom=t.transform.scaleZoom(this._startScale*f)),t.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),f,s]),t.easeTo(r,{originalEvent:n})):(a=Math.abs(1-f)>h,v=Math.abs(l)>c,v?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=u,this._startScale=t.transform.scale,this._startBearing=t.transform.bearing));n.preventDefault()}},_onEnd:function(n){var f,t,i,l,e;if(document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer(),f=this._inertia,t=this._map,f.length<2){t.snapToNorth({},{originalEvent:n});return}var h=f[f.length-1],a=f[0],c=t.transform.scaleZoom(this._startScale*h[1]),v=t.transform.scaleZoom(this._startScale*a[1]),p=c-v,y=(h[0]-a[0])/1e3,w=h[2];if(y===0||c===v){t.snapToNorth({},{originalEvent:n});return}i=p*r/y;Math.abs(i)>u&&(i=i>0?u:-u);l=Math.abs(i/(s*r))*1e3;e=c+i*l/2e3;e<0&&(e=0);t.easeTo({zoom:e,duration:l,easing:o,around:t.unproject(w)},{originalEvent:n})},_drainInertiaBuffer:function(){for(var n=this._inertia,t=Date.now();n.length>2&&t-n[0][0]>160;)n.shift()}}},{"../../util/dom":421,"../../util/util":435}],413:[function(n,t){"use strict";function i(){r.bindAll(["_onHashChange","_updateHash"],this)}t.exports=i;var r=n("../util/util");i.prototype={addTo:function(n){this._map=n;window.addEventListener("hashchange",this._onHashChange,!1);this._map.on("moveend",this._updateHash);return this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var n=location.hash.replace("#","").split("/");return n.length>=3?(this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:+(n[3]||0)}),!0):!1},_updateHash:function(){var n=this._map.getCenter(),t=this._map.getZoom(),i=this._map.getBearing(),r=Math.max(0,Math.ceil(Math.log(t)/Math.LN2)),u="#"+Math.round(t*100)/100+"/"+n.lat.toFixed(r)+"/"+n.lng.toFixed(r)+(i?"/"+Math.round(i*10)/10:"");window.history.replaceState("","",u)}}},{"../util/util":435}],414:[function(n,t){"use strict";function a(n){n.parentNode&&n.parentNode.removeChild(n)}var v=n("../util/canvas"),r=n("../util/util"),f=n("../util/browser"),u=n("../util/browser").window,y=n("../util/evented"),h=n("../util/dom"),c=n("../style/style"),p=n("../style/animation_loop"),w=n("../render/painter"),b=n("../geo/transform"),k=n("./hash"),d=n("./bind_handlers"),g=n("./camera"),nt=n("../geo/lng_lat"),l=n("../geo/lng_lat_bounds"),i=n("point-geometry"),tt=n("./control/attribution"),e=0,o=20,it={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:e,maxZoom:o,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,workerCount:Math.max(f.hardwareConcurrency-1,1)},s=t.exports=function(n){if(n=r.extend({},it,n),n.workerCount<1)throw new Error("workerCount must an integer greater than or equal to 1.");this._interactive=n.interactive;this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat;this._preserveDrawingBuffer=n.preserveDrawingBuffer;this._trackResize=n.trackResize;this._workerCount=n.workerCount;this._bearingSnap=n.bearingSnap;this._container=typeof n.container=="string"?document.getElementById(n.container):n.container;this.animationLoop=new p;this.transform=new b(n.minZoom,n.maxZoom);n.maxBounds&&this.setMaxBounds(n.maxBounds);r.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","_onWindowOnline","_onWindowResize","_update","_render"],this);this._setupContainer();this._setupPainter();this.on("move",this._update.bind(this,!1));this.on("zoom",this._update.bind(this,!0));this.on("moveend",function(){this.animationLoop.set(300);this._rerender()}.bind(this));typeof u!="undefined"&&(u.addEventListener("online",this._onWindowOnline,!1),u.addEventListener("resize",this._onWindowResize,!1));d(this,n);this._hash=n.hash&&(new k).addTo(this);this._hash&&this._hash._onHashChange()||this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch});this.stacks={};this._classes=[];this.resize();n.classes&&this.setClasses(n.classes);n.style&&this.setStyle(n.style);n.attributionControl&&this.addControl(new tt(n.attributionControl));var t=this.fire.bind(this,"error");this.on("style.error",t);this.on("source.error",t);this.on("tile.error",t);this.on("layer.error",t)};r.extend(s.prototype,y);r.extend(s.prototype,g.prototype);r.extend(s.prototype,{addControl:function(n){return n.addTo(this),this},addClass:function(n,t){return this._classes.indexOf(n)>=0||n===""?this:(this._classes.push(n),this._classOptions=t,this.style&&this.style.updateClasses(),this._update(!0))},removeClass:function(n,t){var i=this._classes.indexOf(n);return i<0||n===""?this:(this._classes.splice(i,1),this._classOptions=t,this.style&&this.style.updateClasses(),this._update(!0))},setClasses:function(n,t){for(var r={},i=0;i<n.length;i++)n[i]!==""&&(r[n[i]]=!0);return this._classes=Object.keys(r),this._classOptions=t,this.style&&this.style.updateClasses(),this._update(!0)},hasClass:function(n){return this._classes.indexOf(n)>=0},getClasses:function(){return this._classes},resize:function(){var n=0,t=0;return this._container&&(n=this._container.offsetWidth||400,t=this._container.offsetHeight||300),this._canvas.resize(n,t),this.transform.resize(n,t),this.painter.resize(n,t),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){var n=new l(this.transform.pointLocation(new i(0,0)),this.transform.pointLocation(this.transform.size));return(this.transform.angle||this.transform.pitch)&&(n.extend(this.transform.pointLocation(new i(this.transform.size.x,0))),n.extend(this.transform.pointLocation(new i(0,this.transform.size.y)))),n},setMaxBounds:function(n){if(n){var t=l.convert(n);this.transform.lngRange=[t.getWest(),t.getEast()];this.transform.latRange=[t.getSouth(),t.getNorth()];this.transform._constrain();this._update()}else(n===null||n===undefined)&&(this.transform.lngRange=[],this.transform.latRange=[],this._update());return this},setMinZoom:function(n){if(n=n===null||n===undefined?e:n,n>=e&&n<=this.transform.maxZoom)return this.transform.minZoom=n,this._update(),this.getZoom()<n&&this.setZoom(n),this;throw new Error("minZoom must be between "+e+" and the current maxZoom, inclusive");},setMaxZoom:function(n){if(n=n===null||n===undefined?o:n,n>=this.transform.minZoom&&n<=o)return this.transform.maxZoom=n,this._update(),this.getZoom()>n&&this.setZoom(n),this;throw new Error("maxZoom must be between the current minZoom and "+o+", inclusive");},project:function(n){return this.transform.locationPoint(nt.convert(n))},unproject:function(n){return this.transform.pointLocation(i.convert(n))},queryRenderedFeatures:function(){function r(n){return n instanceof i||Array.isArray(n)}var n={},t;return arguments.length===2?(t=arguments[0],n=arguments[1]):arguments.length===1&&r(arguments[0])?t=arguments[0]:arguments.length===1&&(n=arguments[0]),this.style.queryRenderedFeatures(this._makeQueryGeometry(t),n,this.transform.zoom,this.transform.angle)},_makeQueryGeometry:function(n){var r,u,f,t;return n===undefined&&(n=[i.convert([0,0]),i.convert([this.transform.width,this.transform.height])]),u=n instanceof i||typeof n[0]=="number",u?(f=i.convert(n),r=[f]):(t=[i.convert(n[0]),i.convert(n[1])],r=[t[0],new i(t[1].x,t[0].y),t[1],new i(t[0].x,t[1].y),t[0]]),r.map(function(n){return this.transform.pointCoordinate(n)}.bind(this))},querySourceFeatures:function(n,t){return this.style.querySourceFeatures(n,t)},setStyle:function(n){if(this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("layer.error",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this._update).off("tile.error",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),n)this.style=n instanceof c?n:new c(n,this.animationLoop,this._workerCount);else return this.style=null,this;this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("layer.error",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this._update).on("tile.error",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent);this.on("rotate",this.style._redoPlacement);this.on("pitch",this.style._redoPlacement);return this},getStyle:function(){if(this.style)return this.style.serialize()},addSource:function(n,t){return this.style.addSource(n,t),this._update(!0),this},addSourceType:function(n,t,i){return this.style.addSourceType(n,t,i)},removeSource:function(n){return this.style.removeSource(n),this._update(!0),this},getSource:function(n){return this.style.getSource(n)},addLayer:function(n,t){return this.style.addLayer(n,t),this._update(!0),this},removeLayer:function(n){return this.style.removeLayer(n),this._update(!0),this},getLayer:function(n){return this.style.getLayer(n)},setFilter:function(n,t){return this.style.setFilter(n,t),this._update(!0),this},setLayerZoomRange:function(n,t,i){return this.style.setLayerZoomRange(n,t,i),this._update(!0),this},getFilter:function(n){return this.style.getFilter(n)},setPaintProperty:function(n,t,i,r){return this.style.setPaintProperty(n,t,i,r),this._update(!0),this},getPaintProperty:function(n,t,i){return this.style.getPaintProperty(n,t,i)},setLayoutProperty:function(n,t,i){return this.style.setLayoutProperty(n,t,i),this._update(!0),this},getLayoutProperty:function(n,t){return this.style.getLayoutProperty(n,t)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var n=this._container,t,i,r;n.classList.add("mapboxgl-map");t=this._canvasContainer=h.create("div","mapboxgl-canvas-container",n);this._interactive&&t.classList.add("mapboxgl-interactive");this._canvas=new v(this,t);i=this._controlContainer=h.create("div","mapboxgl-control-container",n);r=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(n){r[n]=h.create("div","mapboxgl-ctrl-"+n,i)})},_setupPainter:function(){var n=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer});if(!n){this.fire("error",{error:new Error("Failed to initialize WebGL")});return}this.painter=new w(n,this.transform)},_contextLost:function(n){n.preventDefault();this._frameId&&f.cancelFrame(this._frameId);this.fire("webglcontextlost",{originalEvent:n})},_contextRestored:function(n){this._setupPainter();this.resize();this._update();this.fire("webglcontextrestored",{originalEvent:n})},loaded:function(){return this._styleDirty||this._sourcesDirty?!1:!this.style||!this.style.loaded()?!1:!0},_update:function(n){return this.style?(this._styleDirty=this._styleDirty||n,this._sourcesDirty=!0,this._rerender(),this):this},_render:function(){try{this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom));this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform));this.painter.render(this.style,{debug:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming});this.fire("render");this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load"));this._frameId=null;this.animationLoop.stopped()||(this._styleDirty=!0);(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender()}catch(n){this.fire("error",{error:n})}return this},remove:function(){this._hash&&this._hash.remove();f.cancelFrame(this._frameId);this.setStyle(null);typeof u!="undefined"&&u.removeEventListener("resize",this._onWindowResize,!1);var n=this.painter.gl.getExtension("WEBGL_lose_context");n&&n.loseContext();a(this._canvasContainer);a(this._controlContainer);this._container.classList.remove("mapboxgl-map")},_rerender:function(){this.style&&!this._frameId&&(this._frameId=f.frame(this._render))},_forwardStyleEvent:function(n){this.fire("style."+n.type,r.extend({style:n.target},n))},_forwardSourceEvent:function(n){this.fire(n.type,r.extend({style:n.target},n))},_forwardLayerEvent:function(n){this.fire(n.type,r.extend({style:n.target},n))},_forwardTileEvent:function(n){this.fire(n.type,r.extend({style:n.target},n))},_onStyleLoad:function(n){this.transform.unmodified&&this.jumpTo(this.style.stylesheet);this.style.update(this._classes,{transition:!1});this._forwardStyleEvent(n)},_onStyleChange:function(n){this._update(!0);this._forwardStyleEvent(n)},_onSourceAdd:function(n){var t=n.source;if(t.onAdd)t.onAdd(this);this._forwardSourceEvent(n)},_onSourceRemove:function(n){var t=n.source;if(t.onRemove)t.onRemove(this);this._forwardSourceEvent(n)},_onSourceUpdate:function(n){this._update();this._forwardSourceEvent(n)},_onWindowOnline:function(){this._update()},_onWindowResize:function(){this._trackResize&&this.stop().resize()._update()}});r.extendAll(s.prototype,{_showTileBoundaries:!1,get showTileBoundaries(){return this._showTileBoundaries},set showTileBoundaries(n){this._showTileBoundaries!==n&&(this._showTileBoundaries=n,this._update())},_showCollisionBoxes:!1,get showCollisionBoxes(){return this._showCollisionBoxes},set showCollisionBoxes(n){this._showCollisionBoxes!==n&&(this._showCollisionBoxes=n,this.style._redoPlacement())},_showOverdrawInspector:!1,get showOverdrawInspector(){return this._showOverdrawInspector},set showOverdrawInspector(n){this._showOverdrawInspector!==n&&(this._showOverdrawInspector=n,this._update())},_repaint:!1,get repaint(){return this._repaint},set repaint(n){this._repaint=n;this._update()},_vertices:!1,get vertices(){return this._vertices},set vertices(n){this._vertices=n;this._update()}})},{"../geo/lng_lat":332,"../geo/lng_lat_bounds":333,"../geo/transform":334,"../render/painter":348,"../style/animation_loop":368,"../style/style":371,"../util/browser":419,"../util/canvas":420,"../util/dom":421,"../util/evented":427,"../util/util":435,"./bind_handlers":400,"./camera":401,"./control/attribution":402,"./hash":413,"point-geometry":493}],415:[function(n,t){"use strict";function r(n,t){n||(n=i.create("div"));n.classList.add("mapboxgl-marker");this._el=n;this._offset=f.convert(t&&t.offset||[0,0]);this._update=this._update.bind(this)}t.exports=r;var i=n("../util/dom"),u=n("../geo/lng_lat"),f=n("point-geometry");r.prototype={addTo:function(n){this.remove();this._map=n;n.getCanvasContainer().appendChild(this._el);n.on("move",this._update);return this._update(),this},remove:function(){this._map&&(this._map.off("move",this._update),this._map=null);var n=this._el.parentNode;return n&&n.removeChild(this._el),this},getLngLat:function(){return this._lngLat},setLngLat:function(n){return this._lngLat=u.convert(n),this._update(),this},getElement:function(){return this._el},_update:function(){if(this._map){var n=this._map.project(this._lngLat)._add(this._offset);i.setTransform(this._el,"translate("+n.x+"px,"+n.y+"px)")}}}},{"../geo/lng_lat":332,"../util/dom":421,"point-geometry":493}],416:[function(n,t){"use strict";function u(n){r.setOptions(this,n);r.bindAll(["_update","_onClickClose"],this)}t.exports=u;var r=n("../util/util"),f=n("../util/evented"),i=n("../util/dom"),e=n("../geo/lng_lat");u.prototype=r.inherit(f,{options:{closeButton:!0,closeOnClick:!0},addTo:function(n){this._map=n;this._map.on("move",this._update);if(this.options.closeOnClick)this._map.on("click",this._onClickClose);return this._update(),this},remove:function(){return this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._container&&(this._container.parentNode.removeChild(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire("close"),this},getLngLat:function(){return this._lngLat},setLngLat:function(n){return this._lngLat=e.convert(n),this._update(),this},setText:function(n){return this.setDOMContent(document.createTextNode(n))},setHTML:function(n){var i=document.createDocumentFragment(),r=document.createElement("body"),t;for(r.innerHTML=n;;){if(t=r.firstChild,!t)break;i.appendChild(t)}return this.setDOMContent(i)},setDOMContent:function(n){return this._createContent(),this._content.appendChild(n),this._update(),this},_createContent:function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content);this._content=i.create("div","mapboxgl-popup-content",this._container);this.options.closeButton&&(this._closeButton=i.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},_update:function(){var t,n,r,u,f,e,o;if(this._map&&this._lngLat&&this._content){this._container||(this._container=i.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=i.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content));t=this._map.project(this._lngLat).round();n=this.options.anchor;n||(r=this._container.offsetWidth,u=this._container.offsetHeight,n=t.y<u?["top"]:t.y>this._map.transform.height-u?["bottom"]:[],t.x<r/2?n.push("left"):t.x>this._map.transform.width-r/2&&n.push("right"),n=n.length===0?"bottom":n.join("-"));f={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};e=this._container.classList;for(o in f)e.remove("mapboxgl-popup-anchor-"+o);e.add("mapboxgl-popup-anchor-"+n);i.setTransform(this._container,f[n]+" translate("+t.x+"px,"+t.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lng_lat":332,"../util/dom":421,"../util/evented":427,"../util/util":435}],417:[function(n,t){"use strict";function i(n,t){this.target=n;this.parent=t;this.callbacks={};this.callbackID=0;this.receive=this.receive.bind(this);this.target.addEventListener("message",this.receive,!1)}t.exports=i;i.prototype.receive=function(n){function u(n,t,i){this.postMessage({type:"<response>",id:String(f),error:n?String(n):null,data:t},i)}var t=n.data,f=t.id,i,r;t.type==="<response>"?(i=this.callbacks[t.id],delete this.callbacks[t.id],i&&i(t.error||null,t.data)):typeof t.id!="undefined"&&this.parent[t.type]?this.parent[t.type](t.data,u.bind(this)):typeof t.id!="undefined"&&this.parent.workerSources?(r=t.type.split("."),this.parent.workerSources[r[0]][r[1]](t.data,u.bind(this))):this.parent[t.type](t.data)};i.prototype.send=function(n,t,i,r){var u=null;i&&(this.callbacks[u=this.callbackID++]=i);this.postMessage({type:n,id:String(u),data:t},r)};i.prototype.postMessage=function(n,t){this.target.postMessage(n,t)}},{}],418:[function(n,t,i){"use strict";function r(n){var t=document.createElement("a");return t.href=n,t.protocol===document.location.protocol&&t.host===document.location.host}i.getJSON=function(n,t){var i=new XMLHttpRequest;return i.open("GET",n,!0),i.setRequestHeader("Accept","application/json"),i.onerror=function(n){t(n)},i.onload=function(){if(i.status>=200&&i.status<300&&i.response){var n;try{n=JSON.parse(i.response)}catch(r){return t(r)}t(null,n)}else t(new Error(i.statusText))},i.send(),i};i.getArrayBuffer=function(n,t){var i=new XMLHttpRequest;return i.open("GET",n,!0),i.responseType="arraybuffer",i.onerror=function(n){t(n)},i.onload=function(){i.status>=200&&i.status<300&&i.response?t(null,i.response):t(new Error(i.statusText))},i.send(),i};i.getImage=function(n,t){return i.getArrayBuffer(n,function(n,i){var r,u;return n?t(n):(r=new Image,r.onload=function(){t(null,r);(window.URL||window.webkitURL).revokeObjectURL(r.src)},u=new Blob([new Uint8Array(i)],{type:"image/png"}),r.src=(window.URL||window.webkitURL).createObjectURL(u),r.getData=function(){var n=document.createElement("canvas"),t=n.getContext("2d");return n.width=r.width,n.height=r.height,t.drawImage(r,0,0),t.getImageData(0,0,r.width,r.height).data},r)})};i.getVideo=function(n,t){var i=document.createElement("video"),u,f;for(i.onloadstart=function(){t(null,i)},u=0;u<n.length;u++)f=document.createElement("source"),r(n[u])||(i.crossOrigin="Anonymous"),f.src=n[u],i.appendChild(f);return i.getData=function(){return i},i}},{}],419:[function(n,t,i){"use strict";var u,f,r;i.window=window;t.exports.now=function(){return window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date)}();u=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;i.frame=function(n){return u(n)};f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;i.cancelFrame=function(n){f(n)};i.timed=function(n,r,u){function o(s){f||(s=t.exports.now(),s>=e+r?n.call(u,1):(n.call(u,(s-e)/r),i.frame(o)))}if(!r)return n.call(u,1),null;var f=!1,e=t.exports.now();return i.frame(o),function(){f=!0}};i.supported=n("mapbox-gl-supported");i.hardwareConcurrency=navigator.hardwareConcurrency||4;Object.defineProperty(i,"devicePixelRatio",{get:function(){return window.devicePixelRatio}});i.supportsWebp=!1;r=document.createElement("img");r.onload=function(){i.supportsWebp=!0};r.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=";i.supportsGeolocation=!!navigator.geolocation},{"mapbox-gl-supported":489}],420:[function(n,t){"use strict";function i(n,t){this.canvas=document.createElement("canvas");n&&t&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",n._contextLost.bind(n),!1),this.canvas.addEventListener("webglcontextrestored",n._contextRestored.bind(n),!1),this.canvas.setAttribute("tabindex",0),t.appendChild(this.canvas))}var r=n("../util"),u=n("mapbox-gl-supported");t.exports=i;i.prototype.resize=function(n,t){var i=window.devicePixelRatio||1;this.canvas.width=i*n;this.canvas.height=i*t;this.canvas.style.width=n+"px";this.canvas.style.height=t+"px"};i.prototype.getWebGLContext=function(n){return n=r.extend({},n,u.webGLContextAttributes),this.canvas.getContext("webgl",n)||this.canvas.getContext("experimental-webgl",n)};i.prototype.getElement=function(){return this.canvas}},{"../util":435,"mapbox-gl-supported":489}],421:[function(n,t,i){"use strict";function o(n){for(var t=0;t<n.length;t++)if(n[t]in u)return n[t]}function f(n){n.preventDefault();n.stopPropagation();window.removeEventListener("click",f,!0)}var e=n("point-geometry"),u,r,s,h;i.create=function(n,t,i){var r=document.createElement(n);return t&&(r.className=t),i&&i.appendChild(r),r};u=document.documentElement.style;r=o(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){r&&(s=u[r],u[r]="none")};i.enableDrag=function(){r&&(u[r]=s)};h=o(["transform","WebkitTransform"]);i.setTransform=function(n,t){n.style[h]=t};i.suppressClick=function(){window.addEventListener("click",f,!0);window.setTimeout(function(){window.removeEventListener("click",f,!0)},0)};i.mousePos=function(n,t){var i=n.getBoundingClientRect();return t=t.touches?t.touches[0]:t,new e(t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop)};i.touchPos=function(n,t){for(var r=n.getBoundingClientRect(),u=[],i=0;i<t.touches.length;i++)u.push(new e(t.touches[i].clientX-r.left-n.clientLeft,t.touches[i].clientY-r.top-n.clientTop));return u}},{"point-geometry":493}],422:[function(n,t){"use strict";var i=n("webworkify");t.exports=function(){return new i(n("../../source/worker"))}},{"../../source/worker":366,webworkify:510}],423:[function(n,t){"use strict";function r(n,t){return t.area-n.area}function u(n){for(var u=0,t=0,f=n.length,e=f-1,i,r;t<f;e=t++)i=n[t],r=n[e],u+=(r.x-i.x)*(i.y+r.y);return u}var i=n("quickselect");t.exports=function(n,t){var l=n.length,f,s,c,o,h,e;if(l<=1)return[n];for(f=[],o=0;o<l;o++)(h=u(n[o]),h!==0)&&(n[o].area=Math.abs(h),c===undefined&&(c=h<0),c===h<0?(s&&f.push(s),s=[n[o]]):s.push(n[o]));if(s&&f.push(s),t>1)for(e=0;e<f.length;e++)f[e].length<=t||(i(f[e],t,1,f[e].length-1,r),f[e]=f[e].slice(0,t));return f}},{quickselect:494}],424:[function(n,t){"use strict";t.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0}},{}],425:[function(n,t){"use strict";function i(n){var t,i;for(this._stringToNumber={},this._numberToString=[],t=0;t<n.length;t++)i=n[t],this._stringToNumber[i]=t,this._numberToString[t]=i}t.exports=i;i.prototype.encode=function(n){return this._stringToNumber[n]};i.prototype.decode=function(n){return this._numberToString[n]}},{}],426:[function(n,t){"use strict";function i(n,t){var i,e,r;for(this.actors=[],this.currentActor=0,i=0;i<n;i++)e=new f,r=new u(e,t),r.name="Worker "+i,this.actors.push(r)}var r=n("./util"),u=n("./actor"),f=n("./web_worker");t.exports=i;i.prototype={broadcast:function(n,t,i){i=i||function(){};r.asyncAll(this.actors,function(i,r){i.send(n,t,r)},i)},send:function(n,t,i,r,u){return(typeof r!="number"||isNaN(r))&&(r=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[r].send(n,t,i,u),r},remove:function(){for(var n=0;n<this.actors.length;n++)this.actors[n].target.terminate();this.actors=[]}}},{"./actor":417,"./util":435,"./web_worker":422}],427:[function(n,t){"use strict";var i=n("./util"),r={on:function(n,t){return this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(t),this},off:function(n,t){if(!n)return delete this._events,this;if(!this.listens(n))return this;if(t){var i=this._events[n].indexOf(t);i>=0&&this._events[n].splice(i,1);this._events[n].length||delete this._events[n]}else delete this._events[n];return this},once:function(n,t){var i=function(r){this.off(n,i);t.call(this,r)}.bind(this);this.on(n,i);return this},fire:function(n,t){var u,r;if(!this.listens(n))return i.endsWith(n,"error")&&console.error(t&&t.error||t||"Empty error event"),this;for(t=i.extend({},t),i.extend(t,{type:n,target:this}),u=this._events[n].slice(),r=0;r<u.length;r++)u[r].call(this,t);return this},listens:function(n){return!!(this._events&&this._events[n])}};t.exports=r},{"./util":435}],428:[function(n,t){"use strict";function i(n,t){this.stacks=n.readFields(r,[],t)}function r(n,t,i){if(n===1){var r=i.readMessage(u,{glyphs:{}});t.push(r)}}function u(n,t,i){if(n===1)t.name=i.readString();else if(n===2)t.range=i.readString();else if(n===3){var r=i.readMessage(f,{});t.glyphs[r.id]=r}}function f(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}t.exports=i},{}],429:[function(n,t){"use strict";function i(n,t,i){return n*(1-i)+t*i}t.exports=i;i.number=i;i.vec2=function(n,t,r){return[i(n[0],t[0],r),i(n[1],t[1],r)]};i.color=function(n,t,r){return[i(n[0],t[0],r),i(n[1],t[1],r),i(n[2],t[2],r),i(n[3],t[3],r)]};i.array=function(n,t,r){return n.map(function(n,u){return i(n,t[u],r)})}},{}],430:[function(n,t){"use strict";function o(n,t,i){for(var s,f,h,o,c,u=0;u<n.length;u++)for(s=n[u],f=0;f<t.length;f++)for(h=t[f],o=0;o<h.length;o++)if((c=h[o],e(s,c))||r(c,s,i))return!0;return!1}function s(n,t){var i,c,r,e,o,s,h;if(n.length===1&&n[0].length===1)return u(t,n[0][0]);for(i=0;i<t.length;i++)for(c=t[i],r=0;r<c.length;r++)if(u(n,c[r]))return!0;for(e=0;e<n.length;e++){for(o=n[e],s=0;s<o.length;s++)if(u(t,o[s]))return!0;for(h=0;h<t.length;h++)if(f(o,t[h]))return!0}return!1}function h(n,t,i){for(var u,f,o,s,r=0;r<t.length;r++)for(u=t[r],f=0;f<n.length;f++){if(o=n[f],o.length>=3)for(s=0;s<u.length;s++)if(e(o,u[s]))return!0;if(c(o,u,i))return!0}return!1}function c(n,t,i){var u,e;if(n.length>1){if(f(n,t))return!0;for(u=0;u<t.length;u++)if(r(t[u],n,i))return!0}for(e=0;e<n.length;e++)if(r(n[e],t,i))return!0;return!1}function f(n,t){for(var u,f,r,e,o,i=0;i<n.length-1;i++)for(u=n[i],f=n[i+1],r=0;r<t.length-1;r++)if(e=t[r],o=t[r+1],l(u,f,e,o))return!0;return!1}function i(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function l(n,t,r,u){return i(n,r,u)!==i(t,r,u)&&i(n,t,r)!==i(n,t,u)}function r(n,t,i){var u=i*i,r,f,e;if(t.length===1)return n.distSqr(t[0])<u;for(r=1;r<t.length;r++)if(f=t[r-1],e=t[r],a(n,f,e)<u)return!0;return!1}function a(n,t,i){var u=t.distSqr(i),r;return u===0?n.distSqr(t):(r=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/u,r<0)?n.distSqr(t):r>1?n.distSqr(i):n.distSqr(i.sub(t)._mult(r)._add(t))}function u(n,t){for(var f,s,e=!1,r,i,u,o=0;o<n.length;o++)for(r=n[o],f=0,s=r.length-1;f<r.length;s=f++)i=r[f],u=r[s],i.y>t.y!=u.y>t.y&&t.x<(u.x-i.x)*(t.y-i.y)/(u.y-i.y)+i.x&&(e=!e);return e}function e(n,t){for(var i,r,u=!1,f=0,e=n.length-1;f<n.length;e=f++)i=n[f],r=n[e],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(u=!u);return u}t.exports={multiPolygonIntersectsBufferedMultiPoint:o,multiPolygonIntersectsMultiPolygon:s,multiPolygonIntersectsBufferedMultiLine:h}},{}],431:[function(n,t){"use strict";function i(n,t){this.max=n;this.onRemove=t;this.reset()}t.exports=i;i.prototype.reset=function(){for(var n in this.data)this.onRemove(this.data[n]);return this.data={},this.order=[],this};i.prototype.add=function(n,t){if(this.has(n))this.order.splice(this.order.indexOf(n),1),this.data[n]=t,this.order.push(n);else if(this.data[n]=t,this.order.push(n),this.order.length>this.max){var i=this.get(this.order[0]);if(i)this.onRemove(i)}return this};i.prototype.has=function(n){return n in this.data};i.prototype.keys=function(){return this.order};i.prototype.get=function(n){if(!this.has(n))return null;var t=this.data[n];return delete this.data[n],this.order.splice(this.order.indexOf(n),1),t};i.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var t=this.get(this.order[0]);if(t)this.onRemove(t)}return this}},{}],432:[function(n,t){"use strict";function u(n,t,i){if(i=i||r.ACCESS_TOKEN,!i&&r.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");if(n=n.replace(/^mapbox:\/\//,r.API_URL+t),n+=n.indexOf("?")!==-1?"&access_token=":"?access_token=",r.REQUIRE_ACCESS_TOKEN){if(i[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");n+=i}return n}function f(n){return n?"?"+n:""}function s(n){return n.access_token&&n.access_token.slice(0,3)==="tk."?o.extend({},n,{access_token:r.ACCESS_TOKEN}):n}var r=n("./config"),e=n("./browser"),i=n("url"),o=n("./util");t.exports.normalizeStyleURL=function(n,t){var r=i.parse(n);return r.protocol!=="mapbox:"?n:u("mapbox:/"+r.pathname+f(r.query),"/styles/v1/",t)};t.exports.normalizeSourceURL=function(n,t){var r=i.parse(n);return r.protocol!=="mapbox:"?n:u(n+".json","/v4/",t)+"&secure"};t.exports.normalizeGlyphsURL=function(n,t){var r=i.parse(n),e;return r.protocol!=="mapbox:"?n:(e=r.pathname.split("/")[1],u("mapbox://"+e+"/{fontstack}/{range}.pbf"+f(r.query),"/fonts/v1/",t))};t.exports.normalizeSpriteURL=function(n,t,r,e){var o=i.parse(n);return o.protocol!=="mapbox:"?(o.pathname+=t+r,i.format(o)):u("mapbox:/"+o.pathname+"/sprite"+t+r+f(o.query),"/styles/v1/",e)};t.exports.normalizeTileURL=function(n,t,r){var u=i.parse(n,!0),f,o,h;return t?(f=i.parse(t),f.protocol!=="mapbox:")?n:(o=e.supportsWebp?".webp":"$1",h=e.devicePixelRatio>=2||r===512?"@2x":"",i.format({protocol:u.protocol,hostname:u.hostname,pathname:u.pathname.replace(/(\.(?:png|jpg)\d*)/,h+o),query:s(u.query)})):n}},{"./browser":419,"./config":424,"./util":435,url:69}],433:[function(n,t){"use strict";function c(n){function t(){h.apply(this,arguments)}function f(){i.apply(this,arguments);this.members=t.prototype.members}var s=JSON.stringify(n);if(u[s])return u[s];n.alignment===undefined&&(n.alignment=1);t.prototype=Object.create(h.prototype);var e=0,c=0,p=["Uint8"];return t.prototype.members=n.members.map(function(i){var f,u;for(i={name:i.name,type:i.type,components:i.components||1},p.indexOf(i.type)<0&&p.push(i.type),f=r(i.type),c=Math.max(c,f),i.offset=e=o(e,Math.max(n.alignment,f)),u=0;u<i.components;u++)Object.defineProperty(t.prototype,i.name+(i.components===1?"":u),{get:v(i,u),set:y(i,u)});return e+=f*i.components,i}),t.prototype.alignment=n.alignment,t.prototype.size=o(e,Math.max(c,n.alignment)),f.serialize=l,f.prototype=Object.create(i.prototype),f.prototype.StructType=t,f.prototype.bytesPerElement=t.prototype.size,f.prototype.emplaceBack=a(t.prototype.members,t.prototype.size),f.prototype._usedTypes=p,u[s]=f,f}function l(){return{members:this.prototype.StructType.prototype.members,alignment:this.prototype.StructType.prototype.alignment,bytesPerElement:this.prototype.bytesPerElement}}function o(n,t){return Math.ceil(n/t)*t}function r(n){return e[n].BYTES_PER_ELEMENT}function f(n){return n.toLowerCase()}function a(n,t){for(var u,i,o,c,a,l=[],s=[],e="var i = this.length;\nthis.resize(this.length + 1);\n",h=0;h<n.length;h++)for(u=n[h],i=r(u.type),l.indexOf(i)<0&&(l.push(i),e+="var o"+i.toFixed(0)+" = i * "+(t/i).toFixed(0)+";\n"),o=0;o<u.components;o++)c="v"+s.length,a="o"+i.toFixed(0)+" + "+(u.offset/i+o).toFixed(0),e+="this."+f(u.type)+"["+a+"] = "+c+";\n",s.push(c);return e+="return i;",new Function(s,e)}function s(n,t){var i="this._pos"+r(n.type).toFixed(0),u=(n.offset/r(n.type)+t).toFixed(0),e=i+" + "+u;return"this._structArray."+f(n.type)+"["+e+"]"}function v(n,t){return new Function([],"return "+s(n,t)+";")}function y(n,t){return new Function(["x"],s(n,t)+" = x;")}function h(n,t){this._structArray=n;this._pos1=t*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8}function i(n){n!==undefined?(this.arrayBuffer=n.arrayBuffer,this.length=n.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):(this.capacity=-1,this.resize(0))}t.exports=c;var e={Int8:Int8Array,Uint8:Uint8Array,Uint8Clamped:Uint8ClampedArray,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array,Float64:Float64Array},u={};i.prototype.DEFAULT_CAPACITY=128;i.prototype.RESIZE_MULTIPLIER=5;i.prototype.serialize=function(){return this.trim(),{length:this.length,arrayBuffer:this.arrayBuffer}};i.prototype.get=function(n){return new this.StructType(this,n)};i.prototype.trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())};i.prototype.resize=function(n){if(this.length=n,n>this.capacity){this.capacity=Math.max(n,Math.floor(this.capacity*this.RESIZE_MULTIPLIER),this.DEFAULT_CAPACITY);this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews();t&&this.uint8.set(t)}};i.prototype._refreshViews=function(){for(var t,n=0;n<this._usedTypes.length;n++)t=this._usedTypes[n],this[f(t)]=new e[t](this.arrayBuffer)};i.prototype.toArray=function(n,t){for(var u,r=[],i=n;i<t;i++)u=this.get(i),r.push(u);return r}},{}],434:[function(n,t){"use strict";function i(n,t){return t.replace(/{([^{}]+)}/g,function(t,i){return i in n?n[i]:""})}t.exports=i},{}],435:[function(n,t,i){"use strict";var e=n("unitbezier"),o=n("../geo/coordinate"),u,r;i.easeCubicInOut=function(n){if(n<=0)return 0;if(n>=1)return 1;var t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)};i.bezier=function(n,t,i,r){var u=new e(n,t,i,r);return function(n){return u.solve(n)}};i.ease=i.bezier(.25,.1,.25,1);i.clamp=function(n,t,i){return Math.min(i,Math.max(t,n))};i.wrap=function(n,t,i){var r=i-t,u=((n-t)%r+r)%r+t;return u===t?i:u};i.coalesce=function(){for(var t,n=0;n<arguments.length;n++)if(t=arguments[n],t!==null&&t!==undefined)return t};i.asyncAll=function(n,t,i){if(!n.length)return i(null,[]);var f=n.length,r=new Array(n.length),u=null;n.forEach(function(n,e){t(n,function(n,t){n&&(u=n);r[e]=t;--f==0&&i(u,r)})})};i.keysDifference=function(n,t){var i=[];for(var r in n)r in t||i.push(r);return i};i.extend=function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)n[r]=i[r]}return n};i.extendAll=function(n,t){for(var i in t)Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i));return n};i.inherit=function(n,t){var u=typeof n=="function"?n.prototype:n,r=Object.create(u);return i.extendAll(r,t),r};i.pick=function(n,t){for(var i,u={},r=0;r<t.length;r++)i=t[r],i in n&&(u[i]=n[i]);return u};u=1;i.uniqueId=function(){return u++};i.debounce=function(n,t){var i,r;return function(){r=arguments;clearTimeout(i);i=setTimeout(function(){n.apply(null,r)},t)}};i.bindAll=function(n,t){n.forEach(function(n){t[n]&&(t[n]=t[n].bind(t))})};i.bindHandlers=function(n){for(var t in n)typeof n[t]=="function"&&t.indexOf("_on")===0&&(n[t]=n[t].bind(n))};i.setOptions=function(n,t){n.hasOwnProperty("options")||(n.options=n.options?Object.create(n.options):{});for(var i in t)n.options[i]=t[i];return n.options};i.getCoordinatesCenter=function(n){for(var i=Infinity,r=Infinity,u=-Infinity,f=-Infinity,t=0;t<n.length;t++)i=Math.min(i,n[t].column),r=Math.min(r,n[t].row),u=Math.max(u,n[t].column),f=Math.max(f,n[t].row);var e=u-i,s=f-r,h=Math.max(e,s);return new o((i+u)/2,(r+f)/2,0).zoomTo(Math.floor(-Math.log(h)/Math.LN2))};i.endsWith=function(n,t){return n.indexOf(t,n.length-t.length)!==-1};i.startsWith=function(n,t){return n.indexOf(t)===0};i.mapObject=function(n,t,i){var u={};for(var r in n)u[r]=t.call(i||this,n[r],r,n);return u};i.filterObject=function(n,t,i){var u={};for(var r in n)t.call(i||this,n[r],r,n)&&(u[r]=n[r]);return u};i.deepEqual=function f(n,t){var i,u,r;if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(i=0;i<n.length;i++)if(!f(n[i],t[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(!(typeof t=="object")||(u=Object.keys(n),u.length!==Object.keys(t).length))return!1;for(r in n)if(!f(n[r],t[r]))return!1;return!0}return n===t};i.clone=function(n){return Array.isArray(n)?n.map(i.clone):typeof n=="object"?i.mapObject(n,i.clone):n};i.arraysIntersect=function(n,t){for(var i=0;i<n.length;i++)if(t.indexOf(n[i])>=0)return!0;return!1};r={};i.warnOnce=function(n){r[n]||(typeof console!="undefined"&&console.warn(n),r[n]=!0)}},{"../geo/coordinate":331,unitbezier:502}],436:[function(n,t){"use strict";function i(n,t,i,r){this._vectorTileFeature=n;n._z=t;n._x=i;n._y=r;this.properties=n.properties;n.id!=null&&(this.id=n.id)}t.exports=i;i.prototype={type:"Feature",get geometry(){return this._geometry===undefined&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},set geometry(n){this._geometry=n},toJSON:function(){var t={};for(var n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&n!=="toJSON"&&(t[n]=this[n]);return t}}},{}],437:[function(n,t,i){function r(n){return n=Math.round(n),n<0?0:n>255?255:n}function s(n){return n<0?0:n>1?1:n}function f(n){return n[n.length-1]==="%"?r(parseFloat(n)/100*255):r(parseInt(n))}function u(n){return n[n.length-1]==="%"?s(parseFloat(n)/100):s(parseFloat(n))}function e(n,t,i){return(i<0?i+=1:i>1&&(i-=1),i*6<1)?n+(t-n)*i*6:i*2<1?t:i*3<2?n+(t-n)*(2/3-i)*6:n}function h(n){var i=n.replace(/ /g,"").toLowerCase(),t,h,v;if(i in o)return o[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16),!(t>=0&&t<=4095))?null:[(t&3840)>>4|(t&3840)>>8,t&240|(t&240)>>4,t&15|(t&15)<<4,1]:i.length===7?(t=parseInt(i.substr(1),16),!(t>=0&&t<=16777215))?null:[(t&16711680)>>16,(t&65280)>>8,t&255,1]:null;if(h=i.indexOf("("),v=i.indexOf(")"),h!==-1&&v+1===i.length){var b=i.substr(0,h),s=i.substr(h+1,v-(h+1)).split(","),l=1;switch(b){case"rgba":if(s.length!==4)return null;l=u(s.pop());case"rgb":return s.length!==3?null:[f(s[0]),f(s[1]),f(s[2]),l];case"hsla":if(s.length!==4)return null;l=u(s.pop());case"hsl":if(s.length!==3)return null;var y=(parseFloat(s[0])%360+360)%360/360,p=u(s[1]),c=u(s[2]),a=c<=.5?c*(p+1):c+p-c*p,w=c*2-a;return[r(e(w,a,y+1/3)*255),r(e(w,a,y)*255),r(e(w,a,y-1/3)*255),l];default:return null}}return null}var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{i.parseCSSColor=h}catch(c){}},{}],438:[function(n,t){"use strict";function h(n,t,i){var r,u,c,l,e,o,w,s;i=i||2;var y=t&&t.length,p=y?t[0]*i:n.length,h=v(n,0,p,i,!0),a=[];if(!h)return a;if(y&&(h=nt(n,t,h,i)),n.length>80*i){for(r=c=n[0],u=l=n[1],s=i;s<p;s+=i)e=n[s],o=n[s+1],e<r&&(r=e),o<u&&(u=o),e>c&&(c=e),o>l&&(l=o);w=Math.max(c-r,l-u)}return f(h,a,i,r,u,w),a}function v(n,t,i,u,f){var e,s;if(f===a(n,t,i,u)>0)for(e=t;e<i;e+=u)s=w(e,n[e],n[e+1],s);else for(e=i-u;e>=t;e-=u)s=w(e,n[e],n[e+1],s);return s&&r(s,s.next)&&(o(s),s=s.next),s}function u(n,t){if(!n)return n;t||(t=n);var u=n,f;do if(f=!1,!u.steiner&&(r(u,u.next)||i(u.prev,u,u.next)===0)){if(o(u),u=t=u.prev,u===u.next)return null;f=!0}else u=u.next;while(f||u!==t);return t}function f(n,t,i,r,e,s,h){if(n){!h&&s&&ut(n,r,e,s);for(var l=n,a,c;n.prev!==n.next;){if(a=n.prev,c=n.next,s?k(n,r,e,s):b(n)){t.push(a.i/i);t.push(n.i/i);t.push(c.i/i);o(n);n=c.next;l=c.next;continue}if(n=c,n===l){h?h===1?(n=d(n,t,i),f(n,t,i,r,e,s,2)):h===2&&g(n,t,i,r,e,s):f(u(n),t,i,r,e,s,1);break}}}}function b(n){var r=n.prev,u=n,f=n.next,t;if(i(r,u,f)>=0)return!1;for(t=n.next.next;t!==n.prev;){if(s(r.x,r.y,u.x,u.y,f.x,f.y,t.x,t.y)&&i(t.prev,t,t.next)>=0)return!1;t=t.next}return!0}function k(n,t,r,u){var o=n.prev,h=n,e=n.next;if(i(o,h,e)>=0)return!1;for(var l=o.x<h.x?o.x<e.x?o.x:e.x:h.x<e.x?h.x:e.x,a=o.y<h.y?o.y<e.y?o.y:e.y:h.y<e.y?h.y:e.y,v=o.x>h.x?o.x>e.x?o.x:e.x:h.x>e.x?h.x:e.x,y=o.y>h.y?o.y>e.y?o.y:e.y:h.y>e.y?h.y:e.y,p=c(l,a,t,r,u),w=c(v,y,t,r,u),f=n.nextZ;f&&f.z<=w;){if(f!==n.prev&&f!==n.next&&s(o.x,o.y,h.x,h.y,e.x,e.y,f.x,f.y)&&i(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=n.prevZ;f&&f.z>=p;){if(f!==n.prev&&f!==n.next&&s(o.x,o.y,h.x,h.y,e.x,e.y,f.x,f.y)&&i(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function d(n,t,i){var u=n,s,f;do s=u.prev,f=u.next.next,!r(s,f)&&y(s,u,u.next,f)&&e(s,f)&&e(f,s)&&(t.push(s.i/i),t.push(u.i/i),t.push(f.i/i),o(u),o(u.next),u=n=f),u=u.next;while(u!==n);return u}function g(n,t,i,r,e,o){var s=n,h,c;do{for(h=s.next.next;h!==s.prev;){if(s.i!==h.i&&ot(s,h)){c=p(s,h);s=u(s,s.next);c=u(c,c.next);f(s,t,i,r,e,o);f(c,t,i,r,e,o);return}h=h.next}s=s.next}while(s!==n)}function nt(n,t,i,r){for(var o=[],h,c,e,f=0,s=t.length;f<s;f++)h=t[f]*r,c=f<s-1?t[f+1]*r:n.length,e=v(n,h,c,r,!1),e===e.next&&(e.steiner=!0),o.push(et(e));for(o.sort(tt),f=0;f<o.length;f++)it(o[f],i),i=u(i,i.next);return i}function tt(n,t){return n.x-t.x}function it(n,t){if(t=rt(n,t),t){var i=p(t,n);u(i,i.next)}}function rt(n,t){var i=t,f=n.x,r=n.y,o=-Infinity,u,h;do{if(r<=i.y&&r>=i.next.y&&(h=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y),h<=f&&h>o)){if(o=h,h===f){if(r===i.y)return i;if(r===i.next.y)return i.next}u=i.x<i.next.x?i:i.next}i=i.next}while(i!==t);if(!u)return null;if(f===o)return u.prev;var y=u,v=u.x,l=u.y,a=Infinity,c;for(i=u.next;i!==y;)f>=i.x&&i.x>=v&&s(r<l?f:o,r,v,l,r<l?o:f,r,i.x,i.y)&&(c=Math.abs(r-i.y)/(f-i.x),(c<a||c===a&&i.x>u.x)&&e(i,n)&&(u=i,a=c)),i=i.next;return u}function ut(n,t,i,r){var u=n;do u.z===null&&(u.z=c(u.x,u.y,t,i,r)),u.prevZ=u.prev,u.nextZ=u.next,u=u.next;while(u!==n);u.prevZ.nextZ=null;u.prevZ=null;ft(u)}function ft(n){var o,i,t,r,u,s,f,e,h=1;do{for(i=n,n=null,u=null,s=0;i;){for(s++,t=i,f=0,o=0;o<h;o++)if(f++,t=t.nextZ,!t)break;for(e=h;f>0||e>0&&t;)f===0?(r=t,t=t.nextZ,e--):e!==0&&t?i.z<=t.z?(r=i,i=i.nextZ,f--):(r=t,t=t.nextZ,e--):(r=i,i=i.nextZ,f--),u?u.nextZ=r:n=r,r.prevZ=u,u=r;i=t}u.nextZ=null;h*=2}while(s>1);return n}function c(n,t,i,r,u){return n=32767*(n-i)/u,t=32767*(t-r)/u,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function et(n){var t=n,i=n;do t.x<i.x&&(i=t),t=t.next;while(t!==n);return i}function s(n,t,i,r,u,f,e,o){return(u-e)*(t-o)-(n-e)*(f-o)>=0&&(n-e)*(r-o)-(i-e)*(t-o)>=0&&(i-e)*(f-o)-(u-e)*(r-o)>=0}function ot(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!st(n,t)&&e(n,t)&&e(t,n)&&ht(n,t)}function i(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function r(n,t){return n.x===t.x&&n.y===t.y}function y(n,t,u,f){return r(n,t)&&r(u,f)||r(n,f)&&r(u,t)?!0:i(n,t,u)>0!=i(n,t,f)>0&&i(u,f,n)>0!=i(u,f,t)>0}function st(n,t){var i=n;do{if(i.i!==n.i&&i.next.i!==n.i&&i.i!==t.i&&i.next.i!==t.i&&y(i,i.next,n,t))return!0;i=i.next}while(i!==n);return!1}function e(n,t){return i(n.prev,n,n.next)<0?i(n,t,n.next)>=0&&i(n,n.prev,t)>=0:i(n,t,n.prev)<0||i(n,n.next,t)<0}function ht(n,t){var i=n,r=!1,f=(n.x+t.x)/2,u=(n.y+t.y)/2;do i.y>u!=i.next.y>u&&f<(i.next.x-i.x)*(u-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==n);return r}function p(n,t){var r=new l(n.i,n.x,n.y),i=new l(t.i,t.x,t.y),u=n.next,f=t.prev;return n.next=t,t.prev=n,r.next=u,u.prev=r,i.next=r,r.prev=i,f.next=i,i.prev=f,i}function w(n,t,i,r){var u=new l(n,t,i);return r?(u.next=r.next,u.prev=r,r.next.prev=u,r.next=u):(u.prev=u,u.next=u),u}function o(n){n.next.prev=n.prev;n.prev.next=n.next;n.prevZ&&(n.prevZ.nextZ=n.nextZ);n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function l(n,t,i){this.i=n;this.x=t;this.y=i;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=!1}function a(n,t,i,r){for(var e=0,u=t,f=i-r;u<i;u+=r)e+=(n[f]-n[u])*(n[u+1]+n[f+1]),f=u;return e}t.exports=h;h.deviation=function(n,t,i,r){var h=t&&t.length,p=h?t[0]*i:n.length,f=Math.abs(a(n,0,p,i)),u,s,c,l,e;if(h)for(u=0,s=t.length;u<s;u++)c=t[u]*i,l=u<s-1?t[u+1]*i:n.length,f-=Math.abs(a(n,c,l,i));for(e=0,u=0;u<r.length;u+=3){var o=r[u]*i,v=r[u+1]*i,y=r[u+2]*i;e+=Math.abs((n[o]-n[y])*(n[v+1]-n[o+1])-(n[o]-n[v])*(n[y+1]-n[o+1]))}return f===0&&e===0?0:Math.abs((e-f)/f)};h.flatten=function(n){for(var i,r,f=n[0][0].length,u={vertices:[],holes:[],dimensions:f},e=0,t=0;t<n.length;t++){for(i=0;i<n[t].length;i++)for(r=0;r<f;r++)u.vertices.push(n[t][i][r]);t>0&&(e+=n[t-1].length,u.holes.push(e))}return u}},{}],439:[function(n,t){"use strict";function c(n){return new Function("f","var p = (f && f.properties || {}); return "+e(n))}function e(n){var t,f;return n?(t=n[0],n.length<=1)?t==="any"?"false":"true":(f=t==="=="?i(n[1],n[2],"===",!1):t==="!="?i(n[1],n[2],"!==",!1):t==="<"||t===">"||t==="<="||t===">="?i(n[1],n[2],t,!0):t==="any"?r(n.slice(1),"||"):t==="all"?r(n.slice(1),"&&"):t==="none"?u(r(n.slice(1),"||")):t==="in"?s(n[1],n.slice(2)):t==="!in"?u(s(n[1],n.slice(2))):t==="has"?h(n[1]):t==="!has"?u(h([n[1]])):"true","("+f+")"):"true"}function o(n){return n==="$type"?"f.type":n==="$id"?"f.id":"p["+JSON.stringify(n)+"]"}function i(n,t,i,r){var u=o(n),e=n==="$type"?f.indexOf(t):JSON.stringify(t);return(r?"typeof "+u+"=== typeof "+e+"&&":"")+u+i+e}function r(n,t){return n.map(e).join(t)}function s(n,t){n==="$type"&&(t=t.map(function(n){return f.indexOf(n)}));var i=JSON.stringify(t.sort(l)),r=o(n);return t.length<=200?i+".indexOf("+r+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+r+", "+i+",0,"+(t.length-1)+")"}function h(n){return JSON.stringify(n)+" in p"}function u(n){return"!("+n+")"}function l(n,t){return n<t?-1:n>t?1:0}t.exports=c;var f=["Unknown","Point","LineString","Polygon"]},{}],440:[function(n,t){function i(n,t){switch(n&&n.type||null){case"FeatureCollection":return n.features=n.features.map(r(i,t)),n;case"Feature":return n.geometry=i(n.geometry,t),n;case"Polygon":case"MultiPolygon":return o(n,t);default:return n}}function r(n,t){return function(i){return n(i,t)}}function o(n,t){return n.type==="Polygon"?n.coordinates=u(n.coordinates,t):n.type==="MultiPolygon"&&(n.coordinates=n.coordinates.map(r(u,t))),n}function u(n,t){t=!!t;n[0]=f(n[0],!t);for(var i=1;i<n.length;i++)n[i]=f(n[i],t);return n}function f(n,t){return s(n)===t?n:n.reverse()}function s(n){return e.ring(n)>=0}var e=n("geojson-area");t.exports=i},{"geojson-area":441}],441:[function(n,t){function e(n){var i,t;if(n.type==="Polygon")return f(n.coordinates);if(n.type==="MultiPolygon"){for(i=0,t=0;t<n.coordinates.length;t++)i+=f(n.coordinates[t]);return i}return null}function f(n){var r=0,t;if(n&&n.length>0)for(r+=Math.abs(i(n[0])),t=1;t<n.length;t++)r-=Math.abs(i(n[t]));return r}function i(n){var i=0,f,e,t;if(n.length>2){for(t=0;t<n.length-1;t++)f=n[t],e=n[t+1],i+=r(e[0]-f[0])*(2+Math.sin(r(f[1]))+Math.sin(r(e[1])));i=i*u.RADIUS*u.RADIUS/2}return i}function r(n){return n*Math.PI/180}var u=n("wgs84");t.exports.geometry=e;t.exports.ring=i},{wgs84:442}],442:[function(n,t){t.exports.RADIUS=6378137;t.exports.FLATTENING=1/298.257223563;t.exports.POLAR_RADIUS=6356752.3142},{}],443:[function(n,t){"use strict";function u(n,t,i,u,o,s,h,c){var a,v,b;if(i/=t,u/=t,h>=i&&c<=u)return n;if(h>u||c<i)return null;for(a=[],v=0;v<n.length;v++){var l=n[v],k=l.geometry,y=l.type,p,w;if(p=l.min[o],w=l.max[o],p>=i&&w<=u){a.push(l);continue}else if(p>u||w<i)continue;b=y===1?f(k,i,u,o):e(k,i,u,o,s,y===3);b.length&&a.push(r(l.tags,y,b,l.id))}return a.length?a:null}function f(n,t,i,r){for(var f,e,o=[],u=0;u<n.length;u++)f=n[u],e=f[r],e>=t&&e<=i&&o.push(f);return o}function e(n,t,r,u,f,e){for(var a=[],d=0;d<n.length;d++){for(var v=0,c=0,h=null,l=n[d],y=l.area,p=l.dist,w=l.outer,g=l.length,s,k,o=[],b=0;b<g-1;b++)s=h||l[b],h=l[b+1],v=c||s[u],c=h[u],v<t?c>r?(o.push(f(s,h,t),f(s,h,r)),e||(o=i(a,o,y,p,w))):c>=t&&o.push(f(s,h,t)):v>r?c<t?(o.push(f(s,h,r),f(s,h,t)),e||(o=i(a,o,y,p,w))):c<=r&&o.push(f(s,h,r)):(o.push(s),c<t?(o.push(f(s,h,t)),e||(o=i(a,o,y,p,w))):c>r&&(o.push(f(s,h,r)),e||(o=i(a,o,y,p,w))));s=l[g-1];v=s[u];v>=t&&v<=r&&o.push(s);k=o[o.length-1];e&&k&&(o[0][0]!==k[0]||o[0][1]!==k[1])&&o.push(o[0]);i(a,o,y,p,w)}return a}function i(n,t,i,r,u){return t.length&&(t.area=i,t.dist=r,u!==undefined&&(t.outer=u),n.push(t)),[]}t.exports=u;var r=n("./feature")},{"./feature":445}],444:[function(n,t){"use strict";function o(n,t){var i=[],u;if(n.type==="FeatureCollection")for(u=0;u<n.features.length;u++)r(i,n.features[u],t);else n.type==="Feature"?r(i,n,t):r(i,{geometry:n},t);return i}function r(n,t,e){if(t.geometry!==null){var p=t.geometry,s=p.type,h=p.coordinates,c=t.properties,v=t.id,o,y,l,a;if(s==="Point")n.push(i(c,1,[f(h)],v));else if(s==="MultiPoint")n.push(i(c,1,u(h),v));else if(s==="LineString")n.push(i(c,2,[u(h,e)],v));else if(s==="MultiLineString"||s==="Polygon"){for(l=[],o=0;o<h.length;o++)a=u(h[o],e),s==="Polygon"&&(a.outer=o===0),l.push(a);n.push(i(c,s==="Polygon"?3:2,l,v))}else if(s==="MultiPolygon"){for(l=[],o=0;o<h.length;o++)for(y=0;y<h[o].length;y++)a=u(h[o][y],e),a.outer=y===0,l.push(a);n.push(i(c,3,l,v))}else if(s==="GeometryCollection")for(o=0;o<p.geometries.length;o++)r(n,{geometry:p.geometries[o],properties:c},e);else throw new Error("Input data is not a valid GeoJSON object.");}}function u(n,t){for(var i=[],r=0;r<n.length;r++)i.push(f(n[r]));return t&&(e(i,t),s(i)),i}function f(n){var i=Math.sin(n[1]*Math.PI/180),r=n[0]/360+.5,t=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return t=t<0?0:t>1?1:t,[r,t,0]}function s(n){for(var u=0,f=0,r=0,i,t;r<n.length-1;r++)i=t||n[r],t=n[r+1],u+=i[0]*t[1]-t[0]*i[1],f+=Math.abs(t[0]-i[0])+Math.abs(t[1]-i[1]);n.area=Math.abs(u/2);n.dist=f}t.exports=o;var e=n("./simplify"),i=n("./feature")},{"./feature":445,"./simplify":447}],445:[function(n,t){"use strict";function r(n,t,i,r){var f={id:r||null,type:t,geometry:i,tags:n||null,min:[Infinity,Infinity],max:[-Infinity,-Infinity]};return u(f),f}function u(n){var r=n.geometry,u=n.min,f=n.max,t;if(n.type===1)i(u,f,r);else for(t=0;t<r.length;t++)i(u,f,r[t]);return n}function i(n,t,i){for(var u=0,r;u<i.length;u++)r=i[u],n[0]=Math.min(r[0],n[0]),t[0]=Math.max(r[0],t[0]),n[1]=Math.min(r[1],n[1]),t[1]=Math.max(r[1],t[1])}t.exports=r},{}],446:[function(n,t){"use strict";function a(n,t){return new u(n,t)}function u(n,t){var r,u,i;t=this.options=v(Object.create(this.options),t);r=t.debug;r&&console.time("preprocess data");u=1<<t.maxZoom;i=h(n,t.tolerance/(u*t.extent));this.tiles={};this.tileCoords=[];r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0);i=c(i,t.buffer/t.extent,o);i.length&&this.splitTile(i,0,0,0);r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function f(n,t,i){return((1<<n)*i+t)*32+n}function o(n,t,i){return[i,(i-n[0])*(t[1]-n[1])/(t[0]-n[0])+n[1],1]}function e(n,t,i){return[(i-n[1])*(t[0]-n[0])/(t[1]-n[1])+n[0],i,1]}function v(n,t){for(var i in t)n[i]=t[i];return n}function s(n,t,i){var s=n.source,u,o,e,f;if(s.length!==1||(u=s[0],u.type!==3||u.geometry.length>1)||(o=u.geometry[0].length,o!==5))return!1;for(e=0;e<o;e++)if(f=r.point(u.geometry[0][e],t,n.z2,n.x,n.y),f[0]!==-i&&f[0]!==t+i||f[1]!==-i&&f[1]!==t+i)return!1;return!0}t.exports=a;var h=n("./convert"),r=n("./transform"),i=n("./clip"),c=n("./wrap"),l=n("./tile");u.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0};u.prototype.splitTile=function(n,t,r,u,h,c,a){for(var p=[n,t,r,u],y=this.options,k=y.debug,ht=null,nt,tt;p.length;){u=p.pop();r=p.pop();t=p.pop();n=p.pop();var w=1<<t,ct=f(t,r,u),v=this.tiles[ct],lt=t===y.maxZoom?0:y.tolerance/(w*y.extent);if(v||(k>1&&console.time("creation"),v=this.tiles[ct]=l(n,w,r,u,lt,t===y.maxZoom),this.tileCoords.push({z:t,x:r,y:u}),k&&(k>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,u,v.numFeatures,v.numPoints,v.numSimplified),console.timeEnd("creation")),nt="z"+t,this.stats[nt]=(this.stats[nt]||0)+1,this.total++)),v.source=n,h){if(t===y.maxZoom||t===h)continue;if(tt=1<<h-t,r!==Math.floor(c/tt)||u!==Math.floor(a/tt))continue}else if(t===y.indexMaxZoom||v.numPoints<=y.indexMaxPoints)continue;if(!y.solidChildren&&s(v,y.extent,y.buffer)){h&&(ht=t);continue}v.source=null;k>1&&console.time("clipping");var b=.5*y.buffer/y.extent,it=.5-b,rt=.5+b,ut=1+b,ft,et,ot,st,d,g;ft=et=ot=st=null;d=i(n,w,r-b,r+rt,0,o,v.min[0],v.max[0]);g=i(n,w,r+it,r+ut,0,o,v.min[0],v.max[0]);d&&(ft=i(d,w,u-b,u+rt,1,e,v.min[1],v.max[1]),et=i(d,w,u+it,u+ut,1,e,v.min[1],v.max[1]));g&&(ot=i(g,w,u-b,u+rt,1,e,v.min[1],v.max[1]),st=i(g,w,u+it,u+ut,1,e,v.min[1],v.max[1]));k>1&&console.timeEnd("clipping");n.length&&(p.push(ft||[],t+1,r*2,u*2),p.push(et||[],t+1,r*2,u*2+1),p.push(ot||[],t+1,r*2+1,u*2),p.push(st||[],t+1,r*2+1,u*2+1))}return ht};u.prototype.getTile=function(n,t,i){var y=this.options,l=y.extent,a=y.debug,p=1<<n,e,v,w;if(t=(t%p+p)%p,e=f(n,t,i),this.tiles[e])return r.tile(this.tiles[e],l);a>1&&console.log("drilling down to z%d-%d-%d",n,t,i);for(var o=n,h=t,c=i,u;!u&&o>0;)o--,h=Math.floor(h/2),c=Math.floor(c/2),u=this.tiles[f(o,h,c)];return!u||!u.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",o,h,c),s(u,l,y.buffer))?r.tile(u,l):(a>1&&console.time("drilling down"),v=this.splitTile(u.source,o,h,c,n,t,i),a>1&&console.timeEnd("drilling down"),v!==null&&(w=1<<n-v,e=f(v,Math.floor(t/w),Math.floor(i/w))),this.tiles[e]?r.tile(this.tiles[e],l):null)}},{"./clip":443,"./convert":444,"./tile":448,"./transform":449,"./wrap":450}],447:[function(n,t){"use strict";function i(n,t){var c=t*t,l=n.length,i=0,u=l-1,o=[],f,e,h,s;for(n[i][2]=1,n[u][2]=1;u;){for(e=0,f=i+1;f<u;f++)h=r(n[f],n[i],n[u]),h>e&&(s=f,e=h);e>c?(n[s][2]=e,o.push(i),o.push(s),i=s):(u=o.pop(),i=o.pop())}}function r(n,t,i){var f=t[0],e=t[1],s=i[0],h=i[1],c=n[0],l=n[1],r=s-f,u=h-e,o;return(r!==0||u!==0)&&(o=((c-f)*r+(l-e)*u)/(r*r+u*u),o>1?(f=s,e=h):o>0&&(f+=r*o,e+=u*o)),r=c-f,u=l-e,r*r+u*u}t.exports=i},{}],448:[function(n,t){"use strict";function i(n,t,i,u,f,e){for(var h,c,o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:u,z2:t,transformed:!1,min:[2,1],max:[-1,0]},s=0;s<n.length;s++)o.numFeatures++,r(o,n[s],f,e),h=n[s].min,c=n[s].max,h[0]<o.min[0]&&(o.min[0]=h[0]),h[1]<o.min[1]&&(o.min[1]=h[1]),c[0]>o.max[0]&&(o.max[0]=c[0]),c[1]>o.max[1]&&(o.max[1]=c[1]);return o}function r(n,t,i,r){var s=t.geometry,o=t.type,h=[],y=i*i,f,c,e,a,l,v;if(o===1)for(f=0;f<s.length;f++)h.push(s[f]),n.numPoints++,n.numSimplified++;else for(f=0;f<s.length;f++){if(e=s[f],!r&&(o===2&&e.dist<i||o===3&&e.area<y)){n.numPoints+=e.length;continue}for(l=[],c=0;c<e.length;c++)a=e[c],(r||a[2]>y)&&(l.push(a),n.numSimplified++),n.numPoints++;o===3&&u(l,e.outer);h.push(l)}h.length&&(v={geometry:h,type:o,tags:t.tags||null},t.id!==null&&(v.id=t.id),n.features.push(v))}function u(n,t){var i=f(n);i<0===t&&n.reverse()}function f(n){for(var u=0,t=0,f=n.length,e=f-1,i,r;t<f;e=t++)i=n[t],r=n[e],u+=(r[0]-i[0])*(i[1]+r[1]);return u}t.exports=i},{}],449:[function(n,t,i){"use strict";function u(n,t){var o;if(n.transformed)return n;for(var s=n.z2,h=n.x,c=n.y,i,u,e=0;e<n.features.length;e++){var l=n.features[e],f=l.geometry,a=l.type;if(a===1)for(i=0;i<f.length;i++)f[i]=r(f[i],t,s,h,c);else for(i=0;i<f.length;i++)for(o=f[i],u=0;u<o.length;u++)o[u]=r(o[u],t,s,h,c)}return n.transformed=!0,n}function r(n,t,i,r,u){var f=Math.round(t*(n[0]*i-r)),e=Math.round(t*(n[1]*i-u));return[f,e]}i.tile=u;i.point=r},{}],450:[function(n,t){"use strict";function e(n,t,u){var f=n,e=i(n,1,-1-t,t,0,u,-1,2),o=i(n,1,1-t,2+t,0,u,-1,2);return(e||o)&&(f=i(n,1,-t,1+t,0,u,-1,2)||[],e&&(f=r(e,1).concat(f)),o&&(f=f.concat(r(o,-1)))),f}function r(n,t){for(var i,s,r,e,h=[],o=0;o<n.length;o++){if(i=n[o],s=i.type,s===1)r=u(i.geometry,t);else for(r=[],e=0;e<i.geometry.length;e++)r.push(u(i.geometry[e],t));h.push(f(i.tags,s,r,i.id))}return h}function u(n,t){var r=[],i;for(r.area=n.area,r.dist=n.dist,i=0;i<n.length;i++)r.push([n[i][0]+t,n[i][1],n[i][2]]);return r}var i=n("./clip"),f=n("./feature");t.exports=e},{"./clip":443,"./feature":445}],451:[function(n,t,i){i.glMatrix=n("./gl-matrix/common.js");i.mat2=n("./gl-matrix/mat2.js");i.mat2d=n("./gl-matrix/mat2d.js");i.mat3=n("./gl-matrix/mat3.js");i.mat4=n("./gl-matrix/mat4.js");i.quat=n("./gl-matrix/quat.js");i.vec2=n("./gl-matrix/vec2.js");i.vec3=n("./gl-matrix/vec3.js");i.vec4=n("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":452,"./gl-matrix/mat2.js":453,"./gl-matrix/mat2d.js":454,"./gl-matrix/mat3.js":455,"./gl-matrix/mat4.js":456,"./gl-matrix/quat.js":457,"./gl-matrix/vec2.js":458,"./gl-matrix/vec3.js":459,"./gl-matrix/vec4.js":460}],452:[function(n,t){var i={},r;i.EPSILON=1e-6;i.ARRAY_TYPE=typeof Float32Array!="undefined"?Float32Array:Array;i.RANDOM=Math.random;i.ENABLE_SIMD=!1;i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this;i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE;i.setMatrixArrayType=function(n){i.ARRAY_TYPE=n};r=Math.PI/180;i.toRadian=function(n){return n*r};i.equals=function(n,t){return Math.abs(n-t)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(t))};t.exports=i},{}],453:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(4);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};i.clone=function(n){var t=new r.ARRAY_TYPE(4);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n};i.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};i.fromValues=function(n,t,i,u){var f=new r.ARRAY_TYPE(4);return f[0]=n,f[1]=t,f[2]=i,f[3]=u,f};i.set=function(n,t,i,r,u){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n};i.transpose=function(n,t){if(n===t){var i=t[1];n[1]=t[2];n[2]=i}else n[0]=t[0],n[1]=t[2],n[2]=t[1],n[3]=t[3];return n};i.invert=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],i=r*e-f*u;return i?(i=1/i,n[0]=e*i,n[1]=-u*i,n[2]=-f*i,n[3]=r*i,n):null};i.adjoint=function(n,t){var i=t[0];return n[0]=t[3],n[1]=-t[1],n[2]=-t[2],n[3]=i,n};i.determinant=function(n){return n[0]*n[3]-n[2]*n[1]};i.multiply=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3],o=i[0],s=i[1],h=i[2],c=i[3];return n[0]=r*o+f*s,n[1]=u*o+e*s,n[2]=r*h+f*c,n[3]=u*h+e*c,n};i.mul=i.multiply;i.rotate=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],r=Math.sin(i),u=Math.cos(i);return n[0]=f*u+o*r,n[1]=e*u+s*r,n[2]=f*-r+o*u,n[3]=e*-r+s*u,n};i.scale=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],r=i[0],u=i[1];return n[0]=f*r,n[1]=e*r,n[2]=o*u,n[3]=s*u,n};i.fromRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=i,n[2]=-i,n[3]=r,n};i.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=t[1],n};i.str=function(n){return"mat2("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};i.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2))};i.LDU=function(n,t,i,r){return n[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-n[2]*i[1],[n,t,i]};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n};i.sub=i.subtract;i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=n[3],o=t[0],s=t[1],h=t[2],c=t[3];return Math.abs(i-o)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(u-s)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(s))&&Math.abs(f-h)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(h))&&Math.abs(e-c)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(c))};i.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n};i.multiplyScalarAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n[3]=t[3]+i[3]*r,n};t.exports=i},{"./common.js":452}],454:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(6);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};i.clone=function(n){var t=new r.ARRAY_TYPE(6);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n};i.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};i.fromValues=function(n,t,i,u,f,e){var o=new r.ARRAY_TYPE(6);return o[0]=n,o[1]=t,o[2]=i,o[3]=u,o[4]=f,o[5]=e,o};i.set=function(n,t,i,r,u,f,e){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n[4]=f,n[5]=e,n};i.invert=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],i=r*e-u*f;return i?(i=1/i,n[0]=e*i,n[1]=-u*i,n[2]=-f*i,n[3]=r*i,n[4]=(f*s-e*o)*i,n[5]=(u*o-r*s)*i,n):null};i.determinant=function(n){return n[0]*n[3]-n[1]*n[2]};i.multiply=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3],v=t[4],y=t[5],o=i[0],s=i[1],h=i[2],c=i[3],l=i[4],a=i[5];return n[0]=r*o+f*s,n[1]=u*o+e*s,n[2]=r*h+f*c,n[3]=u*h+e*c,n[4]=r*l+f*a+v,n[5]=u*l+e*a+y,n};i.mul=i.multiply;i.rotate=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],r=Math.sin(i),u=Math.cos(i);return n[0]=f*u+o*r,n[1]=e*u+s*r,n[2]=f*-r+o*u,n[3]=e*-r+s*u,n[4]=h,n[5]=c,n};i.scale=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],r=i[0],u=i[1];return n[0]=f*r,n[1]=e*r,n[2]=o*u,n[3]=s*u,n[4]=h,n[5]=c,n};i.translate=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3],h=t[4],c=t[5],o=i[0],s=i[1];return n[0]=r,n[1]=u,n[2]=f,n[3]=e,n[4]=r*o+f*s+h,n[5]=u*o+e*s+c,n};i.fromRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=i,n[2]=-i,n[3]=r,n[4]=0,n[5]=0,n};i.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=t[1],n[4]=0,n[5]=0,n};i.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=t[0],n[5]=t[1],n};i.str=function(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"};i.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+1)};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n};i.sub=i.subtract;i.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n};i.multiplyScalarAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n[3]=t[3]+i[3]*r,n[4]=t[4]+i[4]*r,n[5]=t[5]+i[5]*r,n};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=t[0],c=t[1],l=t[2],a=t[3],v=t[4],y=t[5];return Math.abs(i-h)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-c)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(c))&&Math.abs(f-l)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))&&Math.abs(e-a)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(o-v)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-y)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))};t.exports=i},{"./common.js":452}],455:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(9);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};i.fromMat4=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n};i.clone=function(n){var t=new r.ARRAY_TYPE(9);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n};i.fromValues=function(n,t,i,u,f,e,o,s,h){var c=new r.ARRAY_TYPE(9);return c[0]=n,c[1]=t,c[2]=i,c[3]=u,c[4]=f,c[5]=e,c[6]=o,c[7]=s,c[8]=h,c};i.set=function(n,t,i,r,u,f,e,o,s,h){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n[4]=f,n[5]=e,n[6]=o,n[7]=s,n[8]=h,n};i.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};i.transpose=function(n,t){if(n===t){var i=t[1],r=t[2],u=t[5];n[1]=t[3];n[2]=t[6];n[3]=i;n[5]=t[7];n[6]=r;n[7]=u}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n};i.invert=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],h=t[6],c=t[7],l=t[8],a=l*o-s*c,v=-l*e+s*h,y=c*e-o*h,i=r*a+u*v+f*y;return i?(i=1/i,n[0]=a*i,n[1]=(-l*u+f*c)*i,n[2]=(s*u-f*o)*i,n[3]=v*i,n[4]=(l*r-f*h)*i,n[5]=(-s*r+f*e)*i,n[6]=y*i,n[7]=(-c*r+u*h)*i,n[8]=(o*r-u*e)*i,n):null};i.adjoint=function(n,t){var i=t[0],r=t[1],u=t[2],f=t[3],e=t[4],o=t[5],s=t[6],h=t[7],c=t[8];return n[0]=e*c-o*h,n[1]=u*h-r*c,n[2]=r*o-u*e,n[3]=o*s-f*c,n[4]=i*c-u*s,n[5]=u*f-i*o,n[6]=f*h-e*s,n[7]=r*s-i*h,n[8]=i*e-r*f,n};i.determinant=function(n){var o=n[0],s=n[1],h=n[2],t=n[3],i=n[4],r=n[5],u=n[6],f=n[7],e=n[8];return o*(e*i-r*f)+s*(-e*t+r*u)+h*(f*t-i*u)};i.multiply=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],h=t[6],c=t[7],l=t[8],a=i[0],v=i[1],y=i[2],p=i[3],w=i[4],b=i[5],k=i[6],d=i[7],g=i[8];return n[0]=a*r+v*e+y*h,n[1]=a*u+v*o+y*c,n[2]=a*f+v*s+y*l,n[3]=p*r+w*e+b*h,n[4]=p*u+w*o+b*c,n[5]=p*f+w*s+b*l,n[6]=k*r+d*e+g*h,n[7]=k*u+d*o+g*c,n[8]=k*f+d*s+g*l,n};i.mul=i.multiply;i.translate=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],l=t[6],a=t[7],v=t[8],r=i[0],u=i[1];return n[0]=f,n[1]=e,n[2]=o,n[3]=s,n[4]=h,n[5]=c,n[6]=r*f+u*s+l,n[7]=r*e+u*h+a,n[8]=r*o+u*c+v,n};i.rotate=function(n,t,i){var f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],l=t[6],a=t[7],v=t[8],r=Math.sin(i),u=Math.cos(i);return n[0]=u*f+r*s,n[1]=u*e+r*h,n[2]=u*o+r*c,n[3]=u*s-r*f,n[4]=u*h-r*e,n[5]=u*c-r*o,n[6]=l,n[7]=a,n[8]=v,n};i.scale=function(n,t,i){var r=i[0],u=i[1];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=u*t[3],n[4]=u*t[4],n[5]=u*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n};i.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=t[0],n[7]=t[1],n[8]=1,n};i.fromRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=i,n[2]=0,n[3]=-i,n[4]=r,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};i.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=t[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};i.fromMat2d=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=0,n[3]=t[2],n[4]=t[3],n[5]=0,n[6]=t[4],n[7]=t[5],n[8]=1,n};i.fromQuat=function(n,t){var f=t[0],r=t[1],i=t[2],e=t[3],u=f+f,o=r+r,s=i+i,h=f*u,c=r*u,l=r*o,a=i*u,v=i*o,y=i*s,p=e*u,w=e*o,b=e*s;return n[0]=1-l-y,n[3]=c-b,n[6]=a+w,n[1]=c+b,n[4]=1-h-y,n[7]=v-p,n[2]=a-w,n[5]=v+p,n[8]=1-h-l,n};i.normalFromMat4=function(n,t){var e=t[0],o=t[1],s=t[2],r=t[3],h=t[4],c=t[5],l=t[6],u=t[7],k=t[8],d=t[9],g=t[10],nt=t[11],a=t[12],v=t[13],y=t[14],f=t[15],ot=e*c-o*h,st=e*l-s*h,tt=e*u-r*h,ht=o*l-s*c,it=o*u-r*c,rt=s*u-r*l,ut=k*v-d*a,ft=k*y-g*a,p=k*f-nt*a,et=d*y-g*v,w=d*f-nt*v,b=g*f-nt*y,i=ot*b-st*w+tt*et+ht*p-it*ft+rt*ut;return i?(i=1/i,n[0]=(c*b-l*w+u*et)*i,n[1]=(l*p-h*b-u*ft)*i,n[2]=(h*w-c*p+u*ut)*i,n[3]=(s*w-o*b-r*et)*i,n[4]=(e*b-s*p+r*ft)*i,n[5]=(o*p-e*w-r*ut)*i,n[6]=(v*rt-y*it+f*ht)*i,n[7]=(y*tt-a*rt-f*st)*i,n[8]=(a*it-v*tt+f*ot)*i,n):null};i.str=function(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"};i.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2))};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n[6]=t[6]+i[6],n[7]=t[7]+i[7],n[8]=t[8]+i[8],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n[6]=t[6]-i[6],n[7]=t[7]-i[7],n[8]=t[8]-i[8],n};i.sub=i.subtract;i.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*i,n};i.multiplyScalarAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n[3]=t[3]+i[3]*r,n[4]=t[4]+i[4]*r,n[5]=t[5]+i[5]*r,n[6]=t[6]+i[6]*r,n[7]=t[7]+i[7]*r,n[8]=t[8]+i[8]*r,n};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=n[6],c=n[7],l=n[8],a=t[0],v=t[1],y=t[2],p=t[3],w=t[4],b=t[5],k=n[6],d=t[7],g=t[8];return Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(u-v)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(f-y)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(e-p)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(p))&&Math.abs(o-w)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-b)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(h-k)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(c-d)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(l-g)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))};t.exports=i},{"./common.js":452}],456:[function(n,t){var r=n("./common.js"),i={scalar:{},SIMD:{}};i.create=function(){var n=new r.ARRAY_TYPE(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.clone=function(n){var t=new r.ARRAY_TYPE(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};i.fromValues=function(n,t,i,u,f,e,o,s,h,c,l,a,v,y,p,w){var b=new r.ARRAY_TYPE(16);return b[0]=n,b[1]=t,b[2]=i,b[3]=u,b[4]=f,b[5]=e,b[6]=o,b[7]=s,b[8]=h,b[9]=c,b[10]=l,b[11]=a,b[12]=v,b[13]=y,b[14]=p,b[15]=w,b};i.set=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n[4]=f,n[5]=e,n[6]=o,n[7]=s,n[8]=h,n[9]=c,n[10]=l,n[11]=a,n[12]=v,n[13]=y,n[14]=p,n[15]=w,n};i.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.scalar.transpose=function(n,t){if(n===t){var i=t[1],r=t[2],u=t[3],f=t[6],e=t[7],o=t[11];n[1]=t[4];n[2]=t[8];n[3]=t[12];n[4]=i;n[6]=t[9];n[7]=t[13];n[8]=r;n[9]=f;n[11]=t[14];n[12]=u;n[13]=e;n[14]=o}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n};i.SIMD.transpose=function(n,t){var u,f,e,o,i,r,s,h,c,l;return u=SIMD.Float32x4.load(t,0),f=SIMD.Float32x4.load(t,4),e=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),i=SIMD.Float32x4.shuffle(u,f,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),s=SIMD.Float32x4.shuffle(i,r,0,2,4,6),h=SIMD.Float32x4.shuffle(i,r,1,3,5,7),SIMD.Float32x4.store(n,0,s),SIMD.Float32x4.store(n,4,h),i=SIMD.Float32x4.shuffle(u,f,2,3,6,7),r=SIMD.Float32x4.shuffle(e,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,r,0,2,4,6),l=SIMD.Float32x4.shuffle(i,r,1,3,5,7),SIMD.Float32x4.store(n,8,c),SIMD.Float32x4.store(n,12,l),n};i.transpose=r.USE_SIMD?i.SIMD.transpose:i.scalar.transpose;i.scalar.invert=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5],h=t[6],c=t[7],l=t[8],a=t[9],v=t[10],y=t[11],p=t[12],w=t[13],b=t[14],k=t[15],d=r*s-u*o,g=r*h-f*o,nt=r*c-e*o,tt=u*h-f*s,it=u*c-e*s,rt=f*c-e*h,ut=l*w-a*p,ft=l*b-v*p,et=l*k-y*p,ot=a*b-v*w,st=a*k-y*w,ht=v*k-y*b,i=d*ht-g*st+nt*ot+tt*et-it*ft+rt*ut;return i?(i=1/i,n[0]=(s*ht-h*st+c*ot)*i,n[1]=(f*st-u*ht-e*ot)*i,n[2]=(w*rt-b*it+k*tt)*i,n[3]=(v*it-a*rt-y*tt)*i,n[4]=(h*et-o*ht-c*ft)*i,n[5]=(r*ht-f*et+e*ft)*i,n[6]=(b*nt-p*rt-k*g)*i,n[7]=(l*rt-v*nt+y*g)*i,n[8]=(o*st-s*et+c*ut)*i,n[9]=(u*et-r*st-e*ut)*i,n[10]=(p*it-w*nt+k*d)*i,n[11]=(a*nt-l*it-y*d)*i,n[12]=(s*ft-o*ot-h*ut)*i,n[13]=(r*ot-u*ft+f*ut)*i,n[14]=(w*g-p*tt-b*d)*i,n[15]=(l*tt-a*g+v*d)*i,n):null};i.SIMD.invert=function(n,t){var l,o,c,s,i,h,u,f,e,r,a=SIMD.Float32x4.load(t,0),v=SIMD.Float32x4.load(t,4),y=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return(i=SIMD.Float32x4.shuffle(a,v,0,1,4,5),o=SIMD.Float32x4.shuffle(y,p,0,1,4,5),l=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.shuffle(a,v,2,3,6,7),s=SIMD.Float32x4.shuffle(y,p,2,3,6,7),c=SIMD.Float32x4.shuffle(i,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,i,1,3,5,7),i=SIMD.Float32x4.mul(c,s),i=SIMD.Float32x4.swizzle(i,1,0,3,2),h=SIMD.Float32x4.mul(o,i),u=SIMD.Float32x4.mul(l,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),h),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,i),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.mul(o,c),i=SIMD.Float32x4.swizzle(i,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),h),e=SIMD.Float32x4.mul(l,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,i)),e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,i),e),e=SIMD.Float32x4.swizzle(e,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,2,3,0,1),s),i=SIMD.Float32x4.swizzle(i,1,0,3,2),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,i),h),f=SIMD.Float32x4.mul(l,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,i)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,i),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),i=SIMD.Float32x4.mul(l,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),f),e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,i),e),i=SIMD.Float32x4.swizzle(i,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,i),f),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(c,i)),i=SIMD.Float32x4.mul(l,s),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(c,i)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),f),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,i),u),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(o,i)),i=SIMD.Float32x4.mul(l,c),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),u),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(o,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(s,i)),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),e),r=SIMD.Float32x4.mul(l,h),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,2,3,0,1),r),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,1,0,3,2),r),i=SIMD.Float32x4.reciprocalApproximation(r),r=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(r,SIMD.Float32x4.mul(i,i))),r=SIMD.Float32x4.swizzle(r,0,0,0,0),!r)?null:(SIMD.Float32x4.store(n,0,SIMD.Float32x4.mul(r,h)),SIMD.Float32x4.store(n,4,SIMD.Float32x4.mul(r,u)),SIMD.Float32x4.store(n,8,SIMD.Float32x4.mul(r,f)),SIMD.Float32x4.store(n,12,SIMD.Float32x4.mul(r,e)),n)};i.invert=r.USE_SIMD?i.SIMD.invert:i.scalar.invert;i.scalar.adjoint=function(n,t){var y=t[0],c=t[1],i=t[2],r=t[3],p=t[4],l=t[5],u=t[6],f=t[7],w=t[8],a=t[9],e=t[10],o=t[11],b=t[12],v=t[13],s=t[14],h=t[15];return n[0]=l*(e*h-o*s)-a*(u*h-f*s)+v*(u*o-f*e),n[1]=-(c*(e*h-o*s)-a*(i*h-r*s)+v*(i*o-r*e)),n[2]=c*(u*h-f*s)-l*(i*h-r*s)+v*(i*f-r*u),n[3]=-(c*(u*o-f*e)-l*(i*o-r*e)+a*(i*f-r*u)),n[4]=-(p*(e*h-o*s)-w*(u*h-f*s)+b*(u*o-f*e)),n[5]=y*(e*h-o*s)-w*(i*h-r*s)+b*(i*o-r*e),n[6]=-(y*(u*h-f*s)-p*(i*h-r*s)+b*(i*f-r*u)),n[7]=y*(u*o-f*e)-p*(i*o-r*e)+w*(i*f-r*u),n[8]=p*(a*h-o*v)-w*(l*h-f*v)+b*(l*o-f*a),n[9]=-(y*(a*h-o*v)-w*(c*h-r*v)+b*(c*o-r*a)),n[10]=y*(l*h-f*v)-p*(c*h-r*v)+b*(c*f-r*l),n[11]=-(y*(l*o-f*a)-p*(c*o-r*a)+w*(c*f-r*l)),n[12]=-(p*(a*s-e*v)-w*(l*s-u*v)+b*(l*e-u*a)),n[13]=y*(a*s-e*v)-w*(c*s-i*v)+b*(c*e-i*a),n[14]=-(y*(l*s-u*v)-p*(c*s-i*v)+b*(c*u-i*l)),n[15]=y*(l*e-u*a)-p*(c*e-i*a)+w*(c*u-i*l),n};i.SIMD.adjoint=function(n,t){var c,e,s,o,i,h,r,u,f,l=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4),v=SIMD.Float32x4.load(t,8),y=SIMD.Float32x4.load(t,12);return i=SIMD.Float32x4.shuffle(l,a,0,1,4,5),e=SIMD.Float32x4.shuffle(v,y,0,1,4,5),c=SIMD.Float32x4.shuffle(i,e,0,2,4,6),e=SIMD.Float32x4.shuffle(e,i,1,3,5,7),i=SIMD.Float32x4.shuffle(l,a,2,3,6,7),o=SIMD.Float32x4.shuffle(v,y,2,3,6,7),s=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(s,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),h=SIMD.Float32x4.mul(e,i),r=SIMD.Float32x4.mul(c,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,i),h),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,i),r),r=SIMD.Float32x4.swizzle(r,2,3,0,1),i=SIMD.Float32x4.mul(e,s),i=SIMD.Float32x4.swizzle(i,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),h),f=SIMD.Float32x4.mul(c,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(o,i)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,i),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),h),u=SIMD.Float32x4.mul(c,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,i)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,i),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.mul(c,e),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,i),f),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),u),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,i)),i=SIMD.Float32x4.mul(c,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(s,i)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,i),u),i=SIMD.Float32x4.swizzle(i,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),r),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(e,i)),i=SIMD.Float32x4.mul(c,s),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),r),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(e,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(o,i)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,i),f),SIMD.Float32x4.store(n,0,h),SIMD.Float32x4.store(n,4,r),SIMD.Float32x4.store(n,8,u),SIMD.Float32x4.store(n,12,f),n};i.adjoint=r.USE_SIMD?i.SIMD.adjoint:i.scalar.adjoint;i.determinant=function(n){var t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=n[5],o=n[6],s=n[7],h=n[8],c=n[9],l=n[10],a=n[11],v=n[12],y=n[13],p=n[14],w=n[15],b=t*e-i*f,k=t*o-r*f,d=t*s-u*f,g=i*o-r*e,nt=i*s-u*e,tt=r*s-u*o,it=h*y-c*v,rt=h*p-l*v,ut=h*w-a*v,ft=c*p-l*y,et=c*w-a*y,ot=l*w-a*p;return b*ot-k*et+d*ft+g*ut-nt*rt+tt*it};i.SIMD.multiply=function(n,t,i){var e=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,4),s=SIMD.Float32x4.load(t,8),h=SIMD.Float32x4.load(t,12),c=SIMD.Float32x4.load(i,0),y=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),h)))),r,l,u,a,f,v;return SIMD.Float32x4.store(n,0,y),r=SIMD.Float32x4.load(i,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,3,3,3,3),h)))),SIMD.Float32x4.store(n,4,l),u=SIMD.Float32x4.load(i,8),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),h)))),SIMD.Float32x4.store(n,8,a),f=SIMD.Float32x4.load(i,12),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),h)))),SIMD.Float32x4.store(n,12,v),n};i.scalar.multiply=function(n,t,i){var o=t[0],s=t[1],h=t[2],c=t[3],l=t[4],a=t[5],v=t[6],y=t[7],p=t[8],w=t[9],b=t[10],k=t[11],d=t[12],g=t[13],nt=t[14],tt=t[15],r=i[0],u=i[1],f=i[2],e=i[3];return n[0]=r*o+u*l+f*p+e*d,n[1]=r*s+u*a+f*w+e*g,n[2]=r*h+u*v+f*b+e*nt,n[3]=r*c+u*y+f*k+e*tt,r=i[4],u=i[5],f=i[6],e=i[7],n[4]=r*o+u*l+f*p+e*d,n[5]=r*s+u*a+f*w+e*g,n[6]=r*h+u*v+f*b+e*nt,n[7]=r*c+u*y+f*k+e*tt,r=i[8],u=i[9],f=i[10],e=i[11],n[8]=r*o+u*l+f*p+e*d,n[9]=r*s+u*a+f*w+e*g,n[10]=r*h+u*v+f*b+e*nt,n[11]=r*c+u*y+f*k+e*tt,r=i[12],u=i[13],f=i[14],e=i[15],n[12]=r*o+u*l+f*p+e*d,n[13]=r*s+u*a+f*w+e*g,n[14]=r*h+u*v+f*b+e*nt,n[15]=r*c+u*y+f*k+e*tt,n};i.multiply=r.USE_SIMD?i.SIMD.multiply:i.scalar.multiply;i.mul=i.multiply;i.scalar.translate=function(n,t,i){var r=i[0],u=i[1],f=i[2],e,o,s,h,c,l,a,v,y,p,w,b;return t===n?(n[12]=t[0]*r+t[4]*u+t[8]*f+t[12],n[13]=t[1]*r+t[5]*u+t[9]*f+t[13],n[14]=t[2]*r+t[6]*u+t[10]*f+t[14],n[15]=t[3]*r+t[7]*u+t[11]*f+t[15]):(e=t[0],o=t[1],s=t[2],h=t[3],c=t[4],l=t[5],a=t[6],v=t[7],y=t[8],p=t[9],w=t[10],b=t[11],n[0]=e,n[1]=o,n[2]=s,n[3]=h,n[4]=c,n[5]=l,n[6]=a,n[7]=v,n[8]=y,n[9]=p,n[10]=w,n[11]=b,n[12]=e*r+c*u+y*f+t[12],n[13]=o*r+l*u+p*f+t[13],n[14]=s*r+a*u+w*f+t[14],n[15]=h*r+v*u+b*f+t[15]),n};i.SIMD.translate=function(n,t,i){var r=SIMD.Float32x4.load(t,0),u=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),s=SIMD.Float32x4.load(t,12),e=SIMD.Float32x4(i[0],i[1],i[2],0),o;return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(e,0,0,0,0)),u=SIMD.Float32x4.mul(u,SIMD.Float32x4.swizzle(e,1,1,1,1)),f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(e,2,2,2,2)),o=SIMD.Float32x4.add(r,SIMD.Float32x4.add(u,SIMD.Float32x4.add(f,s))),SIMD.Float32x4.store(n,12,o),n};i.translate=r.USE_SIMD?i.SIMD.translate:i.scalar.translate;i.scalar.scale=function(n,t,i){var r=i[0],u=i[1],f=i[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*u,n[5]=t[5]*u,n[6]=t[6]*u,n[7]=t[7]*u,n[8]=t[8]*f,n[9]=t[9]*f,n[10]=t[10]*f,n[11]=t[11]*f,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};i.SIMD.scale=function(n,t,i){var u,f,e,r=SIMD.Float32x4(i[0],i[1],i[2],0);return u=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(n,0,SIMD.Float32x4.mul(u,SIMD.Float32x4.swizzle(r,0,0,0,0))),f=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(n,4,SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(r,1,1,1,1))),e=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(n,8,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(r,2,2,2,2))),n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};i.scale=r.USE_SIMD?i.SIMD.scale:i.scalar.scale;i.rotate=function(n,t,i,u){var f=u[0],e=u[1],o=u[2],c=Math.sqrt(f*f+e*e+o*o),h,l,s,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,a,v,y,p,w,b,k,d,g;return Math.abs(c)<r.EPSILON?null:(c=1/c,f*=c,e*=c,o*=c,h=Math.sin(i),l=Math.cos(i),s=1-l,nt=t[0],tt=t[1],it=t[2],rt=t[3],ut=t[4],ft=t[5],et=t[6],ot=t[7],st=t[8],ht=t[9],ct=t[10],lt=t[11],a=f*f*s+l,v=e*f*s+o*h,y=o*f*s-e*h,p=f*e*s-o*h,w=e*e*s+l,b=o*e*s+f*h,k=f*o*s+e*h,d=e*o*s-f*h,g=o*o*s+l,n[0]=nt*a+ut*v+st*y,n[1]=tt*a+ft*v+ht*y,n[2]=it*a+et*v+ct*y,n[3]=rt*a+ot*v+lt*y,n[4]=nt*p+ut*w+st*b,n[5]=tt*p+ft*w+ht*b,n[6]=it*p+et*w+ct*b,n[7]=rt*p+ot*w+lt*b,n[8]=nt*k+ut*d+st*g,n[9]=tt*k+ft*d+ht*g,n[10]=it*k+et*d+ct*g,n[11]=rt*k+ot*d+lt*g,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)};i.scalar.rotateX=function(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[4],e=t[5],o=t[6],s=t[7],h=t[8],c=t[9],l=t[10],a=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=f*u+h*r,n[5]=e*u+c*r,n[6]=o*u+l*r,n[7]=s*u+a*r,n[8]=h*u-f*r,n[9]=c*u-e*r,n[10]=l*u-o*r,n[11]=a*u-s*r,n};i.SIMD.rotateX=function(n,t,i){var f=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i)),r,u;return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),r=SIMD.Float32x4.load(t,4),u=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(n,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,e),SIMD.Float32x4.mul(u,f))),SIMD.Float32x4.store(n,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,e),SIMD.Float32x4.mul(r,f))),n};i.rotateX=r.USE_SIMD?i.SIMD.rotateX:i.scalar.rotateX;i.scalar.rotateY=function(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[0],e=t[1],o=t[2],s=t[3],h=t[8],c=t[9],l=t[10],a=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*u-h*r,n[1]=e*u-c*r,n[2]=o*u-l*r,n[3]=s*u-a*r,n[8]=f*r+h*u,n[9]=e*r+c*u,n[10]=o*r+l*u,n[11]=s*r+a*u,n};i.SIMD.rotateY=function(n,t,i){var f=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i)),r,u;return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),r=SIMD.Float32x4.load(t,0),u=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(n,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,e),SIMD.Float32x4.mul(u,f))),SIMD.Float32x4.store(n,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,f),SIMD.Float32x4.mul(u,e))),n};i.rotateY=r.USE_SIMD?i.SIMD.rotateY:i.scalar.rotateY;i.scalar.rotateZ=function(n,t,i){var r=Math.sin(i),u=Math.cos(i),f=t[0],e=t[1],o=t[2],s=t[3],h=t[4],c=t[5],l=t[6],a=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*u+h*r,n[1]=e*u+c*r,n[2]=o*u+l*r,n[3]=s*u+a*r,n[4]=h*u-f*r,n[5]=c*u-e*r,n[6]=l*u-o*r,n[7]=a*u-s*r,n};i.SIMD.rotateZ=function(n,t,i){var f=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i)),r,u;return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),r=SIMD.Float32x4.load(t,0),u=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(n,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,e),SIMD.Float32x4.mul(u,f))),SIMD.Float32x4.store(n,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,e),SIMD.Float32x4.mul(r,f))),n};i.rotateZ=r.USE_SIMD?i.SIMD.rotateZ:i.scalar.rotateZ;i.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n};i.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.fromRotation=function(n,t,i){var u=i[0],f=i[1],e=i[2],h=Math.sqrt(u*u+f*f+e*e),s,c,o;return Math.abs(h)<r.EPSILON?null:(h=1/h,u*=h,f*=h,e*=h,s=Math.sin(t),c=Math.cos(t),o=1-c,n[0]=u*u*o+c,n[1]=f*u*o+e*s,n[2]=e*u*o-f*s,n[3]=0,n[4]=u*f*o-e*s,n[5]=f*f*o+c,n[6]=e*f*o+u*s,n[7]=0,n[8]=u*e*o+f*s,n[9]=f*e*o-u*s,n[10]=e*e*o+c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)};i.fromXRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=i,n[7]=0,n[8]=0,n[9]=-i,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.fromYRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=0,n[2]=-i,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=i,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.fromZRotation=function(n,t){var i=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=i,n[2]=0,n[3]=0,n[4]=-i,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.fromRotationTranslation=function(n,t,i){var r=t[0],u=t[1],e=t[2],o=t[3],h=r+r,s=u+u,f=e+e,c=r*h,l=r*s,a=r*f,v=u*s,y=u*f,p=e*f,w=o*h,b=o*s,k=o*f;return n[0]=1-(v+p),n[1]=l+k,n[2]=a-b,n[3]=0,n[4]=l-k,n[5]=1-(c+p),n[6]=y+w,n[7]=0,n[8]=a+b,n[9]=y-w,n[10]=1-(c+v),n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n};i.getTranslation=function(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n};i.getRotation=function(n,t){var r=t[0]+t[5]+t[10],i=0;return r>0?(i=Math.sqrt(r+1)*2,n[3]=.25*i,n[0]=(t[6]-t[9])/i,n[1]=(t[8]-t[2])/i,n[2]=(t[1]-t[4])/i):t[0]>t[5]&t[0]>t[10]?(i=Math.sqrt(1+t[0]-t[5]-t[10])*2,n[3]=(t[6]-t[9])/i,n[0]=.25*i,n[1]=(t[1]+t[4])/i,n[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=Math.sqrt(1+t[5]-t[0]-t[10])*2,n[3]=(t[8]-t[2])/i,n[0]=(t[1]+t[4])/i,n[1]=.25*i,n[2]=(t[6]+t[9])/i):(i=Math.sqrt(1+t[10]-t[0]-t[5])*2,n[3]=(t[1]-t[4])/i,n[0]=(t[8]+t[2])/i,n[1]=(t[6]+t[9])/i,n[2]=.25*i),n};i.fromRotationTranslationScale=function(n,t,i,r){var u=t[0],f=t[1],o=t[2],s=t[3],v=u+u,h=f+f,e=o+o,y=u*v,p=u*h,w=u*e,b=f*h,k=f*e,d=o*e,g=s*v,nt=s*h,tt=s*e,c=r[0],l=r[1],a=r[2];return n[0]=(1-(b+d))*c,n[1]=(p+tt)*c,n[2]=(w-nt)*c,n[3]=0,n[4]=(p-tt)*l,n[5]=(1-(y+d))*l,n[6]=(k+g)*l,n[7]=0,n[8]=(w+nt)*a,n[9]=(k-g)*a,n[10]=(1-(y+b))*a,n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n};i.fromRotationTranslationScaleOrigin=function(n,t,i,r,u){var f=t[0],e=t[1],l=t[2],a=t[3],b=f+f,v=e+e,o=l+l,k=f*b,d=f*v,g=f*o,nt=e*v,tt=e*o,it=l*o,rt=a*b,ut=a*v,ft=a*o,y=r[0],p=r[1],w=r[2],s=u[0],h=u[1],c=u[2];return n[0]=(1-(nt+it))*y,n[1]=(d+ft)*y,n[2]=(g-ut)*y,n[3]=0,n[4]=(d-ft)*p,n[5]=(1-(k+it))*p,n[6]=(tt+rt)*p,n[7]=0,n[8]=(g+ut)*w,n[9]=(tt-rt)*w,n[10]=(1-(k+nt))*w,n[11]=0,n[12]=i[0]+s-(n[0]*s+n[4]*h+n[8]*c),n[13]=i[1]+h-(n[1]*s+n[5]*h+n[9]*c),n[14]=i[2]+c-(n[2]*s+n[6]*h+n[10]*c),n[15]=1,n};i.fromQuat=function(n,t){var f=t[0],r=t[1],i=t[2],e=t[3],u=f+f,o=r+r,s=i+i,h=f*u,c=r*u,l=r*o,a=i*u,v=i*o,y=i*s,p=e*u,w=e*o,b=e*s;return n[0]=1-l-y,n[1]=c+b,n[2]=a-w,n[3]=0,n[4]=c-b,n[5]=1-h-y,n[6]=v+p,n[7]=0,n[8]=a+w,n[9]=v-p,n[10]=1-h-l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};i.frustum=function(n,t,i,r,u,f,e){var o=1/(i-t),s=1/(u-r),h=1/(f-e);return n[0]=f*2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=f*2*s,n[6]=0,n[7]=0,n[8]=(i+t)*o,n[9]=(u+r)*s,n[10]=(e+f)*h,n[11]=-1,n[12]=0,n[13]=0,n[14]=e*f*2*h,n[15]=0,n};i.perspective=function(n,t,i,r,u){var f=1/Math.tan(t/2),e=1/(r-u);return n[0]=f/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=f,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(u+r)*e,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*u*r*e,n[15]=0,n};i.perspectiveFromFieldOfView=function(n,t,i,r){var u=Math.tan(t.upDegrees*Math.PI/180),f=Math.tan(t.downDegrees*Math.PI/180),e=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),s=2/(e+o),h=2/(u+f);return n[0]=s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=-((e-o)*s*.5),n[9]=(u-f)*h*.5,n[10]=r/(i-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*i/(i-r),n[15]=0,n};i.ortho=function(n,t,i,r,u,f,e){var o=1/(t-i),s=1/(r-u),h=1/(f-e);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*h,n[11]=0,n[12]=(t+i)*o,n[13]=(u+r)*s,n[14]=(e+f)*h,n[15]=1,n};i.lookAt=function(n,t,u,f){var c,l,a,v,y,p,o,s,h,e,w=t[0],b=t[1],k=t[2],d=f[0],g=f[1],nt=f[2],tt=u[0],it=u[1],rt=u[2];return Math.abs(w-tt)<r.EPSILON&&Math.abs(b-it)<r.EPSILON&&Math.abs(k-rt)<r.EPSILON?i.identity(n):(o=w-tt,s=b-it,h=k-rt,e=1/Math.sqrt(o*o+s*s+h*h),o*=e,s*=e,h*=e,c=g*h-nt*s,l=nt*o-d*h,a=d*s-g*o,e=Math.sqrt(c*c+l*l+a*a),e?(e=1/e,c*=e,l*=e,a*=e):(c=0,l=0,a=0),v=s*a-h*l,y=h*c-o*a,p=o*l-s*c,e=Math.sqrt(v*v+y*y+p*p),e?(e=1/e,v*=e,y*=e,p*=e):(v=0,y=0,p=0),n[0]=c,n[1]=v,n[2]=o,n[3]=0,n[4]=l,n[5]=y,n[6]=s,n[7]=0,n[8]=a,n[9]=p,n[10]=h,n[11]=0,n[12]=-(c*w+l*b+a*k),n[13]=-(v*w+y*b+p*k),n[14]=-(o*w+s*b+h*k),n[15]=1,n)};i.str=function(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"};i.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2)+Math.pow(n[9],2)+Math.pow(n[10],2)+Math.pow(n[11],2)+Math.pow(n[12],2)+Math.pow(n[13],2)+Math.pow(n[14],2)+Math.pow(n[15],2))};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n[6]=t[6]+i[6],n[7]=t[7]+i[7],n[8]=t[8]+i[8],n[9]=t[9]+i[9],n[10]=t[10]+i[10],n[11]=t[11]+i[11],n[12]=t[12]+i[12],n[13]=t[13]+i[13],n[14]=t[14]+i[14],n[15]=t[15]+i[15],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n[6]=t[6]-i[6],n[7]=t[7]-i[7],n[8]=t[8]-i[8],n[9]=t[9]-i[9],n[10]=t[10]-i[10],n[11]=t[11]-i[11],n[12]=t[12]-i[12],n[13]=t[13]-i[13],n[14]=t[14]-i[14],n[15]=t[15]-i[15],n};i.sub=i.subtract;i.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*i,n[9]=t[9]*i,n[10]=t[10]*i,n[11]=t[11]*i,n[12]=t[12]*i,n[13]=t[13]*i,n[14]=t[14]*i,n[15]=t[15]*i,n};i.multiplyScalarAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n[3]=t[3]+i[3]*r,n[4]=t[4]+i[4]*r,n[5]=t[5]+i[5]*r,n[6]=t[6]+i[6]*r,n[7]=t[7]+i[7]*r,n[8]=t[8]+i[8]*r,n[9]=t[9]+i[9]*r,n[10]=t[10]+i[10]*r,n[11]=t[11]+i[11]*r,n[12]=t[12]+i[12]*r,n[13]=t[13]+i[13]*r,n[14]=t[14]+i[14]*r,n[15]=t[15]+i[15]*r,n};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=n[6],c=n[7],l=n[8],a=n[9],v=n[10],y=n[11],p=n[12],w=n[13],b=n[14],k=n[15],d=t[0],g=t[1],nt=t[2],tt=t[3],it=t[4],rt=t[5],ut=t[6],ft=t[7],et=t[8],ot=t[9],st=t[10],ht=t[11],ct=t[12],lt=t[13],at=t[14],vt=t[15];return Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(u-g)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(f-nt)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(nt))&&Math.abs(e-tt)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(tt))&&Math.abs(o-it)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(it))&&Math.abs(s-rt)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(rt))&&Math.abs(h-ut)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(ut))&&Math.abs(c-ft)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(ft))&&Math.abs(l-et)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(et))&&Math.abs(a-ot)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(ot))&&Math.abs(v-st)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(st))&&Math.abs(y-ht)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(ht))&&Math.abs(p-ct)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(ct))&&Math.abs(w-lt)<=r.EPSILON*Math.max(1,Math.abs(w),Math.abs(lt))&&Math.abs(b-at)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(at))&&Math.abs(k-vt)<=r.EPSILON*Math.max(1,Math.abs(k),Math.abs(vt))};t.exports=i},{"./common.js":452}],457:[function(n,t){var f=n("./common.js"),e=n("./mat3.js"),u=n("./vec3.js"),r=n("./vec4.js"),i={};i.create=function(){var n=new f.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};i.rotationTo=function(){var n=u.create(),t=u.fromValues(1,0,0),r=u.fromValues(0,1,0);return function(f,e,o){var s=u.dot(e,o);return s<-.999999?(u.cross(n,t,e),u.length(n)<1e-6&&u.cross(n,r,e),u.normalize(n,n),i.setAxisAngle(f,n,Math.PI),f):s>.999999?(f[0]=0,f[1]=0,f[2]=0,f[3]=1,f):(u.cross(n,e,o),f[0]=n[0],f[1]=n[1],f[2]=n[2],f[3]=1+s,i.normalize(f,f))}}();i.setAxes=function(){var n=e.create();return function(t,r,u,f){return n[0]=u[0],n[3]=u[1],n[6]=u[2],n[1]=f[0],n[4]=f[1],n[7]=f[2],n[2]=-r[0],n[5]=-r[1],n[8]=-r[2],i.normalize(t,i.fromMat3(t,n))}}();i.clone=r.clone;i.fromValues=r.fromValues;i.copy=r.copy;i.set=r.set;i.identity=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};i.setAxisAngle=function(n,t,i){i=i*.5;var r=Math.sin(i);return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=Math.cos(i),n};i.getAxisAngle=function(n,t){var r=Math.acos(t[3])*2,i=Math.sin(r/2);return i!=0?(n[0]=t[0]/i,n[1]=t[1]/i,n[2]=t[2]/i):(n[0]=1,n[1]=0,n[2]=0),r};i.add=r.add;i.multiply=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3],o=i[0],s=i[1],h=i[2],c=i[3];return n[0]=r*c+e*o+u*h-f*s,n[1]=u*c+e*s+f*o-r*h,n[2]=f*c+e*h+r*s-u*o,n[3]=e*c-r*o-u*s-f*h,n};i.mul=i.multiply;i.scale=r.scale;i.rotateX=function(n,t,i){i*=.5;var f=t[0],e=t[1],o=t[2],s=t[3],r=Math.sin(i),u=Math.cos(i);return n[0]=f*u+s*r,n[1]=e*u+o*r,n[2]=o*u-e*r,n[3]=s*u-f*r,n};i.rotateY=function(n,t,i){i*=.5;var f=t[0],e=t[1],o=t[2],s=t[3],r=Math.sin(i),u=Math.cos(i);return n[0]=f*u-o*r,n[1]=e*u+s*r,n[2]=o*u+f*r,n[3]=s*u-e*r,n};i.rotateZ=function(n,t,i){i*=.5;var f=t[0],e=t[1],o=t[2],s=t[3],r=Math.sin(i),u=Math.cos(i);return n[0]=f*u+e*r,n[1]=e*u-f*r,n[2]=o*u+s*r,n[3]=s*u-o*r,n};i.calculateW=function(n,t){var i=t[0],r=t[1],u=t[2];return n[0]=i,n[1]=r,n[2]=u,n[3]=Math.sqrt(Math.abs(1-i*i-r*r-u*u)),n};i.dot=r.dot;i.lerp=r.lerp;i.slerp=function(n,t,i,r){var v=t[0],y=t[1],p=t[2],w=t[3],o=i[0],s=i[1],h=i[2],c=i[3],l,u,a,f,e;return u=v*o+y*s+p*h+w*c,u<0&&(u=-u,o=-o,s=-s,h=-h,c=-c),1-u>1e-6?(l=Math.acos(u),a=Math.sin(l),f=Math.sin((1-r)*l)/a,e=Math.sin(r*l)/a):(f=1-r,e=r),n[0]=f*v+e*o,n[1]=f*y+e*s,n[2]=f*p+e*h,n[3]=f*w+e*c,n};i.sqlerp=function(){var n=i.create(),t=i.create();return function(r,u,f,e,o,s){return i.slerp(n,u,o,s),i.slerp(t,f,e,s),i.slerp(r,n,t,2*s*(1-s)),r}}();i.invert=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],o=r*r+u*u+f*f+e*e,i=o?1/o:0;return n[0]=-r*i,n[1]=-u*i,n[2]=-f*i,n[3]=e*i,n};i.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n};i.length=r.length;i.len=i.length;i.squaredLength=r.squaredLength;i.sqrLen=i.squaredLength;i.normalize=r.normalize;i.fromMat3=function(n,t){var e=t[0]+t[4]+t[8],i,r,u,f;return e>0?(i=Math.sqrt(e+1),n[3]=.5*i,i=.5/i,n[0]=(t[5]-t[7])*i,n[1]=(t[6]-t[2])*i,n[2]=(t[1]-t[3])*i):(r=0,t[4]>t[0]&&(r=1),t[8]>t[r*3+r]&&(r=2),u=(r+1)%3,f=(r+2)%3,i=Math.sqrt(t[r*3+r]-t[u*3+u]-t[f*3+f]+1),n[r]=.5*i,i=.5/i,n[3]=(t[u*3+f]-t[f*3+u])*i,n[u]=(t[u*3+r]+t[r*3+u])*i,n[f]=(t[f*3+r]+t[r*3+f])*i),n};i.str=function(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};i.exactEquals=r.exactEquals;i.equals=r.equals;t.exports=i},{"./common.js":452,"./mat3.js":455,"./vec3.js":459,"./vec4.js":460}],458:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(2);return n[0]=0,n[1]=0,n};i.clone=function(n){var t=new r.ARRAY_TYPE(2);return t[0]=n[0],t[1]=n[1],t};i.fromValues=function(n,t){var i=new r.ARRAY_TYPE(2);return i[0]=n,i[1]=t,i};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n};i.set=function(n,t,i){return n[0]=t,n[1]=i,n};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n};i.sub=i.subtract;i.multiply=function(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n};i.mul=i.multiply;i.divide=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n};i.div=i.divide;i.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n};i.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n};i.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n};i.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n};i.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n};i.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n};i.scaleAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n};i.distance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1];return Math.sqrt(i*i+r*r)};i.dist=i.distance;i.squaredDistance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1];return i*i+r*r};i.sqrDist=i.squaredDistance;i.length=function(n){var t=n[0],i=n[1];return Math.sqrt(t*t+i*i)};i.len=i.length;i.squaredLength=function(n){var t=n[0],i=n[1];return t*t+i*i};i.sqrLen=i.squaredLength;i.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n};i.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n};i.normalize=function(n,t){var r=t[0],u=t[1],i=r*r+u*u;return i>0&&(i=1/Math.sqrt(i),n[0]=t[0]*i,n[1]=t[1]*i),n};i.dot=function(n,t){return n[0]*t[0]+n[1]*t[1]};i.cross=function(n,t,i){var r=t[0]*i[1]-t[1]*i[0];return n[0]=n[1]=0,n[2]=r,n};i.lerp=function(n,t,i,r){var u=t[0],f=t[1];return n[0]=u+r*(i[0]-u),n[1]=f+r*(i[1]-f),n};i.random=function(n,t){t=t||1;var i=r.RANDOM()*2*Math.PI;return n[0]=Math.cos(i)*t,n[1]=Math.sin(i)*t,n};i.transformMat2=function(n,t,i){var r=t[0],u=t[1];return n[0]=i[0]*r+i[2]*u,n[1]=i[1]*r+i[3]*u,n};i.transformMat2d=function(n,t,i){var r=t[0],u=t[1];return n[0]=i[0]*r+i[2]*u+i[4],n[1]=i[1]*r+i[3]*u+i[5],n};i.transformMat3=function(n,t,i){var r=t[0],u=t[1];return n[0]=i[0]*r+i[3]*u+i[6],n[1]=i[1]*r+i[4]*u+i[7],n};i.transformMat4=function(n,t,i){var r=t[0],u=t[1];return n[0]=i[0]*r+i[4]*u+i[12],n[1]=i[1]*r+i[5]*u+i[13],n};i.forEach=function(){var n=i.create();return function(t,i,r,u,f,e){var o,s;for(i||(i=2),r||(r=0),s=u?Math.min(u*i+r,t.length):t.length,o=r;o<s;o+=i)n[0]=t[o],n[1]=t[o+1],f(n,n,e),t[o]=n[0],t[o+1]=n[1];return t}}();i.str=function(n){return"vec2("+n[0]+", "+n[1]+")"};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]};i.equals=function(n,t){var i=n[0],u=n[1],f=t[0],e=t[1];return Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(u-e)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(e))};t.exports=i},{"./common.js":452}],459:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(3);return n[0]=0,n[1]=0,n[2]=0,n};i.clone=function(n){var t=new r.ARRAY_TYPE(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t};i.fromValues=function(n,t,i){var u=new r.ARRAY_TYPE(3);return u[0]=n,u[1]=t,u[2]=i,u};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n};i.set=function(n,t,i,r){return n[0]=t,n[1]=i,n[2]=r,n};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n};i.sub=i.subtract;i.multiply=function(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n};i.mul=i.multiply;i.divide=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n};i.div=i.divide;i.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n[2]=Math.ceil(t[2]),n};i.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n[2]=Math.floor(t[2]),n};i.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n};i.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n};i.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n[2]=Math.round(t[2]),n};i.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n};i.scaleAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n};i.distance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1],u=t[2]-n[2];return Math.sqrt(i*i+r*r+u*u)};i.dist=i.distance;i.squaredDistance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1],u=t[2]-n[2];return i*i+r*r+u*u};i.sqrDist=i.squaredDistance;i.length=function(n){var t=n[0],i=n[1],r=n[2];return Math.sqrt(t*t+i*i+r*r)};i.len=i.length;i.squaredLength=function(n){var t=n[0],i=n[1],r=n[2];return t*t+i*i+r*r};i.sqrLen=i.squaredLength;i.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n};i.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n[2]=1/t[2],n};i.normalize=function(n,t){var r=t[0],u=t[1],f=t[2],i=r*r+u*u+f*f;return i>0&&(i=1/Math.sqrt(i),n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i),n};i.dot=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]};i.cross=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=i[0],o=i[1],s=i[2];return n[0]=u*s-f*o,n[1]=f*e-r*s,n[2]=r*o-u*e,n};i.lerp=function(n,t,i,r){var u=t[0],f=t[1],e=t[2];return n[0]=u+r*(i[0]-u),n[1]=f+r*(i[1]-f),n[2]=e+r*(i[2]-e),n};i.hermite=function(n,t,i,r,u,f){var e=f*f,o=e*(2*f-3)+1,s=e*(f-2)+f,h=e*(f-1),c=e*(3-2*f);return n[0]=t[0]*o+i[0]*s+r[0]*h+u[0]*c,n[1]=t[1]*o+i[1]*s+r[1]*h+u[1]*c,n[2]=t[2]*o+i[2]*s+r[2]*h+u[2]*c,n};i.bezier=function(n,t,i,r,u,f){var e=1-f,l=e*e,a=f*f,o=l*e,s=3*f*l,h=3*a*e,c=a*f;return n[0]=t[0]*o+i[0]*s+r[0]*h+u[0]*c,n[1]=t[1]*o+i[1]*s+r[1]*h+u[1]*c,n[2]=t[2]*o+i[2]*s+r[2]*h+u[2]*c,n};i.random=function(n,t){t=t||1;var u=r.RANDOM()*2*Math.PI,i=r.RANDOM()*2-1,f=Math.sqrt(1-i*i)*t;return n[0]=Math.cos(u)*f,n[1]=Math.sin(u)*f,n[2]=i*t,n};i.transformMat4=function(n,t,i){var u=t[0],f=t[1],e=t[2],r=i[3]*u+i[7]*f+i[11]*e+i[15];return r=r||1,n[0]=(i[0]*u+i[4]*f+i[8]*e+i[12])/r,n[1]=(i[1]*u+i[5]*f+i[9]*e+i[13])/r,n[2]=(i[2]*u+i[6]*f+i[10]*e+i[14])/r,n};i.transformMat3=function(n,t,i){var r=t[0],u=t[1],f=t[2];return n[0]=r*i[0]+u*i[3]+f*i[6],n[1]=r*i[1]+u*i[4]+f*i[7],n[2]=r*i[2]+u*i[5]+f*i[8],n};i.transformQuat=function(n,t,i){var o=t[0],s=t[1],h=t[2],r=i[0],u=i[1],f=i[2],e=i[3],c=e*o+u*h-f*s,l=e*s+f*o-r*h,a=e*h+r*s-u*o,v=-r*o-u*s-f*h;return n[0]=c*e+v*-r+l*-f-a*-u,n[1]=l*e+v*-u+a*-r-c*-f,n[2]=a*e+v*-f+c*-u-l*-r,n};i.rotateX=function(n,t,i,r){var u=[],f=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],f[0]=u[0],f[1]=u[1]*Math.cos(r)-u[2]*Math.sin(r),f[2]=u[1]*Math.sin(r)+u[2]*Math.cos(r),n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n};i.rotateY=function(n,t,i,r){var u=[],f=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],f[0]=u[2]*Math.sin(r)+u[0]*Math.cos(r),f[1]=u[1],f[2]=u[2]*Math.cos(r)-u[0]*Math.sin(r),n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n};i.rotateZ=function(n,t,i,r){var u=[],f=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],f[0]=u[0]*Math.cos(r)-u[1]*Math.sin(r),f[1]=u[0]*Math.sin(r)+u[1]*Math.cos(r),f[2]=u[2],n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n};i.forEach=function(){var n=i.create();return function(t,i,r,u,f,e){var o,s;for(i||(i=3),r||(r=0),s=u?Math.min(u*i+r,t.length):t.length,o=r;o<s;o+=i)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],f(n,n,e),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2];return t}}();i.angle=function(n,t){var r=i.fromValues(n[0],n[1],n[2]),u=i.fromValues(t[0],t[1],t[2]),f;return i.normalize(r,r),i.normalize(u,u),f=i.dot(r,u),f>1?0:Math.acos(f)};i.str=function(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=t[0],o=t[1],s=t[2];return Math.abs(i-e)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))&&Math.abs(u-o)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(o))&&Math.abs(f-s)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(s))};t.exports=i},{"./common.js":452}],460:[function(n,t){var r=n("./common.js"),i={};i.create=function(){var n=new r.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n};i.clone=function(n){var t=new r.ARRAY_TYPE(4);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t};i.fromValues=function(n,t,i,u){var f=new r.ARRAY_TYPE(4);return f[0]=n,f[1]=t,f[2]=i,f[3]=u,f};i.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n};i.set=function(n,t,i,r,u){return n[0]=t,n[1]=i,n[2]=r,n[3]=u,n};i.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n};i.subtract=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n};i.sub=i.subtract;i.multiply=function(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n[3]=t[3]*i[3],n};i.mul=i.multiply;i.divide=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n[3]=t[3]/i[3],n};i.div=i.divide;i.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n[2]=Math.ceil(t[2]),n[3]=Math.ceil(t[3]),n};i.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n[2]=Math.floor(t[2]),n[3]=Math.floor(t[3]),n};i.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n[3]=Math.min(t[3],i[3]),n};i.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n[3]=Math.max(t[3],i[3]),n};i.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n[2]=Math.round(t[2]),n[3]=Math.round(t[3]),n};i.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n};i.scaleAndAdd=function(n,t,i,r){return n[0]=t[0]+i[0]*r,n[1]=t[1]+i[1]*r,n[2]=t[2]+i[2]*r,n[3]=t[3]+i[3]*r,n};i.distance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1],u=t[2]-n[2],f=t[3]-n[3];return Math.sqrt(i*i+r*r+u*u+f*f)};i.dist=i.distance;i.squaredDistance=function(n,t){var i=t[0]-n[0],r=t[1]-n[1],u=t[2]-n[2],f=t[3]-n[3];return i*i+r*r+u*u+f*f};i.sqrDist=i.squaredDistance;i.length=function(n){var t=n[0],i=n[1],r=n[2],u=n[3];return Math.sqrt(t*t+i*i+r*r+u*u)};i.len=i.length;i.squaredLength=function(n){var t=n[0],i=n[1],r=n[2],u=n[3];return t*t+i*i+r*r+u*u};i.sqrLen=i.squaredLength;i.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n};i.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n[2]=1/t[2],n[3]=1/t[3],n};i.normalize=function(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],i=r*r+u*u+f*f+e*e;return i>0&&(i=1/Math.sqrt(i),n[0]=r*i,n[1]=u*i,n[2]=f*i,n[3]=e*i),n};i.dot=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]};i.lerp=function(n,t,i,r){var u=t[0],f=t[1],e=t[2],o=t[3];return n[0]=u+r*(i[0]-u),n[1]=f+r*(i[1]-f),n[2]=e+r*(i[2]-e),n[3]=o+r*(i[3]-o),n};i.random=function(n,t){return t=t||1,n[0]=r.RANDOM(),n[1]=r.RANDOM(),n[2]=r.RANDOM(),n[3]=r.RANDOM(),i.normalize(n,n),i.scale(n,n,t),n};i.transformMat4=function(n,t,i){var r=t[0],u=t[1],f=t[2],e=t[3];return n[0]=i[0]*r+i[4]*u+i[8]*f+i[12]*e,n[1]=i[1]*r+i[5]*u+i[9]*f+i[13]*e,n[2]=i[2]*r+i[6]*u+i[10]*f+i[14]*e,n[3]=i[3]*r+i[7]*u+i[11]*f+i[15]*e,n};i.transformQuat=function(n,t,i){var o=t[0],s=t[1],h=t[2],r=i[0],u=i[1],f=i[2],e=i[3],c=e*o+u*h-f*s,l=e*s+f*o-r*h,a=e*h+r*s-u*o,v=-r*o-u*s-f*h;return n[0]=c*e+v*-r+l*-f-a*-u,n[1]=l*e+v*-u+a*-r-c*-f,n[2]=a*e+v*-f+c*-u-l*-r,n[3]=t[3],n};i.forEach=function(){var n=i.create();return function(t,i,r,u,f,e){var o,s;for(i||(i=4),r||(r=0),s=u?Math.min(u*i+r,t.length):t.length,o=r;o<s;o+=i)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],n[3]=t[o+3],f(n,n,e),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2],t[o+3]=n[3];return t}}();i.str=function(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};i.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]};i.equals=function(n,t){var i=n[0],u=n[1],f=n[2],e=n[3],o=t[0],s=t[1],h=t[2],c=t[3];return Math.abs(i-o)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(u-s)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(s))&&Math.abs(f-h)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(h))&&Math.abs(e-c)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(c))};t.exports=i},{"./common.js":452}],461:[function(n,t){"use strict";function i(n,t,i){var e=this.cells=[],u,f,o,s,a,h,c,l;if(n instanceof ArrayBuffer){for(this.arrayBuffer=n,u=new Int32Array(this.arrayBuffer),n=u[0],t=u[1],i=u[2],this.d=t+2*i,f=0;f<this.d*this.d;f++)o=u[r+f],s=u[r+f+1],e.push(o===s?null:u.subarray(o,s));a=u[r+e.length];h=u[r+e.length+1];this.keys=u.subarray(a,h);this.bboxes=u.subarray(h);this.insert=this._insertReadonly}else{for(this.d=t+2*i,c=0;c<this.d*this.d;c++)e.push([]);this.keys=[];this.bboxes=[]}this.n=t;this.extent=n;this.padding=i;this.scale=t/n;this.uid=0;l=i/t*n;this.min=-l;this.max=n+l}t.exports=i;var r=3;i.prototype.insert=function(n,t,i,r,u){this._forEachCell(t,i,r,u,this._insertCell,this.uid++);this.keys.push(n);this.bboxes.push(t);this.bboxes.push(i);this.bboxes.push(r);this.bboxes.push(u)};i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer.";};i.prototype._insertCell=function(n,t,i,r,u,f){this.cells[u].push(f)};i.prototype.query=function(n,t,i,r){var f=this.min,e=this.max,u,o;return n<=f&&t<=f&&e<=i&&e<=r?Array.prototype.slice.call(this.keys):(u=[],o={},this._forEachCell(n,t,i,r,this._queryCell,u,o),u)};i.prototype._queryCell=function(n,t,i,r,u,f,e){var l=this.cells[u],a,s,c,o,h;if(l!==null)for(a=this.keys,s=this.bboxes,c=0;c<l.length;c++)o=l[c],e[o]===undefined&&(h=o*4,n<=s[h+2]&&t<=s[h+3]&&i>=s[h+0]&&r>=s[h+1]?(e[o]=!0,f.push(a[o])):e[o]=!1)};i.prototype._forEachCell=function(n,t,i,r,u,f,e){for(var o,h,c=this._convertToCellCoord(n),l=this._convertToCellCoord(t),a=this._convertToCellCoord(i),v=this._convertToCellCoord(r),s=c;s<=a;s++)for(o=l;o<=v;o++)if(h=this.d*o+s,u.call(this,n,t,i,r,h,f,e))return};i.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))};i.prototype.toArrayBuffer=function(){var f,n,t,i,e;if(this.arrayBuffer)return this.arrayBuffer;var u=this.cells,o=r+this.cells.length+1+1,s=0;for(f=0;f<this.cells.length;f++)s+=this.cells[f].length;for(n=new Int32Array(o+s+this.keys.length+this.bboxes.length),n[0]=this.extent,n[1]=this.n,n[2]=this.padding,t=o,i=0;i<u.length;i++)e=u[i],n[r+i]=t,n.set(e,t),t+=e.length;return n[r+u.length]=t,n.set(this.keys,t),t+=this.keys.length,n[r+u.length+1]=t,n.set(this.bboxes,t),t+=this.bboxes.length,n.buffer}},{}],462:[function(n,t){"use strict";function i(n,t){var u,f,y,a,h,p;if(e(n)){var v=typeof n.stops[0][0]=="object",w=v||n.property!==undefined,b=v||!w,l=n.type||t||"exponential",c;if(l==="exponential")c=r;else if(l==="interval")c=s;else if(l==="categorical")c=o;else throw new Error('Unknown function type "'+l+'"');if(v){for(f={},y=[],a=0;a<n.stops.length;a++)h=n.stops[a],f[h[0].zoom]===undefined&&(f[h[0].zoom]={zoom:h[0].zoom,type:n.type,property:n.property,stops:[]}),f[h[0].zoom].stops.push([h[0].value,h[1]]);for(p in f)y.push([f[p].zoom,i(f[p])]);u=function(t,i){return r({stops:y,base:n.base},t)(t,i)};u.isFeatureConstant=!1;u.isZoomConstant=!1}else b?(u=function(t){return c(n,t)},u.isFeatureConstant=!0,u.isZoomConstant=!1):(u=function(t,i){return c(n,i[n.property])},u.isFeatureConstant=!1,u.isZoomConstant=!0)}else u=function(){return n},u.isFeatureConstant=!0,u.isZoomConstant=!0;return u}function o(n,t){for(var i=0;i<n.stops.length;i++)if(t===n.stops[i][0])return n.stops[i][1];return n.stops[0][1]}function s(n,t){for(var i=0;i<n.stops.length;i++)if(t<n.stops[i][0])break;return n.stops[Math.max(i-1,0)][1]}function r(n,t){for(var r=n.base!==undefined?n.base:1,i=0;;)if(i>=n.stops.length)break;else if(t<=n.stops[i][0])break;else i++;return i===0?n.stops[i][1]:i===n.stops.length?n.stops[i-1][1]:u(t,r,n.stops[i-1][0],n.stops[i][0],n.stops[i-1][1],n.stops[i][1])}function u(n,t,i,r,e,o){return typeof e=="function"?function(){var f=e.apply(undefined,arguments),s=o.apply(undefined,arguments);return u(n,t,i,r,f,s)}:e.length?h(n,t,i,r,e,o):f(n,t,i,r,e,o)}function f(n,t,i,r,u,f){var o=r-i,s=n-i,e;return e=t===1?s/o:(Math.pow(t,s)-1)/(Math.pow(t,o)-1),u*(1-e)+f*e}function h(n,t,i,r,u,e){for(var s=[],o=0;o<u.length;o++)s[o]=f(n,t,i,r,u[o],e[o]);return s}function e(n){return typeof n=="object"&&n.stops}t.exports.isFunctionDefinition=e;t.exports.interpolated=function(n){return i(n,"exponential")};t.exports["piecewise-constant"]=function(n){return i(n,"interval")}},{}],463:[function(n,t){var i=n("path");t.exports={debug:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform lowp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\n}\n"},fill:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n#pragma mapbox: define lowp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define lowp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},circle:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n#pragma mapbox: define lowp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_extrude;\nvarying lowp float v_antialiasblur;\n\nvoid main() {\n    #pragma mapbox: initialize lowp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    float t = smoothstep(1.0 - max(blur, v_antialiasblur), 1.0, length(v_extrude));\n    gl_FragColor = color * (1.0 - t) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform vec2 u_extrude_scale;\nuniform float u_devicepixelratio;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define lowp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_extrude;\nvarying lowp float v_antialiasblur;\n\nvoid main(void) {\n    #pragma mapbox: initialize lowp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    v_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5), 0, 1);\n\n    if (u_scale_with_map) {\n        gl_Position.xy += extrude;\n    } else {\n        gl_Position.xy += extrude * gl_Position.w;\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    v_antialiasblur = 1.0 / u_devicepixelratio / radius;\n}\n"},line:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform lowp vec4 u_color;\nuniform lowp float u_opacity;\nuniform float u_blur;\n\nvarying vec2 v_linewidth;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_linewidth.t - blur), v_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    gl_FragColor = u_color * (alpha * u_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform mediump float u_linewidth;\nuniform mediump float u_gapwidth;\nuniform mediump float u_antialiasing;\nuniform mediump float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\nuniform mediump float u_blur;\n\nvarying vec2 v_normal;\nvarying vec2 v_linewidth;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    float inset = u_gapwidth + (u_gapwidth > 0.0 ? u_antialiasing : 0.0);\n    float outset = u_gapwidth + u_linewidth * (u_gapwidth > 0.0 ? 2.0 : 1.0) + u_antialiasing;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist) / u_ratio, 0.0, 1.0);\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_linewidth = vec2(outset, inset);\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"},linepattern:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform float u_blur;\n\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform float u_fade;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_linewidth;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_linewidth.t - blur), v_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * v_linewidth.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * v_linewidth.s / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a, u_pattern_br_a, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b, u_pattern_br_b, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    alpha *= u_opacity;\n\n    gl_FragColor = color * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform mediump float u_linewidth;\nuniform mediump float u_gapwidth;\nuniform mediump float u_antialiasing;\nuniform mediump float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\n\nvarying vec2 v_normal;\nvarying vec2 v_linewidth;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    float inset = u_gapwidth + (u_gapwidth > 0.0 ? u_antialiasing : 0.0);\n    float outset = u_gapwidth + u_linewidth * (u_gapwidth > 0.0 ? 2.0 : 1.0) + u_antialiasing;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist) / u_ratio, 0.0, 1.0);\n    v_linesofar = a_linesofar;\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_linewidth = vec2(outset, inset);\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"},linesdfpattern:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform lowp vec4 u_color;\nuniform lowp float u_opacity;\n\nuniform float u_blur;\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_linewidth;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\nvoid main() {\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_linewidth.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_linewidth.t) or when fading out\n    // (v_linewidth.s)\n    float blur = u_blur * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_linewidth.t - blur), v_linewidth.s - dist) / blur, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma, 0.5 + u_sdfgamma, sdfdist);\n\n    gl_FragColor = u_color * (alpha * u_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform mediump float u_linewidth;\nuniform mediump float u_gapwidth;\nuniform mediump float u_antialiasing;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform float u_extra;\nuniform mat2 u_antialiasingmatrix;\nuniform mediump float u_offset;\n\nvarying vec2 v_normal;\nvarying vec2 v_linewidth;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    float inset = u_gapwidth + (u_gapwidth > 0.0 ? u_antialiasing : 0.0);\n    float outset = u_gapwidth + u_linewidth * (u_gapwidth > 0.0 ? 2.0 : 1.0) + u_antialiasing;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset = u_offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit of the position before scaling it with the\n    // model/view matrix.\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5) + (offset + dist) / u_ratio, 0.0, 1.0);\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    // position of y on the screen\n    float y = gl_Position.y / gl_Position.w;\n\n    // how much features are squished in the y direction by the tilt\n    float squish_scale = length(a_extrude) / length(u_antialiasingmatrix * a_extrude);\n\n    // how much features are squished in all directions by the perspectiveness\n    float perspective_scale = 1.0 / (1.0 - min(y * u_extra, 0.9));\n\n    v_linewidth = vec2(outset, inset);\n    v_gamma_scale = perspective_scale * squish_scale;\n}\n"},outline:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\n#pragma mapbox: define lowp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize lowp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = smoothstep(1.0, 0.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},outlinepattern:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform float u_opacity;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a, u_pattern_br_a, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b, u_pattern_br_b, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = smoothstep(1.0, 0.0, dist);\n    \n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    vec2 scaled_size_a = u_scale_a * u_pattern_size_a;\n    vec2 scaled_size_b = u_scale_b * u_pattern_size_b;\n\n    // the correct offset needs to be calculated.\n    //\n    // The offset depends on how many pixels are between the world origin and\n    // the edge of the tile:\n    // vec2 offset = mod(pixel_coord, size)\n    //\n    // At high zoom levels there are a ton of pixels between the world origin\n    // and the edge of the tile. The glsl spec only guarantees 16 bits of\n    // precision for highp floats. We need more than that.\n    //\n    // The pixel_coord is passed in as two 16 bit values:\n    // pixel_coord_upper = floor(pixel_coord / 2^16)\n    // pixel_coord_lower = mod(pixel_coord, 2^16)\n    //\n    // The offset is calculated in a series of steps that should preserve this precision:\n    vec2 offset_a = mod(mod(mod(u_pixel_coord_upper, scaled_size_a) * 256.0, scaled_size_a) * 256.0 + u_pixel_coord_lower, scaled_size_a);\n    vec2 offset_b = mod(mod(mod(u_pixel_coord_upper, scaled_size_b) * 256.0, scaled_size_b) * 256.0 + u_pixel_coord_lower, scaled_size_b);\n\n    v_pos_a = (u_tile_units_to_pixels * a_pos + offset_a) / scaled_size_a;\n    v_pos_b = (u_tile_units_to_pixels * a_pos + offset_b) / scaled_size_b;\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},pattern:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform float u_opacity;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a, u_pattern_br_a, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b, u_pattern_br_b, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    vec2 scaled_size_a = u_scale_a * u_pattern_size_a;\n    vec2 scaled_size_b = u_scale_b * u_pattern_size_b;\n\n    // the correct offset needs to be calculated.\n    //\n    // The offset depends on how many pixels are between the world origin and\n    // the edge of the tile:\n    // vec2 offset = mod(pixel_coord, size)\n    //\n    // At high zoom levels there are a ton of pixels between the world origin\n    // and the edge of the tile. The glsl spec only guarantees 16 bits of\n    // precision for highp floats. We need more than that.\n    //\n    // The pixel_coord is passed in as two 16 bit values:\n    // pixel_coord_upper = floor(pixel_coord / 2^16)\n    // pixel_coord_lower = mod(pixel_coord, 2^16)\n    //\n    // The offset is calculated in a series of steps that should preserve this precision:\n    vec2 offset_a = mod(mod(mod(u_pixel_coord_upper, scaled_size_a) * 256.0, scaled_size_a) * 256.0 + u_pixel_coord_lower, scaled_size_a);\n    vec2 offset_b = mod(mod(mod(u_pixel_coord_upper, scaled_size_b) * 256.0, scaled_size_b) * 256.0 + u_pixel_coord_lower, scaled_size_b);\n\n    v_pos_a = (u_tile_units_to_pixels * a_pos + offset_a) / scaled_size_a;\n    v_pos_b = (u_tile_units_to_pixels * a_pos + offset_b) / scaled_size_b;\n}\n"},raster:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform float u_opacity0;\nuniform float u_opacity1;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    vec4 color = color0 * u_opacity0 + color1 * u_opacity1;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb), color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},icon:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\nuniform lowp float u_opacity;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * u_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_texture_pos;\nattribute vec4 a_data;\n\n\n// matrix is for the vertex position.\nuniform mat4 u_matrix;\n\nuniform mediump float u_zoom;\nuniform bool u_rotate_with_map;\nuniform vec2 u_extrude_scale;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    vec2 a_tex = a_texture_pos.xy;\n    mediump float a_labelminzoom = a_data[0];\n    mediump vec2 a_zoom = a_data.pq;\n    mediump float a_minzoom = a_zoom[0];\n    mediump float a_maxzoom = a_zoom[1];\n\n    // u_zoom is the current zoom level adjusted for the change in font size\n    mediump float z = 2.0 - step(a_minzoom, u_zoom) - (1.0 - step(a_maxzoom, u_zoom));\n\n    vec2 extrude = u_extrude_scale * (a_offset / 64.0);\n    if (u_rotate_with_map) {\n        gl_Position = u_matrix * vec4(a_pos + extrude, 0, 1);\n        gl_Position.z += z * gl_Position.w;\n    } else {\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\n    }\n\n    v_tex = a_tex / u_texsize;\n    v_fade_tex = vec2(a_labelminzoom / 255.0, 0.0);\n}\n"},sdf:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\nuniform lowp vec4 u_color;\nuniform lowp float u_opacity;\nuniform lowp float u_buffer;\nuniform lowp float u_gamma;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\nvarying float v_gamma_scale;\n\nvoid main() {\n    lowp float dist = texture2D(u_texture, v_tex).a;\n    lowp float fade_alpha = texture2D(u_fadetexture, v_fade_tex).a;\n    lowp float gamma = u_gamma * v_gamma_scale;\n    lowp float alpha = smoothstep(u_buffer - gamma, u_buffer + gamma, dist) * fade_alpha;\n\n    gl_FragColor = u_color * (alpha * u_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nconst float PI = 3.141592653589793;\n\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_texture_pos;\nattribute vec4 a_data;\n\n\n// matrix is for the vertex position.\nuniform mat4 u_matrix;\n\nuniform mediump float u_zoom;\nuniform bool u_rotate_with_map;\nuniform bool u_pitch_with_map;\nuniform mediump float u_pitch;\nuniform mediump float u_bearing;\nuniform mediump float u_aspect_ratio;\nuniform vec2 u_extrude_scale;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\nvarying float v_gamma_scale;\n\nvoid main() {\n    vec2 a_tex = a_texture_pos.xy;\n    mediump float a_labelminzoom = a_data[0];\n    mediump vec2 a_zoom = a_data.pq;\n    mediump float a_minzoom = a_zoom[0];\n    mediump float a_maxzoom = a_zoom[1];\n\n    // u_zoom is the current zoom level adjusted for the change in font size\n    mediump float z = 2.0 - step(a_minzoom, u_zoom) - (1.0 - step(a_maxzoom, u_zoom));\n\n    // pitch-alignment: map\n    // rotation-alignment: map | viewport\n    if (u_pitch_with_map) {\n        lowp float angle = u_rotate_with_map ? (a_data[1] / 256.0 * 2.0 * PI) : u_bearing;\n        lowp float asin = sin(angle);\n        lowp float acos = cos(angle);\n        mat2 RotationMatrix = mat2(acos, asin, -1.0 * asin, acos);\n        vec2 offset = RotationMatrix * a_offset;\n        vec2 extrude = u_extrude_scale * (offset / 64.0);\n        gl_Position = u_matrix * vec4(a_pos + extrude, 0, 1);\n        gl_Position.z += z * gl_Position.w;\n    // pitch-alignment: viewport\n    // rotation-alignment: map\n    } else if (u_rotate_with_map) {\n        // foreshortening factor to apply on pitched maps\n        // as a label goes from horizontal <=> vertical in angle\n        // it goes from 0% foreshortening to up to around 70% foreshortening\n        lowp float pitchfactor = 1.0 - cos(u_pitch * sin(u_pitch * 0.75));\n\n        lowp float lineangle = a_data[1] / 256.0 * 2.0 * PI;\n\n        // use the lineangle to position points a,b along the line\n        // project the points and calculate the label angle in projected space\n        // this calculation allows labels to be rendered unskewed on pitched maps\n        vec4 a = u_matrix * vec4(a_pos, 0, 1);\n        vec4 b = u_matrix * vec4(a_pos + vec2(cos(lineangle),sin(lineangle)), 0, 1);\n        lowp float angle = atan((b[1]/b[3] - a[1]/a[3])/u_aspect_ratio, b[0]/b[3] - a[0]/a[3]);\n        lowp float asin = sin(angle);\n        lowp float acos = cos(angle);\n        mat2 RotationMatrix = mat2(acos, -1.0 * asin, asin, acos);\n\n        vec2 offset = RotationMatrix * (vec2((1.0-pitchfactor)+(pitchfactor*cos(angle*2.0)), 1.0) * a_offset);\n        vec2 extrude = u_extrude_scale * (offset / 64.0);\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\n        gl_Position.z += z * gl_Position.w;\n    // pitch-alignment: viewport\n    // rotation-alignment: viewport\n    } else {\n        vec2 extrude = u_extrude_scale * (a_offset / 64.0);\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\n    }\n\n    v_gamma_scale = (gl_Position.w - 0.5);\n\n    v_tex = a_tex / u_texsize;\n    v_fade_tex = vec2(a_labelminzoom / 255.0, 0.0);\n}\n"},collisionbox:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\n\n    if (v_placement_zoom > u_zoom) {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n    }\n\n    if (u_zoom >= v_max_zoom) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\n    }\n\n    if (v_placement_zoom >= u_maxzoom) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\n    }\n}\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#define lowp\n#define mediump\n#define highp\n#endif\n\nattribute vec2 a_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_scale;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos + a_extrude / u_scale, 0.0, 1.0);\n\n    v_max_zoom = a_data.x;\n    v_placement_zoom = a_data.y;\n}\n"}};t.exports.util="float evaluate_zoom_function_1(const vec4 values, const float t) {\n    if (t < 1.0) {\n        return mix(values[0], values[1], t);\n    } else if (t < 2.0) {\n        return mix(values[1], values[2], t - 1.0);\n    } else {\n        return mix(values[2], values[3], t - 2.0);\n    }\n}\nvec4 evaluate_zoom_function_4(const vec4 value0, const vec4 value1, const vec4 value2, const vec4 value3, const float t) {\n    if (t < 1.0) {\n        return mix(value0, value1, t);\n    } else if (t < 2.0) {\n        return mix(value1, value2, t - 1.0);\n    } else {\n        return mix(value2, value3, t - 2.0);\n    }\n}\n"},{path:63}],464:[function(n,t){"use strict";function r(n,t){this.message=(n?n+": ":"")+i.apply(i,Array.prototype.slice.call(arguments,2));t!==null&&t!==undefined&&t.__line__&&(this.line=t.__line__)}var i=n("util").format;t.exports=r},{util:72}],465:[function(n,t){"use strict";t.exports=function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)n[r]=i[r]}return n}},{}],466:[function(n,t){"use strict";t.exports=function(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}},{}],467:[function(n,t){"use strict";t.exports=function(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}},{}],468:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/get_type"),u=n("../util/extend");t.exports=function(t){var l=n("./validate_function"),a=n("./validate_object"),o={"*":function(){return[]},array:n("./validate_array"),boolean:n("./validate_boolean"),number:n("./validate_number"),color:n("./validate_color"),constants:n("./validate_constants"),"enum":n("./validate_enum"),filter:n("./validate_filter"),"function":n("./validate_function"),layer:n("./validate_layer"),object:n("./validate_object"),source:n("./validate_source"),string:n("./validate_string")},f=t.value,e=t.valueSpec,s=t.key,h=t.styleSpec,c=t.style;if(r(f)==="string"&&f[0]==="@"){if(h.$version>7)return[new i(s,f,"constants have been deprecated as of v8")];if(!(f in c.constants))return[new i(s,f,'constant "%s" not found',f)];t=u({},t,{value:c.constants[f]})}return e.function&&r(f)==="object"?l(t):e.type&&o[e.type]?o[e.type](t):a(u({},t,{valueSpec:e.type?h[e.type]:e}))}},{"../error/validation_error":464,"../util/extend":465,"../util/get_type":466,"./validate_array":469,"./validate_boolean":470,"./validate_color":471,"./validate_constants":472,"./validate_enum":473,"./validate_filter":474,"./validate_function":475,"./validate_layer":477,"./validate_number":479,"./validate_object":480,"./validate_source":482,"./validate_string":483}],469:[function(n,t){"use strict";var i=n("../util/get_type"),u=n("./validate"),r=n("../error/validation_error");t.exports=function(n){var t=n.value,f=n.valueSpec,l=n.style,c=n.styleSpec,o=n.key,a=n.arrayElementValidator||u,s,h,e;if(i(t)!=="array")return[new r(o,t,"array expected, %s found",i(t))];if(f.length&&t.length!==f.length)return[new r(o,t,"array length %d expected, length %d found",f.length,t.length)];if(f["min-length"]&&t.length<f["min-length"])return[new r(o,t,"array length at least %d expected, length %d found",f["min-length"],t.length)];for(s={type:f.value},c.$version<7&&(s.function=f.function),i(f.value)==="object"&&(s=f.value),h=[],e=0;e<t.length;e++)h=h.concat(a({array:t,arrayIndex:e,value:t[e],valueSpec:s,style:l,styleSpec:c,key:o+"["+e+"]"}));return h}},{"../error/validation_error":464,"../util/get_type":466,"./validate":468}],470:[function(n,t){"use strict";var i=n("../util/get_type"),r=n("../error/validation_error");t.exports=function(n){var t=n.value,f=n.key,u=i(t);return u!=="boolean"?[new r(f,t,"boolean expected, %s found",u)]:[]}},{"../error/validation_error":464,"../util/get_type":466}],471:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/get_type"),u=n("csscolorparser").parseCSSColor;t.exports=function(n){var f=n.key,t=n.value,e=r(t);return e!=="string"?[new i(f,t,"color expected, %s found",e)]:u(t)===null?[new i(f,t,'color expected, "%s" found',t)]:[]}},{"../error/validation_error":464,"../util/get_type":466,csscolorparser:437}],472:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/get_type");t.exports=function(n){var f=n.key,t=n.value,s=n.styleSpec,e,o,u;if(s.$version>7)return t?[new i(f,t,"constants have been deprecated as of v8")]:[];if(e=r(t),e!=="object")return[new i(f,t,"object expected, %s found",e)];o=[];for(u in t)u[0]!=="@"&&o.push(new i(f+"."+u,t[u],'constants must start with "@"'));return o}},{"../error/validation_error":464,"../util/get_type":466}],473:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/unbundle_jsonlint");t.exports=function(n){var e=n.key,t=n.value,u=n.valueSpec,f=[];return u.values.indexOf(r(t))===-1&&f.push(new i(e,t,"expected one of [%s], %s found",u.values.join(", "),t)),f}},{"../error/validation_error":464,"../util/unbundle_jsonlint":467}],474:[function(n,t){"use strict";var i=n("../error/validation_error"),u=n("./validate_enum"),r=n("../util/get_type"),f=n("../util/unbundle_jsonlint");t.exports=function e(n){var t=n.value,h=n.key,l=n.styleSpec,c,o=[],s;if(r(t)!=="array")return[new i(h,t,"array expected, %s found",r(t))];if(t.length<1)return[new i(h,t,"filter array must have at least 1 element")];o=o.concat(u({key:h+"[0]",value:t[0],valueSpec:l.filter_operator,style:n.style,styleSpec:n.styleSpec}));switch(f(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&t[1]=="$type"&&o.push(new i(h,t,'"$type" cannot be use with operator "%s"',t[0]));case"==":case"!=":t.length!=3&&o.push(new i(h,t,'filter array for operator "%s" must have 3 elements',t[0]));case"in":case"!in":for(t.length>=2&&(c=r(t[1]),c!=="string"?o.push(new i(h+"[1]",t[1],"string expected, %s found",c)):t[1][0]==="@"&&o.push(new i(h+"[1]",t[1],"filter key cannot be a constant"))),s=2;s<t.length;s++)c=r(t[s]),t[1]=="$type"?o=o.concat(u({key:h+"["+s+"]",value:t[s],valueSpec:l.geometry_type,style:n.style,styleSpec:n.styleSpec})):c==="string"&&t[s][0]==="@"?o.push(new i(h+"["+s+"]",t[s],"filter value cannot be a constant")):c!=="string"&&c!=="number"&&c!=="boolean"&&o.push(new i(h+"["+s+"]",t[s],"string, number, or boolean expected, %s found",c));break;case"any":case"all":case"none":for(s=1;s<t.length;s++)o=o.concat(e({key:h+"["+s+"]",value:t[s],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":c=r(t[1]);t.length!==2?o.push(new i(h,t,'filter array for "%s" operator must have 2 elements',t[0])):c!=="string"?o.push(new i(h+"[1]",t[1],"string expected, %s found",c)):t[1][0]==="@"&&o.push(new i(h+"[1]",t[1],"filter key cannot be a constant"))}return o}},{"../error/validation_error":464,"../util/get_type":466,"../util/unbundle_jsonlint":467,"./validate_enum":473}],475:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/get_type"),e=n("./validate"),u=n("./validate_object"),o=n("./validate_array"),f=n("./validate_number");t.exports=function(n){function v(n){var t=[],u=n.value;return t=t.concat(o({key:n.key,value:u,valueSpec:n.valueSpec,style:n.style,styleSpec:n.styleSpec,arrayElementValidator:y})),r(u)==="array"&&u.length===0&&t.push(new i(n.key,u,"array must have at least one stop")),t}function y(n){var a=[],o=n.value,s=n.key,v;if(r(o)!=="array")return[new i(s,o,"array expected, %s found",r(o))];if(o.length!==2)return[new i(s,o,"array length %d expected, length %d found",2,o.length)];if(v=r(o[0]),t||(t=v),v!==t)return[new i(s,o,"%s stop key type must match previous stop key type %s",v,t)];if(v==="object"){if(o[0].zoom===undefined)return[new i(s,o,"object stop key must have zoom")];if(o[0].value===undefined)return[new i(s,o,"object stop key must have value")];a=a.concat(u({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:n.style,styleSpec:n.styleSpec,objectElementValidators:{zoom:f,value:l}}))}else a=a.concat((c?f:l)({key:s+"[0]",value:o[0],valueSpec:{},style:n.style,styleSpec:n.styleSpec}));return a=a.concat(e({key:s+"[1]",value:o[1],valueSpec:h,style:n.style,styleSpec:n.styleSpec})),r(o[0])==="number"&&(h.function==="piecewise-constant"&&o[0]%1!=0&&a.push(new i(s+"[0]",o[0],"zoom level for piecewise-constant functions must be an integer")),n.arrayIndex!==0&&o[0]<n.array[n.arrayIndex-1][0]&&a.push(new i(s+"[0]",o[0],"array stops must appear in ascending order"))),a}function l(n){var u=[],t=r(n.value);return t!=="number"&&t!=="string"&&t!=="array"&&u.push(new i(n.key,n.value,"property value must be a number, string or array")),u}var h=n.valueSpec,t,a=n.value.property!==undefined||t==="object",c=n.value.property===undefined||t==="object",s=u({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:v}});return n.styleSpec.$version>=8&&(a&&!n.valueSpec["property-function"]?s.push(new i(n.key,n.value,"property functions not supported")):c&&!n.valueSpec["zoom-function"]&&s.push(new i(n.key,n.value,"zoom functions not supported"))),s}},{"../error/validation_error":464,"../util/get_type":466,"./validate":468,"./validate_array":469,"./validate_number":479,"./validate_object":480}],476:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("./validate_string");t.exports=function(n){var u=n.value,f=n.key,t=r(n);return t.length?t:(u.indexOf("{fontstack}")===-1&&t.push(new i(f,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&t.push(new i(f,u,'"glyphs" url must include a "{range}" token')),t)}},{"../error/validation_error":464,"./validate_string":483}],477:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/unbundle_jsonlint"),u=n("./validate_object"),e=n("./validate_filter"),o=n("./validate_paint_property"),s=n("./validate_layout_property"),f=n("../util/extend");t.exports=function(n){var h=[],t=n.value,c=n.key,v=n.style,k=n.styleSpec,l,w,y,b,p,a;if(t.type||t.ref||h.push(new i(c,t,'either "type" or "ref" is required')),l=r(t.type),w=r(t.ref),t.id)for(y=0;y<n.arrayIndex;y++)b=v.layers[y],r(b.id)===r(t.id)&&h.push(new i(c,t.id,'duplicate layer id "%s", previously used at line %d',t.id,b.id.__line__));return"ref"in t?(["type","source","source-layer","filter","layout"].forEach(function(n){n in t&&h.push(new i(c,t[n],'"%s" is prohibited for ref layers',n))}),v.layers.forEach(function(n){n.id==w&&(p=n)}),p?p.ref?h.push(new i(c,t.ref,"ref cannot reference another ref layer")):l=r(p.type):h.push(new i(c,t.ref,'ref layer "%s" not found',w))):l!=="background"&&(t.source?(a=v.sources&&v.sources[t.source],a?a.type=="vector"&&l=="raster"?h.push(new i(c,t.source,'layer "%s" requires a raster source',t.id)):a.type=="raster"&&l!="raster"?h.push(new i(c,t.source,'layer "%s" requires a vector source',t.id)):a.type!="vector"||t["source-layer"]||h.push(new i(c,t,'layer "%s" must specify a "source-layer"',t.id)):h.push(new i(c,t.source,'source "%s" not found',t.source))):h.push(new i(c,t,'missing required property "source"'))),h=h.concat(u({key:c,value:t,valueSpec:k.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{filter:e,layout:function(n){return u({layer:t,key:n.key,value:n.value,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":function(n){return s(f({layerType:l},n))}}})},paint:function(n){return u({layer:t,key:n.key,value:n.value,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":function(n){return o(f({layerType:l},n))}}})}}}))}},{"../error/validation_error":464,"../util/extend":465,"../util/unbundle_jsonlint":467,"./validate_filter":474,"./validate_layout_property":478,"./validate_object":480,"./validate_paint_property":481}],478:[function(n,t){"use strict";var r=n("./validate"),i=n("../error/validation_error");t.exports=function(n){var o=n.key,t=n.style,s=n.styleSpec,f=n.value,u=n.objectKey,h=s["layout_"+n.layerType],e;return n.valueSpec||h[u]?(e=[],n.layerType==="symbol"&&(u==="icon-image"&&t&&!t.sprite?e.push(new i(o,f,'use of "icon-image" requires a style "sprite" property')):u==="text-field"&&t&&!t.glyphs&&e.push(new i(o,f,'use of "text-field" requires a style "glyphs" property'))),e.concat(r({key:n.key,value:f,valueSpec:n.valueSpec||h[u],style:t,styleSpec:s}))):[new i(o,f,'unknown property "%s"',u)]}},{"../error/validation_error":464,"./validate":468}],479:[function(n,t){"use strict";var r=n("../util/get_type"),i=n("../error/validation_error");t.exports=function(n){var f=n.key,t=n.value,u=n.valueSpec,e=r(t);return e!=="number"?[new i(f,t,"number expected, %s found",e)]:"minimum"in u&&t<u.minimum?[new i(f,t,"%s is less than the minimum value %s",t,u.minimum)]:"maximum"in u&&t>u.maximum?[new i(f,t,"%s is greater than the maximum value %s",t,u.maximum)]:[]}},{"../error/validation_error":464,"../util/get_type":466}],480:[function(n,t){"use strict";var i=n("../error/validation_error"),r=n("../util/get_type"),u=n("./validate");t.exports=function(n){var t=n.key,f=n.value,s=n.valueSpec,c=n.objectElementValidators||{},y=n.style,p=n.styleSpec,h=[],l=r(f),e;if(l!=="object")return[new i(t,f,"object expected, %s found",l)];for(e in f){var o=e.split(".")[0],a=s&&(s[o]||s["*"]),v=c[o]||c["*"];a||v?h=h.concat((v||u)({key:(t?t+".":t)+e,value:f[e],valueSpec:a,style:y,styleSpec:p,object:f,objectKey:e})):t!==""&&t.split(".").length!==1&&h.push(new i(t,f[e],'unknown property "%s"',e))}for(o in s)s[o].required&&s[o]["default"]===undefined&&f[o]===undefined&&h.push(new i(t,f,'missing required property "%s"',o));return h}},{"../error/validation_error":464,"../util/get_type":466,"./validate":468}],481:[function(n,t){"use strict";var i=n("./validate"),r=n("../error/validation_error");t.exports=function(n){var s=n.key,h=n.style,t=n.styleSpec,e=n.value,u=n.objectKey,f=t["paint_"+n.layerType],o=u.match(/^(.*)-transition$/);return o&&f[o[1]]&&f[o[1]].transition?i({key:s,value:e,valueSpec:t.transition,style:h,styleSpec:t}):n.valueSpec||f[u]?i({key:n.key,value:e,valueSpec:n.valueSpec||f[u],style:h,styleSpec:t}):[new r(s,e,'unknown property "%s"',u)]}},{"../error/validation_error":464,"./validate":468}],482:[function(n,t){"use strict";var r=n("../error/validation_error"),u=n("../util/unbundle_jsonlint"),i=n("./validate_object"),f=n("./validate_enum");t.exports=function(n){var t=n.value,o=n.key,e=n.styleSpec,c=n.style,l,s,h;if(!t.type)return[new r(o,t,'"type" is required')];l=u(t.type);switch(l){case"vector":case"raster":if(s=[],s=s.concat(i({key:o,value:t,valueSpec:e.source_tile,style:n.style,styleSpec:e})),"url"in t)for(h in t)["type","url","tileSize"].indexOf(h)<0&&s.push(new r(o+"."+h,t[h],'a source with a "url" property may not include a "%s" property',h));return s;case"geojson":return i({key:o,value:t,valueSpec:e.source_geojson,style:c,styleSpec:e});case"video":return i({key:o,value:t,valueSpec:e.source_video,style:c,styleSpec:e});case"image":return i({key:o,value:t,valueSpec:e.source_image,style:c,styleSpec:e});default:return f({key:o+".type",value:t.type,valueSpec:{values:["vector","raster","geojson","video","image"]},style:c,styleSpec:e})}}},{"../error/validation_error":464,"../util/unbundle_jsonlint":467,"./validate_enum":473,"./validate_object":480}],483:[function(n,t){"use strict";var i=n("../util/get_type"),r=n("../error/validation_error");t.exports=function(n){var t=n.value,f=n.key,u=i(t);return u!=="string"?[new r(f,t,"string expected, %s found",u)]:[]}},{"../error/validation_error":464,"../util/get_type":466}],484:[function(n,t){"use strict";function i(n,t){t=t||o;var i=[];return i=i.concat(e({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,objectElementValidators:{glyphs:s}})),t.$version>7&&n.constants&&(i=i.concat(f({key:"constants",value:n.constants,style:n,styleSpec:t}))),u(i)}function u(n){return[].concat(n).sort(function(n,t){return n.line-t.line})}function r(n){return function(){return u(n.apply(this,arguments))}}var f=n("./validate/validate_constants"),e=n("./validate/validate"),o=n("../reference/latest.min"),s=n("./validate/validate_glyphs_url");i.source=r(n("./validate/validate_source"));i.layer=r(n("./validate/validate_layer"));i.filter=r(n("./validate/validate_filter"));i.paintProperty=r(n("./validate/validate_paint_property"));i.layoutProperty=r(n("./validate/validate_layout_property"));t.exports=i},{"../reference/latest.min":486,"./validate/validate":468,"./validate/validate_constants":472,"./validate/validate_filter":474,"./validate/validate_glyphs_url":476,"./validate/validate_layer":477,"./validate/validate_layout_property":478,"./validate/validate_paint_property":481,"./validate/validate_source":482}],485:[function(n,t){t.exports=n("./v8.json")},{"./v8.json":487}],486:[function(n,t){t.exports=n("./v8.min.json")},{"./v8.min.json":488}],487:[function(n,t){t.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number","default":0,period:360,units:"degrees",doc:"Default bearing, in degrees.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number","default":0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface.  The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the 'sprite-image' layout property.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the 'text-field' layout property.",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number","default":0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number","default":22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number","default":512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"],doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number","default":14,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number","default":64,doc:"Tile buffer size on each side (higher means fewer rendering artifacts near tile edges but slower performance)."},tolerance:{type:"number","default":3,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean","default":!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number","default":400,doc:"Radius of each cluster when clustering points, relative to 4096 tile."},clusterMaxZoom:{type:"number",doc:"Max zoom to cluster points on. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:["video"],doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:["image"],doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image"},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"],doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.","default":!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},layout_fill:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},layout_circle:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["butt","round","square"],"default":"butt",doc:"The display of line endings.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-join":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["bevel","round","miter"],"default":"miter",doc:"The display of lines when joining.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-miter-limit":{type:"number","default":2,"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-round-limit":{type:"number","default":1.05,"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["point","line"],"default":"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-text-fit":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!1,values:["none","both","width","height"],"default":"none",doc:"Position and scale an icon by the its corresponding text.",requires:["icon-image","text-field"],"sdk-support":{basic:{}}},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Size of padding area around the text-fit size in clockwise order: top, right, bottom, left.",requires:["icon-image","icon-text-fit","text-field"],"sdk-support":{basic:{}}},"icon-image":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-pitch-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Aligns text to the plane of the `viewport` or the `map` when the map is pitched. Matches `text-rotation-alignment` if unspecified.",requires:["text-field"],"sdk-support":{basic:{}}},"text-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"viewport",doc:"Orientation of text when map is rotated.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-field":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-font":{type:"array",value:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-size":{type:"number","default":16,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Font size.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-max-width":{type:"number","default":10,minimum:0,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"The maximum line width for text wrapping.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-line-height":{type:"number","default":1.2,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-letter-spacing":{type:"number","default":0,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-justify":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["left","center","right"],"default":"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],"default":"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-max-angle":{type:"number","default":45,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-transform":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["none","uppercase","lowercase"],"default":"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",value:"number",units:"ems","function":"interpolated","zoom-function":!0,"property-function":!0,length:2,"default":[0,0],requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},layout_raster:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none","has","!has"],doc:"The filter operator."},geometry_type:{type:"enum",values:["Point","LineString","Polygon"],doc:"The geometry type for the filter to select."},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"],doc:"A color operation to apply."},"function":{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number","default":1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a global property or feature property to use as the function input.","default":"$zoom"},type:{type:"enum",values:["exponential","interval","categorical"],doc:"The interpolation strategy to use in function evaluation.","default":"exponential"}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"fill-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the fill-color, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"fill-color":{type:"color","default":"#000000",doc:"The color of the filled part of this layer. This color can be specified as rgba with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.19.0"}}},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.19.0"}}},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"fill-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["fill-translate"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"fill-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.","function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-color":{type:"color",doc:"The color with which the line will be drawn.","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["line-translate"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-gap-width":{type:"number","default":0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-offset":{type:"number","default":0,doc:'The line\'s offset perpendicular to its direction. Values may be positive or negative, where positive indicates "rightwards" (if you were moving in the direction of the line) and negative indicates "leftwards."',"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels","sdk-support":{basic:{js:"0.12.1",ios:"3.1.0",android:"3.0.0"}}},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-dasharray":{type:"array",value:"number","function":"piecewise-constant","zoom-function":!0,"property-function":!0,doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"line-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.18.0"}}},"circle-color":{type:"color","default":"#000000",doc:"The color of the circle.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.18.0"}}},"circle-blur":{type:"number","default":0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.20.0"}}},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"},"property-function":{js:"0.20.0"}}},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"circle-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["circle-translate"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"circle-pitch-scale":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",doc:"Controls the scaling behavior of the circle when the map is pitched. The value `map` scales circles according to their apparent distance to the camera. The value `viewport` results in no pitch-related scaling.","sdk-support":{basic:{}}}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"icon-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).","default":"map",requires:["icon-image","icon-translate"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-color":{type:"color",doc:"The color with which the text will be drawn.","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"text-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).","default":"map",requires:["text-field","text-translate"],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-brightness-min":{type:"number","function":"interpolated","zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.","default":0,minimum:0,maximum:1,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.","default":1,minimum:0,maximum:1,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},paint_background:{"background-color":{type:"color","default":"#000000",doc:"The color with which the background will be drawn.","function":"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"background-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.","function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{basic:{js:"0.10.0",ios:"2.0.0",android:"2.0.1"}}}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number","default":0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],488:[function(n,t){t.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"]},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"},maxzoom:{type:"number","default":14},buffer:{type:"number","default":64},tolerance:{type:"number","default":3},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":400},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:["video"]},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:["image"]},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"]},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:22},maxzoom:{type:"number",minimum:0,maximum:22},interactive:{type:"boolean","default":!1},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},layout_fill:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},layout_circle:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2,"function":"interpolated","zoom-function":!0,"property-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number","default":1.05,"function":"interpolated","zoom-function":!0,"property-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["point","line"],"default":"point"},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["icon-image"]},"icon-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"viewport",requires:["icon-image"]},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-text-fit":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!1,values:["none","both","width","height"],"default":"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image","icon-text-fit","text-field"]},"icon-image":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"text-pitch-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],requires:["text-field"]},"text-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"viewport",requires:["text-field"]},"text-field":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":"",tokens:!0},"text-font":{type:"array",value:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number","default":16,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number","default":10,minimum:0,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number","default":1.2,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number","default":0,units:"em","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["left","center","right"],"default":"center",requires:["text-field"]},"text-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],"default":"center",requires:["text-field"]},"text-max-angle":{type:"number","default":45,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["none","uppercase","lowercase"],"default":"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems","function":"interpolated","zoom-function":!0,"property-function":!0,length:2,"default":[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["text-field"]},"text-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!1,requires:["text-field","icon-image"]},visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},layout_raster:{visibility:{type:"enum","function":"piecewise-constant","zoom-function":!0,values:["visible","none"],"default":"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none","has","!has"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"]},"function":{stops:{type:"array",required:!0,value:"function_stop"},base:{type:"number","default":1,minimum:0},property:{type:"string","default":"$zoom"},type:{type:"enum",values:["exponential","interval","categorical"],"default":"exponential"}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":!0},"fill-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",requires:["fill-translate"]},"fill-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,transition:!0}},paint_line:{"line-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",requires:["line-translate"]},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number","default":0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number","function":"piecewise-constant","zoom-function":!0,"property-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number","default":0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map"}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:["map","viewport"],"default":"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number","function":"interpolated","zoom-function":!0,"default":0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}}}},{}],489:[function(n,t){"use strict";function i(n){return!!(u()&&f()&&e()&&o()&&s()&&h()&&c()&&l(n&&n.failIfMajorPerformanceCaveat))}function u(){return typeof window!="undefined"&&typeof document!="undefined"}function f(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function e(){return Function.prototype&&Function.prototype.bind}function o(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function s(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function h(){return"Worker"in window}function c(){return"Uint8ClampedArray"in window}function l(n){return r[n]===undefined&&(r[n]=a(n)),r[n]}function a(n){var t=document.createElement("canvas"),r=Object.create(i.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=n,t.probablySupportsContext?t.probablySupportsContext("webgl",r)||t.probablySupportsContext("experimental-webgl",r):t.supportsContext?t.supportsContext("webgl",r)||t.supportsContext("experimental-webgl",r):t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}typeof t!="undefined"&&t.exports?t.exports=i:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=i);var r={};i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],490:[function(n,t){"use strict";function u(n){var r,t;return n&&n.length&&(r=n,n=r.length),t=new Uint8Array(n||0),r&&t.set(r),t.readUInt32LE=i.readUInt32LE,t.writeUInt32LE=i.writeUInt32LE,t.readInt32LE=i.readInt32LE,t.writeInt32LE=i.writeInt32LE,t.readFloatLE=i.readFloatLE,t.writeFloatLE=i.writeFloatLE,t.readDoubleLE=i.readDoubleLE,t.writeDoubleLE=i.writeDoubleLE,t.toString=i.toString,t.write=i.write,t.slice=i.slice,t.copy=i.copy,t._isBuffer=!0,t}function o(n){for(var f=n.length,i=[],u=0,t,r;u<f;u++){if(t=n.charCodeAt(u),t>55295&&t<57344)if(r)if(t<56320){i.push(239,191,189);r=t;continue}else t=r-55296<<10|t-56320|65536,r=null;else{t>56319||u+1===f?i.push(239,191,189):r=t;continue}else r&&(i.push(239,191,189),r=null);t<128?i.push(t):t<2048?i.push(t>>6|192,t&63|128):t<65536?i.push(t>>12|224,t>>6&63|128,t&63|128):i.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}return i}var r,i,e,f;t.exports=u;r=n("ieee754");i={readUInt32LE:function(n){return(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},writeUInt32LE:function(n,t){this[t]=n;this[t+1]=n>>>8;this[t+2]=n>>>16;this[t+3]=n>>>24},readInt32LE:function(n){return(this[n]|this[n+1]<<8|this[n+2]<<16)+(this[n+3]<<24)},readFloatLE:function(n){return r.read(this,n,!0,23,4)},readDoubleLE:function(n){return r.read(this,n,!0,52,8)},writeFloatLE:function(n,t){return r.write(this,n,t,!0,23,4)},writeDoubleLE:function(n,t){return r.write(this,n,t,!0,52,8)},toString:function(n,t,i){var e="",r="",u,f;for(t=t||0,i=Math.min(this.length,i||this.length),u=t;u<i;u++)f=this[u],f<=127?(e+=decodeURIComponent(r)+String.fromCharCode(f),r=""):r+="%"+f.toString(16);return e+decodeURIComponent(r)},write:function(n,t){for(var r=n===e?f:o(n),i=0;i<r.length;i++)this[t+i]=r[i]},slice:function(n,t){return this.subarray(n,t)},copy:function(n,t){t=t||0;for(var i=0;i<this.length;i++)n[t+i]=this[i]}};i.writeInt32LE=i.writeUInt32LE;u.byteLength=function(n){return e=n,f=o(n),f.length};u.isBuffer=function(n){return!!(n&&n._isBuffer)}},{ieee754:492}],491:[function(n,t){(function(i){"use strict";function r(n){this.buf=u.isBuffer(n)?n:new u(n||0);this.pos=0;this.length=this.buf.length}function s(n,t){var r=t.buf,i;if((i=r[t.pos++],n+=(i&127)*268435456,i<128)||(i=r[t.pos++],n+=(i&127)*34359738368,i<128)||(i=r[t.pos++],n+=(i&127)*4398046511104,i<128)||(i=r[t.pos++],n+=(i&127)*562949953421312,i<128)||(i=r[t.pos++],n+=(i&127)*0x100000000000000,i<128)||(i=r[t.pos++],n+=(i&127)*0x8000000000000000,i<128))return n;throw new Error("Expected varint not more than 10 bytes");}function h(n,t){var i,r;for(t.realloc(10),i=t.pos+10;n>=1;){if(t.pos>=i)throw new Error("Given varint doesn't fit into 10 bytes");r=n&255;t.buf[t.pos++]=r|(n>=128?128:0);n/=128}}function c(n,t,i){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(Math.LN2*7)),r;for(i.realloc(u),r=i.pos-1;r>=n;r--)i.buf[r+u]=i.buf[r]}function l(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function a(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function v(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function y(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function p(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function w(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function b(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function k(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function d(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}var u;t.exports=r;u=i.Buffer||n("./buffer");r.Varint=0;r.Fixed64=1;r.Bytes=2;r.Fixed32=5;var f=4294967296,e=1/f,o=Math.pow(2,63);r.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),u=r>>3,f=this.pos;n(u,t,this);this.pos===f&&this.skip(r)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=this.buf.readUInt32LE(this.pos);return this.pos+=4,n},readSFixed32:function(){var n=this.buf.readInt32LE(this.pos);return this.pos+=4,n},readFixed64:function(){var n=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*f;return this.pos+=8,n},readSFixed64:function(){var n=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*f;return this.pos+=8,n},readFloat:function(){var n=this.buf.readFloatLE(this.pos);return this.pos+=4,n},readDouble:function(){var n=this.buf.readDoubleLE(this.pos);return this.pos+=8,n},readVarint:function(){var i=this.buf,t,n;return(n=i[this.pos++],t=n&127,n<128)?t:(n=i[this.pos++],t|=(n&127)<<7,n<128)?t:(n=i[this.pos++],t|=(n&127)<<14,n<128)?t:(n=i[this.pos++],t|=(n&127)<<21,n<128)?t:s(t,this)},readVarint64:function(){var r=this.pos,i=this.readVarint(),t,n,u;if(i<o)return i;for(t=this.pos-2;this.buf[t]===255;)t--;for(t<r&&(t=r),i=0,n=0;n<t-r+1;n++)u=~this.buf[r+n]&127,i+=n<4?u<<n*7:u*Math.pow(2,n*7);return-i-1},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,t=this.buf.toString("utf8",this.pos,n);return this.pos=n,t},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.slice(this.pos,n);return this.pos=n,t},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readVarint());return n},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,n=[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=n&7;if(t===r.Varint)while(this.buf[this.pos++]>127);else if(t===r.Bytes)this.pos=this.readVarint()+this.pos;else if(t===r.Fixed32)this.pos+=4;else if(t===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t);},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16,i;t<this.pos+n;)t*=2;t!==this.length&&(i=new u(t),this.buf.copy(i),this.buf=i,this.length=t)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(n){this.realloc(4);this.buf.writeUInt32LE(n,this.pos);this.pos+=4},writeSFixed32:function(n){this.realloc(4);this.buf.writeInt32LE(n,this.pos);this.pos+=4},writeFixed64:function(n){this.realloc(8);this.buf.writeInt32LE(n&-1,this.pos);this.buf.writeUInt32LE(Math.floor(n*e),this.pos+4);this.pos+=8},writeSFixed64:function(n){this.realloc(8);this.buf.writeInt32LE(n&-1,this.pos);this.buf.writeInt32LE(Math.floor(n*e),this.pos+4);this.pos+=8},writeVarint:function(n){if(n=+n,n>268435455){h(n,this);return}(this.realloc(4),this.buf[this.pos++]=n&127|(n>127?128:0),n<=127)||(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),n<=127)||(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),n<=127)||(this.buf[this.pos++]=n>>>7&127)},writeSVarint:function(n){this.writeVarint(n<0?-n*2-1:n*2)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n);var t=u.byteLength(n);this.writeVarint(t);this.realloc(t);this.buf.write(n,this.pos);this.pos+=t},writeFloat:function(n){this.realloc(4);this.buf.writeFloatLE(n,this.pos);this.pos+=4},writeDouble:function(n){this.realloc(8);this.buf.writeDoubleLE(n,this.pos);this.pos+=8},writeBytes:function(n){var i=n.length,t;for(this.writeVarint(i),this.realloc(i),t=0;t<i;t++)this.buf[this.pos++]=n[t]},writeRawMessage:function(n,t){var r,i;this.pos++;r=this.pos;n(t,this);i=this.pos-r;i>=128&&c(r,i,this);this.pos=r-1;this.writeVarint(i);this.pos+=i},writeMessage:function(n,t,i){this.writeTag(n,r.Bytes);this.writeRawMessage(t,i)},writePackedVarint:function(n,t){this.writeMessage(n,l,t)},writePackedSVarint:function(n,t){this.writeMessage(n,a,t)},writePackedBoolean:function(n,t){this.writeMessage(n,p,t)},writePackedFloat:function(n,t){this.writeMessage(n,v,t)},writePackedDouble:function(n,t){this.writeMessage(n,y,t)},writePackedFixed32:function(n,t){this.writeMessage(n,w,t)},writePackedSFixed32:function(n,t){this.writeMessage(n,b,t)},writePackedFixed64:function(n,t){this.writeMessage(n,k,t)},writePackedSFixed64:function(n,t){this.writeMessage(n,d,t)},writeBytesField:function(n,t){this.writeTag(n,r.Bytes);this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,r.Fixed32);this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,r.Fixed32);this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,r.Fixed64);this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,r.Fixed64);this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,r.Varint);this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,r.Varint);this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,r.Bytes);this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,r.Fixed32);this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,r.Fixed64);this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,Boolean(t))}}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./buffer":490}],492:[function(n,t,i){arguments[4][59][0].apply(i,arguments)},{dup:59}],493:[function(n,t){"use strict";function i(n,t){this.x=n;this.y=t}t.exports=i;i.prototype={clone:function(){return new i(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,i=n.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[0]*this.x+n[1]*this.y,i=n[2]*this.x+n[3]*this.y;return this.x=t,this.y=i,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),i=Math.sin(n),r=t*this.x-i*this.y,u=i*this.x+t*this.y;return this.x=r,this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};i.convert=function(n){return n instanceof i?n:Array.isArray(n)?new i(n[0],n[1]):n}},{}],494:[function(n,t){"use strict";function r(n,t,f,e,o){for(f=f||0,e=e||n.length-1,o=o||u;e>f;){if(e-f>600){var h=e-f+1,v=t-f+1,y=Math.log(h),l=.5*Math.exp(2*y/3),p=.5*Math.sqrt(y*l*(h-l)/h)*(v-h/2<0?-1:1),w=Math.max(f,Math.floor(t-v*l/h+p)),b=Math.min(e,Math.floor(t+(h-v)*l/h+p));r(n,t,w,b,o)}var a=n[t],c=f,s=e;for(i(n,f,t),o(n[e],a)>0&&i(n,f,e);c<s;){for(i(n,c,s),c++,s--;o(n[c],a)<0;)c++;while(o(n[s],a)>0)s--}o(n[f],a)===0?i(n,f,s):(s++,i(n,s,e));s<=t&&(f=s+1);t<=s&&(e=s-1)}}function i(n,t,i){var r=n[t];n[t]=n[i];n[i]=r}function u(n,t){return n<t?-1:n>t?1:0}t.exports=r},{}],495:[function(t,i,r){void function(t,u){typeof n=="function"&&n.amd?n(u):typeof r=="object"?i.exports=u():t.resolveUrl=u()}(this,function(){function n(){var r=arguments.length,n,t,u,f,i;if(r===0)throw new Error("resolveUrl requires at least one argument; got none.");if(n=document.createElement("base"),n.href=arguments[0],r===1)return n.href;for(t=document.getElementsByTagName("head")[0],t.insertBefore(n,t.firstChild),u=document.createElement("a"),i=1;i<r;i++)u.href=arguments[i],f=u.href,n.href=f;return t.removeChild(n),f}return n})},{}],496:[function(t,i,r){(function(t,u){typeof r=="object"&&typeof i!="undefined"?i.exports=u():typeof n=="function"&&n.amd?n(u):t.ShelfPack=u()})(this,function(){function n(n,t,i){i=i||{};this.w=n||64;this.h=t||64;this.autoResize=!!i.autoResize;this.shelves=[];this.stats={};this.count=function(n){this.stats[n]=(this.stats[n]|0)+1}}function t(n,t,i){this.x=0;this.y=n;this.w=this.free=t;this.h=i}return n.prototype.pack=function(n,t){var o,s,h,r,i,u,c,f,e;for(n=[].concat(n),t=t||{},o=[],i=0;i<n.length;i++)if(s=n[i].w||n[i].width,h=n[i].h||n[i].height,s&&h){if(r=this.packOne(s,h),!r)continue;t.inPlace&&(n[i].x=r.x,n[i].y=r.y);o.push(r)}if(this.shelves.length>0){for(u=0,c=0,f=0;f<this.shelves.length;f++)e=this.shelves[f],c+=e.h,u=Math.max(e.w-e.free,u);this.resize(u,c)}return o},n.prototype.packOne=function(n,i){for(var f,c,e,l,s=0,u={shelf:-1,waste:Infinity},r,h,o=0;o<this.shelves.length;o++){if(r=this.shelves[o],s+=r.h,i===r.h&&n<=r.free)return this.count(i),r.alloc(n,i);i>r.h||n>r.free||i<r.h&&n<=r.free&&(h=r.h-i,h<u.waste&&(u.waste=h,u.shelf=o))}return u.shelf!==-1?(r=this.shelves[u.shelf],this.count(i),r.alloc(n,i)):i<=this.h-s&&n<=this.w?(r=new t(s,this.w,i),this.shelves.push(r),this.count(i),r.alloc(n,i)):this.autoResize?(f=c=this.h,e=l=this.w,(e<=f||n>e)&&(l=Math.max(n,e)*2),(f<e||i>f)&&(c=Math.max(i,f)*2),this.resize(l,c),this.packOne(n,i)):null},n.prototype.clear=function(){this.shelves=[];this.stats={}},n.prototype.resize=function(n,t){this.w=n;this.h=t;for(var i=0;i<this.shelves.length;i++)this.shelves[i].resize(n);return!0},t.prototype.alloc=function(n,t){if(n>this.free||t>this.h)return null;var i=this.x;return this.x+=n,this.free-=n,{x:i,y:this.y,w:n,h:t,width:n,height:t}},t.prototype.resize=function(n){return this.free+=n-this.w,this.w=n,!0},n})},{}],497:[function(n,t){"use strict";function c(n){return new f(n)}function f(n){this.options=p(Object.create(this.options),n);this.trees=new Array(this.options.maxZoom+1)}function e(n,t,i,r){return{x:n,y:t,zoom:Infinity,id:r,numPoints:i}}function l(n,t){var u=n.geometry.coordinates;return e(i(u[0]),r(u[1]),1,t)}function a(n){return{type:"Feature",properties:o(n),geometry:{type:"Point",coordinates:[v(n.x),y(n.y)]}}}function o(n){var t=n.numPoints,i=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return{cluster:!0,point_count:t,point_count_abbreviated:i}}function i(n){return n/360+.5}function r(n){var i=Math.sin(n*Math.PI/180),t=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return t<0?0:t>1?1:t}function v(n){return(n-.5)*360}function y(n){var t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function p(n,t){for(var i in t)n[i]=t[i];return n}function s(n){return n.x}function h(n){return n.y}var u=n("kdbush");t.exports=c;f.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1},load:function(n){var r=this.options.log,f,t,i,e;for(r&&console.time("total time"),f="prepare "+n.length+" points",r&&console.time(f),this.points=n,t=n.map(l),r&&console.timeEnd(f),i=this.options.maxZoom;i>=this.options.minZoom;i--)e=+Date.now(),this.trees[i+1]=u(t,s,h,this.options.nodeSize,Float32Array),t=this._cluster(t,i),r&&console.log("z%d: %d clusters in %dms",i,t.length,+Date.now()-e);return this.trees[this.options.minZoom]=u(t,s,h,this.options.nodeSize,Float32Array),r&&console.timeEnd("total time"),this},getClusters:function(n,t){for(var u,e=this.trees[this._limitZoom(t)],o=e.range(i(n[0]),r(n[3]),i(n[2]),r(n[1])),s=[],f=0;f<o.length;f++)u=e.points[o[f]],s.push(u.id!==-1?this.points[u.id]:a(u));return s},getTile:function(n,t,i){var r=Math.pow(2,n),s=this.options.extent,f=this.options.radius/s,l=this.trees[this._limitZoom(n)],h=l.range((t-f)/r,(i-f)/r,(t+1+f)/r,(i+1+f)/r),c,e,u,a;if(!h.length)return null;for(c={features:[]},e=0;e<h.length;e++)u=l.points[h[e]],a={type:1,geometry:[[Math.round(s*(u.x*r-t)),Math.round(s*(u.y*r-i))]],tags:u.id!==-1?this.points[u.id].properties:o(u)},c.features.push(a);return c},_limitZoom:function(n){return Math.max(this.options.minZoom,Math.min(n,this.options.maxZoom+1))},_cluster:function(n,t){for(var i,f,r,s=[],y=this.options.radius/(this.options.extent*Math.pow(2,t)),o=0;o<n.length;o++)if(i=n[o],!(i.zoom<=t)){i.zoom=t;var h=this.trees[t+1],c=h.within(i.x,i.y,y),l=!1,u=i.numPoints,a=i.x*u,v=i.y*u;for(f=0;f<c.length;f++)r=h.points[c[f]],t<r.zoom&&(l=!0,r.zoom=t,a+=r.x*r.numPoints,v+=r.y*r.numPoints,u+=r.numPoints);s.push(l?e(a/u,v/u,u,-1):i)}return s}}},{kdbush:498}],498:[function(n,t){"use strict";function e(n,t,r,u,f){return new i(n,t,r,u,f)}function i(n,t,i,u,f){t=t||o;i=i||s;f=f||Array;this.nodeSize=u||64;this.points=n;this.ids=new f(n.length);this.coords=new f(n.length*2);for(var e=0;e<n.length;e++)this.ids[e]=e,this.coords[2*e]=t(n[e]),this.coords[2*e+1]=i(n[e]);r(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function o(n){return n[0]}function s(n){return n[1]}var r=n("./sort"),u=n("./range"),f=n("./within");t.exports=e;i.prototype={range:function(n,t,i,r){return u(this.ids,this.coords,n,t,i,r,this.nodeSize)},within:function(n,t,i){return f(this.ids,this.coords,n,t,i,this.nodeSize)}}},{"./range":499,"./sort":500,"./within":501}],499:[function(n,t){"use strict";function i(n,t,i,r,u,f,e){for(var o=[0,n.length-1,0],y=[],s,h,c,l,w;o.length;){var p=o.pop(),a=o.pop(),v=o.pop();if(a-v<=e){for(c=v;c<=a;c++)s=t[2*c],h=t[2*c+1],s>=i&&s<=u&&h>=r&&h<=f&&y.push(n[c]);continue}l=Math.floor((v+a)/2);s=t[2*l];h=t[2*l+1];s>=i&&s<=u&&h>=r&&h<=f&&y.push(n[l]);w=(p+1)%2;(p===0?i<=s:r<=h)&&(o.push(v),o.push(l-1),o.push(w));(p===0?u>=s:f>=h)&&(o.push(l+1),o.push(a),o.push(w))}return y}t.exports=i},{}],500:[function(n,t){"use strict";function r(n,t,i,u,e,o){if(!(e-u<=i)){var s=Math.floor((u+e)/2);f(n,t,s,u,e,o%2);r(n,t,i,u,s-1,o+1);r(n,t,i,s+1,e,o+1)}}function f(n,t,r,u,e,o){while(e>u){if(e-u>600){var h=e-u+1,v=r-u+1,y=Math.log(h),l=.5*Math.exp(2*y/3),p=.5*Math.sqrt(y*l*(h-l)/h)*(v-h/2<0?-1:1),w=Math.max(u,Math.floor(r-v*l/h+p)),b=Math.min(e,Math.floor(r+(h-v)*l/h+p));f(n,t,r,w,b,o)}var a=t[2*r+o],c=u,s=e;for(i(n,t,u,r),t[2*e+o]>a&&i(n,t,u,e);c<s;){for(i(n,t,c,s),c++,s--;t[2*c+o]<a;)c++;while(t[2*s+o]>a)s--}t[2*u+o]===a?i(n,t,u,s):(s++,i(n,t,s,e));s<=r&&(u=s+1);r<=s&&(e=s-1)}}function i(n,t,i,r){u(n,i,r);u(t,2*i,2*r);u(t,2*i+1,2*r+1)}function u(n,t,i){var r=n[t];n[t]=n[i];n[i]=r}t.exports=r},{}],501:[function(n,t){"use strict";function r(n,t,r,u,f,e){for(var o=[0,n.length-1,0],a=[],b=f*f,s,w;o.length;){var v=o.pop(),c=o.pop(),l=o.pop();if(c-l<=e){for(s=l;s<=c;s++)i(t[2*s],t[2*s+1],r,u)<=b&&a.push(n[s]);continue}var h=Math.floor((l+c)/2),y=t[2*h],p=t[2*h+1];i(y,p,r,u)<=b&&a.push(n[h]);w=(v+1)%2;(v===0?r-f<=y:u-f<=p)&&(o.push(l),o.push(h-1),o.push(w));(v===0?r+f>=y:u+f>=p)&&(o.push(h+1),o.push(c),o.push(w))}return a}function i(n,t,i,r){var u=n-i,f=t-r;return u*u+f*f}t.exports=r},{}],502:[function(n,t){function i(n,t,i,r){this.cx=3*n;this.bx=3*(i-n)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*t;this.by=3*(r-t)-this.cy;this.ay=1-this.cy-this.by;this.p1x=n;this.p1y=r;this.p2x=i;this.p2y=r}t.exports=i;i.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n};i.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n};i.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx};i.prototype.solveCurveX=function(n,t){var r,u,i,f,e,o;for(typeof t=="undefined"&&(t=1e-6),i=n,e=0;e<8;e++){if(f=this.sampleCurveX(i)-n,Math.abs(f)<t)return i;if(o=this.sampleCurveDerivativeX(i),Math.abs(o)<1e-6)break;i=i-f/o}if(r=0,u=1,i=n,i<r)return r;if(i>u)return u;while(r<u){if(f=this.sampleCurveX(i),Math.abs(f-n)<t)return i;n>f?r=i:u=i;i=(u-r)*.5+r}return i};i.prototype.solve=function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}},{}],503:[function(n,t){t.exports.VectorTile=n("./lib/vectortile.js");t.exports.VectorTileFeature=n("./lib/vectortilefeature.js");t.exports.VectorTileLayer=n("./lib/vectortilelayer.js")},{"./lib/vectortile.js":504,"./lib/vectortilefeature.js":505,"./lib/vectortilelayer.js":506}],504:[function(n,t){"use strict";function r(n,t){this.layers=n.readFields(u,{},t)}function u(n,t,r){if(n===3){var u=new i(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}var i=n("./vectortilelayer");t.exports=r},{"./vectortilelayer":506}],505:[function(n,t){"use strict";function i(n,t,i,r,f){this.properties={};this.extent=i;this.type=0;this._pbf=n;this._geometry=-1;this._keys=r;this._values=f;n.readFields(u,this,t)}function u(n,t,i){n==1?t.id=i.readVarint():n==2?f(i,t):n==3?t.type=i.readVarint():n==4&&(t._geometry=i.pos)}function f(n,t){for(var u=n.readVarint()+n.pos,i,r;n.pos<u;)i=t._keys[n.readVarint()],r=t._values[n.readVarint()],t.properties[i]=r}function e(n){var e=n.length,r,t,f,i,u;if(e<=1)return[n];for(r=[],i=0;i<e;i++)(u=o(n[i]),u!==0)&&(f===undefined&&(f=u<0),f===u<0?(t&&r.push(t),t=[n[i]]):t.push(n[i]));return t&&r.push(t),r}function o(n){for(var u=0,t=0,f=n.length,e=f-1,i,r;t<f;e=t++)i=n[t],r=n[e],u+=(r.x-i.x)*(i.y+r.y);return u}var r=n("point-geometry");t.exports=i;i.types=["Unknown","Point","LineString","Polygon"];i.prototype.loadGeometry=function(){var t=this._pbf,e;t.pos=this._geometry;for(var h=t.readVarint()+t.pos,i=1,u=0,o=0,s=0,f=[],n;t.pos<h;)if(u||(e=t.readVarint(),i=e&7,u=e>>3),u--,i===1||i===2)o+=t.readSVarint(),s+=t.readSVarint(),i===1&&(n&&f.push(n),n=[]),n.push(new r(o,s));else if(i===7)n&&n.push(n[0].clone());else throw new Error("unknown command "+i);return n&&f.push(n),f};i.prototype.bbox=function(){var n=this._pbf,h;n.pos=this._geometry;for(var c=n.readVarint()+n.pos,t=1,u=0,i=0,r=0,f=Infinity,e=-Infinity,o=Infinity,s=-Infinity;n.pos<c;)if(u||(h=n.readVarint(),t=h&7,u=h>>3),u--,t===1||t===2)i+=n.readSVarint(),r+=n.readSVarint(),i<f&&(f=i),i>e&&(e=i),r<o&&(o=r),r>s&&(s=r);else if(t!==7)throw new Error("unknown command "+t);return[f,o,e,s]};i.prototype.toGeoJSON=function(n,t,r){function h(n){for(var i,r,t=0;t<n.length;t++)i=n[t],r=180-(i.y+y)*360/a,n[t]=[(i.x+v)*360/a-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}var a=this.extent*Math.pow(2,r),v=this.extent*n,y=this.extent*t,u=this.loadGeometry(),s=i.types[this.type],f,o,c,l;switch(this.type){case 1:for(c=[],f=0;f<u.length;f++)c[f]=u[f][0];u=c;h(u);break;case 2:for(f=0;f<u.length;f++)h(u[f]);break;case 3:for(u=e(u),f=0;f<u.length;f++)for(o=0;o<u[f].length;o++)h(u[f][o])}return u.length===1?u=u[0]:s="Multi"+s,l={type:"Feature",geometry:{type:s,coordinates:u},properties:this.properties},"id"in this&&(l.id=this.id),l}},{"point-geometry":493}],506:[function(n,t){"use strict";function i(n,t){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=n;this._keys=[];this._values=[];this._features=[];n.readFields(u,this,t);this.length=this._features.length}function u(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===5?t.extent=i.readVarint():n===2?t._features.push(i.pos):n===3?t._keys.push(i.readString()):n===4&&t._values.push(f(i))}function f(n){for(var i=null,r=n.readVarint()+n.pos,t;n.pos<r;)t=n.readVarint()>>3,i=t===1?n.readString():t===2?n.readFloat():t===3?n.readDouble():t===4?n.readVarint64():t===5?n.readVarint():t===6?n.readSVarint():t===7?n.readBoolean():null;return i}var r=n("./vectortilefeature.js");t.exports=i;i.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,t,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":505}],507:[function(n,t){function i(n){var i=[],r,t;for(r in n.layers)i.push(h(n.layers[r]));return t=new e,o.tile.write({layers:i},t),t.finish()}function s(n){var u={};for(var t in n)u[t]=new r(n[t].features),u[t].name=t;return i({layers:u})}function h(n){for(var t,e,r,u,o,f,i={name:n.name||"",version:n.version||1,extent:n.extent||4096,keys:[],values:[],features:[]},h={},a={},s=0;s<n.length;s++){t=n.feature(s);t.geometry=c(t.loadGeometry());e=[];for(r in t.properties)u=h[r],typeof u=="undefined"&&(i.keys.push(r),u=i.keys.length-1,h[r]=u),o=l(t.properties[r]),f=a[o.key],typeof f=="undefined"&&(i.values.push(o),f=i.values.length-1,a[o.key]=f),e.push(u),e.push(f);t.tags=e;i.features.push(t)}return i}function u(n,t){return(t<<3)+(n&7)}function f(n){return n<<1^n>>31}function c(n){for(var i,t,o,s,r=[],h=0,c=0,l=n.length,e=0;e<l;e++)for(i=n[e],r.push(u(1,1)),t=0;t<i.length;t++)t===1&&r.push(u(2,i.length-1)),o=i[t].x-h,s=i[t].y-c,r.push(f(o),f(s)),h+=o,c+=s;return r}function l(n){var t,i=typeof n;return i==="string"?t={string_value:n}:i==="boolean"?t={bool_value:n}:i==="number"?t=n%1!=0?{double_value:n}:n<0?{sint_value:n}:{uint_value:n}:(n=JSON.stringify(n),t={string_value:n}),t.key=i+":"+n,t}var e=n("pbf"),o=n("./vector-tile-pb"),r=n("./lib/geojson_wrapper");t.exports=i;t.exports.fromVectorTileJs=i;t.exports.fromGeojsonVt=s;t.exports.GeoJSONWrapper=r},{"./lib/geojson_wrapper":508,"./vector-tile-pb":509,pbf:491}],508:[function(n,t){"use strict";function r(n){this.features=n;this.length=n.length}function i(n){this.id=typeof n.id=="number"?n.id:undefined;this.type=n.type;this.rawGeometry=n.type===1?[n.geometry]:n.geometry;this.properties=n.tags;this.extent=4096}var u=n("point-geometry"),f=n("vector-tile").VectorTileFeature;t.exports=r;r.prototype.feature=function(n){return new i(this.features[n])};i.prototype.loadGeometry=function(){var f=this.rawGeometry,t,i,r,n;for(this.geometry=[],t=0;t<f.length;t++){for(i=f[t],r=[],n=0;n<i.length;n++)r.push(new u(i[n][0],i[n][1]));this.geometry.push(r)}return this.geometry};i.prototype.bbox=function(){var t,o,i,n;this.geometry||this.loadGeometry();var s=this.geometry,r=Infinity,u=-Infinity,f=Infinity,e=-Infinity;for(t=0;t<s.length;t++)for(o=s[t],i=0;i<o.length;i++)n=o[i],r=Math.min(r,n.x),u=Math.max(u,n.x),f=Math.min(f,n.y),e=Math.max(e,n.y);return[r,f,u,e]};i.prototype.toGeoJSON=f.prototype.toGeoJSON},{"point-geometry":493,"vector-tile":503}],509:[function(n,t,i){"use strict";function c(n,t){return n.readFields(l,{layers:[]},t)}function l(n,t,i){n===3&&t.layers.push(s(i,i.readVarint()+i.pos))}function a(n,t){var i;if(n.layers!==undefined)for(i=0;i<n.layers.length;i++)t.writeMessage(3,h,n.layers[i])}function u(n,t){return n.readFields(v,{},t)}function v(n,t,i){n===1?t.string_value=i.readString():n===2?t.float_value=i.readFloat():n===3?t.double_value=i.readDouble():n===4?t.int_value=i.readVarint():n===5?t.uint_value=i.readVarint():n===6?t.sint_value=i.readSVarint():n===7&&(t.bool_value=i.readBoolean())}function f(n,t){n.string_value!==undefined&&t.writeStringField(1,n.string_value);n.float_value!==undefined&&t.writeFloatField(2,n.float_value);n.double_value!==undefined&&t.writeDoubleField(3,n.double_value);n.int_value!==undefined&&t.writeVarintField(4,n.int_value);n.uint_value!==undefined&&t.writeVarintField(5,n.uint_value);n.sint_value!==undefined&&t.writeSVarintField(6,n.sint_value);n.bool_value!==undefined&&t.writeBooleanField(7,n.bool_value)}function e(n,t){var i=n.readFields(y,{},t);return i.type===undefined&&(i.type="Unknown"),i}function y(n,t,i){n===1?t.id=i.readVarint():n===2?t.tags=i.readPackedVarint():n===3?t.type=i.readVarint():n===4&&(t.geometry=i.readPackedVarint())}function o(n,t){n.id!==undefined&&t.writeVarintField(1,n.id);n.tags!==undefined&&t.writePackedVarint(2,n.tags);n.type!==undefined&&t.writeVarintField(3,n.type);n.geometry!==undefined&&t.writePackedVarint(4,n.geometry)}function s(n,t){return n.readFields(p,{features:[],keys:[],values:[]},t)}function p(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===2?t.features.push(e(i,i.readVarint()+i.pos)):n===3?t.keys.push(i.readString()):n===4?t.values.push(u(i,i.readVarint()+i.pos)):n===5&&(t.extent=i.readVarint())}function h(n,t){n.version!==undefined&&t.writeVarintField(15,n.version);n.name!==undefined&&t.writeStringField(1,n.name);var i;if(n.features!==undefined)for(i=0;i<n.features.length;i++)t.writeMessage(2,o,n.features[i]);if(n.keys!==undefined)for(i=0;i<n.keys.length;i++)t.writeStringField(3,n.keys[i]);if(n.values!==undefined)for(i=0;i<n.values.length;i++)t.writeMessage(4,f,n.values[i]);n.extent!==undefined&&t.writeVarintField(5,n.extent)}var r=i.tile={read:c,write:a};r.GeomType={Unknown:0,Point:1,LineString:2,Polygon:3};r.value={read:u,write:f};r.feature={read:e,write:o};r.layer={read:s,write:h}},{}],510:[function(n,t){var f=arguments[3],i=arguments[4],u=arguments[5],r=JSON.stringify;t.exports=function(n,t){for(var c,a,s,v,y,p,w,e,h=Object.keys(u),o=0,l=h.length;o<l;o++)if(s=h[o],c=u[s].exports,c===n||c&&c.default===n){e=s;break}if(!e){for(e=Math.floor(Math.pow(16,8)*Math.random()).toString(16),a={},o=0,l=h.length;o<l;o++)s=h[o],a[s]=s;i[e]=[Function(["require","module","exports"],"("+n+")(self)"),a]}v=Math.floor(Math.pow(16,8)*Math.random()).toString(16);y={};y[e]=e;i[v]=[Function(["require"],"var f = require("+r(e)+");(f.default ? f.default : f)(self);"),y];var k="("+f+")({"+Object.keys(i).map(function(n){return r(n)+":["+i[n][0]+","+r(i[n][1])+"]"}).join(",")+"},{},["+r(v)+"])",d=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([k],{type:"text/javascript"});return t&&t.bare?b:(p=d.createObjectURL(b),w=new Worker(p),w.objectURL=p,w)}},{}],511:[function(t,i,r){(function(t,u){typeof r=="object"&&typeof i!="undefined"?u(r):typeof n=="function"&&n.amd?n(["exports"],u):u(t.WhooTS=t.WhooTS||{})})(this,function(n){function r(n,t,r,u,f,e){e=e||{};return n+"?"+["bbox="+i(r,u,f),"format="+(e.format||"image/png"),"service="+(e.service||"WMS"),"version="+(e.version||"1.1.1"),"request="+(e.request||"GetMap"),"srs="+(e.srs||"EPSG:3857"),"width="+(e.width||256),"height="+(e.height||256),"layers="+t].join("&")}function i(n,i,r){i=Math.pow(2,r)-i-1;var u=t(n*256,i*256,r),f=t((n+1)*256,(i+1)*256,r);return u[0]+","+u[1]+","+f[0]+","+f[1]}function t(n,t,i){var r=12756274*Math.PI/256/Math.pow(2,i),u=n*r-6378137*Math.PI,f=t*r-6378137*Math.PI;return[u,f]}n.getURL=r;n.getTileBBox=i;n.getMercCoords=t;Object.defineProperty(n,"__esModule",{value:!0})})},{}],512:[function(n,t){t.exports={name:"mapbox-gl",description:"A WebGL interactive maps library",version:"0.22.0",main:"js/mapbox-gl.js",license:"BSD-3-Clause",repository:{type:"git",url:"git://github.com/mapbox/mapbox-gl-js.git"},engines:{node:">=4.0.0"},dependencies:{csscolorparser:"^1.0.2",earcut:"^2.0.3","feature-filter":"^2.2.0","geojson-rewind":"^0.1.0","geojson-vt":"^2.4.0","gl-matrix":"^2.3.1","grid-index":"^1.0.0","mapbox-gl-function":"^1.2.1","mapbox-gl-shaders":"github:mapbox/mapbox-gl-shaders#de2ab007455aa2587c552694c68583f94c9f2747","mapbox-gl-style-spec":"github:mapbox/mapbox-gl-style-spec#83b1a3e5837d785af582efd5ed1a212f2df6a4ae","mapbox-gl-supported":"^1.2.0",pbf:"^1.3.2",pngjs:"^2.2.0","point-geometry":"^0.0.0",quickselect:"^1.0.0",request:"^2.39.0","resolve-url":"^0.2.1","shelf-pack":"^1.0.0",supercluster:"^2.0.1",unassertify:"^2.0.0",unitbezier:"^0.0.0","vector-tile":"^1.3.0","vt-pbf":"^2.0.2",webworkify:"^1.3.0","whoots-js":"^2.0.0"},devDependencies:{async:"^2.0.1","babel-preset-react":"^6.11.1",babelify:"^7.3.0",benchmark:"~2.1.0",browserify:"^13.0.0","browserify-middleware":"^7.0.0",clipboard:"^1.5.12","concat-stream":"1.5.1",coveralls:"^2.11.8",doctrine:"^1.2.1",documentation:"https://github.com/documentationjs/documentation/archive/bb41619c734e59ef3fbc3648610032efcfdaaace.tar.gz","documentation-theme-utils":"3.0.0",envify:"^3.4.0",eslint:"^2.5.3","eslint-config-mourner":"^2.0.0","eslint-plugin-html":"^1.5.1",express:"^4.13.4",gl:"^4.0.1",handlebars:"4.0.5","highlight.js":"9.3.0",istanbul:"^0.4.2","json-loader":"^0.5.4",lodash:"^4.13.1","mapbox-gl-test-suite":"github:mapbox/mapbox-gl-test-suite#1619d84e76ff3434becd51237720d370c7405ee5","memory-fs":"^0.3.0",minifyify:"^7.0.1",nyc:"6.4.0",proxyquire:"^1.7.9",react:"^15.3.0","react-dom":"^15.3.0",remark:"4.2.2","remark-html":"3.0.0",sinon:"^1.15.4",st:"^1.0.0",tap:"^5.7.0",through:"^2.3.7","transform-loader":"^0.2.3","unist-util-visit":"1.1.0",vinyl:"1.1.1","vinyl-fs":"2.4.3",watchify:"^3.2.2",webpack:"^1.13.1","webworkify-webpack":"^1.1.3"},browserify:{transform:["unassertify"]},browser:{"./js/util/ajax.js":"./js/util/browser/ajax.js","./js/util/browser.js":"./js/util/browser/browser.js","./js/util/canvas.js":"./js/util/browser/canvas.js","./js/util/dom.js":"./js/util/browser/dom.js","./js/util/web_worker.js":"./js/util/browser/web_worker.js"},scripts:{"build-dev":"browserify js/mapbox-gl.js --debug --ignore-transform unassertify --standalone mapboxgl > dist/mapbox-gl-dev.js && tap --no-coverage test/build/dev.test.js","build-docs":"documentation build --github --format html -c documentation.yml --theme ./docs/_theme --output docs/api/","build-min":"browserify js/mapbox-gl.js --debug --plugin [minifyify --map mapbox-gl.js.map --output dist/mapbox-gl.js.map] --standalone mapboxgl > dist/mapbox-gl.js && tap --no-coverage test/build/min.test.js","//":"The 'build' script is invoked by publisher when publishing docs on the mb-pages branch",build:"npm run build-docs",lint:"eslint js test bench server.js docs/_posts/examples/*.html","open-changed-examples":"git diff --name-only mb-pages HEAD -- docs/_posts/examples/*.html | awk '{print \"http://127.0.0.1:4000/mapbox-gl-js/example/\" substr($0,33,length($0)-37)}' | xargs open","start-docs":"npm run build-min && npm run build-docs && jekyll serve -w",start:"node server.js","test-suite":"node test/render.test.js && node test/query.test.js",test:"npm run lint && tap --reporter dot test/js/*/*.js test/build/webpack.test.js"},gitHead:"98461d3e2db6369cbcb66d70595e3032558fba9d",bugs:{url:"https://github.com/mapbox/mapbox-gl-js/issues"},homepage:"https://github.com/mapbox/mapbox-gl-js#readme",_id:"mapbox-gl@0.22.0",_shasum:"7fb1d70984dc7d8671abcd09ef6ab5fb98c0a310",_from:"mapbox-gl@latest",_npmVersion:"2.15.5",_nodeVersion:"4.4.5",_npmUser:{name:"lucaswoj",email:"lucas@lucaswoj.com"},dist:{shasum:"7fb1d70984dc7d8671abcd09ef6ab5fb98c0a310",tarball:"https://registry.npmjs.org/mapbox-gl/-/mapbox-gl-0.22.0.tgz"},maintainers:[{name:"aaronlidman",email:"aaronlidman@gmail.com"},{name:"ajashton",email:"aj.ashton@gmail.com"},{name:"ansis",email:"ansis.brammanis@gmail.com"},{name:"bergwerkgis",email:"wb@bergwerk-gis.at"},{name:"bhousel",email:"bryan@mapbox.com"},{name:"bsudekum",email:"bobby@mapbox.com"},{name:"camilleanne",email:"camille@mapbox.com"},{name:"dnomadb",email:"damon@mapbox.com"},{name:"dthompson",email:"dthompson@gmail.com"},{name:"emilymcafee",email:"emily@mapbox.com"},{name:"flippmoke",email:"flippmoke@gmail.com"},{name:"freenerd",email:"spam@freenerd.de"},{name:"gretacb",email:"carol@mapbox.com"},{name:"ian29",email:"ian.villeda@gmail.com"},{name:"ianshward",email:"ian@mapbox.com"},{name:"ingalls",email:"nicholas.ingalls@gmail.com"},{name:"jfirebaugh",email:"john.firebaugh@gmail.com"},{name:"jrpruit1",email:"jake@jakepruitt.com"},{name:"karenzshea",email:"karen@mapbox.com"},{name:"kkaefer",email:"kkaefer@gmail.com"},{name:"lbud",email:"lauren@mapbox.com"},{name:"lucaswoj",email:"lucas@lucaswoj.com"},{name:"lxbarth",email:"alex@mapbox.com"},{name:"lyzidiamond",email:"lyzi@mapbox.com"},{name:"mapbox-admin",email:"accounts@mapbox.com"},{name:"mateov",email:"matt@mapbox.com"},{name:"mcwhittemore",email:"mcwhittemore@gmail.com"},{name:"miccolis",email:"jeff@miccolis.net"},{name:"mikemorris",email:"michael.patrick.morris@gmail.com"},{name:"morganherlocker",email:"morgan.herlocker@gmail.com"},{name:"mourner",email:"agafonkin@gmail.com"},{name:"nickidlugash",email:"nicki@mapbox.com"},{name:"rclark",email:"ryan.clark.j@gmail.com"},{name:"samanbb",email:"saman@mapbox.com"},{name:"sbma44",email:"tlee@mapbox.com"},{name:"scothis",email:"scothis@gmail.com"},{name:"sgillies",email:"sean@mapbox.com"},{name:"springmeyer",email:"dane@mapbox.com"},{name:"themarex",email:"patrick@mapbox.com"},{name:"tmcw",email:"tom@macwright.org"},{name:"tristen",email:"tristen.brown@gmail.com"},{name:"willwhite",email:"will@mapbox.com"},{name:"yhahn",email:"young@mapbox.com"}],_npmOperationalInternal:{host:"packages-12-west.internal.npmjs.com",tmp:"tmp/mapbox-gl-0.22.0.tgz_1471021366539_0.7491761057171971"},directories:{},_resolved:"https://registry.npmjs.org/mapbox-gl/-/mapbox-gl-0.22.0.tgz"}},{}],513:[function(n,t){"use strict";function r(n,t){function v(n){var t=!1;return"altKey"in n&&(t=t||n.altKey!==r.alt,r.alt=!!n.altKey),"shiftKey"in n&&(t=t||n.shiftKey!==r.shift,r.shift=!!n.shiftKey),"ctrlKey"in n&&(t=t||n.ctrlKey!==r.control,r.control=!!n.ctrlKey),"metaKey"in n&&(t=t||n.metaKey!==r.meta,r.meta=!!n.metaKey),t}function c(n,u){var e=i.x(u),h=i.y(u);"buttons"in u&&(n=u.buttons|0);(n!==f||e!==o||h!==s||v(u))&&(f=n|0,o=e||0,s=h||0,t(f,o,s,r))}function e(n){c(0,n)}function l(){(f||o||s||r.shift||r.alt||r.meta||r.control)&&(o=s=0,f=0,r.shift=r.alt=r.control=r.meta=!1,t(0,0,0,r))}function u(n){v(n)&&t(f,o,s,r)}function y(n){i.buttons(n)===0?c(0,n):c(f,n)}function p(n){c(f|i.buttons(n),n)}function w(n){c(f&~i.buttons(n),n)}function b(){h||(h=!0,n.addEventListener("mousemove",y),n.addEventListener("mousedown",p),n.addEventListener("mouseup",w),n.addEventListener("mouseleave",e),n.addEventListener("mouseenter",e),n.addEventListener("mouseout",e),n.addEventListener("mouseover",e),n.addEventListener("blur",l),n.addEventListener("keyup",u),n.addEventListener("keydown",u),n.addEventListener("keypress",u),n!==window&&(window.addEventListener("blur",l),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}function k(){h&&(h=!1,n.removeEventListener("mousemove",y),n.removeEventListener("mousedown",p),n.removeEventListener("mouseup",w),n.removeEventListener("mouseleave",e),n.removeEventListener("mouseenter",e),n.removeEventListener("mouseout",e),n.removeEventListener("mouseover",e),n.removeEventListener("blur",l),n.removeEventListener("keyup",u),n.removeEventListener("keydown",u),n.removeEventListener("keypress",u),n!==window&&(window.removeEventListener("blur",l),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}var a;t||(t=n,n=window);var f=0,o=0,s=0,r={shift:!1,alt:!1,control:!1,meta:!1},h=!1;return b(),a={element:n},Object.defineProperties(a,{enabled:{get:function(){return h},set:function(n){n?b():k},enumerable:!0},buttons:{get:function(){return f},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),a}t.exports=r;var i=n("mouse-event")},{"mouse-event":514}],514:[function(n,t,i){"use strict";function u(n){var t;if(typeof n=="object"){if("buttons"in n)return n.buttons;if("which"in n){if(t=n.which,t===2)return 4;if(t===3)return 2;if(t>0)return 1<<t-1}else if("button"in n){if(t=n.button,t===1)return 4;if(t===2)return 2;if(t>=0)return 1<<t}}return 0}function r(n){return n.target||n.srcElement||window}function f(n){if(typeof n=="object"){if("offsetX"in n)return n.offsetX;var t=r(n),i=t.getBoundingClientRect();return n.clientX-i.left}return 0}function e(n){if(typeof n=="object"){if("offsetY"in n)return n.offsetY;var t=r(n),i=t.getBoundingClientRect();return n.clientY-i.top}return 0}i.buttons=u;i.element=r;i.x=f;i.y=e},{}],515:[function(n,t){t.exports=function(n,t){t||(t=[0,""]);n=String(n);var i=parseFloat(n,10);return t[0]=i,t[1]=n.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],516:[function(n,t){"use strict";function r(n,t){var i=f(getComputedStyle(n).getPropertyValue(t));return i[0]*u(i[1],n)}function e(n,t){var i=document.createElement("div"),u;return i.style["font-size"]="128"+n,t.appendChild(i),u=r(i,"font-size")/128,t.removeChild(i),u}function u(n,t){t=t||document.body;n=(n||"px").trim().toLowerCase();(t===window||t===document)&&(t=document.body);switch(n){case"%":return t.clientHeight/100;case"ch":case"ex":return e(n,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return i;case"cm":return i/2.54;case"mm":return i/25.4;case"pt":return i/72;case"pc":return i/6}return 1}var f=n("parse-unit"),i;t.exports=u;i=96},{"parse-unit":515}],517:[function(n,t){"use strict";function r(n,t,r){typeof n=="function"&&(r=!!t,t=n,n=window);var f=i("ex",n),u=function(n){r&&n.preventDefault();var u=n.deltaX||0,e=n.deltaY||0,o=n.deltaZ||0,s=n.deltaMode,i=1;switch(s){case 1:i=f;break;case 2:i=window.innerHeight}return u*=i,e*=i,o*=i,u||e||o?t(u,e,o):void 0};return n.addEventListener("wheel",u),u}var i=n("to-px");t.exports=r},{"to-px":516}],518:[function(n,t){"use strict";var i=n("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});t.exports=function(n,t){return i(n,t),n}},{"cwise/lib/wrapper":128}],519:[function(n,t){"use strict";function f(n,t){switch(t.length){case 0:break;case 1:n[0]=1/t[0];break;case 4:i(n,t);break;case 9:r(n,t);break;case 16:u(n,t);break;default:throw new Error("currently supports matrices up to 4x4");}return n}t.exports=f;var i=n("gl-mat2/invert"),r=n("gl-mat3/invert"),u=n("gl-mat4/invert")},{"gl-mat2/invert":520,"gl-mat3/invert":146,"gl-mat4/invert":153}],520:[function(n,t){function i(n,t){var r=t[0],u=t[1],f=t[2],e=t[3],i=r*e-f*u;return i?(i=1/i,n[0]=e*i,n[1]=-u*i,n[2]=-f*i,n[3]=r*i,n):null}t.exports=i},{}],521:[function(n,t){"use strict";function i(n,t){var i=Math.floor(t),r=t-i,u=0<=i&&i<n.shape[0],f=0<=i+1&&i+1<n.shape[0],e=u?+n.get(i):0,o=f?+n.get(i+1):0;return(1-r)*e+r*o}function r(n,t,i){var r=Math.floor(t),f=t-r,e=0<=r&&r<n.shape[0],o=0<=r+1&&r+1<n.shape[0],u=Math.floor(i),s=i-u,h=0<=u&&u<n.shape[1],c=0<=u+1&&u+1<n.shape[1],l=e&&h?n.get(r,u):0,a=e&&c?n.get(r,u+1):0,v=o&&h?n.get(r+1,u):0,y=o&&c?n.get(r+1,u+1):0;return(1-s)*((1-f)*l+f*v)+s*((1-f)*a+f*y)}function u(n,t,i,r){var u=Math.floor(t),o=t-u,s=0<=u&&u<n.shape[0],h=0<=u+1&&u+1<n.shape[0],f=Math.floor(i),c=i-f,l=0<=f&&f<n.shape[1],a=0<=f+1&&f+1<n.shape[1],e=Math.floor(r),p=r-e,v=0<=e&&e<n.shape[2],y=0<=e+1&&e+1<n.shape[2],w=s&&l&&v?n.get(u,f,e):0,b=s&&a&&v?n.get(u,f+1,e):0,k=h&&l&&v?n.get(u+1,f,e):0,d=h&&a&&v?n.get(u+1,f+1,e):0,g=s&&l&&y?n.get(u,f,e+1):0,nt=s&&a&&y?n.get(u,f+1,e+1):0,tt=h&&l&&y?n.get(u+1,f,e+1):0,it=h&&a&&y?n.get(u+1,f+1,e+1):0;return(1-p)*((1-c)*((1-o)*w+o*k)+c*((1-o)*b+o*d))+p*((1-c)*((1-o)*g+o*tt)+c*((1-o)*nt+o*it))}function f(n){for(var u=n.shape.length|0,r=new Array(u),o=new Array(u),c=new Array(u),l=new Array(u),s,h,i,f,e,t=0;t<u;++t)s=+arguments[t+1],r[t]=Math.floor(s),o[t]=s-r[t],c[t]=0<=r[t]&&r[t]<n.shape[t],l[t]=0<=r[t]+1&&r[t]+1<n.shape[t];h=0;n:for(t=0;t<1<<u;++t){for(f=1,e=n.offset,i=0;i<u;++i)if(t&1<<i){if(!l[i])continue n;f*=o[i];e+=n.stride[i]*(r[i]+1)}else{if(!c[i])continue n;f*=1-o[i];e+=n.stride[i]*r[i]}h+=f*n.data[e]}return h}function e(n,t,e,o){switch(n.shape.length){case 0:return 0;case 1:return i(n,t);case 2:return r(n,t,e);case 3:return u(n,t,e,o);default:return f.apply(undefined,arguments)}}t.exports=e;t.exports.d1=i;t.exports.d2=r;t.exports.d3=u},{}],522:[function(n,t){"use strict";var i=n("ndarray-linear-interpolate"),r=n("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_9_arg4_)}",args:[{name:"_inline_9_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_9_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_9_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_9_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_9_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),u=n("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),f=n("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_16_arg2_(this_warped,_inline_16_arg0_),_inline_16_arg1_=_inline_16_arg3_(_inline_16_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),e=n("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_19_arg2_(this_warped,_inline_19_arg0_),_inline_19_arg1_=_inline_19_arg3_(_inline_19_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_19_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_19_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_19_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_19_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_19_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64});t.exports=function(n,t,o){switch(t.shape.length){case 1:u(n,o,i.d1,t);break;case 2:f(n,o,i.d2,t);break;case 3:e(n,o,i.d3,t);break;default:r(n,o,i.bind(undefined,t),t.shape.length)}return n}},{"cwise/lib/wrapper":128,"ndarray-linear-interpolate":521}],523:[function(n,t){"use strict";function u(n,t,u){var f=t.dimension,e=r([],u);return i(n,t,function(n,t){for(var u,r,o,i=0;i<f;++i)for(n[i]=e[(f+1)*f+i],r=0;r<f;++r)n[i]+=e[(f+1)*r+i]*t[r];for(u=e[(f+1)*(f+1)-1],r=0;r<f;++r)u+=e[(f+1)*r+f]*t[r];for(o=1/u,i=0;i<f;++i)n[i]*=o;return n}),n}var i=n("ndarray-warp"),r=n("gl-matrix-invert");t.exports=u},{"gl-matrix-invert":519,"ndarray-warp":522}],524:[function(n,t,i){"use strict";function e(n){var t,i;if(!n)return f;for(t=0;t<n.args.length;++t)i=n.args[t],n.args[t]=t===0?{name:i,lvalue:!0,rvalue:!!n.rvalue,count:n.count||1}:{name:i,lvalue:!1,rvalue:!0,count:1};return n.thisVars||(n.thisVars=[]),n.localVars||(n.localVars=[]),n}function v(n){return u({args:n.args,pre:e(n.pre),body:e(n.body),post:e(n.proc),funcName:n.funcName})}function r(n){for(var r,t=[],i=0;i<n.args.length;++i)t.push("a"+i);return r=new Function("P",["return function ",n.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join("")),r(v(n))}var u=n("cwise-compiler"),f={body:"",args:[],thisVars:[],localVars:[]},a={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},o,s,h,c,l;(function(){var n,t;for(n in a)t=a[n],i[n]=r({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:n}),i[n+"eq"]=r({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:n+"eq"}),i[n+"s"]=r({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:n+"s"}),i[n+"seq"]=r({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:n+"seq"})})();o={not:"!",bnot:"~",neg:"-",recip:"1.0/"},function(){var n,t;for(n in o)t=o[n],i[n]=r({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:n}),i[n+"eq"]=r({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:n+"eq"})}();s={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="},function(){var n,t;for(n in s)t=s[n],i[n]=r({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:n}),i[n+"s"]=r({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:n+"s"}),i[n+"eq"]=r({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:n+"eq"}),i[n+"seq"]=r({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:n+"seq"})}();h=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"],function(){for(var n,t=0;t<h.length;++t)n=h[t],i[n]=r({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),i[n+"eq"]=r({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}();c=["max","min","atan2","pow"],function(){for(var n,t=0;t<c.length;++t)n=c[t],i[n]=r({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),i[n+"s"]=r({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),i[n+"eq"]=r({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),i[n+"seq"]=r({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}();l=["atan2","pow"],function(){for(var n,t=0;t<l.length;++t)n=l[t],i[n+"op"]=r({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),i[n+"ops"]=r({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),i[n+"opeq"]=r({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),i[n+"opseq"]=r({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}();i.any=u({args:["array"],pre:f,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});i.all=u({args:["array"],pre:f,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});i.sum=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});i.prod=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});i.norm2squared=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});i.norm2=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});i.norminf=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});i.norm1=u({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});i.sup=u({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});i.inf=u({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});i.argmin=u({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});i.argmax=u({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});i.random=r({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});i.assign=r({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});i.assigns=r({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});i.equals=u({args:["array","array"],pre:f,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":125}],525:[function(n,t){function o(n,t){return n[0]-t[0]}function s(){for(var r=this.stride,t=new Array(r.length),i,n=0;n<t.length;++n)t[n]=[Math.abs(r[n]),n];for(t.sort(o),i=new Array(t.length),n=0;n<i.length;++n)i[n]=t[n][1];return i}function r(n,t){var f=["View",t,"d",n].join(""),l,e,b,k,v,y,r,c;if(t<0&&(f="View_Nil"+n),l=n==="generic",t===-1)return e="function "+f+"(a){this.data=a;};var proto="+f+".prototype;proto.dtype='"+n+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+f+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+f+"(a){return new "+f+"(a);}",c=new Function(e),c();if(t===0)return e="function "+f+"(a,d) {this.data = a;this.offset = d};var proto="+f+".prototype;proto.dtype='"+n+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+f+"_copy() {return new "+f+"(this.data,this.offset)};proto.pick=function "+f+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+f+"_get(){return "+(l?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+f+"_set(v){return "+(l?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+f+"(a,b,c,d){return new "+f+"(a,d)}",c=new Function("TrivialArray",e),c(i[n][0]);var e=["'use strict'"],o=u(t),h=o.map(function(n){return"i"+n}),a="this.offset+"+o.map(function(n){return"this.stride["+n+"]*i"+n}).join("+"),p=o.map(function(n){return"b"+n}).join(","),w=o.map(function(n){return"c"+n}).join(",");for(e.push("function "+f+"(a,"+p+","+w+",d){this.data=a","this.shape=["+p+"]","this.stride=["+w+"]","this.offset=d|0}","var proto="+f+".prototype","proto.dtype='"+n+"'","proto.dimension="+t),e.push("Object.defineProperty(proto,'size',{get:function "+f+"_size(){return "+o.map(function(n){return"this.shape["+n+"]"}).join("*"),"}})"),t===1?e.push("proto.order=[0]"):(e.push("Object.defineProperty(proto,'order',{get:"),t<4?(e.push("function "+f+"_order(){"),t===2?e.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):t===3&&e.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):e.push("ORDER})")),e.push("proto.set=function "+f+"_set("+h.join(",")+",v){"),l?e.push("return this.data.set("+a+",v)}"):e.push("return this.data["+a+"]=v}"),e.push("proto.get=function "+f+"_get("+h.join(",")+"){"),l?e.push("return this.data.get("+a+")}"):e.push("return this.data["+a+"]}"),e.push("proto.index=function "+f+"_index(",h.join(),"){return "+a+"}"),e.push("proto.hi=function "+f+"_hi("+h.join(",")+"){return new "+f+"(this.data,"+o.map(function(n){return["(typeof i",n,"!=='number'||i",n,"<0)?this.shape[",n,"]:i",n,"|0"].join("")}).join(",")+","+o.map(function(n){return"this.stride["+n+"]"}).join(",")+",this.offset)}"),b=o.map(function(n){return"a"+n+"=this.shape["+n+"]"}),k=o.map(function(n){return"c"+n+"=this.stride["+n+"]"}),e.push("proto.lo=function "+f+"_lo("+h.join(",")+"){var b=this.offset,d=0,"+b.join(",")+","+k.join(",")),r=0;r<t;++r)e.push("if(typeof i"+r+"==='number'&&i"+r+">=0){d=i"+r+"|0;b+=c"+r+"*d;a"+r+"-=d}");for(e.push("return new "+f+"(this.data,"+o.map(function(n){return"a"+n}).join(",")+","+o.map(function(n){return"c"+n}).join(",")+",b)}"),e.push("proto.step=function "+f+"_step("+h.join(",")+"){var "+o.map(function(n){return"a"+n+"=this.shape["+n+"]"}).join(",")+","+o.map(function(n){return"b"+n+"=this.stride["+n+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),r=0;r<t;++r)e.push("if(typeof i"+r+"==='number'){d=i"+r+"|0;if(d<0){c+=b"+r+"*(a"+r+"-1);a"+r+"=ceil(-a"+r+"/d)}else{a"+r+"=ceil(a"+r+"/d)}b"+r+"*=d}");for(e.push("return new "+f+"(this.data,"+o.map(function(n){return"a"+n}).join(",")+","+o.map(function(n){return"b"+n}).join(",")+",c)}"),v=new Array(t),y=new Array(t),r=0;r<t;++r)v[r]="a[i"+r+"]",y[r]="b[i"+r+"]";for(e.push("proto.transpose=function "+f+"_transpose("+h+"){"+h.map(function(n,t){return n+"=("+n+"===undefined?"+t+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+f+"(this.data,"+v.join(",")+","+y.join(",")+",this.offset)}"),e.push("proto.pick=function "+f+"_pick("+h+"){var a=[],b=[],c=this.offset"),r=0;r<t;++r)e.push("if(typeof i"+r+"==='number'&&i"+r+">=0){c=(c+this.stride["+r+"]*i"+r+")|0}else{a.push(this.shape["+r+"]);b.push(this.stride["+r+"])}");return e.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),e.push("return function construct_"+f+"(data,shape,stride,offset){return new "+f+"(data,"+o.map(function(n){return"shape["+n+"]"}).join(",")+","+o.map(function(n){return"stride["+n+"]"}).join(",")+",offset)}"),c=new Function("CTOR_LIST","ORDER",e.join("\n")),c(i[n],s)}function h(n){if(f(n))return"buffer";if(e)switch(Object.prototype.toString.call(n)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(n)?"array":"generic"}function c(n,t,u,f){var o,l,e,a,s,c;if(n===undefined)return c=i.array[0],c([]);if(typeof n=="number"&&(n=[n]),t===undefined&&(t=[n.length]),o=t.length,u===undefined)for(u=new Array(o),e=o-1,l=1;e>=0;--e)u[e]=l,l*=t[e];if(f===undefined)for(f=0,e=0;e<o;++e)u[e]<0&&(f-=(t[e]-1)*u[e]);for(a=h(n),s=i[a];s.length<=o+1;)s.push(r(a,s.length-1));return c=s[o+1],c(n,t,u,f)}var u=n("iota-array"),f=n("is-buffer"),e=typeof Float64Array!="undefined",i={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var n in i)i[n].push(r(n,-1))});t.exports=c},{"iota-array":319,"is-buffer":320}],526:[function(n,t,i){arguments[4][229][0].apply(i,arguments)},{dup:229}],527:[function(n,t){(function(n){t.exports=n.performance&&n.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],528:[function(n,t){"use strict";function f(n){for(var i,r,e,o="robustLinearSolve"+n+"d",t=["function ",o,"(A,b){return ["],f=0;f<n;++f){for(t.push("det(["),i=0;i<n;++i){for(i>0&&t.push(","),t.push("["),r=0;r<n;++r)r>0&&t.push(","),r===f?t.push("+b[",i,"]"):t.push("+A[",i,"][",r,"]");t.push("]")}t.push("]),")}return(t.push("det(A)]}return ",o),e=new Function("det",t.join("")),n<6)?e(u[n]):e(u)}function e(){return[0]}function o(n,t){return[[t[0]],[n[0][0]]]}function s(){for(var u,e,o,n;i.length<r;)i.push(f(i.length));for(u=[],e=["function dispatchLinearSolve(A,b){switch(A.length){"],n=0;n<r;++n)u.push("s"+n),e.push("case ",n,":return s",n,"(A,b);");for(e.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),u.push("CACHE","g",e.join("")),o=Function.apply(undefined,u),t.exports=o.apply(undefined,i.concat([i,f])),n=0;n<r;++n)t.exports[n]=i[n]}var u=n("robust-determinant"),r=6,i=[e,o];s()},{"robust-determinant":530}],529:[function(n,t){"use strict";function i(n){for(var o,r,u,e,f,s=n.length,t=n[n.length-1],h=s,i=s-2;i>=0;--i)r=t,u=n[i],t=r+u,e=t-r,f=u-e,f&&(n[--h]=t,t=f);for(o=0,i=h;i<s;++i)r=n[i],u=t,t=r+u,e=t-r,f=u-e,f&&(n[o++]=f);return n[o++]=t,n.length=o,n}t.exports=i},{}],530:[function(n,t){"use strict";function l(n,t){for(var f,i,e,u=new Array(n.length-1),r=1;r<n.length;++r)for(f=u[r-1]=new Array(n.length-1),i=0,e=0;i<n.length;++i)i!==t&&(f[e++]=n[r][i]);return u}function a(n){for(var i,r=new Array(n),t=0;t<n;++t)for(r[t]=new Array(n),i=0;i<n;++i)r[t][i]=["m[",t,"][",i,"]"].join("");return r}function v(n){return n&1?"-":""}function r(n){if(n.length===1)return n[0];if(n.length===2)return["sum(",n[0],",",n[1],")"].join("");var t=n.length>>1;return["sum(",r(n.slice(0,t)),",",r(n.slice(t)),")"].join("")}function f(n){var i,t;if(n.length===2)return["sum(prod(",n[0][0],",",n[1][1],"),prod(-",n[0][1],",",n[1][0],"))"].join("");for(i=[],t=0;t<n.length;++t)i.push(["scale(",f(l(n,t)),",",v(t),n[0][t],")"].join(""));return r(i)}function e(n){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",n,"(m){return compress(",f(a(n)),")};return robustDeterminant",n].join(""));return t(s,h,o,c)}function y(){for(var r,f,o,n;i.length<u;)i.push(e(i.length));for(r=[],f=["function robustDeterminant(m){switch(m.length){"],n=0;n<u;++n)r.push("det"+n),f.push("case ",n,":return det",n,"(m);");for(f.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),r.push("CACHE","gen",f.join("")),o=Function.apply(undefined,r),t.exports=o.apply(undefined,i.concat([i,e])),n=0;n<i.length;++n)t.exports[n]=i[n]}var o=n("two-product"),s=n("robust-sum"),h=n("robust-scale"),c=n("robust-compress"),u=6,i=[function(){return[0]},function(n){return[n[0][0]]}];y()},{"robust-compress":529,"robust-scale":532,"robust-sum":534,"two-product":548}],531:[function(n,t){"use strict";function o(n,t){for(var f,i,e,u=new Array(n.length-1),r=1;r<n.length;++r)for(f=u[r-1]=new Array(n.length-1),i=0,e=0;i<n.length;++i)i!==t&&(f[e++]=n[r][i]);return u}function p(n){for(var i,r=new Array(n),t=0;t<n;++t)for(r[t]=new Array(n),i=0;i<n;++i)r[t][i]=["m",i,"[",n-t-1,"]"].join("");return r}function w(n){return n&1?"-":""}function r(n){if(n.length===1)return n[0];if(n.length===2)return["sum(",n[0],",",n[1],")"].join("");var t=n.length>>1;return["sum(",r(n.slice(0,t)),",",r(n.slice(t)),")"].join("")}function s(n){var i,t;if(n.length===2)return[["sum(prod(",n[0][0],",",n[1][1],"),prod(-",n[0][1],",",n[1][0],"))"].join("")];for(i=[],t=0;t<n.length;++t)i.push(["scale(",r(s(o(n,t))),",",w(t),n[0][t],")"].join(""));return i}function e(n){for(var i=[],u=[],f=p(n),e=[],t=0;t<n;++t)(t&1)==0?i.push.apply(i,s(o(f,t))):u.push.apply(u,s(o(f,t))),e.push("m"+t);var y=r(i),w=r(u),v="orientation"+n+"Exact",b=["function ",v,"(",e.join(),"){var p=",y,",n=",w,",d=sub(p,n);return d[d.length-1];};return ",v].join(""),k=new Function("sum","prod","scale","sub",b);return k(c,h,l,a)}function d(n){var t=i[n.length];return t||(t=i[n.length]=e(n.length)),t.apply(undefined,n)}function g(){for(var r,f,o,s,n;i.length<=u;)i.push(e(i.length));for(r=[],f=["slow"],n=0;n<=u;++n)r.push("a"+n),f.push("o"+n);for(o=["function getOrientation(",r.join(),"){switch(arguments.length){case 0:case 1:return 0;"],n=2;n<=u;++n)o.push("case ",n,":return o",n,"(",r.slice(0,n).join(),");");for(o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),f.push(o.join("")),s=Function.apply(undefined,f),t.exports=s.apply(undefined,[d].concat(i)),n=0;n<=u;++n)t.exports[n]=i[n]}var h=n("two-product"),c=n("robust-sum"),l=n("robust-scale"),a=n("robust-subtract"),u=5,f=11102230246251565e-32,v=(3+16*f)*f,y=(7+56*f)*f,b=e(3),k=e(4),i=[function(){return 0},function(){return 0},function(n,t){return t[0]-n[0]},function(n,t,i){var u=(n[1]-i[1])*(t[0]-i[0]),f=(n[0]-i[0])*(t[1]-i[1]),r=u-f,e,o;if(u>0){if(f<=0)return r;e=u+f}else if(u<0){if(f>=0)return r;e=-(u+f)}else return r;return(o=v*e,r>=o||r<=-o)?r:b(n,t,i)},function(n,t,i,r){var f=n[0]-r[0],e=t[0]-r[0],o=i[0]-r[0],s=n[1]-r[1],h=t[1]-r[1],c=i[1]-r[1],l=n[2]-r[2],a=t[2]-r[2],v=i[2]-r[2],p=e*c,w=o*h,b=o*s,d=f*c,g=f*h,nt=e*s,u=l*(p-w)+a*(b-d)+v*(g-nt),it=(Math.abs(p)+Math.abs(w))*Math.abs(l)+(Math.abs(b)+Math.abs(d))*Math.abs(a)+(Math.abs(g)+Math.abs(nt))*Math.abs(v),tt=y*it;return u>tt||-u>tt?u:k(n,t,i,r)}];g()},{"robust-scale":532,"robust-subtract":533,"robust-sum":534,"two-product":548}],532:[function(n,t){"use strict";function u(n,t){var h=n.length,o,s,l;if(h===1)return(o=i(n[0],t),o[0])?o:[o[1]];var f=new Array(2*h),u=[.1,.1],c=[.1,.1],e=0;for(i(n[0],t,u),u[0]&&(f[e++]=u[0]),s=1;s<h;++s){i(n[s],t,c);l=u[1];r(l,c[0],u);u[0]&&(f[e++]=u[0]);var a=c[1],v=u[1],y=a+v,w=y-a,p=v-w;u[1]=y;p&&(f[e++]=p)}return u[1]&&(f[e++]=u[1]),e===0&&(f[e++]=0),f.length=e,f}var i=n("two-product"),r=n("two-sum");t.exports=u},{"two-product":548,"two-sum":549}],533:[function(n,t){"use strict";function i(n,t){var i=n+t,r=i-n,f=i-r,e=t-r,o=n-f,u=o+e;return u?[u,i]:[i]}function r(n,t){var v=n.length|0,y=t.length|0;if(v===1&&y===1)return i(n[0],-t[0]);var ft=v+y,w=new Array(ft),b=0,r=0,u=0,k=Math.abs,h=n[r],nt=k(h),c=-t[u],tt=k(c),f,s;nt<tt?(s=h,r+=1,r<v&&(h=n[r],nt=k(h))):(s=c,u+=1,u<y&&(c=-t[u],tt=k(c)));r<v&&nt<tt||u>=y?(f=h,r+=1,r<v&&(h=n[r],nt=k(h))):(f=c,u+=1,u<y&&(c=-t[u],tt=k(c)));for(var e=f+s,g=e-f,a=s-g,d=a,o=e,l,p,it,rt,ut;r<v&&u<y;)nt<tt?(f=h,r+=1,r<v&&(h=n[r],nt=k(h))):(f=c,u+=1,u<y&&(c=-t[u],tt=k(c))),s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l;while(r<v)f=h,s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l,r+=1,r<v&&(h=n[r]);while(u<y)f=c,s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l,u+=1,u<y&&(c=-t[u]);return d&&(w[b++]=d),o&&(w[b++]=o),b||(w[b++]=0),w.length=b,w}t.exports=r},{}],534:[function(n,t){"use strict";function i(n,t){var i=n+t,r=i-n,f=i-r,e=t-r,o=n-f,u=o+e;return u?[u,i]:[i]}function r(n,t){var v=n.length|0,y=t.length|0;if(v===1&&y===1)return i(n[0],t[0]);var ft=v+y,w=new Array(ft),b=0,r=0,u=0,k=Math.abs,h=n[r],nt=k(h),c=t[u],tt=k(c),f,s;nt<tt?(s=h,r+=1,r<v&&(h=n[r],nt=k(h))):(s=c,u+=1,u<y&&(c=t[u],tt=k(c)));r<v&&nt<tt||u>=y?(f=h,r+=1,r<v&&(h=n[r],nt=k(h))):(f=c,u+=1,u<y&&(c=t[u],tt=k(c)));for(var e=f+s,g=e-f,a=s-g,d=a,o=e,l,p,it,rt,ut;r<v&&u<y;)nt<tt?(f=h,r+=1,r<v&&(h=n[r],nt=k(h))):(f=c,u+=1,u<y&&(c=t[u],tt=k(c))),s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l;while(r<v)f=h,s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l,r+=1,r<v&&(h=n[r]);while(u<y)f=c,s=d,e=f+s,g=e-f,a=s-g,a&&(w[b++]=a),l=o+e,p=l-o,it=l-p,rt=e-p,ut=o-it,d=ut+rt,o=l,u+=1,u<y&&(c=t[u]);return d&&(w[b++]=d),o&&(w[b++]=o),b||(w[b++]=0),w.length=b,w}t.exports=r},{}],535:[function(n,t){"use strict";function r(n){return n.split("").map(function(n){return n in i?i[n]:""}).join("")}t.exports=r;var i={" ":" ","0":"⁰","1":"¹","2":"²","3":"³","4":"⁴","5":"⁵","6":"⁶","7":"⁷","8":"⁸","9":"⁹","+":"⁺","-":"⁻",a:"ᵃ",b:"ᵇ",c:"ᶜ",d:"ᵈ",e:"ᵉ",f:"ᶠ",g:"ᵍ",h:"ʰ",i:"ⁱ",j:"ʲ",k:"ᵏ",l:"ˡ",m:"ᵐ",n:"ⁿ",o:"ᵒ",p:"ᵖ",r:"ʳ",s:"ˢ",t:"ᵗ",u:"ᵘ",v:"ᵛ",w:"ʷ",x:"ˣ",y:"ʸ",z:"ᶻ"}},{}],536:[function(n,t){"use strict";function h(n){return"a"+n}function e(n){return"d"+n}function i(n,t){return"c"+n+"_"+t}function o(n){return"s"+n}function v(n,t){return"t"+n+"_"+t}function tt(n){return"o"+n}function c(n){return"x"+n}function r(n){return"p"+n}function w(n,t){return"d"+n+"_"+t}function s(n){return"i"+n}function y(n,t){return"u"+n+"_"+t}function u(n){return"b"+n}function b(n){return"y"+n}function l(n){return"e"+n}function k(n){return"v"+n}function rt(n,t,i){for(var u=0,r=0;r<n;++r)t&1<<r&&(u|=1<<i[r]);return u}function ut(n,t,ut,ft,et,ot){function ui(n,t){lt.push("for(",s(et[n]),"=",t,";",s(et[n]),"<",o(et[n]),";","++",s(et[n]),"){")}function fi(n){for(var t=0;t<vt;++t)lt.push(r(t),"+=",y(t,et[n]),";");lt.push("}")}function hi(n){for(var i,u,t=n-1;t>=0;--t)ui(t,0);for(i=[],t=0;t<vt;++t)ot[t]?i.push(e(t)+".get("+r(t)+")"):i.push(e(t)+"["+r(t)+"]");for(t=0;t<ft;++t)i.push(c(t));for(lt.push(a,"[",f,"++]=phase(",i.join(),");"),t=0;t<n;++t)fi(t);for(u=0;u<vt;++u)lt.push(r(u),"+=",y(u,et[n]),";")}function ci(n){for(var g,tt,y,b,nt,o,h,t=0;t<vt;++t)ot[t]?lt.push(i(t,0),"=",e(t),".get(",r(t),");"):lt.push(i(t,0),"=",e(t),"[",r(t),"];");for(g=[],t=0;t<vt;++t)g.push(i(t,0));for(t=0;t<ft;++t)g.push(c(t));for(lt.push(u(0),"=",a,"[",f,"]=phase(",g.join(),");"),o=1;o<1<<ht;++o)lt.push(u(o),"=",a,"[",f,"+",l(o),"];");for(tt=[],o=1;o<1<<ht;++o)tt.push("("+u(0)+"!=="+u(o)+")");for(lt.push("if(",tt.join("||"),"){"),y=[],t=0;t<ht;++t)y.push(s(t));for(t=0;t<vt;++t)for(y.push(i(t,0)),o=1;o<1<<ht;++o)ot[t]?lt.push(i(t,o),"=",e(t),".get(",r(t),"+",w(t,o),");"):lt.push(i(t,o),"=",e(t),"[",r(t),"+",w(t,o),"];"),y.push(i(t,o));for(t=0;t<1<<ht;++t)y.push(u(t));for(t=0;t<ft;++t)y.push(c(t));for(lt.push("vertex(",y.join(),");",k(0),"=",p,"[",f,"]=",it,"++;"),b=(1<<ht)-1,nt=u(b),o=0;o<ht;++o)if((n&~(1<<o))==0){var d=b^1<<o,rt=u(d),v=[];for(h=d;h>0;h=h-1&d)v.push(p+"["+f+"+"+l(h)+"]");for(v.push(k(0)),h=0;h<vt;++h)o&1?v.push(i(h,b),i(h,d)):v.push(i(h,d),i(h,b));for(o&1?v.push(nt,rt):v.push(rt,nt),h=0;h<ft;++h)v.push(c(h));lt.push("if(",nt,"!==",rt,"){","face(",v.join(),")}")}lt.push("}",f,"+=1;")}function ei(){for(var n=1;n<1<<ht;++n)lt.push(g,"=",l(n),";",l(n),"=",b(n),";",b(n),"=",g,";")}function ii(n,t){if(n<0){ci(t);return}hi(n);lt.push("if(",o(et[n]),">0){",s(et[n]),"=1;");ii(n-1,t|1<<et[n]);for(var i=0;i<vt;++i)lt.push(r(i),"+=",y(i,et[n]),";");n===ht-1&&(lt.push(f,"=0;"),ei());ui(n,2);ii(n-1,t);n===ht-1&&(lt.push("if(",s(et[ht-1]),"&1){",f,"=0;}"),ei());fi(n);lt.push("}")}var vt=ot.length,ht=et.length,dt,gt,ni,st,ct,pt,wt,yt,ti,bt,oi,si;if(ht<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");var ri="extractContour"+et.join("_"),lt=[],at=[],kt=[];for(st=0;st<vt;++st)kt.push(h(st));for(st=0;st<ft;++st)kt.push(c(st));for(st=0;st<ht;++st)at.push(o(st)+"="+h(0)+".shape["+st+"]|0");for(st=0;st<vt;++st)for(at.push(e(st)+"="+h(st)+".data",tt(st)+"="+h(st)+".offset|0"),ct=0;ct<ht;++ct)at.push(v(st,ct)+"="+h(st)+".stride["+ct+"]|0");for(st=0;st<vt;++st)for(at.push(r(st)+"="+tt(st)),at.push(i(st,0)),ct=1;ct<1<<ht;++ct){for(dt=[],yt=0;yt<ht;++yt)ct&1<<yt&&dt.push("-"+v(st,yt));at.push(w(st,ct)+"=("+dt.join("")+")|0");at.push(i(st,ct)+"=0")}for(st=0;st<vt;++st)for(ct=0;ct<ht;++ct)gt=[v(st,et[ct])],ct>0&&gt.push(v(st,et[ct-1])+"*"+o(et[ct-1])),at.push(y(st,et[ct])+"=("+gt.join("-")+")|0");for(st=0;st<ht;++st)at.push(s(st)+"=0");for(at.push(it+"=0"),ni=["2"],st=ht-2;st>=0;--st)ni.push(o(et[st]));for(at.push(d+"=("+ni.join("*")+")|0",a+"=mallocUint32("+d+")",p+"=mallocUint32("+d+")",f+"=0"),at.push(u(0)+"=0"),ct=1;ct<1<<ht;++ct){for(pt=[],wt=[],yt=0;yt<ht;++yt)ct&1<<yt&&(wt.length===0?pt.push("1"):pt.unshift(wt.join("*"))),wt.push(o(et[yt]));ti="";pt[0].indexOf(o(et[ht-2]))<0&&(ti="-");bt=rt(ht,ct,et);at.push(l(bt)+"=(-"+pt.join("-")+")|0",b(bt)+"=("+ti+pt.join("-")+")|0",u(bt)+"=0")}return at.push(k(0)+"=0",g+"=0"),ii(ht-1,0),lt.push("freeUint32(",p,");freeUint32(",a,");"),oi=["'use strict';","function ",ri,"(",kt.join(),"){","var ",at.join(),";",lt.join(""),"}","return ",ri].join(""),si=new Function("vertex","face","phase","mallocUint32","freeUint32",oi),si(n,t,ut,nt.mallocUint32,nt.freeUint32)}function ft(n){function t(n){throw new Error("ndarray-extract-contour: "+n);}var u,r,f,o,e,i;for(typeof n!="object"&&t("Must specify arguments"),u=n.order,Array.isArray(u)||t("Must specify order"),r=n.arrayArguments||1,r<1&&t("Must have at least one array argument"),f=n.scalarArguments||0,f<0&&t("Scalar arg count must be > 0"),typeof n.vertex!="function"&&t("Must specify vertex creation function"),typeof n.cell!="function"&&t("Must specify cell creation function"),typeof n.phase!="function"&&t("Must specify phase function"),o=n.getters||[],e=new Array(r),i=0;i<r;++i)e[i]=o.indexOf(i)>=0?!0:!1;return ut(n.vertex,n.cell,n.phase,f,u,e)}var nt=n("typedarray-pool");t.exports=ft;var p="V",a="P",it="N",d="Q",f="X",g="T"},{"typedarray-pool":550}],537:[function(n,t){function f(n){var r,t,u;if(n<0)return Number("0/0");for(r=i[0],t=i.length-1;t>0;--t)r+=i[t]/(n+t);return u=n+e+.5,.5*Math.log(2*Math.PI)+(n+.5)*Math.log(u)-u+Math.log(r)-Math.log(n)}var r=7,u=[.99999999999980993,676.5203681218851,-1259.1392167224028,771.32342877765313,-176.61502916214059,12.507343278686905,-.13857109526572012,99843695780195716e-22,15056327351493116e-23],e=607/128,i=[.99999999999999711,57.156235665862923,-59.597960355475493,14.136097974741746,-.49191381609762019,33994649984811891e-21,46523628927048578e-21,-98374475304879565e-21,.00015808870322491249,-.00021026444172410488,.00021743961811521265,-.00016431810653676389,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];t.exports=function o(n){var i,t,e;if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*o(1-n));if(n>100)return Math.exp(f(n));for(n-=1,i=u[0],t=1;t<r+2;t++)i+=u[t]/(n+t);return e=n+r+.5,Math.sqrt(2*Math.PI)*Math.pow(e,n+.5)*Math.exp(-e)*i};t.exports.log=f},{}],538:[function(n,t){"use strict";function u(n){var o=n.length,e,f,t,s,u;if(o<r){for(f=1,t=0;t<o;++t)for(u=0;u<t;++u)if(n[t]<n[u])f=-f;else if(n[t]===n[u])return 0;return f}for(e=i.mallocUint8(o),t=0;t<o;++t)e[t]=0;for(f=1,t=0;t<o;++t)if(!e[t]){for(s=1,e[t]=1,u=n[t];u!==t;u=n[u]){if(e[u])return i.freeUint8(e),0;s+=1;e[u]=1}s&1||(f=-f)}return i.freeUint8(e),f}t.exports=u;var r=32,i=n("typedarray-pool")},{"typedarray-pool":550}],539:[function(n,t,i){"use strict";function f(n){var e=n.length;switch(e){case 0:case 1:return 0;case 2:return n[1]}var i=r.mallocUint32(e),f=r.mallocUint32(e),h=0,o,s,t;for(u(n,f),t=0;t<e;++t)i[t]=n[t];for(t=e-1;t>0;--t)s=f[t],o=i[t],i[t]=i[s],i[s]=o,f[t]=f[o],f[o]=s,h=(h+o)*t;return r.freeUint32(f),r.freeUint32(i),h}function e(n,t,i){switch(n){case 0:return i?i:[];case 1:return i?(i[0]=0,i):[0];case 2:return i?(t?(i[0]=0,i[1]=1):(i[0]=1,i[1]=0),i):t?[0,1]:[1,0]}i=i||new Array(n);var f,e,r,u=1;for(i[0]=0,r=1;r<n;++r)i[r]=r,u=u*r|0;for(r=n-1;r>0;--r)f=t/u|0,t=t-f*u|0,u=u/r|0,e=i[r]|0,i[r]=i[f]|0,i[f]=e|0;return i}var r=n("typedarray-pool"),u=n("invert-permutation");i.rank=f;i.unrank=e},{"invert-permutation":540,"typedarray-pool":550}],540:[function(n,t){"use strict";function i(n,t){t=t||new Array(n.length);for(var i=0;i<n.length;++i)t[n[i]]=i;return t}t.exports=i},{}],541:[function(n,t){"use strict";function f(n){var c,o,t,e;if(n<0)return[];if(n===0)return[[0]];for(c=Math.round(u(n+1))|0,o=[],t=0;t<c;++t){var s=i.unrank(n,t),f=[0],h=0;for(e=0;e<s.length;++e)h+=1<<s[e],f.push(h);r(s)<1&&(f[0]=h,f[n]=0);o.push(f)}return o}t.exports=f;var i=n("permutation-rank"),r=n("permutation-parity"),u=n("gamma")},{gamma:537,"permutation-parity":538,"permutation-rank":539}],542:[function(n,t){t.exports=n("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":125}],543:[function(n,t){"use strict";function r(n,t){var r=[];return t=+t||0,i(n.hi(n.shape[0]-1),r,t),r}t.exports=r;var i=n("./lib/zc-core")},{"./lib/zc-core":542}],544:[function(n,t){"use strict";function e(n,t){var e=n.length,s=["'use strict';"],et="surfaceNets"+n.join("_")+"d"+t,p,l,it,a,c,rt,o,h,d,y,g,f,nt,ot,st,tt,ft,i,ht;for(s.push("var contour=genContour({","order:[",n.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),t==="generic"&&s.push("getters:[0],"),p=[],l=[],i=0;i<e;++i)p.push("d"+i),l.push("d"+i);for(i=0;i<1<<e;++i)p.push("v"+i),l.push("v"+i);for(i=0;i<1<<e;++i)p.push("p"+i),l.push("p"+i);for(p.push("a","b","c"),l.push("a","c"),s.push("vertex:function vertexFunc(",p.join(),"){"),it=[],i=0;i<1<<e;++i)it.push("(p"+i+"<<"+i+")");for(s.push("var m=(",it.join("+"),")|0;if(m===0||m===",(1<<(1<<e))-1,"){return}"),a=[],c=[],1<<(1<<e)<=128?(s.push("switch(m){"),c=s):s.push("switch(m>>>7){"),i=0;i<1<<(1<<e);++i){1<<(1<<e)>128&&i%128==0&&(a.length>0&&c.push("}}"),rt="vExtra"+a.length,s.push("case ",i>>>7,":",rt,"(m&0x7f,",l.join(),");break;"),c=["function ",rt,"(m,",l.join(),"){switch(m){"],a.push(c));c.push("case ",i&127,":");var w=new Array(e),b=new Array(e),v=new Array(e),k=new Array(e),ut=0;for(o=0;o<e;++o)w[o]=[],b[o]=[],v[o]=0,k[o]=0;for(o=0;o<1<<e;++o)for(f=0;f<e;++f)if((h=o^1<<f,!(h>o))&&!(i&1<<h)!=!(i&1<<o))for(d=1,i&1<<h?b[f].push("v"+h+"-v"+o):(b[f].push("v"+o+"-v"+h),d=-d),d<0?(w[f].push("-v"+o+"-v"+h),v[f]+=2):(w[f].push("v"+o+"+v"+h),v[f]-=2),ut+=1,y=0;y<e;++y)y!==f&&(h&1<<y?k[y]+=1:k[y]-=1);for(g=[],f=0;f<e;++f)w[f].length===0?g.push("d"+f+"-0.5"):(nt="",v[f]<0?nt=v[f]+"*c":v[f]>0&&(nt="+"+v[f]+"*c"),ot=.5*(w[f].length/ut),st=.5+.5*(k[f]/ut),g.push("d"+f+"-"+st+"-"+ot+"*("+w[f].join("+")+nt+")/("+b[f].join("+")+")"));c.push("a.push([",g.join(),"]);","break;")}for(s.push("}},"),a.length>0&&c.push("}}"),tt=[],i=0;i<1<<e-1;++i)tt.push("v"+i);for(tt.push("c0","c1","p0","p1","a","b","c"),s.push("cell:function cellFunc(",tt.join(),"){"),ft=u(e-1),s.push("if(p0){b.push(",ft.map(function(n){return"["+n.map(function(n){return"v"+n})+"]"}).join(),")}else{b.push(",ft.map(function(n){var t=n.slice();return t.reverse(),"["+t.map(function(n){return"v"+n})+"]"}).join(),")}}});function ",et,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",et,";"),i=0;i<a.length;++i)s.push(a[i].join(""));return ht=new Function("genContour",s.join("")),ht(r)}function o(n,t){for(var u=f(n,t),r=u.length,e=new Array(r),o=new Array(r),i=0;i<r;++i)e[i]=[u[i]],o[i]=[i];return{positions:e,cells:o}}function s(n,t){if(n.dimension<=0)return{positions:[],cells:[]};if(n.dimension===1)return o(n,t);var u=n.order.join()+"-"+n.dtype,r=i[u],t=+t||0;return r||(r=i[u]=e(n.order,n.dtype)),r(n,t)}var i;t.exports=s;var r=n("ndarray-extract-contour"),u=n("triangulate-hypercube"),f=n("zero-crossings");i={}},{"ndarray-extract-contour":536,"triangulate-hypercube":541,"zero-crossings":543}],545:[function(n,t){(function(i){"use strict";function o(n){for(var s,t,i,r=n.cells,h=n.positions,u=new Float32Array(r.length*6),o=0,f=0,e=0;e<r.length;++e)for(s=r[e],t=0;t<3;++t)i=h[s[t]],u[o++]=i[0],u[o++]=i[1]+1.4,f=Math.max(i[0],f);return{data:u,shape:f}}function f(n,t){var s=u[n],h,i,a,c;if(s||(s=u[n]={" ":{data:new Float32Array(0),shape:.2}}),h=s[t],!h)if(t.length<=1||!/\d/.test(t))h=s[t]=o(e(t,{triangles:!0,font:n,textAlign:"left",textBaseline:"alphabetic"}));else{var v=t.split(/(\d|\s)/),r=new Array(v.length),p=0,l=0;for(i=0;i<v.length;++i)r[i]=f(n,v[i]),p+=r[i].data.length,l+=r[i].shape,i>0&&(l+=.02);var y=new Float32Array(p),w=0,b=-.5*l;for(i=0;i<r.length;++i){for(a=r[i].data,c=0;c<a.length;c+=2)y[w++]=a[c]+b,y[w++]=a[c+1];b+=r[i].shape+.02}h=s[t]={data:y,shape:l}}return h}t.exports=f;var e=n("vectorize-text"),r=window||i.global||{},u=r.__TEXT_CACHE||{};r.__TEXT_CACHE={}}).call(this,n("_process"))},{_process:64,"vectorize-text":552}],546:[function(t,i){(function(){function t(n,i){if(n=n?n:"",i=i||{},n instanceof t)return n;if(!(this instanceof t))return new t(n,i);var u=rt(n);this._originalInput=n;this._r=u.r;this._g=u.g;this._b=u.b;this._a=u.a;this._roundA=r(100*this._a)/100;this._format=i.format||u.format;this._gradientType=i.gradientType;this._r<1&&(this._r=r(this._r));this._g<1&&(this._g=r(this._g));this._b<1&&(this._b=r(this._b));this._ok=u.ok;this._tc_id=it++}function rt(n){var t={r:0,g:0,b:0},i=1,r=!1,u=!1;return typeof n=="string"&&(n=ui(n)),typeof n=="object"&&(n.hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")?(t=ut(n.r,n.g,n.b),r=!0,u=String(n.r).substr(-1)==="%"?"prgb":"rgb"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("v")?(n.s=l(n.s),n.v=l(n.v),t=et(n.h,n.s,n.v),r=!0,u="hsv"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("l")&&(n.s=l(n.s),n.l=l(n.l),t=ft(n.h,n.s,n.l),r=!0,u="hsl"),n.hasOwnProperty("a")&&(i=n.a)),i=g(i),{ok:r,format:n.format||u,r:f(255,e(t.r,0)),g:f(255,e(t.g,0)),b:f(255,e(t.b,0)),a:i}}function ut(n,t,i){return{r:u(n,255)*255,g:u(t,255)*255,b:u(i,255)*255}}function p(n,t,i){var s;n=u(n,255);t=u(t,255);i=u(i,255);var r=e(n,t,i),h=f(n,t,i),o,c,l=(r+h)/2;if(r==h)o=c=0;else{s=r-h;c=l>.5?s/(2-r-h):s/(r+h);switch(r){case n:o=(t-i)/s+(t<i?6:0);break;case t:o=(i-n)/s+2;break;case i:o=(n-t)/s+4}o/=6}return{h:o,s:c,l:l}}function ft(n,t,i){function h(n,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?n+(t-n)*6*i:i<1/2?t:i<2/3?n+(t-n)*(2/3-i)*6:n}var e,o,s,r,f;return n=u(n,360),t=u(t,100),i=u(i,100),t===0?e=o=s=i:(r=i<.5?i*(1+t):i+t-i*t,f=2*i-r,e=h(f,r,n+1/3),o=h(f,r,n),s=h(f,r,n-1/3)),{r:e*255,g:o*255,b:s*255}}function w(n,t,i){n=u(n,255);t=u(t,255);i=u(i,255);var r=e(n,t,i),h=f(n,t,i),o,c,l=r,s=r-h;if(c=r===0?0:s/r,r==h)o=0;else{switch(r){case n:o=(t-i)/s+(t<i?6:0);break;case t:o=(i-n)/s+2;break;case i:o=(n-t)/s+4}o/=6}return{h:o,s:c,v:l}}function et(n,t,i){n=u(n,360)*6;t=u(t,100);i=u(i,100);var s=c.floor(n),h=n-s,r=i*(1-t),f=i*(1-h*t),e=i*(1-(1-h)*t),o=s%6,l=[i,f,r,r,e,i][o],a=[e,i,i,f,r,r][o],v=[r,r,e,i,i,f][o];return{r:l*255,g:a*255,b:v*255}}function b(n,t,i,u){var f=[h(r(n).toString(16)),h(r(t).toString(16)),h(r(i).toString(16))];return u&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0):f.join("")}function k(n,t,i,u){var f=[h(ii(u)),h(r(n).toString(16)),h(r(t).toString(16)),h(r(i).toString(16))];return f.join("")}function ot(n,i){i=i===0?0:i||10;var r=t(n).toHsl();return r.s-=i/100,r.s=v(r.s),t(r)}function st(n,i){i=i===0?0:i||10;var r=t(n).toHsl();return r.s+=i/100,r.s=v(r.s),t(r)}function ht(n){return t(n).desaturate(100)}function ct(n,i){i=i===0?0:i||10;var r=t(n).toHsl();return r.l+=i/100,r.l=v(r.l),t(r)}function lt(n,i){i=i===0?0:i||10;var u=t(n).toRgb();return u.r=e(0,f(255,u.r-r(255*-(i/100)))),u.g=e(0,f(255,u.g-r(255*-(i/100)))),u.b=e(0,f(255,u.b-r(255*-(i/100)))),t(u)}function at(n,i){i=i===0?0:i||10;var r=t(n).toHsl();return r.l-=i/100,r.l=v(r.l),t(r)}function vt(n,i){var u=t(n).toHsl(),f=(r(u.h)+i)%360;return u.h=f<0?360+f:f,t(u)}function yt(n){var i=t(n).toHsl();return i.h=(i.h+180)%360,t(i)}function pt(n){var i=t(n).toHsl(),r=i.h;return[t(n),t({h:(r+120)%360,s:i.s,l:i.l}),t({h:(r+240)%360,s:i.s,l:i.l})]}function wt(n){var i=t(n).toHsl(),r=i.h;return[t(n),t({h:(r+90)%360,s:i.s,l:i.l}),t({h:(r+180)%360,s:i.s,l:i.l}),t({h:(r+270)%360,s:i.s,l:i.l})]}function bt(n){var i=t(n).toHsl(),r=i.h;return[t(n),t({h:(r+72)%360,s:i.s,l:i.l}),t({h:(r+216)%360,s:i.s,l:i.l})]}function kt(n,i,r){i=i||6;r=r||30;var u=t(n).toHsl(),f=360/r,e=[t(n)];for(u.h=(u.h-(f*i>>1)+720)%360;--i;)u.h=(u.h+f)%360,e.push(t(u));return e}function dt(n,i){i=i||6;for(var r=t(n).toHsv(),e=r.h,o=r.s,u=r.v,f=[],s=1/i;i--;)f.push(t({h:e,s:o,v:u})),u=(u+s)%1;return f}function gt(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[n[t]]=t);return i}function g(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function u(n,t){ni(n)&&(n="100%");var i=ti(n);return(n=f(t,e(0,parseFloat(n))),i&&(n=parseInt(n*t,10)/100),c.abs(n-t)<1e-6)?1:n%t/parseFloat(t)}function v(n){return f(1,e(0,n))}function o(n){return parseInt(n,16)}function ni(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function ti(n){return typeof n=="string"&&n.indexOf("%")!=-1}function h(n){return n.length==1?"0"+n:""+n}function l(n){return n<=1&&(n=n*100+"%"),n}function ii(n){return Math.round(parseFloat(n)*255).toString(16)}function ri(n){return o(n)/255}function ui(n){var i,t;if(n=n.replace(nt,"").replace(tt,"").toLowerCase(),i=!1,a[n])n=a[n],i=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(t=s.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=s.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=s.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=s.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=s.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=s.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=s.hex8.exec(n))?{a:ri(t[1]),r:o(t[2]),g:o(t[3]),b:o(t[4]),format:i?"name":"hex8"}:(t=s.hex6.exec(n))?{r:o(t[1]),g:o(t[2]),b:o(t[3]),format:i?"name":"hex"}:(t=s.hex3.exec(n))?{r:o(t[1]+""+t[1]),g:o(t[2]+""+t[2]),b:o(t[3]+""+t[3]),format:i?"name":"hex"}:!1}function fi(n){var t,i;return n=n||{level:"AA",size:"small"},t=(n.level||"AA").toUpperCase(),i=(n.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),i!=="small"&&i!=="large"&&(i="small"),{level:t,size:i}}var nt=/^\s+/,tt=/\s+$/,it=0,c=Math,r=c.round,f=c.min,e=c.max,y=c.random,a,d,s;t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},getLuminance:function(){var r=this.toRgb(),n,t,i,u,f,e;return n=r.r/255,t=r.g/255,i=r.b/255,u=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),f=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),e=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),.2126*u+.7152*f+.0722*e},setAlpha:function(n){return this._a=g(n),this._roundA=r(100*this._a)/100,this},toHsv:function(){var n=w(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=w(this._r,this._g,this._b),t=r(n.h*360),i=r(n.s*100),u=r(n.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+u+"%)":"hsva("+t+", "+i+"%, "+u+"%, "+this._roundA+")"},toHsl:function(){var n=p(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=p(this._r,this._g,this._b),t=r(n.h*360),i=r(n.s*100),u=r(n.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+u+"%)":"hsla("+t+", "+i+"%, "+u+"%, "+this._roundA+")"},toHex:function(n){return b(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(){return k(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:r(this._r),g:r(this._g),b:r(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+r(this._r)+", "+r(this._g)+", "+r(this._b)+")":"rgba("+r(this._r)+", "+r(this._g)+", "+r(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:r(u(this._r,255)*100)+"%",g:r(u(this._g,255)*100)+"%",b:r(u(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+r(u(this._r,255)*100)+"%, "+r(u(this._g,255)*100)+"%, "+r(u(this._b,255)*100)+"%)":"rgba("+r(u(this._r,255)*100)+"%, "+r(u(this._g,255)*100)+"%, "+r(u(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:d[b(this._r,this._g,this._b,!0)]||!1},toFilter:function(n){var i="#"+k(this._r,this._g,this._b,this._a),r=i,f=this._gradientType?"GradientType = 1, ":"",u;return n&&(u=t(n),r=u.toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+f+"startColorstr="+i+",endColorstr="+r+")"},toString:function(n){var i=!!n;n=n||this._format;var t=!1,r=this._a<1&&this._a>=0,u=!i&&r&&(n==="hex"||n==="hex6"||n==="hex3"||n==="name");return u?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(t=this.toRgbString()),n==="prgb"&&(t=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(t=this.toHexString()),n==="hex3"&&(t=this.toHexString(!0)),n==="hex8"&&(t=this.toHex8String()),n==="name"&&(t=this.toName()),n==="hsl"&&(t=this.toHslString()),n==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(n,t){var i=n.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(ct,arguments)},brighten:function(){return this._applyModification(lt,arguments)},darken:function(){return this._applyModification(at,arguments)},desaturate:function(){return this._applyModification(ot,arguments)},saturate:function(){return this._applyModification(st,arguments)},greyscale:function(){return this._applyModification(ht,arguments)},spin:function(){return this._applyModification(vt,arguments)},_applyCombination:function(n,t){return n.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(kt,arguments)},complement:function(){return this._applyCombination(yt,arguments)},monochromatic:function(){return this._applyCombination(dt,arguments)},splitcomplement:function(){return this._applyCombination(bt,arguments)},triad:function(){return this._applyCombination(pt,arguments)},tetrad:function(){return this._applyCombination(wt,arguments)}};t.fromRatio=function(n,i){var u,r;if(typeof n=="object"){u={};for(r in n)n.hasOwnProperty(r)&&(u[r]=r==="a"?n[r]:l(n[r]));n=u}return t(n,i)};t.equals=function(n,i){return!n||!i?!1:t(n).toRgbString()==t(i).toRgbString()};t.random=function(){return t.fromRatio({r:y(),g:y(),b:y()})};t.mix=function(n,i,r){var s,l;r=r===0?0:r||50;var f=t(n).toRgb(),e=t(i).toRgb(),h=r/100,o=h*2-1,c=e.a-f.a,u;return u=o*c==-1?o:(o+c)/(1+o*c),u=(u+1)/2,s=1-u,l={r:e.r*u+f.r*s,g:e.g*u+f.g*s,b:e.b*u+f.b*s,a:e.a*h+f.a*(1-h)},t(l)};t.readability=function(n,i){var r=t(n),u=t(i);return(Math.max(r.getLuminance(),u.getLuminance())+.05)/(Math.min(r.getLuminance(),u.getLuminance())+.05)};t.isReadable=function(n,i,r){var f=t.readability(n,i),e,u;u=!1;e=fi(r);switch(e.level+e.size){case"AAsmall":case"AAAlarge":u=f>=4.5;break;case"AAlarge":u=f>=3;break;case"AAAsmall":u=f>=7}return u};t.mostReadable=function(n,i,r){var f=null,o=0,e,s,h,c,u;for(r=r||{},s=r.includeFallbackColors,h=r.level,c=r.size,u=0;u<i.length;u++)e=t.readability(n,i[u]),e>o&&(o=e,f=t(i[u]));return t.isReadable(n,f,{level:h,size:c})||!s?f:(r.includeFallbackColors=!1,t.mostReadable(n,["#fff","#000"],r))};a=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};d=t.hexNames=gt(a);s=function(){var n="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();typeof i!="undefined"&&i.exports?i.exports=t:typeof n=="function"&&n.amd?n(function(){return t}):window.tinycolor=t})()},{}],547:[function(t,i,r){(function(t,u){typeof r=="object"&&typeof i!="undefined"?u(r):typeof n=="function"&&n.amd?n(["exports"],u):u(t.topojson={})})(this,function(n){"use strict";function r(){}function u(n){if(!n)return r;var t,i,u=n.scale[0],f=n.scale[1],e=n.translate[0],o=n.translate[1];return function(n,r){r||(t=i=0);n[0]=(t+=n[0])*u+e;n[1]=(i+=n[1])*f+o}}function c(n){if(!n)return r;var t,i,u=n.scale[0],f=n.scale[1],e=n.translate[0],o=n.translate[1];return function(n,r){r||(t=i=0);var s=(n[0]-e)/u|0,h=(n[1]-o)/f|0;n[0]=s-t;n[1]=h-i;t=s;i=h}}function l(n,t){for(var u,i=n.length,r=i-t;r<--i;)u=n[r],n[r++]=n[i],n[i]=u}function f(n,t){for(var i=0,u=n.length,r;i<u;)r=i+u>>>1,n[r]<t?i=r+1:u=r;return i}function a(n,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return e(n,t)})}:e(n,t)}function e(n,i){var r={type:"Feature",id:i.id,properties:i.properties||{},geometry:t(n,i)};return i.id==null&&delete r.id,r}function t(n,t){function c(n,t){t.length&&t.pop();for(var u=h[n<0?~n:n],i=0,f=u.length,e;i<f;++i)t.push(e=u[i].slice()),r(e,i);n<0&&l(t,f)}function f(n){return n=n.slice(),r(n,0),n}function i(n){for(var t=[],i=0,r=n.length;i<r;++i)c(n[i],t);return t.length<2&&t.push(t[0].slice()),t}function a(n){for(var t=i(n);t.length<4;)t.push(t[0].slice());return t}function e(n){return n.map(a)}function o(n){var t=n.type;return t==="GeometryCollection"?{type:t,geometries:n.geometries.map(o)}:t in s?{type:t,coordinates:s[t](n)}:null}var r=u(n.transform),h=n.arcs,s={Point:function(n){return f(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(f)},LineString:function(n){return i(n.arcs)},MultiLineString:function(n){return n.arcs.map(i)},Polygon:function(n){return e(n.arcs)},MultiPolygon:function(n){return n.arcs.map(e)}};return o(t)}function o(n,t){function s(t){var r=n.arcs[t<0?~t:t],u=r[0],i;return n.transform?(i=[0,0],r.forEach(function(n){i[0]+=n[0];i[1]+=n[1]})):i=r[r.length-1],t<0?[i,u]:[u,i]}function o(n,t){var r,i;for(r in n)i=n[r],delete t[i.start],delete i.start,delete i.end,i.forEach(function(n){f[n<0?~n:n]=1}),u.push(i)}var f={},i={},r={},u=[],e=-1;return t.forEach(function(i,r){var u=n.arcs[i<0?~i:i],f;u.length<3&&!u[1][0]&&!u[1][1]&&(f=t[++e],t[e]=i,t[r]=f)}),t.forEach(function(n){var c=s(n),f=c[0],e=c[1],t,u,o,h;(t=r[f])?(delete r[t.end],t.push(n),t.end=e,(u=i[e])?(delete i[u.start],o=u===t?t:t.concat(u),i[o.start=t.start]=r[o.end=u.end]=o):i[t.start]=r[t.end]=t):(t=i[e])?(delete i[t.start],t.unshift(n),t.start=f,(u=r[f])?(delete r[u.end],h=u===t?t:u.concat(t),i[h.start=u.start]=r[h.end=t.end]=h):i[t.start]=r[t.end]=t):(t=[n],i[t.start=f]=r[t.end=e]=t)}),o(r,i),o(i,r),t.forEach(function(n){f[n<0?~n:n]||u.push([n])}),u}function v(n){return t(n,s.apply(this,arguments))}function s(n,t,i){function v(n){var t=n<0?~n:n;(u[t]||(u[t]=[])).push({i:n,g:l})}function h(n){n.forEach(v)}function e(n){n.forEach(h)}function c(n){n.type==="GeometryCollection"?n.geometries.forEach(c):n.type in s&&(l=n,s[n.type](n.arcs))}var r=[],u,l,s,f,a;if(arguments.length>1)u=[],s={LineString:h,MultiLineString:e,Polygon:e,MultiPolygon:function(n){n.forEach(e)}},c(t),u.forEach(arguments.length<3?function(n){r.push(n[0].i)}:function(n){i(n[0].g,n[n.length-1].g)&&r.push(n[0].i)});else for(f=0,a=n.arcs.length;f<a;++f)r.push(f);return{type:"MultiLineString",arcs:o(n,r)}}function y(n){var t=n[0],i=n[1],r=n[2];return Math.abs((t[0]-r[0])*(i[1]-t[1])-(t[0]-i[0])*(r[1]-t[1]))}function p(n){for(var r=-1,u=n.length,i,t=n[u-1],f=0;++r<u;)i=t,t=n[r],f+=i[0]*t[1]-i[1]*t[0];return f/2}function w(n){return t(n,h.apply(this,arguments))}function h(n,i){function e(n){n.forEach(function(t){t.forEach(function(t){(r[t=t<0?~t:t]||(r[t]=[])).push(n)})});u.push(n)}function s(i){return p(t(n,{type:"Polygon",arcs:[i]}).coordinates[0])>0}var r={},u=[],f=[];return i.forEach(function(n){n.type==="Polygon"?e(n.arcs):n.type==="MultiPolygon"&&n.arcs.forEach(e)}),u.forEach(function(n){if(!n._){var t=[],i=[n];for(n._=1,f.push(t);n=i.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){r[n<0?~n:n].forEach(function(n){n._||(n._=1,i.push(n))})})})}}),u.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:f.map(function(t){var i=[],f,e,u,h;if(t.forEach(function(n){n.forEach(function(n){n.forEach(function(n){r[n<0?~n:n].length<2&&i.push(n)})})}),i=o(n,i),(f=i.length)>1)for(e=s(t[0][0]),u=0;u<f;++u)if(e===s(i[u])){h=i[0];i[0]=i[u];i[u]=h;break}return i})}}function b(n){function a(n,t){n.forEach(function(n){n<0&&(n=~n);var i=e[n];i?i.push(t):e[n]=[t]})}function c(n,t){n.forEach(function(n){a(n,t)})}function v(n,t){n.type==="GeometryCollection"?n.geometries.forEach(function(n){v(n,t)}):n.type in y&&y[n.type](n.arcs,t)}var e={},h=n.map(function(){return[]}),y={LineString:a,MultiLineString:c,Polygon:c,MultiPolygon:function(n,t){n.forEach(function(n){c(n,t)})}},t,s,r,u,i;n.forEach(v);for(t in e)for(var l=e[t],p=l.length,o=0;o<p;++o)for(s=o+1;s<p;++s)r=l[o],u=l[s],(i=h[r])[t=f(i,u)]!==u&&i.splice(t,0,u),(i=h[u])[t=f(i,r)]!==r&&i.splice(t,0,r);return h}function i(n,t){return n[1][2]-t[1][2]}function k(){function u(t,r){while(r>0){var f=(r+1>>1)-1,u=n[f];if(i(t,u)>=0)break;n[u._=r]=u;n[t._=r=f]=t}}function f(r,u){for(;;){var o=u+1<<1,s=o-1,e=u,f=n[e];if(s<t&&i(n[s],f)<0&&(f=n[e=s]),o<t&&i(n[o],f)<0&&(f=n[e=o]),e===u)break;n[f._=u]=f;n[r._=u=e]=r}}var r={},n=[],t=0;return r.push=function(i){return u(n[i._=t]=i,t++),t},r.pop=function(){if(!(t<=0)){var r=n[0],i;return--t>0&&(i=n[t],f(n[i._=0]=i,0)),r}},r.remove=function(r){var e=r._,o;if(n[e]===r)return e!==--t&&(o=n[t],(i(o,r)<0?u:f)(n[o._=e]=o,e)),e},r}function d(n,t){function r(n){i.remove(n);n[1][2]=t(n);i.push(n)}var f=u(n.transform),e=c(n.transform),i=k();return t||(t=y),n.arcs.forEach(function(n){for(var l=[],a=0,o,v,h,c,u=0,s=n.length;u<s;++u)v=n[u],f(n[u]=[v[0],v[1],Infinity],u);for(u=1,s=n.length-1;u<s;++u)o=n.slice(u-1,u+2),o[1][2]=t(o),l.push(o),i.push(o);for(u=0,s=l.length;u<s;++u)o=l[u],o.previous=l[u-1],o.next=l[u+1];while(o=i.pop())h=o.previous,c=o.next,o[1][2]<a?o[1][2]=a:a=o[1][2],h&&(h.next=c,h[2]=o[2],r(h)),c&&(c.previous=h,c[0]=o[0],r(c));n.forEach(e)}),n}n.version="1.6.24";n.mesh=v;n.meshArcs=s;n.merge=w;n.mergeArcs=h;n.feature=a;n.neighbors=b;n.presimplify=d})},{}],548:[function(n,t){"use strict";function r(n,t,r){var u=n*t,o=i*n,a=o-n,f=o-a,s=n-f,h=i*t,v=h-t,e=h-v,c=t-e,y=u-f*e,p=y-s*e,w=p-f*c,l=s*c-w;return r?(r[0]=l,r[1]=u,r):[l,u]}t.exports=r;var i=+(Math.pow(2,27)+1)},{}],549:[function(n,t){"use strict";function i(n,t,i){var r=n+t,u=r-n,o=r-u,f=t-u,e=n-o;return i?(i[0]=e+f,i[1]=r,i):[e+f,r]}t.exports=i},{}],550:[function(n,t,i){(function(t,r){"use strict";function a(n){if(n){var t=n.length||n.byteLength,i=o.log2(t);s[i].push(n)}}function it(n){a(n.buffer)}function e(n){var n=o.nextPow2(n),i=o.log2(n),t=s[i];return t.length>0?t.pop():new ArrayBuffer(n)}function c(n){return new Uint8Array(e(n),0,n)}function v(n){return new Uint16Array(e(2*n),0,n)}function y(n){return new Uint32Array(e(4*n),0,n)}function p(n){return new Int8Array(e(n),0,n)}function w(n){return new Int16Array(e(2*n),0,n)}function b(n){return new Int32Array(e(4*n),0,n)}function k(n){return new Float32Array(e(4*n),0,n)}function d(n){return new Float64Array(e(8*n),0,n)}function g(n){return l?new Uint8ClampedArray(e(n),0,n):c(n)}function nt(n){return new DataView(e(n),0,n)}function tt(n){n=o.nextPow2(n);var i=o.log2(n),t=h[i];return t.length>0?t.pop():new r(n)}var o=n("bit-twiddle"),f=n("dup"),l,u,s,h;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:f([32,0]),UINT16:f([32,0]),UINT32:f([32,0]),INT8:f([32,0]),INT16:f([32,0]),INT32:f([32,0]),FLOAT:f([32,0]),DOUBLE:f([32,0]),DATA:f([32,0]),UINT8C:f([32,0]),BUFFER:f([32,0])});l=typeof Uint8ClampedArray!="undefined";u=t.__TYPEDARRAY_POOL;u.UINT8C||(u.UINT8C=f([32,0]));u.BUFFER||(u.BUFFER=f([32,0]));s=u.DATA;h=u.BUFFER;i.free=function(n){if(r.isBuffer(n))h[o.log2(n.length)].push(n);else{if(Object.prototype.toString.call(n)!=="[object ArrayBuffer]"&&(n=n.buffer),!n)return;var t=n.length||n.byteLength,i=o.log2(t)|0;s[i].push(n)}};i.freeUint8=i.freeUint16=i.freeUint32=i.freeInt8=i.freeInt16=i.freeInt32=i.freeFloat32=i.freeFloat=i.freeFloat64=i.freeDouble=i.freeUint8Clamped=i.freeDataView=it;i.freeArrayBuffer=a;i.freeBuffer=function(n){h[o.log2(n.length)].push(n)};i.malloc=function(n,t){if(t===undefined||t==="arraybuffer")return e(n);switch(t){case"uint8":return c(n);case"uint16":return v(n);case"uint32":return y(n);case"int8":return p(n);case"int16":return w(n);case"int32":return b(n);case"float":case"float32":return k(n);case"double":case"float64":return d(n);case"uint8_clamped":return g(n);case"buffer":return tt(n);case"data":case"dataview":return nt(n);default:return null}return null};i.mallocArrayBuffer=e;i.mallocUint8=c;i.mallocUint16=v;i.mallocUint32=y;i.mallocInt8=p;i.mallocInt16=w;i.mallocInt32=b;i.mallocFloat32=i.mallocFloat=k;i.mallocFloat64=i.mallocDouble=d;i.mallocUint8Clamped=g;i.mallocDataView=nt;i.mallocBuffer=tt;i.clearCache=function(){for(var n=0;n<32;++n)u.UINT8[n].length=0,u.UINT16[n].length=0,u.UINT32[n].length=0,u.INT8[n].length=0,u.INT16[n].length=0,u.INT32[n].length=0,u.FLOAT[n].length=0,u.DOUBLE[n].length=0,u.UINT8C[n].length=0,s[n].length=0,h[n].length=0}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer)},{"bit-twiddle":56,buffer:57,dup:131}],551:[function(n,t){"use strict";function i(n,t){for(var i=1,e=n.length,r=n[0],f=n[0],u=1;u<e;++u)if(f=r,r=n[u],t(r,f)){if(u===i){i++;continue}n[i++]=r}return n.length=i,n}function r(n){for(var i=1,f=n.length,t=n[0],u=n[0],r=1;r<f;++r,u=t)if(u=t,t=n[r],t!==u){if(r===i){i++;continue}n[i++]=t}return n.length=i,n}function u(n,t,u){return n.length===0?n:t?(u||n.sort(t),i(n,t)):(u||n.sort(),r(n))}t.exports=u},{}],552:[function(n,t){"use strict";function f(n,t){return(typeof t!="object"||t===null)&&(t={}),u(n,t.canvas||i,t.context||r,t)}t.exports=f;var u=n("./lib/vtext"),i=null,r=null;typeof document!="undefined"&&(i=document.createElement("canvas"),i.width=8192,i.height=1024,r=i.getContext("2d"))},{"./lib/vtext":553}],553:[function(n,t){"use strict";function c(n,t,i){for(var c,r,s,e,o,l=t.textAlign||"start",a=t.textBaseline||"alphabetic",u=[1073741824,1073741824],f=[0,0],v=n.length,h=0;h<v;++h)for(c=n[h],r=0;r<2;++r)u[r]=Math.min(u[r],c[r])|0,f[r]=Math.max(f[r],c[r])|0;s=0;switch(l){case"center":s=-.5*(u[0]+f[0]);break;case"right":case"end":s=-f[0];break;case"left":case"start":s=-u[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+l+"'");}e=0;switch(a){case"hanging":case"top":e=-u[1];break;case"middle":e=-.5*(u[1]+f[1]);break;case"alphabetic":case"ideographic":e=-3*i;break;case"bottom":e=-f[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+a+"'");}return o=1/i,"lineHeight"in t?o*=+t.lineHeight:"width"in t?o=t.width/(f[0]-u[0]):"height"in t&&(o=t.height/(f[1]-u[1])),n.map(function(n){return[o*(n[0]+s),o*(n[1]+e)]})}function l(n,t,i,r){var e=Math.ceil(t.measureText(i).width+2*r)|0,u,o,s;if(e>8192)throw new Error("vectorize-text: String too long (sorry, this will get fixed later)");return u=3*r,n.height<u&&(n.height=u),t.fillStyle="#000",t.fillRect(0,0,n.width,n.height),t.fillStyle="#fff",t.fillText(i,r,2*r),o=t.getImageData(0,0,e,u),s=f(o.data,[u,e,4]),s.pick(-1,-1,0).transpose(1,0)}function a(n,t){var i=u(n,128);return t?e(i.cells,i.positions,.25):{edges:i.cells,positions:i.positions}}function i(n,t,i,r){var g=a(n,r),u=c(g.positions,t,i),v=g.edges,nt="ccw"===t.orientation,y,k,f,p,d,e,w,b,l;if(o(u,v),t.polygons||t.polygon||t.polyline){for(y=h(v,u),k=new Array(y.length),f=0;f<y.length;++f){for(p=y[f],d=new Array(p.length),e=0;e<p.length;++e){for(w=p[e],b=new Array(w.length),l=0;l<w.length;++l)b[l]=u[w[l]].slice();nt&&b.reverse();d[e]=b}k[f]=d}return k}return t.triangles||t.triangulate||t.triangle?{cells:s(u,v,{delaunay:!1,exterior:!1,interior:!0}),positions:u}:{edges:v,positions:u}}function r(n,t,r){try{return i(n,t,r,!0)}catch(u){}try{return i(n,t,r,!1)}catch(u){}return t.polygons||t.polyline||t.polygon?[]:t.triangles||t.triangulate||t.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function v(n,t,i,u){var f=u.size||64,o=u.font||"normal",e;return i.font=f+"px "+o,i.textAlign="start",i.textBaseline="alphabetic",i.direction="ltr",e=l(t,i,n,f),r(e,u,f)}t.exports=v;t.exports.processPixels=r;var u=n("surface-nets"),f=n("ndarray"),e=n("simplify-planar-graph"),o=n("clean-pslg"),s=n("cdt2d"),h=n("planar-graph-to-polyline")},{cdt2d:73,"clean-pslg":80,ndarray:525,"planar-graph-to-polyline":566,"simplify-planar-graph":570,"surface-nets":544}],554:[function(n,t){"use strict";function r(n,t){for(var c,l,a,e,h,f,v,o,y=i(n,t.length),u=new Array(t.length),p=new Array(t.length),s=[],r=0;r<t.length;++r)c=y[r].length,p[r]=c,u[r]=!0,c<=1&&s.push(r);while(s.length>0)for(f=s.pop(),u[f]=!1,l=y[f],r=0;r<l.length;++r)a=l[r],--p[a]==0&&s.push(a);for(e=new Array(t.length),h=[],r=0;r<t.length;++r)u[r]?(f=h.length,e[r]=f,h.push(t[r])):e[r]=-1;for(v=[],r=0;r<n.length;++r)o=n[r],u[o[0]]&&u[o[1]]&&v.push([e[o[0]],e[o[1]]]);return[v,h]}t.exports=r;var i=n("edges-to-adjacency-list")},{"edges-to-adjacency-list":555}],555:[function(n,t){"use strict";function r(n,t){var o=n.length,f,r,u,e;if(typeof t!="number"){for(t=0,r=0;r<o;++r)u=n[r],t=Math.max(t,u[0],u[1]);t=(t|0)+1}for(t=t|0,f=new Array(t),r=0;r<t;++r)f[r]=[];for(r=0;r<o;++r)u=n[r],f[u[0]].push(u[1]),f[u[1]].push(u[0]);for(e=0;e<t;++e)i(f[e],function(n,t){return n-t});return f}t.exports=r;var i=n("uniq")},{uniq:551}],556:[function(n,t){"use strict";function r(n,t){function a(n,t){var i=u[t][n[t]];i.splice(i.indexOf(n),1)}function l(n,r,f){for(var e,v,l,o,s,c,h=0;h<2;++h)if(u[h][r].length>0){o=u[h][r][0];c=h;break}for(s=o[c^1],e=0;e<2;++e)for(v=u[e][r],l=0;l<v.length;++l){var y=v[l],p=y[e^1],w=i(t[n],t[r],t[s],t[p]);w>0&&(o=y,s=p,c=e)}return f?s:(o&&a(o,c),s)}function y(n,r){var h=u[r][n][0],f=[n],e,c;for(a(h,r),e=h[r^1],c=r;;){while(e!==n)f.push(e),e=l(f[f.length-2],e,!1);if(u[0][n].length+u[1][n].length===0)break;var o=f[f.length-1],s=n,v=f[1],y=l(o,s,!0);if(i(t[o],t[s],t[v],t[y])<0)break;f.push(n);e=l(o,s)}return f}function p(n,t){return t[1]===t[t.length-1]}for(var o,s,h,f,w,c,e=t.length|0,v=n.length,u=[new Array(e),new Array(e)],r=0;r<e;++r)u[0][r]=[],u[1][r]=[];for(r=0;r<v;++r)o=n[r],u[0][o[0]].push(o),u[1][o[1]].push(o);for(s=[],r=0;r<e;++r)u[0][r].length+u[1][r].length===0&&s.push([r]);for(r=0;r<e;++r)for(h=0;h<2;++h){for(f=[];u[h][r].length>0;)w=u[0][r].length,c=y(r,h),p(f,c)?f.push.apply(f,c):(f.length>0&&s.push(f),f=c);f.length>0&&s.push(f)}return s}t.exports=r;var i=n("compare-angle")},{"compare-angle":557}],557:[function(n,t){"use strict";function r(n,t,i){var f=u(n[0],-t[0]),s=u(n[1],-t[1]),h=u(i[0],-t[0]),c=u(i[1],-t[1]),r=o(e(f,h),e(s,c));return r[r.length-1]>=0}function s(n,t,u,e){var h=i(t,u,e),o,s,c,a,l,v;return h===0?(o=f(i(n,t,u)),s=f(i(n,t,e)),o===s)?o===0?(c=r(n,t,u),a=r(n,t,e),c===a?0:c?1:-1):0:s===0?o>0?-1:r(n,t,e)?-1:1:o===0?s>0?1:r(n,t,u)?1:-1:f(s-o):(l=i(n,t,u),l>0?h>0&&i(n,t,e)>0?1:-1:l<0?h>0||i(n,t,e)>0?1:-1:(v=i(n,t,e),v>0?1:r(n,t,u)?1:-1))}t.exports=s;var i=n("robust-orientation"),f=n("signum"),u=n("two-sum"),e=n("robust-product"),o=n("robust-sum")},{"robust-orientation":531,"robust-product":558,"robust-sum":534,signum:559,"two-sum":549}],558:[function(n,t){"use strict";function u(n,t){var f,u;if(n.length===1)return i(t,n[0]);if(t.length===1)return i(n,t[0]);if(n.length===0||t.length===0)return[0];if(f=[0],n.length<t.length)for(u=0;u<n.length;++u)f=r(f,i(t,n[u]));else for(u=0;u<t.length;++u)f=r(f,i(n,t[u]));return f}var r=n("robust-sum"),i=n("robust-scale");t.exports=u},{"robust-scale":532,"robust-sum":534}],559:[function(n,t){"use strict";t.exports=function(n){return n<0?-1:n>0?1:0}},{}],560:[function(n,t,i){arguments[4][27][0].apply(i,arguments)},{dup:27}],561:[function(n,t){"use strict";function h(n,t,i,r,u){this.mid=n;this.left=t;this.right=i;this.leftPoints=r;this.rightPoints=u;this.count=(t?t.count:0)+(i?i.count:0)+r.length}function c(n,t){n.mid=t.mid;n.left=t.left;n.right=t.right;n.leftPoints=t.leftPoints;n.rightPoints=t.rightPoints;n.count=t.count}function y(n,t){var i=e(t);n.mid=i.mid;n.left=i.left;n.right=i.right;n.leftPoints=i.leftPoints;n.rightPoints=i.rightPoints;n.count=i.count}function p(n,t){var i=n.intervals([]);i.push(t);y(n,i)}function w(n,t){var r=n.intervals([]),f=r.indexOf(t);return f<0?u:(r.splice(f,1),y(n,r),i)}function b(n,t,i){for(var u,r=0;r<n.length&&n[r][0]<=t;++r)if(u=i(n[r]),u)return u}function k(n,t,i){for(var u,r=n.length-1;r>=0&&n[r][1]>=t;--r)if(u=i(n[r]),u)return u}function d(n,t){for(var r,i=0;i<n.length;++i)if(r=t(n[i]),r)return r}function g(n,t){return n-t}function l(n,t){var i=n[0]-t[0];return i?i:n[1]-t[1]}function a(n,t){var i=n[1]-t[1];return i?i:n[0]-t[0]}function e(n){var r,t,i,o,s;if(n.length===0)return null;for(r=[],t=0;t<n.length;++t)r.push(n[t][0],n[t][1]);r.sort(g);var u=r[r.length>>1],c=[],v=[],f=[];for(t=0;t<n.length;++t)i=n[t],i[1]<u?c.push(i):u<i[0]?v.push(i):f.push(i);return o=f,s=f.slice(),o.sort(l),s.sort(a),new h(u,e(c),e(v),o,s)}function v(n){this.root=n}function nt(n){return!n||n.length===0?new v(null):new v(e(n))}var o=n("binary-search-bounds"),u=0,i=1,s=2,f,r;t.exports=nt;f=h.prototype;f.intervals=function(n){return n.push.apply(n,this.leftPoints),this.left&&this.left.intervals(n),this.right&&this.right.intervals(n),n};f.insert=function(n){var t=this.count-this.leftPoints.length,i,r;this.count+=1;n[1]<this.mid?this.left?4*(this.left.count+1)>3*(t+1)?p(this,n):this.left.insert(n):this.left=e([n]):n[0]>this.mid?this.right?4*(this.right.count+1)>3*(t+1)?p(this,n):this.right.insert(n):this.right=e([n]):(i=o.ge(this.leftPoints,n,l),r=o.ge(this.rightPoints,n,a),this.leftPoints.splice(i,0,n),this.rightPoints.splice(r,0,n))};f.remove=function(n){var h=this.count-this.leftPoints,v,y,e,r,f,t;if(n[1]<this.mid)return this.left?(v=this.right?this.right.count:0,4*v>3*(h-1))?w(this,n):(t=this.left.remove(n),t===s)?(this.left=null,this.count-=1,i):(t===i&&(this.count-=1),t):u;if(n[0]>this.mid)return this.right?(y=this.left?this.left.count:0,4*y>3*(h-1))?w(this,n):(t=this.right.remove(n),t===s)?(this.right=null,this.count-=1,i):(t===i&&(this.count-=1),t):u;if(this.count===1)return this.leftPoints[0]===n?s:u;if(this.leftPoints.length===1&&this.leftPoints[0]===n){if(this.left&&this.right){for(e=this,r=this.left;r.right;)e=r,r=r.right;e===this?r.right=this.right:(f=this.left,t=this.right,e.count-=r.count,e.right=r.left,r.left=f,r.right=t);c(this,r);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?c(this,this.left):c(this,this.right);return i}for(f=o.ge(this.leftPoints,n,l);f<this.leftPoints.length;++f){if(this.leftPoints[f][0]!==n[0])break;if(this.leftPoints[f]===n)for(this.count-=1,this.leftPoints.splice(f,1),t=o.ge(this.rightPoints,n,a);t<this.rightPoints.length;++t)if(this.rightPoints[t][1]!==n[1])break;else if(this.rightPoints[t]===n)return this.rightPoints.splice(t,1),i}return u};f.queryPoint=function(n,t){var i;return n<this.mid?this.left&&(i=this.left.queryPoint(n,t),i)?i:b(this.leftPoints,n,t):n>this.mid?this.right&&(i=this.right.queryPoint(n,t),i)?i:k(this.rightPoints,n,t):d(this.leftPoints,t)};f.queryInterval=function(n,t,i){var r;return n<this.mid&&this.left&&(r=this.left.queryInterval(n,t,i),r)?r:t>this.mid&&this.right&&(r=this.right.queryInterval(n,t,i),r)?r:t<this.mid?b(this.leftPoints,t,i):n>this.mid?k(this.rightPoints,n,i):d(this.leftPoints,i)};r=v.prototype;r.insert=function(n){this.root?this.root.insert(n):this.root=new h(n[0],null,null,[n],[n])};r.remove=function(n){if(this.root){var t=this.root.remove(n);return t===s&&(this.root=null),t!==u}return!1};r.queryPoint=function(n,t){if(this.root)return this.root.queryPoint(n,t)};r.queryInterval=function(n,t,i){if(n<=t&&this.root)return this.root.queryInterval(n,t,i)};Object.defineProperty(r,"count",{get:function(){return this.root?this.root.count:0}});Object.defineProperty(r,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":560}],562:[function(n,t){"use strict";function r(n,t){var f,u,h,e,r;if(t[0][0]<t[1][0])f=t[0],u=t[1];else if(t[0][0]>t[1][0])f=t[1],u=t[0];else{var c=Math.min(n[0][1],n[1][1]),o=Math.max(n[0][1],n[1][1]),l=Math.min(t[0][1],t[1][1]),s=Math.max(t[0][1],t[1][1]);return o<l?o-l:c>s?c-s:o-s}return(n[0][1]<n[1][1]?(h=n[0],e=n[1]):(h=n[1],e=n[0]),r=i(u,f,h),r)?r:(r=i(u,f,e),r)?r:e-u}function u(n,t){var s,e,h,o,u,f;if(t[0][0]<t[1][0])s=t[0],e=t[1];else if(t[0][0]>t[1][0])s=t[1],e=t[0];else return r(t,n);if(n[0][0]<n[1][0])h=n[0],o=n[1];else if(n[0][0]>n[1][0])h=n[1],o=n[0];else return-r(n,t);if(u=i(s,e,o),f=i(s,e,h),u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;if(u=i(o,h,e),f=i(o,h,s),u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;return e[0]-o[0]}t.exports=u;var i=n("robust-orientation")},{"robust-orientation":531}],563:[function(n,t){"use strict";function e(n,t,i,r,u,f){this._color=n;this.key=t;this.value=i;this.left=r;this.right=u;this._count=f}function h(n){return new e(n._color,n.key,n.value,n.left,n.right,n._count)}function c(n,t){return new e(n,t.key,t.value,t.left,t.right,t._count)}function u(n){n._count=1+(n.left?n.left._count:0)+(n.right?n.right._count:0)}function l(n,t){this._compare=n;this.root=t}function a(n,t){var i;return t.left&&(i=a(n,t.left),i)?i:(i=n(t.key,t.value),i)?i:t.right?a(n,t.right):void 0}function v(n,t,i,r){var f=t(n,r.key),u;return f<=0&&(r.left&&(u=v(n,t,i,r.left),u)||(u=i(r.key,r.value),u))?u:r.right?v(n,t,i,r.right):void 0}function y(n,t,i,r,u){var o=i(n,u.key),e=i(t,u.key),f;return o<=0&&(u.left&&(f=y(n,t,i,r,u.left),f)||e>0&&(f=r(u.key,u.value),f))?f:e>0&&u.right?y(n,t,i,r,u.right):void 0}function o(n,t){this.tree=n;this._stack=t}function p(n,t){n.key=t.key;n.value=t.value;n.left=t.left;n.right=t.right;n._color=t._color;n._count=t._count}function w(n){for(var s,l,f,t,o,e=n.length-1;e>=0;--e){if(l=n[e],e===0){l._color=i;return}if(f=n[e-1],f.left===l){if(t=f.right,t.right&&t.right._color===r){t=f.right=h(t);o=t.right=h(t.right);f.right=t.left;t.left=f;t.right=o;t._color=f._color;l._color=i;f._color=i;o._color=i;u(f);u(t);e>1&&(s=n[e-2],s.left===f?s.left=t:s.right=t);n[e-1]=t;return}if(t.left&&t.left._color===r){t=f.right=h(t);o=t.left=h(t.left);f.right=o.left;t.left=o.right;o.left=f;o.right=t;o._color=f._color;f._color=i;t._color=i;l._color=i;u(f);u(t);u(o);e>1&&(s=n[e-2],s.left===f?s.left=o:s.right=o);n[e-1]=o;return}if(t._color===i){if(f._color===r){f._color=i;f.right=c(r,t);return}f.right=c(r,t);continue}else t=h(t),f.right=t.left,t.left=f,t._color=f._color,f._color=r,u(f),u(t),e>1&&(s=n[e-2],s.left===f?s.left=t:s.right=t),n[e-1]=t,n[e]=f,e+1<n.length?n[e+1]=l:n.push(l),e=e+2}else{if(t=f.left,t.left&&t.left._color===r){t=f.left=h(t);o=t.left=h(t.left);f.left=t.right;t.right=f;t.left=o;t._color=f._color;l._color=i;f._color=i;o._color=i;u(f);u(t);e>1&&(s=n[e-2],s.right===f?s.right=t:s.left=t);n[e-1]=t;return}if(t.right&&t.right._color===r){t=f.left=h(t);o=t.right=h(t.right);f.left=o.right;t.right=o.left;o.right=f;o.left=t;o._color=f._color;f._color=i;t._color=i;l._color=i;u(f);u(t);u(o);e>1&&(s=n[e-2],s.right===f?s.right=o:s.left=o);n[e-1]=o;return}if(t._color===i){if(f._color===r){f._color=i;f.left=c(r,t);return}f.left=c(r,t);continue}else t=h(t),f.left=t.right,t.right=f,t._color=f._color,f._color=r,u(f),u(t),e>1&&(s=n[e-2],s.right===f?s.right=t:s.left=t),n[e-1]=t,n[e]=f,e+1<n.length?n[e+1]=l:n.push(l),e=e+2}}}function b(n,t){return n<t?-1:n>t?1:0}function k(n){return new l(n||b,null)}var r,i,f,s;t.exports=k;r=0;i=1;f=l.prototype;Object.defineProperty(f,"keys",{get:function(){var n=[];return this.forEach(function(t){n.push(t)}),n}});Object.defineProperty(f,"values",{get:function(){var n=[];return this.forEach(function(t,i){n.push(i)}),n}});Object.defineProperty(f,"length",{get:function(){return this.root?this.root._count:0}});f.insert=function(n,t){for(var w=this._compare,f=this.root,a=[],b=[],p,o,h,s,v,y;f;)p=w(n,f.key),a.push(f),b.push(p),f=p<=0?f.left:f.right;for(a.push(new e(r,n,t,null,null,1)),o=a.length-2;o>=0;--o)f=a[o],a[o]=b[o]<=0?new e(f._color,f.key,f.value,a[o+1],f.right,f._count+1):new e(f._color,f.key,f.value,f.left,a[o+1],f._count+1);for(o=a.length-1;o>1;--o){if(h=a[o-1],f=a[o],h._color===i||f._color===i)break;if(s=a[o-2],s.left===h)if(h.left===f)if(v=s.right,v&&v._color===r)h._color=i,s.right=c(i,v),s._color=r,o-=1;else{s._color=r;s.left=h.right;h._color=i;h.right=s;a[o-2]=h;a[o-1]=f;u(s);u(h);o>=3&&(y=a[o-3],y.left===s?y.left=h:y.right=h);break}else if(v=s.right,v&&v._color===r)h._color=i,s.right=c(i,v),s._color=r,o-=1;else{h.right=f.left;s._color=r;s.left=f.right;f._color=i;f.left=h;f.right=s;a[o-2]=f;a[o-1]=h;u(s);u(h);u(f);o>=3&&(y=a[o-3],y.left===s?y.left=f:y.right=f);break}else if(h.right===f)if(v=s.left,v&&v._color===r)h._color=i,s.left=c(i,v),s._color=r,o-=1;else{s._color=r;s.right=h.left;h._color=i;h.left=s;a[o-2]=h;a[o-1]=f;u(s);u(h);o>=3&&(y=a[o-3],y.right===s?y.right=h:y.left=h);break}else if(v=s.left,v&&v._color===r)h._color=i,s.left=c(i,v),s._color=r,o-=1;else{h.left=f.right;s._color=r;s.right=f.left;f._color=i;f.right=h;f.left=s;a[o-2]=f;a[o-1]=h;u(s);u(h);u(f);o>=3&&(y=a[o-3],y.right===s?y.right=f:y.left=f);break}}return a[0]._color=i,new l(w,a[0])};f.forEach=function(n,t,i){if(this.root)switch(arguments.length){case 1:return a(n,this.root);case 2:return v(t,this._compare,n,this.root);case 3:return this._compare(t,i)>=0?void 0:y(t,i,this._compare,n,this.root)}};Object.defineProperty(f,"begin",{get:function(){for(var t=[],n=this.root;n;)t.push(n),n=n.left;return new o(this,t)}});Object.defineProperty(f,"end",{get:function(){for(var t=[],n=this.root;n;)t.push(n),n=n.right;return new o(this,t)}});f.at=function(n){if(n<0)return new o(this,[]);for(var t=this.root,i=[];;){if(i.push(t),t.left){if(n<t.left._count){t=t.left;continue}n-=t.left._count}if(!n)return new o(this,i);if(n-=1,t.right){if(n>=t.right._count)break;t=t.right}else break}return new o(this,[])};f.ge=function(n){for(var f=this._compare,t=this.root,i=[],u=0,r;t;)r=f(n,t.key),i.push(t),r<=0&&(u=i.length),t=r<=0?t.left:t.right;return i.length=u,new o(this,i)};f.gt=function(n){for(var f=this._compare,t=this.root,i=[],u=0,r;t;)r=f(n,t.key),i.push(t),r<0&&(u=i.length),t=r<0?t.left:t.right;return i.length=u,new o(this,i)};f.lt=function(n){for(var f=this._compare,t=this.root,i=[],u=0,r;t;)r=f(n,t.key),i.push(t),r>0&&(u=i.length),t=r<=0?t.left:t.right;return i.length=u,new o(this,i)};f.le=function(n){for(var f=this._compare,t=this.root,i=[],u=0,r;t;)r=f(n,t.key),i.push(t),r>=0&&(u=i.length),t=r<0?t.left:t.right;return i.length=u,new o(this,i)};f.find=function(n){for(var u=this._compare,t=this.root,r=[],i;t;){if(i=u(n,t.key),r.push(t),i===0)return new o(this,r);t=i<=0?t.left:t.right}return new o(this,[])};f.remove=function(n){var t=this.find(n);return t?t.remove():this};f.get=function(n){for(var r=this._compare,t=this.root,i;t;){if(i=r(n,t.key),i===0)return t.value;t=i<=0?t.left:t.right}return};s=o.prototype;Object.defineProperty(s,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(s,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0});s.clone=function(){return new o(this.tree,this._stack.slice())};s.remove=function(){var f=this._stack,t,n,o,c,s,u,h;if(f.length===0)return this.tree;for(t=new Array(f.length),n=f[f.length-1],t[t.length-1]=new e(n._color,n.key,n.value,n.left,n.right,n._count),u=f.length-2;u>=0;--u)n=f[u],t[u]=n.left===f[u+1]?new e(n._color,n.key,n.value,t[u+1],n.right,n._count):new e(n._color,n.key,n.value,n.left,t[u+1],n._count);if(n=t[t.length-1],n.left&&n.right){for(o=t.length,n=n.left;n.right;)t.push(n),n=n.right;for(c=t[o-1],t.push(new e(n._color,c.key,c.value,n.left,n.right,n._count)),t[o-1].key=n.key,t[o-1].value=n.value,u=t.length-2;u>=o;--u)n=t[u],t[u]=new e(n._color,n.key,n.value,n.left,t[u+1],n._count);t[o-1].left=t[o]}if(n=t[t.length-1],n._color===r){for(s=t[t.length-2],s.left===n?s.left=null:s.right===n&&(s.right=null),t.pop(),u=0;u<t.length;++u)t[u]._count--;return new l(this.tree._compare,t[0])}if(n.left||n.right){for(n.left?p(n,n.left):n.right&&p(n,n.right),n._color=i,u=0;u<t.length-1;++u)t[u]._count--;return new l(this.tree._compare,t[0])}if(t.length===1)return new l(this.tree._compare,null);for(u=0;u<t.length;++u)t[u]._count--;return h=t[t.length-2],w(t),h.left===n?h.left=null:h.right=null,new l(this.tree._compare,t[0])};Object.defineProperty(s,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0});Object.defineProperty(s,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0});Object.defineProperty(s,"index",{get:function(){var i=0,n=this._stack,r,t;if(n.length===0)return(r=this.tree.root,r)?r._count:0;for(n[n.length-1].left&&(i=n[n.length-1].left._count),t=n.length-2;t>=0;--t)n[t+1]===n[t].right&&(++i,n[t].left&&(i+=n[t].left._count));return i},enumerable:!0});s.next=function(){var n=this._stack,t;if(n.length!==0)if(t=n[n.length-1],t.right)for(t=t.right;t;)n.push(t),t=t.left;else for(n.pop();n.length>0&&n[n.length-1].right===t;)t=n[n.length-1],n.pop()};Object.defineProperty(s,"hasNext",{get:function(){var n=this._stack,t;if(n.length===0)return!1;if(n[n.length-1].right)return!0;for(t=n.length-1;t>0;--t)if(n[t-1].left===n[t])return!0;return!1}});s.update=function(n){var r=this._stack,u,t,i;if(r.length===0)throw new Error("Can't update empty node!");for(u=new Array(r.length),t=r[r.length-1],u[u.length-1]=new e(t._color,t.key,n,t.left,t.right,t._count),i=r.length-2;i>=0;--i)t=r[i],u[i]=t.left===r[i+1]?new e(t._color,t.key,t.value,u[i+1],t.right,t._count):new e(t._color,t.key,t.value,t.left,u[i+1],t._count);return new l(this.tree._compare,u[0])};s.prev=function(){var n=this._stack,t;if(n.length!==0)if(t=n[n.length-1],t.left)for(t=t.left;t;)n.push(t),t=t.right;else for(n.pop();n.length>0&&n[n.length-1].left===t;)t=n[n.length-1],n.pop()};Object.defineProperty(s,"hasPrev",{get:function(){var n=this._stack,t;if(n.length===0)return!1;if(n[n.length-1].left)return!0;for(t=n.length-1;t>0;--t)if(n[t-1].right===n[t])return!0;return!1}})},{}],564:[function(n,t){"use strict";function o(n,t,i){this.slabs=n;this.coordinates=t;this.horizontal=i}function l(n,t){return n.y-t}function i(n,t){for(var h=null,r,e,o,s,u;n;)if(r=n.key,r[0][0]<r[1][0]?(e=r[0],o=r[1]):(e=r[1],o=r[0]),s=f(e,o,t),s<0)n=n.left;else if(s>0)if(t[0]!==r[1][0])h=n,n=n.right;else{if(u=i(n.right,t),u)return u;n=n.left}else{if(t[0]!==r[1][0])return n;if(u=i(n.right,t),u)return u;n=n.left}return h}function r(n,t,i,r){this.y=n;this.index=t;this.start=i;this.closed=r}function h(n,t,i,r){this.x=n;this.segment=t;this.create=i;this.index=r}function a(n){for(var u,v,y,f,t,p=n.length,a=2*p,s=new Array(a),i=0;i<p;++i)u=n[i],v=u[0][0]<u[1][0],s[2*i]=new h(u[0][0],u,v,i),s[2*i+1]=new h(u[1][0],u,!v,i);s.sort(function(n,t){var i=n.x-t.x;return i?i:(i=n.create-t.create,i)?i:Math.min(n.segment[0][1],n.segment[1][1])-Math.min(t.segment[0][1],t.segment[1][1])});var l=c(e),w=[],b=[],k=[];for(i=0;i<a;){for(y=s[i].x,f=[];i<a;){if(t=s[i],t.x!==y)break;i+=1;t.segment[0][0]===t.x&&t.segment[1][0]===t.x?t.create&&(t.segment[0][1]<t.segment[1][1]?(f.push(new r(t.segment[0][1],t.index,!0,!0)),f.push(new r(t.segment[1][1],t.index,!1,!1))):(f.push(new r(t.segment[1][1],t.index,!0,!1)),f.push(new r(t.segment[0][1],t.index,!1,!0)))):l=t.create?l.insert(t.segment,t.index):l.remove(t.segment)}w.push(l.root);b.push(y);k.push(f)}return new o(w,b,k)}var s;t.exports=a;var u=n("binary-search-bounds"),c=n("functional-red-black-tree"),f=n("robust-orientation"),e=n("./lib/order-segments");s=o.prototype;s.castUp=function(n){var c=u.le(this.coordinates,n[0]),o,a,s,r,t,y;if(c<0)return-1;var p=this.slabs[c],v=i(this.slabs[c],n),h=-1;if(v&&(h=v.value),this.coordinates[c]===n[0]&&(o=null,v&&(o=v.key),c>0&&(a=i(this.slabs[c-1],n),a&&(o?e(a.key,o)>0&&(o=a.key,h=a.value):(h=a.value,o=a.key))),s=this.horizontal[c],s.length>0&&(r=u.ge(s,n[1],l),r<s.length))){if(t=s[r],n[1]===t.y){if(t.closed)return t.index;while(r<s.length-1&&s[r+1].y===n[1])if(r=r+1,t=s[r],t.closed)return t.index;if(t.y===n[1]&&!t.start){if(r=r+1,r>=s.length)return h;t=s[r]}}t.start?o?(y=f(o[0],o[1],[n[0],t.y]),o[0][0]>o[1][0]&&(y=-y),y>0&&(h=t.index)):h=t.index:t.y!==n[1]&&(h=t.index)}return h}},{"./lib/order-segments":562,"binary-search-bounds":560,"functional-red-black-tree":563,"robust-orientation":531}],565:[function(n,t){function o(){return!0}function s(n){return function(t,i){var r=n[t];return r?!!r.queryPoint(i,o):!1}}function i(n){for(var o,r,a,i={},t=0;t<n.length;++t){var u=n[t],e=u[0][0],h=u[0][1],c=u[1][1],l=[Math.min(h,c),Math.max(h,c)];e in i?i[e].push(l):i[e]=[l]}for(o={},r=Object.keys(i),t=0;t<r.length;++t)a=i[r[t]],o[r[t]]=f(a);return s(o)}function h(n,t){return function(i){var f=e.le(t,i[0]),u,h,o,s;if(f<0)return 1;if(u=n[f],!u)if(f>0&&t[f]===i[0])u=n[f-1];else return 1;for(h=1;u;)if(o=u.key,s=r(i,o[0],o[1]),o[0][0]<o[1][0])if(s<0)u=u.left;else if(s>0)h=-1,u=u.right;else return 0;else if(s>0)u=u.left;else if(s<0)h=1,u=u.right;else return 0;return h}}function c(){return 1}function l(n){return function(t){return n(t[0],t[1])?0:1}}function a(n,t){return function(i){return n(i[0],i[1])?0:t(i)}}function v(n){for(var r,y,p,f,e,o,w,b,k=n.length,s=[],t=[],v=0;v<k;++v)for(r=n[v],y=r.length,p=y-1,f=0;f<y;p=f++)e=r[p],o=r[f],e[0]===o[0]?t.push([e,o]):s.push([e,o]);return s.length===0?t.length===0?c:l(i(t)):(w=u(s),b=h(w.slabs,w.coordinates),t.length===0?b:a(i(t),b))}t.exports=v;var r=n("robust-orientation")[3],u=n("slab-decomposition"),f=n("interval-tree-1d"),e=n("binary-search-bounds")},{"binary-search-bounds":560,"interval-tree-1d":561,"robust-orientation":531,"slab-decomposition":564}],566:[function(n,t){"use strict";function u(n,t){for(var r=new Array(n),i=0;i<n;++i)r[i]=t;return r}function c(n){for(var i=new Array(n),t=0;t<n;++t)i[t]=[];return i}function l(n,t){function ni(n){for(var s=n.length,u=[0],f=0;f<s;++f){var e=t[n[f]],o=t[n[(f+1)%s]],h=i(-e[0],e[1]),c=i(-e[0],o[1]),l=i(o[0],e[1]),a=i(o[0],o[1]);u=r(u,r(r(h,c),r(l,a)))}return u[u.length-1]>0}function kt(n){for(var i=n.length,t=0;t<i;++t)if(!et[n[t]])return!1;return!0}var d=h(n,t),p,ut,lt,b,ft,et,nt,a,pt,tt,k,ot,st,dt,it,wt,l,rt,v;n=d[0];t=d[1];var bt=t.length,fi=n.length,gt=f(n,t.length);for(l=0;l<bt;++l)if(gt[l].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");p=e(n,t);p=p.filter(ni);var y=p.length,g=new Array(y),ht=new Array(y);for(l=0;l<y;++l){g[l]=l;var w=new Array(y),ti=p[l].map(function(n){return t[n]}),ii=o([ti]),ct=0;n:for(a=0;a<y;++a)if(w[a]=0,l!==a){for(v=p[a],nt=v.length,ut=0;ut<nt;++ut)if(lt=ii(t[v[ut]]),lt!==0){lt<0&&(w[a]=1,ct+=1);continue n}w[a]=1;ct+=1}ht[l]=[ct,l,w]}for(ht.sort(function(n,t){return t[0]-n[0]}),l=0;l<y;++l){var w=ht[l],ri=w[1],ui=w[2];for(a=0;a<y;++a)ui[a]&&(g[a]=ri)}for(b=c(y),l=0;l<y;++l)b[l].push(g[l]),b[g[l]].push(l);for(ft={},et=u(bt,!1),l=0;l<y;++l)for(v=p[l],nt=v.length,a=0;a<nt;++a){var at=v[a],vt=v[(a+1)%nt],yt=Math.min(at,vt)+":"+Math.max(at,vt);yt in ft?(pt=ft[yt],b[pt].push(l),b[l].push(pt),et[at]=et[vt]=!0):ft[yt]=l}for(tt=[],k=u(y,-1),l=0;l<y;++l)g[l]!==l||kt(p[l])?k[l]=-1:(tt.push(l),k[l]=0);for(d=[];tt.length>0;){for(ot=tt.pop(),st=b[ot],s(st,function(n,t){return n-t}),dt=st.length,it=k[ot],it===0&&(v=p[ot],wt=[v]),l=0;l<dt;++l)(rt=st[l],k[rt]>=0)||(k[rt]=it^1,tt.push(rt),it===0&&(v=p[rt],kt(v)||(v.reverse(),wt.push(v))));it===0&&d.push(wt)}return d}t.exports=l;var f=n("edges-to-adjacency-list"),e=n("planar-dual"),o=n("point-in-big-polygon"),i=n("two-product"),r=n("robust-sum"),s=n("uniq"),h=n("./lib/trim-leaves")},{"./lib/trim-leaves":554,"edges-to-adjacency-list":555,"planar-dual":556,"point-in-big-polygon":565,"robust-sum":534,"two-product":548,uniq:551}],567:[function(n,t,i){arguments[4][56][0].apply(i,arguments)},{dup:56}],568:[function(n,t){"use strict";"use restrict";function i(n){this.roots=new Array(n);this.ranks=new Array(n);for(var t=0;t<n;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=i;i.prototype.length=function(){return this.roots.length};i.prototype.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n};i.prototype.find=function(n){for(var t=this.roots,i;t[n]!==n;)i=t[n],t[n]=t[i],n=i;return n};i.prototype.link=function(n,t){var i=this.find(n),r=this.find(t);if(i!==r){var u=this.ranks,f=this.roots,e=u[i],o=u[r];e<o?f[i]=r:o<e?f[r]=i:(f[r]=i,++u[i])}}},{}],569:[function(n,t,i){arguments[4][318][0].apply(i,arguments)},{"bit-twiddle":567,dup:318,"union-find":568}],570:[function(n,t){"use strict";function u(n,t,i){var u=Math.abs(r(n,t,i)),f=Math.sqrt(Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2));return u/f}function f(n,t,r){function nt(n){if(v[n])return Infinity;var i=c[n],r=l[n];return i<0||r<0?Infinity:u(t[n],t[i],t[r])}function tt(n,t){var i=o[n],r=o[t];o[n]=r;o[t]=i;e[i]=t;e[r]=n}function y(n){return a[o[n]]}function ht(n){return n&1?n-1>>1:(n>>1)-1}function it(n){for(var o=y(n),f,e;;){var i=o,r=2*n+1,u=2*(n+1),t=n;if(r<s&&(f=y(r),f<i&&(t=r,i=f)),u<s&&(e=y(u),e<i&&(t=u)),t===n)return n;tt(n,t);n=t}}function rt(n){for(var r=y(n),t,i;n>0;){if(t=ht(n),t>=0&&(i=y(t),r<i)){tt(n,t);n=t;continue}return n}}function ut(){if(s>0){var n=o[0];return tt(0,s-1),s-=1,it(0),n}return-1}function ft(n,t){var i=o[n];return a[i]===t?n:(a[i]=-Infinity,rt(n),ut(),a[i]=t,s+=1,rt(s-1))}function ct(n){if(!v[n]){v[n]=!0;var t=c[n],i=l[n];c[i]>=0&&(c[i]=t);l[t]>=0&&(l[t]=i);e[t]>=0&&ft(e[t],nt(t));e[i]>=0&&ft(e[i],nt(i))}}function ot(n,t){var f,i,r,u;if(n[t]<0)return t;f=t;i=t;do{if(r=n[i],!v[i]||r<0||r===i)break;if(i=r,r=n[i],!v[i]||r<0||r===i)break;i=r;f=n[f]}while(f!==i);for(u=t;u!==i;u=n[u])n[u]=i;return i}for(var w,b,k,o,e,et,s,d,p,lt,g,h=t.length,st=n.length,c=new Array(h),l=new Array(h),a=new Array(h),v=new Array(h),f=0;f<h;++f)c[f]=l[f]=-1,a[f]=Infinity,v[f]=!1;for(f=0;f<st;++f){if(w=n[f],w.length!==2)throw new Error("Input must be a graph");b=w[1];k=w[0];l[k]=l[k]!==-1?-2:b;c[b]=c[b]!==-1?-2:k}for(o=[],e=new Array(h),f=0;f<h;++f)et=a[f]=nt(f),et<Infinity?(e[f]=o.length,o.push(f)):e[f]=-1;for(s=o.length,f=s>>1;f>=0;--f)it(f);for(;;){if(d=ut(),d<0||a[d]>r)break;ct(d)}for(p=[],f=0;f<h;++f)v[f]||(e[f]=p.length,p.push(t[f].slice()));return lt=p.length,g=[],n.forEach(function(n){var t=ot(c,n[0]),i=ot(l,n[1]),r,u;t>=0&&i>=0&&t!==i&&(r=e[t],u=e[i],r!==u&&g.push([r,u]))}),i.unique(i.normalize(g)),{positions:p,edges:g}}t.exports=f;var r=n("robust-orientation"),i=n("simplicial-complex")},{"robust-orientation":531,"simplicial-complex":569}],571:[function(n,t){var i=n("get-canvas-context");t.exports=function(n){return i("webgl",n)}},{"get-canvas-context":572}],572:[function(n,t){function i(n,t){var r,e,i,u,f;if(typeof n!="string")throw new TypeError("must specify type string");if(t=t||{},typeof document=="undefined"&&!t.canvas)return null;r=t.canvas||document.createElement("canvas");typeof t.width=="number"&&(r.width=t.width);typeof t.height=="number"&&(r.height=t.height);e=t;try{for(u=[n],n.indexOf("webgl")===0&&u.push("experimental-"+n),f=0;f<u.length;f++)if(i=r.getContext(u[f],e),i)return i}catch(o){i=null}return i||null}t.exports=i},{}],573:[function(n,t){"use strict";var i=n("../../lib"),u=n("../color"),r=n("../../plots/cartesian/axes"),f=n("./attributes");t.exports=function(n,t){function e(t,r){return i.coerce(n,h,f,t,r)}var h={},k,v,d,l,g,a,s,c,b;for(e("opacity"),e("align"),e("bgcolor"),k=e("bordercolor"),v=u.opacity(k),e("borderpad"),d=e("borderwidth"),l=e("showarrow"),l&&(e("arrowcolor",v?h.bordercolor:u.defaultLine),e("arrowhead"),e("arrowsize"),e("arrowwidth",(v&&d||1)*2),e("ax"),e("ay"),e("axref"),e("ayref"),i.noneOrAll(n,h,["ax","ay"])),e("text",l?" ":"new text"),e("textangle"),i.coerceFont(e,"font",t.font),g=["x","y"],a=0;a<2;a++){var o=g[a],y={_fullLayout:t},p=r.coerceRef(n,h,y,o),nt=r.coerceARef(n,h,y,o),w=.5;p!=="paper"&&(s=r.getFromId(y,p),w=s.range[0]+w*(s.range[1]-s.range[0]),["date","category"].indexOf(s.type)!==-1&&typeof n[o]=="string"&&(s.type==="date"?(c=i.dateTime2ms(n[o]),c!==!1&&(n[o]=c),nt===p&&(b=i.dateTime2ms(n["a"+o]),b!==!1&&(n["a"+o]=b))):(s._categories||[]).length&&(c=s._categories.indexOf(n[o]),c!==-1&&(n[o]=c))));e(o,w);l||e(o+"anchor")}return i.noneOrAll(n,h,["x","y"]),h}},{"../../lib":681,"../../plots/cartesian/axes":710,"../color":582,"./attributes":575}],574:[function(n,t){"use strict";t.exports=["",{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0},{path:"M2,2V-2H-2V2Z",backoff:0}]},{}],575:[function(n,t){"use strict";var r=n("./arrow_paths"),u=n("../../plots/font_attributes"),i=n("../../plots/cartesian/constants"),f=n("../../lib/extend").extendFlat;t.exports={_isLinkedToArray:!0,text:{valType:"string"},textangle:{valType:"angle",dflt:0},font:f({},u,{}),opacity:{valType:"number",min:0,max:1,dflt:1},align:{valType:"enumerated",values:["left","center","right"],dflt:"center"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)"},borderpad:{valType:"number",min:0,dflt:1},borderwidth:{valType:"number",min:0,dflt:1},showarrow:{valType:"boolean",dflt:!0},arrowcolor:{valType:"color"},arrowhead:{valType:"integer",min:0,max:r.length,dflt:1},arrowsize:{valType:"number",min:.3,dflt:1},arrowwidth:{valType:"number",min:.1},ax:{valType:"number",dflt:-10},ay:{valType:"number",dflt:-30},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.x.toString()]},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.y.toString()]},xref:{valType:"enumerated",values:["paper",i.idRegex.x.toString()]},x:{valType:"number"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto"},yref:{valType:"enumerated",values:["paper",i.idRegex.y.toString()]},y:{valType:"number"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto"},_deprecated:{ref:{valType:"string"}}}},{"../../lib/extend":673,"../../plots/cartesian/constants":715,"../../plots/font_attributes":729,"./arrow_paths":574}],576:[function(n,t){"use strict";function f(n){var t=n._fullLayout;t.annotations.forEach(function(t){var r=i.getFromId(n,t.xref),u=i.getFromId(n,t.yref),f;if(r||u){var c=(t._xsize||0)/2,l=t._xshift||0,a=(t._ysize||0)/2,v=t._yshift||0,e=c-l,o=c+l,s=a-v,h=a+v;t.showarrow&&(f=3*t.arrowsize*t.arrowwidth,e=Math.max(e,f),o=Math.max(o,f),s=Math.max(s,f),h=Math.max(h,f));r&&r.autorange&&i.expand(r,[r.l2c(t.x)],{ppadplus:o,ppadminus:e});u&&u.autorange&&i.expand(u,[u.l2c(t.y)],{ppadplus:h,ppadminus:s})}})}var r=n("../../lib"),i=n("../../plots/cartesian/axes"),u=n("./draw").draw;t.exports=function(n){var s=n._fullLayout,e=s.annotations,t,o;if(e.length&&n._fullData.length)return(t={},e.forEach(function(n){t[n.xref]=!0;t[n.yref]=!0}),o=i.list(n).filter(function(n){return n.autorange&&t[n._id]}),!o.length)?void 0:r.syncOrAsync([u,f],n)}},{"../../lib":681,"../../plots/cartesian/axes":710,"./draw":578}],577:[function(n,t){"use strict";var i=n("./annotation_defaults");t.exports=function(n,t){for(var f,e,u=n.annotations||[],o=t.annotations=[],r=0;r<u.length;r++)f=u[r]||{},e=i(f,t),o.push(e)}},{"./annotation_defaults":573}],578:[function(n,t){"use strict";function h(n){var i=n._fullLayout,t;for(i._infolayer.selectAll(".annotation").remove(),t=0;t<i.annotations.length;t++)e(n,t);return p.previousPromises(n)}function e(n,t,p,d){function oi(n){return n.call(o.font,yi).attr({"text-anchor":{left:"start",right:"end"}[g.align]||"middle"}),c.convertToTspans(n,pi),n}function pi(){function ri(n,t){return t==="auto"&&(t=n<1/3?"left":n>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var p,c,y,ht,ct,lt,at,e,vt,ti,ii,nt,it,h;bt.selectAll("tspan.line").attr({y:0,x:0});var ot=st.select(".annotation-math-group"),kt=!ot.empty(),w=o.bBox((kt?ot:bt).node()),gt=w.width,ni=w.height,b=Math.round(gt+2*wt),d=Math.round(ni+2*wt);if(g._w=gt,g._h=ni,p=!1,["x","y"].forEach(function(t){var e=g[t+"ref"]||t,i=r.getFromId(n,e),o=(yt+(t==="x"?0:90))*Math.PI/180,s=b*Math.abs(Math.cos(o))+d*Math.abs(Math.sin(o)),h=g[t+"anchor"],u,f;if(i){if(!i.autorange&&(g[t]-i.range[0])*(g[t]-i.range[1])>0&&(g["a"+t+"ref"]===e?(g["a"+t]-i.range[0])*(g["a"+t]-i.range[1])>0&&(p=!0):p=!0,p))return;tt[t]=i._offset+i.l2p(g[t]);u=.5}else u=g[t],t==="y"&&(u=1-u),tt[t]=t==="x"?ut.l+ut.w*u:ut.t+ut.h*u;f=0;g["a"+t+"ref"]===e?tt["aa"+t]=i._offset+i.l2p(g["a"+t]):(f=g.showarrow?g["a"+t]:s*ri(u,h),tt[t]+=f);g["_"+t+"type"]=i&&i.type;g["_"+t+"size"]=s;g["_"+t+"shift"]=f}),p){st.remove();return}g.showarrow&&(c=g.axref===g.xref?tt.x:i.constrain(tt.x-g.ax,1,rt.width-1),y=g.ayref===g.yref?tt.y:i.constrain(tt.y-g.ay,1,rt.height-1));tt.x=i.constrain(tt.x,1,rt.width-1);tt.y=i.constrain(tt.y,1,rt.height-1);ht=wt-w.top;ct=wt-w.left;kt?ot.select("svg").attr({x:wt-1,y:wt}):(bt.attr({x:ct,y:ht}),bt.selectAll("tspan.line").attr({y:ht,x:ct}));ei.call(o.setRect,pt/2,pt/2,b-pt,d-pt);lt=0;at=0;lt=g.axref===g.xref?Math.round(tt.aax-b/2):Math.round(tt.x-b/2);at=g.ayref===g.yref?Math.round(tt.aay-d/2):Math.round(tt.y-d/2);st.call(i.setTranslate,lt,at);e="annotations["+t+"]";vt=function(r,o){var h,l,ht,b,ct,lt;v.select(n).selectAll('.annotation-arrow-g[data-index="'+t+'"]').remove();h=g.axref===g.xref?tt.aax+r:tt.x+r;l=g.ayref===g.yref?tt.aay+o:tt.y+o;var nt=i.rotationXYMatrix(yt,h,l),at=i.apply2DTransform(nt),vt=i.apply2DTransform2(nt),p=ei.attr("width")/2,w=ei.attr("height")/2,it=[[h-p,l-w,h-p,l+w],[h-p,l+w,h+p,l+w],[h+p,l+w,h+p,l-w],[h+p,l-w,h-p,l-w]].map(vt);if(!it.reduce(function(n,t){return n^!!a(c,y,c+1e6,y+1e6,t[0],t[1],t[2],t[3])},!1)){it.forEach(function(n){var t=a(h,l,c,y,n[0],n[1],n[2],n[3]);t&&(h=t.x,l=t.y)});var rt=g.arrowwidth,ot=g.arrowcolor,d=li.append("g").style({opacity:u.opacity(ot)}).classed("annotation-arrow-g",!0).attr("data-index",String(t)),pt=d.append("path").attr("d","M"+h+","+l+"L"+c+","+y).style("stroke-width",rt+"px").call(u.stroke,u.rgb(ot));k(pt,g.arrowhead,"end",g.arrowsize);ht=d.append("path").classed("annotation",!0).classed("anndrag",!0).attr({"data-index":String(t),d:"M3,3H-3V-3H3ZM0,0L"+(h-c)+","+(l-y),transform:"translate("+c+","+y+")"}).style("stroke-width",rt+6+"px").call(u.stroke,"rgba(0,0,0,0)").call(u.fill,"rgba(0,0,0,0)");n._context.editable&&f.init({element:ht.node(),prepFn:function(){var n=i.getTranslate(st);ct=n.x;lt=n.y;b={};ft&&ft.autorange&&(b[ft._name+".autorange"]=!0);et&&et.autorange&&(b[et._name+".autorange"]=!0)},moveFn:function(n,t){d.attr("transform","translate("+n+","+t+")");var r=at(ct,lt),u=r[0]+n,f=r[1]+t;st.call(i.setTranslate,u,f);b[e+".x"]=ft?g.x+n/ft._m:(c+n-ut.l)/ut.w;b[e+".y"]=et?g.y+t/et._m:1-(y+t-ut.t)/ut.h;g.axref===g.xref&&(b[e+".ax"]=ft?g.ax+n/ft._m:(c+n-ut.l)/ut.w);g.ayref===g.yref&&(b[e+".ay"]=et?g.ay+t/et._m:1-(y+t-ut.t)/ut.h);dt.attr({transform:"rotate("+yt+","+u+","+f+")"})},doneFn:function(t){if(t){s.relayout(n,b);var i=document.querySelector(".js-notes-box-panel");i&&i.redraw(i.selectedObj)}}})}};g.showarrow&&vt(0,0);ti=i.rotationXYMatrix(yt,tt.x,tt.y);ii=i.apply2DTransform(ti);n._context.editable&&f.init({element:st.node(),prepFn:function(){var n=i.getTranslate(st);nt=n.x;it=n.y;h={}},moveFn:function(n,t){var r,u,s,o,c;st.call(i.setTranslate,nt+n,it+t);r="pointer";g.showarrow?(h[e+".ax"]=g.axref===g.xref?ft.p2l(ft.l2p(g.ax)+n):g.ax+n,h[e+".ay"]=g.ayref===g.yref?et.p2l(et.l2p(g.ay)+t):g.ay+t,vt(n,t)):(ft?h[e+".x"]=g.x+n/ft._m:(u=g._xsize/ut.w,s=g.x+g._xshift/ut.w-u/2,h[e+".x"]=f.align(s+n/ut.w,u,0,1,g.xanchor)),et?h[e+".y"]=g.y+t/et._m:(o=g._ysize/ut.h,c=g.y-g._yshift/ut.h-o/2,h[e+".y"]=f.align(c-t/ut.h,o,0,1,g.yanchor)),ft&&et||(r=f.getCursor(ft?.5:h[e+".x"],et?.5:h[e+".y"],g.xanchor,g.yanchor)));var a=ii(nt,it),v=a[0]+n,y=a[1]+t;st.call(i.setTranslate,nt+n,it+t);dt.attr({transform:"rotate("+yt+","+v+","+y+")"});l(st,r)},doneFn:function(t){if(l(st),t){s.relayout(n,h);var i=document.querySelector(".js-notes-box-panel");i&&i.redraw(i.selectedObj)}}})}var at=n.layout,rt=n._fullLayout,it,gt,ht,ni,si,vt,ti,ii,ut,hi,ct,ui,fi,g;if(!y(t)||t===-1){if(!t&&Array.isArray(d)){at.annotations=d;b(at,rt);h(n);return}if(d==="remove"){delete at.annotations;rt.annotations=[];h(n);return}if(p&&d!=="add"){for(it=0;it<rt.annotations.length;it++)e(n,it,p,d);return}t=rt.annotations.length;rt.annotations.push({})}if(!p&&d){if(d==="remove"){for(rt._infolayer.selectAll('.annotation[data-index="'+t+'"]').remove(),rt.annotations.splice(t,1),at.annotations.splice(t,1),it=t;it<rt.annotations.length;it++)rt._infolayer.selectAll('.annotation[data-index="'+(it+1)+'"]').attr("data-index",String(it)),e(n,it);return}if(d==="add"||i.isPlainObject(d))for(rt.annotations.splice(t,0,{}),gt=i.isPlainObject(d)?i.extendFlat({},d):{text:"New text"},at.annotations?at.annotations.splice(t,0,gt):at.annotations=[gt],it=rt.annotations.length-1;it>t;it--)rt._infolayer.selectAll('.annotation[data-index="'+(it-1)+'"]').attr("data-index",String(it)),e(n,it)}if(rt._infolayer.selectAll('.annotation[data-index="'+t+'"]').remove(),ht=at.annotations[t],ni=rt.annotations[t],ht){for(si={xref:ht.xref,yref:ht.yref},vt={},typeof p=="string"&&p?vt[p]=d:i.isPlainObject(p)&&(vt=p),ti=Object.keys(vt),it=0;it<ti.length;it++)ii=ti[it],i.nestedProperty(ht,ii).set(vt[ii]);for(ut=rt._size,hi=["x","y"],it=0;it<2;it++)if(ct=hi[it],vt[ct]===undefined&&ht[ct]!==undefined){var lt=r.getFromId(n,r.coerceRef(si,{},n,ct)),ot=r.getFromId(n,r.coerceRef(ht,{},n,ct)),nt=ht[ct],ri=ni["_"+ct+"type"];if(vt[ct+"ref"]!==undefined){var ci=ht[ct+"anchor"]==="auto",ai=ct==="x"?ut.w:ut.h,kt=(ni["_"+ct+"size"]||0)/(2*ai);lt&&ot?(nt=(nt-lt.range[0])/(lt.range[1]-lt.range[0]),nt=ot.range[0]+nt*(ot.range[1]-ot.range[0])):lt?(nt=(nt-lt.range[0])/(lt.range[1]-lt.range[0]),nt=lt.domain[0]+nt*(lt.domain[1]-lt.domain[0]),ci&&(ui=nt+kt,fi=nt-kt,nt+fi<2/3?nt=fi:nt+ui>4/3&&(nt=ui))):ot&&(ci&&(nt<1/3?nt+=kt:nt>2/3&&(nt-=kt)),nt=(nt-ot.domain[0])/(ot.domain[1]-ot.domain[0]),nt=ot.range[0]+nt*(ot.range[1]-ot.range[0]))}ot&&ot===lt&&ri&&(ri==="log"&&ot.type!=="log"?nt=Math.pow(10,nt):ri!=="log"&&ot.type==="log"&&(nt=nt>0?Math.log(nt)/Math.LN10:undefined));ht[ct]=nt}g=w(ht,rt);rt.annotations[t]=g;var ft=r.getFromId(n,g.xref),et=r.getFromId(n,g.yref),tt={x:0,y:0},yt=+g.textangle||0,li=rt._infolayer.append("g").classed("annotation",!0).attr("data-index",String(t)).style("opacity",g.opacity).on("click",function(){n._dragging=!1;n.emit("plotly_clickannotation",{index:t,annotation:ht,fullAnnotation:g})}),dt=li.append("g").classed("annotation-text-g",!0).attr("data-index",String(t)),st=dt.append("g"),pt=g.borderwidth,vi=g.borderpad,wt=pt+vi,ei=st.append("rect").attr("class","bg").style("stroke-width",pt+"px").call(u.stroke,g.bordercolor).call(u.fill,g.bgcolor),yi=g.font,bt=st.append("text").classed("annotation",!0).attr("data-unformatted",g.text).text(g.text);if(n._context.editable)bt.call(c.makeEditable,st).call(oi).on("edit",function(i){g.text=i;this.attr({"data-unformatted":g.text});this.call(oi);var r={};r["annotations["+t+"].text"]=g.text;ft&&ft.autorange&&(r[ft._name+".autorange"]=!0);et&&et.autorange&&(r[et._name+".autorange"]=!0);s.relayout(n,r)});else bt.call(oi);dt.attr({transform:"rotate("+yt+","+tt.x+","+tt.y+")"}).call(o.setPosition,tt.x,tt.y)}}function a(n,t,i,r,u,f,e,o){var h=i-n,v=u-n,y=e-u,c=r-t,p=f-t,w=o-f,l=h*w-y*c,s,a;return l===0?null:(s=(v*w-y*p)/l,a=(v*c-h*p)/l,a<0||a>1||s<0||s>1)?null:{x:n+h*s,y:t+c*s}}var v=n("d3"),y=n("fast-isnumeric"),s=n("../../plotly"),p=n("../../plots/plots"),i=n("../../lib"),r=n("../../plots/cartesian/axes"),u=n("../color"),o=n("../drawing"),c=n("../../lib/svg_text_utils"),l=n("../../lib/setcursor"),f=n("../dragelement"),w=n("./annotation_defaults"),b=n("./defaults"),k=n("./draw_arrow_head");t.exports={draw:h,drawOne:e}},{"../../lib":681,"../../lib/setcursor":691,"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/cartesian/axes":710,"../../plots/plots":769,"../color":582,"../dragelement":603,"../drawing":605,"./annotation_defaults":573,"./defaults":577,"./draw_arrow_head":579,d3:129,"fast-isnumeric":133}],579:[function(n,t){"use strict";var i=n("d3"),r=n("fast-isnumeric"),u=n("../color"),f=n("../drawing"),e=n("./arrow_paths");t.exports=function(n,t,o,s){var h,w,g,nt,v,y,tt,it,rt,ut,ot,ft;if(r(s)||(s=1),h=n.node(),w=e[t||0],w){typeof o=="string"&&o||(o="end");var et=(f.getPx(n,"stroke-width")||1)*s,st=n.style("stroke")||u.defaultLine,ht=n.style("stroke-opacity")||1,b=o.indexOf("start")>=0,k=o.indexOf("end")>=0,c=w.backoff*et,l,a,p,d;h.nodeName==="line"?(l={x:+n.attr("x1"),y:+n.attr("y1")},a={x:+n.attr("x2"),y:+n.attr("y2")},p=Math.atan2(l.y-a.y,l.x-a.x),d=p+Math.PI,c&&(g=c*Math.cos(p),nt=c*Math.sin(p),b&&(l.x-=g,l.y-=nt,n.attr({x1:l.x,y1:l.y})),k&&(a.x+=g,a.y+=nt,n.attr({x2:a.x,y2:a.y})))):h.nodeName==="path"&&(v=h.getTotalLength(),y="",b&&(tt=h.getPointAtLength(0),it=h.getPointAtLength(.1),p=Math.atan2(tt.y-it.y,tt.x-it.x),l=h.getPointAtLength(Math.min(c,v)),c&&(y="0px,"+c+"px,")),k?(rt=h.getPointAtLength(v),ut=h.getPointAtLength(v-.1),d=Math.atan2(rt.y-ut.y,rt.x-ut.x),a=h.getPointAtLength(Math.max(0,v-c)),c&&(ot=y?2*c:c,y+=v-ot+"px,"+v+"px")):y&&(y+=v+"px"),y&&n.style("stroke-dasharray",y));ft=function(r,u){t>5&&(u=0);i.select(h.parentElement).append("path").attr({"class":n.attr("class"),d:w.path,transform:"translate("+r.x+","+r.y+")rotate("+u*180/Math.PI+")scale("+et+")"}).style({fill:st,opacity:ht,"stroke-width":0})};b&&ft(l,p);k&&ft(a,d)}}},{"../color":582,"../drawing":605,"./arrow_paths":574,d3:129,"fast-isnumeric":133}],580:[function(n,t,i){"use strict";var u=n("../../plotly"),r;i.moduleType="component";i.name="annotations";i.ARROWPATHS=n("./arrow_paths");i.layoutAttributes=n("./attributes");i.supplyLayoutDefaults=n("./defaults");i.calcAutorange=n("./calc_autorange");i.arrowhead=n("./draw_arrow_head");r=n("./draw");i.draw=r.draw;i.drawOne=r.drawOne;i.add=function(n){var t=n._fullLayout.annotations.length;u.relayout(n,"annotations["+t+"]","add")}},{"../../plotly":706,"./arrow_paths":574,"./attributes":575,"./calc_autorange":576,"./defaults":577,"./draw":578,"./draw_arrow_head":579}],581:[function(n,t,i){"use strict";i.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];i.defaultLine="#444";i.lightLine="#eee";i.background="#fff";i.borderLine="#BEC8D9";i.lightFraction=1e3/11},{}],582:[function(n,t){"use strict";function f(n){var r,u,t,f,i,o;if(e(n)||typeof n!="string"||(r=n.trim(),r.substr(0,3)!=="rgb")||(u=r.match(/^rgba?\s*\(([^()]*)\)$/),!u)||(t=u[1].trim().split(/\s*[\s,]\s*/),f=r.charAt(3)==="a"&&t.length===4,!f&&t.length!==3))return n;for(i=0;i<t.length;i++){if(!t[i].length||(t[i]=Number(t[i]),!(t[i]>=0)))return n;if(i===3)t[i]>1&&(t[i]=1);else if(t[i]>=1)return n}return(o=Math.round(t[0]*255)+", "+Math.round(t[1]*255)+", "+Math.round(t[2]*255),f)?"rgba("+o+", "+t[3]+")":"rgb("+o+")"}var r=n("tinycolor2"),e=n("fast-isnumeric"),i=t.exports={},u=n("./attributes");i.defaults=u.defaults;i.defaultLine=u.defaultLine;i.lightLine=u.lightLine;i.background=u.background;i.tinyRGB=function(n){var t=n.toRgb();return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"};i.rgb=function(n){return i.tinyRGB(r(n))};i.opacity=function(n){return n?r(n).getAlpha():0};i.addOpacity=function(n,t){var i=r(n).toRgb();return"rgba("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+", "+t+")"};i.combine=function(n,t){var f=r(n).toRgb();if(f.a===1)return r(n).toRgbString();var u=r(t||i.background).toRgb(),e=u.a===1?u:{r:255*(1-u.a)+u.r*u.a,g:255*(1-u.a)+u.g*u.a,b:255*(1-u.a)+u.b*u.a},o={r:e.r*(1-f.a)+f.r*f.a,g:e.g*(1-f.a)+f.g*f.a,b:e.b*(1-f.a)+f.b*f.a};return r(o).toRgbString()};i.contrast=function(n,t,i){var u=r(n),f=u.isLight()?u.darken(i):u.lighten(t);return f.toString()};i.stroke=function(n,t){var u=r(t);n.style({stroke:i.tinyRGB(u),"stroke-opacity":u.getAlpha()})};i.fill=function(n,t){var u=r(t);n.style({fill:i.tinyRGB(u),"fill-opacity":u.getAlpha()})};i.clean=function(n){var s,e,r,u,t,o;if(n&&typeof n=="object")for(s=Object.keys(n),e=0;e<s.length;e++)if(u=s[e],t=n[u],u.substr(u.length-5)==="color")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]=f(t[r]);else n[u]=f(t);else if(u.substr(u.length-10)==="colorscale"&&Array.isArray(t))for(r=0;r<t.length;r++)Array.isArray(t[r])&&(t[r][1]=f(t[r][1]));else if(Array.isArray(t)){if(o=t[0],!Array.isArray(o)&&o&&typeof o=="object")for(r=0;r<t.length;r++)i.clean(t[r])}else t&&typeof t=="object"&&i.clean(t)}},{"./attributes":581,"fast-isnumeric":133,tinycolor2:546}],583:[function(n,t){"use strict";var i=n("../../plots/cartesian/layout_attributes"),u=n("../../plots/font_attributes"),r=n("../../lib/extend").extendFlat;t.exports={thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:i.linecolor,outlinewidth:i.linewidth,bordercolor:i.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:i.tickmode,nticks:i.nticks,tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:r({},i.ticks,{dflt:""}),ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,tickfont:i.tickfont,tickangle:i.tickangle,tickformat:i.tickformat,tickprefix:i.tickprefix,showtickprefix:i.showtickprefix,ticksuffix:i.ticksuffix,showticksuffix:i.showticksuffix,separatethousands:i.separatethousands,exponentformat:i.exponentformat,showexponent:i.showexponent,title:{valType:"string",dflt:"Click to enter colorscale title"},titlefont:r({},u,{}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},{"../../lib/extend":673,"../../plots/cartesian/layout_attributes":719,"../../plots/font_attributes":729}],584:[function(n,t){"use strict";var i=n("../../lib"),r=n("../../plots/cartesian/tick_value_defaults"),u=n("../../plots/cartesian/tick_mark_defaults"),f=n("../../plots/cartesian/tick_label_defaults"),e=n("./attributes");t.exports=function(n,t,o){function s(n,t){return i.coerce(c,h,e,n,t)}var h=t.colorbar={},c=n.colorbar||{},a=s("thicknessmode"),l;s("thickness",a==="fraction"?30/(o.width-o.margin.l-o.margin.r):30);l=s("lenmode");s("len",l==="fraction"?1:o.height-o.margin.t-o.margin.b);s("x");s("xanchor");s("xpad");s("y");s("yanchor");s("ypad");i.noneOrAll(c,h,["x","y"]);s("outlinecolor");s("outlinewidth");s("bordercolor");s("borderwidth");s("bgcolor");r(c,h,s,"linear");f(c,h,s,"linear",{outerTicks:!1,font:o.font,noHover:!0});u(c,h,s,"linear",{outerTicks:!1,font:o.font,noHover:!0});s("title");i.coerceFont(s,"titlefont",o.font);s("titleside")}},{"../../lib":681,"../../plots/cartesian/tick_label_defaults":725,"../../plots/cartesian/tick_mark_defaults":726,"../../plots/cartesian/tick_value_defaults":727,"./attributes":583}],585:[function(n,t){"use strict";var i=n("d3"),h=n("tinycolor2"),c=n("../../plotly"),e=n("../../plots/plots"),l=n("../../registry"),a=n("../../plots/cartesian/axes"),f=n("../dragelement"),r=n("../../lib"),v=n("../../lib/extend").extendFlat,o=n("../../lib/setcursor"),u=n("../drawing"),s=n("../color"),y=n("../titles"),p=n("../../plots/cartesian/axis_defaults"),w=n("../../plots/cartesian/position_defaults"),b=n("../../plots/cartesian/layout_attributes"),k=n("./attributes");t.exports=function(n,t){function g(){function ai(n,t){return r.coerce(ui,k,b,n,t)}function ur(){var v,s,c;if(["top","bottom"].indexOf(d.titleside)!==-1){var f=it.select(".cbtitle"),t=f.select("text"),e=[-d.outlinewidth/2,d.outlinewidth/2],l=f.select(".h"+k._id+"title-math-group").node(),o=15.6;t.node()&&(o=parseInt(t.style("font-size"),10)*1.3);l?(ot=u.bBox(l).height,ot>o&&(e[1]-=(ot-o)/2)):t.node()&&!t.classed("js-placeholder")&&(ot=u.bBox(f.node()).height);ot&&(ot+=5,d.titleside==="top"?(k.domain[1]-=ot/tt.h,e[1]*=-1):(k.domain[0]+=ot/tt.h,v=Math.max(1,t.selectAll("tspan.line").size()),e[1]+=(1-v)*o),f.attr("transform","translate("+e+")"),k.setScale())}return it.selectAll(".cbfills,.cblines,.cbaxis").attr("transform","translate(0,"+Math.round(tt.h*(1-k.domain[1]))+")"),s=it.select(".cbfills").selectAll("rect.cbfill").data(rt),s.enter().append("rect").classed("cbfill",!0).style("stroke","none"),s.exit().remove(),s.each(function(n,t){var r=[t===0?et[0]:(rt[t]+rt[t-1])/2,t===rt.length-1?et[1]:(rt[t]+rt[t+1])/2].map(k.c2p).map(Math.round),u,f;t!==rt.length-1&&(r[1]+=r[1]>r[0]?1:-1);u=ki(n).replace("e-","");f=h(u).toHexString();i.select(this).attr({x:lt,width:Math.max(ht,2),y:i.min(r),height:Math.max(i.max(r)-i.min(r),2),fill:f})}),c=it.select(".cblines").selectAll("path.cbline").data(d.line.color&&d.line.width?pt:[]),c.enter().append("path").classed("cbline",!0),c.exit().remove(),c.each(function(n){i.select(this).attr("d","M"+lt+","+(Math.round(k.c2p(n))+d.line.width/2%1)+"h"+ht).call(u.lineGroupStyle,d.line.width,bi(n),d.line.dash)}),k._axislayer.selectAll("g."+k._id+"tick,path").remove(),k._pos=lt+ht+(d.outlinewidth||0)/2-(d.ticks==="outside"?1:0),k.side="right",r.syncOrAsync([function(){return a.doTicks(n,k,!0)},function(){if(["top","bottom"].indexOf(d.titleside)===-1){var t=k.titlefont.size,r=k._offset+k._length/2,u=tt.l+(k.position||0)*tt.w+(k.side==="right"?10+t*(k.showticklabels?1:.5):-10-t*(k.showticklabels?.5:0));pi("h"+k._id+"title",{avoid:{selection:i.select(n).selectAll("g."+k._id+"tick"),side:d.titleside,offsetLeft:tt.l,offsetTop:tt.t,maxShift:ft.width},attributes:{x:u,y:r,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])}function pi(t,i){var u=nt(),f,e,r;f=l.traceIs(u,"markerColorscale")?"marker.colorbar.title":"colorbar.title";e={propContainer:k,propName:f,traceIndex:u.index,dfltName:"colorscale",containerGroup:it.select(".cbtitle")};r=t.charAt(0)==="h"?t.substr(1):"h"+t;it.selectAll("."+r+",."+r+"-math-group").remove();y.draw(n,t,v(e,i||{}))}function fr(){var f=ht+d.outlinewidth/2+u.bBox(k._axislayer.node()).width,o,h,i,r,c;ri=bt.select("text");ri.node()&&!ri.classed("js-placeholder")&&(o=bt.select(".h"+k._id+"title-math-group").node(),h=o&&["top","bottom"].indexOf(d.titleside)!==-1?u.bBox(o).width:u.bBox(bt.node()).right-lt-tt.l,f=Math.max(f,h));i=2*d.xpad+f+d.borderwidth+d.outlinewidth/2;r=ii-wt;it.select(".cbbg").attr({x:lt-d.xpad-(d.borderwidth+d.outlinewidth)/2,y:wt-ci,width:Math.max(i,2),height:Math.max(r+2*ci,2)}).call(s.fill,d.bgcolor).call(s.stroke,d.bordercolor).style({"stroke-width":d.borderwidth});it.selectAll(".cboutline").attr({x:lt,y:wt+d.ypad+(d.titleside==="top"?ot:0),width:Math.max(ht,2),height:Math.max(r-2*d.ypad-ot,2)}).call(s.stroke,d.outlinecolor).style({fill:"None","stroke-width":d.outlinewidth});c=({center:.5,right:1}[d.xanchor]||0)*i;it.attr("transform","translate("+(tt.l-c)+","+tt.t+")");e.autoMargin(n,t,{x:d.x,y:d.y,l:i*({right:1,center:.5}[d.xanchor]||0),r:i*({left:1,center:.5}[d.xanchor]||0),t:r*({bottom:1,middle:.5}[d.yanchor]||0),b:r*({top:1,middle:.5}[d.yanchor]||0)})}var ft=n._fullLayout,tt=ft._size,oi,it,bt,ot,vi,si,yi,yt,wi,kt,dt;if(typeof d.fillcolor!="function"&&typeof d.line.color!="function"){ft._infolayer.selectAll("g."+t).remove();return}for(var et=i.extent((typeof d.fillcolor=="function"?d.fillcolor:d.line.color).domain()),pt=[],rt=[],bi=typeof d.line.color=="function"?d.line.color:function(){return d.line.color},ki=typeof d.fillcolor=="function"?d.fillcolor:function(){return d.fillcolor},gt=d.levels.end+d.levels.size/100,at=d.levels.size,di=1.001*et[0]-.001*et[1],gi=1.001*et[1]-.001*et[0],ut=d.levels.start;(ut-gt)*at<0;ut+=at)ut>di&&ut<gi&&pt.push(ut);if(typeof d.fillcolor=="function")if(d.filllevels)for(gt=d.filllevels.end+d.filllevels.size/100,at=d.filllevels.size,ut=d.filllevels.start;(ut-gt)*at<0;ut+=at)ut>et[0]&&ut<et[1]&&rt.push(ut);else rt=pt.map(function(n){return n-d.levels.size/2}),rt.push(rt[rt.length-1]+d.levels.size);else d.fillcolor&&typeof d.fillcolor=="string"&&(rt=[0]);d.levels.size<0&&(pt.reverse(),rt.reverse());var nr=ft.height-ft.margin.t-ft.margin.b,tr=ft.width-ft.margin.l-ft.margin.r,ht=Math.round(d.thickness*(d.thicknessmode==="fraction"?tr:1)),ni=ht/tt.w,hi=Math.round(d.len*(d.lenmode==="fraction"?nr:1)),vt=hi/tt.h,ti=d.xpad/tt.w,ci=(d.borderwidth+d.outlinewidth)/2,ct=d.ypad/tt.h,lt=Math.round(d.x*tt.w+d.xpad),ir=d.x-ni*({middle:.5,right:1}[d.xanchor]||0),st=d.y+vt*(({top:-.5,bottom:.5}[d.yanchor]||0)-.5),ii=Math.round(tt.h*(1-st)),wt=ii-hi,ri,ui={type:"linear",range:et,tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,tickfont:d.tickfont,tickangle:d.tickangle,tickformat:d.tickformat,exponentformat:d.exponentformat,separatethousands:d.separatethousands,showexponent:d.showexponent,showtickprefix:d.showtickprefix,tickprefix:d.tickprefix,showticksuffix:d.showticksuffix,ticksuffix:d.ticksuffix,title:d.title,titlefont:d.titlefont,anchor:"free",position:1},k={},li={letter:"y",font:ft.font,noHover:!0};if(p(ui,k,ai,li),w(ui,k,ai,li),k._id="y"+t,k._gd=n,k.position=d.x+ti+ni,g.axis=k,["top","bottom"].indexOf(d.titleside)!==-1&&(k.titleside=d.titleside,k.titlex=d.x+ti,k.titley=st+(d.titleside==="top"?vt-ct:ct)),d.line.color&&d.tickmode==="auto"){k.tickmode="linear";k.tick0=d.levels.start;var fi=d.levels.size,rr=r.constrain((ii-wt)/50,4,15)+1,ei=(et[1]-et[0])/((d.nticks||rr)*fi);ei>1&&(oi=Math.pow(10,Math.floor(Math.log(ei)/Math.LN10)),fi*=oi*r.roundUp(ei/oi,[2,5,10]),(Math.abs(d.levels.start)/d.levels.size+1e-6)%1<2e-6&&(k.tick0=0));k.dtick=fi}return k.domain=[st+ct,st+vt-ct],k.setScale(),it=ft._infolayer.selectAll("g."+t).data([0]),it.enter().append("g").classed(t,!0).each(function(){var n=i.select(this);n.append("rect").classed("cbbg",!0);n.append("g").classed("cbfills",!0);n.append("g").classed("cblines",!0);n.append("g").classed("cbaxis",!0).classed("crisp",!0);n.append("g").classed("cbtitleunshift",!0).append("g").classed("cbtitle",!0);n.append("rect").classed("cboutline",!0);n.select(".cbtitle").datum(0)}),it.attr("transform","translate("+Math.round(tt.l)+","+Math.round(tt.t)+")"),bt=it.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(tt.l)+",-"+Math.round(tt.t)+")"),k._axislayer=it.select(".cbaxis"),ot=0,["top","bottom"].indexOf(d.titleside)!==-1&&(vi=tt.l+(d.x+ti)*tt.w,si=k.titlefont.size,yi=d.titleside==="top"?(1-(st+vt-ct))*tt.h+tt.t+3+si*.75:(1-(st+ct))*tt.h+tt.t-3-si*.25,pi(k._id+"title",{attributes:{x:vi,y:yi,"text-anchor":"start"}})),yt=r.syncOrAsync([e.previousPromises,ur,e.previousPromises,fr],n),yt&&yt.then&&(n._promises||[]).push(yt),n._context.editable&&f.init({element:it.node(),prepFn:function(){wi=it.attr("transform");o(it)},moveFn:function(n,t){it.attr("transform",wi+" translate("+n+","+t+")");kt=f.align(ir+n/tt.w,ni,0,1,d.xanchor);dt=f.align(st-t/tt.h,vt,0,1,d.yanchor);var i=f.getCursor(kt,dt,d.xanchor,d.yanchor);o(it,i)},doneFn:function(t){o(it);t&&kt!==undefined&&dt!==undefined&&c.restyle(n,{"colorbar.x":kt,"colorbar.y":dt},nt().index)}}),yt}function nt(){for(var u=t.substr(2),r,i=0;i<n._fullData.length;i++)if(r=n._fullData[i],r.uid===u)return r}var d={};return Object.keys(k).forEach(function(n){d[n]=null}),d.fillcolor=null,d.line={color:null,width:null,dash:null},d.levels={start:null,end:null,size:null},d.filllevels=null,Object.keys(d).forEach(function(n){g[n]=function(t){return arguments.length?(d[n]=r.isPlainObject(d[n])?r.extendFlat(d[n],t):t,g):d[n]}}),g.options=function(n){return Object.keys(n).forEach(function(t){typeof g[t]=="function"&&g[t](n[t])}),g},g._opts=d,g}},{"../../lib":681,"../../lib/extend":673,"../../lib/setcursor":691,"../../plotly":706,"../../plots/cartesian/axes":710,"../../plots/cartesian/axis_defaults":711,"../../plots/cartesian/layout_attributes":719,"../../plots/cartesian/position_defaults":722,"../../plots/plots":769,"../../registry":784,"../color":582,"../dragelement":603,"../drawing":605,"../titles":656,"./attributes":583,d3:129,tinycolor2:546}],586:[function(n,t){"use strict";var i=n("../../lib");t.exports=function(n){return i.isPlainObject(n.colorbar)}},{"../../lib":681}],587:[function(n,t,i){"use strict";i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.draw=n("./draw");i.hasColorbar=n("./has_colorbar")},{"./attributes":583,"./defaults":584,"./draw":585,"./has_colorbar":586}],588:[function(n,t){"use strict";t.exports={zauto:{valType:"boolean",dflt:!0},zmin:{valType:"number",dflt:null},zmax:{valType:"number",dflt:null},colorscale:{valType:"colorscale"},autocolorscale:{valType:"boolean",dflt:!0},reversescale:{valType:"boolean",dflt:!1},showscale:{valType:"boolean",dflt:!0}}},{}],589:[function(n,t){"use strict";var i=n("../../lib"),r=n("./scales"),u=n("./flip_scale");t.exports=function(n,t,f,e){var o,c;f?(o=i.nestedProperty(n,f).get(),c=i.nestedProperty(n._input,f).get()):(o=n,c=n._input);var a=o[e+"auto"],s=o[e+"min"],h=o[e+"max"],l=o.colorscale;(a!==!1||s===undefined)&&(s=i.aggNums(Math.min,null,t));(a!==!1||h===undefined)&&(h=i.aggNums(Math.max,null,t));s===h&&(s-=.5,h+=.5);o[e+"min"]=s;o[e+"max"]=h;c[e+"min"]=s;c[e+"max"]=h;o.autocolorscale&&(l=s*h<0?r.RdBu:s>=0?r.Reds:r.Blues,c.colorscale=l,o.reversescale&&(l=u(l)),o.colorscale=l)}},{"../../lib":681,"./flip_scale":593,"./scales":600}],590:[function(n,t){"use strict";var i=n("./attributes"),r=n("../../lib/extend").extendDeep,u=n("./scales.js");t.exports=function(){return{color:{valType:"color",arrayOk:!0},colorscale:r({},i.colorscale,{}),cauto:r({},i.zauto,{}),cmax:r({},i.zmax,{}),cmin:r({},i.zmin,{}),autocolorscale:r({},i.autocolorscale,{}),reversescale:r({},i.reversescale,{})}}},{"../../lib/extend":673,"./attributes":588,"./scales.js":600}],591:[function(n,t){"use strict";var i=n("./scales");t.exports=i.RdBu},{"./scales":600}],592:[function(n,t){"use strict";var i=n("fast-isnumeric"),r=n("../../lib"),u=n("../colorbar/has_colorbar"),f=n("../colorbar/defaults"),e=n("./is_valid_scale"),o=n("./flip_scale");t.exports=function(n,t,s,h,c){var l=c.prefix,a=c.cLetter,y=l.slice(0,l.length-1),v=l?r.nestedProperty(n,y).get()||{}:n,p=l?r.nestedProperty(t,y).get()||{}:t,w=v[a+"min"],b=v[a+"max"],k=v.colorscale,rt=i(w)&&i(b)&&w<b,d,g,nt,tt,it;(h(l+a+"auto",!rt),h(l+a+"min"),h(l+a+"max"),k!==undefined&&(d=!e(k)),h(l+"autocolorscale",d),g=h(l+"colorscale"),nt=h(l+"reversescale"),nt&&(p.colorscale=o(g)),l!=="marker.line.")&&(l&&(tt=u(v)),it=h(l+"showscale",tt),it&&f(v,p,s))}},{"../../lib":681,"../colorbar/defaults":584,"../colorbar/has_colorbar":586,"./flip_scale":593,"./is_valid_scale":597,"fast-isnumeric":133}],593:[function(n,t){"use strict";t.exports=function(n){for(var r=n.length,u=new Array(r),t,i=r-1,f=0;i>=0;i--,f++)t=n[i],u[f]=[1-t[0],t[1]];return u}},{}],594:[function(n,t){"use strict";var i=n("./scales"),r=n("./default_scale"),u=n("./is_valid_scale_array");t.exports=function(n,t){function f(){try{n=i[n]||JSON.parse(n)}catch(r){n=t}}return(t||(t=r),!n)?t:(typeof n=="string"&&(f(),typeof n=="string"&&f()),!u(n))?t:n}},{"./default_scale":591,"./is_valid_scale_array":598,"./scales":600}],595:[function(n,t){"use strict";var i=n("fast-isnumeric"),r=n("../../lib"),u=n("./is_valid_scale");t.exports=function(n,t){var f=t?r.nestedProperty(n,t).get()||{}:n,o=f.color,s=!1,e;if(Array.isArray(o))for(e=0;e<o.length;e++)if(i(o[e])){s=!0;break}return r.isPlainObject(f)&&(s||f.showscale===!0||i(f.cmin)&&i(f.cmax)||u(f.colorscale)||r.isPlainObject(f.colorbar))}},{"../../lib":681,"./is_valid_scale":597,"fast-isnumeric":133}],596:[function(n,t,i){"use strict";i.scales=n("./scales");i.defaultScale=n("./default_scale");i.attributes=n("./attributes");i.handleDefaults=n("./defaults");i.calc=n("./calc");i.hasColorscale=n("./has_colorscale");i.isValidScale=n("./is_valid_scale");i.getScale=n("./get_scale");i.flipScale=n("./flip_scale");i.makeScaleFunction=n("./make_scale_function")},{"./attributes":588,"./calc":589,"./default_scale":591,"./defaults":592,"./flip_scale":593,"./get_scale":594,"./has_colorscale":595,"./is_valid_scale":597,"./make_scale_function":599,"./scales":600}],597:[function(n,t){"use strict";var i=n("./scales"),r=n("./is_valid_scale_array");t.exports=function(n){return i[n]!==undefined?!0:r(n)}},{"./is_valid_scale_array":598,"./scales":600}],598:[function(n,t){"use strict";var i=n("tinycolor2");t.exports=function(n){var u=0,r,t;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(r=0;r<n.length;r++){if(t=n[r],t.length!==2||+t[0]<u||!i(t[1]).isValid())return!1;u=+t[0]}return!0}},{tinycolor2:546}],599:[function(n,t){"use strict";var r=n("d3"),i=n("tinycolor2"),u=n("fast-isnumeric"),f=n("../../lib"),e=n("../color");t.exports=function(n,t,o){for(var v,h=n.length,l=new Array(h),a=new Array(h),c,s=0;s<h;s++)c=n[s],l[s]=t+c[0]*(o-t),a[s]=i(c[1]).toRgb();return v=r.scale.linear().domain(l).interpolate(r.interpolateObject).range(a),function(n){if(u(n)){var r=f.constrain(n,t,o),s=v(r);return i(s).toRgbString()}return i(n).isValid()?n:e.defaultLine}}},{"../../lib":681,"../color":582,d3:129,"fast-isnumeric":133,tinycolor2:546}],600:[function(n,t){"use strict";t.exports={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.062745098039215685,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.31372549019607843,"#33638d"],[.37647058823529411,"#2c728e"],[.4392156862745098,"#26828e"],[.50196078431372548,"#21918c"],[.56470588235294117,"#1fa088"],[.62745098039215685,"#28ae80"],[.69019607843137254,"#3fbc73"],[.75294117647058822,"#5ec962"],[.81568627450980391,"#84d44b"],[.8784313725490196,"#addc30"],[.94117647058823528,"#d8e219"],[1,"#fde725"]]}},{}],601:[function(n,t){"use strict";t.exports=function(n,t,i,r,u){var f=(n-i)/(r-i),e=f+t/(r-i),o=(f+e)/2;return u==="left"||u==="bottom"?f:u==="center"||u==="middle"?o:u==="right"||u==="top"?e:f<2/3-o?f:e>4/3-o?e:o}},{}],602:[function(n,t){"use strict";var i=n("../../lib"),r=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function(n,t,u,f){return n=u==="left"?0:u==="center"?1:u==="right"?2:i.constrain(Math.floor(n*3),0,2),t=f==="bottom"?0:f==="middle"?1:f==="top"?2:i.constrain(Math.floor(t*3),0,2),r[t][n]}},{"../../lib":681}],603:[function(n,t){"use strict";function e(){var t=document.createElement("div"),n;return t.className="dragcover",n=t.style,n.position="fixed",n.left=0,n.right=0,n.top=0,n.bottom=0,n.zIndex=999999999,n.background="none",document.body.appendChild(t),t}function s(n){n._dragging=!1;n._replotPending&&o.plot(n)}var o=n("../../plotly"),r=n("../../lib"),f=n("../../plots/cartesian/constants"),i=t.exports={},u;i.align=n("./align");i.getCursor=n("./cursor");u=n("./unhover");i.unhover=u.wrapped;i.unhoverRaw=u.raw;i.init=function(n){function w(i){return n.element.onmousemove=a,t._dragged=!1,t._dragging=!0,h=i.clientX,c=i.clientY,y=i.target,l=(new Date).getTime(),l-t._mouseDownTime<v?o+=1:(o=1,t._mouseDownTime=l),n.prepFn&&n.prepFn(i,h,c),u=e(),u.onmousemove=b,u.onmouseup=p,u.onmouseout=p,u.style.cursor=window.getComputedStyle(n.element).cursor,r.pauseEvent(i)}function b(u){var e=u.clientX-h,o=u.clientY-c,s=n.minDrag||f.MINDRAG;return Math.abs(e)<s&&(e=0),Math.abs(o)<s&&(o=0),(e||o)&&(t._dragged=!0,i.unhover(t)),n.moveFn&&n.moveFn(e,o,t._dragged),r.pauseEvent(u)}function p(i){if(a=n.element.onmousemove,n.setCursor&&(n.element.onmousemove=n.setCursor),u.onmousemove=null,u.onmouseup=null,u.onmouseout=null,r.removeElement(u),!t._dragging){t._dragged=!1;return}if(t._dragging=!1,(new Date).getTime()-t._mouseDownTime>v&&(o=Math.max(o-1,1)),n.doneFn&&n.doneFn(t._dragged,o),!t._dragged){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);y.dispatchEvent(f)}return s(t),t._dragged=!1,r.pauseEvent(i)}var t=r.getPlotDiv(n.element)||{},o=1,v=f.DBLCLICKDELAY,h,c,l,u,y,a;t._mouseDownTime||(t._mouseDownTime=0);a=n.element.onmousemove;n.setCursor&&(n.element.onmousemove=n.setCursor);n.element.onmousedown=w;n.element.style.pointerEvents="all"};i.coverSlip=e},{"../../lib":681,"../../plotly":706,"../../plots/cartesian/constants":715,"./align":601,"./cursor":602,"./unhover":604}],604:[function(n,t){"use strict";var r=n("../../lib/events"),i=t.exports={};i.wrapped=function(n,t,r){typeof n=="string"&&(n=document.getElementById(n));n._hoverTimer&&(clearTimeout(n._hoverTimer),n._hoverTimer=undefined);i.raw(n,t,r)};i.raw=function(n,t){var i=n._fullLayout;(t||(t={}),t.target&&r.triggerHandler(n,"plotly_beforehover",t)===!1)||(i._hoverlayer.selectAll("g").remove(),t.target&&n._hoverdata&&n.emit("plotly_unhover",{points:n._hoverdata}),n._hoverdata=undefined)}},{"../../lib/events":672}],605:[function(n,t){"use strict";function rt(n,t,r,u,e,o,s){var a,c,l,h;k.traceIs(r,"symbols")&&(a=it(r),t.attr("d",function(n){var u,t,f;return u=n.ms==="various"||o.size==="various"?3:tt.isBubble(r)?a(n.ms):(o.size||6)/2,n.mrc=u,t=i.symbolNumber(n.mx||o.symbol)||0,f=t%100,n.om=t%200>=100,i.symbolFuncs[f](u)+(t>=200?v:"")}).style("opacity",function(n){return(n.mo+1||o.opacity+1)-1}));n.so?(h=s.outlierwidth,l=s.outliercolor,c=o.outliercolor):(h=(n.mlw+1||s.width+1||(n.trace?n.trace.marker.line.width:0)+1)-1,l="mlc"in n?n.mlcc=e(n.mlc):Array.isArray(s.color)?f.defaultLine:s.color,c="mc"in n?n.mcc=u(n.mc):Array.isArray(o.color)?f.defaultLine:o.color||"rgba(0,0,0,0)");n.om?t.call(f.stroke,c).style({"stroke-width":(h||1)+"px",fill:"none"}):(t.style("stroke-width",h+"px").call(f.fill,c),h&&t.call(f.stroke,l))}function h(n,t,i,u){var h=n[0]-t[0],c=n[1]-t[1],a=i[0]-t[0],v=i[1]-t[1],f=Math.pow(h*h+c*c,l/2),e=Math.pow(a*a+v*v,l/2),y=(e*e*h-f*f*a)*u,p=(e*e*c-f*f*v)*u,o=3*e*(f+e),s=3*f*(f+e);return[[r.round(t[0]+(o&&y/o),2),r.round(t[1]+(o&&p/o),2)],[r.round(t[0]-(s&&y/s),2),r.round(t[1]-(s&&p/s),2)]]}var r=n("d3"),e=n("fast-isnumeric"),k=n("../../registry"),f=n("../color"),d=n("../colorscale"),u=n("../../lib"),g=n("../../lib/svg_text_utils"),nt=n("../../constants/xmlns_namespaces"),tt=n("../../traces/scatter/subtypes"),it=n("../../traces/scatter/make_bubble_size_func"),i=t.exports={},c,a,v,s,y,l,p,w,o,b;i.font=function(n,t,i,r){t&&t.family&&(r=t.color,i=t.size,t=t.family);t&&n.style("font-family",t);i+1&&n.style("font-size",i+"px");r&&n.call(f.fill,r)};i.setPosition=function(n,t,i){n.attr("x",t).attr("y",i)};i.setSize=function(n,t,i){n.attr("width",t).attr("height",i)};i.setRect=function(n,t,r,u,f){n.call(i.setPosition,t,r).call(i.setSize,u,f)};i.translatePoint=function(n,t,i,r){var u=n.xp||i.c2p(n.x),f=n.yp||r.c2p(n.y);e(u)&&e(f)?t.node().nodeName==="text"?t.attr("x",u).attr("y",f):t.attr("transform","translate("+u+","+f+")"):t.remove()};i.translatePoints=function(n,t,u,f){n.each(function(n){var e=r.select(this);i.translatePoint(n,e,t,u,f)})};i.getPx=function(n,t){return Number(n.style(t).replace(/px$/,""))};i.crispRound=function(n,t,i){return!t||!e(t)?i||0:n._context.staticPlot?t:t<1?1:Math.round(t)};i.singleLineStyle=function(n,t,r,u,e){t.style("fill","none");var o=(((n||[])[0]||{}).trace||{}).line||{},s=r||o.width||0,h=e||o.dash||"";f.stroke(t,u||o.color);i.dashLine(t,h,s)};i.lineGroupStyle=function(n,t,u,e){n.style("fill","none").each(function(n){var o=(((n||[])[0]||{}).trace||{}).line||{},s=t||o.width||0,h=e||o.dash||"";r.select(this).call(f.stroke,u||o.color).call(i.dashLine,h,s)})};i.dashLine=function(n,t,i){var r=Math.max(i,3);t==="solid"?t="":t==="dot"?t=r+"px,"+r+"px":t==="dash"?t=3*r+"px,"+3*r+"px":t==="longdash"?t=5*r+"px,"+5*r+"px":t==="dashdot"?t=3*r+"px,"+r+"px,"+r+"px,"+r+"px":t==="longdashdot"&&(t=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px");n.style({"stroke-dasharray":t,"stroke-width":i+"px"})};i.fillGroupStyle=function(n){n.style("stroke-width",0).each(function(t){var i=r.select(this);try{i.call(f.fill,t[0].trace.fillcolor)}catch(e){u.error(e,n);i.remove()}})};c=n("./symbol_defs");i.symbolNames=[];i.symbolFuncs=[];i.symbolNeedLines={};i.symbolNoDot={};i.symbolList=[];Object.keys(c).forEach(function(n){var t=c[n];i.symbolList=i.symbolList.concat([t.n,n,t.n+100,n+"-open"]);i.symbolNames[t.n]=n;i.symbolFuncs[t.n]=t.f;t.needLine&&(i.symbolNeedLines[t.n]=!0);t.noDot?i.symbolNoDot[t.n]=!0:i.symbolList=i.symbolList.concat([t.n+200,n+"-dot",t.n+300,n+"-open-dot"])});a=i.symbolNames.length;v="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";i.symbolNumber=function(n){if(typeof n=="string"){var t=0;n.indexOf("-open")>0&&(t=100,n=n.replace("-open",""));n.indexOf("-dot")>0&&(t+=200,n=n.replace("-dot",""));n=i.symbolNames.indexOf(n);n>=0&&(n+=t)}return n%100>=a||n>=400?0:Math.floor(Math.max(n,0))};i.singlePointStyle=function(n,t,r){var u=r.marker,e=u.line,f=(r._input||{}).marker||{},o=i.tryColorscale(u,f,""),s=i.tryColorscale(u,f,"line.");rt(n,t,r,o,s,u,e)};i.pointStyle=function(n,t){if(n.size()){var u=t.marker,f=(t._input||{}).marker||{},e=i.tryColorscale(u,f,""),o=i.tryColorscale(u,f,"line.");n.each(function(n){i.singlePointStyle(n,r.select(this),t,e,o)})}};i.tryColorscale=function(n,t,i){var o=u.nestedProperty(n,i+"color").get(),s=u.nestedProperty(n,i+"colorscale").get(),l=u.nestedProperty(n,i+"cauto").get(),h=u.nestedProperty(n,i+"cmin"),c=u.nestedProperty(n,i+"cmax"),r=h.get(),f=c.get();return s&&Array.isArray(o)?(!l&&e(r)&&e(f)||(r=Infinity,f=-Infinity,o.forEach(function(n){e(n)&&(r>n&&(r=+n),f<n&&(f=+n))}),r>f&&(r=0,f=1),h.set(r),c.set(f),u.nestedProperty(t,i+"cmin").set(r),u.nestedProperty(t,i+"cmax").set(f)),d.makeScaleFunction(s,r,f)):u.identity};s={start:1,end:-1,middle:0,bottom:1,top:-1};y=1.3;i.textPointStyle=function(n,t){n.each(function(n){var f=r.select(this),h=n.tx||t.text;if(!h||Array.isArray(h)){f.remove();return}var o=n.tp||t.textposition,c=o.indexOf("top")!==-1?"top":o.indexOf("bottom")!==-1?"bottom":"middle",l=o.indexOf("left")!==-1?"end":o.indexOf("right")!==-1?"start":"middle",u=n.ts||t.textfont.size,a=n.mrc?n.mrc/.8+1:0;u=e(u)&&u>0?u:0;f.call(i.font,n.tf||t.textfont.family,u,n.tc||t.textfont.color).attr("text-anchor",l).text(h).call(g.convertToTspans);var w=r.select(this.parentNode),v=f.selectAll("tspan.line"),p=((v[0].length||1)-1)*y+1,b=s[l]*a,k=u*.75+s[c]*a+(s[c]-1)*p*u/2;w.attr("transform","translate("+b+","+k+")");p>1&&v.attr({x:f.attr("x"),y:f.attr("y")})})};l=.5;i.smoothopen=function(n,t){if(n.length<3)return"M"+n.join("L");for(var u="M"+n[0],r=[],i=1;i<n.length-1;i++)r.push(h(n[i-1],n[i],n[i+1],t));for(u+="Q"+r[0][0]+" "+n[1],i=2;i<n.length-1;i++)u+="C"+r[i-2][1]+" "+r[i-1][0]+" "+n[i];return u+("Q"+r[n.length-3][1]+" "+n[n.length-1])};i.smoothclosed=function(n,t){if(n.length<3)return"M"+n.join("L")+"Z";for(var f="M"+n[0],r=n.length-1,u=[h(n[r],n[0],n[1],t)],i=1;i<r;i++)u.push(h(n[i-1],n[i],n[i+1],t));for(u.push(h(n[r-1],n[r],n[0],t)),i=1;i<=r;i++)f+="C"+u[i-1][1]+" "+u[i][0]+" "+n[i];return f+("C"+u[r][1]+" "+u[0][0]+" "+n[0]+"Z")};p={hv:function(n,t){return"H"+r.round(t[0],2)+"V"+r.round(t[1],2)},vh:function(n,t){return"V"+r.round(t[1],2)+"H"+r.round(t[0],2)},hvh:function(n,t){return"H"+r.round((n[0]+t[0])/2,2)+"V"+r.round(t[1],2)+"H"+r.round(t[0],2)},vhv:function(n,t){return"V"+r.round((n[1]+t[1])/2,2)+"H"+r.round(t[0],2)+"V"+r.round(t[1],2)}};w=function(n,t){return"L"+r.round(t[0],2)+","+r.round(t[1],2)};i.steps=function(n){var t=p[n]||w;return function(n){for(var u="M"+r.round(n[0][0],2)+","+r.round(n[0][1],2),i=1;i<n.length;i++)u+=t(n[i-1],n[i]);return u}};i.makeTester=function(n){var t=r.select("body").selectAll("#js-plotly-tester").data([0]),i;t.enter().append("svg").attr("id","js-plotly-tester").attr(nt.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"});i=t.selectAll(".js-reference-point").data([0]);i.enter().append("path").classed("js-reference-point",!0).attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"});t.node()._cache||(t.node()._cache={});n._tester=t;n._testref=i};o=[];b=1e4;i.bBox=function(n){var e=n.attributes["data-bb"],t,i,s;if(e&&e.value)return u.extendFlat({},o[e.value]);var h=r.select("#js-plotly-tester"),c=h.node(),f=n.cloneNode(!0);return c.appendChild(f),r.select(f).attr({x:0,y:0,transform:""}),t=f.getBoundingClientRect(),i=h.select(".js-reference-point").node().getBoundingClientRect(),c.removeChild(f),s={height:t.height,width:t.width,left:t.left-i.left,top:t.top-i.top,right:t.right-i.left,bottom:t.bottom-i.top},o.length>=b&&(r.selectAll("[data-bb]").attr("data-bb",null),o=[]),n.setAttribute("data-bb",o.length),o.push(s),u.extendFlat({},s)};i.setClipUrl=function(n,t){if(!t){n.attr("clip-path",null);return}var i="#"+t,u=r.select("base");u.size()&&u.attr("href")&&(i=window.location.href+i);n.attr("clip-path","url("+i+")")}},{"../../constants/xmlns_namespaces":666,"../../lib":681,"../../lib/svg_text_utils":695,"../../registry":784,"../../traces/scatter/make_bubble_size_func":904,"../../traces/scatter/subtypes":909,"../color":582,"../colorscale":596,"./symbol_defs":606,d3:129,"fast-isnumeric":133}],606:[function(n,t){"use strict";var i=n("d3");t.exports={circle:{n:0,f:function(n){var t=i.round(n,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(n){var t=i.round(n*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(n){var t=i.round(n*.4,2),r=i.round(n*1.2,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(n){var t=i.round(n*.8/Math.sqrt(2),2),r="l"+t+","+t,e="l"+t+",-"+t,u="l-"+t+",-"+t,f="l-"+t+","+t;return"M0,"+t+r+e+u+e+u+f+u+f+r+f+r+"Z"}},"triangle-up":{n:5,f:function(n){var t=i.round(n*2/Math.sqrt(3),2),r=i.round(n/2,2),u=i.round(n,2);return"M-"+t+","+r+"H"+t+"L0,-"+u+"Z"}},"triangle-down":{n:6,f:function(n){var t=i.round(n*2/Math.sqrt(3),2),r=i.round(n/2,2),u=i.round(n,2);return"M-"+t+",-"+r+"H"+t+"L0,"+u+"Z"}},"triangle-left":{n:7,f:function(n){var t=i.round(n*2/Math.sqrt(3),2),r=i.round(n/2,2),u=i.round(n,2);return"M"+r+",-"+t+"V"+t+"L-"+u+",0Z"}},"triangle-right":{n:8,f:function(n){var t=i.round(n*2/Math.sqrt(3),2),r=i.round(n/2,2),u=i.round(n,2);return"M-"+r+",-"+t+"V"+t+"L"+u+",0Z"}},"triangle-ne":{n:9,f:function(n){var t=i.round(n*.6,2),r=i.round(n*1.2,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(n){var t=i.round(n*.6,2),r=i.round(n*1.2,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(n){var t=i.round(n*.6,2),r=i.round(n*1.2,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(n){var t=i.round(n*.6,2),r=i.round(n*1.2,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(n){var t=i.round(n*.951,2),r=i.round(n*.588,2),f=i.round(-n,2),u=i.round(n*-.309,2),e=i.round(n*.809,2);return"M"+t+","+u+"L"+r+","+e+"H-"+r+"L-"+t+","+u+"L0,"+f+"Z"}},hexagon:{n:14,f:function(n){var r=i.round(n,2),t=i.round(n/2,2),u=i.round(n*Math.sqrt(3)/2,2);return"M"+u+",-"+t+"V"+t+"L0,"+r+"L-"+u+","+t+"V-"+t+"L0,-"+r+"Z"}},hexagon2:{n:15,f:function(n){var r=i.round(n,2),t=i.round(n/2,2),u=i.round(n*Math.sqrt(3)/2,2);return"M-"+t+","+u+"H"+t+"L"+r+",0L"+t+",-"+u+"H-"+t+"L-"+r+",0Z"}},octagon:{n:16,f:function(n){var r=i.round(n*.924,2),t=i.round(n*.383,2);return"M-"+t+",-"+r+"H"+t+"L"+r+",-"+t+"V"+t+"L"+t+","+r+"H-"+t+"L-"+r+","+t+"V-"+t+"Z"}},star:{n:17,f:function(n){var t=n*1.4,r=i.round(t*.225,2),u=i.round(t*.951,2),f=i.round(t*.363,2),e=i.round(t*.588,2),c=i.round(-t,2),o=i.round(t*-.309,2),s=i.round(t*.118,2),h=i.round(t*.809,2),l=i.round(t*.382,2);return"M"+r+","+o+"H"+u+"L"+f+","+s+"L"+e+","+h+"L0,"+l+"L-"+e+","+h+"L-"+f+","+s+"L-"+u+","+o+"H-"+r+"L0,"+c+"Z"}},hexagram:{n:18,f:function(n){var t=i.round(n*.66,2),r=i.round(n*.38,2),u=i.round(n*.76,2);return"M-"+u+",0l-"+r+",-"+t+"h"+u+"l"+r+",-"+t+"l"+r+","+t+"h"+u+"l-"+r+","+t+"l"+r+","+t+"h-"+u+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+u+"Z"}},"star-triangle-up":{n:19,f:function(n){var t=i.round(n*Math.sqrt(3)*.8,2),r=i.round(n*.8,2),e=i.round(n*1.6,2),f=i.round(n*4,2),u="A "+f+","+f+" 0 0 1 ";return"M-"+t+","+r+u+t+","+r+u+"0,-"+e+u+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(n){var t=i.round(n*Math.sqrt(3)*.8,2),r=i.round(n*.8,2),e=i.round(n*1.6,2),f=i.round(n*4,2),u="A "+f+","+f+" 0 0 1 ";return"M"+t+",-"+r+u+"-"+t+",-"+r+u+"0,"+e+u+t+",-"+r+"Z"}},"star-square":{n:21,f:function(n){var t=i.round(n*1.1,2),u=i.round(n*2,2),r="A "+u+","+u+" 0 0 1 ";return"M-"+t+",-"+t+r+"-"+t+","+t+r+t+","+t+r+t+",-"+t+r+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(n){var t=i.round(n*1.4,2),u=i.round(n*1.9,2),r="A "+u+","+u+" 0 0 1 ";return"M-"+t+",0"+r+"0,"+t+r+t+",0"+r+"0,-"+t+r+"-"+t+",0Z"}},"diamond-tall":{n:23,f:function(n){var t=i.round(n*.7,2),r=i.round(n*1.4,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(n){var t=i.round(n*1.4,2),r=i.round(n*.7,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:!0},bowtie:{n:26,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:!0},"circle-cross":{n:27,f:function(n){var t=i.round(n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(n){var r=i.round(n,2),t=i.round(n/Math.sqrt(2),2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+r+",0A"+r+","+r+" 0 1,1 0,-"+r+"A"+r+","+r+" 0 0,1 "+r+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(n){var t=i.round(n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(n){var t=i.round(n*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(n){var r=i.round(n*1.3,2),t=i.round(n*.65,2);return"M"+r+",0L0,"+r+"L-"+r+",0L0,-"+r+"ZM-"+t+",-"+t+"L"+t+","+t+"M-"+t+","+t+"L"+t+",-"+t},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(n){var t=i.round(n*1.4,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:!0,noDot:!0},"x-thin":{n:34,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0},asterisk:{n:35,f:function(n){var r=i.round(n*1.2,2),t=i.round(n*.85,2);return"M0,"+r+"V-"+r+"M"+r+",0H-"+r+"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0},hash:{n:36,f:function(n){var r=i.round(n/2,2),t=i.round(n,2);return"M"+r+","+t+"V-"+t+"m-"+t+",0V"+t+"M"+t+","+r+"H-"+t+"m0,-"+t+"H"+t},needLine:!0},"y-up":{n:37,f:function(n){var t=i.round(n*1.2,2),u=i.round(n*1.6,2),r=i.round(n*.8,2);return"M-"+t+","+r+"L0,0M"+t+","+r+"L0,0M0,-"+u+"L0,0"},needLine:!0,noDot:!0},"y-down":{n:38,f:function(n){var t=i.round(n*1.2,2),u=i.round(n*1.6,2),r=i.round(n*.8,2);return"M-"+t+",-"+r+"L0,0M"+t+",-"+r+"L0,0M0,"+u+"L0,0"},needLine:!0,noDot:!0},"y-left":{n:39,f:function(n){var t=i.round(n*1.2,2),u=i.round(n*1.6,2),r=i.round(n*.8,2);return"M"+r+","+t+"L0,0M"+r+",-"+t+"L0,0M-"+u+",0L0,0"},needLine:!0,noDot:!0},"y-right":{n:40,f:function(n){var t=i.round(n*1.2,2),u=i.round(n*1.6,2),r=i.round(n*.8,2);return"M-"+r+","+t+"L0,0M-"+r+",-"+t+"L0,0M"+u+",0L0,0"},needLine:!0,noDot:!0},"line-ew":{n:41,f:function(n){var t=i.round(n*1.4,2);return"M"+t+",0H-"+t},needLine:!0,noDot:!0},"line-ns":{n:42,f:function(n){var t=i.round(n*1.4,2);return"M0,"+t+"V-"+t},needLine:!0,noDot:!0},"line-ne":{n:43,f:function(n){var t=i.round(n,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0},"line-nw":{n:44,f:function(n){var t=i.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:!0,noDot:!0}}},{d3:129}],607:[function(n,t){"use strict";t.exports={visible:{valType:"boolean"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"]},symmetric:{valType:"boolean"},array:{valType:"data_array"},arrayminus:{valType:"data_array"},value:{valType:"number",min:0,dflt:10},valueminus:{valType:"number",min:0,dflt:10},traceref:{valType:"integer",min:0,dflt:0},tracerefminus:{valType:"integer",min:0,dflt:0},copy_ystyle:{valType:"boolean"},copy_zstyle:{valType:"boolean"},color:{valType:"color"},thickness:{valType:"number",min:0,dflt:2},width:{valType:"number",min:0},_deprecated:{opacity:{valType:"number"}}}},{}],608:[function(n,t){"use strict";function u(n,t,u,f){var l=t["error_"+f]||{},w=l.visible&&["linear","log"].indexOf(u.type)!==-1,a=[],v,o,c,s,h,y,p;if(w){for(v=e(l),o=0;o<n.length;o++)(c=n[o],s=c[f],i(u.c2l(s)))&&(h=v(s,o),i(h[0])&&i(h[1])&&(y=c[f+"s"]=s-h[0],p=c[f+"h"]=s+h[1],a.push(y,p)));r.expand(u,a,{padded:!0})}}var i=n("fast-isnumeric"),f=n("../../registry"),r=n("../../plots/cartesian/axes"),e=n("./compute_error");t.exports=function(n){for(var i,t,s,h,o=n.calcdata,e=0;e<o.length;e++)(i=o[e],t=i[0].trace,f.traceIs(t,"errorBarsOK"))&&(s=r.getFromId(n,t.xaxis),h=r.getFromId(n,t.yaxis),u(i,t,s,"x"),u(i,t,h,"y"))}},{"../../plots/cartesian/axes":710,"../../registry":784,"./compute_error":609,"fast-isnumeric":133}],609:[function(n,t){"use strict";function i(n,t){return n==="percent"?function(n){return Math.abs(n*t/100)}:n==="constant"?function(){return Math.abs(t)}:n==="sqrt"?function(n){return Math.sqrt(Math.abs(n))}:void 0}t.exports=function(n){var t=n.type,e=n.symmetric,r,u,f,o;return t==="data"?(r=n.array,u=n.arrayminus,e||u===undefined?function(n,t){var i=+r[t];return[i,i]}:function(n,t){return[+u[t],+r[t]]}):(f=i(t,n.value),o=i(t,n.valueminus),e||n.valueminus===undefined?function(n){var t=f(n);return[t,t]}:function(n){return[o(n),f(n)]})}},{}],610:[function(n,t){"use strict";var i=n("fast-isnumeric"),r=n("../../registry"),u=n("../../lib"),f=n("./attributes");t.exports=function(n,t,e,o){function s(n,t){return u.coerce(h,l,f,n,t)}var y="error_"+o.axis,l=t[y]={},h=n[y]||{},k=h.array!==undefined||h.value!==undefined||h.type==="sqrt",d=s("visible",k),c,a,p,w,v,b;d!==!1&&(c=s("type","array"in h?"data":"percent"),a=!0,c!=="sqrt"&&(a=s("symmetric",!((c==="data"?"arrayminus":"valueminus")in h))),c==="data"?(p=s("array"),p||(l.array=[]),s("traceref"),a||(w=s("arrayminus"),w||(l.arrayminus=[]),s("tracerefminus"))):(c==="percent"||c==="constant")&&(s("value"),a||s("valueminus")),v="copy_"+o.inherit+"style",o.inherit&&(b=t["error_"+o.inherit],(b||{}).visible&&s(v,!(h.color||i(h.thickness)||i(h.width)))),o.inherit&&l[v]||(s("color",e),s("thickness"),s("width",r.traceIs(t,"gl3d")?0:4)))}},{"../../lib":681,"../../registry":784,"./attributes":607,"fast-isnumeric":133}],611:[function(n,t){"use strict";var i=t.exports={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("./calc");i.calcFromTrace=function(n,t){for(var f=n.x||[],e=n.y,o=f.length||e.length,u=new Array(o),r=0;r<o;r++)u[r]={x:f[r],y:e[r]};return u[0].trace=n,i.calc({calcdata:[u],_fullLayout:t}),u};i.plot=n("./plot");i.style=n("./style");i.hoverInfo=function(n,t,i){(t.error_y||{}).visible&&(i.yerr=n.yh-n.y,t.error_y.symmetric||(i.yerrneg=n.y-n.ys));(t.error_x||{}).visible&&(i.xerr=n.xh-n.x,t.error_x.symmetric||(i.xerrneg=n.x-n.xs))}},{"./attributes":607,"./calc":608,"./defaults":610,"./plot":612,"./style":613}],612:[function(n,t){"use strict";function f(n,t,r){var u={x:t.c2p(n.x),y:r.c2p(n.y)};return n.yh!==undefined&&(u.yh=r.c2p(n.yh),u.ys=r.c2p(n.ys),i(u.ys)||(u.noYS=!0,u.ys=r.c2p(n.ys,!0))),n.xh!==undefined&&(u.xh=t.c2p(n.xh),u.xs=t.c2p(n.xs),i(u.xs)||(u.noXS=!0,u.xs=t.c2p(n.xs,!0))),u}var r=n("d3"),i=n("fast-isnumeric"),u=n("../../traces/scatter/subtypes");t.exports=function(n,t,e){var o,h=t.xaxis,c=t.yaxis,s=e&&e.duration>0;n.each(function(n){var t=n[0].trace,a=t.error_x||{},v=t.error_y||{},y,p,l,w;(t.ids&&(y=function(n){return n.id}),p=u.hasMarkers(t)&&t.marker.maxdisplayed>0,v.visible||a.visible)&&(l=r.select(this).selectAll("g.errorbar").data(n,y),l.exit().remove(),l.style("opacity",1),w=l.enter().append("g").classed("errorbar",!0),s&&w.style("opacity",0).transition().duration(e.duration).style("opacity",1),l.each(function(n){var k=r.select(this),t=f(n,h,c),u,l,y,w,b;(!p||n.vis)&&(v.visible&&i(t.x)&&i(t.yh)&&i(t.ys)&&(l=v.width,u="M"+(t.x-l)+","+t.yh+"h"+2*l+"m-"+l+",0V"+t.ys,t.noYS||(u+="m-"+l+",0h"+2*l),y=k.select("path.yerror"),o=!y.size(),o?y=k.append("path").classed("yerror",!0):s&&(y=y.transition().duration(e.duration).ease(e.easing)),y.attr("d",u)),a.visible&&i(t.y)&&i(t.xh)&&i(t.xs)&&(w=(a.copy_ystyle?v:a).width,u="M"+t.xh+","+(t.y-w)+"v"+2*w+"m0,-"+w+"H"+t.xs,t.noXS||(u+="m0,-"+w+"v"+2*w),b=k.select("path.xerror"),o=!b.size(),o?b=k.append("path").classed("xerror",!0):s&&(b=b.transition().duration(e.duration).ease(e.easing)),b.attr("d",u)))}))})}},{"../../traces/scatter/subtypes":909,d3:129,"fast-isnumeric":133}],613:[function(n,t){"use strict";var r=n("d3"),i=n("../color");t.exports=function(n){n.each(function(n){var f=n[0].trace,u=f.error_y||{},t=f.error_x||{},e=r.select(this);e.selectAll("path.yerror").style("stroke-width",u.thickness+"px").call(i.stroke,u.color);t.copy_ystyle&&(t=u);e.selectAll("path.xerror").style("stroke-width",t.thickness+"px").call(i.stroke,t.color)})}},{"../color":582,d3:129}],614:[function(n,t){"use strict";var i=n("../../plots/cartesian/constants");t.exports={_isLinkedToArray:!0,source:{valType:"string"},layer:{valType:"enumerated",values:["below","above"],dflt:"above"},sizex:{valType:"number",dflt:0},sizey:{valType:"number",dflt:0},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain"},opacity:{valType:"number",min:0,max:1,dflt:1},x:{valType:"number",dflt:0},y:{valType:"number",dflt:0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top"},xref:{valType:"enumerated",values:["paper",i.idRegex.x.toString()],dflt:"paper"},yref:{valType:"enumerated",values:["paper",i.idRegex.y.toString()],dflt:"paper"}}},{"../../plots/cartesian/constants":715}],615:[function(n,t){"use strict";function f(n,t,f){function e(i,f){return r.coerce(n,t,u,i,f)}var o,s,h;for(t=t||{},e("source"),e("layer"),e("x"),e("y"),e("xanchor"),e("yanchor"),e("sizex"),e("sizey"),e("sizing"),e("opacity"),o=0;o<2;o++)s={_fullLayout:f},h=["x","y"][o],i.coerceRef(n,t,s,h,"paper");return t}var i=n("../../plots/cartesian/axes"),r=n("../../lib"),u=n("./attributes");t.exports=function(n,t){var r,u,i,e,o;if(n.images&&Array.isArray(n.images))for(r=n.images,u=t.images=[],i=0;i<r.length;i++)(e=r[i],e.source)&&(o=f(r[i]||{},u[i]||{},t),u.push(o))}},{"../../lib":681,"../../plots/cartesian/axes":710,"./attributes":614}],616:[function(n,t){"use strict";var i=n("d3"),u=n("../drawing"),r=n("../../plots/cartesian/axes"),f=n("../../constants/xmlns_namespaces");t.exports=function(n){function h(t){var r=i.select(this),u;r.attr("xmlns",f.svg);u=new Promise(function(n){function u(){r.remove();n()}var i=new Image;i.setAttribute("crossOrigin","anonymous");i.onerror=u;i.onload=function(){var n=document.createElement("canvas"),t,i;n.width=this.width;n.height=this.height;t=n.getContext("2d");t.drawImage(this,0,0);i=n.toDataURL("image/png");r.attr("xlink:href",i)};r.on("error",u);r.on("load",n);i.src=t.source});n._promises.push(u)}function c(f){var l=i.select(this),e=r.getFromId(n,f.xref),s=r.getFromId(n,f.yref),h=t._size,a=e?Math.abs(e.l2p(f.sizex)-e.l2p(0)):f.sizex*h.w,v=s?Math.abs(s.l2p(f.sizey)-s.l2p(0)):f.sizey*h.h,p=a*o.x[f.xanchor].offset,w=v*o.y[f.yanchor].offset,c=o.x[f.xanchor].sizing+o.y[f.yanchor].sizing,b=(e?e.l2p(f.x)+e._offset:f.x*h.w+h.l)+p,k=(s?s.l2p(f.y)+s._offset:h.h-f.y*h.h+h.t)+w;switch(f.sizing){case"fill":c+=" slice";break;case"stretch":c="none"}l.attr({x:b,y:k,width:a,height:v,preserveAspectRatio:c,opacity:f.opacity});var d=e?e._id:"",g=s?s._id:"",y=d+g;y&&l.call(u.setClipUrl,"clip"+t._uid+y)}function l(n,t){return n.source+t}var t=n._fullLayout,p=[],w=[],b=[],s,e,o;if(t.images){for(s=0;s<t.images.length;s++)e=t.images[s],e.layer==="below"&&e.xref!=="paper"&&e.yref!=="paper"?w.push(e):e.layer==="above"?p.push(e):b.push(e);o={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};var a=t._imageLowerLayer.selectAll("image").data(b,l),v=t._imageSubplotLayer.selectAll("image").data(w,l),y=t._imageUpperLayer.selectAll("image").data(p,l);a.enter().append("image").each(h);v.enter().append("image").each(h);y.enter().append("image").each(h);a.exit().remove();v.exit().remove();y.exit().remove();a.each(c);v.each(c);y.each(c)}}},{"../../constants/xmlns_namespaces":666,"../../plots/cartesian/axes":710,"../drawing":605,d3:129}],617:[function(n,t){"use strict";var i=n("./draw"),r=n("./defaults"),u=n("./attributes");t.exports={moduleType:"component",name:"images",draw:i,layoutAttributes:u,supplyLayoutDefaults:r}},{"./attributes":614,"./defaults":615,"./draw":616}],618:[function(n,t,i){"use strict";i.isRightAnchor=function(n){return n.xanchor==="right"||n.xanchor==="auto"&&n.x>=2/3};i.isCenterAnchor=function(n){return n.xanchor==="center"||n.xanchor==="auto"&&n.x>1/3&&n.x<2/3};i.isBottomAnchor=function(n){return n.yanchor==="bottom"||n.yanchor==="auto"&&n.y<=1/3};i.isMiddleAnchor=function(n){return n.yanchor==="middle"||n.yanchor==="auto"&&n.y>1/3&&n.y<2/3}},{}],619:[function(n,t){"use strict";var i=n("../../plots/font_attributes"),r=n("../color/attributes"),u=n("../../lib/extend").extendFlat;t.exports={bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:r.defaultLine},borderwidth:{valType:"number",min:0,dflt:0},font:u({},i,{}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"]},tracegroupgap:{valType:"number",min:0,dflt:10},x:{valType:"number",min:-2,max:3,dflt:1.02},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto"}}},{"../../lib/extend":673,"../../plots/font_attributes":729,"../color/attributes":581}],620:[function(n,t){"use strict";t.exports={scrollBarWidth:4,scrollBarHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4}},{}],621:[function(n,t){"use strict";var u=n("../../registry"),i=n("../../lib"),f=n("./attributes"),e=n("../../plots/layout_attributes"),r=n("./helpers");t.exports=function(n,t,o){function s(n,t){return i.coerce(d,a,f,n,t)}for(var h,g,l,d=n.legend||{},a=t.legend={},v=0,c="normal",y,p,w,b,k=0;k<o.length;k++)h=o[k],r.legendGetsTrace(h)&&(v++,u.traceIs(h,"pie")&&v++),(u.traceIs(h,"bar")&&t.barmode==="stack"||["tonextx","tonexty"].indexOf(h.fill)!==-1)&&(c=r.isGrouped({traceorder:c})?"grouped+reversed":"reversed"),h.legendgroup!==undefined&&h.legendgroup!==""&&(c=r.isReversed({traceorder:c})?"reversed+grouped":"grouped");(g=i.coerce(n,t,e,"showlegend",v>1),g!==!1)&&(s("bgcolor",t.paper_bgcolor),s("bordercolor"),s("borderwidth"),i.coerceFont(s,"font",t.font),s("orientation"),a.orientation==="h"&&(l=n.xaxis,l&&l.rangeslider&&l.rangeslider.visible?(y=0,w="left",p=1.1,b="bottom"):(y=0,w="left",p=-.1,b="top")),s("traceorder",c),r.isGrouped(t.legend)&&s("tracegroupgap"),s("x",y),s("xanchor",w),s("y",p),s("yanchor",b),i.noneOrAll(d,a,["x","y"]))}},{"../../lib":681,"../../plots/layout_attributes":760,"../../registry":784,"./attributes":619,"./helpers":624}],622:[function(n,t){"use strict";function k(n,t){function f(i){a.convertToTspans(i,function(){i.selectAll("tspan.line").attr({x:i.attr("x")});n.call(g,t)})}var i=n.data()[0][0],l=t._fullLayout,u=i.trace,s=c.traceIs(u,"pie"),v=u.index,h=s?i.label:u.name,r=n.selectAll("text.legendtext").data([0]);if(r.enter().append("text").classed("legendtext",!0),r.attr({x:40,y:0,"data-unformatted":h}).style("text-anchor","start").classed("user-select-none",!0).call(e.font,l.legend.font).text(h),t._context.editable&&!s)r.call(a.makeEditable).call(f).on("edit",function(n){var e,r,u,s;this.attr({"data-unformatted":n});this.text(n).call(f);this.text()||(n="    ");e=i.trace._fullInput||{};["ohlc","candlestick"].indexOf(e.type)!==-1?(u=i.trace.transforms,s=u[u.length-1].direction,r=s+".legenditem.name"):r="name";o.restyle(t,r,n,v)});else r.call(f)}function d(n,t){var i=t._fullLayout.hiddenlabels?t._fullLayout.hiddenlabels.slice():[],r=n.selectAll("rect").data([0]);r.enter().append("rect").classed("legendtoggle",!0).style("cursor","pointer").attr("pointer-events","all").call(s.fill,"rgba(0,0,0,0)");r.on("click",function(){var s,h,u;if(!t._dragged){var l=n.data()[0][0],a=t._fullData,r=l.trace,v=r.legendgroup,f=[],e,y;if(c.traceIs(r,"pie"))s=l.label,h=i.indexOf(s),h===-1?i.push(s):i.splice(h,1),o.relayout(t,"hiddenlabels",i);else{if(v==="")f=[r.index];else for(u=0;u<a.length;u++)e=a[u],e.legendgroup===v&&f.push(e.index);y=r.visible===!0?"legendonly":!0;o.restyle(t,"visible",y,f)}}})}function g(n,t){var u=n.data()[0][0],f=n.select("g[class*=math-group]"),y=t._fullLayout.legend,l=y.font.size*1.3,r,o,s,c;if(!u.trace.showlegend){n.remove();return}if(f.node())s=e.bBox(f.node()),r=s.height,o=s.width,i.setTranslate(f,0,r/4);else{var h=n.selectAll(".legendtext"),a=n.selectAll(".legendtext>tspan"),v=a[0].length||1;r=l*v;o=h.node()&&e.bBox(h.node()).width;c=l*(.3+(1-v)/2);h.attr("y",c);a.attr("y",c)}r=Math.max(r,16)+3;u.height=r;u.width=o}function y(n,t,r){var h=n._fullLayout,u=h.legend,o=u.borderwidth,a=v.isGrouped(u),y,p,c,k,d,g;if(v.isVertical(u))a&&t.each(function(n,t){i.setTranslate(this,0,t*u.tracegroupgap)}),u.width=0,u.height=0,r.each(function(n){var t=n[0],r=t.height,f=t.width;i.setTranslate(this,o,5+o+u.height+r/2);u.height+=r;u.width=Math.max(u.width,f)}),u.width+=45+o*2,u.height+=10+o*2,a&&(u.height+=(u._lgroupsLength-1)*u.tracegroupgap),u.width=Math.ceil(u.width),u.height=Math.ceil(u.height),r.each(function(t){var i=t[0],r=f.select(this).select(".legendtoggle");r.call(e.setRect,0,-i.height/2,(n._context.editable?0:u.width)+40,i.height)});else if(a){for(u.width=0,u.height=0,y=[u.width],p=t.data(),c=0,k=p.length;c<k;c++)d=p[c].map(function(n){return n[0].width}),g=40+Math.max.apply(null,d),u.width+=u.tracegroupgap+g,y.push(u.width);t.each(function(n,t){i.setTranslate(this,y[t],0)});t.each(function(){var t=f.select(this),r=t.selectAll("g.traces"),n=0;r.each(function(t){var u=t[0],r=u.height;i.setTranslate(this,0,5+o+n+r/2);n+=r});u.height=Math.max(u.height,n)});u.height+=10+o*2;u.width+=o*2;u.width=Math.ceil(u.width);u.height=Math.ceil(u.height);r.each(function(t){var i=t[0],r=f.select(this).select(".legendtoggle");r.call(e.setRect,0,-i.height/2,n._context.editable?0:u.width,i.height)})}else{u.width=0;u.height=0;var w=0,s=0,b=0,l=0;r.each(function(n){b=Math.max(40+n[0].width,b)});r.each(function(n){var t=n[0],r=b,f=u.tracegroupgap||5;o+l+f+r>h.width-(h.margin.r+h.margin.l)&&(l=0,w=w+s,u.height=u.height+s,s=0);i.setTranslate(this,o+l,5+o+t.height/2+w);u.width+=f+r;u.height=Math.max(u.height,t.height);l+=f+r;s=Math.max(t.height,s)});u.width+=o*2;u.height+=10+o*2;u.width=Math.ceil(u.width);u.height=Math.ceil(u.height);r.each(function(t){var i=t[0],r=f.select(this).select(".legendtoggle");r.call(e.setRect,0,-i.height/2,n._context.editable?0:u.width,i.height)})}}function p(n){var f=n._fullLayout,t=f.legend,r="left",i;u.isRightAnchor(t)?r="right":u.isCenterAnchor(t)&&(r="center");i="top";u.isBottomAnchor(t)?i="bottom":u.isMiddleAnchor(t)&&(i="middle");h.autoMargin(n,"legend",{x:t.x,y:t.y,l:t.width*({right:1,center:.5}[r]||0),r:t.width*({left:1,center:.5}[r]||0),b:t.height*({top:1,middle:.5}[i]||0),t:t.height*({bottom:1,middle:.5}[i]||0)})}function nt(n){var r=n._fullLayout,t=r.legend,i="left";u.isRightAnchor(t)?i="right":u.isCenterAnchor(t)&&(i="center");h.autoMargin(n,"legend",{x:t.x,y:.5,l:t.width*({right:1,center:.5}[i]||0),r:t.width*({left:1,center:.5}[i]||0),b:0,t:0})}var f=n("d3"),o=n("../../plotly"),i=n("../../lib"),h=n("../../plots/plots"),c=n("../../registry"),l=n("../dragelement"),e=n("../drawing"),s=n("../color"),a=n("../../lib/svg_text_utils"),r=n("./constants"),w=n("./get_legend_data"),b=n("./style"),v=n("./helpers"),u=n("./anchor_utils");t.exports=function(n){function ti(n,u){it.attr("data-scroll",u).call(i.setTranslate,0,u);vt.call(e.setRect,rt,n,r.scrollBarWidth,r.scrollBarHeight);at.select("rect").attr({y:t.borderwidth-u})}var v=n._fullLayout,lt="legend"+v._uid,g,at,ot,it,vt,ht,ct,bt,rt,dt,tt,gt,yt,pt,st,et,ni,ii,ri,oi,si;if(v._infolayer&&n.calcdata){var t=v.legend,ui=v.showlegend&&w(n.calcdata,t),hi=v.hiddenlabels||[];if(!v.showlegend||!ui.length){v._infolayer.selectAll(".legend").remove();v._topdefs.select("#"+lt).remove();h.autoMargin(n,"legend");return}g=v._infolayer.selectAll("g.legend").data([0]);g.enter().append("g").attr({"class":"legend","pointer-events":"all"});at=v._topdefs.selectAll("#"+lt).data([0]);at.enter().append("clipPath").attr("id",lt).append("rect");ot=g.selectAll("rect.bg").data([0]);ot.enter().append("rect").attr({"class":"bg","shape-rendering":"crispEdges"});ot.call(s.stroke,t.bordercolor);ot.call(s.fill,t.bgcolor);ot.style("stroke-width",t.borderwidth+"px");it=g.selectAll("g.scrollbox").data([0]);it.enter().append("g").attr("class","scrollbox");vt=g.selectAll("rect.scrollbar").data([0]);vt.enter().append("rect").attr({"class":"scrollbar",rx:20,ry:2,width:0,height:0}).call(s.fill,"#808BA4");ht=it.selectAll("g.groups").data(ui);ht.enter().append("g").attr("class","groups");ht.exit().remove();ct=ht.selectAll("g.traces").data(i.identity);ct.enter().append("g").attr("class","traces");ct.exit().remove();ct.call(b).style("opacity",function(n){var t=n[0].trace;return c.traceIs(t,"pie")?hi.indexOf(n[0].label)!==-1?.5:1:t.visible==="legendonly"?.5:1}).each(function(){f.select(this).call(k,n).call(d,n)});bt=g.enter().size()!==0;bt&&(y(n,ht,ct),p(n));var fi=0,kt=v.width,ei=0,wt=v.height;y(n,ht,ct);t.height>wt?nt(n):p(n);var a=v._size,ut=a.l+a.w*t.x,ft=a.t+a.h*(1-t.y);if(u.isRightAnchor(t)?ut-=t.width:u.isCenterAnchor(t)&&(ut-=t.width/2),u.isBottomAnchor(t)?ft-=t.height:u.isMiddleAnchor(t)&&(ft-=t.height/2),rt=t.width,dt=a.w,rt>dt?(ut=a.l,rt=dt):(ut+rt>kt&&(ut=kt-rt),ut<fi&&(ut=fi),rt=Math.min(kt-ut,t.width)),tt=t.height,gt=a.h,tt>gt?(ft=a.t,tt=gt):(ft+tt>wt&&(ft=wt-tt),ft<ei&&(ft=ei),tt=Math.min(wt-ft,t.height)),i.setTranslate(g,ut,ft),yt=tt-r.scrollBarHeight-2*r.scrollBarMargin,pt=t.height-tt,t.height<=tt||n._context.staticPlot)ot.attr({width:rt-t.borderwidth,height:tt-t.borderwidth,x:t.borderwidth/2,y:t.borderwidth/2}),i.setTranslate(it,0,0),at.select("rect").attr({width:rt-2*t.borderwidth,height:tt-2*t.borderwidth,x:t.borderwidth,y:t.borderwidth}),it.call(e.setClipUrl,lt);else{st=r.scrollBarMargin;et=it.attr("data-scroll")||0;ot.attr({width:rt-2*t.borderwidth+r.scrollBarWidth+r.scrollBarMargin,height:tt-t.borderwidth,x:t.borderwidth/2,y:t.borderwidth/2});at.select("rect").attr({width:rt-2*t.borderwidth+r.scrollBarWidth+r.scrollBarMargin,height:tt-2*t.borderwidth,x:t.borderwidth,y:t.borderwidth-et});it.call(e.setClipUrl,lt);bt&&ti(st,et);g.on("wheel",null);g.on("wheel",function(){et=i.constrain(it.attr("data-scroll")-f.event.deltaY/yt*pt,-pt,0);st=r.scrollBarMargin-et/pt*yt;ti(st,et);f.event.preventDefault()});vt.on(".drag",null);it.on(".drag",null);ni=f.behavior.drag().on("drag",function(){st=i.constrain(f.event.y-r.scrollBarHeight/2,r.scrollBarMargin,r.scrollBarMargin+yt);et=-(st-r.scrollBarMargin)/yt*pt;ti(st,et)});vt.call(ni);it.call(ni)}n._context.editable&&(g.classed("cursor-move",!0),l.init({element:g.node(),prepFn:function(){var n=i.getTranslate(g);oi=n.x;si=n.y},moveFn:function(n,r){var u=oi+n,f=si+r;i.setTranslate(g,u,f);ii=l.align(u,0,a.l,a.l+a.w,t.xanchor);ri=l.align(f,0,a.t+a.h,a.t,t.yanchor)},doneFn:function(t){t&&ii!==undefined&&ri!==undefined&&o.relayout(n,{"legend.x":ii,"legend.y":ri})}}))}}},{"../../lib":681,"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/plots":769,"../../registry":784,"../color":582,"../dragelement":603,"../drawing":605,"./anchor_utils":618,"./constants":620,"./get_legend_data":623,"./helpers":624,"./style":626,d3:129}],623:[function(n,t){"use strict";var r=n("../../registry"),i=n("./helpers");t.exports=function(n,t){function k(n,r){if(n!==""&&i.isGrouped(t))e.indexOf(n)===-1?(e.push(n),w=!0,h[n]=[[r]]):h[n].push([r]);else{var u="~~i"+b;e.push(u);h[u]=[[r]];b++}}for(var h={},e=[],w=!1,y={},b=0,o,p,f,a,v,u=0;u<n.length;u++){var c=n[u],d=c[0],l=d.trace,s=l.legendgroup;if(i.legendGetsTrace(l)&&l.showlegend)if(r.traceIs(l,"pie"))for(y[s]||(y[s]={}),o=0;o<c.length;o++)p=c[o].label,y[s][p]||(k(s,{label:p,color:c[o].color,i:c[o].i,trace:l}),y[s][p]=!0);else k(s,d)}if(!e.length)return[];if(f=e.length,w&&i.isGrouped(t))for(v=new Array(f),u=0;u<f;u++)a=h[e[u]],v[u]=i.isReversed(t)?a.reverse():a;else{for(v=[new Array(f)],u=0;u<f;u++)a=h[e[u]][0],v[0][i.isReversed(t)?f-u-1:u]=a;f=1}return t._lgroupsLength=f,v}},{"../../registry":784,"./helpers":624}],624:[function(n,t,i){"use strict";var r=n("../../registry");i.legendGetsTrace=function(n){return n.visible&&r.traceIs(n,"showLegend")};i.isGrouped=function(n){return(n.traceorder||"").indexOf("grouped")!==-1};i.isVertical=function(n){return n.orientation!=="h"};i.isReversed=function(n){return(n.traceorder||"").indexOf("reversed")!==-1}},{"../../registry":784}],625:[function(n,t){"use strict";var i=t.exports={};i.moduleType="component";i.name="legend";i.layoutAttributes=n("./attributes");i.supplyLayoutDefaults=n("./defaults");i.draw=n("./draw");i.style=n("./style")},{"./attributes":619,"./defaults":621,"./draw":622,"./style":626}],626:[function(n,t){"use strict";function h(n){var t=n[0].trace,o=t.visible&&t.fill&&t.fill!=="none",s=e.hasLines(t),f=i.select(this).select(".legendfill").selectAll("path").data(o?[n]:[]),r;f.enter().append("path").classed("js-fill",!0);f.exit().remove();f.attr("d","M5,0h30v6h-30z").call(u.fillGroupStyle);r=i.select(this).select(".legendlines").selectAll("path").data(s?[n]:[]);r.enter().append("path").classed("js-line",!0).attr("d","M5,0h30");r.exit().remove();r.call(u.lineGroupStyle)}function c(n){function f(n,t,i){var u=r.nestedProperty(s,n).get(),f=Array.isArray(u)&&t?t(u):u;if(i){if(f<i[0])return i[0];if(f>i[1])return i[1]}return f}function o(n){return n[0]}var b=n[0],s=b.trace,h=e.hasMarkers(s),y=e.hasText(s),k=e.hasLines(s),c,p,t,l,w,a,v;(h||y||k)&&(t={},l={},h&&(t.mc=f("marker.color",o),t.mo=f("marker.opacity",r.mean,[.2,1]),t.ms=f("marker.size",r.mean,[2,16]),t.mlc=f("marker.line.color",o),t.mlw=f("marker.line.width",r.mean,[0,5]),l.marker={sizeref:1,sizemin:1,sizemode:"diameter"}),k&&(l.line={width:f("line.width",o,[0,10])}),y&&(t.tx="Aa",t.tp=f("textposition",o),t.ts=10,t.tc=f("textfont.color",o),t.tf=f("textfont.family",o)),c=[r.minExtend(b,t)],p=r.minExtend(s,l));w=i.select(this).select("g.legendpoints");a=w.selectAll("path.scatterpts").data(h?c:[]);a.enter().append("path").classed("scatterpts",!0).attr("transform","translate(20,0)");a.exit().remove();a.call(u.pointStyle,p);h&&(c[0].mrc=3);v=w.selectAll("g.pointtext").data(y?c:[]);v.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)");v.exit().remove();v.selectAll("text").call(u.textPointStyle,p)}function l(n){var r=n[0].trace,u=r.marker||{},e=u.line||{},t=i.select(this).select("g.legendpoints").selectAll("path.legendbar").data(o.traceIs(r,"bar")?[n]:[]);t.enter().append("path").classed("legendbar",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");t.exit().remove();t.each(function(n){var t=(n.mlw+1||e.width+1)-1,r=i.select(this);r.style("stroke-width",t+"px").call(f.fill,n.mc||u.color);t&&r.call(f.stroke,n.mlc||e.color)})}function a(n){var t=n[0].trace,r=i.select(this).select("g.legendpoints").selectAll("path.legendbox").data(o.traceIs(t,"box")&&t.visible?[n]:[]);r.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();r.each(function(n){var r=(n.lw+1||t.line.width+1)-1,u=i.select(this);u.style("stroke-width",r+"px").call(f.fill,n.fc||t.fillcolor);r&&u.call(f.stroke,n.lc||t.line.color)})}function v(n){var r=n[0].trace,t=i.select(this).select("g.legendpoints").selectAll("path.legendpie").data(o.traceIs(r,"pie")&&r.visible?[n]:[]);t.enter().append("path").classed("legendpie",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");t.exit().remove();t.size()&&t.call(s,n[0],r)}var i=n("d3"),o=n("../../registry"),r=n("../../lib"),u=n("../drawing"),f=n("../color"),e=n("../../traces/scatter/subtypes"),s=n("../../traces/pie/style_one");t.exports=function(n){n.each(function(n){var r=i.select(this),f=r.selectAll("g.legendfill").data([n]),u,t;f.enter().append("g").classed("legendfill",!0);u=r.selectAll("g.legendlines").data([n]);u.enter().append("g").classed("legendlines",!0);t=r.selectAll("g.legendsymbols").data([n]);t.enter().append("g").classed("legendsymbols",!0);t.style("opacity",n[0].trace.opacity);t.selectAll("g.legendpoints").data([n]).enter().append("g").classed("legendpoints",!0)}).each(l).each(a).each(v).each(h).each(c)}},{"../../lib":681,"../../registry":784,"../../traces/pie/style_one":883,"../../traces/scatter/subtypes":909,"../color":582,"../drawing":605,d3:129}],627:[function(n,t){"use strict";function u(n,t){var h=t.currentTarget,c=h.getAttribute("data-attr"),i=h.getAttribute("data-val")||!0,b=n._fullLayout,r={},s,l,e;if(c==="zoom"){var a=i==="in"?.5:2,y=(1+a)/2,p=(1-a)/2,w=v.list(n,null,!0),f,u;for(s=0;s<w.length;s++)f=w[s],f.fixedrange||(u=f._name,i==="auto"?r[u+".autorange"]=!0:i==="reset"?f._rangeInitial===undefined?r[u+".autorange"]=!0:(l=f._rangeInitial.slice(),r[u+".range[0]"]=l[0],r[u+".range[1]"]=l[1]):(e=f.range,r[u+".range[0]"]=y*e[0]+p*e[1],r[u+".range[1]"]=y*e[1]+p*e[0]))}else c==="hovermode"&&(i==="x"||i==="y")&&(i=b._isHoriz?"y":"x",h.setAttribute("data-val",i)),r[c]=i;o.relayout(n,r)}function s(n,t){for(var r=t.currentTarget,s=r.getAttribute("data-attr"),h=r.getAttribute("data-val")||!0,c=n._fullLayout,u=e.getSubplotIds(c,"gl3d"),f={},l=s.split("."),i=0;i<u.length;i++)f[u[i]+"."+l[1]]=h;o.relayout(n,f)}function c(n,t){for(var h=t.currentTarget,r=h.getAttribute("data-attr"),u=n._fullLayout,f=e.getSubplotIds(u,"gl3d"),i=0;i<f.length;i++){var c=f[i],o=u[c],s=o._scene;r==="resetDefault"?s.setCameraToDefault():r==="resetLastSave"&&s.setCamera(o.camera)}}function a(n,t){var h=t.currentTarget,v=h._previousVal||!1,nt=n.layout,y=n._fullLayout,p=e.getSubplotIds(y,"gl3d"),tt=["xaxis","yaxis","zaxis"],w=["showspikes","spikesides","spikethickness","spikecolor"],b={},k={},i={},r,u,l,s,a;if(v)i=f.extendDeep(nt,v),h._previousVal=null;else{for(i={"allaxes.showspikes":!1},r=0;r<p.length;r++){var c=p[r],d=y[c],g=b[c]={};for(g.hovermode=d.hovermode,i[c+".hovermode"]=!1,u=0;u<3;u++)for(l=tt[u],k=g[l]={},s=0;s<w.length;s++)a=w[s],k[a]=d[l][a]}h._previousVal=f.extendDeep({},b)}o.relayout(n,i)}function l(n,t){for(var i,u,f,o=t.currentTarget,s=o.getAttribute("data-attr"),l=o.getAttribute("data-val")||!0,h=n._fullLayout,c=e.getSubplotIds(h,"geo"),r=0;r<c.length;r++)i=h[c[r]]._subplot,s==="zoom"?(u=i.projection.scale(),f=l==="in"?2*u:.5*u,i.projection.scale(f),i.zoom.scale(f),i.render()):s==="reset"&&i.zoomReset()}function h(n){var t=n._fullLayout,i,r;i=t._has("cartesian")?t._isHoriz?"y":"x":"closest";r=n._fullLayout.hovermode?!1:i;o.relayout(n,"hovermode",r)}var o=n("../../plotly"),e=n("../../plots/plots"),v=n("../../plots/cartesian/axes"),f=n("../../lib"),y=n("../../snapshot/download"),i=n("../../../build/ploticon"),r=t.exports={};r.toImage={name:"toImage",title:"Download plot as a png",icon:i.camera,click:function(n){var t="png";f.notifier("Taking snapshot - this may take a few seconds","long");f.isIE()&&(f.notifier("IE only supports svg.  Changing format to svg.","long"),t="svg");y(n,{format:t}).then(function(n){f.notifier("Snapshot succeeded - "+n,"long")}).catch(function(){f.notifier("Sorry there was a problem downloading your snapshot!","long")})}};r.sendDataToCloud={name:"sendDataToCloud",title:"Save and edit plot in cloud",icon:i.disk,click:function(n){e.sendDataToCloud(n)}};r.zoom2d={name:"zoom2d",title:"Zoom",attr:"dragmode",val:"zoom",icon:i.zoombox,click:u};r.pan2d={name:"pan2d",title:"Pan",attr:"dragmode",val:"pan",icon:i.pan,click:u};r.select2d={name:"select2d",title:"Box Select",attr:"dragmode",val:"select",icon:i.selectbox,click:u};r.lasso2d={name:"lasso2d",title:"Lasso Select",attr:"dragmode",val:"lasso",icon:i.lasso,click:u};r.zoomIn2d={name:"zoomIn2d",title:"Zoom in",attr:"zoom",val:"in",icon:i.zoom_plus,click:u};r.zoomOut2d={name:"zoomOut2d",title:"Zoom out",attr:"zoom",val:"out",icon:i.zoom_minus,click:u};r.autoScale2d={name:"autoScale2d",title:"Autoscale",attr:"zoom",val:"auto",icon:i.autoscale,click:u};r.resetScale2d={name:"resetScale2d",title:"Reset axes",attr:"zoom",val:"reset",icon:i.home,click:u};r.hoverClosestCartesian={name:"hoverClosestCartesian",title:"Show closest data on hover",attr:"hovermode",val:"closest",icon:i.tooltip_basic,gravity:"ne",click:u};r.hoverCompareCartesian={name:"hoverCompareCartesian",title:"Compare data on hover",attr:"hovermode",val:function(n){return n._fullLayout._isHoriz?"y":"x"},icon:i.tooltip_compare,gravity:"ne",click:u};r.zoom3d={name:"zoom3d",title:"Zoom",attr:"scene.dragmode",val:"zoom",icon:i.zoombox,click:s};r.pan3d={name:"pan3d",title:"Pan",attr:"scene.dragmode",val:"pan",icon:i.pan,click:s};r.orbitRotation={name:"orbitRotation",title:"orbital rotation",attr:"scene.dragmode",val:"orbit",icon:i["3d_rotate"],click:s};r.tableRotation={name:"tableRotation",title:"turntable rotation",attr:"scene.dragmode",val:"turntable",icon:i["z-axis"],click:s};r.resetCameraDefault3d={name:"resetCameraDefault3d",title:"Reset camera to default",attr:"resetDefault",icon:i.home,click:c};r.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:"Reset camera to last save",attr:"resetLastSave",icon:i.movie,click:c};r.hoverClosest3d={name:"hoverClosest3d",title:"Toggle show closest data on hover",attr:"hovermode",val:null,toggle:!0,icon:i.tooltip_basic,gravity:"ne",click:a};r.zoomInGeo={name:"zoomInGeo",title:"Zoom in",attr:"zoom",val:"in",icon:i.zoom_plus,click:l};r.zoomOutGeo={name:"zoomOutGeo",title:"Zoom out",attr:"zoom",val:"out",icon:i.zoom_minus,click:l};r.resetGeo={name:"resetGeo",title:"Reset",attr:"reset",val:null,icon:i.autoscale,click:l};r.hoverClosestGeo={name:"hoverClosestGeo",title:"Toggle show closest data on hover",attr:"hovermode",val:null,toggle:!0,icon:i.tooltip_basic,gravity:"ne",click:h};r.hoverClosestGl2d={name:"hoverClosestGl2d",title:"Toggle show closest data on hover",attr:"hovermode",val:null,toggle:!0,icon:i.tooltip_basic,gravity:"ne",click:h};r.hoverClosestPie={name:"hoverClosestPie",title:"Toggle show closest data on hover",attr:"hovermode",val:"closest",icon:i.tooltip_basic,gravity:"ne",click:h};r.toggleHover={name:"toggleHover",title:"Toggle show closest data on hover",attr:"hovermode",val:null,toggle:!0,icon:i.tooltip_basic,gravity:"ne",click:function(n,t){h(n);a(n,t)}};r.resetViews={name:"resetViews",title:"Reset views",icon:i.home,click:function(n,t){var i=t.currentTarget;i.setAttribute("data-attr","zoom");i.setAttribute("data-val","reset");u(n,t);i.setAttribute("data-attr","resetLastSave");c(n,t)}}},{"../../../build/ploticon":2,"../../lib":681,"../../plotly":706,"../../plots/cartesian/axes":710,"../../plots/plots":769,"../../snapshot/download":786}],628:[function(n,t,i){"use strict";i.manage=n("./manage")},{"./manage":629}],629:[function(n,t){"use strict";function o(n,t,r){function f(n){for(var u,f=[],r=0;r<n.length;r++)(u=n[r],t.indexOf(u)===-1)&&f.push(i[u]);y.push(f)}var e=n._fullLayout,k=n._fullData,o=e._has("cartesian"),w=e._has("gl3d"),b=e._has("geo"),v=e._has("pie"),l=e._has("gl2d"),a=e._has("ternary"),y=[],p,c;return(f(["toImage","sendDataToCloud"]),(o||l||v||a)+b+w>1)?(f(["resetViews","toggleHover"]),u(y,r)):(w&&(f(["zoom3d","pan3d","orbitRotation","tableRotation"]),f(["resetCameraDefault3d","resetCameraLastSave3d"]),f(["hoverClosest3d"])),b&&(f(["zoomInGeo","zoomOutGeo","resetGeo"]),f(["hoverClosestGeo"])),p=s(e),c=[],((o||l)&&!p||a)&&(c=["zoom2d","pan2d"]),(o||a)&&h(k)&&(c.push("select2d"),c.push("lasso2d")),c.length&&f(c),!(o||l)||p||a||f(["zoomIn2d","zoomOut2d","autoScale2d","resetScale2d"]),o&&v?f(["toggleHover"]):l?f(["hoverClosestGl2d"]):o?f(["hoverClosestCartesian","hoverCompareCartesian"]):v&&f(["hoverClosestPie"]),u(y,r))}function s(n){for(var i=f.list({_fullLayout:n},null,!0),r=!0,t=0;t<i.length;t++)if(!i[t].fixedrange){r=!1;break}return r}function h(n){for(var t,i=!1,u=0;u<n.length;u++){if(i)break;(t=n[u],t._module&&t._module.selectPoints)&&(t.type==="scatter"||t.type==="scatterternary"?(r.hasMarkers(t)||r.hasText(t))&&(i=!0):i=!0)}return i}function u(n,t){if(t.length)if(Array.isArray(t[0]))for(var i=0;i<t.length;i++)n.push(t[i]);else n.push(t);return n}function c(n){for(var f,r,u,t=0;t<n.length;t++)for(f=n[t],r=0;r<f.length;r++)if(u=f[r],typeof u=="string")if(i[u]!==undefined)n[t][r]=i[u];else throw new Error("*modeBarButtons* configuration options invalid button name");return n}var f=n("../../plots/cartesian/axes"),r=n("../../traces/scatter/subtypes"),e=n("./modebar"),i=n("./buttons");t.exports=function(n){var u=n._fullLayout,t=n._context,i=u._modeBar,r,f;if(!t.displayModeBar){i&&(i.destroy(),delete u._modeBar);return}if(!Array.isArray(t.modeBarButtonsToRemove))throw new Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(t.modeBarButtonsToAdd))throw new Error("*modeBarButtonsToAdd* configuration options must be an array.");r=t.modeBarButtons;f=Array.isArray(r)&&r.length?c(r):o(n,t.modeBarButtonsToRemove,t.modeBarButtonsToAdd);i?i.update(n,f):u._modeBar=e(n,f)}},{"../../plots/cartesian/axes":710,"../../traces/scatter/subtypes":909,"./buttons":627,"./modebar":630}],630:[function(n,t){"use strict";function e(n){this.container=n.container;this.element=document.createElement("div");this.update(n.graphInfo,n.buttons);this.container.appendChild(this.element)}function o(n,t){var i=n._fullLayout,u=new e({graphInfo:n,container:i._paperdiv.node(),buttons:t});return i._privateplot&&r.select(u.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),u}var r=n("d3"),u=n("../../lib"),f=n("../../../build/ploticon"),i=e.prototype;i.update=function(n,t){var i,r,u;this.graphInfo=n;i=this.graphInfo._context;this.element.className=i.displayModeBar==="hover"?"modebar modebar--hover":"modebar";r=!this.hasButtons(t);u=this.hasLogo!==i.displaylogo;(r||u)&&(this.removeAllButtons(),this.updateButtons(t),i.displaylogo&&(this.element.appendChild(this.getLogo()),this.hasLogo=!0));this.updateActiveButton()};i.updateButtons=function(n){var t=this;this.buttons=n;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach(function(n){var i=t.createGroup();n.forEach(function(n){var r=n.name,u;if(!r)throw new Error("must provide button 'name' in button config");if(t.buttonsNames.indexOf(r)!==-1)throw new Error("button name '"+r+"' is taken");t.buttonsNames.push(r);u=t.createButton(n);t.buttonElements.push(u);i.appendChild(u)});t.element.appendChild(i)})};i.createGroup=function(){var n=document.createElement("div");return n.className="modebar-group",n};i.createButton=function(n){var u=this,t=document.createElement("a"),i,r,e;if(t.setAttribute("rel","tooltip"),t.className="modebar-btn",i=n.title,i===undefined&&(i=n.name),(i||i===0)&&t.setAttribute("data-title",i),n.attr!==undefined&&t.setAttribute("data-attr",n.attr),r=n.val,r!==undefined&&(typeof r=="function"&&(r=r(this.graphInfo)),t.setAttribute("data-val",r)),e=n.click,typeof e!="function")throw new Error("must provide button 'click' function in button config");else t.addEventListener("click",function(t){n.click(u.graphInfo,t);u.updateActiveButton(t.currentTarget)});return t.setAttribute("data-toggle",n.toggle||!1),n.toggle&&t.classList.add("active"),t.appendChild(this.createIcon(n.icon||f.question)),t.setAttribute("data-gravity",n.gravity||"n"),t};i.createIcon=function(n){var r=n.ascent-n.descent,u="http://www.w3.org/2000/svg",t=document.createElementNS(u,"svg"),i=document.createElementNS(u,"path");return t.setAttribute("height","1em"),t.setAttribute("width",n.width/r+"em"),t.setAttribute("viewBox",[0,0,n.width,r].join(" ")),i.setAttribute("d",n.path),i.setAttribute("transform","matrix(1 0 0 -1 0 "+n.ascent+")"),t.appendChild(i),t};i.updateActiveButton=function(n){var t=this.graphInfo._fullLayout,i=n!==undefined?n.getAttribute("data-attr"):null;this.buttonElements.forEach(function(n){var s=n.getAttribute("data-val")||!0,f=n.getAttribute("data-attr"),h=n.getAttribute("data-toggle")==="true",e=r.select(n),o;h?f===i&&e.classed("active",!e.classed("active")):(o=f===null?f:u.nestedProperty(t,f).get(),e.classed("active",o===s))})};i.hasButtons=function(n){var r=this.buttons,t,i;if(!r||n.length!==r.length)return!1;for(t=0;t<n.length;++t){if(n[t].length!==r[t].length)return!1;for(i=0;i<n[t].length;i++)if(n[t][i].name!==r[t][i].name)return!1}return!0};i.getLogo=function(){var t=this.createGroup(),n=document.createElement("a");return n.href="https://plot.ly/",n.target="_blank",n.setAttribute("data-title","Produced with Plotly"),n.className="modebar-btn plotlyjsicon modebar-btn--logo",n.appendChild(this.createIcon(f.plotlylogo)),t.appendChild(n),t};i.removeAllButtons=function(){while(this.element.firstChild)this.element.removeChild(this.element.firstChild);this.hasLogo=!1};i.destroy=function(){u.removeElement(this.container.querySelector(".modebar"))};t.exports=o},{"../../../build/ploticon":2,"../../lib":681,d3:129}],631:[function(n,t){"use strict";var f=n("../../plots/font_attributes"),r=n("../color/attributes"),u=n("../../lib/extend").extendFlat,i=n("./button_attributes");i=u(i,{_isLinkedToArray:!0});t.exports={visible:{valType:"boolean"},buttons:i,x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom"},font:u({},f,{}),bgcolor:{valType:"color",dflt:r.lightLine},activecolor:{valType:"color"},bordercolor:{valType:"color",dflt:r.defaultLine},borderwidth:{valType:"number",min:0,dflt:0}}},{"../../lib/extend":673,"../../plots/font_attributes":729,"../color/attributes":581,"./button_attributes":632}],632:[function(n,t){"use strict";t.exports={step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward"},count:{valType:"number",min:0,dflt:1},label:{valType:"string"}}},{}],633:[function(n,t){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],634:[function(n,t){"use strict";function o(n,t){function u(n,t){return i.coerce(o,r,e,n,t)}for(var c,s=n.buttons||[],h=t.buttons=[],o,r,f=0;f<s.length;f++)(o=s[f],r={},i.isPlainObject(o))&&(c=u("step"),c!=="all"&&(u("stepmode"),u("count")),u("label"),r._index=f,h.push(r));return h}function s(n,t,i){for(var e,o=i.filter(function(i){return t[i].anchor===n._id}),u=0,f=0;f<o.length;f++)e=t[o[f]].domain,e&&(u=Math.max(e[1],u));return[n.domain[0],u+r.yPad]}var i=n("../../lib"),u=n("../color"),f=n("./attributes"),e=n("./button_attributes"),r=n("./constants");t.exports=function(n,t,e,h){function c(n,t){return i.coerce(a,v,f,n,t)}var a=n.rangeselector||{},v=t.rangeselector={},p=o(a,v),w=c("visible",p.length>0),l,y;w&&(l=s(t,e,h),c("x",l[0]),c("y",l[1]),i.noneOrAll(n,t,["x","y"]),c("xanchor"),c("yanchor"),i.coerceFont(c,"font",e.font),y=c("bgcolor"),c("activecolor",u.contrast(y,r.lightAmount,r.darkAmount)),c("bordercolor"),c("borderwidth"))}},{"../../lib":681,"../color":582,"./attributes":631,"./button_attributes":632,"./constants":633}],635:[function(n,t){"use strict";function v(n){for(var t,r=l.list(n,"x",!0),u=[],i=0;i<r.length;i++)t=r[i],t.rangeselector&&t.rangeselector.visible&&u.push(t);return u}function y(n){return n._id}function p(n,t,i){if(t.step==="all")return n.autorange===!0;var r=Object.keys(i);return n.range[0]===i[r[0]]&&n.range[1]===i[r[1]]}function f(n,t,i){var r=n.selectAll("rect").data([0]);r.enter().append("rect").classed("selector-rect",!0);r.attr("shape-rendering","crispEdges");r.attr({rx:u.rx,ry:u.ry});r.call(e.stroke,t.bordercolor).call(e.fill,w(t,i)).style("stroke-width",t.borderwidth+"px")}function w(n,t){return t.isActive||t.isHovered?n.activecolor:n.bgcolor}function b(n,t,i){function u(n){c.convertToTspans(n)}var r=n.selectAll("text").data([0]);r.enter().append("text").classed("selector-text",!0).classed("user-select-none",!0);r.attr("text-anchor","middle");r.call(o.font,t.font).text(k(i)).call(u)}function k(n){return n.label?n.label:n.step==="all"?"all":n.count+n.step.charAt(0)}function d(n,t,f,e){var a,s,c,l;f.width=0;f.height=0;a=f.borderwidth;t.each(function(){var n=i.select(this),t=n.select(".selector-text"),r=t.selectAll("tspan"),u=f.font.size*1.3,e=r[0].length||1,o=Math.max(u*e,16)+3;f.height=Math.max(f.height,o)});t.each(function(){var t=i.select(this),h=t.select(".selector-rect"),n=t.select(".selector-text"),s=n.selectAll("tspan"),c=n.node()&&o.bBox(n.node()).width,l=f.font.size*1.3,v=s[0].length||1,r=Math.max(c+10,u.minButtonWidth),e;t.attr("transform","translate("+(a+f.width)+","+a+")");h.attr({x:0,y:0,width:r,height:f.height});e={x:r/2,y:f.height/2-(v-1)*l/2+3};n.attr(e);s.attr(e);f.width+=r+5});t.selectAll("rect").attr("height",f.height);s=n._fullLayout._size;f.lx=s.l+s.w*f.x;f.ly=s.t+s.h*(1-f.y);c="left";r.isRightAnchor(f)&&(f.lx-=f.width,c="right");r.isCenterAnchor(f)&&(f.lx-=f.width/2,c="center");l="top";r.isBottomAnchor(f)&&(f.ly-=f.height,l="bottom");r.isMiddleAnchor(f)&&(f.ly-=f.height/2,l="middle");f.width=Math.ceil(f.width);f.height=Math.ceil(f.height);f.lx=Math.round(f.lx);f.ly=Math.round(f.ly);h.autoMargin(n,e+"-range-selector",{x:f.x,y:f.y,l:f.width*({right:1,center:.5}[c]||0),r:f.width*({left:1,center:.5}[c]||0),b:f.height*({top:1,middle:.5}[l]||0),t:f.height*({bottom:1,middle:.5}[l]||0)})}var i=n("d3"),s=n("../../plotly"),h=n("../../plots/plots"),e=n("../color"),o=n("../drawing"),c=n("../../lib/svg_text_utils"),l=n("../../plots/cartesian/axis_ids"),r=n("../legend/anchor_utils"),u=n("./constants"),a=n("./get_update_object");t.exports=function(n){var r=n._fullLayout,t=r._infolayer.selectAll(".rangeselector").data(v(n),y);t.enter().append("g").classed("rangeselector",!0);t.exit().remove();t.style({cursor:"pointer","pointer-events":"all"});t.each(function(t){var o=i.select(this),u=t,r=u.rangeselector,e=o.selectAll("g.button").data(r.buttons);e.enter().append("g").classed("button",!0);e.exit().remove();e.each(function(t){var e=i.select(this),o=a(u,t);t.isActive=p(u,t,o);e.call(f,r,t);e.call(b,r,t);e.on("click",function(){n._dragged||s.relayout(n,o)});e.on("mouseover",function(){t.isHovered=!0;e.call(f,r,t)});e.on("mouseout",function(){t.isHovered=!1;e.call(f,r,t)})});d(n,e,r,u._name);o.attr("transform","translate("+r.lx+","+r.ly+")")})}},{"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/cartesian/axis_ids":712,"../../plots/plots":769,"../color":582,"../drawing":605,"../legend/anchor_utils":618,"./constants":633,"./get_update_object":636,d3:129}],636:[function(n,t){"use strict";function r(n,t){var f=n.range,e=new Date(f[1]),r=t.step,o=t.count,u,s,h;switch(t.stepmode){case"backward":u=i.time[r].offset(e,-o).getTime();break;case"todate":s=i.time[r].offset(e,-(o-1));u=i.time[r].floor(s).getTime()}return h=f[1],[u,h]}var i=n("d3");t.exports=function(n,t){var u=n._name,i={},f;return t.step==="all"?i[u+".autorange"]=!0:(f=r(n,t),i[u+".range[0]"]=f[0],i[u+".range[1]"]=f[1]),i}},{d3:129}],637:[function(n,t,i){"use strict";i.moduleType="component";i.name="rangeselector";i.layoutAttributes=n("./attributes");i.handleDefaults=n("./defaults");i.draw=n("./draw")},{"./attributes":631,"./defaults":634,"./draw":635}],638:[function(n,t){"use strict";var i=n("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:i.background},bordercolor:{valType:"color",dflt:i.defaultLine},borderwidth:{valType:"integer",dflt:0,min:0},range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},thickness:{valType:"number",dflt:.15,min:0,max:1},visible:{valType:"boolean",dflt:!0}}},{"../color/attributes":581}],639:[function(n,t){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskColor:"rgba(0,0,0,0.4)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,grabAreaMinOffset:-6,grabAreaMaxOffset:-2,handleWidth:2,handleRadius:1,handleFill:"#fff",handleStroke:"#666"}},{}],640:[function(n,t){"use strict";var i=n("../../lib"),r=n("./attributes");t.exports=function(n,t,u,f){function o(n,t){return i.coerce(h,e,r,n,t)}var h,e,s,c;n[u].rangeslider&&(i.isPlainObject(n[u].rangeslider)||(n[u].rangeslider={}),h=n[u].rangeslider,e=t[u].rangeslider={},o("bgcolor",t.plot_bgcolor),o("bordercolor"),o("borderwidth"),o("thickness"),o("visible"),o("range"),e.range&&!t[u].autorange?(s=e.range,c=t[u].range,s[0]=Math.min(s[0],c[0]),s[1]=Math.max(s[1],c[1])):t[u]._needsExpand=!0,e.visible&&f.forEach(function(n){var i=t[n]||{};i.fixedrange=!0;t[n]=i}),e._input=h)}},{"../../lib":681,"./attributes":638}],641:[function(n,t){"use strict";function v(n){return n.xaxis?n.xaxis[i.name]?n.xaxis[i.name].visible?n._has("gl2d")?[]:[n.xaxis]:[]:[]:[]}function y(n,t,f,e){var o=n.select("rect."+i.slideBoxClassName).node(),s=n.select("rect."+i.grabAreaMinClassName).node(),h=n.select("rect."+i.grabAreaMaxClassName).node();n.on("mousedown",function(){function k(u){var k=+u.clientX-w,l,y,d,nt;switch(g){case o:d="ew-resize";l=c+k;y=v+k;break;case s:d="col-resize";l=c+k;y=v;break;case h:d="col-resize";l=c;y=v+k;break;default:d="ew-resize";l=b;y=b+k}y<l&&(nt=y,y=l,l=nt);e._pixelMin=l;e._pixelMax=y;a(r.select(i),d);p(n,t,f,e)}function d(){i.removeEventListener("mousemove",k);i.removeEventListener("mouseup",d);u.removeElement(i)}var y=r.event,g=y.target,w=y.clientX,b=w-n.node().getBoundingClientRect().left,c=e.d2p(f.range[0]),v=e.d2p(f.range[1]),i=l.coverSlip();i.addEventListener("mousemove",k);i.addEventListener("mouseup",d)})}function p(n,t,i,r){function f(n){return u.constrain(n,r.range[0],r.range[1])}var e=f(r.p2d(r._pixelMin)),s=f(r.p2d(r._pixelMax));window.requestAnimationFrame(function(){o.relayout(t,"xaxis.range",[e,s])})}function w(n,t,r,f){function s(n){return u.constrain(n,0,f._width)}var e=s(f.d2p(r.range[0])),o=s(f.d2p(r.range[1]));n.select("rect."+i.slideBoxClassName).attr("x",e).attr("width",o-e);n.select("rect."+i.maskMinClassName).attr("width",e);n.select("rect."+i.maskMaxClassName).attr("x",o).attr("width",f._width-o);n.select("g."+i.grabberMinClassName).attr("transform","translate("+(e-i.handleWidth-1)+",0)");n.select("g."+i.grabberMaxClassName).attr("transform","translate("+o+",0)")}function b(n,t,r,u){var o=n.selectAll("rect."+i.bgClassName).data([0]),f,e;o.enter().append("rect").classed(i.bgClassName,!0).attr({x:0,y:0,"shape-rendering":"crispEdges"});f=u.borderwidth%2==0?u.borderwidth:u.borderwidth-1;e=-u._offsetShift;o.attr({width:u._width+f,height:u._height+f,transform:"translate("+e+","+e+")",fill:u.bgcolor,stroke:u.bordercolor,"stroke-width":u.borderwidth})}function k(n,t,i,r){var f=t._fullLayout,u=f._topdefs.selectAll("#"+r._clipId).data([0]);u.enter().append("clipPath").attr("id",r._clipId).append("rect").attr({x:0,y:0});u.select("rect").attr({width:r._width,height:r._height})}function d(n,t,o,l){var y=e.getSubplots(t,o),p=t.calcdata,a=n.selectAll("g."+i.rangePlotClassName).data(y,u.identity),v;a.enter().append("g").attr("class",function(n){return i.rangePlotClassName+" "+n}).call(s.setClipUrl,l._clipId);a.order();a.exit().remove();a.each(function(n,i){var w=r.select(this),s=i===0,a=e.getFromId(t,n,"y"),y=a._name,o={data:[],layout:{xaxis:{domain:[0,1],range:l.range.slice()},width:l._width,height:l._height,margin:{t:0,b:0,l:0,r:0}}};o.layout[y]={domain:[0,1],range:a.range.slice()};f.supplyDefaults(o);var b=o._fullLayout.xaxis,k=o._fullLayout[y],u={id:n,plotgroup:w,xaxis:b,yaxis:k};s?v=u:(u.mainplot="xy",u.mainplotinfo=v);c.rangePlot(t,u,g(p,n));s&&u.bg.call(h.fill,l.bgcolor)})}function g(n,t){for(var r,u,f=[],i=0;i<n.length;i++)r=n[i],u=r[0].trace,u.xaxis+u.yaxis===t&&f.push(r);return f}function nt(n,t,r,u){var e=n.selectAll("rect."+i.maskMinClassName).data([0]),f;e.enter().append("rect").classed(i.maskMinClassName,!0).attr({x:0,y:0});e.attr({height:u._height,fill:i.maskColor});f=n.selectAll("rect."+i.maskMaxClassName).data([0]);f.enter().append("rect").classed(i.maskMaxClassName,!0).attr("y",0);f.attr({height:u._height,fill:i.maskColor})}function tt(n,t,r,u){var f=n.selectAll("rect."+i.slideBoxClassName).data([0]);f.enter().append("rect").classed(i.slideBoxClassName,!0).attr("y",0).attr("cursor",i.slideBoxCursor);f.attr({height:u._height,fill:i.slideBoxFill})}function it(n,t,r,u){var e=n.selectAll("g."+i.grabberMinClassName).data([0]),f,o,s,h,c;e.enter().append("g").classed(i.grabberMinClassName,!0);f=n.selectAll("g."+i.grabberMaxClassName).data([0]);f.enter().append("g").classed(i.grabberMaxClassName,!0);var l={x:0,width:i.handleWidth,rx:i.handleRadius,fill:i.handleFill,stroke:i.handleStroke,"shape-rendering":"crispEdges"},a={y:u._height/4,height:u._height/2},v=e.selectAll("rect."+i.handleMinClassName).data([0]);v.enter().append("rect").classed(i.handleMinClassName,!0).attr(l);v.attr(a);o=f.selectAll("rect."+i.handleMaxClassName).data([0]);o.enter().append("rect").classed(i.handleMaxClassName,!0).attr(l);o.attr(a);s={width:i.grabAreaWidth,y:0,fill:i.grabAreaFill,cursor:i.grabAreaCursor};h=e.selectAll("rect."+i.grabAreaMinClassName).data([0]);h.enter().append("rect").classed(i.grabAreaMinClassName,!0).attr(s);h.attr({x:i.grabAreaMinOffset,height:u._height});c=f.selectAll("rect."+i.grabAreaMaxClassName).data([0]);c.enter().append("rect").classed(i.grabAreaMaxClassName,!0).attr(s);c.attr({x:i.grabAreaMaxOffset,height:u._height})}function rt(n){for(var r,e=n._fullLayout._pushmargin||{},u=Object.keys(e),t=0;t<u.length;t++)r=u[t],r.indexOf(i.name)!==-1&&f.autoMargin(n,r)}var r=n("d3"),o=n("../../plotly"),f=n("../../plots/plots"),u=n("../../lib"),s=n("../drawing"),h=n("../color"),c=n("../../plots/cartesian"),e=n("../../plots/cartesian/axes"),l=n("../dragelement"),a=n("../../lib/setcursor"),i=n("./constants");t.exports=function(n){function s(n){return n._name}var t=n._fullLayout,o=v(t),u=t._infolayer.selectAll("g."+i.containerClassName).data(o,s);(u.enter().append("g").classed(i.containerClassName,!0).attr("pointer-events","all"),u.exit().each(function(n){var u=r.select(this),f=n[i.name];u.remove();t._topdefs.select("#"+f._clipId).remove()}),u.exit().size()&&rt(n),o.length!==0)&&u.each(function(u){var s=r.select(this),o=u[i.name],v,p,rt;o.range||(o._input.range=o.range=e.getAutoRange(u));var h=t.margin,a=t._size,c=u.domain;o._id=i.name+u._id;o._clipId=o._id+"-"+t._uid;o._width=a.w*(c[1]-c[0]);o._height=(t.height-h.b-h.t)*o.thickness;o._offsetShift=Math.floor(o.borderwidth/2);v=h.l+a.w*c[0];p=t.height-o._height-h.b;s.attr("transform","translate("+v+","+p+")");s.call(b,n,u,o).call(k,n,u,o).call(d,n,u,o).call(nt,n,u,o).call(tt,n,u,o).call(it,n,u,o);var l=o.range[0],ut=o.range[1],g=ut-l;o.p2d=function(n){return n/o._width*g+l};o.d2p=function(n){return(n-l)/g*o._width};y(s,n,u,o);w(s,n,u,o);rt=u._boundingBox?u._boundingBox.height:0;f.autoMargin(n,o._id,{x:0,y:0,l:0,r:0,t:0,b:o._height+t.margin.b+rt,pad:15+o._offsetShift*2})})}},{"../../lib":681,"../../lib/setcursor":691,"../../plotly":706,"../../plots/cartesian":718,"../../plots/cartesian/axes":710,"../../plots/plots":769,"../color":582,"../dragelement":603,"../drawing":605,"./constants":639,d3:129}],642:[function(n,t){"use strict";t.exports={moduleType:"component",name:"rangeslider",layoutAttributes:n("./attributes"),handleDefaults:n("./defaults"),draw:n("./draw")}},{"./attributes":638,"./defaults":640,"./draw":641}],643:[function(n,t){"use strict";var r=n("../annotations/attributes"),f=n("../../traces/scatter/attributes"),u=n("../../lib/extend").extendFlat,i=f.line;t.exports={_isLinkedToArray:!0,type:{valType:"enumerated",values:["circle","rect","path","line"]},layer:{valType:"enumerated",values:["below","above"],dflt:"above"},xref:u({},r.xref,{}),x0:{valType:"any"},x1:{valType:"any"},yref:u({},r.yref,{}),y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string"},opacity:{valType:"number",min:0,max:1,dflt:1},line:{color:i.color,width:i.width,dash:i.dash},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)"}}},{"../../lib/extend":673,"../../traces/scatter/attributes":889,"../annotations/attributes":575}],644:[function(n,t){"use strict";function u(n,t,i,u,e){var o=n.type==="category"?Number:n.d2c;if(t!==undefined)return[o(t),o(i)];if(u){var c=Infinity,l=-Infinity,y=u.match(r.segmentRE),s,p,a,v,h;for(n.type==="date"&&(o=f.decodeDate(o)),s=0;s<y.length;s++)(p=y[s],a=e[p.charAt(0)].drawn,a!==undefined)&&((v=y[s].substr(1).match(r.paramRE),!v||v.length<a)||(h=o(v[a]),h<c&&(c=h),h>l&&(l=h)));if(l>=c)return[c,l]}}var i=n("../../plots/cartesian/axes"),r=n("./constants"),f=n("./helpers");t.exports=function(n){var c=n._fullLayout,s=c.shapes,o,t,h,f,e;if(s.length&&n._fullData.length)for(o=0;o<s.length;o++)t=s[o],h=t.line.width/2,t.xref!=="paper"&&(f=i.getFromId(n,t.xref),e=u(f,t.x0,t.x1,t.path,r.paramIsX),e&&i.expand(f,e,{ppad:h})),t.yref!=="paper"&&(f=i.getFromId(n,t.yref),e=u(f,t.y0,t.y1,t.path,r.paramIsY),e&&i.expand(f,e,{ppad:h}))}},{"../../plots/cartesian/axes":710,"./constants":645,"./helpers":648}],645:[function(n,t){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],646:[function(n,t){"use strict";var i=n("./shape_defaults");t.exports=function(n,t){for(var f,e,u=n.shapes||[],o=t.shapes=[],r=0;r<u.length;r++)f=u[r]||{},e=i(f,t),o.push(e)}},{"./shape_defaults":650}],647:[function(n,t){"use strict";function s(n){var t=n._fullLayout,i;for(t._shapeUpperLayer.selectAll("path").remove(),t._shapeLowerLayer.selectAll("path").remove(),t._shapeSubplotLayer.selectAll("path").remove(),i=0;i<t.shapes.length;i++)e(n,i)}function e(n,t,i,r){if(!p(t)||t===-1){if(!t&&Array.isArray(r)){d(n,r);return}if(r==="remove"){g(n);return}if(i&&r!=="add"){nt(n,i,r);return}t=n._fullLayout.shapes.length;n._fullLayout.shapes.push({})}if(!i&&r){if(r==="remove"){tt(n,t);return}(r==="add"||f.isPlainObject(r))&&it(n,t,r)}rt(n,t,i,r)}function d(n,t){n.layout.shapes=t;k(n.layout,n._fullLayout);s(n)}function g(n){delete n.layout.shapes;n._fullLayout.shapes=[];s(n)}function nt(n,t,i){for(var r=0;r<n._fullLayout.shapes.length;r++)e(n,r,t,i)}function tt(n,t){o(n,t).selectAll('[data-index="'+t+'"]').remove();n._fullLayout.shapes.splice(t,1);n.layout.shapes.splice(t,1);for(var i=t;i<n._fullLayout.shapes.length;i++)o(n,i).selectAll('[data-index="'+(i+1)+'"]').attr("data-index",i),e(n,i)}function it(n,t,i){var u,r;for(n._fullLayout.shapes.splice(t,0,{}),u=f.isPlainObject(i)?f.extendFlat({},i):{text:"New text"},n.layout.shapes?n.layout.shapes.splice(t,0,u):n.layout.shapes=[u],r=n._fullLayout.shapes.length-1;r>t;r--)o(n,r).selectAll('[data-index="'+(r-1)+'"]').attr("data-index",r),e(n,r)}function rt(n,t,u,e){function ht(i){var u={"data-index":t,"fill-rule":"evenodd",d:h(n,s)},f=s.line.width?s.line.color:"rgba(0,0,0,0)",r=i.append("path").attr(u).style("opacity",s.opacity).call(c.stroke,f).call(c.fill,s.fillcolor).call(l.dashLine,s.line.dash,s.line.width);g&&r.call(l.setClipUrl,"clip"+n._fullLayout._uid+g);n._context.editable&&ut(n,r,s,t)}var a,ct,v,lt,k,it,rt,at,d,s,g,ot,tt,st;if(o(n,t).selectAll('[data-index="'+t+'"]').remove(),v=n.layout.shapes[t],v){for(lt={xref:v.xref,yref:v.yref},k={},typeof u=="string"&&u?k[u]=e:f.isPlainObject(u)&&(k=u),it=Object.keys(k),a=0;a<it.length;a++)rt=it[a],f.nestedProperty(v,rt).set(k[rt]);for(at=["x0","x1","y0","y1"],a=0;a<4;a++)if(d=at[a],k[d]===undefined&&v[d]!==undefined){var et=d.charAt(0),p=r.getFromId(n,r.coerceRef(lt,{},n,et)),w=r.getFromId(n,r.coerceRef(v,{},n,et)),y=v[d],nt;k[et+"ref"]!==undefined&&(p?(nt=i.dataToLinear(p)(y),y=(nt-p.range[0])/(p.range[1]-p.range[0])):y=(y-w.domain[0])/(w.domain[1]-w.domain[0]),w?(nt=w.range[0]+y*(w.range[1]-w.range[0]),y=i.linearToData(w)(nt)):y=p.domain[0]+y*(p.domain[1]-p.domain[0]));v[d]=y}if(s=b(v,n._fullLayout),n._fullLayout.shapes[t]=s,s.layer!=="below")g=(s.xref+s.yref).replace(/paper/g,""),ht(n._fullLayout._shapeUpperLayer);else if(s.xref==="paper"&&s.yref==="paper")g="",ht(n._fullLayout._shapeLowerLayer);else for(ot=n._fullLayout._plots||{},tt=Object.keys(ot),a=0,ct=tt.length;a<ct;a++)st=ot[tt[a]],g=tt[a],ft(n,s,st)&&ht(st.shapelayer)}}function ut(n,t,u,f){function ri(n){var i=p.right-p.left,r=p.bottom-p.top,f=n.clientX-p.left,e=n.clientY-p.top,u=i>kt&&r>dt&&!n.shiftKey?a.getCursor(f/i,1-e/r):"move";v(t,u);b=u.split("-")[0]}function ui(t){o=r.getFromId(n,u.xref);s=r.getFromId(n,u.yref);tt=i.getDataToPixel(n,o);it=i.getDataToPixel(n,s,!0);c=i.getPixelToData(n,o);l=i.getPixelToData(n,s,!0);var h="shapes["+f+"]";u.type==="path"?(pt=u.path,wt=h+".path"):(k=tt(u.x0),d=it(u.y0),g=tt(u.x1),nt=it(u.y1),gt=h+".x0",ni=h+".y0",ti=h+".x1",ii=h+".y1");k<g?(ft=k,ht=h+".x0",vt="x0",et=g,ct=h+".x1",yt="x1"):(ft=g,ht=h+".x1",vt="x1",et=k,ct=h+".x0",yt="x0");d<nt?(rt=d,ot=h+".y0",lt="y0",ut=nt,st=h+".y1",at="y1"):(rt=nt,ot=h+".y1",lt="y1",ut=d,st=h+".y0",at="y0");e={};ri(t);bt.moveFn=b==="move"?ei:oi}function fi(i){v(t);i&&w.relayout(n,e)}function ei(r,f){var a,v;u.type==="path"?(a=function(n){return c(tt(n)+r)},o&&o.type==="date"&&(a=i.encodeDate(a)),v=function(n){return l(it(n)+f)},s&&s.type==="date"&&(v=i.encodeDate(v)),u.path=y(pt,a,v),e[wt]=u.path):(e[gt]=u.x0=c(k+r),e[ni]=u.y0=l(d+f),e[ti]=u.x1=c(g+r),e[ii]=u.y1=l(nt+f));t.attr("d",h(n,u))}function oi(r,f){var a,v;if(u.type==="path")a=function(n){return c(tt(n)+r)},o&&o.type==="date"&&(a=i.encodeDate(a)),v=function(n){return l(it(n)+f)},s&&s.type==="date"&&(v=i.encodeDate(v)),u.path=y(pt,a,v),e[wt]=u.path;else{var p=~b.indexOf("n")?rt+f:rt,w=~b.indexOf("s")?ut+f:ut,k=~b.indexOf("w")?ft+r:ft,d=~b.indexOf("e")?et+r:et;w-p>dt&&(e[ot]=u[lt]=l(p),e[st]=u[at]=l(w));d-k>kt&&(e[ht]=u[vt]=c(k),e[ct]=u[yt]=c(d))}t.attr("d",h(n,u))}var kt=10,dt=10,e,k,d,g,nt,gt,ni,ti,ii,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,o,s,tt,it,c,l,bt={setCursor:ri,element:t.node(),prepFn:ui,doneFn:fi},p=bt.element.getBoundingClientRect(),b;a.init(bt)}function o(n,t){var i=n._fullLayout.shapes[t],r=n._fullLayout._shapeUpperLayer;return i?i.layer==="below"&&(r=i.xref==="paper"&&i.yref==="paper"?n._fullLayout._shapeLowerLayer:n._fullLayout._shapeSubplotLayer):f.log("getShapeLayer: undefined shape: index",t),r}function ft(n,t,i){var u=r.getFromId(n,i.id,"x")._id,f=r.getFromId(n,i.id,"y")._id,e=t.layer==="below",o=u===t.xref||f===t.yref,s=!!i.shapelayer;return e&&o&&s}function h(n,t){var l=t.type,e=r.getFromId(n,t.xref),o=r.getFromId(n,t.yref),h=n._fullLayout._size,w,u,b,f;if(e?(w=i.dataToLinear(e),u=function(n){return e._offset+e.l2p(w(n,!0))}):u=function(n){return h.l+h.w*n},o?(b=i.dataToLinear(o),f=function(n){return o._offset+o.l2p(b(n,!0))}):f=function(n){return h.t+h.h*(1-n)},l==="path")return e&&e.type==="date"&&(u=i.decodeDate(u)),o&&o.type==="date"&&(f=i.decodeDate(f)),et(t.path,u,f);var s=u(t.x0),a=u(t.x1),c=f(t.y0),v=f(t.y1);if(l==="line")return"M"+s+","+c+"L"+a+","+v;if(l==="rect")return"M"+s+","+c+"H"+a+"V"+v+"H"+s+"Z";var y=(s+a)/2,p=(c+v)/2,k=Math.abs(y-s),d=Math.abs(p-c),g="A"+k+","+d,nt=y+k+","+p,tt=y+","+(p-d);return"M"+nt+g+" 0 1,1 "+tt+g+" 0 0,1 "+nt+"Z"}function et(n,t,i){return n.replace(u.segmentRE,function(n){var r=0,e=n.charAt(0),h=u.paramIsX[e],c=u.paramIsY[e],s=u.numParams[e],o=n.substr(1).replace(u.paramRE,function(n){return h[r]?n=t(n):c[r]&&(n=i(n)),r++,r>s&&(n="X"),n});return r>s&&(o=o.replace(/[\s,]*X.*/,""),f.log("Ignoring extra params in segment "+n)),e+o})}function y(n,t,i){return n.replace(u.segmentRE,function(n){var r=0,f=n.charAt(0),e=u.paramIsX[f],o=u.paramIsY[f],s=u.numParams[f],h=n.substr(1).replace(u.paramRE,function(n){return r>=s?n:(e[r]?n=t(n):o[r]&&(n=i(n)),r++,n)});return f+h})}var p=n("fast-isnumeric"),w=n("../../plotly"),f=n("../../lib"),r=n("../../plots/cartesian/axes"),c=n("../color"),l=n("../drawing"),a=n("../dragelement"),v=n("../../lib/setcursor"),u=n("./constants"),i=n("./helpers"),b=n("./shape_defaults"),k=n("./defaults");t.exports={draw:s,drawOne:e}},{"../../lib":681,"../../lib/setcursor":691,"../../plotly":706,"../../plots/cartesian/axes":710,"../color":582,"../dragelement":603,"../drawing":605,"./constants":645,"./defaults":646,"./helpers":648,"./shape_defaults":650,"fast-isnumeric":133}],648:[function(n,t,i){"use strict";i.dataToLinear=function(n){return n.type==="category"?n.c2l:n.d2l};i.linearToData=function(n){return n.type==="category"?n.l2c:n.l2d};i.decodeDate=function(n){return function(t){return t.replace&&(t=t.replace("_"," ")),n(t)}};i.encodeDate=function(n){return function(t){return n(t).replace(" ","_")}};i.getDataToPixel=function(n,t,r){var f=n._fullLayout._size,u,e;return t?(e=i.dataToLinear(t),u=function(n){return t._offset+t.l2p(e(n,!0))},t.type==="date"&&(u=i.decodeDate(u))):u=r?function(n){return f.t+f.h*(1-n)}:function(n){return f.l+f.w*n},u};i.getPixelToData=function(n,t,r){var u=n._fullLayout._size,f,e;return t?(e=i.linearToData(t),f=function(n){return e(t.p2l(n-t._offset))}):f=r?function(n){return 1-(n-u.t)/u.h}:function(n){return(n-u.l)/u.w},f}},{}],649:[function(n,t,i){"use strict";i.moduleType="component";i.name="shapes";i.layoutAttributes=n("./attributes");i.supplyLayoutDefaults=n("./defaults");i.calcAutorange=n("./calc_autorange");var r=n("./draw");i.draw=r.draw;i.drawOne=r.drawOne},{"./attributes":643,"./calc_autorange":644,"./defaults":646,"./draw":647}],650:[function(n,t){"use strict";var i=n("../../lib"),r=n("../../plots/cartesian/axes"),u=n("./attributes"),f=n("./helpers");t.exports=function(n,t){function e(t,r){return i.coerce(n,s,u,t,r)}var s={},h,c,l,o,v;e("layer");e("opacity");e("fillcolor");e("line.color");e("line.width");e("line.dash");var b=n.path?"path":"rect",y=e("type",b),k=["x","y"];for(h=0;h<2;h++){var a=k[h],p={_fullLayout:t},w=r.coerceRef(n,s,p,a);y!=="path"&&(c=.25,l=.75,w!=="paper"&&(o=r.getFromId(p,w),v=f.linearToData(o),c=v(o.range[0]+c*(o.range[1]-o.range[0])),l=v(o.range[0]+l*(o.range[1]-o.range[0]))),e(a+"0",c),e(a+"1",l))}return y==="path"?e("path"):i.noneOrAll(n,s,["x0","x1","y0","y1"]),s}},{"../../lib":681,"../../plots/cartesian/axes":710,"./attributes":643,"./helpers":648}],651:[function(n,t){"use strict";var r=n("../../plots/font_attributes"),f=n("../../plots/pad_attributes"),u=n("../../lib/extend").extendFlat,e=n("../../lib/extend").extendDeep,o=n("../../plots/animation_attributes"),i=n("./constants");t.exports={visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:-10,dflt:0},steps:{_isLinkedToArray:!0,method:{valType:"enumerated",values:["restyle","relayout","animate","update"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"}},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:e({},f,{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:o.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:u({},r,{})},font:u({},r,{}),activebgcolor:{valType:"color",dflt:i.gripBgActiveColor},bgcolor:{valType:"color",dflt:i.railBgColor},bordercolor:{valType:"color",dflt:i.railBorderColor},borderwidth:{valType:"number",min:0,dflt:i.railBorderWidth},ticklen:{valType:"number",min:0,dflt:i.tickLength},tickcolor:{valType:"color",dflt:i.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:i.minorTickLength}}},{"../../lib/extend":673,"../../plots/animation_attributes":707,"../../plots/font_attributes":729,"../../plots/pad_attributes":768,"./constants":652}],652:[function(n,t){"use strict";t.exports={name:"sliders",itemName:"slider",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,fontSizeToHeight:1.3,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],653:[function(n,t){"use strict";function o(n,t,r){function f(r,f){return i.coerce(n,t,u,r,f)}var o=s(n,t),h=f("visible",o.length>0),e;h&&(f("active"),f("x"),f("y"),i.noneOrAll(n,t,["x","y"]),f("xanchor"),f("yanchor"),f("len"),f("lenmode"),f("pad.t"),f("pad.r"),f("pad.b"),f("pad.l"),i.coerceFont(f,"font",r.font),e=f("currentvalue.visible"),e&&(f("currentvalue.xanchor"),f("currentvalue.prefix"),f("currentvalue.suffix"),f("currentvalue.offset"),i.coerceFont(f,"currentvalue.font",t.font)),f("transition.duration"),f("transition.easing"),f("bgcolor"),f("activebgcolor"),f("bordercolor"),f("borderwidth"),f("ticklen"),f("tickwidth"),f("tickcolor"),f("minorticklen"))}function s(n,t){function f(n,t){return i.coerce(r,u,e,n,t)}for(var s=n.steps||[],h=t.steps=[],r,u,o=0;o<s.length;o++)(r=s[o],u={},i.isPlainObject(r)&&Array.isArray(r.args))&&(f("method"),f("args"),f("label","step-"+o),f("value",u.label),h.push(u));return h}var i=n("../../lib"),u=n("./attributes"),f=n("./constants"),r=f.name,e=u.steps;t.exports=function(n,t){for(var f,i,e=Array.isArray(n[r])?n[r]:[],s=t[r]=[],u=0;u<e.length;u++)f=e[u]||{},i={},o(f,i,t),i._input=f,i._index=u,s.push(i)}},{"../../lib":681,"./attributes":651,"./constants":652}],654:[function(n,t){"use strict";function k(n){for(var t,u=n[i.name],f=[],r=0;r<u.length;r++)(t=u[r],t.visible&&t.steps.length)&&f.push(t);return f}function d(n){return n._index}function g(n,t){var l=n._tester.selectAll("g."+i.labelGroupClass).data(t.steps),v,y,p,u,f,c;l.enter().append("g").classed(i.labelGroupClass,!0);v=0;y=0;l.each(function(n){var u=r.select(this),i=a(u,{step:n},t),f=i.node()&&e.bBox(i.node()).width||0;y=i.node()&&e.bBox(i.node()).height||0;v=Math.max(v,f)});l.remove();t.inputAreaWidth=Math.max(i.railWidth,i.gripHeight);t.currentValueMaxWidth=0;t.currentValueHeight=0;t.currentValueTotalHeight=0;t.currentvalue.visible&&(p=n._tester.append("g"),l.each(function(n){var i=h(p,t,n.label),r=i.node()&&e.bBox(i.node())||{width:0,height:0};t.currentValueMaxWidth=Math.max(t.currentValueMaxWidth,Math.ceil(r.width));t.currentValueHeight=Math.max(t.currentValueHeight,Math.ceil(r.height))}),t.currentValueTotalHeight=t.currentValueHeight+t.currentvalue.offset,p.remove());u=n._fullLayout._size;t.lx=u.l+u.w*t.x;t.ly=u.t+u.h*(1-t.y);t.outerLength=t.lenmode==="fraction"?Math.round(u.w*t.len):t.len;t.lenPad=Math.round(i.gripWidth*.5);t.inputAreaStart=0;t.inputAreaLength=Math.round(t.outerLength-t.pad.l-t.pad.r);var w=t.inputAreaLength-2*i.stepInset,b=w/(t.steps.length-1),k=v+i.labelPadding;t.labelStride=Math.max(1,Math.ceil(k/b));t.labelHeight=y;t.height=t.currentValueTotalHeight+i.tickOffset+t.ticklen+i.labelOffset+t.labelHeight+t.pad.t+t.pad.b;f="left";o.isRightAnchor(t)&&(t.lx-=t.outerLength,f="right");o.isCenterAnchor(t)&&(t.lx-=t.outerLength/2,f="center");c="top";o.isBottomAnchor(t)&&(t.ly-=t.height,c="bottom");o.isMiddleAnchor(t)&&(t.ly-=t.height/2,c="middle");t.outerLength=Math.ceil(t.outerLength);t.height=Math.ceil(t.height);t.lx=Math.round(t.lx);t.ly=Math.round(t.ly);s.autoMargin(n,i.autoMarginIdRoot+t._index,{x:t.x,y:t.y,l:t.outerLength*({right:1,center:.5}[f]||0),r:t.outerLength*({left:1,center:.5}[f]||0),b:t.height*({top:1,middle:.5}[c]||0),t:t.height*({bottom:1,middle:.5}[c]||0)})}function nt(n,t,i){t.call(h,i).call(ot,i).call(it,i).call(rt,i).call(et,n,i).call(tt,n,i);f.setTranslate(t,i.lx+i.pad.l,i.ly+i.pad.t);y(n,t,i,i.active,!1,!1)}function h(n,t,r){var s,h,u,o,c;if(t.currentvalue.visible){u=n.selectAll("text").data([0]);switch(t.currentvalue.xanchor){case"right":s=t.inputAreaLength-i.currentValueInset-t.currentValueMaxWidth;h="left";break;case"center":s=t.inputAreaLength*.5;h="middle";break;default:s=i.currentValueInset;h="left"}return u.enter().append("text").classed(i.labelClass,!0).classed("user-select-none",!0).attr("text-anchor",h),o=t.currentvalue.prefix?t.currentvalue.prefix:"",typeof r=="string"?o+=r:(c=t.steps[t.active].label,o+=c),t.currentvalue.suffix&&(o+=t.currentvalue.suffix),u.call(e.font,t.currentvalue.font).text(o).call(l.convertToTspans),f.setTranslate(u,s,t.currentValueHeight),u}}function tt(n,t,r){var f=n.selectAll("rect."+i.gripRectClass).data([0]);f.enter().append("rect").classed(i.gripRectClass,!0).call(p,t,n,r).style("pointer-events","all");f.attr({width:i.gripWidth,height:i.gripHeight,rx:i.gripRadius,ry:i.gripRadius}).call(u.stroke,r.bordercolor).call(u.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function a(n,t,r){var u=n.selectAll("text").data([0]);return u.enter().append("text").classed(i.labelClass,!0).classed("user-select-none",!0).attr("text-anchor","middle"),u.call(e.font,r.font).text(t.step.label).call(l.convertToTspans),u}function it(n,t){var e=n.selectAll("g."+i.labelsClass).data([0]),u;e.enter().append("g").classed(i.labelsClass,!0);u=e.selectAll("g."+i.labelGroupClass).data(t.labelSteps);u.enter().append("g").classed(i.labelGroupClass,!0);u.exit().remove();u.each(function(n){var u=r.select(this);u.call(a,n,t);f.setTranslate(u,c(t,n.fraction),i.tickOffset+t.ticklen+t.labelHeight+i.labelOffset+t.currentValueTotalHeight)})}function v(n,t,i,r,u){var f=Math.round(r*(i.steps.length-1));f!==i.active&&y(n,t,i,f,!0,u)}function y(n,t,i,r,u,e){i._input.active=i.active=r;var o=i.steps[i.active];t.call(ft,i,i.active/(i.steps.length-1),e);t.call(h,i);o&&o.method&&u&&(t._nextMethod?(t._nextMethod.step=o,t._nextMethod.doCallback=u,t._nextMethod.doTransition=e):(t._nextMethod={step:o,doCallback:u,doTransition:e},t._nextMethodRaf=window.requestAnimationFrame(function(){var r=t._nextMethod.step,u=r.args;r.method&&(i._invokingCommand=!0,b[r.method](n,u[0],u[1],u[2]).then(function(){i._invokingCommand=!1},function(){i._invokingCommand=!1;f.warn("Warning: Plotly."+r.method+" was called and rejected.")}),t._nextMethod=null,t._nextMethodRaf=null)})))}function p(n,t,f,e){var s=f.node(),o=r.select(t);n.on("mousedown",function(){var n=f.select("."+i.gripRectClass),h;r.event.stopPropagation();r.event.preventDefault();n.call(u.fill,e.activebgcolor);h=w(e,r.mouse(s)[0]);v(t,f,e,h,!0);o.on("mousemove",function(){var n=w(e,r.mouse(s)[0]);v(t,f,e,n,!1)});o.on("mouseup",function(){n.call(u.fill,e.bgcolor);o.on("mouseup",null);o.on("mousemove",null)})})}function rt(n,t){var e=n.selectAll("rect."+i.tickRectClass).data(t.steps);e.enter().append("rect").classed(i.tickRectClass,!0);e.exit().remove();e.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"});e.each(function(n,e){var o=e%t.labelStride==0,s=r.select(this);s.attr({height:o?t.ticklen:t.minorticklen}).call(u.fill,o?t.tickcolor:t.tickcolor);f.setTranslate(s,c(t,e/(t.steps.length-1))-.5*t.tickwidth,(o?i.tickOffset:i.minorTickOffset)+t.currentValueTotalHeight)})}function ut(n){var r,i,t;for(n.labelSteps=[],r=0,i=n.steps.length,t=r;t<i;t+=n.labelStride)n.labelSteps.push({fraction:t/(i-1),step:n.steps[t]})}function ft(n,t,r,u){var e=n.select("rect."+i.gripRectClass),o=c(t,r),f=e;u&&t.transition.duration>0&&!t._invokingCommand&&(f=f.transition().duration(t.transition.duration).ease(t.transition.easing));f.attr("transform","translate("+(o-i.gripWidth*.5)+","+t.currentValueTotalHeight+")")}function c(n,t){return n.inputAreaStart+i.stepInset+(n.inputAreaLength-2*i.stepInset)*Math.min(1,Math.max(0,t))}function w(n,t){return Math.min(1,Math.max(0,(t-i.stepInset-n.inputAreaStart)/(n.inputAreaLength-2*i.stepInset-2*n.inputAreaStart)))}function et(n,t,r){var e=n.selectAll("rect."+i.railTouchRectClass).data([0]);e.enter().append("rect").classed(i.railTouchRectClass,!0).call(p,t,n,r).style("pointer-events","all");e.attr({width:r.inputAreaLength,height:Math.max(r.inputAreaWidth,i.tickOffset+r.ticklen+r.labelHeight)}).call(u.fill,r.bgcolor).attr("opacity",0);f.setTranslate(e,0,r.currentValueTotalHeight)}function ot(n,t){var r=n.selectAll("rect."+i.railRectClass).data([0]),e;r.enter().append("rect").classed(i.railRectClass,!0);e=t.inputAreaLength-i.railInset*2;r.attr({width:e,height:i.railWidth,rx:i.railRadius,ry:i.railRadius,"shape-rendering":"crispEdges"}).call(u.stroke,t.bordercolor).call(u.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");f.setTranslate(r,i.railInset,(t.inputAreaWidth-i.railWidth)*.5+t.currentValueTotalHeight)}function st(n){for(var r,f=n._fullLayout._pushmargin||{},u=Object.keys(f),t=0;t<u.length;t++)r=u[t],r.indexOf(i.autoMarginIdRoot)!==-1&&s.autoMargin(n,r)}var r=n("d3"),b=n("../../plotly"),s=n("../../plots/plots"),f=n("../../lib"),u=n("../color"),e=n("../drawing"),l=n("../../lib/svg_text_utils"),o=n("../legend/anchor_utils"),i=n("./constants");t.exports=function(n){var o=n._fullLayout,t=k(o),u=o._infolayer.selectAll("g."+i.containerClassName).data(t.length>0?[0]:[]),f,e,h;if(u.enter().append("g").classed(i.containerClassName,!0).style("cursor","ew-resize"),u.exit().remove(),u.exit().size()&&st(n),t.length!==0){for(f=u.selectAll("g."+i.groupClassName).data(t,d),f.enter().append("g").classed(i.groupClassName,!0),f.exit().each(function(t){r.select(this).remove();s.autoMargin(n,i.autoMarginIdRoot+t._index)}),e=0;e<t.length;e++)h=t[e],g(n,h);f.each(function(t){t.steps.length<2||(ut(t),nt(n,r.select(this),t))})}}},{"../../lib":681,"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/plots":769,"../color":582,"../drawing":605,"../legend/anchor_utils":618,"./constants":652,d3:129}],655:[function(n,t,i){"use strict";i.moduleType="component";i.name="sliders";i.layoutAttributes=n("./attributes");i.supplyLayoutDefaults=n("./defaults");i.draw=n("./draw")},{"./attributes":651,"./defaults":653,"./draw":654}],656:[function(n,t){"use strict";var i=n("d3"),h=n("fast-isnumeric"),r=n("../../plotly"),u=n("../../plots/plots"),f=n("../../lib"),e=n("../drawing"),o=n("../color"),s=n("../../lib/svg_text_utils"),c=t.exports={};c.draw=function(n,t,c){function rt(n){f.syncOrAsync([st,ht],n)}function st(t){return t.attr("transform",d?"rotate("+[d.rotate,v.x,v.y]+") translate(0, "+d.offset+")":null),t.style({"font-family":et,"font-size":i.round(ot,2)+"px",fill:o.rgb(it),opacity:k*o.opacity(it),"font-weight":u.fontWeight}).attr(v).call(s.convertToTspans).attr(v),t.selectAll("tspan.line").attr(v),u.previousPromises(n)}function ht(n){var o=i.select(n.node().parentNode),c;if(l&&l.selection&&l.side&&a){o.attr("transform",null);var t=0,v={left:"right",right:"left",top:"bottom",bottom:"top"}[l.side],y=["left","top"].indexOf(l.side)!==-1?-1:1,s=h(l.pad)?l.pad:2,r=e.bBox(o.node()),p={left:0,top:0,right:b.width,bottom:b.height},u=l.maxShift||(p[l.side]-r[l.side])*(l.side==="left"||l.side==="top"?-1:1);u<0?t=u:(r.left-=l.offsetLeft,r.right-=l.offsetLeft,r.top-=l.offsetTop,r.bottom-=l.offsetTop,l.selection.each(function(){var n=e.bBox(this);f.bBoxIntersect(r,n,s)&&(t=Math.max(t,y*(n[l.side]-r[v])+s))}),t=Math.min(u,t));(t>0||u<0)&&(c={left:[-t,0],right:[t,0],top:[0,-t],bottom:[0,t]}[l.side],o.attr("transform","translate("+c+")"))}}function ct(){k=0;g=!0;a=ut;b._infolayer.select("."+t).attr({"data-unformatted":a}).text(a).on("mouseover.opacity",function(){i.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){i.select(this).transition().duration(1e3).style("opacity",0)})}var p=c.propContainer,nt=c.propName,tt=c.traceIndex,ft=c.dfltName,l=c.avoid||{},v=c.attributes,d=c.transform,w=c.containerGroup,b=n._fullLayout,et=p.titlefont.family,ot=p.titlefont.size,it=p.titlefont.color,k=1,g=!1,a=p.title.trim(),y,ut;if(a===""&&(k=0),a.match(/Click to enter .+ title/)&&(k=.2,g=!0),w||(w=b._infolayer.selectAll(".g-"+t).data([0]),w.enter().append("g").classed("g-"+t,!0)),y=w.selectAll("text").data([0]),y.enter().append("text"),y.text(a).attr("class",t),y.attr({"data-unformatted":a}).call(rt),ut="Click to enter "+ft+" title",n._context.editable){a||ct();y.call(s.makeEditable).on("edit",function(t){tt!==undefined?r.restyle(n,nt,t,tt):r.relayout(n,nt,t)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(rt)}).on("input",function(n){this.text(n||" ").attr(v).selectAll("tspan.line").attr(v)})}else(!a||a.match(/Click to enter .+ title/))&&y.remove();y.classed("js-placeholder",g)}},{"../../lib":681,"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/plots":769,"../color":582,"../drawing":605,d3:129,"fast-isnumeric":133}],657:[function(n,t){"use strict";var r=n("../../plots/font_attributes"),u=n("../color/attributes"),i=n("../../lib/extend").extendFlat,f=n("../../plots/pad_attributes");t.exports={_isLinkedToArray:!0,visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:{_isLinkedToArray:!0,method:{valType:"enumerated",values:["restyle","relayout","animate","update"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""}},x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:i({},f,{}),font:i({},r,{}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:u.borderLine},borderwidth:{valType:"number",min:0,dflt:1}}},{"../../lib/extend":673,"../../plots/font_attributes":729,"../../plots/pad_attributes":768,"../color/attributes":581}],658:[function(n,t){"use strict";t.exports={name:"updatemenus",itemName:"updatemenu",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,fontSizeToHeight:1.3,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF"}},{}],659:[function(n,t){"use strict";function o(n,t,r){function f(r,f){return i.coerce(n,t,u,r,f)}var e=s(n,t),o=f("visible",e.length>0);o&&(f("active"),f("direction"),f("type"),f("showactive"),f("x"),f("y"),i.noneOrAll(n,t,["x","y"]),f("xanchor"),f("yanchor"),f("pad.t"),f("pad.r"),f("pad.b"),f("pad.l"),i.coerceFont(f,"font",r.font),f("bgcolor",r.paper_bgcolor),f("bordercolor"),f("borderwidth"))}function s(n,t){function o(n,t){return i.coerce(r,u,e,n,t)}for(var s=n.buttons||[],h=t.buttons=[],r,u,f=0;f<s.length;f++)(r=s[f],u={},i.isPlainObject(r)&&Array.isArray(r.args))&&(o("method"),o("args"),o("label"),u._index=f,h.push(u));return h}var i=n("../../lib"),u=n("./attributes"),f=n("./constants"),r=f.name,e=u.buttons;t.exports=function(n,t){for(var f,i,e=Array.isArray(n[r])?n[r]:[],s=t[r]=[],u=0;u<e.length;u++)f=e[u]||{},i={},o(f,i,t),i._input=f,i._index=u,s.push(i)}},{"../../lib":681,"./attributes":657,"./constants":658}],660:[function(n,t){"use strict";function g(n){for(var r,u=n[i.name],f=[],t=0;t<u.length;t++)r=u[t],r.visible&&f.push(r);return f}function nt(n){return n._index}function a(n,t){var r=+n.attr(i.menuIndexAttrName);return r===t._index}function v(n,t,r,u){var f=t.selectAll("g."+i.headerClassName).data([0]),o;f.enter().append("g").classed(i.headerClassName,!0).style("pointer-events","all");var v=u.active,y=u.buttons[v]||i.blankHeaderOpts,k={y:u.pad.t,yPad:0,x:u.pad.l,xPad:0,index:0},d={width:u.headerWidth,height:u.headerHeight};f.call(c,u,y).call(b,u,k,d);o=t.selectAll("text."+i.headerArrowClassName).data([0]);o.enter().append("text").classed(i.headerArrowClassName,!0).classed("user-select-none",!0).attr("text-anchor","end").call(h.font,u.font).text("▼");o.attr({x:u.headerWidth-i.arrowOffsetX+u.pad.l,y:u.headerHeight/2+i.textOffsetY+u.pad.t});f.on("click",function(){r.call(l);r.attr(i.menuIndexAttrName,a(r,u)?"-1":String(u._index));e(n,t,r,u)});f.on("mouseover",function(){f.call(p)});f.on("mouseout",function(){f.call(w,u)});s.setTranslate(t,u.lx,u.ly)}function e(n,t,u,f){var g;u||(u=t,u.attr("pointer-events","all"));var nt=u.attr(i.menuIndexAttrName)!=="-1"||f.type==="buttons"?f.buttons:[],a=f.type==="dropdown"?i.dropdownButtonClassName:i.buttonClassName,o=u.selectAll("g."+a).data(nt),tt=o.enter().append("g").classed(a,!0),d=o.exit();f.type==="dropdown"?(tt.attr("opacity","0").transition().attr("opacity","1"),d.transition().attr("opacity","0").remove()):d.remove();var h=0,l=0,it=["up","down"].indexOf(f.direction)!==-1;f.type==="dropdown"&&(it?l=f.headerHeight+i.gapButtonHeader:h=f.headerWidth+i.gapButtonHeader);f.type==="dropdown"&&f.direction==="up"&&(l=-i.gapButtonHeader+i.gapButton-f.openHeight);f.type==="dropdown"&&f.direction==="left"&&(h=-i.gapButtonHeader+i.gapButton-f.openWidth);g={x:h+f.pad.l,y:l+f.pad.t,yPad:i.gapButton,xPad:i.gapButton,index:0};o.each(function(s,h){var l=r.select(this);l.call(c,f,s).call(b,f,g);l.on("click",function(){f._input.active=f.active=h;u.attr(i.menuIndexAttrName,"-1");f.type==="dropdown"&&v(n,t,u,f);e(n,t,u,f);var r=s.args;k[s.method](n,r[0],r[1],r[2])});l.on("mouseover",function(){l.call(p)});l.on("mouseout",function(){l.call(w,f);o.call(y,f)})});o.call(y,f);s.setTranslate(u,f.lx,f.ly)}function c(n,t,i){n.call(tt,t).call(it,t,i)}function tt(n,t){var r=n.selectAll("rect").data([0]);r.enter().append("rect").classed(i.itemRectClassName,!0).attr({rx:i.rx,ry:i.ry,"shape-rendering":"crispEdges"});r.call(u.stroke,t.bordercolor).call(u.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function it(n,t,r){var u=n.selectAll("text").data([0]);u.enter().append("text").classed(i.itemTextClassName,!0).classed("user-select-none",!0).attr("text-anchor","start");u.call(h.font,t.font).text(r.label).call(d.convertToTspans)}function y(n,t){var f=t.active;n.each(function(n,e){var o=r.select(this);e===f&&t.showactive&&o.select("rect."+i.itemRectClassName).call(u.fill,i.activeColor)})}function p(n){n.select("rect."+i.itemRectClassName).call(u.fill,i.hoverColor)}function w(n,t){n.select("rect."+i.itemRectClassName).call(u.fill,t.bgcolor)}function rt(n,t){var s,l,u,e;t.width1=0;t.height1=0;t.heights=[];t.widths=[];t.totalWidth=0;t.totalHeight=0;t.openWidth=0;t.openHeight=0;t.lx=0;t.ly=0;s=n._tester.selectAll("g."+i.dropdownButtonClassName).data(t.buttons);s.enter().append("g").classed(i.dropdownButtonClassName,!0);l=["up","down"].indexOf(t.direction)!==-1;s.each(function(n,u){var s=r.select(this);s.call(c,t,n);var o=s.select("."+i.itemTextClassName),a=o.selectAll("tspan"),v=o.node()&&h.bBox(o.node()).width,f=Math.max(v+i.textPadX,i.minWidth),y=t.font.size*i.fontSizeToHeight,p=a[0].length||1,e=Math.max(y*p,i.minHeight)+i.textOffsetY;e=Math.ceil(e);f=Math.ceil(f);t.widths[u]=f;t.heights[u]=e;t.height1=Math.max(t.height1,e);t.width1=Math.max(t.width1,f);l?(t.totalWidth=Math.max(t.totalWidth,f),t.openWidth=t.totalWidth,t.totalHeight+=e+i.gapButton,t.openHeight+=e+i.gapButton):(t.totalWidth+=f+i.gapButton,t.openWidth+=f+i.gapButton,t.totalHeight=Math.max(t.totalHeight,e),t.openHeight=t.totalHeight)});l?t.totalHeight-=i.gapButton:t.totalWidth-=i.gapButton;t.headerWidth=t.width1+i.arrowPadX;t.headerHeight=t.height1;t.type==="dropdown"&&(l?(t.width1+=i.arrowPadX,t.totalHeight=t.height1):t.totalWidth=t.width1,t.totalWidth+=i.arrowPadX);s.remove();var a=t.totalWidth+t.pad.l+t.pad.r,v=t.totalHeight+t.pad.t+t.pad.b,y=n._fullLayout._size;t.lx=y.l+y.w*t.x;t.ly=y.t+y.h*(1-t.y);u="left";f.isRightAnchor(t)&&(t.lx-=a,u="right");f.isCenterAnchor(t)&&(t.lx-=a/2,u="center");e="top";f.isBottomAnchor(t)&&(t.ly-=v,e="bottom");f.isMiddleAnchor(t)&&(t.ly-=v/2,e="middle");t.totalWidth=Math.ceil(t.totalWidth);t.totalHeight=Math.ceil(t.totalHeight);t.lx=Math.round(t.lx);t.ly=Math.round(t.ly);o.autoMargin(n,i.autoMarginIdRoot+t._index,{x:t.x,y:t.y,l:a*({right:1,center:.5}[u]||0),r:a*({left:1,center:.5}[u]||0),b:v*({top:1,middle:.5}[e]||0),t:v*({bottom:1,middle:.5}[e]||0)})}function b(n,t,r,u){var e;u=u||{};var a=n.select("."+i.itemRectClassName),o=n.select("."+i.itemTextClassName),h=o.selectAll("tspan"),c=t.borderwidth,f=r.index;s.setTranslate(n,c+r.x,c+r.y);e=["up","down"].indexOf(t.direction)!==-1;a.attr({x:0,y:0,width:u.width||(e?t.width1:t.widths[f]),height:u.height||(e?t.heights[f]:t.height1)});var v=t.font.size*i.fontSizeToHeight,y=h[0].length||1,p=(y-1)*v/4,l={x:i.textOffsetX,y:t.heights[f]/2-p+i.textOffsetY};o.attr(l);h.attr(l);e?r.y+=t.heights[f]+r.yPad:r.x+=t.widths[f]+r.xPad;r.index++}function l(n){n.selectAll("g."+i.dropdownButtonClassName).remove()}function ut(n){for(var r,f=n._fullLayout._pushmargin||{},u=Object.keys(f),t=0;t<u.length;t++)r=u[t],r.indexOf(i.autoMarginIdRoot)!==-1&&o.autoMargin(n,r)}var r=n("d3"),k=n("../../plotly"),o=n("../../plots/plots"),s=n("../../lib"),u=n("../color"),h=n("../drawing"),d=n("../../lib/svg_text_utils"),f=n("../legend/anchor_utils"),i=n("./constants");t.exports=function(n){var c=n._fullLayout,u=g(c),f=c._infolayer.selectAll("g."+i.containerClassName).data(u.length>0?[0]:[]),s,t,h,y;if(f.enter().append("g").classed(i.containerClassName,!0).style("cursor","pointer"),f.exit().remove(),f.exit().size()&&ut(n),u.length!==0){for(s=f.selectAll("g."+i.headerGroupClassName).data(u,nt),s.enter().append("g").classed(i.headerGroupClassName,!0),t=f.selectAll("g."+i.dropdownButtonGroupClassName).data([0]),t.enter().append("g").classed(i.dropdownButtonGroupClassName,!0).style("pointer-events","all"),s.enter().size()&&t.call(l).attr(i.menuIndexAttrName,"-1"),s.exit().each(function(u){r.select(this).remove();t.call(l).attr(i.menuIndexAttrName,"-1");o.autoMargin(n,i.autoMarginIdRoot+u._index)}),h=0;h<u.length;h++)y=u[h],rt(n,y);s.each(function(i){var u=r.select(this);i.type==="dropdown"?(v(n,u,t,i),a(t,i)&&e(n,u,t,i)):e(n,u,null,i)})}}},{"../../lib":681,"../../lib/svg_text_utils":695,"../../plotly":706,"../../plots/plots":769,"../color":582,"../drawing":605,"../legend/anchor_utils":618,"./constants":658,d3:129}],661:[function(n,t,i){"use strict";i.moduleType="component";i.name="updatemenus";i.layoutAttributes=n("./attributes");i.supplyLayoutDefaults=n("./defaults");i.draw=n("./draw")},{"./attributes":657,"./defaults":659,"./draw":660}],662:[function(n,t){"use strict";t.exports={solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}},{}],663:[function(n,t){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],664:[function(n,t){"use strict";t.exports={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"}},{}],665:[function(n,t){"use strict";t.exports={entityToUnicode:{mu:"μ",amp:"&",lt:"<",gt:">",nbsp:" ",times:"×",plusmn:"±",deg:"°"},unicodeToEntity:{"&":"amp","<":"lt",">":"gt",'"':"quot","'":"#x27","/":"#x2F"}}},{}],666:[function(n,t,i){"use strict";i.xmlns="http://www.w3.org/2000/xmlns/";i.svg="http://www.w3.org/2000/svg";i.xlink="http://www.w3.org/1999/xlink";i.svgAttrs={xmlns:i.svg,"xmlns:xlink":i.xlink}},{}],667:[function(n,t,i){"use strict";var r=n("./plotly");i.version="1.18.1";n("es6-promise").polyfill();n("../build/plotcss");n("./fonts/mathjax_config");i.plot=r.plot;i.newPlot=r.newPlot;i.restyle=r.restyle;i.relayout=r.relayout;i.redraw=r.redraw;i.update=r.update;i.extendTraces=r.extendTraces;i.prependTraces=r.prependTraces;i.addTraces=r.addTraces;i.deleteTraces=r.deleteTraces;i.moveTraces=r.moveTraces;i.purge=r.purge;i.setPlotConfig=n("./plot_api/set_plot_config");i.register=n("./plot_api/register");i.toImage=n("./plot_api/to_image");i.downloadImage=n("./snapshot/download");i.validate=n("./plot_api/validate");i.addFrames=r.addFrames;i.deleteFrames=r.deleteFrames;i.animate=r.animate;i.register(n("./traces/scatter"));i.register([n("./components/legend"),n("./components/annotations"),n("./components/shapes"),n("./components/images"),n("./components/updatemenus"),n("./components/sliders"),n("./components/rangeslider"),n("./components/rangeselector")]);i.Icons=n("../build/ploticon");i.Plots=r.Plots;i.Fx=r.Fx;i.Snapshot=n("./snapshot");i.PlotSchema=n("./plot_api/plot_schema");i.Queue=n("./lib/queue");i.d3=n("d3")},{"../build/plotcss":1,"../build/ploticon":2,"./components/annotations":580,"./components/images":617,"./components/legend":625,"./components/rangeselector":637,"./components/rangeslider":642,"./components/shapes":649,"./components/sliders":655,"./components/updatemenus":661,"./fonts/mathjax_config":668,"./lib/queue":689,"./plot_api/plot_schema":700,"./plot_api/register":701,"./plot_api/set_plot_config":702,"./plot_api/to_image":704,"./plot_api/validate":705,"./plotly":706,"./snapshot":789,"./snapshot/download":786,"./traces/scatter":899,d3:129,"es6-promise":132}],668:[function(n,t,i){"use strict";typeof MathJax!="undefined"?(i.MathJax=!0,MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured()):i.MathJax=!1},{}],669:[function(n,t){"use strict";t.exports=function(n,t,i,r){Array.isArray(n)&&(t[i]=n[r])}},{}],670:[function(n,t,i){"use strict";function e(n){return n&&n.valType!==undefined}var u=n("fast-isnumeric"),o=n("tinycolor2"),r=n("./nested_property"),s=n("./is_plain_object"),h=n("./filter_unique"),c=n("../components/colorscale/get_scale"),l=Object.keys(n("../components/colorscale/scales")),f=/^([2-9]|[1-9][0-9]+)$/;i.valObjects={data_array:{coerceFunction:function(n,t,i){Array.isArray(n)?t.set(n):i!==undefined&&t.set(i)}},enumerated:{coerceFunction:function(n,t,i,r){r.coerceNumber&&(n=+n);r.values.indexOf(n)===-1?t.set(i):t.set(n)}},boolean:{coerceFunction:function(n,t,i){n===!0||n===!1?t.set(n):t.set(i)}},number:{coerceFunction:function(n,t,i,r){!u(n)||r.min!==undefined&&n<r.min||r.max!==undefined&&n>r.max?t.set(i):t.set(+n)}},integer:{coerceFunction:function(n,t,i,r){n%1||!u(n)||r.min!==undefined&&n<r.min||r.max!==undefined&&n>r.max?t.set(i):t.set(+n)}},string:{coerceFunction:function(n,t,i,r){if(typeof n!="string"){var u=typeof n=="number";r.strict!==!0&&u?t.set(String(n)):t.set(i)}else r.noBlank&&!n?t.set(i):t.set(n)}},color:{coerceFunction:function(n,t,i){o(n).isValid()?t.set(n):t.set(i)}},colorscale:{coerceFunction:function(n,t,i){t.set(c(n,i))}},angle:{coerceFunction:function(n,t,i){n==="auto"?t.set("auto"):u(n)?(Math.abs(n)>180&&(n-=Math.round(n/360)*360),t.set(+n)):t.set(i)}},subplotid:{coerceFunction:function(n,t,i){var r=i.length;if(typeof n=="string"&&n.substr(0,r)===i&&f.test(n.substr(r))){t.set(n);return}t.set(i)},validateFunction:function(n,t){var i=t.dflt,r=i.length;return n===i?!0:typeof n!="string"?!1:n.substr(0,r)===i&&f.test(n.substr(r))?!0:!1}},flaglist:{coerceFunction:function(n,t,i,r){var u,f,e;if(typeof n!="string"){t.set(i);return}if((r.extras||[]).indexOf(n)!==-1){t.set(n);return}for(u=n.split("+"),f=0;f<u.length;)e=u[f],r.flags.indexOf(e)===-1||u.indexOf(e)<f?u.splice(f,1):f++;u.length?t.set(u.join("+")):t.set(i)}},any:{coerceFunction:function(n,t,i){n===undefined?t.set(i):t.set(n)}},info_array:{coerceFunction:function(n,t,r,u){var e,o,f;if(!Array.isArray(n)){t.set(r);return}for(e=u.items,o=[],r=Array.isArray(r)?r:[],f=0;f<e.length;f++)i.coerce(n,o,e,"["+f+"]",r[f]);t.set(o)},validateFunction:function(n,t){var u,r,f;if(!Array.isArray(n)||(u=t.items,!t.freeLength&&n.length!==u.length))return!1;for(r=0;r<n.length;r++)if(f=i.validate(n[r],t.items[r]),!f)return!1;return!0}}};i.coerce=function(n,t,u,f,e){var o=r(u,f).get(),c=r(n,f),h=r(t,f),s=c.get();return(e===undefined&&(e=o.dflt),o.arrayOk&&Array.isArray(s))?(h.set(s),s):(i.valObjects[o.valType].coerceFunction(s,h,e,o),h.get())};i.coerce2=function(n,t,u,f,e){var o=r(n,f),s=i.coerce(n,t,u,f,e);return o.get()?s:!1};i.coerceFont=function(n,t,i){var r={};return i=i||{},r.family=n(t+".family",i.family),r.size=n(t+".size",i.size),r.color=n(t+".color",i.color),r};i.validate=function(n,t){var r=i.valObjects[t.valType];if(t.arrayOk&&Array.isArray(n))return!0;if(r.validateFunction)return r.validateFunction(n,t);var u={},f=u,e={set:function(n){f=n}};return r.coerceFunction(n,e,u,t),f!==u};i.isValObject=e;i.IS_SUBPLOT_OBJ="_isSubplotObj";i.IS_LINKED_TO_ARRAY="_isLinkedToArray";i.DEPRECATED="_deprecated";i.UNDERSCORE_ATTRS=[i.IS_SUBPLOT_OBJ,i.IS_LINKED_TO_ARRAY,i.DEPRECATED];i.crawl=function(n,t,r){var u=r||0;Object.keys(n).forEach(function(r){var f=n[r];i.UNDERSCORE_ATTRS.indexOf(r)===-1&&((t(f,r,n,u),e(f))||s(f)&&i.crawl(f,t,u+1))})};i.findArrayAttributes=function(n){function f(i,f,o,s){var c,h,l;(u=u.slice(0,s).concat([f]),c=i.valType==="data_array"||i.arrayOk===!0,c)&&(h=e(u),l=r(n,h).get(),Array.isArray(l))&&t.push(h)}function e(n){return n.join(".")}var t=[],u=[];return i.crawl(n._module.attributes,f),n._fullInput&&(i.crawl(n._fullInput._module.attributes,f),t=h(t)),t}},{"../components/colorscale/get_scale":594,"../components/colorscale/scales":600,"./filter_unique":674,"./is_plain_object":683,"./nested_property":686,"fast-isnumeric":133,tinycolor2:546}],671:[function(n,t,i){"use strict";function u(n,t){return String(n+Math.pow(10,t)).substr(1)}function rt(n){var t;return t=w.test(n)?"Y":"y",t+(b.test(n)?"b":"")}function ut(n){return d.test(n)?k.test(n)?"I":"H":"D"}var e=n("d3"),o=n("fast-isnumeric");i.dateTime2ms=function(n){var u,r,i,e,f,t,s;try{if(n.getTime)return+n}catch(h){return!1}if((f=String(n).split(" "),f.length>2)||(t=f[0].split("-"),t.length>3||t.length!==3&&f[1]))return!1;if(t[0].length===4)u=Number(t[0]);else if(t[0].length===2)s=(new Date).getFullYear(),u=((Number(t[0])-s+70)%100+200)%100+s-70;else return!1;return o(u)?t.length===1?new Date(u,0,1).getTime():(r=Number(t[1])-1,t[1].length>2||!(r>=0&&r<=11))?!1:t.length===2?new Date(u,r,1).getTime():(i=Number(t[2]),t[2].length>2||!(i>=1&&i<=31))?!1:(i=new Date(u,r,i).getTime(),!f[1])?i:(t=f[1].split(":"),t.length>3)?!1:(e=Number(t[0]),t[0].length>2||!(e>=0&&e<=23))?!1:(i+=36e5*e,t.length===1)?i:(r=Number(t[1]),t[1].length>2||!(r>=0&&r<=59))?!1:(i+=6e4*r,t.length===2)?i:(n=Number(t[2]),!(n>=0&&n<60))?!1:i+n*1e3:!1};i.isDateTime=function(n){return i.dateTime2ms(n)!==!1};i.ms2DateTime=function(n,t){t||(t=0);var r=new Date(n),i=e.time.format("%Y-%m-%d")(r);return t<7776e6?(i+=" "+u(r.getHours(),2),t<432e6&&(i+=":"+u(r.getMinutes(),2),t<108e5&&(i+=":"+u(r.getSeconds(),2),t<3e5&&(i+="."+u(r.getMilliseconds(),3)))),i.replace(/([:\s]00)*\.?[0]*$/,"")):i};var s={H:["%H:%M:%S~%L","%H:%M:%S","%H:%M"],I:["%I:%M:%S~%L%p","%I:%M:%S%p","%I:%M%p"],D:["%H","%I%p","%Hh"]},h={Y:["%Y~%m~%d","%Y%m%d","%y%m%d","%m~%d~%Y","%d~%m~%Y"],Yb:["%b~%d~%Y","%d~%b~%Y","%Y~%d~%b","%Y~%b~%d"],y:["%m~%d~%y","%d~%m~%y","%y~%m~%d"],yb:["%b~%d~%y","%d~%b~%y","%y~%d~%b","%y~%b~%d"]},r=e.time.format.utc,f={Y:{H:["%Y~%m~%dT%H:%M:%S","%Y~%m~%dT%H:%M:%S~%L"].map(r),I:[],D:["%Y%m%d%H%M%S","%Y~%m","%m~%Y"].map(r)},Yb:{H:[],I:[],D:["%Y~%b","%b~%Y"].map(r)},y:{H:[],I:[],D:[]},yb:{H:[],I:[],D:[]}};["Y","Yb","y","yb"].forEach(function(n){h[n].forEach(function(t){f[n].D.push(r(t));["H","I","D"].forEach(function(i){s[i].forEach(function(u){var e=f[n][i];e.push(r(t+"~"+u));e.push(r(u+"~"+t))})})})});var c=/[a-z]*/g,l=function(n){return n.substr(0,3)},a=/(mon|tue|wed|thu|fri|sat|sun|the|of|st|nd|rd|th)/g,v=/[\s,\/\-\.\(\)]+/g,y=/~?([ap])~?m(~|$)/,p=function(n,t){return t+"m "},w=/\d\d\d\d/,b=/(^|~)[a-z]{3}/,k=/[ap]m/,d=/:/,g=/q([1-4])/,nt=["31~mar","30~jun","30~sep","31~dec"],tt=function(n,t){return nt[t-1]},it=/ ?([+\-]\d\d:?\d\d|Z)$/;i.parseDate=function(n){var i,e;if(n.getTime)return n;if(typeof n!="string")return!1;n=n.toLowerCase().replace(c,l).replace(a,"").replace(v,"~").replace(y,p).replace(g,tt).trim().replace(it,"");var t=null,o=rt(n),s=ut(n),r,u;for(r=f[o][s],u=r.length,i=0;i<u;i++)if(t=r[i].parse(n),t)break;return(t instanceof Date)?(e=t.getTimezoneOffset(),t.setTime(t.getTime()+e*6e4),t):!1}},{d3:129,"fast-isnumeric":133}],672:[function(n,t){"use strict";var i=n("events").EventEmitter,r={init:function(n){if(n._ev instanceof i)return n;var t=new i,r=new i;return n._ev=t,n._internalEv=r,n.on=t.on.bind(t),n.once=t.once.bind(t),n.removeListener=t.removeListener.bind(t),n.removeAllListeners=t.removeAllListeners.bind(t),n._internalOn=r.on.bind(r),n._internalOnce=r.once.bind(r),n._removeInternalListener=r.removeListener.bind(r),n._removeAllInternalListeners=r.removeAllListeners.bind(r),n.emit=function(i,u){typeof jQuery!="undefined"&&jQuery(n).trigger(i,u);t.emit(i,u);r.emit(i,u)},n},triggerHandler:function(n,t,i){var u,o,e,r,s,f;if((typeof jQuery!="undefined"&&(u=jQuery(n).triggerHandler(t,i)),e=n._ev,!e)||(r=e._events[t],!r))return u;for(typeof r=="function"&&(r=[r]),s=r.pop(),f=0;f<r.length;f++)r[f](i);return o=s(i),u!==undefined?u:o},purge:function(n){return delete n._ev,delete n.on,delete n.once,delete n.removeListener,delete n.removeAllListeners,delete n.emit,delete n._ev,delete n._internalEv,delete n._internalOn,delete n._internalOnce,delete n._removeInternalListener,delete n._removeAllInternalListeners,n}};t.exports=r},{events:61}],673:[function(n,t,i){"use strict";function e(n,t){for(var r,i=0;i<n.length;i++){if(r=n[i],r!==null&&typeof r=="object")return!1;r!==void 0&&(t[i]=r)}return!0}function u(n,t,i,o){var s=n[0],w=n.length,v,l,c,h,y,p,b,a;if(w===2&&r(s)&&r(n[1])&&s.length===0){if(b=e(n[1],s),b)return s;s.splice(0,s.length)}for(a=1;a<w;a++){v=n[a];for(l in v)c=s[l],h=v[l],o&&r(h)?s[l]=h:t&&h&&(f(h)||(y=r(h)))?(y?(y=!1,p=c&&r(c)?c:[]):p=c&&f(c)?c:{},s[l]=u([p,h],t,i,o)):(typeof h!="undefined"||i)&&(s[l]=h)}return s}var f=n("./is_plain_object.js"),r=Array.isArray;i.extendFlat=function(){return u(arguments,!1,!1,!1)};i.extendDeep=function(){return u(arguments,!0,!1,!1)};i.extendDeepAll=function(){return u(arguments,!0,!0,!1)};i.extendDeepNoArrays=function(){return u(arguments,!0,!1,!0)}},{"./is_plain_object.js":683}],674:[function(n,t){"use strict";t.exports=function(n){for(var t,r={},u=[],f=0,i=0;i<n.length;i++)t=n[i],r[t]!==1&&(r[t]=1,u[f++]=t);return u}},{}],675:[function(n,t){"use strict";t.exports=function(n){for(var i,r=[],t=0;t<n.length;t++)i=n[t],i.visible===!0&&r.push(i);return r}},{}],676:[function(n,t){"use strict";t.exports=function(n,t){for(var r=new Float32Array(t),i=0;i<t;i++)r[i]=n[i];return r}},{}],677:[function(n,t,i){"use strict";function o(n,t){var i=e[n];return i(t)}function s(n){for(var i,e,t=0;t<f.length;t++)if(i=f[t],e=new RegExp(u[i]),e.test(n.toLowerCase()))return i;return r.warn("Unrecognized country name: "+n+"."),!1}var u=n("country-regex"),r=n("../lib"),f=Object.keys(u),e={"ISO-3":r.identity,"USA-states":r.identity,"country names":s};i.locationToFeature=function(n,t,i){var f=o(n,t),u,e;if(f){for(u=0;u<i.length;u++)if(e=i[u],e.id===f)return e;r.warn(["Location with id",f,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}},{"../lib":681,"country-regex":124}],678:[function(n,t,i){"use strict";i.calcTraceToLineCoords=function(n){for(var u,f=n[0].trace,e=f.connectgaps,i=[],t=[],r=0;r<n.length;r++)u=n[r],t.push(u.lonlat),!e&&u.gapAfter&&t.length>0&&(i.push(t),t=[]);return i.push(t),i};i.makeLine=function(n,t){var i={};return i=n.length===1?{type:"LineString",coordinates:n[0]}:{type:"MultiLineString",coordinates:n},t&&(i.trace=t),i};i.makePolygon=function(n,t){var r={},u,i;if(n.length===1)r={type:"Polygon",coordinates:n};else{for(u=new Array(n.length),i=0;i<n.length;i++)u[i]=[n[i]];r={type:"MultiPolygon",coordinates:u}}return t&&(r.trace=t),r};i.makeBlank=function(){return{type:"Point",coordinates:[]}}},{}],679:[function(n,t){"use strict";function u(n,t){var i=c(n);return i[3]*=t,i}function f(n){return o(n).isValid()?n:i}function e(n){return s(n)?n:r}function l(n,t,o){var c=n.color,a=Array.isArray(c),v=Array.isArray(t),l=[],y,p,w,b,k,s;if(y=n.colorscale!==undefined?h(n.colorscale,n.cmin,n.cmax):f,p=a?function(n,t){return n[t]===undefined?i:y(n[t])}:f,w=v?function(n,t){return n[t]===undefined?r:e(n[t])}:e,a||v)for(s=0;s<o;s++)b=p(c,s),k=w(t,s),l[s]=u(b,k);else l=u(c,t);return l}var o=n("tinycolor2"),s=n("fast-isnumeric"),h=n("../components/colorscale/make_scale_function"),i=n("../components/color/attributes").defaultLine,c=n("./str2rgbarray"),r=1;t.exports=l},{"../components/color/attributes":581,"../components/colorscale/make_scale_function":599,"./str2rgbarray":694,"fast-isnumeric":133,tinycolor2:546}],680:[function(n,t){"use strict";function u(n){for(var t=0,r;(t=n.indexOf("<sup>",t))>=0;){if(r=n.indexOf("<\/sup>",t),r<t)break;n=n.slice(0,t)+i(n.slice(t+5,r))+n.slice(r+6)}return n}function f(n){return n.replace(/\<br\>/g,"\n")}function e(n){return n.replace(/\<.*\>/g,"")}function o(n){for(var f=r.entityToUnicode,t=0,i,u;(t=n.indexOf("&",t))>=0;){if(i=n.indexOf(";",t),i<t){t+=1;continue}u=f[n.slice(t+1,i)];n=u?n.slice(0,t)+u+n.slice(i+1):n.slice(0,t)+n.slice(i+1)}return n}function s(n){return""+o(e(u(f(n))))}var i=n("superscript-text"),r=n("../constants/string_mappings");t.exports=s},{"../constants/string_mappings":665,"superscript-text":535}],681:[function(n,t){"use strict";var a=n("d3"),i=t.exports={},r,o,e,f,u,s,h,c,l;i.nestedProperty=n("./nested_property");i.isPlainObject=n("./is_plain_object");i.isArray=n("./is_array");r=n("./coerce");i.valObjects=r.valObjects;i.coerce=r.coerce;i.coerce2=r.coerce2;i.coerceFont=r.coerceFont;i.validate=r.validate;i.isValObject=r.isValObject;i.crawl=r.crawl;i.findArrayAttributes=r.findArrayAttributes;i.IS_SUBPLOT_OBJ=r.IS_SUBPLOT_OBJ;i.IS_LINKED_TO_ARRAY=r.IS_LINKED_TO_ARRAY;i.DEPRECATED=r.DEPRECATED;i.UNDERSCORE_ATTRS=r.UNDERSCORE_ATTRS;o=n("./dates");i.dateTime2ms=o.dateTime2ms;i.isDateTime=o.isDateTime;i.ms2DateTime=o.ms2DateTime;i.parseDate=o.parseDate;e=n("./search");i.findBin=e.findBin;i.sorterAsc=e.sorterAsc;i.sorterDes=e.sorterDes;i.distinctVals=e.distinctVals;i.roundUp=e.roundUp;f=n("./stats");i.aggNums=f.aggNums;i.len=f.len;i.mean=f.mean;i.variance=f.variance;i.stdev=f.stdev;i.interp=f.interp;u=n("./matrix");i.init2dArray=u.init2dArray;i.transposeRagged=u.transposeRagged;i.dot=u.dot;i.translationMatrix=u.translationMatrix;i.rotationMatrix=u.rotationMatrix;i.rotationXYMatrix=u.rotationXYMatrix;i.apply2DTransform=u.apply2DTransform;i.apply2DTransform2=u.apply2DTransform2;s=n("./extend");i.extendFlat=s.extendFlat;i.extendDeep=s.extendDeep;i.extendDeepAll=s.extendDeepAll;i.extendDeepNoArrays=s.extendDeepNoArrays;h=n("./loggers");i.log=h.log;i.warn=h.warn;i.error=h.error;i.notifier=n("./notifier");i.filterUnique=n("./filter_unique");i.swapAttrs=function(n,t,r,u){var f;for(r||(r="x"),u||(u="y"),f=0;f<t.length;f++){var e=t[f],o=i.nestedProperty(n,e.replace("?",r)),s=i.nestedProperty(n,e.replace("?",u)),h=o.get();o.set(s.get());s.set(h)}};i.pauseEvent=function(n){return n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,!1};i.constrain=function(n,t,i){return t>i?Math.max(i,Math.min(t,n)):Math.max(t,Math.min(i,n))};i.bBoxIntersect=function(n,t,i){return i=i||0,n.left<=t.right+i&&t.left<=n.right+i&&n.top<=t.bottom+i&&t.top<=n.bottom+i};i.identity=function(n){return n};i.noop=function(){};i.randstr=function v(n,t,i){var f,r,u,h,e,o,s;if(i||(i=16),t===undefined&&(t=24),t<=0)return"0";for(f=Math.log(Math.pow(2,t))/Math.log(i),r="",u=2;f===Infinity;u*=2)f=Math.log(Math.pow(2,t/u))/Math.log(i)*u;for(o=f-Math.floor(f),u=0;u<Math.floor(f);u++)e=Math.floor(Math.random()*i).toString(i),r=e+r;return o&&(h=Math.pow(i,o),e=Math.floor(Math.random()*h).toString(i),r=e+r),s=parseInt(r,i),n&&n.indexOf(r)>-1||s!==Infinity&&s>=Math.pow(2,t)?v(n,t,i):r};i.OptionControl=function(n,t){n||(n={});t||(t="opt");var i={};return i.optionList=[],i._newoption=function(r){r[t]=n;i[r.name]=r;i.optionList.push(r)},i["_"+t]=n,i};i.smooth=function(n,t){if(t=Math.round(t)||0,t<2)return n;for(var f=n.length,u=2*f,o=2*t-1,h=new Array(o),c=new Array(f),e,i,s,r=0;r<o;r++)h[r]=(1-Math.cos(Math.PI*(r+1)/t))/(2*t);for(r=0;r<f;r++){for(s=0,e=0;e<o;e++)i=r+e+1-t,i<-f?i-=u*Math.round(i/u):i>=u&&(i-=u*Math.floor(i/u)),i<0?i=-1-i:i>=f&&(i=u-1-i),s+=n[i]*h[e];c[r]=s}return c};i.syncOrAsync=function(n,t,r){function e(){return i.syncOrAsync(n,t,r)}for(var u,f;n.length;)if(f=n.splice(0,1)[0],u=f(t),u&&u.then)return u.then(e).then(undefined,i.promiseError);return r&&r(t)};i.stripTrailingSlash=function(n){return n.substr(-1)==="/"?n.substr(0,n.length-1):n};i.noneOrAll=function(n,t,i){if(n){for(var f=!1,e=!0,u,r=0;r<i.length;r++)u=n[i[r]],u!==undefined&&u!==null?f=!0:e=!1;if(f&&!e)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]]}};i.pushUnique=function(n,t){return t&&n.indexOf(t)===-1&&n.push(t),n};i.mergeArray=function(n,t,i){var u,r;if(Array.isArray(n))for(u=Math.min(n.length,t.length),r=0;r<u;r++)t[r][i]=n[r]};i.minExtend=function(n,t){var o={},s,e,f,r,u;for(typeof t!="object"&&(t={}),s=3,e=Object.keys(n),f=0;f<e.length;f++)if(r=e[f],u=n[r],r.charAt(0)==="_"||typeof u=="function")continue;else o[r]=r==="module"?u:Array.isArray(u)?u.slice(0,s):u&&typeof u=="object"?i.minExtend(n[r],t[r]):u;for(e=Object.keys(t),f=0;f<e.length;f++)r=e[f],u=t[r],typeof u=="object"&&r in o&&typeof o[r]=="object"||(o[r]=u);return o};i.titleCase=function(n){return n.charAt(0).toUpperCase()+n.substr(1)};i.containsAny=function(n,t){for(var i=0;i<t.length;i++)if(n.indexOf(t[i])!==-1)return!0;return!1};i.getPlotDiv=function(n){for(;n&&n.removeAttribute;n=n.parentNode)if(i.isPlotDiv(n))return n};i.isPlotDiv=function(n){var t=a.select(n);return t.size()&&t.classed("js-plotly-plot")};i.removeElement=function(n){var t=n&&n.parentNode;t&&t.removeChild(n)};i.addStyleRule=function(n,t){var u,r;i.styleSheet||(u=document.createElement("style"),u.appendChild(document.createTextNode("")),document.head.appendChild(u),i.styleSheet=u.sheet);r=i.styleSheet;r.insertRule?r.insertRule(n+"{"+t+"}",0):r.addRule?r.addRule(n,t,0):i.warn("addStyleRule failed")};i.getTranslate=function(n){var i=n.attr?"attr":"getAttribute",r=n[i]("transform")||"",t=r.replace(/.*\btranslate\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(n,t,i){return[t,i].join(" ")}).split(" ");return{x:+t[0]||0,y:+t[1]||0}};i.setTranslate=function(n,t,i){var u=n.attr?"attr":"getAttribute",f=n.attr?"attr":"setAttribute",r=n[u]("transform")||"";return t=t||0,i=i||0,r=r.replace(/(\btranslate\(.*?\);?)/,"").trim(),r+=" translate("+t+", "+i+")",r=r.trim(),n[f]("transform",r),r};i.getScale=function(n){var i=n.attr?"attr":"getAttribute",r=n[i]("transform")||"",t=r.replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(n,t,i){return[t,i].join(" ")}).split(" ");return{x:+t[0]||1,y:+t[1]||1}};i.setScale=function(n,t,i){var u=n.attr?"attr":"getAttribute",f=n.attr?"attr":"setAttribute",r=n[u]("transform")||"";return t=t||1,i=i||1,r=r.replace(/(\bscale\(.*?\);?)/,"").trim(),r+=" scale("+t+", "+i+")",r=r.trim(),n[f]("transform",r),r};i.setPointGroupScale=function(n,t,i){var r,u,f;return t=t||1,i=i||1,u=t===1&&i===1?"":" scale("+t+","+i+")",f=/\s*sc.*/,n.each(function(){r=(this.getAttribute("transform")||"").replace(f,"");r+=u;r=r.trim();this.setAttribute("transform",r)}),u};i.isIE=function(){return typeof window.navigator.msSaveBlob!="undefined"};i.objectFromPath=function(n,t){for(var u=n.split("."),i,s=i={},r=0;r<u.length;r++){var f=u[r],e=null,o=u[r].match(/(.*)\[([0-9]+)\]/);o?(f=o[1],e=o[2],i=i[f]=[],i[e]=r===u.length-1?t:{},i=i[e]):(i[f]=r===u.length-1?t:{},i=i[f])}return s};c=/^([^\[\.]+)\.(.+)?/;l=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;i.expandObjectPaths=function(n){var u,t,r,f,e,o,s;if(typeof n=="object"&&!Array.isArray(n))for(t in n)n.hasOwnProperty(t)&&((u=t.match(c))?(f=n[t],r=u[1],delete n[t],n[r]=i.extendDeepNoArrays(n[r]||{},i.objectFromPath(t,i.expandObjectPaths(f))[r])):(u=t.match(l))?(f=n[t],r=u[1],e=parseInt(u[2]),delete n[t],n[r]=n[r]||[],u[3]==="."?(s=u[4],o=n[r][e]=n[r][e]||{},i.extendDeepNoArrays(o,i.objectFromPath(s,i.expandObjectPaths(f)))):n[r][e]=i.expandObjectPaths(f)):n[t]=i.expandObjectPaths(n[t]));return n};i.numSeparate=function(n,t,i){if(i||(i=!1),typeof t!="string"||t.length===0)throw new Error("Separator string required for formatting!");typeof n=="number"&&(n=String(n));var f=/(\d+)(\d{3})/,o=t.charAt(0),e=t.charAt(1),u=n.split("."),r=u[0],s=u.length>1?o+u[1]:"";if(e&&(u.length>1||r.length>4||i))while(f.test(r))r=r.replace(f,"$1"+e+"$2");return r+s}},{"./coerce":670,"./dates":671,"./extend":673,"./filter_unique":674,"./is_array":682,"./is_plain_object":683,"./loggers":684,"./matrix":685,"./nested_property":686,"./notifier":687,"./search":690,"./stats":693,d3:129}],682:[function(n,t){"use strict";t.exports=function(n){return Array.isArray(n)||ArrayBuffer.isView(n)}},{}],683:[function(n,t){"use strict";t.exports=function(n){return window&&window.process&&window.process.versions?Object.prototype.toString.call(n)==="[object Object]":Object.prototype.toString.call(n)==="[object Object]"&&Object.getPrototypeOf(n)===Object.prototype}},{}],684:[function(n,t){"use strict";var i=n("../plot_api/plot_config"),r=t.exports={};r.log=function(){var n,t;if(i.logging>1){for(n=["LOG:"],t=0;t<arguments.length;t++)n.push(arguments[t]);console.trace?console.trace.apply(console,n):console.log.apply(console,n)}};r.warn=function(){var n,t;if(i.logging>0){for(n=["WARN:"],t=0;t<arguments.length;t++)n.push(arguments[t]);console.trace?console.trace.apply(console,n):console.log.apply(console,n)}};r.error=function(){var t,n;if(i.logging>0){for(t=["ERROR:"],n=0;n<arguments.length;n++)t.push(arguments[n]);console.error.apply(console,arguments)}}},{"../plot_api/plot_config":699}],685:[function(n,t,i){"use strict";i.init2dArray=function(n,t){for(var r=new Array(n),i=0;i<n;i++)r[i]=new Array(t);return r};i.transposeRagged=function(n){for(var r=0,f=n.length,i,u,t=0;t<f;t++)r=Math.max(r,n[t].length);for(u=new Array(r),t=0;t<r;t++)for(u[t]=new Array(f),i=0;i<f;i++)u[t][i]=n[i][t];return u};i.dot=function(n,t){var f,u,r,e;if(!(n.length&&t.length)||n.length!==t.length)return null;if(f=n.length,n[0].length)for(u=new Array(f),r=0;r<f;r++)u[r]=i.dot(n[r],t);else if(t[0].length)for(e=i.transposeRagged(t),u=new Array(e.length),r=0;r<e.length;r++)u[r]=i.dot(n,e[r]);else for(u=0,r=0;r<f;r++)u+=n[r]*t[r];return u};i.translationMatrix=function(n,t){return[[1,0,n],[0,1,t],[0,0,1]]};i.rotationMatrix=function(n){var t=n*Math.PI/180;return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]};i.rotationXYMatrix=function(n,t,r){return i.dot(i.dot(i.translationMatrix(t,r),i.rotationMatrix(n)),i.translationMatrix(-t,-r))};i.apply2DTransform=function(n){return function(){var t=arguments,r;return t.length===3&&(t=t[0]),r=arguments.length===1?t[0]:[t[0],t[1]],i.dot(n,[r[0],r[1],1]).slice(0,2)}};i.apply2DTransform2=function(n){var t=i.apply2DTransform(n);return function(n){return t(n.slice(0,2)).concat(t(n.slice(2,4)))}}},{}],686:[function(n,t){"use strict";function u(n,t){return function(){for(var r=n,s,h,f,o,e=0;e<t.length-1;e++){if(s=t[e],s===-1){for(h=!0,f=[],o=0;o<r.length;o++)f[o]=u(r[o],t.slice(e+1))(),f[o]!==f[0]&&(h=!1);return h?f[0]:f}if(typeof s=="number"&&!i(r)||(r=r[s],typeof r!="object"||r===null))return undefined}return typeof r!="object"||r===null?undefined:(f=r[t[e]],f===null)?undefined:f}}function f(n,t){var r=["annotations","shapes","range","domain","buttons"].indexOf(t)===-1;return i(n)&&r}function e(n,t){return function(u){for(var e=n,v=[n],a=r(u)&&!f(u,t[t.length-1]),l,s=0;s<t.length-1;s++){if(l=t[s],typeof l=="number"&&!i(e))throw"array index but container is not an array";if(l===-1)if(a=!h(e,t.slice(s+1),u),a)break;else return;if(!o(e,l,t[s+1],a))break;if(e=e[l],typeof e!="object"||e===null)throw"container is not an object";v.push(e)}a?(s===t.length-1&&delete e[t[s]],c(v)):e[t[s]]=u}}function h(n,t,u){for(var c=i(u),l=!0,s=u,h=c?!1:r(u),a=t[0],f=0;f<n.length;f++)(c&&(s=u[f%u.length],h=r(s)),h&&(l=!1),o(n,f,a,h))&&e(n[f],t)(s);return l}function o(n,t,i,r){if(n[t]===undefined){if(r)return!1;n[t]=typeof i=="number"?[]:{}}return!0}function c(n){for(var t,u,e,o,s=n.length-1;s>=0;s--){if(u=n[s],o=!1,i(u))for(t=u.length-1;t>=0;t--)r(u[t])?o?u[t]=undefined:u.pop():o=!0;else if(typeof u=="object"&&u!==null)for(e=Object.keys(u),o=!1,t=e.length-1;t>=0;t--)r(u[e[t]])&&!f(u[e[t]],e[t])?delete u[e[t]]:o=!0;if(o)return}}function r(n){return n===undefined||n===null?!0:typeof n!="object"?!1:i(n)?!n.length:!Object.keys(n).length}function l(n,t,i){return{set:function(){throw"bad container";},get:function(){},astr:t,parts:i,obj:n}}var s=n("fast-isnumeric"),i=n("./is_array");t.exports=function(n,t){if(s(t))t=String(t);else if(typeof t!="string"||t.substr(t.length-4)==="[-1]")throw"bad property string";for(var r=0,i=t.split("."),f,h,o;r<i.length;){if(f=String(i[r]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),f){if(f[1])i[r]=f[1];else if(r===0)i.splice(0,1);else throw"bad property string";for(h=f[2].substr(1,f[2].length-2).split("]["),o=0;o<h.length;o++)r++,i.splice(r,0,Number(h[o]))}r++}return typeof n!="object"?l(n,t,i):{set:e(n,i),get:u(n,i),astr:t,parts:i,obj:n}}},{"./is_array":682,"fast-isnumeric":133}],687:[function(n,t){"use strict";var r=n("d3"),u=n("fast-isnumeric"),i=[];t.exports=function(n,t){function s(n){n.duration(700).style("opacity",0).each("end",function(n){var t=i.indexOf(n);t!==-1&&i.splice(t,1);r.select(this).remove()})}var f,e,o;i.indexOf(n)===-1&&(i.push(n),f=1e3,u(t)?f=t:t==="long"&&(f=3e3),e=r.select("body").selectAll(".plotly-notifier").data([0]),e.enter().append("div").classed("plotly-notifier",!0),o=e.selectAll(".notifier-note").data(i),o.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(n){var t=r.select(this);t.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){t.transition().call(s)});t.append("p").html(n);t.transition().duration(700).style("opacity",1).transition().delay(f).call(s)}))}},{d3:129,"fast-isnumeric":133}],688:[function(n,t){"use strict";var i=n("./matrix").dot,r=t.exports={},u;r.tester=function(n){function h(n,t){var i=n[0],o=n[1];return i<r||i>f||o<u||o>e?!1:t&&s(n)?!1:!0}function c(n,i){var o=n[0],s=n[1];if(o<r||o>f||s<u||s>e)return!1;for(var b=t.length,h=t[0][0],a=t[0][1],p=0,l,v,y,w,c=1;c<b;c++)if(l=h,v=a,h=t[c][0],a=t[c][1],y=Math.min(l,h),o<y||o>Math.max(l,h)||s>Math.max(v,a))continue;else if(s<Math.min(v,a))o!==y&&p++;else{if(w=h===l?s:v+(o-l)*(a-v)/(h-l),s===w)return c===1&&i?!1:!0;s<=w&&o!==y&&p++}return p%2==1}var t=n.slice(),r=t[0][0],f=r,u=t[0][1],e=u,i,o,s;for(t.push(t[0]),i=1;i<t.length;i++)r=Math.min(r,t[i][0]),f=Math.max(f,t[i][0]),u=Math.min(u,t[i][1]),e=Math.max(e,t[i][1]);return o=!1,t.length===5&&(t[0][0]===t[1][0]?t[2][0]===t[3][0]&&t[0][1]===t[3][1]&&t[1][1]===t[2][1]&&(o=!0,s=function(n){return n[0]===t[0][0]}):t[0][1]===t[1][1]&&t[2][1]===t[3][1]&&t[0][0]===t[3][0]&&t[1][0]===t[2][0]&&(o=!0,s=function(n){return n[1]===t[0][1]})),{xmin:r,xmax:f,ymin:u,ymax:e,pts:t,contains:o?h:c,isRect:o}};u=r.isSegmentBent=function(n,t,r,u){for(var o=n[t],f=[n[r][0]-o[0],n[r][1]-o[1]],c=i(f,f),l=Math.sqrt(c),a=[-f[1]/l,f[0]/l],s,h,e=t+1;e<r;e++)if(s=[n[e][0]-o[0],n[e][1]-o[1]],h=i(s,f),h<0||h>c||Math.abs(i(s,a))>u)return!0;return!1};r.filter=function(n,t){function e(e){var h,s,o;for(n.push(e),h=i.length,s=r,i.splice(f+1),o=s+1;o<n.length;o++)(o===n.length-1||u(n,s,o+1,t))&&(i.push(n[o]),i.length<h-2&&(r=o,f=i.length-1),s=o)}var i=[n[0]],r=0,f=0,o;return n.length>1&&(o=n.pop(),e(o)),{addPt:e,raw:n,filtered:i}}},{"./matrix":685}],689:[function(n,t){"use strict";function f(n,t){for(var f=[],i,u=0;u<t.length;u++)i=t[u],f[u]=i===n?i:typeof i=="object"?Array.isArray(i)?r.extendDeep([],i):r.extendDeepAll({},i):i;return f}var r=n("../lib"),u=n("../plot_api/plot_config"),i={};i.add=function(n,t,i,r,f){var e,o;if(n.undoQueue=n.undoQueue||{index:0,queue:[],sequence:!1},o=n.undoQueue.index,n.autoplay){n.undoQueue.inSequence||(n.autoplay=!1);return}!n.undoQueue.sequence||n.undoQueue.beginSequence?(e={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},n.undoQueue.queue.splice(o,n.undoQueue.queue.length-o,e),n.undoQueue.index+=1):e=n.undoQueue.queue[o-1];n.undoQueue.beginSequence=!1;e&&(e.undo.calls.unshift(t),e.undo.args.unshift(i),e.redo.calls.push(r),e.redo.args.push(f));n.undoQueue.queue.length>u.queueLength&&(n.undoQueue.queue.shift(),n.undoQueue.index--)};i.startSequence=function(n){n.undoQueue=n.undoQueue||{index:0,queue:[],sequence:!1};n.undoQueue.sequence=!0;n.undoQueue.beginSequence=!0};i.stopSequence=function(n){n.undoQueue=n.undoQueue||{index:0,queue:[],sequence:!1};n.undoQueue.sequence=!1;n.undoQueue.beginSequence=!1};i.undo=function(n){var r,t;if(n.framework&&n.framework.isPolar){n.framework.undo();return}if(n.undoQueue!==undefined&&!isNaN(n.undoQueue.index)&&!(n.undoQueue.index<=0)){for(n.undoQueue.index--,r=n.undoQueue.queue[n.undoQueue.index],n.undoQueue.inSequence=!0,t=0;t<r.undo.calls.length;t++)i.plotDo(n,r.undo.calls[t],r.undo.args[t]);n.undoQueue.inSequence=!1;n.autoplay=!1}};i.redo=function(n){var r,t;if(n.framework&&n.framework.isPolar){n.framework.redo();return}if(n.undoQueue!==undefined&&!isNaN(n.undoQueue.index)&&!(n.undoQueue.index>=n.undoQueue.queue.length)){for(r=n.undoQueue.queue[n.undoQueue.index],n.undoQueue.inSequence=!0,t=0;t<r.redo.calls.length;t++)i.plotDo(n,r.redo.calls[t],r.redo.args[t]);n.undoQueue.inSequence=!1;n.autoplay=!1;n.undoQueue.index++}};i.plotDo=function(n,t,i){n.autoplay=!0;i=f(n,i);t.apply(null,i)};t.exports=i},{"../lib":681,"../plot_api/plot_config":699}],690:[function(n,t,i){"use strict";function f(n,t){return n<t}function e(n,t){return n<=t}function o(n,t){return n>t}function s(n,t){return n>=t}var r=n("fast-isnumeric"),u=n("./loggers");i.findBin=function(n,t,i){if(r(t.start))return i?Math.ceil((n-t.start)/t.size)-1:Math.floor((n-t.start)/t.size);for(var h=0,l=t.length,a=0,c,v=t[t.length-1]>=t[0]?i?f:e:i?s:o;h<l&&a++<100;)c=Math.floor((h+l)/2),v(t[c],n)?h=c+1:l=c;return a>90&&u.log("Long binary search..."),h-1};i.sorterAsc=function(n,t){return n-t};i.sorterDes=function(n,t){return t-n};i.distinctVals=function(n){var t=n.slice(),r;t.sort(i.sorterAsc);var f=t.length-1,u=t[f]-t[0]||1,o=u/(f||1)/1e4,e=[t[0]];for(r=0;r<f;r++)t[r+1]>t[r]+o&&(u=Math.min(u,t[r+1]-t[r]),e.push(t[r+1]));return{vals:e,minDiff:u}};i.roundUp=function(n,t,i){for(var r=0,f=t.length-1,u,e=0,o=i?0:1,s=i?1:0,h=i?Math.ceil:Math.floor;r<f&&e++<100;)u=h((r+f)/2),t[u]<=n?r=u+o:f=u-s;return t[r]}},{"./loggers":684,"fast-isnumeric":133}],691:[function(n,t){"use strict";t.exports=function(n,t){(n.attr("class")||"").split(" ").forEach(function(t){t.indexOf("cursor-")===0&&n.classed(t,!1)});t&&n.classed("cursor-"+t,!0)}},{}],692:[function(n,t){"use strict";var i=n("../components/color"),r=function(){};t.exports=function(n){var u,t;for(u in n)typeof n[u]=="function"&&(n[u]=r);return n.destroy=function(){n.container.parentNode.removeChild(n.container)},t=document.createElement("div"),t.textContent="Webgl is not supported by your browser - visit http://get.webgl.org for more info",t.style.cursor="pointer",t.style.fontSize="24px",t.style.color=i.defaults[0],n.container.appendChild(t),n.container.style.background="#FFFFFF",n.container.onclick=function(){window.open("http://get.webgl.org")},!1}},{"../components/color":582}],693:[function(n,t,i){"use strict";var r=n("fast-isnumeric");i.aggNums=function(n,t,u,f){var e,o;if(f||(f=u.length),r(t)||(t=!1),Array.isArray(u[0])){for(o=new Array(f),e=0;e<f;e++)o[e]=i.aggNums(n,t,u[e]);u=o}for(e=0;e<f;e++)r(t)?r(u[e])&&(t=n(+t,+u[e])):t=u[e];return t};i.len=function(n){return i.aggNums(function(n){return n+1},0,n)};i.mean=function(n,t){return t||(t=i.len(n)),i.aggNums(function(n,t){return n+t},0,n)/t};i.variance=function(n,t,u){return t||(t=i.len(n)),r(u)||(u=i.mean(n,t)),i.aggNums(function(n,t){return n+Math.pow(t-u,2)},0,n)/t};i.stdev=function(n,t,r){return Math.sqrt(i.variance(n,t,r))};i.interp=function(n,t){if(!r(t))throw"n should be a finite number";if(t=t*n.length-.5,t<0)return n[0];if(t>n.length-1)return n[n.length-1];var i=t%1;return i*n[Math.ceil(t)]+(1-i)*n[Math.floor(t)]}},{"fast-isnumeric":133}],694:[function(n,t){"use strict";function u(n){return n=i(n),r.str2RgbaArray(n.toRgbString())}var i=n("tinycolor2"),r=n("arraytools");t.exports=u},{arraytools:55,tinycolor2:546}],695:[function(n,t,i){"use strict";function e(n,t){return n.node().getBoundingClientRect()[t]}function a(n){return n.replace(/(<|&lt;|&#60;)/g,"\\lt ").replace(/(>|&gt;|&#62;)/g,"\\gt ")}function v(n,t,i){var e="math-output-"+u.randstr([],64),f=r.select("body").append("div").attr({id:e}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(a(n));MathJax.Hub.Queue(["Typeset",MathJax.Hub,f.node()],function(){var e=r.select("body").select("#MathJax_SVG_glyphs"),t;f.select(".MathJax_SVG").empty()||!f.select("svg").node()?(u.log("There was an error in the tex syntax.",n),i()):(t=f.select("svg").node().getBoundingClientRect(),i(f.select(".MathJax_SVG"),e,t));f.remove()})}function h(n,t){for(var u,i=n||"",r=0;r<t.length;r++)u=t[r],i=i.replace(u.regExp,u.sub);return i}function k(n){return h(n,w)}function c(n){return h(n,b)}function d(n){var t,u,r,f,o,e;for(n=k(n),t=n.split(/(<[^<>]*>)/).map(function(n){var u=n.match(/<(\/?)([^ >]*)\s*(.*)>/i),t=u&&u[2].toLowerCase(),r=s[t],h,l,e;if(r!==undefined){var a=u[1],o=u[3],f=o.match(/^style\s*=\s*"([^"]+)"\s*/i);return t==="a"?a?"<\/a>":o.substr(0,4).toLowerCase()!=="href"?"<a>":(h=o.substr(4).replace(/["']/g,"").replace(/=/,""),l=document.createElement("a"),l.href=h,y.indexOf(l.protocol)===-1)?"<a>":'<a xlink:show="new" xlink:href="'+c(h)+'">':t==="br"?"<br>":a?t==="sup"?'<\/tspan><tspan dy="0.42em">&#x200b;<\/tspan>':t==="sub"?'<\/tspan><tspan dy="-0.21em">&#x200b;<\/tspan>':"<\/tspan>":(e="<tspan",(t==="sup"||t==="sub")&&(e="&#x200b;"+e),f&&(f=f[1].replace(/(^|;)\s*color:/,"$1 fill:"),r=(r?r+";":"")+c(f)),e+(r?' style="'+r+'"':"")+">")}return i.xml_entity_encode(n).replace(/</g,"&lt;")}),u=[],r=t.indexOf("<br>");r>0;r=t.indexOf("<br>",r+1))u.push(r);return f=0,u.forEach(function(n){for(var o,u=n+f,r=t.slice(0,u),e="",i=r.length-1;i>=0;i--)if(o=r[i].match(/<(\/?).*>/i),o&&r[i]!=="<br>"){o[1]||(e=r[i]);break}e&&(t.splice(u+1,0,e),t.splice(u,0,"<\/tspan>"),f+=2)}),o=t.join(""),e=o.split(/<br>/gi),e.length>1&&(t=e.map(function(n,t){return'<tspan class="line" dy="'+t*1.3+'em">'+n+"<\/tspan>"})),t.join("")}function l(n,t,i){var f=i.horizontalAlign,e=i.verticalAlign||"top",r=n.node().getBoundingClientRect(),o=t.node().getBoundingClientRect(),u,s,h;return s=e==="bottom"?function(){return r.bottom-u.height}:e==="middle"?function(){return r.top+(r.height-u.height)/2}:function(){return r.top},h=f==="right"?function(){return r.right-u.width}:f==="center"?function(){return r.left+(r.width-u.width)/2}:function(){return r.left},function(){return u=this.node().getBoundingClientRect(),this.style({top:s()-o.top+"px",left:h()-o.left+"px","z-index":1e3}),this}}var r=n("d3"),u=n("../lib"),o=n("../constants/xmlns_namespaces"),f=n("../constants/string_mappings");r.selection.prototype.appendSVG=function(n){for(var f=['<svg xmlns="',o.svg,'" ','xmlns:xlink="',o.xlink,'">',n,"<\/svg>"].join(""),i=(new DOMParser).parseFromString(f,"application/xml"),t=i.documentElement.firstChild;t;)this.node().appendChild(this.node().ownerDocument.importNode(t,!0)),t=t.nextSibling;return i.querySelector("parsererror")?(u.log(i.querySelector("parsererror div").textContent),null):r.select(this.node().lastChild)};i.html_entity_decode=function(n){var t=r.select("body").append("div").style({display:"none"}).html(""),i=n.replace(/(&[^;]*;)/gi,function(n){return n==="&lt;"?"&#60;":n==="&rt;"?"&#62;":t.html(n).text()});return t.remove(),i};i.xml_entity_encode=function(n){return n.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")};i.convertToTspans=function(n,t){function p(){o.empty()||(f=i.attr("class")+"-math",o.select("svg."+f).remove());n.text("").style({visibility:"inherit","white-space":"pre"});y=n.appendSVG(l);y||n.text(h);n.select("a").size()&&n.style("pointer-events","all");t&&t.call(i)}var h=n.text(),l=d(h),i=n,a=!i.attr("data-notex")&&l.match(/([^$]*)([$]+[^$]*[$]+)([^$]*)/),y=h,o=r.select(i.node().parentNode),f,s,c;if(!o.empty()){for(f=i.attr("class")?i.attr("class").split(" ")[0]:"text",f+="-math",o.selectAll("svg."+f).remove(),o.selectAll("g."+f+"-group").remove(),n.style({visibility:null}),s=n.node();s&&s.removeAttribute;s=s.parentNode)s.removeAttribute("data-bb");return a?(c=u.getPlotDiv(i.node()),(c&&c._promises||[]).push(new Promise(function(n){i.style({visibility:"hidden"});var r={fontSize:parseInt(i.style("font-size"),10)};v(a[2],r,function(r,u,s){var h,c,a;if(o.selectAll("svg."+f).remove(),o.selectAll("g."+f+"-group").remove(),h=r&&r.select("svg"),!h||!h.node()){p();n();return}c=o.append("g").classed(f+"-group",!0).attr({"pointer-events":"none"});c.node().appendChild(h.node());u&&u.node()&&h.node().insertBefore(u.node().cloneNode(!0),h.node().firstChild);h.attr({"class":f,height:s.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});a=i.style("fill")||"black";h.select("g").attr({fill:a,stroke:a});var y=e(h,"width"),v=e(h,"height"),w=+i.attr("x")-y*{start:0,middle:.5,end:1}[i.attr("text-anchor")||"start"],b=parseInt(i.style("font-size"),10)||e(i,"height"),l=-b/4;f[0]==="y"?(c.attr({transform:"rotate("+[-90,+i.attr("x"),+i.attr("y")]+") translate("+[-y/2,l-v/2]+")"}),h.attr({x:+i.attr("x"),y:+i.attr("y")})):f[0]==="l"?h.attr({x:i.attr("x"),y:l-v/2}):f[0]==="a"?h.attr({x:0,y:l}):h.attr({x:w,y:+i.attr("y")+l-v/2});t&&t.call(i,c);n(c)})}))):p(),n}};var s={sup:'font-size:70%" dy="-0.6em',sub:'font-size:70%" dy="0.3em',b:"font-weight:bold",i:"font-style:italic",a:"",span:"",br:"",em:"font-style:italic;font-weight:bold"},y=["http:","https:","mailto:"],p=new RegExp("<\/?("+Object.keys(s).join("|")+")( [^>]*)?/?>","g"),w=Object.keys(f.entityToUnicode).map(function(n){return{regExp:new RegExp("&"+n+";","g"),sub:f.entityToUnicode[n]}}),b=Object.keys(f.unicodeToEntity).map(function(n){return{regExp:new RegExp(n,"g"),sub:"&"+f.unicodeToEntity[n]+";"}});i.plainText=function(n){return(n||"").replace(p," ")};i.makeEditable=function(n,t,i){function h(){a();f.style({opacity:0});var t=s.attr("class"),n;n=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]";n&&r.select(f.node().parentNode).select(n).style({opacity:0})}function c(n){var i=n.node(),r=document.createRange(),t;r.selectNodeContents(i);t=window.getSelection();t.removeAllRanges();t.addRange(r);i.focus()}function a(){var o=r.select(u.getPlotDiv(f.node())),n=o.select(".svg-container"),t=n.append("div");t.classed("plugin-editable editable",!0).style({position:"absolute","font-family":f.style("font-family")||"Arial","font-size":f.style("font-size")||12,color:i.fill||f.style("fill")||"black",opacity:1,"background-color":i.background||"transparent",outline:"#ffffff33 1px solid",margin:[-parseFloat(f.style("font-size"))/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(i.text||f.attr("data-unformatted")).call(l(f,n,i)).on("blur",function(){var n,t,i;f.text(this.textContent).style({opacity:1});n=r.select(this).attr("class");t=n?"."+n.split(" ")[0]+"-math-group":"[class*=-math-group]";t&&r.select(f.node().parentNode).select(t).style({opacity:0});i=this.textContent;r.select(this).transition().duration(0).remove();r.select(document).on("mouseup",null);e.edit.call(f,i)}).on("focus",function(){var n=this;r.select(document).on("mouseup",function(){if(r.event.target===n)return!1;document.activeElement===t.node()&&t.node().blur()})}).on("keyup",function(){r.event.which===27?(f.style({opacity:1}),r.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),e.cancel.call(f,this.textContent)):(e.input.call(f,this.textContent),r.select(this).call(l(f,n,i)))}).on("keydown",function(){r.event.which===13&&this.blur()}).call(c)}i||(i={});var f=this,e=r.dispatch("edit","input","cancel"),o=r.select(this.node()).style({"pointer-events":"all"}),s=t||o;if(t&&o.style({"pointer-events":"none"}),i.immediate)h();else s.on("click",h);return r.rebind(this,e,"on")}},{"../constants/string_mappings":665,"../constants/xmlns_namespaces":666,"../lib":681,d3:129}],696:[function(n,t){"use strict";var i=t.exports={},r=n("../plots/geo/constants").locationmodeToLayer,u=n("topojson").feature;i.getTopojsonName=function(n){return[n.scope.replace(/ /g,"-"),"_",n.resolution.toString(),"m"].join("")};i.getTopojsonPath=function(n,t){return n+t+".json"};i.getTopojsonFeatures=function(n,t){var i=r[n.locationmode],f=t.objects[i];return u(t,f).features}},{"../plots/geo/constants":731,topojson:547}],697:[function(n,t,i){"use strict";function o(n,t){var i=n[t],r=t.charAt(0);i&&i!=="paper"&&(n[t]=e.cleanId(i,r))}function c(n){var t="middle",i="center";return n.indexOf("top")!==-1?t="top":n.indexOf("bottom")!==-1&&(t="bottom"),n.indexOf("left")!==-1?i="left":n.indexOf("right")!==-1&&(i="right"),t+" "+i}function s(n,t){return t in n&&typeof n[t]=="object"&&Object.keys(n[t]).length===0}var l=n("fast-isnumeric"),a=n("gl-mat4/fromQuat"),f=n("../registry"),r=n("../lib"),h=n("../plots/plots"),e=n("../plots/cartesian/axes"),u=n("../components/color");i.getGraphDiv=function(n){var t;if(typeof n=="string"){if(t=document.getElementById(n),t===null)throw new Error("No DOM element with id '"+n+"' exists on the page.");return t}if(n===null||n===undefined)throw new Error("DOM element provided is null or undefined");return n};i.clearPromiseQueue=function(n){Array.isArray(n._promises)&&n._promises.length>0&&r.log("Clearing previous rejected promises from queue.");n._promises=[]};i.cleanLayout=function(n){var i,v,k,t,nt,c,tt,d,f,g,y,l;for(n||(n={}),n.xaxis1&&(n.xaxis||(n.xaxis=n.xaxis1),delete n.xaxis1),n.yaxis1&&(n.yaxis||(n.yaxis=n.yaxis1),delete n.yaxis1),k=e.list({_fullLayout:n}),i=0;i<k.length;i++)t=k[i],t.anchor&&t.anchor!=="free"&&(t.anchor=e.cleanId(t.anchor)),t.overlaying&&(t.overlaying=e.cleanId(t.overlaying)),t.type||(t.isdate?t.type="date":t.islog?t.type="log":t.isdate===!1&&t.islog===!1&&(t.type="linear")),(t.autorange==="withzero"||t.autorange==="tozero")&&(t.autorange=!0,t.rangemode="tozero"),delete t.islog,delete t.isdate,delete t.categories,s(t,"domain")&&delete t.domain,t.autotick!==undefined&&(t.tickmode===undefined&&(t.tickmode=t.autotick?"auto":"linear"),delete t.autotick);for(n.annotations===undefined||Array.isArray(n.annotations)||(r.warn("Annotations must be an array."),delete n.annotations),nt=(n.annotations||[]).length,i=0;i<nt;i++)c=n.annotations[i],c.ref&&(c.ref==="paper"?(c.xref="paper",c.yref="paper"):c.ref==="data"&&(c.xref="x",c.yref="y"),delete c.ref),o(c,"xref"),o(c,"yref");for(n.shapes===undefined||Array.isArray(n.shapes)||(r.warn("Shapes must be an array."),delete n.shapes),tt=(n.shapes||[]).length,i=0;i<tt;i++)d=n.shapes[i],o(d,"xref"),o(d,"yref");for(f=n.legend,f&&(f.x>3?(f.x=1.02,f.xanchor="left"):f.x<-2&&(f.x=-.02,f.xanchor="right"),f.y>3?(f.y=1.02,f.yanchor="bottom"):f.y<-2&&(f.y=-.02,f.yanchor="top")),n.dragmode==="rotate"&&(n.dragmode="orbit"),n.scene1&&(n.scene||(n.scene=n.scene1),delete n.scene1),g=h.getSubplotIds(n,"gl3d"),i=0;i<g.length;i++)if(y=n[g[i]],l=y.cameraposition,Array.isArray(l)&&l[0].length===4){var it=l[0],p=l[1],rt=l[2],w=a([],it),b=[];for(v=0;v<3;++v)b[v]=p[i]+rt*w[2+4*v];y.camera={eye:{x:b[0],y:b[1],z:b[2]},center:{x:p[0],y:p[1],z:p[2]},up:{x:w[1],y:w[5],z:w[9]}};delete y.cameraposition}return u.clean(n),n};i.cleanData=function(n,t){for(var o,a,g,b,k,v,d,l,p=[],w=n.concat(Array.isArray(t)?t:[]).filter(function(n){return"uid"in n}).map(function(n){return n.uid}),y=0;y<n.length;y++){if(o=n[y],!("uid"in o)||p.indexOf(o.uid)!==-1){for(a=0;a<100;a++)if(g=r.randstr(w),p.indexOf(g)===-1)break;o.uid=r.randstr(w);w.push(o.uid)}if(p.push(o.uid),o.type==="histogramy"&&"xbins"in o&&!("ybins"in o)&&(o.ybins=o.xbins,delete o.xbins),o.error_y&&"opacity"in o.error_y&&(b=u.defaults,k=o.error_y.color||(f.traceIs(o,"bar")?u.defaultLine:b[y%b.length]),o.error_y.color=u.addOpacity(u.rgb(k),u.opacity(k)*o.error_y.opacity),delete o.error_y.opacity),"bardir"in o&&(o.bardir==="h"&&(f.traceIs(o,"bar")||o.type.substr(0,9)==="histogram")&&(o.orientation="h",i.swapXYData(o)),delete o.bardir),o.type==="histogramy"&&i.swapXYData(o),(o.type==="histogramx"||o.type==="histogramy")&&(o.type="histogram"),"scl"in o&&(o.colorscale=o.scl,delete o.scl),"reversescl"in o&&(o.reversescale=o.reversescl,delete o.reversescl),o.xaxis&&(o.xaxis=e.cleanId(o.xaxis,"x")),o.yaxis&&(o.yaxis=e.cleanId(o.yaxis,"y")),f.traceIs(o,"gl3d")&&o.scene&&(o.scene=h.subplotsRegistry.gl3d.cleanId(o.scene)),f.traceIs(o,"pie")||(Array.isArray(o.textposition)?o.textposition=o.textposition.map(c):o.textposition&&(o.textposition=c(o.textposition))),f.traceIs(o,"2dMap")&&(o.colorscale==="YIGnBu"&&(o.colorscale="YlGnBu"),o.colorscale==="YIOrRd"&&(o.colorscale="YlOrRd")),f.traceIs(o,"markerColorscale")&&o.marker&&(v=o.marker,v.colorscale==="YIGnBu"&&(v.colorscale="YlGnBu"),v.colorscale==="YIOrRd"&&(v.colorscale="YlOrRd")),o.type==="surface"&&r.isPlainObject(o.contours))for(d=["x","y","z"],a=0;a<d.length;a++)(l=o.contours[d[a]],r.isPlainObject(l))&&(l.highlightColor&&(l.highlightcolor=l.highlightColor,delete l.highlightColor),l.highlightWidth&&(l.highlightwidth=l.highlightWidth,delete l.highlightWidth));s(o,"line")&&delete o.line;"marker"in o&&(s(o.marker,"line")&&delete o.marker.line,s(o,"marker")&&delete o.marker);u.clean(o)}};i.swapXYData=function(n){var t,u,f,i;if(r.swapAttrs(n,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(n.z)&&Array.isArray(n.z[0])&&(n.transpose?delete n.transpose:n.transpose=!0),n.error_x&&n.error_y&&(u=n.error_y,f="copy_ystyle"in u?u.copy_ystyle:!(u.color||u.thickness||u.width),r.swapAttrs(n,["error_?.copy_ystyle"]),f&&r.swapAttrs(n,["error_?.color","error_?.thickness","error_?.width"])),n.hoverinfo){for(i=n.hoverinfo.split("+"),t=0;t<i.length;t++)i[t]==="x"?i[t]="y":i[t]==="y"&&(i[t]="x");n.hoverinfo=i.join("+")}};i.coerceTraceIndices=function(n,t){return l(t)?[t]:!Array.isArray(t)||!t.length?n.data.map(function(n,t){return t}):t}},{"../components/color":582,"../lib":681,"../plots/cartesian/axes":710,"../plots/plots":769,"../registry":784,"fast-isnumeric":133,"gl-mat4/fromQuat":150}],698:[function(n){"use strict";function st(n,t){n._fullLayout._paperdiv.style("background","white");i.defaultConfig.setBackground(n,t)}function ht(n,r){n._context||(n._context=t.extendFlat({},i.defaultConfig));var u=n._context;r&&(Object.keys(r).forEach(function(n){n in u&&(u[n]=n==="setBackground"&&r[n]==="opaque"?st:r[n])}),r.plot3dPixelRatio&&!u.plotGlPixelRatio&&(u.plotGlPixelRatio=u.plot3dPixelRatio));u.staticPlot&&(u.editable=!1,u.autosizable=!1,u.scrollZoom=!1,u.doubleClick=!1,u.showTips=!1,u.showLink=!1,u.displayModeBar=!1)}function ct(n,t,i){var a=s.select(n).selectAll(".plot-container").data([0]),u,l;a.enter().insert("div",":first-child").classed("plot-container plotly",!0);u=a.selectAll(".svg-container").data([0]);u.enter().append("div").classed("svg-container",!0).style("position","relative");u.html("");t&&(n.data=t);i&&(n.layout=i);w.manager.fillLayout(n);n._fullLayout.autosize==="initial"&&n._context.autosizable&&(v(n,{}),n._fullLayout.autosize=i.autosize=!0);u.style({width:n._fullLayout.width+"px",height:n._fullLayout.height+"px"});n.framework=w.manager.framework(n);n.framework({data:n.data,layout:n.layout},u.node());n.framework.setUndoPoint();var y=n.framework.svg(),e=1,f=n._fullLayout.title;f!==""&&f||(e=0);var o="Click to enter title",h=function(){this.call(b.convertToTspans)},c=y.select(".title-group text").call(h);if(n._context.editable){if(c.attr({"data-unformatted":f}),!f||f===o){e=.2;c.attr({"data-unformatted":o}).text(o).style({opacity:e}).on("mouseover.opacity",function(){s.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){s.select(this).transition().duration(1e3).style("opacity",0)})}l=function(){this.call(b.makeEditable).on("edit",function(t){n.framework({layout:{title:t}});this.attr({"data-unformatted":t}).text(t).call(h);this.call(l)}).on("cancel",function(){var n=this.attr("data-unformatted");this.text(n).call(h)})};c.call(l)}return n._context.setBackground(n,n._fullLayout.paper_bgcolor),r.addLinks(n),Promise.resolve()}function h(n,t){for(var f=t+1,u=[],r,i=0;i<n.length;i++)r=n[i],r<0?u.push(f+r):u.push(r);return u}function c(n,t,i){for(var r,u=0;u<t.length;u++){if(r=t[u],r!==parseInt(r,10))throw new Error("all values in "+i+" must be integers");if(r>=n.data.length||r<-n.data.length)throw new Error(i+" must be valid indices for gd.data.");if(t.indexOf(r,u+1)>-1||r>=0&&t.indexOf(-n.data.length+r)>-1||r<0&&t.indexOf(n.data.length+r)>-1)throw new Error("each index in "+i+" must be unique.");}}function k(n,t,i){if(!Array.isArray(n.data))throw new Error("gd.data must be an array.");if(typeof t=="undefined")throw new Error("currentIndices is a required argument.");else Array.isArray(t)||(t=[t]);if(c(n,t,"currentIndices"),typeof i=="undefined"||Array.isArray(i)||(i=[i]),typeof i!="undefined"&&c(n,i,"newIndices"),typeof i!="undefined"&&t.length!==i.length)throw new Error("current and new indices must be of equal length.");}function lt(n,t,i){var r,u;if(!Array.isArray(n.data))throw new Error("gd.data must be an array.");if(typeof t=="undefined")throw new Error("traces must be defined.");for(Array.isArray(t)||(t=[t]),r=0;r<t.length;r++)if(u=t[r],typeof u!="object"||Array.isArray(u)||u===null)throw new Error("all values in traces array must be non-array objects");if(typeof i=="undefined"||Array.isArray(i)||(i=[i]),typeof i!="undefined"&&i.length!==t.length)throw new Error("if indices is specified, traces.length must equal indices.length");}function at(n,i,r,u){var e=t.isPlainObject(u),f;if(!Array.isArray(n.data))throw new Error("gd.data must be an array");if(!t.isPlainObject(i))throw new Error("update must be a key:value object");if(typeof r=="undefined")throw new Error("indices must be an integer or array of integers");c(n,r,"indices");for(f in i){if(!Array.isArray(i[f])||i[f].length!==r.length)throw new Error("attribute "+f+" must be an array of length equal to indices array length");if(e&&(!(f in u)||!Array.isArray(u[f])||u[f].length!==i[f].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object");}}function vt(n,i,r,u){var p=t.isPlainObject(u),a=[],v,s,c,l,o,e,f;Array.isArray(r)||(r=[r]);r=h(r,n.data.length-1);for(e in i)for(f=0;f<r.length;f++){if(v=n.data[r[f]],c=t.nestedProperty(v,e),s=c.get(),l=i[e][f],!Array.isArray(l))throw new Error("attribute: "+e+" index: "+f+" must be an array");if(!Array.isArray(s))throw new Error("cannot extend missing or non-array attribute: "+e);o=p?u[e][f]:u;y(o)||(o=-1);a.push({prop:c,target:s,insert:l,maxp:Math.floor(o)})}return a}function d(n,t,i,r,u,f){var o;at(n,t,i,r);var s=vt(n,t,i,r),v=[],c={},l={},a,e,h;for(o=0;o<s.length;o++)e=s[o].prop,h=s[o].maxp,a=u(s[o].target,s[o].insert),h>=0&&h<a.length&&(v=f(a,h)),h=s[o].target.length,e.set(a),Array.isArray(c[e.astr])||(c[e.astr]=[]),Array.isArray(l[e.astr])||(l[e.astr]=[]),c[e.astr].push(v),l[e.astr].push(h);return{update:c,maxPoints:l}}function tt(n,r,e){function kt(){return v.map(function(){return undefined})}function dt(n){var t=i.Axes.id2name(n);g.indexOf(t)===-1&&g.push(t)}function fi(n){return"LAYOUT"+n+".autorange"}function ei(n){return"LAYOUT"+n+".range"}function h(i,u,f){if(Array.isArray(i)){i.forEach(function(n){h(n,u,f)});return}if(!(i in r)){var e;e=i.substr(0,6)==="LAYOUT"?t.nestedProperty(n.layout,i.replace("LAYOUT","")):t.nestedProperty(d[v[f]],i);i in b||(b[i]=kt());b[i][f]===undefined&&(b[i][f]=e.get());u!==undefined&&e.set(u)}}for(var a=n._fullLayout,at=n._fullData,d=n.data,v=u.coerceTraceIndices(n,e),c={docalc:!1,docalcAutorange:!1,doplot:!1,dostyle:!1,docolorbars:!1,autorangeOn:!1,clearCalc:!1,fullReplot:!1},ft={},b={},g,et={},vt=["mode","visible","type","orientation","fill","histfunc","histnorm","text","x","y","z","a","b","c","open","high","low","close","xtype","x0","dx","ytype","y0","dy","xaxis","yaxis","line.width","connectgaps","transpose","zsmooth","showscale","marker.showscale","zauto","marker.cauto","autocolorscale","marker.autocolorscale","colorscale","marker.colorscale","reversescale","marker.reversescale","autobinx","nbinsx","xbins","xbins.start","xbins.end","xbins.size","autobiny","nbinsy","ybins","ybins.start","ybins.end","ybins.size","autocontour","ncontours","contours","contours.coloring","error_y","error_y.visible","error_y.value","error_y.type","error_y.traceref","error_y.array","error_y.symmetric","error_y.arrayminus","error_y.valueminus","error_y.tracerefminus","error_x","error_x.visible","error_x.value","error_x.type","error_x.traceref","error_x.array","error_x.symmetric","error_x.arrayminus","error_x.valueminus","error_x.tracerefminus","swapxy","swapxyaxes","orientationaxes","marker.colors","values","labels","label0","dlabel","sort","textinfo","textposition","textfont.size","textfont.family","textfont.color","insidetextfont.size","insidetextfont.family","insidetextfont.color","outsidetextfont.size","outsidetextfont.family","outsidetextfont.color","hole","scalegroup","domain","domain.x","domain.y","domain.x[0]","domain.x[1]","domain.y[0]","domain.y[1]","tilt","tiltaxis","depth","direction","rotation","pull","line.showscale","line.cauto","line.autocolorscale","line.reversescale","marker.line.showscale","marker.line.cauto","marker.line.autocolorscale","marker.line.reversescale"],o,k,l,w,y,nt,p,ot,st,rt,ht,gt,tt,ut,ct,it,s=0;s<v.length;s++)if(f.traceIs(at[v[s]],"box")){vt.push("name");break}var ti=["marker","marker.size","textfont","boxpoints","jitter","pointpos","whiskerwidth","boxmean","tickwidth"],ii=["zmin","zmax","zauto","xgap","ygap","marker.cmin","marker.cmax","marker.cauto","line.cmin","line.cmax","marker.line.cmin","marker.line.cmax","contours.start","contours.end","contours.size","contours.showlines","line","line.smoothing","line.shape","error_y.width","error_x.width","error_x.copy_ystyle","marker.maxdisplayed"],ri=["type","x","y","x0","y0","orientation","xaxis","yaxis"],yt=["zmin","zmax"],pt=["xbins.start","xbins.end","xbins.size"],wt=["ybins.start","ybins.end","ybins.size"],bt=["contours.start","contours.end","contours.size"],ui=["cartesian","pie","ternary"];a._basePlotModules.forEach(function(n){ui.indexOf(n.name)===-1&&(c.docalc=!0)});for(o in r){if(k=r[o],ft[o]=k,o.substr(0,6)==="LAYOUT"){y=t.nestedProperty(n.layout,o.replace("LAYOUT",""));b[o]=[y.get()];y.set(Array.isArray(k)?k[0]:k);c.docalc=!0;continue}for(o.substr(0,10)==="transforms"&&(c.docalc=!0),b[o]=kt(),s=0;s<v.length;s++)if(l=d[v[s]],w=at[v[s]],y=t.nestedProperty(l,o),nt=y.get(),p=Array.isArray(k)?k[s%k.length]:k,p!==undefined)if(yt.indexOf(o)!==-1?h("zauto",!1,s):o==="colorscale"?h("autocolorscale",!1,s):o==="autocolorscale"?h("colorscale",undefined,s):o==="marker.colorscale"?h("marker.autocolorscale",!1,s):o==="marker.autocolorscale"?h("marker.colorscale",undefined,s):o==="zauto"?h(yt,undefined,s):pt.indexOf(o)!==-1?h("autobinx",!1,s):o==="autobinx"?h(pt,undefined,s):wt.indexOf(o)!==-1?h("autobiny",!1,s):o==="autobiny"?h(wt,undefined,s):bt.indexOf(o)!==-1?h("autocontour",!1,s):o==="autocontour"?h(bt,undefined,s):["x0","dx"].indexOf(o)!==-1&&w.x&&w.xtype!=="scaled"?h("xtype","scaled",s):["y0","dy"].indexOf(o)!==-1&&w.y&&w.ytype!=="scaled"?h("ytype","scaled",s):o==="colorbar.thicknessmode"&&y.get()!==p&&["fraction","pixels"].indexOf(p)!==-1&&w.colorbar?(ot=["top","bottom"].indexOf(w.colorbar.orient)!==-1?a.height-a.margin.t-a.margin.b:a.width-a.margin.l-a.margin.r,h("colorbar.thickness",w.colorbar.thickness*(p==="fraction"?1/ot:ot),s)):o==="colorbar.lenmode"&&y.get()!==p&&["fraction","pixels"].indexOf(p)!==-1&&w.colorbar?(st=["top","bottom"].indexOf(w.colorbar.orient)!==-1?a.width-a.margin.l-a.margin.r:a.height-a.margin.t-a.margin.b,h("colorbar.len",w.colorbar.len*(p==="fraction"?1/st:st),s)):o==="colorbar.tick0"||o==="colorbar.dtick"?h("colorbar.tickmode","linear",s):o==="colorbar.tickmode"&&h(["colorbar.tick0","colorbar.dtick"],undefined,s),o==="type"&&p==="pie"!=(nt==="pie")&&(rt="x",ht="y",(p==="bar"||nt==="bar")&&l.orientation==="h"&&(rt="y",ht="x"),t.swapAttrs(l,["?","?src"],"labels",rt),t.swapAttrs(l,["d?","?0"],"label",rt),t.swapAttrs(l,["?","?src"],"values",ht),nt==="pie"?(t.nestedProperty(l,"marker.color").set(t.nestedProperty(l,"marker.colors").get()),a._pielayer.selectAll("g.trace").remove()):f.traceIs(l,"cartesian")&&(t.nestedProperty(l,"marker.colors").set(t.nestedProperty(l,"marker.color").get()),et[l.xaxis||"x"]=!0,et[l.yaxis||"y"]=!0)),b[o][s]=nt,gt=["swapxy","swapxyaxes","orientation","orientationaxes"],gt.indexOf(o)!==-1){if(o==="orientation"){if(y.set(p),y.get()===b[o][s])continue}else o==="orientationaxes"&&(l.orientation={v:"h",h:"v"}[w.orientation]);u.swapXYData(l)}else y.set(p);if(["swapxyaxes","orientationaxes"].indexOf(o)!==-1&&i.Axes.swap(n,v),o==="orientationaxes"&&(tt=t.nestedProperty(n.layout,"hovermode"),tt.get()==="x"?tt.set("y"):tt.get()==="y"&&tt.set("x")),v.indexOf(0)!==-1&&ri.indexOf(o)!==-1&&(i.Axes.clearTypes(n,v),c.docalc=!0),(["autobinx","autobiny","zauto"].indexOf(o)===-1||p!==!1)&&(c.dostyle=!0),(["colorbar","line"].indexOf(y.parts[0])!==-1||y.parts[0]==="marker"&&y.parts[1]==="colorbar")&&(c.docolorbars=!0),vt.indexOf(o)!==-1){if(["orientation","type"].indexOf(o)!==-1){for(g=[],s=0;s<v.length;s++)ut=d[v[s]],f.traceIs(ut,"cartesian")&&(dt(ut.xaxis||"x"),dt(ut.yaxis||"y"),o==="type"&&h(["autobinx","autobiny"],!0,s));h(g.map(fi),!0,0);h(g.map(ei),[0,1],0)}c.docalc=!0}else ii.indexOf(o)!==-1?c.doplot=!0:ti.indexOf(o)!==-1&&(c.docalcAutorange=!0)}i.Axes.list(n).forEach(function(n){n.autorange&&(c.autorangeOn=!0)});ct=Object.keys(et);n:for(s=0;s<ct.length;s++){var lt=ct[s],ni=lt.charAt(0),oi=ni+"axis";for(it=0;it<d.length;it++)if(f.traceIs(d[it],"cartesian")&&(d[it][oi]||ni)===lt)continue n;h("LAYOUT"+i.Axes.id2name(lt),null,0)}return(c.docalc||c.docalcAutorange&&c.autorangeOn)&&(c.clearCalc=!0),(c.docalc||c.doplot||c.docalcAutorange)&&(c.fullReplot=!0),{flags:c,undoit:b,redoit:ft,traces:v,eventData:t.extendDeepNoArrays([],[ft,v])}}function rt(n,r){function c(n,i){if(Array.isArray(n)){n.forEach(function(n){c(n,i)});return}if(!(n in r)){var u=t.nestedProperty(it,n);n in a||(a[n]=u.get());i!==undefined&&u.set(i)}}function kt(n,t){var r=i.Axes.id2name(n[t+"ref"]||t);return(rt[r]||{}).autorange}for(var it=n.layout,rt=n._fullLayout,g=Object.keys(r),ut=i.Axes.list(n),nt,o,p,b,k,gt,ni,at,vt,yt,h=0;h<g.length;h++)if(g[h].indexOf("allaxes")===0){for(nt=0;nt<ut.length;nt++){var pt=ut[nt]._id.substr(1),ti=pt.indexOf("scene")!==-1?pt+".":"",wt=g[h].replace("allaxes",ti+ut[nt]._name);r[wt]||(r[wt]=r[g[h]])}delete r[g[h]]}var e={dolegend:!1,doticks:!1,dolayoutstyle:!1,doplot:!1,docalc:!1,domodebar:!1,layoutReplot:!1},ft={},a={},bt=["height","width"];for(o in r){var u=t.nestedProperty(it,o),l=r[o],et=u.parts.length,ot=typeof u.parts[et-1]=="string"?et-1:et-2,y=u.parts[ot],w=u.parts[ot-1]+"."+y,s=u.parts.slice(0,ot).join("."),tt=t.nestedProperty(n.layout,s).get(),st=t.nestedProperty(rt,s).get(),d;if(l!==undefined)if(ft[o]=l,a[o]=y==="reverse"?l:u.get(),bt.indexOf(o)!==-1?c("autosize",!1):o==="autosize"?c(bt,undefined):w.match(/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/)?c(s+".autorange",!1):w.match(/^[xyz]axis[0-9]*\.autorange$/)?c([s+".range[0]",s+".range[1]"],undefined):w.match(/^aspectratio\.[xyz]$/)?c(u.parts[0]+".aspectmode","manual"):w.match(/^aspectmode$/)?c([s+".x",s+".y",s+".z"],undefined):y==="tick0"||y==="dtick"?c(s+".tickmode","linear"):y==="tickmode"?c([s+".tick0",s+".dtick"],undefined):/[xy]axis[0-9]*?$/.test(y)&&!Object.keys(l||{}).length?e.docalc=!0:/[xy]axis[0-9]*\.categoryorder$/.test(w)?e.docalc=!0:/[xy]axis[0-9]*\.categoryarray/.test(w)&&(e.docalc=!0),w.indexOf("rangeslider")!==-1&&(e.docalc=!0),y==="type"&&st.type==="log"!=(l==="log")&&(p=tt,p&&p.range?st.autorange?l==="log"&&(p.range=p.range[1]>p.range[0]?[1,2]:[2,1]):(b=p.range[0],k=p.range[1],l==="log"?(b<=0&&k<=0&&c(s+".autorange",!0),b<=0?b=k/1e6:k<=0&&(k=b/1e6),c(s+".range[0]",Math.log(b)/Math.LN10),c(s+".range[1]",Math.log(k)/Math.LN10)):(c(s+".range[0]",Math.pow(10,b)),c(s+".range[1]",Math.pow(10,k)))):c(s+".autorange",!0)),y==="reverse")tt.range?tt.range.reverse():(c(s+".autorange",!0),tt.range=[1,0]),st.autorange?e.docalc=!0:e.doplot=!0;else if(u.parts[0]==="annotations"||u.parts[0]==="shapes"){var ht=u.parts[1],ct=u.parts[0],dt=it[ct]||[],lt=dt[ht]||{};u.parts.length===2&&(r[o]==="add"||t.isPlainObject(r[o])?a[o]="remove":r[o]==="remove"?ht===-1?(a[ct]=dt,delete a[o]):a[o]=lt:t.log("???",r));(kt(lt,"x")||kt(lt,"y"))&&!t.containsAny(o,["color","opacity","align","dash"])&&(e.docalc=!0);gt=f.getComponentMethod(ct,"drawOne");gt(n,ht,u.parts.slice(2).join("."),r[o]);delete r[o]}else if(u.parts[0]==="images")ni=t.objectFromPath(o,l),t.extendDeepAll(n.layout,ni),f.getComponentMethod("images","supplyLayoutDefaults")(n.layout,n._fullLayout),f.getComponentMethod("images","draw")(n);else if(u.parts[0]==="mapbox"&&u.parts[1]==="layers"){for(t.extendDeepAll(n.layout,t.objectFromPath(o,l)),at=(n._fullLayout.mapbox||{}).layers||[],d=u.parts[2]+1-at.length,h=0;h<d;h++)at.push({});e.doplot=!0}else if(u.parts[0]==="updatemenus"){for(t.extendDeepAll(n.layout,t.objectFromPath(o,l)),vt=n._fullLayout.updatemenus||[],d=u.parts[2]+1-vt.length,h=0;h<d;h++)vt.push({});e.doplot=!0}else if(u.parts[0]==="sliders"){for(t.extendDeepAll(n.layout,t.objectFromPath(o,l)),yt=n._fullLayout.sliders||[],d=u.parts[2]+1-yt.length,h=0;h<d;h++)yt.push({});e.doplot=!0}else u.parts[0].indexOf("scene")===0?e.doplot=!0:u.parts[0].indexOf("geo")===0?e.doplot=!0:u.parts[0].indexOf("ternary")===0?e.doplot=!0:o==="paper_bgcolor"?e.doplot=!0:rt._has("gl2d")&&(o.indexOf("axis")!==-1||u.parts[0]==="plot_bgcolor")?e.doplot=!0:o==="hiddenlabels"?e.docalc=!0:u.parts[0].indexOf("legend")!==-1?e.dolegend=!0:o.indexOf("title")!==-1?e.doticks=!0:u.parts[0].indexOf("bgcolor")!==-1?e.dolayoutstyle=!0:u.parts.length>1&&t.containsAny(u.parts[1],["tick","exponent","grid","zeroline"])?e.doticks=!0:o.indexOf(".linewidth")!==-1&&o.indexOf("axis")!==-1?e.doticks=e.dolayoutstyle=!0:u.parts.length>1&&u.parts[1].indexOf("line")!==-1?e.dolayoutstyle=!0:u.parts.length>1&&u.parts[1]==="mirror"?e.doticks=e.dolayoutstyle=!0:o==="margin.pad"?e.doticks=e.dolayoutstyle=!0:u.parts[0]==="margin"||u.parts[1]==="autorange"||u.parts[1]==="rangemode"||u.parts[1]==="type"||u.parts[1]==="domain"||o.match(/^(bar|box|font)/)?e.docalc=!0:["hovermode","dragmode"].indexOf(o)!==-1?e.domodebar=!0:["hovermode","dragmode","height","width","autosize"].indexOf(o)===-1&&(e.doplot=!0),u.set(l)}return r.autosize&&(r=v(n,r)),(r.height||r.width||r.autosize)&&(e.docalc=!0),(e.doplot||e.docalc)&&(e.layoutReplot=!0),{flags:e,undoit:a,redoit:ft,eventData:t.extendDeep({},ft)}}function kt(n){var i={left:0,right:0,bottom:0,top:0},t;if(n)for(t in n)n.hasOwnProperty(t)&&(i.left+=n[t].left||0,i.right+=n[t].right||0,i.bottom+=n[t].bottom||0,i.top+=n[t].top||0);return i}function v(n,t){var i=n._fullLayout,o=n._context,s,u,f;if(n.emit("plotly_autosize"),n._context.fillFrame)f=window.innerWidth,u=window.innerHeight,document.body.style.overflow="hidden";else if(y(o.frameMargins)&&o.frameMargins>0){var e=kt(n._boundingBoxMargins),l=e.left+e.right,a=e.bottom+e.top,h=i._container.node().getBoundingClientRect(),c=1-2*o.frameMargins;f=Math.round(c*(h.width-l));u=Math.round(c*(h.height-a))}else s=window.getComputedStyle(n),u=parseFloat(s.height)||i.height,f=parseFloat(s.width)||i.width;return Math.abs(i.width-f)>1||Math.abs(i.height-u)>1?(i.height=n.layout.height=u,i.width=n.layout.width=f):i.autosize!=="initial"&&(delete t.autosize,i.autosize=n.layout.autosize=!0),r.sanitizeMargins(i),t}function l(n){var e=s.select(n),i=n._fullLayout,r,u,f;i._container=e.selectAll(".plot-container").data([0]);i._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0);i._paperdiv=i._container.selectAll(".svg-container").data([0]);i._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative");i.autosize==="initial"&&(v(n,{}),i.autosize=!0,n.layout.autosize=!0);i._glcontainer=i._paperdiv.selectAll(".gl-container").data([0]);i._glcontainer.enter().append("div").classed("gl-container",!0);i._geocontainer=i._paperdiv.selectAll(".geo-container").data([0]);i._geocontainer.enter().append("div").classed("geo-container",!0);i._paperdiv.selectAll(".main-svg").remove();i._paper=i._paperdiv.insert("svg",":first-child").classed("main-svg",!0);i._toppaper=i._paperdiv.append("svg").classed("main-svg",!0);i._uid||(r=[],s.selectAll("defs").each(function(){this.id&&r.push(this.id.split("-")[1])}),i._uid=t.randstr(r));i._paperdiv.selectAll(".main-svg").attr(ot.svgAttrs);i._defs=i._paper.append("defs").attr("id","defs-"+i._uid);i._topdefs=i._toppaper.append("defs").attr("id","topdefs-"+i._uid);i._draggers=i._paper.append("g").classed("draglayer",!0);u=i._paper.append("g").classed("layer-below",!0);i._imageLowerLayer=u.append("g").classed("imagelayer",!0);i._shapeLowerLayer=u.append("g").classed("shapelayer",!0);i._cartesianlayer=i._paper.append("g").classed("cartesianlayer",!0);i._ternarylayer=i._paper.append("g").classed("ternarylayer",!0);f=i._paper.append("g").classed("layer-above",!0);i._imageUpperLayer=f.append("g").classed("imagelayer",!0);i._shapeUpperLayer=f.append("g").classed("shapelayer",!0);i._pielayer=i._paper.append("g").classed("pielayer",!0);i._glimages=i._paper.append("g").classed("glimages",!0);i._geoimages=i._paper.append("g").classed("geoimages",!0);i._infolayer=i._toppaper.append("g").classed("infolayer",!0);i._zoomlayer=i._toppaper.append("g").classed("zoomlayer",!0);i._hoverlayer=i._toppaper.append("g").classed("hoverlayer",!0);n.emit("plotly_framework")}var s=n("d3"),y=n("fast-isnumeric"),i=n("../plotly"),t=n("../lib"),a=n("../lib/events"),o=n("../lib/queue"),f=n("../registry"),r=n("../plots/plots"),p=n("../plots/cartesian/graph_interact"),w=n("../plots/polar"),ft=n("../components/drawing"),et=n("../components/errorbars"),ot=n("../constants/xmlns_namespaces"),b=n("../lib/svg_text_utils"),u=n("./helpers"),e=n("./subroutines");i.plot=function(n,o,h,c){function tt(){for(var r=v._basePlotModules,i=0;i<r.length;i++)r[i].drawFramework&&r[i].drawFramework(n);return t.syncOrAsync([e.layoutStyles,nt,p.init],n)}function g(){var e=n.calcdata,i,u,t;for(f.getComponentMethod("legend","draw")(n),f.getComponentMethod("rangeselector","draw")(n),f.getComponentMethod("updatemenus","draw")(n),f.getComponentMethod("sliders","draw")(n),i=0;i<e.length;i++)u=e[i],t=u[0].trace,t.visible===!0&&t._module.colorbar?t._module.colorbar(n,u):r.autoMargin(n,"cb"+t.uid);return r.doAutoMargin(n),r.previousPromises(n)}function it(){var i=JSON.stringify(v._size)===d?[]:[g,e.layoutStyles];return i=i.concat(p.init),t.syncOrAsync(i,n)}function rt(){var e,o,h,s,i,u;if(b){for(e=r.getSubplotIds(v,"cartesian"),o=v._modules,i=0;i<e.length;i++)for(h=v._plots[e[i]],u=0;u<o.length;u++)s=o[u],s.setPositions&&s.setPositions(n,h);return et.calc(n),t.syncOrAsync([f.getComponentMethod("shapes","calcAutorange"),f.getComponentMethod("annotations","calcAutorange"),ut],n)}}function ut(){var r,t;if(!n._transitioning)for(r=i.Axes.list(n,"",!0),t=0;t<r.length;t++)i.Axes.doAutoRange(r[t])}function nt(){return i.Axes.doTicks(n,"redraw")}function ot(){for(var s=n.calcdata,e,o,t=0;t<s.length;t++){var i=s[t][0].trace,h=i.visible===!0,u=i.uid;h&&f.traceIs(i,"2dMap")||v._paper.selectAll(".hm"+u+",.contour"+u+",#clip"+u).remove();h&&i._module.colorbar||v._infolayer.selectAll(".cb"+u).remove()}for(e=v._basePlotModules,t=0;t<e.length;t++)e[t].plot(n);return o=v._paper.selectAll(".layer-subplot"),v._imageSubplotLayer=o.selectAll(".imagelayer"),v._shapeSubplotLayer=o.selectAll(".shapelayer"),r.style(n),f.getComponentMethod("shapes","draw")(n),f.getComponentMethod("annoations","draw")(n),r.addLinks(n),n._replotting=!1,r.previousPromises(n)}function st(){f.getComponentMethod("shapes","draw")(n);f.getComponentMethod("images","draw")(n);f.getComponentMethod("annotations","draw")(n);f.getComponentMethod("legend","draw")(n);f.getComponentMethod("rangeslider","draw")(n);f.getComponentMethod("rangeselector","draw")(n);f.getComponentMethod("updatemenus","draw")(n);f.getComponentMethod("sliders","draw")(n)}function lt(){n.emit("plotly_afterplot")}var k,y,v,b,w,d;if(n=u.getGraphDiv(n),a.init(n),k=a.triggerHandler(n,"plotly_beforeplot",[o,h,c]),k===!1)return Promise.reject();if(o||h||t.isPlotDiv(n)||t.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",n),ht(n,c),h||(h={}),s.select(n).classed("js-plotly-plot",!0),ft.makeTester(n),n._promises=[],y=(n.data||[]).length===0&&Array.isArray(o),Array.isArray(o)&&(u.cleanData(o,n.data),y?n.data=o:n.data.push.apply(n.data,o),n.empty=!1),(!n.layout||y)&&(n.layout=u.cleanLayout(h)),n._dragging&&!n._transitioning)return n._replotPending=!0,Promise.reject();if(n._replotPending=!1,r.supplyDefaults(n),o&&o[0]&&o[0].r)return ct(n,o,h);for(n._replotting=!0,y&&l(n),n.framework!==l&&(n.framework=l,l(n)),y&&i.Axes.saveRangeInitial(n),v=n._fullLayout,b=!n.calcdata||n.calcdata.length!==(n._fullData||[]).length,b&&r.doCalcdata(n),w=0;w<n.calcdata.length;w++)n.calcdata[w][0].trace=n._fullData[w];return d=JSON.stringify(v._size),t.syncOrAsync([r.previousPromises,tt,g,it,rt,e.layoutStyles,nt,ot,st],n,lt),Promise.all(n._promises).then(function(){return n})};i.redraw=function(n){if(n=u.getGraphDiv(n),!t.isPlotDiv(n))throw new Error("This element is not a Plotly plot: "+n);return u.cleanData(n.data,n.data),u.cleanLayout(n.layout),n.calcdata=undefined,i.plot(n).then(function(){return n.emit("plotly_redraw"),n})};i.newPlot=function(n,t,f,e){return n=u.getGraphDiv(n),r.cleanPlot([],{},n._fullData||{},n._fullLayout||{}),r.purge(n),i.plot(n,t,f,e)};i.extendTraces=function yt(n,t,r,f){n=u.getGraphDiv(n);var e=d(n,t,r,f,function(n,t){return n.concat(t)},function(n,t){return n.splice(0,n.length-t)}),s=i.redraw(n),h=[n,e.update,r,e.maxPoints];return o.add(n,i.prependTraces,h,yt,arguments),s};i.prependTraces=function pt(n,t,r,f){n=u.getGraphDiv(n);var e=d(n,t,r,f,function(n,t){return t.concat(n)},function(n,t){return n.splice(t,n.length)}),s=i.redraw(n),h=[n,e.update,r,e.maxPoints];return o.add(n,i.extendTraces,h,pt,arguments),s};i.addTraces=function wt(n,t,r){n=u.getGraphDiv(n);var e=[],h=i.deleteTraces,c=wt,l=[n,e],a=[n,t],f,s;for(lt(n,t,r),Array.isArray(t)||(t=[t]),u.cleanData(t,n.data),f=0;f<t.length;f+=1)n.data.push(t[f]);for(f=0;f<t.length;f++)e.push(-t.length+f);if(typeof r=="undefined")return s=i.redraw(n),o.add(n,h,l,c,a),s;Array.isArray(r)||(r=[r]);try{k(n,e,r)}catch(v){n.data.splice(n.data.length-t.length,t.length);throw v;}return o.startSequence(n),o.add(n,h,l,c,a),s=i.moveTraces(n,e,r),o.stopSequence(n),s};i.deleteTraces=function bt(n,r){var l;n=u.getGraphDiv(n);var e=[],a=i.addTraces,v=bt,y=[n,e,r],p=[n,r],f,s;if(typeof r=="undefined")throw new Error("indices must be an integer or array of integers.");else Array.isArray(r)||(r=[r]);for(c(n,r,"indices"),r=h(r,n.data.length-1),r.sort(t.sorterDes),f=0;f<r.length;f+=1)s=n.data.splice(r[f],1)[0],e.push(s);return l=i.redraw(n),o.add(n,a,y,v,p),l};i.moveTraces=function g(n,t,r){var c;n=u.getGraphDiv(n);var s=[],e=[],l=g,a=g,v=[n,r,t],y=[n,t,r],f;if(k(n,t,r),t=Array.isArray(t)?t:[t],typeof r=="undefined")for(r=[],f=0;f<t.length;f++)r.push(-t.length+f);for(r=Array.isArray(r)?r:[r],t=h(t,n.data.length-1),r=h(r,n.data.length-1),f=0;f<n.data.length;f++)t.indexOf(f)===-1&&s.push(n.data[f]);for(f=0;f<t.length;f++)e.push({newIndex:r[f],trace:n.data[t[f]]});for(e.sort(function(n,t){return n.newIndex-t.newIndex}),f=0;f<e.length;f+=1)s.splice(e[f].newIndex,0,e[f].trace);return n.data=s,c=i.redraw(n),o.add(n,l,v,a,y),c};i.restyle=function nt(n,f,s,h){var a,c,v,l,y;if(n=u.getGraphDiv(n),u.clearPromiseQueue(n),a={},typeof f=="string")a[f]=s;else if(t.isPlainObject(f))a=f,h===undefined&&(h=s);else return t.warn("Restyle fail.",f,s,h),Promise.reject();return Object.keys(a).length&&(n.changed=!0),c=tt(n,a,h),v=c.flags,v.clearCalc&&(n.calcdata=undefined),l=[],v.fullReplot?l.push(i.plot):(l.push(r.previousPromises),r.supplyDefaults(n),v.dostyle&&l.push(e.doTraceStyle),v.docolorbars&&l.push(e.doColorBars)),o.add(n,nt,[n,c.undoit,c.traces],nt,[n,c.redoit,c.traces]),y=t.syncOrAsync(l,n),y&&y.then||(y=Promise.resolve()),y.then(function(){return n.emit("plotly_restyle",c.eventData),n})};i.relayout=function it(n,i,f){var c,l,h,s,a;if(n=u.getGraphDiv(n),u.clearPromiseQueue(n),n.framework&&n.framework.isPolar)return Promise.resolve(n);if(c={},typeof i=="string")c[i]=f;else if(t.isPlainObject(i))c=i;else return t.warn("Relayout fail.",i,f),Promise.reject();return Object.keys(c).length&&(n.changed=!0),l=rt(n,c),h=l.flags,h.docalc&&(n.calcdata=undefined),s=[],h.layoutReplot?s.push(e.layoutReplot):Object.keys(c).length&&(s.push(r.previousPromises),r.supplyDefaults(n),h.dolegend&&s.push(e.doLegend),h.dolayoutstyle&&s.push(e.layoutStyles),h.doticks&&s.push(e.doTicksRelayout),h.domodebar&&s.push(e.doModeBar)),o.add(n,it,[n,l.undoit],it,[n,l.redoit]),a=t.syncOrAsync(s,n),a&&a.then||(a=Promise.resolve(n)),a.then(function(){return n.emit("plotly_relayout",l.eventData),n})};i.update=function ut(n,f,s,h){var c,w,b,y;if(n=u.getGraphDiv(n),u.clearPromiseQueue(n),n.framework&&n.framework.isPolar)return Promise.resolve(n);t.isPlainObject(f)||(f={});t.isPlainObject(s)||(s={});Object.keys(f).length&&(n.changed=!0);Object.keys(s).length&&(n.changed=!0);var a=tt(n,f,h),v=a.flags,p=rt(n,s),l=p.flags;return(v.clearCalc||l.docalc)&&(n.calcdata=undefined),c=[],v.fullReplot&&l.layoutReplot?(w=n.data,b=n.layout,n.data=undefined,n.layout=undefined,c.push(function(){return i.plot(n,w,b)})):v.fullReplot?c.push(i.plot):l.layoutReplot?c.push(e.layoutReplot):(c.push(r.previousPromises),r.supplyDefaults(n),v.dostyle&&c.push(e.doTraceStyle),v.docolorbars&&c.push(e.doColorBars),l.dolegend&&c.push(e.doLegend),l.dolayoutstyle&&c.push(e.layoutStyles),l.doticks&&c.push(e.doTicksRelayout),l.domodebar&&c.push(e.doModeBar)),o.add(n,ut,[n,a.undoit,p.undoit,a.traces],ut,[n,a.redoit,p.redoit,a.traces]),y=t.syncOrAsync(c,n),y&&y.then||(y=Promise.resolve(n)),y.then(function(){return n.emit("plotly_update",{data:a.eventData,layout:p.eventData}),n})};i.animate=function(n,i,f){function h(n){return Array.isArray(o)?n>=o.length?o[0]:o[n]:o}function c(n){return Array.isArray(s)?n>=s.length?s[0]:s[n]:s}var e,o,s;if(n=u.getGraphDiv(n),!t.isPlotDiv(n))throw new Error("This element is not a Plotly plot: "+n);return e=n._transitionData,e._frameQueue||(e._frameQueue=[]),f=r.supplyAnimationDefaults(f),o=f.transition,s=f.frame,e._frameWaitingCnt===undefined&&(e._frameWaitingCnt=0),new Promise(function(s,l){function g(){if(e._frameQueue.length!==0){while(e._frameQueue.length){var t=e._frameQueue.pop();t.onInterrupt&&t.onInterrupt()}n.emit("plotly_animationinterrupted",[])}}function nt(t){var i,v,a,u,o;if(t.length!==0){for(i=0;i<t.length;i++)v=t[i].type==="byname"?r.computeFrame(n,t[i].name):t[i].data,a=c(i),u=h(i),u.duration=Math.min(u.duration,a.duration),o={frame:v,name:t[i].name,frameOpts:a,transitionOpts:u},i===t.length-1&&(o.onComplete=s,o.onInterrupt=l),e._frameQueue.push(o);f.mode==="immediate"&&(e._lastFrameAt=-Infinity);e._animationRaf||rt()}}function tt(){n.emit("plotly_animated");window.cancelAnimationFrame(e._animationRaf);e._animationRaf=null}function it(){e._currentFrame&&e._currentFrame.onComplete&&(e._currentFrame.onComplete(),e._currentFrame.onComplete=null);var t=e._currentFrame=e._frameQueue.shift();t?(n.emit("plotly_animatingframe",{name:t.name,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}}),e._lastFrameAt=Date.now(),e._timeToNext=t.frameOpts.duration,r.transition(n,t.frame.data,t.frame.layout,u.coerceTraceIndices(n,t.frame.traces),t.frameOpts,t.transitionOpts)):tt()}function rt(){n.emit("plotly_animating");e._lastFrameAt=-Infinity;e._timeToNext=0;e._runningTransitions=0;e._currentFrame=null;var t=function(){e._animationRaf=window.requestAnimationFrame(t);Date.now()-e._lastFrameAt>e._timeToNext&&it()};t()}function w(n){return n.transitionOpts=Array.isArray(o)?b>=o.length?o[b]:o[0]:o,b++,n}var b=0,a,v,y=[],k=i===undefined||i===null,d=Array.isArray(i),ut=!k&&!d&&t.isPlainObject(i),p;if(ut)y.push({type:"object",data:w(t.extendFlat({},i))});else if(k||typeof i=="string")for(a=0;a<e._frames.length;a++)v=e._frames[a],(k||v.group===i)&&y.push({type:"byname",name:v.name,data:w({name:v.name})});else if(d)for(a=0;a<i.length;a++)p=i[a],typeof p=="string"?y.push({type:"byname",name:p,data:w({name:p})}):y.push({type:"object",data:w(t.extendFlat({},p))});for(a=0;a<y.length;a++)if(v=y[a],v.type==="byname"&&!e._frameHash[v.data.name]){t.warn('animate failure: frame not found: "'+v.data.name+'"');l();return}["next","immediate"].indexOf(f.mode)!==-1&&g();y.length>0?nt(y):(n.emit("plotly_animated"),s())})};i.addFrames=function(n,i,f){var e,s,h,v,c,y,w,l;if(n=u.getGraphDiv(n),i===null||i===undefined)return Promise.resolve();if(!t.isPlotDiv(n))throw new Error("This element is not a Plotly plot: "+n);if(c=n._transitionData._frames,y=n._transitionData._frameHash,!Array.isArray(i))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+i);for(w=c.length+i.length*2,l=[],e=i.length-1;e>=0;e--)l.push({frame:r.supplyFrameDefaults(i[e]),index:f&&f[e]!==undefined&&f[e]!==null?f[e]:w+e});l.sort(function(n,t){return n.index>t.index?-1:n.index<t.index?1:0});var a=[],p=[],b=c.length;for(e=l.length-1;e>=0;e--){if(s=l[e].frame,!s.name)while(y[s.name="frame "+n._transitionData._counter++]);if(y[s.name]){for(h=0;h<c.length;h++)if(c[h].name===s.name)break;a.push({type:"replace",index:h,value:s});p.unshift({type:"replace",index:h,value:c[h]})}else v=Math.max(0,Math.min(l[e].index,b)),a.push({type:"insert",index:v,value:s}),p.unshift({type:"delete",index:v}),b++}var k=r.modifyFrames,d=r.modifyFrames,g=[n,p],nt=[n,a];return o&&o.add(n,k,g,d,nt),r.modifyFrames(n,a)};i.deleteFrames=function(n,i){if(n=u.getGraphDiv(n),!t.isPlotDiv(n))throw new Error("This element is not a Plotly plot: "+n);var f,e,c=n._transitionData._frames,s=[],h=[];for(i=i.slice(0),i.sort(),f=i.length-1;f>=0;f--)e=i[f],s.push({type:"delete",index:e}),h.unshift({type:"insert",index:e,value:c[e]});var l=r.modifyFrames,a=r.modifyFrames,v=[n,h],y=[n,s];return o&&o.add(n,l,v,a,y),r.modifyFrames(n,s)};i.purge=function(n){n=u.getGraphDiv(n);var t=n._fullLayout||{},i=n._fullData||[];return r.cleanPlot([],{},i,t),r.purge(n),a.purge(n),t._container&&t._container.remove(),delete n._context,delete n._replotPending,delete n._mouseDownTime,delete n._hmpixcount,delete n._hmlumcount,n}},{"../components/drawing":605,"../components/errorbars":611,"../constants/xmlns_namespaces":666,"../lib":681,"../lib/events":672,"../lib/queue":689,"../lib/svg_text_utils":695,"../plotly":706,"../plots/cartesian/graph_interact":717,"../plots/plots":769,"../plots/polar":772,"../registry":784,"./helpers":697,"./subroutines":703,d3:129,"fast-isnumeric":133}],699:[function(n,t){"use strict";function i(n,i){try{n._fullLayout._paper.style("background",i)}catch(r){t.exports.logging>0&&console.error(r)}}t.exports={staticPlot:!1,editable:!1,queueLength:0,autosizable:!1,fillFrame:!1,frameMargins:0,scrollZoom:!1,doubleClick:"reset+autosize",showTips:!0,showLink:!1,sendData:!0,linkText:"Edit chart",showSources:!1,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:!1,displaylogo:!0,plotGlPixelRatio:2,setBackground:i,topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:!1,globalTransforms:[]}},{}],700:[function(n,t){"use strict";function g(n){var s=v.attributes,r=l({type:n}),y=rt(n),e=ft(n),t={},i={};t.type=null;c(t,s);t=f(r.attributes,t,"attributes",n);e.attributes!==undefined&&c(t,e.attributes);t.type=n;t=a(t);o(t);u.traces[n]=h({},y,{attributes:t});r.layoutAttributes!==undefined&&(i=f(r.layoutAttributes,i,"layoutAttributes",n),o(i),u.traces[n].layoutAttributes=i)}function nt(){var t=v.layoutAttributes,n={};n=f(t,n,"layoutAttributes","*");n=ut(n);n=et(n);n=a(n);o(n);p(n);u.layout={layoutAttributes:n}}function tt(n){var i=r.transformsRegistry[n],t={};t=f(t,i.attributes||{},"attributes","*");t=a(t);o(t);p(t);u.transforms[n]={attributes:t}}function it(){u.defs={valObjects:i.valObjects,metaKeys:i.UNDERSCORE_ATTRS.concat(["description","role"])}}function f(n,t,r,u){var o,h,a,s,e;return Object.keys(n).forEach(function(v){if(v===k){Object.keys(n[v]).forEach(function(e){(o=l({_module:n[v][e]}),o!==undefined)&&(h=o[r],a=f(h,{},r,u),i.nestedProperty(t,e).set(c({},a)))});return}if(v===d){Object.keys(n[v]).forEach(function(i){i===u&&(s=l({_module:n[v][i]}),s!==undefined)&&(e=s[r],e=f(e,{},r,u),y(t,e))});return}t[v]=i.isPlainObject(n[v])?y({},n[v]):n[v]}),t}function o(n){function t(){return{valType:"string"}}function r(n,r,u){e.isValObject(n)?n.valType==="data_array"?(n.role="data",u[r+"src"]=t(r)):n.arrayOk===!0&&(u[r+"src"]=t(r)):i.isPlainObject(n)&&(n.role="object")}i.crawl(n,r)}function l(n){if("type"in n)return n.type==="area"?{attributes:b}:r.getModule({type:n.type});var i=r.subplotsRegistry,u=r.componentsRegistry,t=n._module;return i[t]?i[t]:u[t]?u[t]:w[t]}function a(n){return Object.keys(n).forEach(function(t){t.charAt(0)==="_"&&i.UNDERSCORE_ATTRS.indexOf(t)===-1&&delete n[t]}),n}function rt(n){return n==="area"?{}:r.modules[n].meta||{}}function ut(n){return h(n,{radialaxis:s.radialaxis,angularaxis:s.angularaxis}),h(n,s.layout),n}function ft(n){if(n==="area")return{};var t=r.subplotsRegistry,i=Object.keys(t).filter(function(t){return r.traceIs({type:n},t)})[0];return i===undefined?{}:t[i]}function et(n){var t=r.subplotsRegistry;return Object.keys(n).forEach(function(r){Object.keys(t).forEach(function(u){var f=t[u],e;f.attrRegex&&(e=u==="cartesian"||u==="gl2d"?f.attrRegex.x.test(r)||f.attrRegex.y.test(r):f.attrRegex.test(r),e&&(n[r][i.IS_SUBPLOT_OBJ]=!0))})}),n}function p(n){function t(n,t,r){if(n[i.IS_LINKED_TO_ARRAY]===!0){var u=t.substr(0,t.length-1);delete n[i.IS_LINKED_TO_ARRAY];r[t]={items:{}};r[t].items[u]=n;r[t].role="object"}}i.crawl(n,t)}var w=n("../plotly"),r=n("../registry"),v=n("../plots/plots"),i=n("../lib"),b=n("../plots/polar/area_attributes"),s=n("../plots/polar/axis_attributes"),h=i.extendFlat,c=i.extendDeep,y=i.extendDeepAll,k="_nestedModules",d="_composedModules",u={traces:{},layout:{},transforms:{},defs:{}},e=t.exports={};e.get=function(){return r.allTypes.concat("area").forEach(g),nt(),Object.keys(r.transformsRegistry).forEach(tt),it(),u};e.crawl=i.crawl;e.isValObject=i.isValObject},{"../lib":681,"../plotly":706,"../plots/plots":769,"../plots/polar/area_attributes":770,"../plots/polar/axis_attributes":771,"../registry":784}],701:[function(n,t){"use strict";function u(n){i.register(n,n.name,n.categories,n.meta);i.subplotsRegistry[n.basePlotModule.name]||i.registerSubplot(n.basePlotModule)}function f(n){if(typeof n.name!="string")throw new Error("Transform module *name* must be a string.");var t="Transform module "+n.name,u=typeof n.transform=="function",f=typeof n.calcTransform=="function";if(!u&&!f)throw new Error(t+" is missing a *transform* or *calcTransform* method.");u&&f&&r.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "));r.isPlainObject(n.attributes)||r.log(t+" registered without an *attributes* object.");typeof n.supplyDefaults!="function"&&r.log(t+" registered without a *supplyDefaults* method.");i.transformsRegistry[n.name]=n}function e(n){i.componentsRegistry[n.name]=n}var i=n("../registry"),r=n("../lib");t.exports=function(n){var i,t;if(n)n&&!Array.isArray(n)&&(n=[n]);else throw new Error("No argument passed to Plotly.register.");for(i=0;i<n.length;i++){if(t=n[i],!t)throw new Error("Invalid module was attempted to be registered!");switch(t.moduleType){case"trace":u(t);break;case"transform":f(t);break;case"component":e(t);break;default:throw new Error("Invalid module was attempted to be registered!");}}}},{"../lib":681,"../registry":784}],702:[function(n,t){"use strict";var i=n("../plotly"),r=n("../lib");t.exports=function(n){return r.extendFlat(i.defaultConfig,n)}},{"../lib":681,"../plotly":706}],703:[function(n,t,i){"use strict";var u=n("../plotly"),e=n("../registry"),r=n("../plots/plots"),s=n("../lib"),o=n("../components/color"),f=n("../components/drawing"),c=n("../components/titles"),h=n("../components/modebar");i.layoutStyles=function(n){return s.syncOrAsync([r.doAutoMargin,i.lsInner],n)};i.lsInner=function(n){for(var r=n._fullLayout,t=r._size,l=u.Axes.list(n),e,c=0;c<l.length;c++)l[c]._linepositions={};return r._paperdiv.style({width:r.width+"px",height:r.height+"px"}).selectAll(".main-svg").call(f.setSize,r.width,r.height),n._context.setBackground(n,r.paper_bgcolor),e=[],r._paper.selectAll("g.subplot").each(function(i){var l=r._plots[i],h=u.Axes.getFromId(n,i,"x"),c=u.Axes.getFromId(n,i,"y"),nt;h.setScale();c.setScale();l.bg&&l.bg.call(f.setRect,h._offset-t.p,c._offset-t.p,h._length+2*t.p,c._length+2*t.p).call(o.fill,r.plot_bgcolor);l.clipId="clip"+r._uid+i+"plot";nt=r._defs.selectAll("g.clips").selectAll("#"+l.clipId).data([0]);nt.enter().append("clipPath").attr({"class":"plotclip",id:l.clipId}).append("rect");nt.selectAll("rect").attr({width:h._length,height:c._length});l.plot.call(s.setTranslate,h._offset,c._offset);l.plot.call(f.setClipUrl,l.clipId);var a=f.crispRound(n,h.linewidth,1),v=f.crispRound(n,c.linewidth,1),ct=t.p+v,tt="M"+-ct+",",it="h"+(h._length+2*ct),y=h.anchor==="free"&&e.indexOf(h._id)===-1,rt=t.h*(1-(h.position||0))+a/2%1,ut=h.anchor===c._id&&(h.mirror||h.side!=="top")||h.mirror==="all"||h.mirror==="allticks"||h.mirrors&&h.mirrors[c._id+"bottom"],b=c._length+t.p+a/2,ft=h.anchor===c._id&&(h.mirror||h.side==="top")||h.mirror==="all"||h.mirror==="allticks"||h.mirrors&&h.mirrors[c._id+"top"],k=-t.p-a/2,lt=t.p,pt=ut?0:a,at=ft?0:a,et=","+(-lt-at)+"v"+(c._length+2*lt+at+pt),p=c.anchor==="free"&&e.indexOf(c._id)===-1,ot=t.w*(c.position||0)+v/2%1,vt=c.anchor===h._id&&(c.mirror||c.side!=="right")||c.mirror==="all"||c.mirror==="allticks"||c.mirrors&&c.mirrors[h._id+"left"],d=-t.p-v/2,yt=c.anchor===h._id&&(c.mirror||c.side==="right")||c.mirror==="all"||c.mirror==="allticks"||c.mirrors&&c.mirrors[h._id+"right"],g=h._length+t.p+v/2;h._linepositions[i]=[ut?b:undefined,ft?k:undefined,y?rt:undefined];h.anchor===c._id?h._linepositions[i][3]=h.side==="top"?k:b:y&&(h._linepositions[i][3]=rt);c._linepositions[i]=[vt?d:undefined,yt?g:undefined,p?ot:undefined];c.anchor===h._id?c._linepositions[i][3]=c.side==="right"?g:d:p&&(c._linepositions[i][3]=ot);var w="translate("+h._offset+","+c._offset+")",st=w,ht=w;y&&(st="translate("+h._offset+","+t.t+")",k+=c._offset-t.t,b+=c._offset-t.t);p&&(ht="translate("+t.l+","+c._offset+")",d+=h._offset-t.l,g+=h._offset-t.l);l.xlines.attr("transform",st).attr("d",(ut?tt+b+it:"")+(ft?tt+k+it:"")+(y?tt+rt+it:"")||"M0,0").style("stroke-width",a+"px").call(o.stroke,h.showline?h.linecolor:"rgba(0,0,0,0)");l.ylines.attr("transform",ht).attr("d",(vt?"M"+d+et:"")+(yt?"M"+g+et:"")+(p?"M"+ot+et:"")||"M0,0").attr("stroke-width",v+"px").call(o.stroke,c.showline?c.linecolor:"rgba(0,0,0,0)");l.xaxislayer.attr("transform",st);l.yaxislayer.attr("transform",ht);l.gridlayer.attr("transform",w);l.zerolinelayer.attr("transform",w);l.draglayer.attr("transform",w);y&&e.push(h._id);p&&e.push(c._id)}),u.Axes.makeClipPaths(n),i.drawMainTitle(n),h.manage(n),n._promises.length&&Promise.all(n._promises)};i.drawMainTitle=function(n){var t=n._fullLayout;c.draw(n,"gtitle",{propContainer:t,propName:"title",dfltName:"Plot",attributes:{x:t.width/2,y:t._size.t/2,"text-anchor":"middle"}})};i.doTraceStyle=function(n){for(var t=0;t<n.calcdata.length;t++){var i=n.calcdata[t],f=((i[0]||{}).trace||{})._module||{},u=f.arraysToCalcdata;u&&u(i)}return r.style(n),e.getComponentMethod("legend","draw")(n),r.previousPromises(n)};i.doColorBars=function(n){for(var f,t,i,u=0;u<n.calcdata.length;u++)f=n.calcdata[u][0],(f.t||{}).cb&&(t=f.trace,i=f.t.cb,e.traceIs(t,"contour")&&i.line({width:t.contours.showlines!==!1?t.line.width:0,dash:t.line.dash,color:t.contours.coloring==="line"?i._opts.line.color:t.line.color}),e.traceIs(t,"markerColorscale")?i.options(t.marker.colorbar)():i.options(t.colorbar)());return r.previousPromises(n)};i.layoutReplot=function(n){var t=n.layout;return n.layout=undefined,u.plot(n,"",t)};i.doLegend=function(n){return e.getComponentMethod("legend","draw")(n),r.previousPromises(n)};i.doTicksRelayout=function(n){return u.Axes.doTicks(n,"redraw"),i.drawMainTitle(n),r.previousPromises(n)};i.doModeBar=function(n){var i=n._fullLayout,f,t,e,o,s;for(h.manage(n),u.Fx.supplyLayoutDefaults(n.layout,n._fullLayout,n._fullData),u.Fx.init(n),f=r.getSubplotIds(i,"gl3d"),t=0;t<f.length;t++)e=i[f[t]]._scene,e.updateFx(i.dragmode,i.hovermode);for(f=r.getSubplotIds(i,"gl2d"),t=0;t<f.length;t++)o=i._plots[f[t]]._scene2d,o.updateFx(i);for(f=r.getSubplotIds(i,"geo"),t=0;t<f.length;t++)s=i[f[t]]._subplot,s.updateFx(i.hovermode);return r.previousPromises(n)}},{"../components/color":582,"../components/drawing":605,"../components/modebar":628,"../components/titles":656,"../lib":681,"../plotly":706,"../plots/plots":769,"../registry":784}],704:[function(n,t){"use strict";function h(n,t){return new Promise(function(h,c){function p(){var n=i.getDelay(l._fullLayout);return new Promise(function(i,r){setTimeout(function(){var u=o(l),n=document.createElement("canvas");n.id=f.randstr();s({format:t.format,width:l._fullLayout.width,height:l._fullLayout.height,canvas:n,svg:u,promise:!0}).then(function(n){l&&document.body.removeChild(l);i(n)}).catch(function(n){r(n)})},n)})}var v,a,l,y;t=t||{};t.format=t.format||"png";v=function(n){return n===undefined||n===null?!0:r(n)&&n>1?!0:!1};v(t.width)&&v(t.height)||c(new Error("Height and width should be pixel values."));a=e(n,{format:"png",height:t.height,width:t.width});l=a.td;l.style.position="absolute";l.style.left="-5000px";document.body.appendChild(l);y=i.getRedrawFunc(l);u.plot(l,a.data,a.layout,a.config).then(y).then(p).then(function(n){h(n)}).catch(function(n){c(n)})})}var r=n("fast-isnumeric"),u=n("../plotly"),f=n("../lib"),i=n("../snapshot/helpers"),e=n("../snapshot/cloneplot"),o=n("../snapshot/tosvg"),s=n("../snapshot/svgtoimg");t.exports=h},{"../lib":681,"../plotly":706,"../snapshot/cloneplot":785,"../snapshot/helpers":788,"../snapshot/svgtoimg":790,"../snapshot/tosvg":792,"fast-isnumeric":133}],705:[function(n,t){"use strict";function e(n,t,o,s,h,c){var tt,nt,p,w,ut,it,a,k,ft,g;for(c=c||[],tt=Object.keys(n),nt=0;nt<tt.length;nt++)if(p=tt[nt],p!=="transforms"){w=c.slice();w.push(p);var l=n[p],b=t[p],d=y(o,p),rt=(d||{}).valType==="info_array";if(v(o,p))if(r(l)&&r(b))e(l,b,d,s,h,w);else if(d.items&&!rt&&u(l)){for(ut=p.substr(0,p.length-1),it=[],a=0;a<b.length;a++)ft=d.items[ut],g=b[a]._index||a,k=w.slice(),k.push(g),r(l[g])&&r(b[a])&&(it.push(g),e(l[g],b[a],ft,s,h,k));for(a=0;a<l.length;a++)k=w.slice(),k.push(a),r(l[a])?it.indexOf(a)===-1&&s.push(i("unused",h,k)):s.push(i("object",h,k,l[a]))}else!r(l)&&r(b)?s.push(i("object",h,w,l)):u(l)||!u(b)||rt?p in t?f.validate(l,d)||s.push(i("value",h,w,l)):s.push(i("unused",h,w,l)):s.push(i("array",h,w,l));else s.push(i("schema",h,w))}return s}function a(n,t){for(var u,r,i=0;i<t.length;i++)u=t[i].type,r=n.traces[u].layoutAttributes,r&&f.extendFlat(n.layout.layoutAttributes,r);return n.layout.layoutAttributes}function o(n){return u(n)?"In data trace "+n[1]+", ":"In "+n+", "}function i(n,t,i,r){var e,o,h,c;return i=i||"",u(t)?(e=t[0],o=t[1]):(e=t,o=null),h=p(i),c=s[n](t,h,r),f.log(c),{code:n,container:e,trace:o,path:i,astr:h,msg:c}}function v(n,t){var i=h(t),r=i.keyMinusId,u=i.id;return r in n&&n[r]._isSubplotObj&&u?!0:t in n}function y(n,t){var i=h(t);return n[i.keyMinusId]}function h(n){var t=n.split(/([2-9]|[1-9][0-9]+)$/)[0],i=n.substr(t.length,n.length);return{keyMinusId:t,id:i}}function p(n){var t,i,r;if(!u(n))return String(n);for(t="",i=0;i<n.length;i++)r=n[i],typeof r=="number"?t=t.substr(0,t.length-1)+"["+r+"]":t+=r,i<n.length-1&&(t+=".");return t}var f=n("../lib"),c=n("../plots/plots"),l=n("./plot_schema"),r=f.isPlainObject,u=Array.isArray,s;t.exports=function(n,t){var w=l.get(),o=[],v={},k,g,nt,ut,p,b,s,y,ot,h,tt,it,rt,st,ht;for(u(n)?(v.data=f.extendDeep([],n),k=n):(v.data=[],k=[],o.push(i("array","data"))),r(t)?(v.layout=f.extendDeep({},t),g=t):(v.layout={},g={},arguments.length>1&&o.push(i("object","layout"))),c.supplyDefaults(v),nt=v._fullData,ut=k.length,p=0;p<ut;p++){if(b=k[p],s=["data",p],!r(b)){o.push(i("object",s));continue}var d=nt[p],ft=d.type,et=w.traces[ft].attributes;if(et.type={valType:"enumerated",values:[ft]},d.visible===!1&&b.visible!==!1&&o.push(i("invisible",s)),e(b,d,et,o,s),y=b.transforms,ot=d.transforms,y)for(u(y)||o.push(i("array",s,["transforms"])),s.push("transforms"),h=0;h<y.length;h++){if(tt=["transforms",h],it=y[h].type,!r(y[h])){o.push(i("object",s,tt));continue}rt=w.transforms[it]?w.transforms[it].attributes:{};rt.type={valType:"enumerated",values:Object.keys(w.transforms)};e(y[h],ot[h],rt,o,s,tt)}}return st=v._fullLayout,ht=a(w,nt),e(g,st,ht,o,"layout"),o.length===0?void 0:o};s={object:function(n,t){var i;return i=n==="layout"&&t===""?"The layout argument":n[0]==="data"&&t===""?"Trace "+n[1]+" in the data argument":o(n)+"key "+t,i+" must be linked to an object container"},array:function(n,t){var i;return i=n==="data"?"The data argument":o(n)+"key "+t,i+" must be linked to an array container"},schema:function(n,t){return o(n)+"key "+t+" is not part of the schema"},unused:function(n,t,i){var u=r(i)?"container":"key";return o(n)+u+" "+t+" did not get coerced"},invisible:function(n){return"Trace "+n[1]+" got defaulted to be not visible"},value:function(n,t,i){return[o(n)+"key "+t,"is set to an invalid value ("+i+")"].join(" ")}}},{"../lib":681,"../plots/plots":769,"./plot_schema":700}],706:[function(n,t,i){"use strict";i.defaultConfig=n("./plot_api/plot_config");i.Plots=n("./plots/plots");i.Axes=n("./plots/cartesian/axes");i.Fx=n("./plots/cartesian/graph_interact");i.Color=n("./components/color");i.Drawing=n("./components/drawing");i.Colorscale=n("./components/colorscale");i.Colorbar=n("./components/colorbar");i.ErrorBars=n("./components/errorbars");i.Annotations=n("./components/annotations");i.Shapes=n("./components/shapes");i.Legend=n("./components/legend");i.Images=n("./components/images");i.UpdateMenus=n("./components/updatemenus");i.Sliders=n("./components/sliders");i.ModeBar=n("./components/modebar");n("./plot_api/plot_api")},{"./components/annotations":580,"./components/color":582,"./components/colorbar":587,"./components/colorscale":596,"./components/drawing":605,"./components/errorbars":611,"./components/images":617,"./components/legend":625,"./components/modebar":628,"./components/shapes":649,"./components/sliders":655,"./components/updatemenus":661,"./plot_api/plot_api":698,"./plot_api/plot_config":699,"./plots/cartesian/axes":710,"./plots/cartesian/graph_interact":717,"./plots/plots":769}],707:[function(n,t){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}}},{}],708:[function(n,t){"use strict";t.exports={type:{valType:"enumerated",values:[],dflt:"scatter"},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0},showlegend:{valType:"boolean",dflt:!0},legendgroup:{valType:"string",dflt:""},opacity:{valType:"number",min:0,max:1,dflt:1},name:{valType:"string"},uid:{valType:"string",dflt:""},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],dflt:"all"},stream:{token:{valType:"string",noBlank:!0,strict:!0},maxpoints:{valType:"number",min:0,max:1e4,dflt:500}}}},{}],709:[function(n,t){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x"},yaxis:{valType:"subplotid",dflt:"y"}}},{}],710:[function(n,t){"use strict";function st(n){var r=n.tickvals,e=n.ticktext,o=new Array(r.length),s=n.range[0]*1.0001-n.range[1]*.0001,h=n.range[1]*1.0001-n.range[0]*.0001,c=Math.min(s,h),l=Math.max(s,h),u,t,f=0;for(Array.isArray(e)||(e=[]),t=0;t<r.length;t++)u=n.d2l(r[t]),u>c&&u<l&&(o[f]=e[t]===undefined?i.tickText(n,u):ut(n,u,String(e[t])),f++);return f<r.length&&o.splice(f,r.length-f),o}function o(n,t,i){return t*r.roundUp(n/t,i)}function nt(n){var t=n.dtick,r,i;n._tickexponent=0;f(t)||typeof t=="string"||(t=1);n.type==="category"?n._tickround=null:f(t)||t.charAt(0)==="L"?n.type==="date"?n._tickround=t>=864e5?"d":t>=36e5?"H":t>=6e4?"M":t>=1e3?"S":3-Math.round(Math.log(t/2)/Math.LN10):(f(t)||(t=Number(t.substr(1))),n._tickround=2-Math.floor(Math.log(t)/Math.LN10+.01),r=n.type==="log"?Math.pow(10,Math.max(n.range[0],n.range[1])):Math.max(Math.abs(n.range[0]),Math.abs(n.range[1])),i=Math.floor(Math.log(r)/Math.LN10+.01),Math.abs(i)>3&&(n._tickexponent=n.exponentformat==="SI"||n.exponentformat==="B"?3*Math.round((i-1)/3):i)):n._tickround=t.charAt(0)==="M"?t.length===2?"m":"y":null}function rt(n,t){var i=n.match(it),r=new Date(t),f,e;return i?(f=Math.min(+i[1]||6,6),e=String(t/1e3%1+2.0000005).substr(2,f).replace(/0+$/,"")||"0",u.time.format(n.replace(it,e))(r)):u.time.format(n)(r)}function ut(n,t,i){var r=n.tickfont||n._gd._fullLayout.font;return{x:t,dx:0,dy:0,text:i||"",fontSize:r.size,font:r.family,fontColor:r.color}}function yt(n,t,i,r){var s=t.x,u=n._tickround,o=new Date(s),c="",e;i&&n.hoverformat?e=rt(n.hoverformat,s):n.tickformat?e=rt(n.tickformat,s):(r&&(f(u)?u+=2:u={y:"m",m:"d",d:"H",H:"M",M:"S",S:2}[u]),u==="y"?e=p(o):u==="m"?e=ct(o):(s!==n._tmin||i||(c="<br>"+p(o)),u==="d"?e=tt(o):u==="H"?e=lt(o):(s!==n._tmin||i||(c="<br>"+tt(o)+", "+p(o)),e=at(o),u!=="M"&&(e+=vt(o),u!=="S"&&(e+=a(h(s/1e3,1),n,"none",i).substr(1))))));t.text=e+c}function pt(n,t,i,r,u){var e=n.dtick,o=t.x,s,c;if(r&&(typeof e!="string"||e.charAt(0)!=="L")&&(e="L3"),n.tickformat||typeof e=="string"&&e.charAt(0)==="L")t.text=a(Math.pow(10,o),n,u,r);else if(f(e)||e.charAt(0)==="D"&&h(o+.01,1)<.1)["e","E","power"].indexOf(n.exponentformat)!==-1?(s=Math.round(o),t.text=s===0?1:s===1?"10":s>1?"10<sup>"+s+"<\/sup>":"10<sup>−"+-s+"<\/sup>",t.fontSize*=1.25):(t.text=a(Math.pow(10,o),n,"","fakehover"),e==="D1"&&n._id.charAt(0)==="y"&&(t.dy-=t.fontSize/6));else if(e.charAt(0)==="D")t.text=String(Math.round(Math.pow(10,h(o,1)))),t.fontSize*=.75;else throw"unrecognized dtick "+String(e);n.dtick==="D1"&&(c=String(t.text).charAt(0),(c==="0"||c==="1")&&(n._id.charAt(0)==="y"?t.dx-=t.fontSize/4:(t.dy+=t.fontSize/2,t.dx+=(n.range[1]>n.range[0]?1:-1)*t.fontSize*(o<0?.5:.25))))}function wt(n,t){var i=n._categories[Math.round(t.x)];i===undefined&&(i="");t.text=String(i)}function bt(n,t,i,r,u){n.showexponent==="all"&&Math.abs(t.x/n.dtick)<1e-6&&(u="hide");t.text=a(t.x,n,u,r)}function a(n,t,i,e){var w=n<0,h=t._tickround,s=i||t.exponentformat||"B",o=t._tickexponent,a=t.tickformat,b=t.separatethousands,c,v,y,p,l;if(e&&(c={exponentformat:t.exponentformat,dtick:t.showexponent==="none"?t.dtick:f(n)?Math.abs(n)||1:1,range:t.showexponent==="none"?t.range:[0,n||1]},nt(c),h=(Number(c._tickround)||0)+4,o=c._tickexponent,t.hoverformat&&(a=t.hoverformat)),a)return u.format(a)(n).replace(/-/g,"−");if(v=Math.pow(10,-h)/2,s==="none"&&(o=0),n=Math.abs(n),n<v)n="0",w=!1;else{if(n+=v,o&&(n*=Math.pow(10,-o),h+=o),h===0)n=String(Math.floor(n));else if(h<0)for(n=String(Math.round(n)),n=n.substr(0,n.length+h),y=h;y<0;y++)n+="0";else n=String(n),p=n.indexOf(".")+1,p&&(n=n.substr(0,p+h).replace(/\.?0+$/,""));n=r.numSeparate(n,t._gd._fullLayout.separators,b)}return(o&&s!=="hide"&&(l=o<0?"−"+-o:s!=="power"?"+"+o:String(o),s==="e"||(s==="SI"||s==="B")&&(o>12||o<-15)?n+="e"+l:s==="E"?n+="E"+l:s==="power"?n+="×10<sup>"+l+"<\/sup>":s==="B"&&o===9?n+="B":(s==="SI"||s==="B")&&(n+=ft[o/3+5])),w)?"−"+n:n}function kt(n,t){for(var r=[],i,e,h,f=0;f<t.length;f++){var u=[],o=n._fullData[t[f]].xaxis,s=n._fullData[t[f]].yaxis;if(o&&s){for(i=0;i<r.length;i++)(r[i].x.indexOf(o)!==-1||r[i].y.indexOf(s)!==-1)&&u.push(i);if(!u.length){r.push({x:[o],y:[s]});continue}if(e=r[u[0]],u.length>1)for(i=1;i<u.length;i++)h=r[u[i]],v(e.x,h.x),v(e.y,h.y);v(e.x,[o]);v(e.y,[s])}}return r}function v(n,t){for(var i=0;i<t.length;i++)n.indexOf(t[i])===-1&&n.push(t[i])}function dt(n,t,u){for(var o,s=[],h=[],l=n.layout,y,w,b,f=0;f<t.length;f++)s.push(i.getFromId(n,t[f]));for(f=0;f<u.length;f++)h.push(i.getFromId(n,u[f]));var k=Object.keys(s[0]),nt=["anchor","domain","overlaying","position","side","tickangle"],a=["linear","log"];for(f=0;f<k.length;f++){var e=k[f],v=s[0][e],p=h[0][e],c=!0,d=!1,g=!1;if(e.charAt(0)!=="_"&&typeof v!="function"&&nt.indexOf(e)===-1){for(o=1;o<s.length&&c;o++)y=s[o][e],e==="type"&&a.indexOf(v)!==-1&&a.indexOf(y)!==-1&&v!==y?d=!0:y!==v&&(c=!1);for(o=1;o<h.length&&c;o++)w=h[o][e],e==="type"&&a.indexOf(p)!==-1&&a.indexOf(w)!==-1&&p!==w?g=!0:h[o][e]!==p&&(c=!1);c&&(d&&(l[s[0]._name].type="linear"),g&&(l[h[0]._name].type="linear"),gt(l,e,s,h))}}for(f=0;f<n._fullLayout.annotations.length;f++)b=n._fullLayout.annotations[f],t.indexOf(b.xref)!==-1&&u.indexOf(b.yref)!==-1&&r.swapAttrs(l.annotations[f],["?"])}function gt(n,t,i,u){var e=r.nestedProperty,o=e(n[i[0]._name],t).get(),s=e(n[u[0]._name],t).get(),f;for(t==="title"&&(o==="Click to enter X axis title"&&(o="Click to enter Y axis title"),s==="Click to enter Y axis title"&&(s="Click to enter X axis title")),f=0;f<i.length;f++)e(n,i[f]._name+"."+t).set(s);for(f=0;f<u.length;f++)e(n,u[f]._name+"."+t).set(o)}function h(n,t){return(n%t+t)%t}var u=n("d3"),f=n("fast-isnumeric"),y=n("../../registry"),r=n("../../lib"),et=n("../../lib/svg_text_utils"),ot=n("../../components/titles"),c=n("../../components/color"),s=n("../../components/drawing"),i=t.exports={},e,w,ft;i.layoutAttributes=n("./layout_attributes");i.supplyLayoutDefaults=n("./layout_defaults");i.setConvert=n("./set_convert");e=n("./axis_ids");i.id2name=e.id2name;i.cleanId=e.cleanId;i.list=e.list;i.listIds=e.listIds;i.getFromId=e.getFromId;i.getFromTrace=e.getFromTrace;i.coerceRef=function(n,t,u,f,e){var o=u._fullLayout._has("gl2d")?[]:i.listIds(u,f),s=f+"ref",h={};return h[s]={valType:"enumerated",values:o.concat(["paper"]),dflt:e||o[0]||"paper"},r.coerce(n,t,h,s)};i.coerceARef=function(n,t,u,f,e){var o=u._fullLayout._has("gl2d")?[]:i.listIds(u,f),s="a"+f+"ref",h={};return h[s]={valType:"enumerated",values:o.concat(["pixel"]),dflt:e||"pixel"||o[0]},r.coerce(n,t,h,s)};i.clearTypes=function(n,t){Array.isArray(t)&&t.length||(t=n._fullData.map(function(n,t){return t}));t.forEach(function(t){var r=n.data[t];delete(i.getFromId(n,r.xaxis)||{}).type;delete(i.getFromId(n,r.yaxis)||{}).type})};i.counterLetter=function(n){var t=n.charAt(0);return t==="x"?"y":t==="y"?"x":void 0};i.minDtick=function(n,t,i,r){["log","category"].indexOf(n.type)===-1&&r?n._minDtick===null?(n._minDtick=t,n._forceTick0=i):n._minDtick&&((n._minDtick/t+1e-6)%1<2e-6&&((i-n._forceTick0)/t%1+1.000001)%1<2e-6?(n._minDtick=t,n._forceTick0=i):((t/n._minDtick+1e-6)%1>2e-6||((i-n._forceTick0)/n._minDtick%1+1.000001)%1>2e-6)&&(n._minDtick=0)):n._minDtick=0};i.getAutoRange=function(n){for(var t=[],f=n._min[0].val,o=n._max[0].val,s,h,c,r,u,l,a,e,p,v,y,i=1;i<n._min.length;i++){if(f!==o)break;f=Math.min(f,n._min[i].val)}for(i=1;i<n._max.length;i++){if(f!==o)break;o=Math.max(o,n._max[i].val)}for(e=0,p=n.range&&n.range[1]<n.range[0],n.autorange==="reversed"&&(p=!0,n.autorange=!0),i=0;i<n._min.length;i++)for(h=n._min[i],s=0;s<n._max.length;s++)c=n._max[s],a=c.val-h.val,l=n._length-h.pad-c.pad,a>0&&l>0&&a/l>e&&(r=h,u=c,e=a/l);return f===o?(v=f-1,y=f+1,t=n.rangemode==="tozero"?f<0?[v,0]:[0,y]:n.rangemode==="nonnegative"?[Math.max(0,v),Math.max(0,y)]:[v,y]):e&&((n.type==="linear"||n.type==="-")&&(n.rangemode==="tozero"?(r.val>=0&&(r={val:0,pad:0}),u.val<=0&&(u={val:0,pad:0})):n.rangemode==="nonnegative"&&(r.val-e*r.pad<0&&(r={val:0,pad:0}),u.val<0&&(u={val:1,pad:0})),e=(u.val-r.val)/(n._length-r.pad-u.pad)),t=[r.val-e*r.pad,u.val+e*u.pad]),t[0]===t[1]&&(n.rangemode==="tozero"?t=t[0]<0?[t[0],0]:t[0]>0?[0,t[0]]:[0,1]:(t=[t[0]-1,t[0]+1],n.rangemode==="nonnegative"&&(t[0]=Math.max(0,t[0])))),p&&t.reverse(),t};i.doAutoRange=function(n){var r,t;n._length||n.setScale();r=n._min&&n._max&&n._min.length&&n._max.length;n.autorange&&r&&(n.range=i.getAutoRange(n),t=n._gd.layout[n._name],t||(n._gd.layout[n._name]=t={}),t!==n&&(t.range=n.range.slice(),t.autorange=n.autorange))};i.saveRangeInitial=function(n,t){for(var f=i.list(n,"",!0),e=!1,u=0;u<f.length;u++){var r=f[u],o=r._rangeInitial===undefined,s=o||!(r.range[0]===r._rangeInitial[0]&&r.range[1]===r._rangeInitial[1]);(o&&r.autorange===!1||t&&s)&&(r._rangeInitial=r.range.slice(),e=!0)}return e};w=Number.MAX_VALUE/2;i.expand=function(n,t,i){function p(n){if(Array.isArray(n))return function(t){return Math.max(Number(n[t]||0),0)};var t=Math.max(Number(n||0),0);return function(){return t}}function d(i){function e(n){return f(n)&&Math.abs(n)<w}if(c=t[i],f(c)){if(l=nt(i)+k,a=tt(i)+k,v=c-rt(i),y=c+it(i),n.type==="log"&&v<y/10&&(v=y/10),o=n.c2l(v),s=n.c2l(y),b&&(o=Math.min(0,o),s=Math.max(0,s)),e(o)){for(h=!0,r=0;r<n._min.length&&h;r++)u=n._min[r],u.val<=o&&u.pad>=a?h=!1:u.val>=o&&u.pad<=a&&(n._min.splice(r,1),r--);h&&n._min.push({val:o,pad:b&&o===0?0:a})}if(e(s)){for(h=!0,r=0;r<n._max.length&&h;r++)u=n._max[r],u.val>=s&&u.pad>=l?h=!1:u.val<=s&&u.pad<=l&&(n._max.splice(r,1),r--);h&&n._max.push({val:s,pad:b&&s===0?0:l})}}}if((n.autorange||n._needsExpand)&&t){n._min||(n._min=[]);n._max||(n._max=[]);i||(i={});n._m||n.setScale();var g=t.length,k=i.padded?n._length*.05:0,b=i.tozero&&(n.type==="linear"||n.type==="-"),e,r,u,c,o,s,l,a,h,v,y;var nt=p((n._m>0?i.ppadplus:i.ppadminus)||i.ppad||0),tt=p((n._m>0?i.ppadminus:i.ppadplus)||i.ppad||0),it=p(i.vpadplus||i.vpad),rt=p(i.vpadminus||i.vpad);for(e=0;e<6;e++)d(e);for(e=g-1;e>5;e--)d(e)}};i.autoBin=function(n,t,u,e){function v(n){return(1+(n-s)*100/o.dtick)%100<2}var c=r.aggNums(Math.min,null,n),l=r.aggNums(Math.max,null,n),w,o,s,a,h,y,p,it;if(t.type==="category")return{start:c-.5,end:l+.5,size:1};if(u)w=(l-c)/u;else{var b=r.distinctVals(n),k=Math.pow(10,Math.floor(Math.log(b.minDiff)/Math.LN10)),rt=k*r.roundUp(b.minDiff/k,[.9,1.9,4.9,9.9],!0);w=Math.max(rt,2*r.stdev(n)/Math.pow(n.length,e?.25:.4))}if(o={type:t.type==="log"?"linear":t.type,range:[c,l]},i.autoTicks(o,w),s=i.tickIncrement(i.tickFirst(o),o.dtick,"reverse"),typeof o.dtick=="number"){var d=0,g=0,nt=0,tt=0;for(h=0;h<n.length;h++)n[h]%1==0?nt++:f(n[h])||tt++,v(n[h])&&d++,v(n[h]+o.dtick/2)&&g++;y=n.length-tt;nt===y&&t.type!=="date"?o.dtick<1?s=c-.5*o.dtick:s-=.5:g<y*.1&&(d>y*.3||v(c)||v(l))&&(p=o.dtick/2,s+=s+p<c?p:-p);it=1+Math.floor((l-s)/o.dtick);a=s+it*o.dtick}else for(a=s;a<=l;)a=i.tickIncrement(a,o.dtick);return{start:s,end:a,size:o.dtick}};i.calcTicks=function(n){var f,s,u,c,o;if(n.tickmode==="array")return st(n);n.tickmode!=="auto"&&n.dtick||(f=n.nticks,f||(n.type==="category"?(s=n.tickfont?(n.tickfont.size||12)*1.2:15,f=n._length/s):(s=n._id.charAt(0)==="y"?40:80,f=r.constrain(n._length/s,4,9)+1)),i.autoTicks(n,Math.abs(n.range[1]-n.range[0])/f),n._minDtick>0&&n.dtick<n._minDtick*2&&(n.dtick=n._minDtick,n.tick0=n._forceTick0));n.tick0||(n.tick0=n.type==="date"?new Date(2e3,0,1).getTime():0);nt(n);n._tmin=i.tickFirst(n);var h=n.range[1]<n.range[0],t=[],e=n.range[1]*1.0001-n.range[0]*.0001;for(n.type==="category"&&(e=h?Math.max(-.5,e):Math.min(n._categories.length-.5,e)),u=n._tmin;h?u>=e:u<=e;u=i.tickIncrement(u,n.dtick,h))if(t.push(u),t.length>1e3)break;for(n._tmax=t[t.length-1],c=new Array(t.length),o=0;o<t.length;o++)c[o]=i.tickText(n,t[o]);return c};var l=[2,5,10],b=[1,2,3,6,12],k=[1,2,5,10,15,30],ht=[1,2,3,7,14],d=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],g=[-.301,0,.301,.699,1];i.autoTicks=function(n,t){var i,r,u;if(n.type==="date"?(n.tick0=new Date(2e3,0,1).getTime(),t>157788e5?(t/=315576e5,i=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n.dtick="M"+12*o(t,i,l)):t>12096e5?(t/=26298e5,n.dtick="M"+o(t,1,b)):t>432e5?(n.dtick=o(t,864e5,ht),n.tick0=new Date(2e3,0,2).getTime()):t>18e5?n.dtick=o(t,36e5,b):t>3e4?n.dtick=o(t,6e4,k):t>500?n.dtick=o(t,1e3,k):(i=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n.dtick=o(t,i,l))):n.type==="log"?(n.tick0=0,t>.7?n.dtick=Math.ceil(t):Math.abs(n.range[1]-n.range[0])<1?(r=1.5*Math.abs((n.range[1]-n.range[0])/t),t=Math.abs(Math.pow(10,n.range[1])-Math.pow(10,n.range[0]))/r,i=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n.dtick="L"+o(t,i,l)):n.dtick=t>.3?"D2":"D1"):n.type==="category"?(n.tick0=0,n.dtick=Math.ceil(Math.max(t,1))):(n.tick0=0,i=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n.dtick=o(t,i,l)),n.dtick===0&&(n.dtick=1),!f(n.dtick)&&typeof n.dtick!="string"){u=n.dtick;n.dtick=1;throw"ax.dtick error: "+String(u);}};i.tickIncrement=function(n,t,i){var o=i?-1:1,e,s,c;if(f(t))return n+o*t;if(e=t.charAt(0),s=o*Number(t.substr(1)),e==="M")return c=new Date(n),c.setMonth(c.getMonth()+s);if(e==="L")return Math.log(Math.pow(10,n)+s)/Math.LN10;if(e==="D"){var a=t==="D2"?g:d,l=n+o*.01,v=r.roundUp(h(l,1),a,i);return Math.floor(l)+Math.log(u.round(Math.pow(10,v),1))/Math.LN10}throw"unrecognized dtick "+String(t);};i.tickFirst=function(n){var s=n.range[1]<n.range[0],p=s?Math.floor:Math.ceil,t=n.range[0]*1.0001-n.range[1]*.0001,e=n.dtick,c=n.tick0,v,y,l,a,w,o,b,k;if(f(e))return v=p((t-c)/e)*e+c,n.type==="category"&&(v=r.constrain(v,0,n._categories.length-1)),v;if(y=e.charAt(0),l=Number(e.substr(1)),y==="M"){for(a=new Date(c),t=new Date(t),w=(t.getFullYear()-a.getFullYear())*12+t.getMonth()-a.getMonth(),o=a.setMonth(a.getMonth()+(Math.round(w/l)+(s?1:-1))*l);s?o>t:o<t;)o=i.tickIncrement(o,e,s);return o}if(y==="L")return Math.log(p((Math.pow(10,t)-c)/l)*l+c)/Math.LN10;if(y==="D")return b=e==="D2"?g:d,k=r.roundUp(h(t,1),b,s),Math.floor(t)+Math.log(u.round(Math.pow(10,k),1))/Math.LN10;throw"unrecognized dtick "+String(e);};var p=u.time.format("%Y"),ct=u.time.format("%b %Y"),tt=u.time.format("%b %-d"),lt=u.time.format("%b %-d %Hh"),at=u.time.format("%H:%M"),vt=u.time.format(":%S"),it=/%(\d?)f/g;i.tickText=function(n,t,i){function o(r){var u;return r===undefined?!0:i?r==="none":(u={first:n._tmin,last:n._tmax}[r],r!=="all"&&t!==u)}var r=ut(n,t),f,s=n.tickmode==="array",e=i||s,u,h;if(s&&Array.isArray(n.ticktext)){for(h=Math.abs(n.range[1]-n.range[0])/1e4,u=0;u<n.ticktext.length;u++)if(Math.abs(t-n.d2l(n.tickvals[u]))<h)break;if(u<n.ticktext.length)return r.text=String(n.ticktext[u]),r}return f=n.exponentformat!=="none"&&o(n.showexponent)?"hide":"",n.type==="date"?yt(n,r,i,e):n.type==="log"?pt(n,r,i,e,f):n.type==="category"?wt(n,r):bt(n,r,i,e,f),n.tickprefix&&!o(n.showtickprefix)&&(r.text=n.tickprefix+r.text),n.ticksuffix&&!o(n.showticksuffix)&&(r.text+=n.ticksuffix),r};ft=["f","p","n","μ","m","","k","M","G","T"];i.subplotMatch=/^x([0-9]*)y([0-9]*)$/;i.getSubplots=function(n,t){function d(n,t){return n.indexOf(t._id)!==-1}for(var f=[],h,u,v=n.data||[],e,p,w,l,c,s,r=0;r<v.length;r++)(e=v[r],e.visible!==!1&&e.visible!=="legendonly"&&(y.traceIs(e,"cartesian")||y.traceIs(e,"gl2d")))&&(p=e.xaxis||"x",w=e.yaxis||"y",u=p+w,f.indexOf(u)===-1&&f.push(u));for(l=i.list(n,"",!0),r=0;r<l.length;r++){var o=l[r],b=o._id.charAt(0),g=o.anchor==="free"?b==="x"?"y":"x":o.anchor,a=i.getFromId(n,g),k=!1;for(h=0;h<f.length;h++)if(d(f[h],o)){k=!0;break}o.anchor==="free"&&k||a&&(u=b==="x"?o._id+a._id:a._id+o._id,f.indexOf(u)===-1&&f.push(u))}for(c=i.subplotMatch,s=[],r=0;r<f.length;r++)u=f[r],c.test(u)&&s.push(u);return(s.sort(function(n,t){var i=n.match(c),r=t.match(c);return i[1]===r[1]?+(i[2]||1)-(r[2]||1):+(i[1]||0)-(r[1]||0)}),t)?i.findSubplotsWithAxis(s,t):s};i.findSubplotsWithAxis=function(n,t){for(var r,f=new RegExp(t._id.charAt(0)==="x"?"^"+t._id+"y":t._id+"$"),u=[],i=0;i<n.length;i++)r=n[i],f.test(r)&&u.push(r);return u};i.makeClipPaths=function(n){for(var f=n._fullLayout,l=f._defs,a={_offset:0,_length:f.width,_id:""},v={_offset:0,_length:f.height,_id:""},s=i.list(n,"x",!0),h=i.list(n,"y",!0),e=[],r,c,o,t=0;t<s.length;t++)for(e.push({x:s[t],y:v}),r=0;r<h.length;r++)t===0&&e.push({x:a,y:h[r]}),e.push({x:s[t],y:h[r]});c=l.selectAll("g.clips").data([0]);c.enter().append("g").classed("clips",!0);o=c.selectAll(".axesclip").data(e,function(n){return n.x._id+n.y._id});o.enter().append("clipPath").classed("axesclip",!0).attr("id",function(n){return"clip"+f._uid+n.x._id+n.y._id}).append("rect");o.exit().remove();o.each(function(n){u.select(this).select("rect").attr({x:n.x._offset||0,y:n.y._offset||0,width:n.x._length||1,height:n.y._length||1})})};i.doTicks=function(n,t,o){function yt(n){var t=h.l2p(n.x);return t>1&&t<h._length-1}function pt(n,t){var i=n.selectAll("path."+g).data(h.ticks==="inside"?st:p,it);t&&h.ticks?(i.enter().append("path").classed(g,1).classed("ticks",1).classed("crisp",1).call(c.stroke,h.tickcolor).style("stroke-width",ti+"px").attr("d",t),i.attr("transform",k),i.exit().remove()):i.remove()}function wt(i,e){function y(n,t){n.each(function(n){var o=ft(t),h=u.select(this),r=h.select(".text-math-group"),c=k(n)+(f(t)&&+t!=0?" rotate("+t+","+d(n)+","+(tt(n)-n.fontSize/2)+")":""),i,e;r.empty()?(i=h.select("text").attr({transform:c,"text-anchor":o}),i.empty()||i.selectAll("tspan.line").attr({x:i.attr("x"),y:i.attr("y")})):(e=s.bBox(r.node()).width*{end:-.5,start:.5}[o],r.attr("transform",c+(e?"translate("+e+",0)":"")))})}function ct(){return st.length&&Promise.all(st)}function lt(){var n,i;if(y(o,h.tickangle),l==="x"&&!f(h.tickangle)&&(h.type!=="log"||String(h.dtick).charAt(0)!=="D")){for(n=[],o.each(function(t){var f=u.select(this),r=f.select(".text-math-group"),e=h.l2p(t.x),i;r.empty()&&(r=f.select("text"));i=s.bBox(r.node());n.push({top:0,bottom:10,height:10,left:e-i.width/2,right:e+i.width/2+2,width:i.width+2})}),a=0;a<n.length-1;a++)if(r.bBoxIntersect(n[a],n[a+1])){v=30;break}v&&(i=Math.abs((p[p.length-1].x-p[0].x)*h._m)/(p.length-1),i<ot*2.5&&(v=90),y(o,v));h._lastangle=v}return bt(t),t+" done"}function at(){h._boundingBox=i.node().getBoundingClientRect()}var o=i.selectAll("g."+g).data(p,it),d,tt,ft,ht,c,b;if(!h.showticklabels||!f(e)){o.remove();bt(t);return}l==="x"?(c=w==="bottom"?1:-1,d=function(n){return n.dx+ut*c},ht=e+(rt+nt)*c,tt=function(n){return n.dy+ht+n.fontSize*(w==="bottom"?1:-.5)},ft=function(n){return!f(n)||n===0||n===180?"middle":n*c<0?"end":"start"}):(c=w==="right"?1:-1,tt=function(n){return n.dy+n.fontSize/2-ut*c},d=function(n){return n.dx+e+(rt+nt+(Math.abs(h.tickangle)===90?n.fontSize/2:0))*c},ft=function(n){return f(n)&&Math.abs(n)===90?"middle":w==="right"?"start":"end"});var ot=0,v=0,st=[];return o.enter().append("g").classed(g,1).append("text").attr("text-anchor","middle").each(function(t){var i=u.select(this),r=n._promises.length;i.call(s.setPosition,d(t),tt(t)).call(s.font,t.font,t.fontSize,t.fontColor).text(t.text).call(et.convertToTspans);r=n._promises[r];r?st.push(n._promises.pop().then(function(){y(i,h.tickangle)})):y(i,h.tickangle)}),o.exit().remove(),o.each(function(n){ot=Math.max(ot,n.fontSize)}),y(o,h._lastangle||h.tickangle),b=r.syncOrAsync([ct,lt,at]),b&&b.then&&n._promises.push(b),b}function bt(t){var a;if(!o){var i=e.getFromId(n,t),y=u.select(n).selectAll("g."+t+"tick"),r={selection:y,side:i.side},w=t.charAt(0),s=n._fullLayout._size,h=1.5,c=i.titlefont.size,b,f,p,l;y.size()&&(a=u.select(y.node().parentNode).attr("transform").match(/translate\(([-\.\d]+),([-\.\d]+)\)/),a&&(r.offsetLeft=+a[1],r.offsetTop=+a[2]));w==="x"?(f=i.anchor==="free"?{_offset:s.t+(1-(i.position||0))*s.h,_length:0}:e.getFromId(n,i.anchor),p=i._offset+i._length/2,l=f._offset+(i.side==="top"?-10-c*(h+(i.showticklabels?1:0)):f._length+10+c*(h+(i.showticklabels?1.5:.5))),i.rangeslider&&i.rangeslider.visible&&i._boundingBox&&(l+=(v.height-v.margin.b-v.margin.t)*i.rangeslider.thickness+i._boundingBox.height),r.side||(r.side="bottom")):(f=i.anchor==="free"?{_offset:s.l+(i.position||0)*s.w,_length:0}:e.getFromId(n,i.anchor),l=i._offset+i._length/2,p=f._offset+(i.side==="right"?f._length+10+c*(h+(i.showticklabels?1:.5)):-10-c*(h+(i.showticklabels?.5:0))),b={rotate:"-90",offset:0},r.side||(r.side="left"));ot.draw(n,t+"title",{propContainer:i,propName:i._name+".title",dfltName:w.toUpperCase()+" axis",avoid:r,transform:b,attributes:{x:p,y:l,"text-anchor":"middle"}})}}function ii(n,t){return n.visible!==!0||n.xaxis+n.yaxis!==t?!1:y.traceIs(n,"bar")&&n.orientation==={x:"h",y:"v"}[l]?!0:n.fill&&n.fill.charAt(n.fill.length-1)===l}function kt(t,i,r){var w=t.gridlayer,a=t.zerolinelayer,v=t["hidegrid"+l]?[]:st,y=h._gridpath||"M0,0"+(l==="x"?"v":"h")+i._length,o=w.selectAll("path."+lt).data(h.showgrid===!1?[]:v,it),s,f,p,e;if(o.enter().append("path").classed(lt,1).classed("crisp",1).attr("d",y).each(function(n){h.zeroline&&(h.type==="linear"||h.type==="-")&&Math.abs(n.x)<h.dtick/100&&u.select(this).remove()}),o.attr("transform",k).call(c.stroke,h.gridcolor||"#ddd").style("stroke-width",vt+"px"),o.exit().remove(),a){for(s=!1,f=0;f<n._fullData.length;f++)if(ii(n._fullData[f],r)){s=!0;break}p=h.range[0]*h.range[1]<=0&&h.zeroline&&(h.type==="linear"||h.type==="-")&&v.length&&(s||yt({x:0})||!h.showline);e=a.selectAll("path."+at).data(p?[{x:0}]:[]);e.enter().append("path").classed(at,1).classed("zl",1).classed("crisp",1).attr("d",y);e.attr("transform",k).call(c.stroke,h.zerolinecolor||c.defaultLine).style("stroke-width",ni+"px");e.exit().remove()}}var v=n._fullLayout,h,ct=!1,ft,w,d,st,dt,ht;if(typeof t=="object")h=t,t=h._id,ct=!0;else if(h=i.getFromId(n,t),t==="redraw"&&v._paper.selectAll("g.subplot").each(function(n){var t=v._plots[n],i=t.xaxis,r=t.yaxis;t.xaxislayer.selectAll("."+i._id+"tick").remove();t.yaxislayer.selectAll("."+r._id+"tick").remove();t.gridlayer.selectAll("path").remove();t.zerolinelayer.selectAll("path").remove()}),!t||t==="redraw")return r.syncOrAsync(i.list(n,"",!0).map(function(r){return function(){if(r._id){var u=i.doTicks(n,r._id);return t==="redraw"&&(r._r=r.range.slice()),u}}}));h.tickformat||(["none","e","E","power","SI","B"].indexOf(h.exponentformat)===-1&&(h.exponentformat="e"),["all","first","last","none"].indexOf(h.showexponent)===-1&&(h.showexponent="all"));h.range=[+h.range[0],+h.range[1]];h.setScale();var l=t.charAt(0),gt=i.counterLetter(t),p=i.calcTicks(h),it=function(n){return n.text+n.x+h.mirror},g=t+"tick",lt=t+"grid",at=t+"zl",nt=(h.linewidth||1)/2,rt=(h.ticks==="outside"?h.ticklen:1)+(h.linewidth||0),ut=0,vt=s.crispRound(n,h.gridwidth,1),ni=s.crispRound(n,h.zerolinewidth,vt),ti=s.crispRound(n,h.tickwidth,1),b,k,tt,a;if(h._counterangle&&h.ticks==="outside"&&(ft=h._counterangle*Math.PI/180,rt=h.ticklen*Math.cos(ft)+(h.linewidth||0),ut=h.ticklen*Math.sin(ft)),l==="x")b=["bottom","top"],k=function(n){return"translate("+h.l2p(n.x)+",0)"},tt=function(n,t){if(h._counterangle){var i=h._counterangle*Math.PI/180;return"M0,"+n+"l"+Math.sin(i)*t+","+Math.cos(i)*t}return"M0,"+n+"v"+t};else if(l==="y")b=["left","right"],k=function(n){return"translate(0,"+h.l2p(n.x)+")"},tt=function(n,t){if(h._counterangle){var i=h._counterangle*Math.PI/180;return"M"+n+",0l"+Math.cos(i)*t+","+-Math.sin(i)*t}return"M"+n+",0h"+t};else{r.warn("Unrecognized doTicks axis:",t);return}return w=h.side||b[0],d=[-1,1,w===b[1]?1:-1],h.ticks!=="inside"==(l==="x")&&(d=d.map(function(n){return-n})),st=p.filter(yt),ct?(pt(h._axislayer,tt(h._pos+nt*d[2],d[2]*h.ticklen)),h._counteraxis&&(dt={gridlayer:h._gridlayer,zerolinelayer:h._zerolinelayer},kt(dt,h._counteraxis)),wt(h._axislayer,h._pos)):(ht=i.getSubplots(n,h).map(function(n){var i=v._plots[n],e;if(v._has("cartesian")){var o=i[l+"axislayer"],r=h._linepositions[n]||[],u=i[gt+"axis"],c=u._id===h.anchor,t=[!1,!1,!1],s="";if(h.mirror==="allticks"?t=[!0,!0,!1]:c&&(h.mirror==="ticks"?t=[!0,!0,!1]:t[b.indexOf(w)]=!0),h.mirrors)for(a=0;a<2;a++)e=h.mirrors[u._id+b[a]],(e==="ticks"||e==="labels")&&(t[a]=!0);return r[2]!==undefined&&(t[2]=!0),t.forEach(function(n,t){var i=r[t],u=d[t];n&&f(i)&&(s+=tt(i+nt*u,u*h.ticklen))}),pt(o,s),kt(i,u,n),wt(o,r[3])}}).filter(function(n){return n&&n.then}),ht.length?Promise.all(ht):0)};i.swap=function(n,t){for(var r=kt(n,t),i=0;i<r.length;i++)dt(n,r[i].x,r[i].y)}},{"../../components/color":582,"../../components/drawing":605,"../../components/titles":656,"../../lib":681,"../../lib/svg_text_utils":695,"../../registry":784,"./axis_ids":712,"./layout_attributes":719,"./layout_defaults":720,"./set_convert":724,d3:129,"fast-isnumeric":133}],711:[function(n,t){"use strict";function d(n,t){var h,i,r,a,c,s,l;if(n.type==="-"&&(h=n._id,i=h.charAt(0),h.indexOf("scene")!==-1&&(h=i),r=g(t,h,i),r)){if(r.type==="histogram"&&i==={v:"y",h:"x"}[r.orientation||"v"]){n.type="linear";return}if(e(r,i)){for(a=f(r),c=[],l=0;l<t.length;l++)(s=t[l],u.traceIs(s,"box")&&(s[i+"axis"]||i)===h)&&(s[a]!==undefined?c.push(s[a][0]):s.name!==undefined?c.push(s.name):c.push("text"));n.type=o(c)}else n.type=o(r[i]||[r[i+"0"]])}}function f(n){return{v:"x",h:"y"}[n.orientation||"v"]}function e(n,t){var i=f(n);return u.traceIs(n,"box")&&t===i&&n[i]===undefined&&n[i+"0"]===undefined}function o(n){return tt(n)?"date":it(n)?"category":nt(n)?"linear":"-"}function g(n,t,i){for(var r,u=0;u<n.length;u++)if(r=n[u],(r[i+"axis"]||i)===t&&(e(r,i)||(r[i]||[]).length||r[i+"0"]))return r}function nt(n){if(!n)return!1;for(var t=0;t<n.length;t++)if(i(n[t]))return!0;return!1}function tt(n){for(var f=0,e=0,o=Math.max(1,(n.length-1)/1e3),t,u=0;u<n.length;u+=o)t=n[Math.round(u)],r.isDateTime(t)&&(f+=1),i(t)&&(e+=1);return f>e*2}function it(n){for(var e=Math.max(1,(n.length-1)/1e3),u=0,f=0,t,r=0;r<n.length;r+=e)t=b(n[Math.round(r)]),i(t)?u++:typeof t=="string"&&t!==""&&t!=="None"&&f++;return f>u*2}var i=n("fast-isnumeric"),s=n("tinycolor2").mix,u=n("../../registry"),r=n("../../lib"),h=n("../../components/color/attributes").lightFraction,c=n("./layout_attributes"),l=n("./tick_value_defaults"),a=n("./tick_mark_defaults"),v=n("./tick_label_defaults"),y=n("./category_order_defaults"),p=n("./set_convert"),w=n("./ordered_categories"),b=n("./clean_datum"),k=n("./axis_ids");t.exports=function(n,t,u,f){function e(i,u){return r.coerce2(n,t,c,i,u)}var nt=f.letter,tt=f.font||{},et="Click to enter "+(f.title||nt.toUpperCase()+" axis")+" title",o,b,it,rt,ut,g;f.name&&(t._name=f.name,t._id=k.name2id(f.name));o=u("type");o==="-"&&(d(t,f.data),t.type==="-"?t.type="linear":o=n.type=t.type);p(t);b=u("color");it=b===n.color?b:tt.color;u("title",et);r.coerceFont(u,"titlefont",{family:tt.family,size:Math.round(tt.size*1.2),color:it});rt=(n.range||[]).length===2&&i(n.range[0])&&i(n.range[1]);ut=u("autorange",!rt);ut&&u("rangemode");g=u("range",[-1,nt==="x"?6:4]);g[0]===g[1]&&(t.range=[g[0]-1,g[0]+1]);r.noneOrAll(n.range,t.range,[0,1]);u("fixedrange");l(n,t,u,o);v(n,t,u,o,f);a(n,t,u,f);y(n,t,u);var ot=e("linecolor",b),st=e("linewidth"),ft=u("showline",!!ot||!!st);ft||(delete t.linecolor,delete t.linewidth);(ft||t.ticks)&&u("mirror");var ht=e("gridcolor",s(b,f.bgColor,h).toRgbString()),ct=e("gridwidth"),lt=u("showgrid",f.showGrid||!!ht||!!ct);lt||(delete t.gridcolor,delete t.gridwidth);var at=e("zerolinecolor",b),vt=e("zerolinewidth"),yt=u("zeroline",f.showGrid||!!at||!!vt);return yt||(delete t.zerolinecolor,delete t.zerolinewidth),t._initialCategories=o==="category"?w(nt,t.categoryorder,t.categoryarray,f.data):[],t}},{"../../components/color/attributes":581,"../../lib":681,"../../registry":784,"./axis_ids":712,"./category_order_defaults":713,"./clean_datum":714,"./layout_attributes":719,"./ordered_categories":721,"./set_convert":724,"./tick_label_defaults":725,"./tick_mark_defaults":726,"./tick_value_defaults":727,"fast-isnumeric":133,tinycolor2:546}],712:[function(n,t,i){"use strict";function u(n,t,i){function h(n,i){for(var r,f=Object.keys(n),e=[],u=0;u<f.length;u++)(r=f[u],t&&r.charAt(0)!==t)||/^[xyz]axis[0-9]*/.test(r)&&e.push(i+r);return e.sort()}var u=n._fullLayout,r,o,f,s;if(!u)return[];if(r=h(u,""),i)return r;for(o=e.getSubplotIds(u,"gl3d")||[],f=0;f<o.length;f++)s=o[f],r=r.concat(h(u[s],s+"."));return r}var f=n("../../registry"),e=n("../plots"),o=n("../../lib"),r=n("./constants");i.id2name=function(n){if(typeof n=="string"&&n.match(r.AX_ID_PATTERN)){var t=n.substr(1);return t==="1"&&(t=""),n.charAt(0)+"axis"+t}};i.name2id=function(n){if(n.match(r.AX_NAME_PATTERN)){var t=n.substr(5);return t==="1"&&(t=""),n.charAt(0)+t}};i.cleanId=function(n,t){if(n.match(r.AX_ID_PATTERN)&&(!t||n.charAt(0)===t)){var i=n.substr(1).replace(/^0+/,"");return i==="1"&&(i=""),n.charAt(0)+i}};i.list=function(n,t,i){return u(n,t,i).map(function(t){return o.nestedProperty(n._fullLayout,t).get()})};i.listIds=function(n,t){return u(n,t,!0).map(i.name2id)};i.getFromId=function(n,t,r){var u=n._fullLayout;return r==="x"?t=t.replace(/y[0-9]*/,""):r==="y"&&(t=t.replace(/x[0-9]*/,"")),u[i.id2name(t)]};i.getFromTrace=function(n,t,r){var o=n._fullLayout,u=null,e;return f.traceIs(t,"gl3d")?(e=t.scene,e.substr(0,5)==="scene"&&(u=o[e][r+"axis"])):u=i.getFromId(n,t[r+"axis"]||r),u}},{"../../lib":681,"../../registry":784,"../plots":769,"./constants":715}],713:[function(n,t){"use strict";t.exports=function(n,t,i){var r,e,u,f;t.type==="category"&&(r=n.categoryarray,u=Array.isArray(r)&&r.length>0,u&&(e="array"),f=i("categoryorder",e),f==="array"&&i("categoryarray"),u||f!=="array"||(t.categoryorder="trace"))}},{}],714:[function(n,t){"use strict";var r=n("fast-isnumeric"),i=n("../../lib");t.exports=function(n){try{if(typeof n=="object"&&n!==null&&n.getTime)return i.ms2DateTime(n);if(typeof n!="string"&&!r(n))return"";n=n.toString().replace(/['"%,$# ]/g,"")}catch(t){i.error(t,n)}return n}},{"../../lib":681,"fast-isnumeric":133}],715:[function(n,t){"use strict";t.exports={idRegex:{x:/^x([2-9]|[1-9][0-9]+)?$/,y:/^y([2-9]|[1-9][0-9]+)?$/},attrRegex:{x:/^xaxis([2-9]|[1-9][0-9]+)?$/,y:/^yaxis([2-9]|[1-9][0-9]+)?$/},BADNUM:undefined,xAxisMatch:/^xaxis[0-9]*$/,yAxisMatch:/^yaxis[0-9]*$/,AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,DBLCLICKDELAY:300,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,MAXDIST:20,YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,BENDPX:1.5,REDRAWDELAY:50}},{}],716:[function(n,t){"use strict";function d(n,t){var u=n.range[t],e=Math.abs(u-n.range[1-t]),f;return n.type==="date"?i.ms2DateTime(u,e):n.type==="log"?(f=Math.ceil(Math.max(0,-Math.log(e)/Math.LN10))+3,r.format("."+f+"g")(Math.pow(10,u))):(f=Math.floor(Math.log(Math.abs(u))/Math.LN10)-Math.floor(Math.log(e)/Math.LN10)+4,r.format("."+String(f)+"g")(u))}function h(n,t){return n?n==="nsew"?t==="pan"?"move":"crosshair":n.toLowerCase()+"-resize":"pointer"}function c(n){r.select(n).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function l(n){return["lasso","select"].indexOf(n)!==-1}var r=n("d3"),a=n("tinycolor2"),u=n("../../plotly"),f=n("../../registry"),i=n("../../lib"),v=n("../../lib/svg_text_utils"),o=n("../../components/color"),y=n("../../components/drawing"),p=n("../../lib/setcursor"),w=n("../../components/dragelement"),b=n("./axes"),k=n("./select"),e=n("./constants"),s=!0;t.exports=function(n,t,r,g,nt,tt,it,rt){function ii(n,t){for(var i=0;i<n.length;i++)if(!n[i].fixedrange)return t;return""}function nr(n){n[0]=Number(n[0]);n[1]=Number(n[1])}function tr(){var n,i,r;for(ft=[t.xaxis],et=[t.yaxis],at=ft[0]._length,ht=et[0]._length,n=1;n<dt.length;n++)i=dt[n].xaxis,r=dt[n].yaxis,ft.indexOf(i)===-1&&ft.push(i),et.indexOf(r)===-1&&et.push(r);ni=ft.concat(et);ot=ii(ft,rt);st=ii(et,it);di=h(st+ot,lt.dragmode);hi=t.xaxis._offset;ci=t.yaxis._offset;pt.xa=ft;pt.ya=et}function er(t,i,r){var f=yt.getBoundingClientRect(),u;for(bt=i-f.left,kt=r-f.top,ut={l:bt,r:bt,w:0,t:kt,b:kt,h:0},li=n._hmpixcount?n._hmlumcount/n._hmpixcount:a(n._fullLayout.plot_bgcolor).getLuminance(),ai="M0,0H"+at+"V"+ht+"H0V0",vi=!1,wt="xy",yi=si.append("path").attr("class","zoombox").style({fill:li>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+hi+", "+ci+")").attr("d",ai+"Z"),gt=si.append("path").attr("class","zoombox-corners").style({fill:o.background,stroke:o.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+hi+", "+ci+")").attr("d","M0,0Z"),ir(),u=0;u<ni.length;u++)nr(ni[u].range)}function ir(){si.selectAll(".select-outline").remove()}function or(t,i){if(n._transitioningWithDuration)return!1;var f=Math.max(0,Math.min(at,t+bt)),e=Math.max(0,Math.min(ht,i+kt)),u=Math.abs(f-bt),o=Math.abs(e-kt),r=Math.floor(Math.min(o,u,vt)/2);ut.l=Math.min(bt,f);ut.r=Math.max(bt,f);ut.t=Math.min(kt,e);ut.b=Math.max(kt,e);!st||o<Math.min(Math.max(u*.6,fi),vt)?u<fi?(wt="",ut.r=ut.l,ut.t=ut.b,gt.attr("d","M0,0Z")):(ut.t=0,ut.b=ht,wt="x",gt.attr("d","M"+(ut.l-.5)+","+(kt-vt-.5)+"h-3v"+(2*vt+1)+"h3ZM"+(ut.r+.5)+","+(kt-vt-.5)+"h3v"+(2*vt+1)+"h-3Z")):!ot||u<Math.min(o*.6,vt)?(ut.l=0,ut.r=at,wt="y",gt.attr("d","M"+(bt-vt-.5)+","+(ut.t-.5)+"v-3h"+(2*vt+1)+"v3ZM"+(bt-vt-.5)+","+(ut.b+.5)+"v3h"+(2*vt+1)+"v-3Z")):(wt="xy",gt.attr("d","M"+(ut.l-3.5)+","+(ut.t-.5+r)+"h3v"+-r+"h"+r+"v-3h-"+(r+3)+"ZM"+(ut.r+3.5)+","+(ut.t-.5+r)+"h-3v"+-r+"h"+-r+"v-3h"+(r+3)+"ZM"+(ut.r+3.5)+","+(ut.b+.5-r)+"h-3v"+r+"h"+-r+"v3h"+(r+3)+"ZM"+(ut.l-3.5)+","+(ut.b+.5-r)+"h3v"+r+"h"+r+"v3h-"+(r+3)+"Z"));ut.w=ut.r-ut.l;ut.h=ut.b-ut.t;yi.attr("d",ai+"M"+ut.l+","+ut.t+"v"+ut.h+"h"+ut.w+"v-"+ut.h+"h-"+ut.w+"Z");vi||(yi.transition().style("fill",li>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),gt.transition().style("opacity",1).duration(200),vi=!0)}function rr(n,t,i){for(var f,r,u=0;u<n.length;u++)(f=n[u],f.fixedrange)||(r=f.range,f.range=[r[0]+(r[1]-r[0])*t,r[0]+(r[1]-r[0])*i])}function sr(t,r){if(Math.min(ut.h,ut.w)<fi*2)return r===2&&wi(),c(n);(wt==="xy"||wt==="x")&&rr(ft,ut.l/at,ut.r/at);(wt==="xy"||wt==="y")&&rr(et,(ht-ut.b)/ht,(ht-ut.t)/ht);c(n);bi(wt);s&&n.data&&n._context.showTips&&(i.notifier("Double-click to<br>zoom back out","long"),s=!1)}function hr(t,i){var e=(it+rt).length===1;if(t)bi();else if(i!==2||e){if(i===1&&e){var r=it?et[0]:ft[0],o=it==="s"||rt==="w"?0:1,h=r._name+".range["+o+"]",c=d(r,o),f="left",s="middle";if(r.fixedrange)return;it?(s=it==="n"?"top":"bottom",r.side==="right"&&(f="right")):rt==="e"&&(f="right");ri.call(v.makeEditable,null,{immediate:!0,background:lt.paper_bgcolor,text:String(c),fill:r.tickfont?r.tickfont.color:"#444",horizontalAlign:f,verticalAlign:s}).on("edit",function(t){var i=r.type==="category"?r.c2l(t):r.d2l(t);i!==undefined&&u.relayout(n,h,i)})}}else wi()}function fr(t){function c(n,t,i){if(!n.fixedrange){nr(n.range);var r=n.range,u=r[0]+(r[1]-r[0])*t;n.range=[u+(r[0]-u)*i,u+(r[1]-u)*i]}}var u,f;if(n._context.scrollZoom||lt._enablescrollzoom){if(n._transitioningWithDuration)return i.pauseEvent(t);if(u=n.querySelector(".plotly"),tr(),!(u.scrollHeight-u.clientHeight>10)&&!(u.scrollWidth-u.clientWidth>10)){if(clearTimeout(ur),f=-t.deltaY,isFinite(f)||(f=t.wheelDelta/10),!isFinite(f)){i.log("Did not find wheel motion attributes: ",t);return}var e=Math.exp(-Math.min(Math.max(f,-20),20)/100),o=lr.draglayer.select(".nsewdrag").node().getBoundingClientRect(),s=(t.clientX-o.left)/o.width,l=ct[0]+ct[2]*s,h=(o.bottom-t.clientY)/o.height,a=ct[1]+ct[3]*(1-h),r;if(rt){for(r=0;r<ft.length;r++)c(ft[r],s,e);ct[2]*=e;ct[0]=l-ct[2]*s}if(it){for(r=0;r<et.length;r++)c(et[r],h,e);ct[3]*=e;ct[1]=a-ct[3]*(1-h)}return ui(ct),pi(it,rt),ur=setTimeout(function(){ct=[0,0,at,ht];bi()},cr),i.pauseEvent(t)}}}function ar(t,i){function u(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i.fixedrange||(i.range=[i._r[0]-t/i._m,i._r[1]-t/i._m])}function f(n){return 1-(n>=0?Math.min(n,.9):1/(1/Math.max(n,-.3)+3.222))}function r(n,t,i){for(var r,o=1-t,u=0,e=0;e<n.length;e++)(r=n[e],r.fixedrange)||(u=e,r.range[t]=r._r[o]+(r._r[t]-r._r[o])/f(i/r._length));return n[u]._length*(n[u]._r[t]-n[u].range[t])/(n[u]._r[t]-n[u]._r[o])}if(!n._transitioningWithDuration){if(tr(),ot==="ew"||st==="ns"){ot&&u(ft,t);st&&u(et,i);ui([ot?-t:0,st?-i:0,at,ht]);pi(st,ot);return}ot==="w"?t=r(ft,0,t):ot==="e"?t=r(ft,1,-t):ot||(t=0);st==="n"?i=r(et,1,i):st==="s"?i=r(et,0,-i):st||(i=0);ui([ot==="w"?t:0,st==="n"?i:0,at-t,ht-i]);pi(st,ot)}}function pi(t,i){function o(n){for(r=0;r<n.length;r++)n[r].fixedrange||u.push(n[r]._id)}function e(f,e){for(r=0;r<f.length;r++){var o=f[r];(i&&u.indexOf(o.xref)!==-1||t&&u.indexOf(o.yref)!==-1)&&e(n,r)}}var u=[],r;for(i&&o(ft),t&&o(et),r=0;r<u.length;r++)b.doTicks(n,u[r],!0);e(lt.annotations||[],f.getComponentMethod("annotations","drawOne"));e(lt.shapes||[],f.getComponentMethod("shapes","drawOne"));e(lt.images||[],f.getComponentMethod("images","draw"))}function wi(){if(!n._transitioningWithDuration){var o=n._context.doubleClick,f=(ot?ft:[]).concat(st?et:[]),r={},t,i,e;if(o==="autosize")for(i=0;i<f.length;i++)t=f[i],t.fixedrange||(r[t._name+".autorange"]=!0);else if(o==="reset")for(i=0;i<f.length;i++)t=f[i],t._rangeInitial?(e=t._rangeInitial.slice(),r[t._name+".range[0]"]=e[0],r[t._name+".range[1]"]=e[1]):r[t._name+".autorange"]=!0;else if(o==="reset+autosize")for(i=0;i<f.length;i++)(t=f[i],t.fixedrange)||(t._rangeInitial===undefined||t.range[0]===t._rangeInitial[0]&&t.range[1]===t._rangeInitial[1]?r[t._name+".autorange"]=!0:(e=t._rangeInitial.slice(),r[t._name+".range[0]"]=e[0],r[t._name+".range[1]"]=e[1]));n.emit("plotly_doubleclick",null);u.relayout(n,r)}}function bi(t){for(var i,r={},f=0;f<ni.length;f++)(i=ni[f],t&&t.indexOf(i._id.charAt(0))===-1)||(i._r[0]!==i.range[0]&&(r[i._name+".range[0]"]=i.range[0]),i._r[1]!==i.range[1]&&(r[i._name+".range[1]"]=i.range[1]),i.range=i._r.slice());ui([0,0,at,ht]);u.relayout(n,r)}function ui(n){for(var h,c,t,v=lt._plots,y=Object.keys(v),s=0;s<y.length;s++){var o=v[y[s]],f=o.xaxis,e=o.yaxis,r=rt&&!f.fixedrange,u=it&&!e.fixedrange;if(r){for(h=!1,t=0;t<ft.length;t++)if(ft[t]._id===f._id){h=!0;break}r=r&&h}if(u){for(c=!1,t=0;t<et.length;t++)if(et[t]._id===e._id){c=!0;break}u=u&&c}var l=r?f._length/n[2]:1,a=u?e._length/n[3]:1,p=r?n[0]:0,w=u?n[1]:0,b=r?n[0]/n[2]*f._length:0,k=u?n[1]/n[3]*e._length:0,d=f._offset-b,g=e._offset-k;lt._defs.selectAll("#"+o.clipId).call(i.setTranslate,p,w).call(i.setScale,1/l,1/a);o.plot.call(i.setTranslate,d,g).call(i.setScale,l,a).selectAll(".points").selectAll(".point").call(i.setPointGroupScale,1/l,1/a)}}for(var ei,oi,yt,pt,lt=n._fullLayout,dt=[t].concat(it&&rt?t.overlays:[]),ft=[t.xaxis],et=[t.yaxis],at=ft[0]._length,ht=et[0]._length,fi=e.MINDRAG,vt=e.MINZOOM,ki=it+rt==="nsew",ti=1;ti<dt.length;ti++)ei=dt[ti].xaxis,oi=dt[ti].yaxis,ft.indexOf(ei)===-1&&ft.push(ei),et.indexOf(oi)===-1&&et.push(oi);var ni=ft.concat(et),ot=ii(ft,rt),st=ii(et,it),di=h(st+ot,lt.dragmode),gi=it+rt+"drag",ri=t.draglayer.selectAll("."+gi).data([0]);if(ri.enter().append("rect").classed("drag",!0).classed(gi,!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",t.id),ri.call(y.setRect,r,g,nt,tt).call(p,di),yt=ri.node(),!st&&!ot&&!l(lt.dragmode))return yt.onmousedown=null,yt.style.pointerEvents=ki?"all":"none",yt;pt={element:yt,gd:n,plotinfo:t,xaxes:ft,yaxes:et,doubleclick:wi,prepFn:function(t,i,r){var u=n._fullLayout.dragmode;ki?t.shiftKey&&(u=u==="pan"?"zoom":"pan"):u="pan";pt.minDrag=u==="lasso"?1:undefined;u==="zoom"?(pt.moveFn=or,pt.doneFn=sr,er(t,i,r)):u==="pan"?(pt.moveFn=ar,pt.doneFn=hr,ir()):l(u)&&k(t,i,r,pt,u)}};w.init(pt);var si=n._fullLayout._zoomlayer,hi=t.xaxis._offset,ci=t.yaxis._offset,bt,kt,ut,li,ai,vi,wt,yi,gt;var ct=[0,0,at,ht],ur=null,cr=e.REDRAWDELAY,lr=t.mainplot?lt._plots[t.mainplot]:t;return it.length*rt.length!=1&&(yt.onwheel!==undefined?yt.onwheel=fr:yt.onmousewheel!==undefined&&(yt.onmousewheel=fr)),yt}},{"../../components/color":582,"../../components/dragelement":603,"../../components/drawing":605,"../../lib":681,"../../lib/setcursor":691,"../../lib/svg_text_utils":695,"../../plotly":706,"../../registry":784,"./axes":710,"./constants":715,"./select":723,d3:129,tinycolor2:546}],717:[function(n,t){"use strict";function d(n,t){for(var i=[],r=n.length;r>0;r--)i.push(t);return i}function g(n,t){for(var r=[],i=0;i<n.length;i++)r.push(n[i].p2c(t));return r}function ht(n,t){return function(i){var r=n(i),u=t(i);return Math.sqrt(r*r+u*u)}}function nt(n,t,i){var wi,b,oi,bt,si,k,e,ht,kt,dt,nt,y,u,s,gt,vt,ut,hi,ci,ni,li,yt,pt,wt,ai,et,ti,ii,ri,ui,fi,vi,r,p;if(i==="pie"){n.emit("plotly_hover",{points:[t]});return}i||(i="xy");var w=Array.isArray(i)?i:[i],h=n._fullLayout,yi=h._plots||[],pi=yi[i];pi&&(wi=pi.overlays.map(function(n){return n.id}),w=w.concat(wi));var ei=w.length,ot=new Array(ei),st=new Array(ei);for(b=0;b<ei;b++){if(oi=w[b],bt=yi[oi],bt){ot[b]=l.getFromId(n,bt.xaxis._id);st[b]=l.getFromId(n,bt.yaxis._id);continue}si=h[oi]._subplot;ot[b]=si.xaxis;st[b]=si.yaxis}if(k=t.hovermode||h.hovermode,["x","y","closest"].indexOf(k)===-1||!n.calcdata||n.querySelector(".zoombox")||n._dragging)return v.unhoverRaw(n,t);if(e=[],ht=[],Array.isArray(t))for(k="array",nt=0;nt<t.length;nt++)u=n.calcdata[t[nt].curveNumber||0],u[0].trace.hoverinfo!=="skip"&&ht.push(u);else{for(y=0;y<n.calcdata.length;y++)u=n.calcdata[y],s=u[0].trace,s.hoverinfo!=="skip"&&w.indexOf(tt(s))!==-1&&ht.push(u);if(t.target&&"clientX"in t&&"clientY"in t){if(ft.triggerHandler(n,"plotly_beforehover",t)===!1)return;if(wt=t.target.getBoundingClientRect(),yt=t.clientX-wt.left,pt=t.clientY-wt.top,yt<0||yt>wt.width||pt<0||pt>wt.height)return v.unhoverRaw(n,t)}else yt="xpx"in t?t.xpx:ot[0]._length/2,pt="ypx"in t?t.ypx:st[0]._length/2;if(kt="xval"in t?d(w,t.xval):g(ot,yt),dt="yval"in t?d(w,t.yval):g(st,pt),!c(kt[0])||!c(dt[0]))return a.warn("Fx.hover failed",t,n),v.unhoverRaw(n,t)}for(ai=Infinity,y=0;y<ht.length;y++)if(u=ht[y],u&&u[0]&&u[0].trace&&u[0].trace.visible===!0){if(s=u[0].trace,gt=tt(s),vt=w.indexOf(gt),ut=k,ni={cd:u,trace:s,xa:ot[vt],ya:st[vt],name:n.data.length>1||s.hoverinfo.indexOf("name")!==-1?s.name:undefined,index:!1,distance:Math.min(ai,o.MAXDIST),color:f.defaultLine,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined},h[gt]&&(ni.subplot=h[gt]._subplot),li=e.length,ut==="array"?(et=t[y],"pointNumber"in et?(ni.index=et.pointNumber,ut="closest"):(ut="","xval"in et&&(hi=et.xval,ut="x"),"yval"in et&&(ci=et.yval,ut=ut?"closest":"y"))):(hi=kt[vt],ci=dt[vt]),s._module&&s._module.hoverPoints){if(ti=s._module.hoverPoints(ni,hi,ci,ut),ti)for(ri=0;ri<ti.length;ri++)ii=ti[ri],c(ii.x0)&&c(ii.y0)&&e.push(ct(ii,k))}else a.log("Unrecognized trace type in hover:",s);k==="closest"&&e.length>li&&(e.splice(0,li),ai=e[0].distance)}if(e.length===0)return v.unhoverRaw(n,t);ui=k==="y"&&ht.length>1;e.sort(function(n,t){return n.distance-t.distance});var bi=f.combine(h.plot_bgcolor||f.background,h.paper_bgcolor),ki={hovermode:k,rotateLabels:ui,bgColor:bi,container:h._hoverlayer,outerContainer:h._paperdiv},di=it(e,ki);for(lt(e,ui?"xa":"ya"),rt(di,ui),fi=n._hoverdata,vi=[],nt=0;nt<e.length;nt++)r=e[nt],p={data:r.trace._input,fullData:r.trace,curveNumber:r.trace.index,pointNumber:r.index},r.trace._module.eventData?p=r.trace._module.eventData(p,r):(p.x=r.xVal,p.y=r.yVal,p.xaxis=r.xa,p.yaxis=r.ya,r.zLabelVal!==undefined&&(p.z=r.zLabelVal)),vi.push(p);(n._hoverdata=vi,at(n,t,fi))&&(fi&&n.emit("plotly_unhover",{points:fi}),n.emit("plotly_hover",{points:n._hoverdata,xaxes:ot,yaxes:st,xvals:kt,yvals:dt}))}function tt(n){return n.subplot||n.xaxis+n.yaxis||n.geo}function ct(n,t){var r,u,f,e,o,i;return n.posref=t==="y"?(n.x0+n.x1)/2:(n.y0+n.y1)/2,n.x0=a.constrain(n.x0,0,n.xa._length),n.x1=a.constrain(n.x1,0,n.xa._length),n.y0=a.constrain(n.y0,0,n.ya._length),n.y1=a.constrain(n.y1,0,n.ya._length),n.xLabelVal!==undefined&&(r=n.xa.type==="log"&&n.xLabelVal<=0,u=l.tickText(n.xa,n.xa.c2l(r?-n.xLabelVal:n.xLabelVal),"hover"),n.xLabel=r?n.xLabelVal===0?"0":"-"+u.text:u.text,n.xVal=n.xa.c2d(n.xLabelVal)),n.yLabelVal!==undefined&&(r=n.ya.type==="log"&&n.yLabelVal<=0,f=l.tickText(n.ya,n.ya.c2l(r?-n.yLabelVal:n.yLabelVal),"hover"),n.yLabel=r?n.yLabelVal===0?"0":"-"+f.text:f.text,n.yVal=n.ya.c2d(n.yLabelVal)),n.zLabelVal!==undefined&&(n.zLabel=String(n.zLabelVal)),isNaN(n.xerr)||n.xa.type==="log"&&n.xerr<=0||(e=l.tickText(n.xa,n.xa.c2l(n.xerr),"hover").text,n.xLabel+=n.xerrneg!==undefined?" +"+e+" / -"+l.tickText(n.xa,n.xa.c2l(n.xerrneg),"hover").text:" ± "+e,t==="x"&&(n.distance+=1)),isNaN(n.yerr)||n.ya.type==="log"&&n.yerr<=0||(o=l.tickText(n.ya,n.ya.c2l(n.yerr),"hover").text,n.yLabel+=n.yerrneg!==undefined?" +"+o+" / -"+l.tickText(n.ya,n.ya.c2l(n.yerrneg),"hover").text:" ± "+o,t==="y"&&(n.distance+=1)),i=n.trace.hoverinfo,i!=="all"&&(i=i.split("+"),i.indexOf("x")===-1&&(n.xLabel=undefined),i.indexOf("y")===-1&&(n.yLabel=undefined),i.indexOf("z")===-1&&(n.zLabel=undefined),i.indexOf("text")===-1&&(n.text=undefined),i.indexOf("name")===-1&&(n.name=undefined)),n}function it(n,t){for(var s=t.hovermode,rt=t.rotateLabels,ft=t.bgColor,et=t.container,ht=t.outerContainer,i=n[0],l=i.xa,c=i.ya,ot=s==="y"?"yLabel":"xLabel",g=i[ot],ct=(String(g)||"").split(" ")[0],nt=ht.node().getBoundingClientRect(),v=nt.top,lt=nt.width,at=nt.height,tt=i.distance<=o.MAXDIST&&(s==="x"||s==="y"),st,it,d,a,p=0;p<n.length;p++)if(st=n[p].trace.hoverinfo,it=st.split("+"),it.indexOf("all")===-1&&it.indexOf(s)===-1){tt=!1;break}return d=et.selectAll("g.axistext").data(tt?[0]:[]),d.enter().append("g").classed("axistext",!0),d.exit().remove(),d.each(function(){var a=h.select(this),d=a.selectAll("path").data([0]),o=a.selectAll("text").data([0]),t,p,k;d.enter().append("path").style({fill:f.defaultLine,"stroke-width":"1px",stroke:f.background});o.enter().append("text").call(e.font,b,w,f.background).attr("data-notex",1);o.text(g).call(y.convertToTspans).call(e.setPosition,0,0).selectAll("tspan.line").call(e.setPosition,0,0);a.attr("transform","");t=o.node().getBoundingClientRect();s==="x"?(o.attr("text-anchor","middle").call(e.setPosition,0,l.side==="top"?v-t.bottom-r-u:v-t.top+r+u).selectAll("tspan.line").attr({x:o.attr("x"),y:o.attr("y")}),p=l.side==="top"?"-":"",d.attr("d","M0,0L"+r+","+p+r+"H"+(u+t.width/2)+"v"+p+(u*2+t.height)+"H-"+(u+t.width/2)+"V"+p+r+"H-"+r+"Z"),a.attr("transform","translate("+(l._offset+(i.x0+i.x1)/2)+","+(c._offset+(l.side==="top"?0:c._length))+")")):(o.attr("text-anchor",c.side==="right"?"start":"end").call(e.setPosition,(c.side==="right"?1:-1)*(u+r),v-t.top-t.height/2).selectAll("tspan.line").attr({x:o.attr("x"),y:o.attr("y")}),k=c.side==="right"?"":"-",d.attr("d","M0,0L"+k+r+","+r+"V"+(u+t.height/2)+"h"+k+(u*2+t.width)+"V-"+(u+t.height/2)+"H"+k+r+"V-"+r+"Z"),a.attr("transform","translate("+(l._offset+(c.side==="right"?l._length:0))+","+(c._offset+(i.y0+i.y1)/2)+")"));n=n.filter(function(n){return n.zLabelVal!==undefined||(n[ot]||"").split(" ")[0]===ct})}),a=et.selectAll("g.hovertext").data(n,function(n){return[n.trace.index,n.index,n.x0,n.y0,n.name,n.attr,n.xa,n.ya||""].join(",")}),a.enter().append("g").classed("hovertext",!0).each(function(){var n=h.select(this);n.append("rect").call(f.fill,f.addOpacity(ft,.8));n.append("text").classed("name",!0).call(e.font,b,w);n.append("path").style("stroke-width","1px");n.append("text").classed("nums",!0).call(e.font,b,w)}),a.exit().remove(),a.each(function(n){var o=h.select(this).attr("transform",""),i="",t="",vt=f.opacity(n.color)?n.color:f.defaultLine,st=f.combine(vt,ft),ct=ut(st).getBrightness()>128?"#000":f.background,ht,d,c,w;n.name&&n.zLabelVal===undefined&&(ht=document.createElement("p"),ht.innerHTML=n.name,i=ht.textContent||"",i.length>15&&(i=i.substr(0,12)+"..."));n.extraText!==undefined&&(t+=n.extraText);n.zLabel!==undefined?(n.xLabel!==undefined&&(t+="x: "+n.xLabel+"<br>"),n.yLabel!==undefined&&(t+="y: "+n.yLabel+"<br>"),t+=(t?"z: ":"")+n.zLabel):tt&&n[s+"Label"]===g?t=n[(s==="x"?"y":"x")+"Label"]||"":n.xLabel===undefined?n.yLabel!==undefined&&(t=n.yLabel):t=n.yLabel===undefined?n.xLabel:"("+n.xLabel+", "+n.yLabel+")";n.text&&!Array.isArray(n.text)&&(t+=(t?"<br>":"")+n.text);t===""&&(i===""&&o.remove(),t=i);d=o.select("text.nums").style("fill",ct).call(e.setPosition,0,0).text(t).attr("data-notex",1).call(y.convertToTspans);d.selectAll("tspan.line").call(e.setPosition,0,0);c=o.select("text.name");w=0;i&&i!==t?(c.style("fill",st).text(i).call(e.setPosition,0,0).attr("data-notex",1).call(y.convertToTspans),c.selectAll("tspan.line").call(e.setPosition,0,0),w=c.node().getBoundingClientRect().width+2*u):(c.remove(),o.select("rect").remove());o.select("path").style({fill:st,stroke:ct});var b=d.node().getBoundingClientRect(),l=n.xa._offset+(n.x0+n.x1)/2,a=n.ya._offset+(n.y0+n.y1)/2,nt=Math.abs(n.x1-n.x0),it=Math.abs(n.y1-n.y0),et=b.width+r+u+w,p,ot;n.ty0=v-b.top;n.bx=b.width+2*u;n.by=b.height+2*u;n.anchor="start";n.txwidth=b.width;n.tx2width=w;n.offset=0;rt?(n.pos=l,p=a+it/2+et<=at,ot=a-it/2-et>=0,(n.idealAlign==="top"||!p)&&ot?(a-=it/2,n.anchor="end"):p?(a+=it/2,n.anchor="start"):n.anchor="middle"):(n.pos=a,p=l+nt/2+et<=lt,ot=l-nt/2-et>=0,(n.idealAlign==="left"||!p)&&ot?(l-=nt/2,n.anchor="end"):p?(l+=nt/2,n.anchor="start"):n.anchor="middle");d.attr("text-anchor",n.anchor);w&&c.attr("text-anchor",n.anchor);o.attr("transform","translate("+l+","+a+")"+(rt?"rotate("+k+")":""))}),a}function lt(n,t){function k(n){var t=n[0],e=n[n.length-1],f;if(o=t.pmin-t.pos-t.dp+t.size,s=e.pos+e.dp+e.size-t.pmax,o>.01){for(i=n.length-1;i>=0;i--)n[i].dp+=o;h=!1}if(!(s<.01)){if(o<-.01){for(i=n.length-1;i>=0;i--)n[i].dp-=s;h=!1}if(h){for(f=0,r=0;r<n.length;r++)u=n[r],u.pos+u.dp+u.size>t.pmax&&f++;for(r=n.length-1;r>=0;r--){if(f<=0)break;u=n[r];u.pos>t.pmax-1&&(u.del=!0,f--)}for(r=0;r<n.length;r++){if(f<=0)break;if(u=n[r],u.pos<t.pmin+1)for(u.del=!0,f--,s=u.size*2,i=n.length-1;i>=0;i--)n[i].dp-=s}for(r=n.length-1;r>=0;r--){if(f<=0)break;u=n[r];u.pos+u.dp+u.size>t.pmax&&(u.del=!0,f--)}}}}for(var b=0,e=n.map(function(n,i){var r=n[t];return[{i:i,dp:0,pos:n.pos,posref:n.posref,size:n.by*(r._id.charAt(0)==="x"?et:1)/2,pmin:r._offset,pmax:r._offset+r._length}]}).sort(function(n,t){return n[0].posref-t[0].posref}),h,o,s,r,i,u,y,p,v,w;!h&&b<=n.length;){for(b++,h=!0,r=0;r<e.length-1;){var f=e[r],a=e[r+1],c=f[f.length-1],l=a[0];if(o=c.pos+c.dp+c.size-l.pos-l.dp+l.size,o>.01&&c.pmin===l.pmin&&c.pmax===l.pmax){for(i=a.length-1;i>=0;i--)a[i].dp+=o;for(f.push.apply(f,a),e.splice(r+1,1),y=0,i=f.length-1;i>=0;i--)y+=f[i].dp;for(s=y/f.length,i=f.length-1;i>=0;i--)f[i].dp-=s;h=!1}else r++}e.forEach(k)}for(r=e.length-1;r>=0;r--)for(p=e[r],i=p.length-1;i>=0;i--)v=p[i],w=n[v.i],w.offset=v.dp,w.del=v.del}function rt(n,t){n.each(function(n){var o=h.select(this);if(n.del){o.remove();return}var c=n.anchor==="end"?-1:1,l=o.select("text.nums"),s={start:1,end:-1,middle:0}[n.anchor],a=s*(r+u),v=a+s*(n.txwidth+u),i=0,f=n.offset;n.anchor==="middle"&&(a-=n.tx2width/2,v-=n.tx2width/2);t&&(f*=-st,i=n.offset*ot);o.select("path").attr("d",n.anchor==="middle"?"M-"+n.bx/2+",-"+n.by/2+"h"+n.bx+"v"+n.by+"h-"+n.bx+"Z":"M0,0L"+(c*r+i)+","+(r+f)+"v"+(n.by/2-r)+"h"+c*n.bx+"v-"+n.by+"H"+(c*r+i)+"V"+(f-r)+"Z");l.call(e.setPosition,a+i,f+n.ty0-n.by/2+u).selectAll("tspan.line").attr({x:l.attr("x"),y:l.attr("y")});n.tx2width&&(o.select("text.name, text.name tspan.line").call(e.setPosition,v+s*u+i,f+n.ty0-n.by/2+u),o.select("rect").call(e.setRect,v+(s-1)*n.tx2width/2+i,f-n.by/2-1,n.tx2width,n.by+2))})}function at(n,t,i){var r,u,f;if(!t.target)return!1;if(!i||i.length!==n._hoverdata.length)return!0;for(r=i.length-1;r>=0;r--)if(u=i[r],f=n._hoverdata[r],u.curveNumber!==f.curveNumber||String(u.pointNumber)!==String(f.pointNumber))return!0;return!1}var h=n("d3"),ut=n("tinycolor2"),c=n("fast-isnumeric"),a=n("../../lib"),ft=n("../../lib/events"),y=n("../../lib/svg_text_utils"),f=n("../../components/color"),e=n("../../components/drawing"),v=n("../../components/dragelement"),l=n("./axes"),o=n("./constants"),s=n("./dragbox"),i=t.exports={};i.unhover=v.unhover;i.layoutAttributes={dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable"],dflt:"zoom"},hovermode:{valType:"enumerated",values:["x","y","closest",!1]}};i.supplyLayoutDefaults=function(n,t,r){function f(r,u){return a.coerce(n,t,i.layoutAttributes,r,u)}var u,e;f("dragmode");t._has("cartesian")?(e=t._isHoriz=i.isHoriz(r),u=e?"y":"x"):u="closest";f("hovermode",u)};i.isHoriz=function(n){for(var r,i=!0,t=0;t<n.length;t++)if(r=n[t],r.orientation!=="h"){i=!1;break}return i};i.init=function(n){var t=n._fullLayout,u,r;t._has("cartesian")&&!n._context.staticPlot&&(u=Object.keys(t._plots||{}).sort(function(n,i){if((t._plots[n].mainplot&&!0)===(t._plots[i].mainplot&&!0)){var r=n.split("y"),u=i.split("y");return r[0]===u[0]?Number(r[1]||1)-Number(u[1]||1):Number(r[0]||1)-Number(u[0]||1)}return t._plots[n].mainplot?1:-1}),u.forEach(function(r){var f=t._plots[r],y;if(t._has("cartesian")){var e=f.xaxis,h=f.yaxis,l=(e._linepositions[r]||[])[3],a=(h._linepositions[r]||[])[3],u=o.DRAGGERSIZE;c(l)&&e.side==="top"&&(l-=u);c(a)&&h.side!=="right"&&(a-=u);f.mainplot||(y=s(n,f,0,0,e._length,h._length,"ns","ew"),y.onmousemove=function(u){i.hover(n,u,r);t._lasthover=y;t._hoversubplot=r},y.onmouseout=function(t){n._dragging||v.unhover(n,t)},y.onclick=function(t){i.click(n,t)},s(n,f,-u,-u,u,u,"n","w"),s(n,f,e._length,-u,u,u,"n","e"),s(n,f,-u,h._length,u,u,"s","w"),s(n,f,e._length,h._length,u,u,"s","e"));c(l)&&(e.anchor==="free"&&(l-=t._size.h*(1-h.domain[1])),s(n,f,e._length*.1,l,e._length*.8,u,"","ew"),s(n,f,0,l,e._length*.1,u,"","w"),s(n,f,e._length*.9,l,e._length*.1,u,"","e"));c(a)&&(h.anchor==="free"&&(a-=t._size.w*e.domain[0]),s(n,f,a,h._length*.1,u,h._length*.8,"ns",""),s(n,f,a,h._length*.9,u,h._length*.1,"s",""),s(n,f,a,0,u,h._length*.1,"n",""))}}),r=t._hoverlayer.node(),r.onmousemove=function(r){r.target=t._lasthover;i.hover(n,r,t._hoversubplot)},r.onclick=function(r){r.target=t._lasthover;i.click(n,r)},r.onmousedown=function(n){t._lasthover.onmousedown(n)})};var k=o.YANGLE,p=Math.PI*k/180,et=1/Math.sin(p),ot=Math.cos(p),st=Math.sin(p);var r=o.HOVERARROWSIZE,u=o.HOVERTEXTPAD,w=o.HOVERFONTSIZE,b=o.HOVERFONT;i.hover=function(n,t,i){if(typeof n=="string"&&(n=document.getElementById(n)),n._lastHoverTime===undefined&&(n._lastHoverTime=0),n._hoverTimer!==undefined&&(clearTimeout(n._hoverTimer),n._hoverTimer=undefined),Date.now()>n._lastHoverTime+o.HOVERMINTIME){nt(n,t,i);n._lastHoverTime=Date.now();return}n._hoverTimer=setTimeout(function(){nt(n,t,i);n._lastHoverTime=Date.now();n._hoverTimer=undefined},o.HOVERMINTIME)};i.getDistanceFunction=function(n,t,i,r){return n==="closest"?r||ht(t,i):n==="x"?t:i};i.getClosest=function(n,t,i){var r,u;if(i.index!==!1)i.index>=0&&i.index<n.length?i.distance=0:i.index=!1;else for(r=0;r<n.length;r++)u=t(n[r]),u<=i.distance&&(i.index=r,i.distance=u);return i};i.loneHover=function(n,t){var e={color:n.color||f.defaultLine,x0:n.x0||n.x||0,x1:n.x1||n.x||0,y0:n.y0||n.y||0,y1:n.y1||n.y||0,xLabel:n.xLabel,yLabel:n.yLabel,zLabel:n.zLabel,text:n.text,name:n.name,idealAlign:n.idealAlign,trace:{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0},i=h.select(t.container),o=t.outerContainer?h.select(t.outerContainer):i,r={hovermode:"closest",rotateLabels:!1,bgColor:t.bgColor||f.background,container:i,outerContainer:o},u=it([e],r);return rt(u,r.rotateLabels),u.node()};i.loneUnhover=function(n){var t=n instanceof h.selection?n:h.select(n);t.selectAll("g.hovertext").remove()};i.click=function(n,t){n._hoverdata&&t&&t.target&&(n.emit("plotly_click",{points:n._hoverdata}),t.stopImmediatePropagation&&t.stopImmediatePropagation())};i.inbox=function(n,t){return n*t<0||n===0?o.MAXDIST*(.6-.3/Math.max(3,Math.abs(n-t))):Infinity}},{"../../components/color":582,"../../components/dragelement":603,"../../components/drawing":605,"../../lib":681,"../../lib/events":672,"../../lib/svg_text_utils":695,"./axes":710,"./constants":715,"./dragbox":716,d3:129,"fast-isnumeric":133,tinycolor2:546}],718:[function(n,t,i){"use strict";function s(n,t,i,r,u){var a=n._fullLayout,l=a._modules,f,e,s,o,h,c;for(t.plot&&t.plot.selectAll("g:not(.scatterlayer)").selectAll("g.trace").remove(),f=0;f<l.length;f++)if(e=l[f],e.basePlotModule.name==="cartesian"){for(s=[],o=0;o<i.length;o++)h=i[o],c=h[0].trace,c._module===e&&c.visible===!0&&s.push(h);e.plot(n,t,s,r,u)}}function a(n){for(var r,e,l=n._fullLayout,h=u.getSubplots(n),a=[],v=[],c=0;c<h.length;c++){var o=h[c],s=l._plots[o],t=s.xaxis,i=s.yaxis,f=u.getFromId(n,t.overlaying)||t;f!==t&&f.overlaying&&(f=t,t.overlaying=!1);r=u.getFromId(n,i.overlaying)||i;r!==i&&r.overlaying&&(r=i,i.overlaying=!1);e=f._id+r._id;e!==o&&h.indexOf(e)!==-1?(s.mainplot=e,s.mainplotinfo=l._plots[e],v.push(o),t.domain=f.domain.slice(),i.domain=r.domain.slice()):a.push(o)}return a.concat(v)}function h(n){function e(n){r(n,"g","imagelayer");r(n,"g","maplayer");r(n,"g","barlayer");r(n,"g","boxlayer");r(n,"g","scatterlayer")}var t=n.plotgroup,u=n.id,f,i;n.mainplot?(i=n.mainplotinfo,n.gridlayer=r(i.overgrid,"g",u),n.zerolinelayer=r(i.overzero,"g",u),n.plot=r(i.overplot,"g",u),n.xlines=r(i.overlines,"path",u),n.ylines=r(i.overlines,"path",u),n.xaxislayer=r(i.overaxes,"g",u),n.yaxislayer=r(i.overaxes,"g",u)):(n.bg=r(t,"rect","bg"),n.bg.style("stroke-width",0),f=r(t,"g","layer-subplot"),n.shapelayer=r(f,"g","shapelayer"),n.imagelayer=r(f,"g","imagelayer"),n.gridlayer=r(t,"g","gridlayer"),n.overgrid=r(t,"g","overgrid"),n.zerolinelayer=r(t,"g","zerolinelayer"),n.overzero=r(t,"g","overzero"),n.plot=r(t,"g","plot"),n.overplot=r(t,"g","overplot"),n.xlines=r(t,"path","xlines"),n.ylines=r(t,"path","ylines"),n.overlines=r(t,"g","overlines"),n.xaxislayer=r(t,"g","xaxislayer"),n.yaxislayer=r(t,"g","yaxislayer"),n.overaxes=r(t,"g","overaxes"));n.plot.call(e);n.xlines.style("fill","none").classed("crisp",!0);n.ylines.style("fill","none").classed("crisp",!0)}function c(n,t){n&&n.each(function(n){var i=f.select(this),r="clip"+t._uid+n+"plot";i.remove();t._draggers.selectAll("g."+n).remove();t._defs.select("#"+r).remove()})}function r(n,t,i){var r=n.selectAll("."+i).data([0]);return r.enter().append(t).classed(i,!0),r}var f=n("d3"),l=n("../../lib"),e=n("../plots"),u=n("./axes"),o=n("./constants");i.name="cartesian";i.attr=["xaxis","yaxis"];i.idRoot=["x","y"];i.idRegex=o.idRegex;i.attrRegex=o.attrRegex;i.attributes=n("./attributes");i.transitionAxes=n("./transition_axes");i.plot=function(n,t,i,r){var v=n._fullLayout,y=e.getSubplotIds(v,"cartesian"),a=n.calcdata,u,c,l,f;if(!Array.isArray(t))for(t=[],u=0;u<a.length;u++)t.push(u);for(u=0;u<y.length;u++){var p=y[u],w=v._plots[p],o=[],h;for(c=0;c<a.length;c++)l=a[c],f=l[0].trace,f.xaxis+f.yaxis===p&&(t.indexOf(f.index)!==-1&&(h&&["tonextx","tonexty","tonext"].indexOf(f.fill)!==-1&&o.indexOf(h)===-1&&o.push(h),o.push(l)),h=l);s(n,w,o,i,r)}};i.clean=function(n,t,i,r){for(var s=r._modules||[],h=t._modules||[],l,a,f,e,o,v,y,p,u=0;u<s.length;u++)if(s[u].name==="scatter"){l=!0;break}for(u=0;u<h.length;u++)if(h[u].name==="scatter"){a=!0;break}if(l&&!a)for(f=r._plots,e=Object.keys(f||{}),u=0;u<e.length;u++)o=f[e[u]],o.plot&&o.plot.select("g.scatterlayer").selectAll("g.trace").remove();v=r._has&&r._has("cartesian");y=t._has&&t._has("cartesian");v&&!y&&(p=r._cartesianlayer.selectAll(".subplot"),p.call(c,r),r._defs.selectAll(".axesclip").remove())};i.drawFramework=function(n){var t=n._fullLayout,u=a(n),i=t._cartesianlayer.selectAll(".subplot").data(u,l.identity);i.enter().append("g").attr("class",function(n){return"subplot "+n});i.order();i.exit().call(c,t);i.each(function(n){var i=t._plots[n],u;i.plotgroup=f.select(this);i.overlays=[];h(i);i.mainplot&&(u=t._plots[i.mainplot],u.overlays.push(i));i.draglayer=r(t._draggers,"g",n)})};i.rangePlot=function(n,t,i){h(t);s(n,t,i);e.style(n)}},{"../../lib":681,"../plots":769,"./attributes":709,"./axes":710,"./constants":715,"./transition_axes":728,d3:129}],719:[function(n,t){"use strict";var u=n("../font_attributes"),i=n("../../components/color/attributes"),f=n("../../lib/extend").extendFlat,r=n("./constants");t.exports={color:{valType:"color",dflt:i.defaultLine},title:{valType:"string"},titlefont:f({},u,{}),type:{valType:"enumerated",values:["-","linear","log","date","category"],dflt:"-"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal"},range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},fixedrange:{valType:"boolean",dflt:!1},tickmode:{valType:"enumerated",values:["auto","linear","array"]},nticks:{valType:"integer",min:0,dflt:0},tick0:{valType:"number",dflt:0},dtick:{valType:"any",dflt:1},tickvals:{valType:"data_array"},ticktext:{valType:"data_array"},ticks:{valType:"enumerated",values:["outside","inside",""]},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1},ticklen:{valType:"number",min:0,dflt:5},tickwidth:{valType:"number",min:0,dflt:1},tickcolor:{valType:"color",dflt:i.defaultLine},showticklabels:{valType:"boolean",dflt:!0},tickfont:f({},u,{}),tickangle:{valType:"angle",dflt:"auto"},tickprefix:{valType:"string",dflt:""},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all"},ticksuffix:{valType:"string",dflt:""},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B"},separatethousands:{valType:"boolean",dflt:!1},tickformat:{valType:"string",dflt:""},hoverformat:{valType:"string",dflt:""},showline:{valType:"boolean",dflt:!1},linecolor:{valType:"color",dflt:i.defaultLine},linewidth:{valType:"number",min:0,dflt:1},showgrid:{valType:"boolean"},gridcolor:{valType:"color",dflt:i.lightLine},gridwidth:{valType:"number",min:0,dflt:1},zeroline:{valType:"boolean"},zerolinecolor:{valType:"color",dflt:i.defaultLine},zerolinewidth:{valType:"number",dflt:1},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()]},side:{valType:"enumerated",values:["top","bottom","left","right"]},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()]},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},position:{valType:"number",min:0,max:1,dflt:0},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace"},categoryarray:{valType:"data_array"},_nestedModules:{rangeslider:"rangeslider",rangeselector:"rangeselector"},_deprecated:{autotick:{valType:"boolean"}}}},{"../../components/color/attributes":581,"../../lib/extend":673,"../font_attributes":729,"./constants":715}],720:[function(n,t){"use strict";var i=n("../../registry"),u=n("../../lib"),f=n("../../components/color"),o=n("../layout_attributes"),e=n("./constants"),s=n("./layout_attributes"),h=n("./axis_defaults"),c=n("./position_defaults"),r=n("./axis_ids");t.exports=function(n,t,l){function ht(n,t){var i=Number(n.substr(5)||1),r=Number(t.substr(5)||1);return i-r}for(var ft=Object.keys(n),b=[],k=[],it=[],rt=[],ut={},et={},y,nt,tt,p,w,ot,st,a,at,vt,yt,v=0;v<l.length;v++){if(y=l[v],i.traceIs(y,"cartesian"))nt=b,tt=k;else if(i.traceIs(y,"gl2d"))nt=it,tt=rt;else continue;p=r.id2name(y.xaxis);w=r.id2name(y.yaxis);p&&nt.indexOf(p)===-1&&nt.push(p);w&&tt.indexOf(w)===-1&&tt.push(w);i.traceIs(y,"2dMap")&&(ut[p]=!0,ut[w]=!0);i.traceIs(y,"oriented")&&(ot=y.orientation==="h"?w:p,et[ot]=!0)}if(st=t._has("gl3d")||t._has("geo"),!st)for(v=0;v<ft.length;v++)a=ft[v],it.indexOf(a)===-1&&b.indexOf(a)===-1&&e.xAxisMatch.test(a)?b.push(a):rt.indexOf(a)===-1&&k.indexOf(a)===-1&&e.yAxisMatch.test(a)&&k.push(a);b.length&&k.length&&u.pushUnique(t._basePlotModules,i.subplotsRegistry.cartesian);var d=b.concat(it).sort(ht),g=k.concat(rt).sort(ht),ct=d.concat(g),lt=f.background;d.length&&g.length&&(lt=u.coerce(n,t,o,"plot_bgcolor"));at=f.combine(lt,t.paper_bgcolor);ct.forEach(function(i){function a(n,t){return u.coerce(f,o,s,n,t)}var e=i.charAt(0),f=n[i]||{},o={},v={letter:e,font:t.font,outerTicks:ut[i],showGrid:!et[i],name:i,data:l,bgColor:at},y={letter:e,counterAxes:{x:g,y:d}[e].map(r.name2id),overlayableAxes:{x:d,y:g}[e].filter(function(t){return t!==i&&!(n[t]||{}).overlaying}).map(r.name2id)};h(f,o,a,v);c(f,o,a,y);t[i]=o;n[i]||f.type==="-"||(n[i]={type:f.type})});vt=i.getComponentMethod("rangeslider","handleDefaults");yt=i.getComponentMethod("rangeselector","handleDefaults");ct.forEach(function(i){var r=i.charAt(0),e=n[i],u=t[i],f={x:g,y:d}[r];vt(n,t,i,f);r==="x"&&u.type==="date"&&yt(e,u,t,f)})}},{"../../components/color":582,"../../lib":681,"../../registry":784,"../layout_attributes":760,"./axis_defaults":711,"./axis_ids":712,"./constants":715,"./layout_attributes":719,"./position_defaults":722}],721:[function(n,t){"use strict";function r(n,t,r){for(var f=[],c=r.map(function(t){return t[n]}),o,h,u,s,l=i.bisector(t).left,e=0;e<c.length;e++)for(h=c[e],o=0;o<h.length;o++)(u=h[o],u!==null&&u!==undefined)&&((s=l(f,u),s<f.length&&f[s]===u)||f.splice(s,0,u));return f}var i=n("d3");t.exports=function(n,t,u,f){switch(t){case"array":return Array.isArray(u)?u.slice():[];case"category ascending":return r(n,i.ascending,f);case"category descending":return r(n,i.descending,f);case"trace":return[];default:return[]}}},{d3:129}],722:[function(n,t){"use strict";var r=n("fast-isnumeric"),i=n("../../lib");t.exports=function(n,t,u,f){var s=f.counterAxes||[],h=f.overlayableAxes||[],c=f.letter,l=i.coerce(n,t,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:r(n.position)?"free":s[0]||"free"}},"anchor"),e,o;return l==="free"&&u("position"),i.coerce(n,t,{side:{valType:"enumerated",values:c==="x"?["bottom","top"]:["left","right"],dflt:c==="x"?"bottom":"left"}},"side"),e=!1,h.length&&(e=i.coerce(n,t,{overlaying:{valType:"enumerated",values:[!1].concat(h),dflt:!1}},"overlaying")),e||(o=u("domain"),o[0]>o[1]-.01&&(t.domain=[0,1]),i.noneOrAll(n.domain,t.domain,[0,1])),t}},{"../../lib":681,"fast-isnumeric":133}],723:[function(n,t){"use strict";function s(n){return n._id}var u=n("../../lib/polygon"),f=n("../../components/color"),e=n("./axes"),o=n("./constants"),h=u.filter,r=u.tester,i=o.MINSELECT;t.exports=function(n,t,u,c,l){function wt(n){var t=n._id.charAt(0)==="y"?1:0;return function(i){return n.p2d(i[t])}}function bt(n,t){return n-t}var ht=c.gd._fullLayout._zoomlayer,ct=c.element.getBoundingClientRect(),lt=c.plotinfo.xaxis._offset,at=c.plotinfo.yaxis._offset,v=t-ct.left,y=u-ct.top,w=v,b=y,vt="M"+v+","+y,et=c.xaxes[0]._length,ot=c.yaxes[0]._length,yt=c.xaxes.map(s),pt=c.yaxes.map(s),rt=c.xaxes.concat(c.yaxes),g,nt;l==="lasso"&&(g=h([[v,y]],o.BENDPX));nt=ht.selectAll("path.select-outline").data([1,2]);nt.enter().append("path").attr("class",function(n){return"select-outline select-outline-"+n}).attr("transform","translate("+lt+", "+at+")").attr("d",vt+"Z");for(var ut=ht.append("path").attr("class","zoombox-corners").style({fill:f.background,stroke:f.defaultLine,"stroke-width":1}).attr("transform","translate("+lt+", "+at+")").attr("d","M0,0Z"),k=[],tt=c.gd,ft,p,d,st=[],it,a=0;a<tt.calcdata.length;a++)if(ft=tt.calcdata[a],p=ft[0].trace,p._module&&p._module.selectPoints)if(c.subplot){if(p.subplot!==c.subplot)continue;k.push({selectPoints:p._module.selectPoints,cd:ft,xaxis:c.xaxes[0],yaxis:c.yaxes[0]})}else{if(yt.indexOf(p.xaxis)===-1)continue;if(pt.indexOf(p.yaxis)===-1)continue;k.push({selectPoints:p._module.selectPoints,cd:ft,xaxis:e.getFromId(tt,p.xaxis),yaxis:e.getFromId(tt,p.yaxis)})}c.moveFn=function(n,t){var u,f,e,o,h,s,p;for(w=Math.max(0,Math.min(et,n+v)),b=Math.max(0,Math.min(ot,t+y)),e=Math.abs(w-v),o=Math.abs(b-y),l==="select"?(o<Math.min(e*.6,i)?(u=r([[v,0],[v,ot],[w,ot],[w,0]]),ut.attr("d","M"+u.xmin+","+(y-i)+"h-4v"+2*i+"h4ZM"+(u.xmax-1)+","+(y-i)+"h4v"+2*i+"h-4Z")):e<Math.min(o*.6,i)?(u=r([[0,y],[0,b],[et,b],[et,y]]),ut.attr("d","M"+(v-i)+","+u.ymin+"v-4h"+2*i+"v4ZM"+(v-i)+","+(u.ymax-1)+"v4h"+2*i+"v-4Z")):(u=r([[v,y],[v,b],[w,b],[w,y]]),ut.attr("d","M0,0Z")),nt.attr("d","M"+u.xmin+","+u.ymin+"H"+(u.xmax-1)+"V"+(u.ymax-1)+"H"+u.xmin+"Z")):l==="lasso"&&(g.addPt([w,b]),u=r(g.filtered),nt.attr("d","M"+g.filtered.join("L")+"Z")),st=[],a=0;a<k.length;a++)d=k[a],[].push.apply(st,d.selectPoints(d,u));if(it={points:st},l==="select")for(h=it.range={},a=0;a<rt.length;a++)f=rt[a],s=f._id.charAt(0),h[f._id]=[f.p2d(u[s+"min"]),f.p2d(u[s+"max"])].sort(bt);else for(p=it.lassoPoints={},a=0;a<rt.length;a++)f=rt[a],p[f._id]=g.filtered.map(wt(f));c.gd.emit("plotly_selecting",it)};c.doneFn=function(n,t){if(ut.remove(),n||t!==2)c.gd.emit("plotly_selected",it);else{for(nt.remove(),a=0;a<k.length;a++)d=k[a],d.selectPoints(d,!1);tt.emit("plotly_deselect",null)}}}},{"../../components/color":582,"../../lib/polygon":688,"./axes":710,"./constants":715}],724:[function(n,t){"use strict";var f=n("d3"),i=n("fast-isnumeric"),u=n("../../lib"),r=n("./constants"),e=n("./clean_datum"),o=n("./axis_ids");t.exports=function(n){function c(t,i){if(t>0)return Math.log(t)/Math.LN10;if(t<=0&&i&&n.range&&n.range.length===2){var u=n.range[0],f=n.range[1];return.5*(u+f-3*h*Math.abs(u-f))}return r.BADNUM}function l(n){return Math.pow(10,n)}function s(n){return i(n)?Number(n):r.BADNUM}var h=10,t;if(n.c2l=n.type==="log"?c:s,n.l2c=n.type==="log"?l:s,n.l2d=function(t){return n.c2d(n.l2c(t))},n.p2d=function(t){return n.l2d(n.p2l(t))},n.setScale=function(t){var e=n._gd._fullLayout._size,f,s,r;for(n._categories||(n._categories=[]),n.overlaying&&(s=o.getFromId(n._gd,n.overlaying),n.domain=s.domain),r=t&&n._r?n._r:n.range,r&&r.length===2&&r[0]!==r[1]||(r=[-1,1]),f=0;f<2;f++)i(r[f])||(r[f]=i(r[1-f])?r[1-f]*(f?10:.1):f?1:-1),r[f]<-(Number.MAX_VALUE/2)?r[f]=-(Number.MAX_VALUE/2):r[f]>Number.MAX_VALUE/2&&(r[f]=Number.MAX_VALUE/2);if(n._id.charAt(0)==="y"?(n._offset=e.t+(1-n.domain[1])*e.h,n._length=e.h*(n.domain[1]-n.domain[0]),n._m=n._length/(r[0]-r[1]),n._b=-n._m*r[1]):(n._offset=e.l+n.domain[0]*e.w,n._length=e.w*(n.domain[1]-n.domain[0]),n._m=n._length/(r[1]-r[0]),n._b=-n._m*r[0]),!isFinite(n._m)||!isFinite(n._b)){u.notifier("Something went wrong with axis scaling","long");n._gd._replotting=!1;throw new Error("axis scaling");}},n.l2p=function(t){return i(t)?f.round(n._b+n._m*t,2):r.BADNUM},n.p2l=function(t){return(t-n._b)/n._m},n.c2p=function(t,i){return n.l2p(n.c2l(t,i))},n.p2c=function(t){return n.l2c(n.p2l(t))},["linear","log","-"].indexOf(n.type)!==-1)n.c2d=s,n.d2c=function(n){return n=e(n),i(n)?Number(n):r.BADNUM},n.d2l=function(t,i){return n.type==="log"?n.c2l(n.d2c(t),i):n.d2c(t)};else if(n.type==="date"){if(n.c2d=function(n){return i(n)?u.ms2DateTime(n):r.BADNUM},n.d2c=function(n){return i(n)?Number(n):u.dateTime2ms(n)},n.d2l=n.d2c,n.range&&n.range.length>1)try{t=n.range.map(u.dateTime2ms);!i(n.range[0])&&i(t[0])&&(n.range[0]=t[0]);!i(n.range[1])&&i(t[1])&&(n.range[1]=t[1])}catch(a){u.error(a,n.range)}}else n.type==="category"&&(n.c2d=function(t){return n._categories[Math.round(t)]},n.d2c=function(t){t!==null&&t!==undefined&&n._categories.indexOf(t)===-1&&n._categories.push(t);var i=n._categories.indexOf(t);return i===-1?r.BADNUM:i},n.d2l=n.d2c);n.makeCalcdata=function(t,i){var u,f,r,e,o;if(i in t)for(u=t[i],f=new Array(u.length),r=0;r<u.length;r++)f[r]=n.d2c(u[r]);else for(e=(i+"0"in t)?n.d2c(t[i+"0"]):0,o=t["d"+i]?Number(t["d"+i]):1,u=t[{x:"y",y:"x"}[i]],f=new Array(u.length),r=0;r<u.length;r++)f[r]=e+r*o;return f};n._min=[];n._max=[];n._minDtick=null;n._forceTick0=null}},{"../../lib":681,"./axis_ids":712,"./clean_datum":714,"./constants":715,d3:129,"fast-isnumeric":133}],725:[function(n,t){"use strict";function r(n){var t=["showexponent","showtickprefix","showticksuffix"].filter(function(t){return n[t]!==undefined}),i=function(i){return n[i]===n[t[0]]};if(t.every(i)||t.length===1)return n[t[0]]}var i=n("../../lib");t.exports=function(n,t,u,f,e){var s=r(n),v=u("tickprefix"),h,c,o,l,a;v&&u("showtickprefix",s);h=u("ticksuffix");h&&u("showticksuffix",s);c=u("showticklabels");c&&(o=e.font||{},l=t.color===n.color?t.color:o.color,i.coerceFont(u,"tickfont",{family:o.family,size:o.size,color:l}),u("tickangle"),f!=="category"&&(a=u("tickformat"),a||f==="date"||(u("showexponent",s),u("exponentformat"),u("separatethousands"))));f==="category"||e.noHover||u("hoverformat")}},{"../../lib":681}],726:[function(n,t){"use strict";var i=n("../../lib"),r=n("./layout_attributes");t.exports=function(n,t,u,f){var e=i.coerce2(n,t,r,"ticklen"),o=i.coerce2(n,t,r,"tickwidth"),s=i.coerce2(n,t,r,"tickcolor",t.color),h=u("ticks",f.outerTicks||e||o||s?"outside":"");h||(delete t.ticklen,delete t.tickwidth,delete t.tickcolor)}},{"../../lib":681,"./layout_attributes":719}],727:[function(n,t){"use strict";var i=n("fast-isnumeric");t.exports=function(n,t,r,u){var f="auto",e,o;n.tickmode==="array"&&(u==="log"||u==="date")&&(n.tickmode="auto");Array.isArray(n.tickvals)?f="array":n.dtick&&i(n.dtick)&&(f="linear");e=r("tickmode",f);e==="auto"?r("nticks"):e==="linear"?(r("tick0"),r("dtick")):(o=r("tickvals"),o===undefined?t.tickmode="auto":r("ticktext"))}},{"fast-isnumeric":133}],728:[function(n,t){"use strict";var f=n("d3"),u=n("../../plotly"),r=n("../../registry"),i=n("../../lib"),e=n("./axes"),o=/((x|y)([2-9]|[1-9][0-9]+)?)axis$/;t.exports=function(n,t,s,h){function tt(n){var i,e,u,s,t,h={},r,f;for(i in n)if(e=i.split("."),u=e[0].match(o),u){if(r=u[1],f=r+"axis",s=c[f],t={},Array.isArray(n[i])?t.to=n[i].slice(0):Array.isArray(n[i].range)&&(t.to=n[i].range.slice(0)),!t.to)continue;t.axisName=f;t.length=s._length;nt.push(r);h[r]=t}return h}function it(n,t,i){var l,a=n._plots,u=[],f,e,r;for(l in a)if(r=a[l],u.indexOf(r)===-1){var o=r.xaxis._id,s=r.yaxis._id,h=r.xaxis.range,c=r.yaxis.range;(r.xaxis._r=r.xaxis.range.slice(),r.yaxis._r=r.yaxis.range.slice(),f=i[o]?i[o].to:h,e=i[s]?i[s].to:c,h[0]!==f[0]||h[1]!==f[1]||c[0]!==e[0]||c[1]!==e[1])&&(t.indexOf(o)!==-1||t.indexOf(s)!==-1)&&u.push(r)}return u}function rt(t,i){function o(t,i){for(u=0;u<t.length;u++){var r=t[u];(f.indexOf(r.xref)!==-1||f.indexOf(r.yref)!==-1)&&i(n,u)}}for(var f=[],f=[t._id,i._id],u=0;u<f.length;u++)e.doTicks(n,f[u],!0);o(c.annotations||[],r.getComponentMethod("annotations","drawOne"));o(c.shapes||[],r.getComponentMethod("shapes","drawOne"));o(c.images||[],r.getComponentMethod("images","draw"))}function d(n){var t=n.xaxis,r=n.yaxis;c._defs.selectAll("#"+n.clipId).call(i.setTranslate,0,0).call(i.setScale,1,1);n.plot.call(i.setTranslate,t._offset,r._offset).call(i.setScale,1,1).selectAll(".points").selectAll(".point").call(i.setPointGroupScale,1,1)}function ut(t,r){var o,u,e,s=a[t.xaxis._id],h=a[t.yaxis._id],f=[],k,d,g,nt;s?(o=n._fullLayout[s.axisName],u=o._r,e=s.to,f[0]=(u[0]*(1-r)+r*e[0]-u[0])/(u[1]-u[0])*t.xaxis._length,k=u[1]-u[0],d=e[1]-e[0],o.range[0]=u[0]*(1-r)+r*e[0],o.range[1]=u[1]*(1-r)+r*e[1],f[2]=t.xaxis._length*(1-r+r*d/k)):(f[0]=0,f[2]=t.xaxis._length);h?(o=n._fullLayout[h.axisName],u=o._r,e=h.to,f[1]=(u[1]*(1-r)+r*e[1]-u[1])/(u[0]-u[1])*t.yaxis._length,g=u[1]-u[0],nt=e[1]-e[0],o.range[0]=u[0]*(1-r)+r*e[0],o.range[1]=u[1]*(1-r)+r*e[1],f[3]=t.yaxis._length*(1-r+r*nt/g)):(f[1]=0,f[3]=t.yaxis._length);rt(t.xaxis,t.yaxis);var l=t.xaxis,v=t.yaxis,y=!!s,p=!!h,w=y?l._length/f[2]:1,b=p?v._length/f[3]:1,tt=y?f[0]:0,it=p?f[1]:0,ut=y?f[0]/f[2]*l._length:0,ft=p?f[1]/f[3]*v._length:0,et=l._offset-ut,ot=v._offset-ft;c._defs.selectAll("#"+t.clipId).call(i.setTranslate,tt,it).call(i.setScale,1/w,1/b);t.plot.call(i.setTranslate,et,ot).call(i.setScale,w,b).selectAll(".points").selectAll(".point").call(i.setPointGroupScale,1/w,1/b)}function ft(){for(var i,r,f={},t=0;t<v.length;t++)i=n._fullLayout[a[v[t]].axisName],r=a[v[t]].to,f[i._name+".range[0]"]=r[0],f[i._name+".range[1]"]=r[1],i.range=r.slice();return p&&p(),u.relayout(n,f).then(function(){for(var n=0;n<l.length;n++)d(l[n])})}function et(){for(var t,i={},r=0;r<v.length;r++)t=n._fullLayout[v[r]+"axis"],i[t._name+".range[0]"]=t.range[0],i[t._name+".range[1]"]=t.range[1],t.range=t._r.slice();return u.relayout(n,i).then(function(){for(var n=0;n<l.length;n++)d(l[n])})}function k(){var t,i,n;for(b=Date.now(),t=Math.min(1,(b-w)/s.duration),i=g(t),n=0;n<l.length;n++)ut(l[n],i);b-w>s.duration?(ft(),y=window.cancelAnimationFrame(k)):y=window.requestAnimationFrame(k)}var c=n._fullLayout,nt=[],a=tt(t),v=Object.keys(a),l=it(c,v,a),p,w,b,y,g;return l.length?(h&&(p=h()),g=f.ease(s.easing),n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(y),y=null,et()}),w=Date.now(),y=window.requestAnimationFrame(k),Promise.resolve()):!1}},{"../../lib":681,"../../plotly":706,"../../registry":784,"./axes":710,d3:129}],729:[function(n,t){"use strict";t.exports={family:{valType:"string",noBlank:!0,strict:!0},size:{valType:"number",min:1},color:{valType:"color"}}},{}],730:[function(n,t){"use strict";t.exports={group:{valType:"string"},name:{valType:"string"},traces:{valType:"data_array"},baseframe:{valType:"string"},data:{valType:"data_array"},layout:{valType:"any"}}},{}],731:[function(n,t){"use strict";var i=t.exports={};i.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3"};i.axesNames=["lonaxis","lataxis"];i.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360};i.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180};i.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,80],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}};i.clipPad=.001;i.precision=.1;i.landColor="#F0DC82";i.waterColor="#3399FF";i.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"};i.sphereSVG={type:"Sphere"};i.fillLayers=["ocean","land","lakes"];i.lineLayers=["subunits","countries","coastlines","rivers","frame"];i.baseLayers=["ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame"];i.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"};i.baseLayersOverChoropleth=["rivers","lakes"]},{}],732:[function(n,t){"use strict";function l(n,t){this.id=n.id;this.graphDiv=n.graphDiv;this.container=n.container;this.topojsonURL=n.topojsonURL;this.hoverContainer=null;this.topojsonName=null;this.topojson=null;this.projectionType=null;this.projection=null;this.clipAngle=null;this.setScale=null;this.path=null;this.zoom=null;this.zoomReset=null;this.xaxis=null;this.yaxis=null;this.makeFramework();this.updateFx(t.hovermode);this.traceHash={}}function b(n){for(var i,u,r=[],t=0;t<n.length;t++)i=n[t],u=i[0].trace,u.visible===!0&&r.push(i);return r}function k(n,t,i){return u.geo.graticule().extent([[n[0],t[0]],[n[1],t[1]]]).step(i)}function d(n,t,i){var u=r.layerNameToAdjective[t];n.select("."+t).selectAll("path").attr("stroke","none").call(f.fill,i[u+"color"])}function g(n,t,i){var u=r.layerNameToAdjective[t];n.select("."+t).selectAll("path").attr("fill","none").call(f.stroke,i[u+"color"]).call(o.dashLine,"",i[u+"width"])}function nt(n,t,i){n.select("."+t+"graticule").selectAll("path").attr("fill","none").call(f.stroke,i[t].gridcolor).call(o.dashLine,"",i[t].gridwidth)}function tt(n){var t={type:"linear",showexponent:"all",exponentformat:s.layoutAttributes.exponentformat.dflt,_gd:{_fullLayout:n}};return s.setConvert(t),t}var u=n("d3"),f=n("../../components/color"),o=n("../../components/drawing"),s=n("../../plots/cartesian/axes"),e=n("../../plots/cartesian/graph_interact"),a=n("./projections"),v=n("./set_scale"),y=n("./zoom"),p=n("./zoom_reset"),r=n("./constants"),h=n("../../constants/xmlns_namespaces"),c=n("../../lib/topojson_utils"),w=n("topojson").feature,i;a(u);t.exports=l;i=l.prototype;i.plot=function(n,t,i){var r=this,f=t[r.id],h=t._size,s,o;r.projection=null;r.setScale=v(f,h);r.makeProjection(f);r.makePath();r.adjustLayout(f,h);r.zoom=y(r,f);r.zoomReset=p(r,f);r.mockAxis=tt(t);r.framework.call(r.zoom).on("dblclick.zoom",r.zoomReset);r.framework.on("mousemove",function(){var n=u.mouse(this),t=r.projection.invert(n),i;isNaN(t[0])||isNaN(t[1])||(i={target:!0,xpx:n[0],ypx:n[1]},r.xaxis.c2p=function(){return n[0]},r.xaxis.p2c=function(){return t[0]},r.yaxis.c2p=function(){return n[1]},r.yaxis.p2c=function(){return t[1]},e.hover(r.graphDiv,i,r.id))});r.framework.on("mouseout",function(){e.loneUnhover(t._toppaper)});r.framework.on("click",function(){e.click(r.graphDiv,{target:!0})});if(s=c.getTopojsonName(f),r.topojson===null||s!==r.topojsonName)if(r.topojsonName=s,PlotlyGeoAssets.topojson[r.topojsonName]!==undefined){r.topojson=PlotlyGeoAssets.topojson[r.topojsonName];r.onceTopojsonIsLoaded(n,f)}else o=c.getTopojsonPath(r.topojsonURL,r.topojsonName),i.push(new Promise(function(t,i){u.json(o,function(u,e){if(u){u.status===404?i(new Error(["plotly.js could not find topojson file at",o,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):i(new Error(["unexpected error while fetching topojson file at",o].join(" ")));return}r.topojson=e;PlotlyGeoAssets.topojson[r.topojsonName]=e;r.onceTopojsonIsLoaded(n,f);t()})}));else r.onceTopojsonIsLoaded(n,f)};i.onceTopojsonIsLoaded=function(n,t){var i,o,r,s,f,h,u,e,c,a,l,v;for(this.drawLayout(t),o=this.traceHash,r={},i=0;i<n.length;i++)s=n[i],f=s[0].trace,r[f.type]=r[f.type]||[],r[f.type].push(s);for(h=Object.keys(o),u=Object.keys(r),i=0;i<h.length;i++)e=h[i],u.indexOf(e)===-1&&(c=o[e][0],a=c[0].trace,a.visible=!1,r[e]=[c]);for(u=Object.keys(r),i=0;i<u.length;i++)l=r[u[i]],v=l[0][0].trace._module,v.plot(this,b(l),t);this.traceHash=r;this.render()};i.updateFx=function(n){this.showHover=n!==!1};i.makeProjection=function(n){var t=n.projection,f=t.type,e=this.projection===null||f!==this.projectionType,i;e?(this.projectionType=f,i=this.projection=u.geo[r.projNames[f]]()):i=this.projection;i.translate(t._translate0).precision(r.precision);n._isAlbersUsa||i.rotate(t._rotate).center(t._center);n._clipAngle?(this.clipAngle=n._clipAngle,i.clipAngle(n._clipAngle-r.clipPad)):this.clipAngle=null;t.parallels&&i.parallels(t.parallels);e&&this.setScale(i);i.translate(t._translate).scale(t._scale)};i.makePath=function(){this.path=u.geo.path().projection(this.projection)};i.makeFramework=function(){var t=this.geoDiv=u.select(this.container).append("div"),i,n;t.attr("id",this.id).style("position","absolute");i=this.hoverContainer=t.append("svg");i.attr(h.svgAttrs).style({position:"absolute","z-index":20,"pointer-events":"none"});n=this.framework=t.append("svg");n.attr(h.svgAttrs).attr({position:"absolute",preserveAspectRatio:"none"});n.append("g").attr("class","bglayer").append("rect");n.append("g").attr("class","baselayer");n.append("g").attr("class","choroplethlayer");n.append("g").attr("class","baselayeroverchoropleth");n.append("g").attr("class","scattergeolayer");n.on("dblclick.zoom",null);this.xaxis={_id:"x"};this.yaxis={_id:"y"}};i.adjustLayout=function(n,t){var i=n.domain,r=t.l+t.w*i.x[0]+n._marginX,u=t.t+t.h*(1-i.y[1])+n._marginY;this.geoDiv.style({left:r+"px",top:u+"px",width:n._width+"px",height:n._height+"px"});this.hoverContainer.attr({width:n._width,height:n._height});this.framework.attr({width:n._width,height:n._height});this.framework.select(".bglayer").select("rect").attr({width:n._width,height:n._height}).call(f.fill,n.bgcolor);this.xaxis._offset=r;this.xaxis._length=n._width;this.yaxis._offset=u;this.yaxis._length=n._height};i.drawTopo=function(n,t,i){if(i["show"+t]===!0){var u=this.topojson,f=t==="frame"?r.sphereSVG:w(u,u.objects[t]);n.append("g").datum(f).attr("class",t).append("path").attr("class","basepath")}};i.drawGraticule=function(n,t,i){var u=i[t];if(u.showgrid===!0){var f=r.scopeDefaults[i.scope],e=f.lonaxisRange,o=f.lataxisRange,s=t==="lonaxis"?[u.dtick]:[0,u.dtick],h=k(e,o,s);n.append("g").datum(h).attr("class",t+"graticule").append("path").attr("class","graticulepath")}};i.drawLayout=function(n){var u=this.framework.select("g.baselayer"),f=r.baseLayers,e=r.axesNames,t,i;for(u.selectAll("*").remove(),i=0;i<f.length;i++)t=f[i],e.indexOf(t)!==-1?this.drawGraticule(u,t,n):this.drawTopo(u,t,n);this.styleLayout(n)};i.styleLayer=function(n,t,i){var u=r.fillLayers,f=r.lineLayers;u.indexOf(t)!==-1?d(n,t,i):f.indexOf(t)!==-1&&g(n,t,i)};i.styleLayout=function(n){for(var u=this.framework.select("g.baselayer"),f=r.baseLayers,e=r.axesNames,t,i=0;i<f.length;i++)t=f[i],e.indexOf(t)!==-1?nt(u,t,n):this.styleLayer(u,t,n)};i.isLonLatOverEdges=function(n){var t=this.clipAngle;if(t===null)return!1;var i=this.projection.rotate(),r=u.geo.distance(n,[-i[0],-i[1]]),f=t*Math.PI/180;return r>f};i.render=function(){function u(t){var i=n.projection(t.lonlat);return i?"translate("+i[0]+","+i[1]+")":null}function e(t){return n.isLonLatOverEdges(t.lonlat)?"0":"1.0"}var n=this,r=n.framework,f=r.select("g.choroplethlayer"),t=r.select("g.scattergeolayer"),i=n.path;r.selectAll("path.basepath").attr("d",i);r.selectAll("path.graticulepath").attr("d",i);f.selectAll("path.choroplethlocation").attr("d",i);f.selectAll("path.basepath").attr("d",i);t.selectAll("path.js-line").attr("d",i);n.clipAngle!==null?(t.selectAll("path.point").style("opacity",e).attr("transform",u),t.selectAll("text").style("opacity",e).attr("transform",u)):(t.selectAll("path.point").attr("transform",u),t.selectAll("text").attr("transform",u))}},{"../../components/color":582,"../../components/drawing":605,"../../constants/xmlns_namespaces":666,"../../lib/topojson_utils":696,"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717,"./constants":731,"./projections":739,"./set_scale":740,"./zoom":741,"./zoom_reset":742,d3:129,topojson:547}],733:[function(n,t,i){"use strict";function f(n,t){for(var r,f,u=[],i=0;i<n.length;i++)r=n[i],f=r[0].trace,f.geo===t&&u.push(r);return u}var u=n("./geo"),r=n("../../plots/plots");i.name="geo";i.attr="geo";i.idRoot="geo";i.idRegex=/^geo([2-9]|[1-9][0-9]+)?$/;i.attrRegex=/^geo([2-9]|[1-9][0-9]+)?$/;i.attributes=n("./layout/attributes");i.layoutAttributes=n("./layout/layout_attributes");i.supplyLayoutDefaults=n("./layout/defaults");i.plot=function(n){var t=n._fullLayout,h=n.calcdata,s=r.getSubplotIds(t,"geo"),i;for(window.PlotlyGeoAssets===undefined&&(window.PlotlyGeoAssets={topojson:{}}),i=0;i<s.length;i++){var e=s[i],c=f(h,e),o=t[e]._subplot;o===undefined&&(o=new u({id:e,graphDiv:n,container:t._geocontainer.node(),topojsonURL:n._context.topojsonURL},t),t[e]._subplot=o);o.plot(c,t,n._promises)}};i.clean=function(n,t,i,u){for(var e,o,s=r.getSubplotIds(u,"geo"),f=0;f<s.length;f++)e=s[f],o=u[e]._subplot,t[e]||!o||o.geoDiv.remove()};i.toSVG=function(n){for(var i=n._fullLayout,o=r.getSubplotIds(i,"geo"),u=i._size,f=0;f<o.length;f++){var t=i[o[f]],s=t.domain,e=t._subplot.framework;e.attr("style",null);e.attr({x:u.l+u.w*s.x[0]+t._marginX,y:u.t+u.h*(1-s.y[1])+t._marginY,width:t._width,height:t._height});i._geoimages.node().appendChild(e.node())}}},{"../../plots/plots":769,"./geo":732,"./layout/attributes":734,"./layout/defaults":737,"./layout/layout_attributes":738}],734:[function(n,t){"use strict";t.exports={geo:{valType:"subplotid",dflt:"geo"}}},{}],735:[function(n,t){"use strict";var i=n("../../../components/color/attributes");t.exports={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number"},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:i.lightLine},gridwidth:{valType:"number",min:0,dflt:1}}},{"../../../components/color/attributes":581}],736:[function(n,t){"use strict";var r=n("../../../lib"),i=n("../constants"),u=n("./axis_attributes");t.exports=function(n,t){function f(n,t){return r.coerce(s,o,u,n,t)}function y(n){var h=t.scope,u,f,e,o,r,s;return h==="world"?(u=t.projection,f=u.type,e=u.rotation,r=i[n+"Span"],s=r[f]!==undefined?r[f]/2:r["*"]/2,o=n==="lonaxis"?e.lon:e.lat,[o-s,o+s]):i.scopeDefaults[h][n+"Range"]}for(var e,c,a,v,l=i.axesNames,s,o,h=0;h<l.length;h++)e=l[h],s=n[e]||{},o={},c=y(e),a=f("range",c),r.noneOrAll(s.range,o.range,[0,1]),f("tick0",a[0]),f("dtick",e==="lonaxis"?30:10),v=f("showgrid"),v&&(f("gridcolor"),f("gridwidth")),t[e]=o,t[e]._fullRange=c}},{"../../../lib":681,"../constants":731,"./axis_attributes":735}],737:[function(n,t){"use strict";function e(n,t,r){var u,e=r("scope"),o=e!=="world",c=i.scopeDefaults[e],a=r("resolution"),l=r("projection.type",c.projType),v=l==="albers usa",y=l.indexOf("conic")!==-1,p,s,h;y&&(p=c.projParallels||[0,60],r("projection.parallels",p));v?t.scope="usa":(s=c.projRotate||[0,0,0],r("projection.rotation.lon",s[0]),r("projection.rotation.lat",s[1]),r("projection.rotation.roll",s[2]),u=r("showcoastlines",!o),u&&(r("coastlinecolor"),r("coastlinewidth")),u=r("showocean"),u&&r("oceancolor"));r("projection.scale");u=r("showland");u&&r("landcolor");u=r("showlakes");u&&r("lakecolor");u=r("showrivers");u&&(r("rivercolor"),r("riverwidth"));u=r("showcountries",o);u&&(r("countrycolor"),r("countrywidth"));(e==="usa"||e==="north america"&&a===50)&&(r("showsubunits",!0),r("subunitcolor"),r("subunitwidth"));o||(u=r("showframe",!0),u&&(r("framecolor"),r("framewidth")));r("bgcolor");f(n,t);t._isHighRes=a===50;t._clipAngle=i.lonaxisSpan[l]/2;t._isAlbersUsa=v;t._isConic=y;t._isScoped=o;h=t.projection.rotation||{};t.projection._rotate=[-h.lon||0,-h.lat||0,h.roll||0]}var r=n("../../subplot_defaults"),i=n("../constants"),u=n("./layout_attributes"),f=n("./axis_defaults");t.exports=function(n,t,i){r(n,t,i,{type:"geo",attributes:u,handleDefaults:e,partition:"y"})}},{"../../subplot_defaults":776,"../constants":731,"./axis_defaults":736,"./layout_attributes":738}],738:[function(n,t){"use strict";var r=n("../../../components/color/attributes"),i=n("../constants"),u=n("./axis_attributes");t.exports={domain:{x:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},y:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]}},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(i.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(i.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,max:10,dflt:1}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:r.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:i.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:i.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:i.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:i.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:r.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:r.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:r.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:r.background},lonaxis:u,lataxis:u}},{"../../../components/color/attributes":581,"../constants":731,"./axis_attributes":735}],739:[function(n,t){"use strict";function i(n){function it(n,t){return{type:"Feature",id:n.id,properties:n.properties,geometry:a(n.geometry,t)}}function a(t,i){if(!t)return null;if(t.type==="GeometryCollection")return{type:"GeometryCollection",geometries:object.geometries.map(function(n){return a(n,i)})};if(!et.hasOwnProperty(t.type))return null;var r=et[t.type];return n.geo.stream(t,i(r)),r.result()}function h(){}function lt(n){if((i=n.length)<4)return!1;for(var t=0,i,r=n[i-1][1]*n[0][0]-n[i-1][0]*n[0][1];++t<i;)r+=n[t-1][1]*n[t][0]-n[t-1][0]*n[t][1];return r<=0}function at(n,t){for(var a=t[0],i=t[1],r=!1,u=0,e=n.length,o=e-1;u<e;o=u++){var s=n[u],h=s[0],f=s[1],c=n[o],v=c[0],l=c[1];f>i^l>i&&a<(v-h)*(i-f)/(l-f)+h&&(r=!r)}return r}function wt(n){return n?n/Math.sin(n):1}function s(n){return n>1?r:n<-1?-r:Math.asin(n)}function y(n){return n>1?0:n<-1?t:Math.acos(n)}function p(n,i){var s=(2+r)*Math.sin(i),e,o,u;for(i/=2,e=0,o=Infinity;e<10&&Math.abs(o)>f;e++)u=Math.cos(i),i-=o=(i+Math.sin(i)*(u+2)-s)/(2*u*(1+u));return[2/Math.sqrt(t*(4+t))*n*(1+Math.cos(i)),2*Math.sqrt(t/(4+t))*Math.sin(i)]}function st(n,t){function i(i,r){var u=c(i/t,r);return u[0]*=n,u}return(arguments.length<2&&(t=n),t===1)?c:t===Infinity?ht:(i.invert=function(i,r){var u=c.invert(i/n,r);return u[0]*=t,u},i)}function bt(){var n=2,t=ot(st),i=t(n);return i.coefficient=function(i){return arguments.length?t(n=+i):n},i}function ht(n,t){return[n*Math.cos(t)/Math.cos(t/=2),2*Math.sin(t)]}function w(n,i){return[3*n/(2*t)*Math.sqrt(t*t/3-i*i),i]}function b(n,i){return[n,1.25*Math.log(Math.tan(t/4+.4*i))]}function ct(n){return function(t){var r=n*Math.sin(t),u=30,i;do t-=i=(t+Math.sin(t)-r)/(1+Math.cos(t));while(Math.abs(i)>f&&--u>0);return t/2}}function kt(n,t,i){function r(i,r){return[n*i*Math.cos(r=u(r)),t*Math.sin(r)]}var u=ct(i);return r.invert=function(r,u){var f=s(u/t);return[r/(n*Math.cos(f)),s((2*f+Math.sin(2*f))/i)]},r}function d(n,t){var i=t*t,r=i*i;return[n*(.8707-.131979*i+r*(-.013791+r*(.003971*i-.001529*r))),t*(1.007226+i*(.015085+r*(-.044475+.028874*i-.005916*r)))]}function g(n,i){var s=Math.min(18,Math.abs(i)*36/t),o=Math.floor(s),f=s-o,h=(e=u[o])[0],c=e[1],l=(e=u[++o])[0],a=e[1],v=(e=u[Math.min(19,++o)])[0],y=e[1],e;return[n*(l+f*(v-h)/2+f*f*(v-2*l+h)/2),(i>0?r:-r)*(a+f*(y-c)/2+f*f*(y-2*a+c)/2)]}function nt(n,t){return[n*Math.cos(t),t]}function l(n,t){var i=Math.cos(t),r=wt(y(i*Math.cos(n/=2)));return[2*i*Math.sin(n)*r,Math.sin(t)*r]}function tt(n,t){var i=l(n,t);return[(i[0]+n/r)/2,(i[1]+t)/2]}var o,ot,c,dt,k,u;n.geo.project=function(n,t){var i=t.stream;if(!i)throw new Error("not yet supported");return(n&&rt.hasOwnProperty(n.type)?rt[n.type]:a)(n,i)};var rt={Feature:it,FeatureCollection:function(n,t){return{type:"FeatureCollection",features:n.features.map(function(n){return it(n,t)})}}},i=[],e=[],ut={point:function(n,t){i.push([n,t])},result:function(){var n=i.length?i.length<2?{type:"Point",coordinates:i[0]}:{type:"MultiPoint",coordinates:i}:null;return i=[],n}},ft={lineStart:h,point:function(n,t){i.push([n,t])},lineEnd:function(){i.length&&(e.push(i),i=[])},result:function(){var n=e.length?e.length<2?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}:null;return e=[],n}},v={polygonStart:h,lineStart:h,point:function(n,t){i.push([n,t])},lineEnd:function(){var n=i.length;if(n){do i.push(i[0].slice());while(++n<4);e.push(i);i=[]}},polygonEnd:h,result:function(){if(!e.length)return null;var n=[],t=[];return e.forEach(function(i){lt(i)?n.push([i]):t.push(i)}),t.forEach(function(t){var i=t[0];n.some(function(n){if(at(n[0],i))return n.push(t),!0})||n.push([t])}),e=[],n.length?n.length>1?{type:"MultiPolygon",coordinates:n}:{type:"Polygon",coordinates:n[0]}:null}},et={Point:ut,MultiPoint:ut,LineString:ft,MultiLineString:ft,Polygon:v,MultiPolygon:v,Sphere:v};var f=1e-6,vt=f*f,t=Math.PI,r=t/2,gt=Math.sqrt(t),yt=t/180,pt=180/t;o=n.geo.projection;ot=n.geo.projectionMutator;n.geo.interrupt=function(i){function o(n,t){for(var e,o=t<0?-1:1,f=u[+(t<0)],r=0,s=f.length-1;r<s&&n>f[r][2][0];++r);return e=i(n-f[r][1][0],t),e[0]+=i(f[r][1][0],o*t>o*f[r][0][1]?f[r][0][1]:t)[0],e}function l(){h=u.map(function(n){return n.map(function(n){var f=i(n[0][0],n[0][1])[0],e=i(n[2][0],n[2][1])[0],t=i(n[1][0],n[0][1])[1],r=i(n[1][0],n[1][1])[1],u;return t>r&&(u=t,t=r,r=u),[[f,t],[e,r]]})})}function a(){for(var i=1e-6,h=[],f=0,v=u[0].length;f<v;++f){var r=u[0][f],e=r[0][0]*180/t,l=r[0][1]*180/t,o=r[1][1]*180/t,s=r[2][0]*180/t,a=r[2][1]*180/t;h.push(c([[e+i,l+i],[e+i,o-i],[s-i,o-i],[s-i,a+i]],30))}for(f=u[1].length-1;f>=0;--f){var r=u[1][f],e=r[0][0]*180/t,l=r[0][1]*180/t,o=r[1][1]*180/t,s=r[2][0]*180/t,a=r[2][1]*180/t;h.push(c([[s-i,a-i],[s-i,o+i],[e+i,o+i],[e+i,l-i]],30))}return{type:"Polygon",coordinates:[n.merge(h)]}}function c(n,t){for(var e=-1,h=n.length,i=n[0],r,o,s,f=[],u;++e<h;){for(r=n[e],o=(r[0]-i[0])/t,s=(r[1]-i[1])/t,u=0;u<t;++u)f.push([i[0]+u*o,i[1]+u*s]);i=r}return f.push(r),f}function v(n,t){return Math.abs(n[0]-t[0])<f&&Math.abs(n[1]-t[1])<f}var u=[[[[-t,0],[0,r],[t,0]]],[[[-t,0],[0,-r],[t,0]]]],h,e,s;return i.invert&&(o.invert=function(n,t){for(var f,e,s=h[+(t<0)],c=u[+(t<0)],r=0,l=s.length;r<l;++r)if(f=s[r],f[0][0]<=n&&n<f[1][0]&&f[0][1]<=t&&t<f[1][1])return e=i.invert(n-i(c[r][1][0],0)[0],t),e[0]+=c[r][1][0],v(o(e[0],e[1]),[n,t])?e:null}),e=n.geo.projection(o),s=e.stream,e.stream=function(t){var r=e.rotate(),i=s(t),u=(e.rotate([0,0]),s(t));return e.rotate(r),i.sphere=function(){n.geo.stream(a(),u)},i},e.lobes=function(n){return arguments.length?(u=n.map(function(n){return n.map(function(n){return[[n[0][0]*t/180,n[0][1]*t/180],[n[1][0]*t/180,n[1][1]*t/180],[n[2][0]*t/180,n[2][1]*t/180]]})}),l(),e):u.map(function(n){return n.map(function(n){return[[n[0][0]*180/t,n[0][1]*180/t],[n[1][0]*180/t,n[1][1]*180/t],[n[2][0]*180/t,n[2][1]*180/t]]})})},e};p.invert=function(n,i){var u=.5*i*Math.sqrt((4+t)/t),f=s(u),e=Math.cos(f);return[n/(2/Math.sqrt(t*(4+t))*(1+e)),s((f+u*(e+2))/(2+r))]};(n.geo.eckert4=function(){return o(p)}).raw=p;c=n.geo.azimuthalEqualArea.raw;ht.invert=function(n,t){var i=2*s(t/2);return[n*Math.cos(i/2)/Math.cos(i),i]};(n.geo.hammer=bt).raw=st;w.invert=function(n,i){return[2/3*t*n/Math.sqrt(t*t/3-i*i),i]};(n.geo.kavrayskiy7=function(){return o(w)}).raw=w;b.invert=function(n,i){return[n,2.5*Math.atan(Math.exp(.8*i))-.625*t]};(n.geo.miller=function(){return o(b)}).raw=b;dt=ct(t);k=kt(Math.SQRT2/r,Math.SQRT2,t);(n.geo.mollweide=function(){return o(k)}).raw=k;d.invert=function(n,t){var r=t,o=25,e,i,u;do i=r*r,u=i*i,r-=e=(r*(1.007226+i*(.015085+u*(-.044475+.028874*i-.005916*u)))-t)/(1.007226+i*(.015085*3+u*(-.044475*7+.028874*9*i-.005916*11*u)));while(Math.abs(e)>f&&--o>0);return[n/(.8707+(i=r*r)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),r]};(n.geo.naturalEarth=function(){return o(d)}).raw=d;u=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];u.forEach(function(n){n[1]*=1.0144});g.invert=function(n,t){var a=t/r,e=a*90,o=Math.min(18,Math.abs(e/5)),i=Math.max(0,Math.floor(o)),p,w;do{var s=u[i][1],h=u[i+1][1],c=u[Math.min(19,i+2)][1],v=c-s,g=c-2*h+s,l=2*(Math.abs(a)-h)/v,y=g/v,f=l*(1-y*l*(1-2*y*l));if(f>=0||i===1){e=(t>=0?5:-5)*(f+o);p=50;do o=Math.min(18,Math.abs(e)/5),i=Math.floor(o),f=o-i,s=u[i][1],h=u[i+1][1],c=u[Math.min(19,i+2)][1],e-=(w=(t>=0?r:-r)*(h+f*(c-s)/2+f*f*(c-2*h+s)/2)-t)*pt;while(Math.abs(w)>vt&&--p>0);break}}while(--i>=0);var b=u[i][0],k=u[i+1][0],d=u[Math.min(19,i+2)][0];return[n/(k+f*(d-b)/2+f*f*(d-2*k+b)/2),e*yt]};(n.geo.robinson=function(){return o(g)}).raw=g;nt.invert=function(n,t){return[n/Math.cos(t),t]};(n.geo.sinusoidal=function(){return o(nt)}).raw=nt;l.invert=function(n,i){var p,w;if(!(n*n+4*i*i>t*t+f)){var o=n,s=i,ot=25;do{var b=Math.sin(o),h=Math.sin(o/2),c=Math.cos(o/2),l=Math.sin(s),r=Math.cos(s),k=Math.sin(2*s),d=l*l,a=r*r,g=h*h,nt=1-a*c*c,u=nt?y(r*c)*Math.sqrt(e=1/nt):e=0,e,tt=2*u*r*h-n,it=u*l-i,rt=e*(a*g+u*r*c*d),ut=e*(.5*b*k-u*2*l*h),ft=e*.25*(k*h-u*l*a*b),et=e*(d*c+u*g*r),v=ut*ft-et*rt;if(!v)break;p=(it*ut-tt*et)/v;w=(tt*ft-it*rt)/v;o-=p;s-=w}while((Math.abs(p)>f||Math.abs(w)>f)&&--ot>0);return[o,s]}};(n.geo.aitoff=function(){return o(l)}).raw=l;tt.invert=function(n,t){var i=n,u=t,ot=25;do{var e=Math.cos(u),h=Math.sin(u),v=Math.sin(2*u),p=h*h,a=e*e,w=Math.sin(i),c=Math.cos(i/2),l=Math.sin(i/2),b=l*l,k=1-a*c*c,o=k?y(e*c)*Math.sqrt(s=1/k):s=0,s,d=.5*(2*o*e*l+i/r)-n,g=.5*(o*h+u)-t,nt=.5*s*(a*b+o*e*c*p)+.5/r,tt=s*(w*v/4-o*h*l),it=.125*s*(v*l-o*h*a*w),rt=.5*s*(p*c+o*b*e)+.5,ut=tt*it-rt*nt,ft=(g*tt-d*rt)/ut,et=(d*it-g*nt)/ut;i-=ft;u-=et}while((Math.abs(ft)>f||Math.abs(et)>f)&&--ot>0);return[i,u]};(n.geo.winkel3=function(){return o(tt)}).raw=tt}t.exports=i},{}],740:[function(n,t){"use strict";function e(n,t){var f=n.projection,e=n.lonaxis,o=n.lataxis,s=n.domain,h=n.framewidth||0,c=t.w*(s.x[1]-s.x[0]),l=t.h*(s.y[1]-s.y[0]),a=e.range[0]+i,y=e.range[1]-i,v=o.range[0]+i,p=o.range[1]-i,k=e._fullRange[0]+i,d=e._fullRange[1]-i,g=o._fullRange[0]+i,nt=o._fullRange[1]-i;f._translate0=[t.l+c/2,t.t+l/2];var tt=y-a,it=p-v,w=[a+tt/2,v+it/2],b=f._rotate;return f._center=[w[0]+b[0],w[1]+b[1]],function(t){function it(n){return Math.min(w*c/(n[1][0]-n[0][0]),w*l/(n[1][1]-n[0][1]))}var w=t.scale(),b=f._translate0,o=u(a,v,y,p),rt=u(k,g,d,nt),e,s,i,tt;i=r(t,o);e=it(i);tt=r(t,rt);f._fullScale=it(tt);t.scale(e);i=r(t,o);s=[b[0]-i[0][0]+h,b[1]-i[0][1]+h];f._translate=s;t.translate(s);i=r(t,o);n._isAlbersUsa||t.clipExtent(i);e=f.scale*e;f._scale=e;n._width=Math.round(i[1][0])+h;n._height=Math.round(i[1][1])+h;n._marginX=(c-Math.round(i[1][0]))/2;n._marginY=(l-Math.round(i[1][1]))/2}}function u(n,t,i,r){var u=(i-n)/4;return{type:"Polygon",coordinates:[[[n,t],[n,r],[n+u,r],[n+2*u,r],[n+3*u,r],[i,r],[i,t],[i-u,t],[i-2*u,t],[i-3*u,t],[n,t]]]}}function r(n,t){return f.geo.path().projection(n).bounds(t)}var f=n("d3"),i=n("./constants").clipPad;t.exports=e},{"./constants":731,d3:129}],741:[function(n,t){"use strict";function v(n,t){var i;return i=t._isScoped?y:t._clipAngle?w:p,i(n,t.projection)}function s(n,t){var r=t._fullScale;return i.behavior.zoom().translate(n.translate()).scale(n.scale()).scaleExtent([.5*r,100*r])}function y(n,t){function f(){i.select(this).style(e)}function h(){r.scale(i.event.scale).translate(i.event.translate);n.render()}function c(){i.select(this).style(o)}var r=n.projection,u=s(r,t);u.on("zoomstart",f).on("zoom",h).on("zoomend",c);return u}function p(n,t){function f(n){return r.invert(n)}function k(n){var t=r(f(n));return Math.abs(t[0]-n[0])>p||Math.abs(t[1]-n[1])>p}function d(){i.select(this).style(e);u=i.mouse(this);c=r.rotate();w=r.translate();v=c;l=f(u)}function g(){if(a=i.mouse(this),k(u)){h.scale(r.scale());h.translate(r.translate());return}r.scale(i.event.scale);r.translate([w[0],i.event.translate[1]]);l?f(a)&&(b=f(a),y=[v[0]+(b[0]-l[0]),c[1],c[2]],r.rotate(y),v=y):(u=a,l=f(u));n.render()}function nt(){i.select(this).style(o)}var r=n.projection,h=s(r,t),p=2,u,c,w,v,l,a,y,b;h.on("zoomstart",d).on("zoom",g).on("zoomend",nt);return h}function w(n,t){function y(n){a++||n({type:"zoomstart"})}function p(n){n({type:"zoom"})}function w(n){--a||n({type:"zoomend"})}var r=n.projection,l={r:r.rotate(),k:r.scale()},u=s(r,t),c=rt(u,"zoomstart","zoom","zoomend"),a=0,v=u.on,h;u.on("zoomstart",function(){i.select(this).style(e);var n=i.mouse(this),t=r.rotate(),o=t,s=r.translate(),a=b(t);h=f(r,n);v.call(u,"zoom",function(){var e=i.mouse(this);if(r.scale(l.k=i.event.scale),h){if(f(r,e)){r.rotate(t).translate(s);var v=f(r,e),y=d(h,v),w=nt(k(a,y)),u=l.r=g(w,h,o);isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])||(u=o);r.rotate(u);o=u}}else n=e,h=f(r,n);p(c.of(this,arguments))});y(c.of(this,arguments))}).on("zoomend",function(){i.select(this).style(o);v.call(u,"zoom",null);w(c.of(this,arguments))}).on("zoom.redraw",function(){n.render()});return i.rebind(u,c,"on")}function f(n,t){var i=n.invert(t);return i&&isFinite(i[0])&&isFinite(i[1])&&tt(i)}function b(n){var s=.5*n[0]*u,h=.5*n[1]*u,c=.5*n[2]*u,t=Math.sin(s),i=Math.cos(s),r=Math.sin(h),f=Math.cos(h),e=Math.sin(c),o=Math.cos(c);return[i*f*o+t*r*e,t*f*o-i*r*e,i*r*o+t*f*e,i*f*e-t*r*o]}function k(n,t){var i=n[0],r=n[1],u=n[2],f=n[3],e=t[0],o=t[1],s=t[2],h=t[3];return[i*e-r*o-u*s-f*h,i*o+r*e+u*h-f*s,i*s-r*h+u*e+f*o,i*h+r*s-u*o+f*e]}function d(n,t){if(n&&t){var i=it(n,t),u=Math.sqrt(a(i,i)),f=.5*Math.acos(Math.max(-1,Math.min(1,a(n,t)))),r=Math.sin(f)/u;return u&&[Math.cos(f),i[2]*r,-i[1]*r,i[0]*r]}}function g(n,t,i){var u=h(t,2,n[0]);u=h(u,1,n[1]);u=h(u,0,n[2]-i[2]);var l=t[0],a=t[1],y=t[2],p=u[0],f=u[1],w=u[2],v=Math.atan2(a,l)*r,o=Math.sqrt(l*l+a*a),s,e;Math.abs(f)>o?(e=(f>0?90:-90)-v,s=0):(e=Math.asin(f/o)*r-v,s=Math.sqrt(o*o-f*f));var b=180-e-2*v,k=(Math.atan2(w,p)-Math.atan2(y,s))*r,d=(Math.atan2(w,p)-Math.atan2(y,-s))*r,g=c(i[0],i[1],e,k),nt=c(i[0],i[1],b,d);return g<=nt?[e,k,i[2]]:[b,d,i[2]]}function c(n,t,i,r){var u=l(i-n),f=l(r-t);return Math.sqrt(u*u+f*f)}function l(n){return(n%360+540)%360-180}function h(n,t,i){var o=i*u,r=n.slice(),f=t===0?1:0,e=t===2?1:2,s=Math.cos(o),h=Math.sin(o);return r[f]=n[f]*s-n[e]*h,r[e]=n[e]*s+n[f]*h,r}function nt(n){return[Math.atan2(2*(n[0]*n[1]+n[2]*n[3]),1-2*(n[1]*n[1]+n[2]*n[2]))*r,Math.asin(Math.max(-1,Math.min(1,2*(n[0]*n[2]-n[3]*n[1]))))*r,Math.atan2(2*(n[0]*n[3]+n[1]*n[2]),1-2*(n[2]*n[2]+n[3]*n[3]))*r]}function tt(n){var t=n[0]*u,i=n[1]*u,r=Math.cos(i);return[r*Math.cos(t),r*Math.sin(t),Math.sin(i)]}function a(n,t){for(var r=0,i=0,u=n.length;i<u;++i)r+=n[i]*t[i];return r}function it(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function rt(n){for(var r=0,f=arguments.length,u=[],t;++r<f;)u.push(arguments[r]);return t=i.dispatch.apply(null,u),t.of=function(r,u){return function(f){var e;try{e=f.sourceEvent=i.event;f.target=n;i.event=f;t[f.type].apply(r,u)}finally{i.event=e}}},t}var i=n("d3"),u=Math.PI/180,r=180/Math.PI,e={cursor:"pointer"},o={cursor:"auto"};t.exports=v},{d3:129}],742:[function(n,t){"use strict";function r(n,t){var r=n.projection,u=n.zoom;return function(){n.makeProjection(t);n.makePath();u.scale(r.scale());u.translate(r.translate());i.loneUnhover(n.hoverContainer);n.render()}}var i=n("../cartesian/graph_interact");t.exports=r},{"../cartesian/graph_interact":717}],743:[function(n,t){"use strict";function u(n,t){this.element=n;this.plot=t;this.mouseListener=null;this.wheelListener=null;this.lastInputTime=Date.now();this.lastPos=[0,0];this.boxEnabled=!1;this.boxStart=[0,0];this.boxEnd=[0,0]}function f(n){function o(){n.xaxis.autorange=!1;n.yaxis.autorange=!1}var e=n.mouseContainer,f=n.glplot,t=new u(e,f);return t.mouseListener=i(e,function(i,r,u){function y(i,r,u){var f=Math.min(r,u),e=Math.max(r,u);f!==e?(i[0]=f,i[1]=e,t.dataBox=i):(n.selectBox.selectBox=[0,0,1,1],n.glplot.setDirty())}var e=n.xaxis.range,s=n.yaxis.range,h=f.viewBox,p=t.lastPos[0],w=t.lastPos[1],c,l,a,v;r*=f.pixelRatio;u*=f.pixelRatio;u=h[3]-h[1]-u;switch(n.fullLayout.dragmode){case"zoom":i?(c=r/(h[2]-h[0])*(e[1]-e[0])+e[0],l=u/(h[3]-h[1])*(s[1]-s[0])+s[0],t.boxEnabled||(t.boxStart[0]=c,t.boxStart[1]=l),t.boxEnd[0]=c,t.boxEnd[1]=l,t.boxEnabled=!0):t.boxEnabled&&(y(e,t.boxStart[0],t.boxEnd[0]),y(s,t.boxStart[1],t.boxEnd[1]),o(),t.boxEnabled=!1);break;case"pan":t.boxEnabled=!1;i&&(a=(p-r)*(e[1]-e[0])/(f.viewBox[2]-f.viewBox[0]),v=(w-u)*(s[1]-s[0])/(f.viewBox[3]-f.viewBox[1]),e[0]+=a,e[1]+=a,s[0]+=v,s[1]+=v,t.lastInputTime=Date.now(),o(),n.cameraChanged())}t.lastPos[0]=r;t.lastPos[1]=u}),t.wheelListener=r(e,function(i,r){var u=n.xaxis.range,e=n.yaxis.range,s=f.viewBox,a=t.lastPos[0],v=t.lastPos[1];switch(n.fullLayout.dragmode){case"pan":var h=Math.exp(.1*r/(s[3]-s[1])),c=a/(s[2]-s[0])*(u[1]-u[0])+u[0],l=v/(s[3]-s[1])*(e[1]-e[0])+e[0];u[0]=(u[0]-c)*h+c;u[1]=(u[1]-c)*h+c;e[0]=(e[0]-l)*h+l;e[1]=(e[1]-l)*h+l;t.lastInputTime=Date.now();o();n.cameraChanged()}return!0}),t}var i=n("mouse-change"),r=n("mouse-wheel");t.exports=f},{"mouse-change":513,"mouse-wheel":517}],744:[function(n,t){"use strict";function u(n){this.scene=n;this.gl=n.gl;this.pixelRatio=n.pixelRatio;this.screenBox=[0,0,1,1];this.viewBox=[0,0,1,1];this.dataBox=[-1,-1,1,1];this.borderLineEnable=[!1,!1,!1,!1];this.borderLineWidth=[1,1,1,1];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.ticks=[[],[]];this.tickEnable=[!0,!0,!1,!1];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labels=["x","y"];this.labelEnable=[!0,!0,!1,!1];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelPad=[15,15,15,15];this.labelSize=[12,12];this.labelFont=["sans-serif","sans-serif"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.title="";this.titleEnable=!0;this.titleCenter=[0,0,0,0];this.titleAngle=0;this.titleColor=[0,0,0,1];this.titleFont="sans-serif";this.titleSize=18;this.gridLineEnable=[!0,!0];this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]];this.gridLineWidth=[1,1];this.zeroLineEnable=[!0,!0];this.zeroLineWidth=[1,1];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.static=this.scene.staticPlot}function h(n){return new u(n)}var f=n("../plots"),e=n("../cartesian/axes"),o=n("../../lib/html2unicode"),i=n("../../lib/str2rgbarray"),r=u.prototype,s=["xaxis","yaxis"];r.merge=function(n){this.titleEnable=!1;this.backgroundColor=i(n.plot_bgcolor);for(var f,r,y,e,h,c,l,a,v,u,t=0;t<2;++t){for(f=s[t],r=n[this.scene[f]._name],y=/Click to enter .+ title/.test(r.title)?"":r.title,u=0;u<=2;u+=2)this.labelEnable[t+u]=!1,this.labels[t+u]=o(y),this.labelColor[t+u]=i(r.titlefont.color),this.labelFont[t+u]=r.titlefont.family,this.labelSize[t+u]=r.titlefont.size,this.labelPad[t+u]=this.getLabelPad(f,r),this.tickEnable[t+u]=!1,this.tickColor[t+u]=i((r.tickfont||{}).color),this.tickAngle[t+u]=r.tickangle==="auto"?0:Math.PI*-r.tickangle/180,this.tickPad[t+u]=this.getTickPad(r),this.tickMarkLength[t+u]=0,this.tickMarkWidth[t+u]=r.tickwidth||0,this.tickMarkColor[t+u]=i(r.tickcolor),this.borderLineEnable[t+u]=!1,this.borderLineColor[t+u]=i(r.linecolor),this.borderLineWidth[t+u]=r.linewidth||0;l=this.hasSharedAxis(r);h=this.hasAxisInDfltPos(f,r)&&!l;c=this.hasAxisInAltrPos(f,r)&&!l;e=r.mirror||!1;a=l?String(e).indexOf("all")!==-1:!!e;v=l?e==="allticks":String(e).indexOf("ticks")!==-1;h?this.labelEnable[t]=!0:c&&(this.labelEnable[t+2]=!0);h?this.tickEnable[t]=r.showticklabels:c&&(this.tickEnable[t+2]=r.showticklabels);(h||a)&&(this.borderLineEnable[t]=r.showline);(c||a)&&(this.borderLineEnable[t+2]=r.showline);(h||v)&&(this.tickMarkLength[t]=this.getTickMarkLength(r));(c||v)&&(this.tickMarkLength[t+2]=this.getTickMarkLength(r));this.gridLineEnable[t]=r.showgrid;this.gridLineColor[t]=i(r.gridcolor);this.gridLineWidth[t]=r.gridwidth;this.zeroLineEnable[t]=r.zeroline;this.zeroLineColor[t]=i(r.zerolinecolor);this.zeroLineWidth[t]=r.zerolinewidth}};r.hasSharedAxis=function(n){var t=this.scene,i=f.getSubplotIds(t.fullLayout,"gl2d"),r=e.findSubplotsWithAxis(i,n);return r.indexOf(t.id)!==0};r.hasAxisInDfltPos=function(n,t){var i=t.side;return n==="xaxis"?i==="bottom":n==="yaxis"?i==="left":void 0};r.hasAxisInAltrPos=function(n,t){var i=t.side;return n==="xaxis"?i==="top":n==="yaxis"?i==="right":void 0};r.getLabelPad=function(n,t){var i=1.5,r=t.titlefont.size,u=t.showticklabels;return n==="xaxis"?t.side==="top"?-10+r*(i+(u?1:0)):-10+r*(i+(u?.5:0)):n==="yaxis"?t.side==="right"?10+r*(i+(u?1:.5)):10+r*(i+(u?.5:0)):void 0};r.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15};r.getTickMarkLength=function(n){if(!n.ticks)return 0;var t=n.ticklen;return n.ticks==="inside"?-t:t};t.exports=h},{"../../lib/html2unicode":680,"../../lib/str2rgbarray":694,"../cartesian/axes":710,"../plots":769}],745:[function(n,t,i){"use strict";var u=n("./scene2d"),r=n("../plots"),f=n("../../constants/xmlns_namespaces");i.name="gl2d";i.attr=["xaxis","yaxis"];i.idRoot=["x","y"];i.idRegex={x:/^x([2-9]|[1-9][0-9]+)?$/,y:/^y([2-9]|[1-9][0-9]+)?$/};i.attrRegex={x:/^xaxis([2-9]|[1-9][0-9]+)?$/,y:/^yaxis([2-9]|[1-9][0-9]+)?$/};i.attributes=n("../cartesian/attributes");i.plot=function(n){for(var t=n._fullLayout,h=n._fullData,o=r.getSubplotIds(t,"gl2d"),f=0;f<o.length;f++){var e=o[f],s=t._plots[e],c=r.getSubplotData(h,"gl2d",e),i=s._scene2d;i===undefined&&(i=new u({id:e,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio},t),s._scene2d=i);i.plot(c,n.calcdata,t,n.layout)}};i.clean=function(n,t,i,u){for(var f,o,h,s=r.getSubplotIds(u,"gl2d"),e=0;e<s.length;e++)(f=s[e],o=u._plots[f],o._scene2d)&&(h=r.getSubplotData(n,"gl2d",f),h.length===0&&(o._scene2d.destroy(),delete u._plots[f]))};i.toSVG=function(n){for(var t=n._fullLayout,u=r.getSubplotIds(t,"gl2d"),i=0;i<u.length;i++){var o=t._plots[u[i]],e=o._scene2d,s=e.toImage("png"),h=t._glimages.append("svg:image");h.attr({xmlns:f.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"});e.destroy()}}},{"../../constants/xmlns_namespaces":666,"../cartesian/attributes":709,"../plots":769,"./scene2d":746}],746:[function(n,t){"use strict";function s(n,t){this.container=n.container;this.graphDiv=n.graphDiv;this.pixelRatio=n.plotGlPixelRatio||window.devicePixelRatio;this.id=n.id;this.staticPlot=!!n.staticPlot;this.fullLayout=t;this.fullData=null;this.updateAxes(t);this.makeFramework();this.glplotOptions=v(this);this.glplotOptions.merge(t);this.glplot=c(this.glplotOptions);this.camera=y(this);this.traces={};this._inputs={};this.spikes=l(this.glplot);this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0});this.lastButtonState=0;this.pickResult=null;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.stopped=!1;this.redraw=this.draw.bind(this);this.redraw()}function k(n,t){for(var u,f,r,i=0;i<2;++i){if(u=n[i],f=t[i],u.length!==f.length)return!0;for(r=0;r<u.length;++r)if(u[r].x!==f[r].x)return!0}return!1}var r=n("../../plots/cartesian/axes"),e=n("../../plots/cartesian/graph_interact"),c=n("gl-plot2d"),l=n("gl-spikes2d"),a=n("gl-select-box"),o=n("webgl-context"),v=n("./convert"),y=n("./camera"),p=n("../../lib/html2unicode"),w=n("../../lib/show_no_webgl_msg"),b=["xaxis","yaxis"],u,f,i,h;t.exports=s;i=s.prototype;i.makeFramework=function(){var r,e,n,t,s,i;if(this.staticPlot){if(!f&&(u=document.createElement("canvas"),f=o({canvas:u,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!f))throw new Error("Error creating static canvas/context for image server");this.canvas=u;this.gl=f}else r=document.createElement("canvas"),e=o({canvas:r,premultipliedAlpha:!0}),e||w(this),this.canvas=r,this.gl=e;n=this.canvas;n.style.width="100%";n.style.height="100%";n.style.position="absolute";n.style.top="0px";n.style.left="0px";n.style["pointer-events"]="none";this.updateSize(n);n.className+="user-select-none";t=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");t.style.position="absolute";t.style.top=t.style.left="0px";t.style.width=t.style.height="100%";t.style["z-index"]=20;t.style["pointer-events"]="none";s=this.mouseContainer=document.createElement("div");s.style.position="absolute";i=this.container;i.appendChild(n);i.appendChild(t);i.appendChild(s)};i.toImage=function(n){var r,h,c,f,e,y,o,a,v,l;n||(n="png");this.stopped=!0;this.staticPlot&&this.container.appendChild(u);this.updateSize(this.canvas);this.glplot.setDirty();this.glplot.draw();var i=this.glplot.gl,t=i.drawingBufferWidth,s=i.drawingBufferHeight;for(i.bindFramebuffer(i.FRAMEBUFFER,null),r=new Uint8Array(t*s*4),i.readPixels(0,0,t,s,i.RGBA,i.UNSIGNED_BYTE,r),h=0,c=s-1;h<c;++h,--c)for(f=0;f<t;++f)for(e=0;e<4;++e)y=r[4*(t*h+f)+e],r[4*(t*h+f)+e]=r[4*(t*c+f)+e],r[4*(t*c+f)+e]=y;o=document.createElement("canvas");o.width=t;o.height=s;a=o.getContext("2d");v=a.createImageData(t,s);v.data.set(r);a.putImageData(v,0,0);switch(n){case"jpeg":l=o.toDataURL("image/jpeg");break;case"webp":l=o.toDataURL("image/webp");break;default:l=o.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(u),l};i.updateSize=function(n){n||(n=this.canvas);var t=this.pixelRatio,i=this.fullLayout,f=i.width,e=i.height,r=Math.ceil(t*f)|0,u=Math.ceil(t*e)|0;return(n.width!==r||n.height!==u)&&(n.width=r,n.height=u),n};i.computeTickMarks=function(){var t,n,i;for(this.xaxis._length=this.glplot.viewBox[2]-this.glplot.viewBox[0],this.yaxis._length=this.glplot.viewBox[3]-this.glplot.viewBox[1],t=[r.calcTicks(this.xaxis),r.calcTicks(this.yaxis)],n=0;n<2;++n)for(i=0;i<t[n].length;++i)t[n][i].text=p(t[n][i].text+"").replace(/\n/g," ");return t};i.updateAxes=function(n){var t=r.subplotMatch,i="xaxis"+this.id.match(t)[1],u="yaxis"+this.id.match(t)[2];this.xaxis=n[i];this.yaxis=n[u]};i.updateFx=function(n){var t=this.fullLayout;t.dragmode=n.dragmode;t.hovermode=n.hovermode};h=function(n){var i=n.xaxis.range,r=n.yaxis.range,t;n.graphDiv.layout.xaxis.autorange=n.xaxis.autorange;n.graphDiv.layout.xaxis.range=i.slice(0);n.graphDiv.layout.yaxis.autorange=n.yaxis.autorange;n.graphDiv.layout.yaxis.range=r.slice(0);t={lastInputTime:n.camera.lastInputTime};t[n.xaxis._name]=i.slice();t[n.yaxis._name]=r.slice();n.graphDiv.emit("plotly_relayout",t)};i.cameraChanged=function(){var u=this.camera,t=this.xaxis.range,i=this.yaxis.range,n,r;this.glplot.setDataBox([t[0],i[0],t[1],i[1]]);n=this.computeTickMarks();r=this.glplotOptions.ticks;k(n,r)&&(this.glplotOptions.ticks=n,this.glplotOptions.dataBox=u.dataBox,this.glplot.update(this.glplotOptions),h(this))};i.destroy=function(){var n=this.traces;n&&Object.keys(n).map(function(t){n[t].dispose();delete n[t]});this.glplot.dispose();this.staticPlot||this.container.removeChild(this.canvas);this.container.removeChild(this.svgContainer);this.container.removeChild(this.mouseContainer);this.fullData=null;this._inputs=null;this.glplot=null;this.stopped=!0};i.plot=function(n,t,i){var d=this.glplot,l,a,o,e,v,y,f,p,s,w,k;this.fullLayout=i;this.updateAxes(i);this.updateTraces(n,t);l=i.width;a=i.height;this.updateSize(this.canvas);o=this.glplotOptions;o.merge(i);o.screenBox=[0,0,l,a];var u=i._size,c=this.xaxis.domain,h=this.yaxis.domain;for(o.viewBox=[u.l+c[0]*u.w,u.b+h[0]*u.h,l-u.r-(1-c[1])*u.w,a-u.t-(1-h[1])*u.h],this.mouseContainer.style.width=u.w*(c[1]-c[0])+"px",this.mouseContainer.style.height=u.h*(h[1]-h[0])+"px",this.mouseContainer.height=u.h*(h[1]-h[0]),this.mouseContainer.style.left=u.l+c[0]*u.w+"px",this.mouseContainer.style.top=u.t+(1-h[1])*u.h+"px",e=this.bounds,e[0]=e[1]=Infinity,e[2]=e[3]=-Infinity,v=Object.keys(this.traces),f=0;f<v.length;++f)for(p=this.traces[v[f]],s=0;s<2;++s)e[s]=Math.min(e[s],p.bounds[s]),e[s+2]=Math.max(e[s+2],p.bounds[s+2]);for(f=0;f<2;++f)e[f]>e[f+2]&&(e[f]=-1,e[f+2]=1),y=this[b[f]],y._length=o.viewBox[f+2]-o.viewBox[f],r.doAutoRange(y);o.ticks=this.computeTickMarks();w=this.xaxis.range;k=this.yaxis.range;o.dataBox=[w[0],k[0],w[1],k[1]];o.merge(i);d.update(o);this.glplot.draw()};i.updateTraces=function(n,t){var h=Object.keys(this.traces),i,f,r,e,o,s,u;this.fullData=n;n:for(i=0;i<h.length;i++){for(e=h[i],o=this.traces[e],f=0;f<n.length;f++)if(r=n[f],r.uid===e&&r.type===o.type)continue n;o.dispose();delete this.traces[e]}for(i=0;i<n.length;i++)r=n[i],this._inputs[r.uid]=i,s=t[i],u=this.traces[r.uid],u?u.update(r,s):(u=r._module.plot(this,r,s),this.traces[r.uid]=u)};i.emitPointAction=function(n,t){var i=this._inputs[n.trace.uid];this.graphDiv.emit(t,{points:[{x:n.traceCoord[0],y:n.traceCoord[1],curveNumber:i,pointNumber:n.pointIndex,data:this.fullData[i]._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis}]})};i.draw=function(){var l,a,t,c,f;if(!this.stopped){requestAnimationFrame(this.redraw);var n=this.glplot,r=this.camera,o=r.mouseListener,v=this.lastButtonState===1&&o.buttons===0,h=this.fullLayout;if(this.lastButtonState=o.buttons,this.cameraChanged(),l=o.x*n.pixelRatio,a=this.canvas.height-n.pixelRatio*o.y,r.boxEnabled&&h.dragmode==="zoom")this.selectBox.enabled=!0,this.selectBox.selectBox=[Math.min(r.boxStart[0],r.boxEnd[0]),Math.min(r.boxStart[1],r.boxEnd[1]),Math.max(r.boxStart[0],r.boxEnd[0]),Math.max(r.boxStart[1],r.boxEnd[1])],n.setDirty();else{this.selectBox.enabled=!1;var s=h._size,y=this.xaxis.domain,p=this.yaxis.domain,u=n.pick(l/n.pixelRatio+s.l+y[0]*s.w,a/n.pixelRatio-(s.t+(1-p[1])*s.h)),i=u&&u.object._trace.handlePick(u);i&&v&&this.emitPointAction(i,"plotly_click");u&&u.object._trace.hoverinfo!=="skip"&&h.hovermode?i&&(!this.lastPickResult||this.lastPickResult.traceUid!==i.trace.uid||this.lastPickResult.dataCoord[0]!==i.dataCoord[0]||this.lastPickResult.dataCoord[1]!==i.dataCoord[1])&&(t=i,this.lastPickResult={traceUid:i.trace?i.trace.uid:null,dataCoord:i.dataCoord.slice()},this.spikes.update({center:u.dataCoord}),t.screenCoord=[((n.viewBox[2]-n.viewBox[0])*(u.dataCoord[0]-n.dataBox[0])/(n.dataBox[2]-n.dataBox[0])+n.viewBox[0])/n.pixelRatio,(this.canvas.height-(n.viewBox[3]-n.viewBox[1])*(u.dataCoord[1]-n.dataBox[1])/(n.dataBox[3]-n.dataBox[1])-n.viewBox[1])/n.pixelRatio],this.emitPointAction(i,"plotly_hover"),c=t.hoverinfo,c!=="all"&&(f=c.split("+"),f.indexOf("x")===-1&&(t.traceCoord[0]=undefined),f.indexOf("y")===-1&&(t.traceCoord[1]=undefined),f.indexOf("z")===-1&&(t.traceCoord[2]=undefined),f.indexOf("text")===-1&&(t.textLabel=undefined),f.indexOf("name")===-1&&(t.name=undefined)),e.loneHover({x:t.screenCoord[0],y:t.screenCoord[1],xLabel:this.hoverFormatter("xaxis",t.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",t.traceCoord[1]),zLabel:t.traceCoord[2],text:t.textLabel,name:t.name,color:t.color},{container:this.svgContainer})):!u&&this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))}n.draw()}};i.hoverFormatter=function(n,t){if(t===undefined)return undefined;var i=this[n];return r.tickText(i,i.c2l(t),"hover").text}},{"../../lib/html2unicode":680,"../../lib/show_no_webgl_msg":692,"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717,"./camera":743,"./convert":744,"gl-plot2d":199,"gl-select-box":275,"gl-spikes2d":295,"webgl-context":571}],747:[function(n,t){"use strict";function e(n,t){var s,c,l;n=n||document.body;t=t||{};s=[.01,Infinity];"distanceLimits"in t&&(s[0]=t.distanceLimits[0],s[1]=t.distanceLimits[1]);"zoomMin"in t&&(s[0]=t.zoomMin);"zoomMax"in t&&(s[1]=t.zoomMax);var e=r({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:s}),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0,v=n.clientWidth,y=n.clientHeight,o={keyBindingMode:"rotate",view:e,element:n,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:e.modes,tick:function(){var u=i(),f=this.delay,c=u-2*f,r,o,t,s;for(e.idle(u-f),e.recalcMatrix(c),e.flush(u-(100+f*2)),r=!0,o=e.computedMatrix,t=0;t<16;++t)r=r&&a[t]===o[t],a[t]=o[t];return(s=n.clientWidth===v&&n.clientHeight===y,v=n.clientWidth,y=n.clientHeight,r)?!s:(h=Math.exp(e.computedRadius[0]),!0)},lookAt:function(n,t,i){e.lookAt(e.lastT(),n,t,i)},rotate:function(n,t,i){e.rotate(e.lastT(),n,t,i)},pan:function(n,t,i){e.pan(e.lastT(),n,t,i)},translate:function(n,t,i){e.translate(e.lastT(),n,t,i)}};return Object.defineProperties(o,{matrix:{get:function(){return e.computedMatrix},set:function(n){return e.setMatrix(e.lastT(),n),e.computedMatrix},enumerable:!0},mode:{get:function(){return e.getMode()},set:function(n){var f=e.computedUp.slice(),r=e.computedEye.slice(),u=e.computedCenter.slice(),t;return e.setMode(n),n==="turntable"&&(t=i(),e._active.lookAt(t,r,u,f),e._active.lookAt(t+500,r,u,[0,0,1]),e._active.flush(t)),e.getMode()},enumerable:!0},center:{get:function(){return e.computedCenter},set:function(n){return e.lookAt(e.lastT(),null,n),e.computedCenter},enumerable:!0},eye:{get:function(){return e.computedEye},set:function(n){return e.lookAt(e.lastT(),n),e.computedEye},enumerable:!0},up:{get:function(){return e.computedUp},set:function(n){return e.lookAt(e.lastT(),null,null,n),e.computedUp},enumerable:!0},distance:{get:function(){return h},set:function(n){return e.setDistance(e.lastT(),n),n},enumerable:!0},distanceLimits:{get:function(){return e.getDistanceLimits(s)},set:function(n){return e.setDistanceLimits(n),n},enumerable:!0}}),n.addEventListener("contextmenu",function(n){return n.preventDefault(),!1}),c=0,l=0,u(n,function(t,r,u,f){var nt=o.keyBindingMode==="rotate",tt=o.keyBindingMode==="pan",it=o.keyBindingMode==="zoom",s=!!f.control,a=!!f.alt,v=!!f.shift,y=!!(t&1),rt=!!(t&2),ut=!!(t&4),b=1/n.clientHeight,k=b*(r-c),w=b*(u-l),ft=o.flipX?1:-1,et=o.flipY?1:-1,p=i(),d=Math.PI*o.rotateSpeed,g;return(!nt||!y||s||a||v)&&(!y||s||a||!v)||e.rotate(p,ft*d*k,-et*d*w,0),(tt&&y&&!s&&!a&&!v||rt||y&&s&&!a&&!v)&&e.pan(p,-o.translateSpeed*k*h,o.translateSpeed*w*h,0),(it&&y&&!s&&!a&&!v||ut||y&&!s&&a&&!v)&&(g=-o.zoomSpeed*w/window.innerHeight*(p-e.lastT())*100,e.pan(p,0,0,h*(Math.exp(g)-1))),c=r,l=u,!0}),f(n,function(n,t){var f=o.flipX?1:-1,s=o.flipY?1:-1,r=i(),u;Math.abs(n)>Math.abs(t)?e.rotate(r,0,0,-n*f*Math.PI*o.rotateSpeed/window.innerWidth):(u=-o.zoomSpeed*s*t/window.innerHeight*(r-e.lastT())/100,e.pan(r,0,0,h*(Math.exp(u)-1)))},!0),o}t.exports=e;var i=n("right-now"),r=n("3d-view"),u=n("mouse-change"),f=n("mouse-wheel")},{"3d-view":45,"mouse-change":513,"mouse-wheel":517,"right-now":527}],748:[function(n,t,i){"use strict";function o(n,t){for(var r,i=0;i<3;++i)r=e[i],t[r]._gd=n}var u=n("./scene"),r=n("../plots"),f=n("../../constants/xmlns_namespaces"),e=["xaxis","yaxis","zaxis"];i.name="gl3d";i.attr="scene";i.idRoot="scene";i.idRegex=/^scene([2-9]|[1-9][0-9]+)?$/;i.attrRegex=/^scene([2-9]|[1-9][0-9]+)?$/;i.attributes=n("./layout/attributes");i.layoutAttributes=n("./layout/layout_attributes");i.supplyLayoutDefaults=n("./layout/defaults");i.plot=function(n){var t=n._fullLayout,c=n._fullData,h=r.getSubplotIds(t,"gl3d"),i;for(t._paperdiv.style({width:t.width+"px",height:t.height+"px"}),n._context.setBackground(n,t.paper_bgcolor),i=0;i<h.length;i++){var e=h[i],l=r.getSubplotData(c,"gl3d",e),s=t[e],f=s._scene;f===undefined&&(o(n,s),f=new u({id:e,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio},t),s._scene=f);f.plot(l,t,n.layout)}};i.clean=function(n,t,i,u){for(var f,o=r.getSubplotIds(u,"gl3d"),e=0;e<o.length;e++)f=o[e],t[f]||!u[f]._scene||u[f]._scene.destroy()};i.toSVG=function(n){for(var u=n._fullLayout,o=r.getSubplotIds(u,"gl3d"),t=u._size,e=0;e<o.length;e++){var s=u[o[e]],i=s.domain,h=s._scene,c=h.toImage("png"),l=u._glimages.append("svg:image");l.attr({xmlns:f.svg,"xlink:href":c,x:t.l+t.w*i.x[0],y:t.t+t.h*(1-i.y[1]),width:t.w*(i.x[1]-i.x[0]),height:t.h*(i.y[1]-i.y[0]),preserveAspectRatio:"none"});h.destroy()}};i.cleanId=function(n){if(n.match(/^scene[0-9]*$/)){var t=n.substr(5);return t==="1"&&(t=""),"scene"+t}};i.setConvert=n("./set_convert")},{"../../constants/xmlns_namespaces":666,"../plots":769,"./layout/attributes":749,"./layout/defaults":753,"./layout/layout_attributes":754,"./scene":758,"./set_convert":759}],749:[function(n,t){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene"}}},{}],750:[function(n,t){"use strict";var r=n("../../../components/color"),i=n("../../cartesian/layout_attributes"),u=n("../../../lib/extend").extendFlat;t.exports={showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:r.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:i.color,categoryorder:i.categoryorder,categoryarray:i.categoryarray,title:i.title,titlefont:i.titlefont,type:i.type,autorange:i.autorange,rangemode:i.rangemode,range:i.range,fixedrange:i.fixedrange,tickmode:i.tickmode,nticks:i.nticks,tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:i.ticks,mirror:i.mirror,ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,tickfont:i.tickfont,tickangle:i.tickangle,tickprefix:i.tickprefix,showtickprefix:i.showtickprefix,ticksuffix:i.ticksuffix,showticksuffix:i.showticksuffix,showexponent:i.showexponent,exponentformat:i.exponentformat,separatethousands:i.separatethousands,tickformat:i.tickformat,hoverformat:i.hoverformat,showline:i.showline,linecolor:i.linecolor,linewidth:i.linewidth,showgrid:i.showgrid,gridcolor:u({},i.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:i.gridwidth,zeroline:i.zeroline,zerolinecolor:i.zerolinecolor,zerolinewidth:i.zerolinewidth}},{"../../../components/color":582,"../../../lib/extend":673,"../../cartesian/layout_attributes":719}],751:[function(n,t){"use strict";var u=n("tinycolor2").mix,i=n("../../../lib"),f=n("./axis_attributes"),e=n("../../cartesian/axis_defaults"),r=["xaxis","yaxis","zaxis"],o=13600/187;t.exports=function(n,t,s){function h(n,t){return i.coerce(a,c,f,n,t)}for(var l,a,c,v=0;v<r.length;v++)l=r[v],a=n[l]||{},c={_id:l[0]+s.scene,_name:l},t[l]=c=e(a,c,h,{font:s.font,letter:l[0],data:s.data,showGrid:!0,bgColor:s.bgColor}),h("gridcolor",u(c.color,s.bgColor,o).toRgbString()),h("title",l[0]),c.setScale=i.noop,h("showspikes")&&(h("spikesides"),h("spikethickness"),h("spikecolor",c.color)),h("showaxeslabels"),h("showbackground")&&h("backgroundcolor")}},{"../../../lib":681,"../../cartesian/axis_defaults":711,"./axis_attributes":750,tinycolor2:546}],752:[function(n,t){"use strict";function u(){this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.tickEnable=[!0,!0,!0];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[18,18,18];this.labels=["x","y","z"];this.labelEnable=[!0,!0,!0];this.labelFont=["Open Sans","Open Sans","Open Sans"];this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[30,30,30];this.lineEnable=[!0,!0,!0];this.lineMirror=[!1,!1,!1];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[!0,!0,!0];this.lineTickMirror=[!1,!1,!1];this.lineTickLength=[10,10,10];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[!0,!0,!0];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[!0,!0,!0];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[!0,!0,!0];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._defaultTickPad=r(this.tickPad);this._defaultLabelPad=r(this.labelPad);this._defaultLineTickLength=r(this.lineTickLength)}function h(n){var t=new u;return t.merge(n),t}var f=n("arraytools"),e=n("../../../lib/html2unicode"),i=n("../../../lib/str2rgbarray"),r=f.copy1D,o=["xaxis","yaxis","zaxis"],s=u.prototype;s.merge=function(n){for(var t,u=this,r=0;r<3;++r)t=n[o[r]],u.labels[r]=e(t.title),"titlefont"in t&&(t.titlefont.color&&(u.labelColor[r]=i(t.titlefont.color)),t.titlefont.family&&(u.labelFont[r]=t.titlefont.family),t.titlefont.size&&(u.labelSize[r]=t.titlefont.size)),"showline"in t&&(u.lineEnable[r]=t.showline),"linecolor"in t&&(u.lineColor[r]=i(t.linecolor)),"linewidth"in t&&(u.lineWidth[r]=t.linewidth),"showgrid"in t&&(u.gridEnable[r]=t.showgrid),"gridcolor"in t&&(u.gridColor[r]=i(t.gridcolor)),"gridwidth"in t&&(u.gridWidth[r]=t.gridwidth),t.type==="log"?u.zeroEnable[r]=!1:"zeroline"in t&&(u.zeroEnable[r]=t.zeroline),"zerolinecolor"in t&&(u.zeroLineColor[r]=i(t.zerolinecolor)),"zerolinewidth"in t&&(u.zeroLineWidth[r]=t.zerolinewidth),u.lineTickEnable[r]="ticks"in t&&!!t.ticks?!0:!1,"ticklen"in t&&(u.lineTickLength[r]=u._defaultLineTickLength[r]=t.ticklen),"tickcolor"in t&&(u.lineTickColor[r]=i(t.tickcolor)),"tickwidth"in t&&(u.lineTickWidth[r]=t.tickwidth),"tickangle"in t&&(u.tickAngle[r]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180),"showticklabels"in t&&(u.tickEnable[r]=t.showticklabels),"tickfont"in t&&(t.tickfont.color&&(u.tickColor[r]=i(t.tickfont.color)),t.tickfont.family&&(u.tickFont[r]=t.tickfont.family),t.tickfont.size&&(u.tickSize[r]=t.tickfont.size)),"mirror"in t?["ticks","all","allticks"].indexOf(t.mirror)!==-1?(u.lineTickMirror[r]=!0,u.lineMirror[r]=!0):t.mirror===!0?(u.lineTickMirror[r]=!1,u.lineMirror[r]=!0):(u.lineTickMirror[r]=!1,u.lineMirror[r]=!1):u.lineMirror[r]=!1,"showbackground"in t&&t.showbackground!==!1?(u.backgroundEnable[r]=!0,u.backgroundColor[r]=i(t.backgroundcolor)):u.backgroundEnable[r]=!1};t.exports=h},{"../../../lib/html2unicode":680,"../../../lib/str2rgbarray":694,arraytools:55}],753:[function(n,t){"use strict";function e(n,t,u,e){for(var c=u("bgcolor"),l=r.combine(c,e.paper_bgcolor),s=Object.keys(i.camera),o=0;o<s.length;o++)u("camera."+s[o]+".x"),u("camera."+s[o]+".y"),u("camera."+s[o]+".z");var h=!!u("aspectratio.x")&&!!u("aspectratio.y")&&!!u("aspectratio.z"),a=h?"manual":"auto",v=u("aspectmode",a);h||(n.aspectratio=t.aspectratio={x:1,y:1,z:1},v==="manual"&&(t.aspectmode="auto"));f(n,t,{font:e.font,scene:e.id,data:e.fullData,bgColor:l});u("dragmode",e.getDfltFromLayout("dragmode"));u("hovermode",e.getDfltFromLayout("hovermode"))}var r=n("../../../components/color"),u=n("../../subplot_defaults"),i=n("./layout_attributes"),f=n("./axis_defaults");t.exports=function(n,t,r){function o(t){if(!f){var r=i[t].values.indexOf(n[t])!==-1;if(r)return n[t]}}var f=t._has("cartesian")||t._has("geo")||t._has("gl2d")||t._has("pie")||t._has("ternary");u(n,t,r,{type:"gl3d",attributes:i,handleDefaults:e,font:t.font,fullData:r,getDfltFromLayout:o,paper_bgcolor:t.paper_bgcolor})}},{"../../../components/color":582,"../../subplot_defaults":776,"./axis_defaults":751,"./layout_attributes":754}],754:[function(n,t){"use strict";function u(n,t,i){return{x:{valType:"number",dflt:n},y:{valType:"number",dflt:t},z:{valType:"number",dflt:i}}}var i=n("./axis_attributes"),r=n("../../../lib/extend").extendFlat;t.exports={bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},camera:{up:r(u(0,0,1),{}),center:r(u(0,0,0),{}),eye:r(u(1.25,1.25,1.25),{})},domain:{x:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},y:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]}},aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto"},aspectratio:{x:{valType:"number",min:0},y:{valType:"number",min:0},z:{valType:"number",min:0}},xaxis:i,yaxis:i,zaxis:i,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan"],dflt:"turntable"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest"},_deprecated:{cameraposition:{valType:"info_array"}}}},{"../../../lib/extend":673,"./axis_attributes":750}],755:[function(n,t){"use strict";function i(){this.enabled=[!0,!0,!0];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.drawSides=[!0,!0,!0];this.lineWidth=[1,1,1]}function e(n){var t=new i;return t.merge(n),t}var r=n("../../../lib/str2rgbarray"),u=["xaxis","yaxis","zaxis"],f=i.prototype;f.merge=function(n){for(var i,t=0;t<3;++t)i=n[u[t]],this.enabled[t]=i.showspikes,this.colors[t]=r(i.spikecolor),this.drawSides[t]=i.spikesides,this.lineWidth[t]=i.spikethickness};t.exports=e},{"../../../lib/str2rgbarray":694}],756:[function(n,t){"use strict";function o(n){for(var r,u,t,f=new Array(3),i=0;i<3;++i){for(r=n[i],u=new Array(r.length),t=0;t<r.length;++t)u[t]=r[t].x;f[i]=u}return f}function s(n){for(var s,y,p,c,h,v=n.axesOptions,l=n.glplot.axesPixels,w=n.fullSceneLayout,a=[[],[],[]],t=0;t<3;++t)if(s=w[f[t]],s._length=(l[t].hi-l[t].lo)*l[t].pixelsPerDataUnit/n.dataScale[t],Math.abs(s._length)===Infinity)a[t]=[];else{for(s.range[0]=l[t].lo/n.dataScale[t],s.range[1]=l[t].hi/n.dataScale[t],s._m=1/(n.dataScale[t]*l[t].pixelsPerDataUnit),s.range[0]===s.range[1]&&(s.range[0]-=1,s.range[1]+=1),y=s.tickmode,s.tickmode==="auto"&&(s.tickmode="linear",p=s.nticks||r.constrain(s._length/40,4,9),i.autoTicks(s,Math.abs(s.range[1]-s.range[0])/p)),c=i.calcTicks(s),h=0;h<c.length;++h)c[h].x=c[h].x*n.dataScale[t],c[h].text=u(c[h].text);a[t]=c;s.tickmode=y}for(v.ticks=a,t=0;t<3;++t)for(e[t]=.5*(n.glplot.bounds[0][t]+n.glplot.bounds[1][t]),h=0;h<2;++h)v.bounds[h][t]=n.glplot.bounds[h][t];n.contourLevels=o(a)}t.exports=s;var i=n("../../cartesian/axes"),r=n("../../../lib"),u=n("../../../lib/html2unicode"),f=["xaxis","yaxis","zaxis"],e=[0,0,0]},{"../../../lib":681,"../../../lib/html2unicode":680,"../../cartesian/axes":710}],757:[function(n,t){"use strict";function i(n,t){for(var u=[0,0,0,0],r,i=0;i<4;++i)for(r=0;r<4;++r)u[r]+=n[4*i+r]*t[i];return u}function r(n,t){return i(n.projection,i(n.view,i(n.model,[t[0],t[1],t[2],1])))}t.exports=r},{}],758:[function(n,t){"use strict";function it(n){function a(t,i){if(typeof i=="string")return i;var r=n.fullSceneLayout[t];return y.tickText(r,r.c2l(i),"hover").text}var t,f=n.svgContainer,b=n.container.getBoundingClientRect(),c=b.width,l=b.height,o,g,e,u,h;f.setAttributeNS(null,"viewBox","0 0 "+c+" "+l);f.setAttributeNS(null,"width",c);f.setAttributeNS(null,"height",l);tt(n);n.glplot.axes.update(n.axesOptions);var d=Object.keys(n.traces),r=null,i=n.glplot.selection;for(o=0;o<d.length;++o)t=n.traces[d[o]],t.data.hoverinfo!=="skip"&&t.handlePick(i)&&(r=t),t.setContourLevels&&t.setContourLevels();if(r!==null){e=k(n.glplot.cameraParams,i.dataCoordinate);t=r.data;var nt=t.hoverinfo,v=a("xaxis",i.traceCoordinate[0]),p=a("yaxis",i.traceCoordinate[1]),w=a("zaxis",i.traceCoordinate[2]);nt!=="all"&&(u=nt.split("+"),u.indexOf("x")===-1&&(v=undefined),u.indexOf("y")===-1&&(p=undefined),u.indexOf("z")===-1&&(w=undefined),u.indexOf("text")===-1&&(i.textLabel=undefined),u.indexOf("name")===-1&&(r.name=undefined));n.fullSceneLayout.hovermode&&s.loneHover({x:(.5+.5*e[0]/e[3])*c,y:(.5-.5*e[1]/e[3])*l,xLabel:v,yLabel:p,zLabel:w,text:i.textLabel,name:r.name,color:r.color},{container:f});h={points:[{x:v,y:p,z:w,data:t._input,fullData:t,curveNumber:t.index,pointNumber:i.data.index}]};i.buttons&&i.distance<5?n.graphDiv.emit("plotly_click",h):n.graphDiv.emit("plotly_hover",h);g=h}else s.loneUnhover(f),n.graphDiv.emit("plotly_unhover",g)}function h(n,t,i,u){var s={canvas:i,gl:u,container:n.container,axes:n.axesOptions,spikes:n.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1},h,o;if(n.staticMode){if(!f&&(r=document.createElement("canvas"),f=v({canvas:r,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!f))throw new Error("error creating static canvas/context for image server");s.pixelRatio=n.pixelRatio;s.gl=f;s.canvas=r}try{n.glplot=a(s)}catch(c){w(n)}return h=function(n){var t={};t[n.id]=l(n.camera);n.saveCamera(n.graphDiv.layout);n.graphDiv.emit("plotly_relayout",t)},n.glplot.canvas.addEventListener("mouseup",h.bind(null,n)),n.glplot.canvas.addEventListener("wheel",h.bind(null,n)),n.staticMode||n.glplot.canvas.addEventListener("webglcontextlost",function(n){e.warn("Lost WebGL context.");n.preventDefault()}),n.camera||(o=n.fullSceneLayout.camera,n.camera=b(n.container,{center:[o.center.x,o.center.y,o.center.z],eye:[o.eye.x,o.eye.y,o.eye.z],up:[o.up.x,o.up.y,o.up.z],zoomMin:.1,zoomMax:100,mode:"orbit"})),n.glplot.mouseListener.enabled=!1,n.glplot.camera=n.camera,n.glplot.oncontextloss=function(){n.recoverContext()},n.glplot.onrender=it.bind(null,n),n.traces={},!0}function c(n,t){var r=document.createElement("div"),u=n.container,i;this.graphDiv=n.graphDiv;i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.style.position="absolute";i.style.top=i.style.left="0px";i.style.width=i.style.height="100%";i.style["z-index"]=20;i.style["pointer-events"]="none";r.appendChild(i);this.svgContainer=i;r.id=n.id;r.style.position="absolute";r.style.top=r.style.left="0px";r.style.width=r.style.height="100%";u.appendChild(r);this.fullLayout=t;this.id=n.id||"scene";this.fullSceneLayout=t[this.id];this.plotArgs=[[],{},{}];this.axesOptions=g(t[this.id]);this.spikeOptions=nt(t[this.id]);this.container=r;this.staticMode=!!n.staticPlot;this.pixelRatio=n.plotGlPixelRatio||2;this.dataScale=[1,1,1];this.contourLevels=[[],[],[]];!h(this,t)}function o(n,t,i,r){for(var e,u,f=0;f<t.length;++f)if(Array.isArray(t[f]))for(e=0;e<t[f].length;++e)u=n.d2l(t[f][e]),!isNaN(u)&&isFinite(u)&&(r[0][i]=Math.min(r[0][i],u),r[1][i]=Math.max(r[1][i],u));else u=n.d2l(t[f]),!isNaN(u)&&isFinite(u)&&(r[0][i]=Math.min(r[0][i],u),r[1][i]=Math.max(r[1][i],u))}function rt(n,t,i){var r=n.fullSceneLayout;o(r.xaxis,t.x,0,i);o(r.yaxis,t.y,1,i);o(r.zaxis,t.z,2,i)}function ut(n){return[[n.eye.x,n.eye.y,n.eye.z],[n.center.x,n.center.y,n.center.z],[n.up.x,n.up.y,n.up.z]]}function l(n){return{up:{x:n.up[0],y:n.up[1],z:n.up[2]},center:{x:n.center[0],y:n.center[1],z:n.center[2]},eye:{x:n.eye[0],y:n.eye[1],z:n.eye[2]}}}var a=n("gl-plot3d"),v=n("webgl-context"),e=n("../../lib"),y=n("../../plots/cartesian/axes"),s=n("../../plots/cartesian/graph_interact"),p=n("../../lib/str2rgbarray"),w=n("../../lib/show_no_webgl_msg"),b=n("./camera"),k=n("./project"),d=n("./set_convert"),g=n("./layout/convert"),nt=n("./layout/spikes"),tt=n("./layout/tick_marks"),r,f,i=c.prototype,u;i.recoverContext=function(){function i(){if(t.isContextLost()){requestAnimationFrame(i);return}if(!h(n,n.fullLayout,r,t)){e.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}n.plot.apply(n,n.plotArgs)}var n=this,t=this.glplot.gl,r=this.glplot.canvas;this.glplot.dispose();requestAnimationFrame(i)};u=["xaxis","yaxis","zaxis"];i.plot=function(n,t,i){var s,l,r,o,c,b,e,it,a,h,nt,ft,et,ot,k,st,ht,v,ut,y,w,g;if(this.plotArgs=[n,t,i],!this.glplot.contextLost){for(e=t[this.id],it=i[this.id],this.glplot.clearColor=e.bgcolor?p(e.bgcolor):[0,0,0,0],this.glplot.snapToData=!0,this.fullSceneLayout=e,this.glplotLayout=e,this.axesOptions.merge(e),this.spikeOptions.merge(e),this.updateFx(e.dragmode,e.hovermode),this.glplot.update({}),r=0;r<3;++r)c=e[u[r]],d(c);for(n?Array.isArray(n)||(n=[n]):n=[],a=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]],r=0;r<n.length;++r)(s=n[r],s.visible===!0)&&rt(this,s,a);for(h=[1,1,1],o=0;o<3;++o)h[o]=a[0][o]>a[1][o]?1:a[1][o]===a[0][o]?1:1/(a[1][o]-a[0][o]);for(this.dataScale=h,r=0;r<n.length;++r)(s=n[r],s.visible===!0)&&(l=this.traces[s.uid],l?l.update(s):(l=s._module.plot(this,s),this.traces[s.uid]=l),l.name=s.name);nt=Object.keys(this.traces);n:for(r=0;r<nt.length;++r){for(o=0;o<n.length;++o)if(n[o].uid===nt[r]&&n[o].visible===!0)continue n;l=this.traces[nt[r]];l.dispose();delete this.traces[nt[r]]}var f=[[0,0,0],[0,0,0]],ct=[],tt={};for(r=0;r<3;++r){if(c=e[u[r]],b=c.type,b in tt?(tt[b].acc*=h[r],tt[b].count+=1):tt[b]={acc:h[r],count:1},c.autorange){for(f[0][r]=Infinity,f[1][r]=-Infinity,o=0;o<this.glplot.objects.length;++o)ft=this.glplot.objects[o].bounds,f[0][r]=Math.min(f[0][r],ft[0][r]/h[r]),f[1][r]=Math.max(f[1][r],ft[1][r]/h[r]);"rangemode"in c&&c.rangemode==="tozero"&&(f[0][r]=Math.min(f[0][r],0),f[1][r]=Math.max(f[1][r],0));f[0][r]>f[1][r]?(f[0][r]=-1,f[1][r]=1):(et=f[1][r]-f[0][r],f[0][r]-=et/32,f[1][r]+=et/32)}else ot=e[u[r]].range,f[0][r]=ot[0],f[1][r]=ot[1];f[0][r]===f[1][r]&&(f[0][r]-=1,f[1][r]+=1);ct[r]=f[1][r]-f[0][r];this.glplot.bounds[0][r]=f[0][r]*h[r];this.glplot.bounds[1][r]=f[1][r]*h[r]}for(k=[1,1,1],r=0;r<3;++r)c=e[u[r]],b=c.type,st=tt[b],k[r]=Math.pow(st.acc,1/st.count)/h[r];if(ht=4,e.aspectmode==="auto")v=Math.max.apply(null,k)/Math.min.apply(null,k)<=ht?k:[1,1,1];else if(e.aspectmode==="cube")v=[1,1,1];else if(e.aspectmode==="data")v=k;else if(e.aspectmode==="manual")ut=e.aspectratio,v=[ut.x,ut.y,ut.z];else throw new Error("scene.js aspectRatio was not one of the enumerated types");e.aspectratio.x=it.aspectratio.x=v[0];e.aspectratio.y=it.aspectratio.y=v[1];e.aspectratio.z=it.aspectratio.z=v[2];this.glplot.aspect=v;y=e.domain||null;w=t._size||null;y&&w&&(g=this.container.style,g.position="absolute",g.left=w.l+y.x[0]*w.w+"px",g.top=w.t+(1-y.y[1])*w.h+"px",g.width=w.w*(y.x[1]-y.x[0])+"px",g.height=w.h*(y.y[1]-y.y[0])+"px");this.glplot.redraw()}};i.destroy=function(){this.glplot.dispose();this.container.parentNode.removeChild(this.container);this.glplot=null};i.setCameraToDefault=function(){this.setCamera({eye:{x:1.25,y:1.25,z:1.25},center:{x:0,y:0,z:0},up:{x:0,y:0,z:1}})};i.getCamera=function(){return this.glplot.camera.view.recalcMatrix(this.camera.view.lastT()),l(this.glplot.camera)};i.setCamera=function(n){var t={};t[this.id]=n;this.glplot.camera.lookAt.apply(this,ut(n));this.graphDiv.emit("plotly_relayout",t)};i.saveCamera=function(n){function s(n,t,i,r){var u=["up","center","eye"],f=["x","y","z"];return t[u[i]]&&n[u[i]][f[r]]===t[u[i]][f[r]]}var u=this.getCamera(),f=e.nestedProperty(n,this.id+".camera"),o=f.get(),t=!1,i,r;if(o===undefined)t=!0;else for(i=0;i<3;i++)for(r=0;r<3;r++)if(!s(u,o,i,r)){t=!0;break}return t&&f.set(u),t};i.updateFx=function(n,t){var i=this.camera;i&&(n==="orbit"?(i.mode="orbit",i.keyBindingMode="rotate"):n==="turntable"?(i.up=[0,0,1],i.mode="turntable",i.keyBindingMode="rotate"):i.keyBindingMode=n);this.fullSceneLayout.hovermode=t};i.toImage=function(n){var u,h,c,f,e,y,o,a,v,l;n||(n="png");this.staticMode&&this.container.appendChild(r);this.glplot.redraw();var i=this.glplot.gl,t=i.drawingBufferWidth,s=i.drawingBufferHeight;for(i.bindFramebuffer(i.FRAMEBUFFER,null),u=new Uint8Array(t*s*4),i.readPixels(0,0,t,s,i.RGBA,i.UNSIGNED_BYTE,u),h=0,c=s-1;h<c;++h,--c)for(f=0;f<t;++f)for(e=0;e<4;++e)y=u[4*(t*h+f)+e],u[4*(t*h+f)+e]=u[4*(t*c+f)+e],u[4*(t*c+f)+e]=y;o=document.createElement("canvas");o.width=t;o.height=s;a=o.getContext("2d");v=a.createImageData(t,s);v.data.set(u);a.putImageData(v,0,0);switch(n){case"jpeg":l=o.toDataURL("image/jpeg");break;case"webp":l=o.toDataURL("image/webp");break;default:l=o.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(r),l};t.exports=c},{"../../lib":681,"../../lib/show_no_webgl_msg":692,"../../lib/str2rgbarray":694,"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717,"./camera":747,"./layout/convert":752,"./layout/spikes":755,"./layout/tick_marks":756,"./project":757,"./set_convert":759,"gl-plot3d":217,"webgl-context":571}],759:[function(n,t){"use strict";var i=n("../../lib"),r=n("../cartesian/axes");t.exports=function(n){r.setConvert(n);n.setScale=i.noop}},{"../../lib":681,"../cartesian/axes":710}],760:[function(n,t){"use strict";var f=n("../lib"),i=f.extendFlat,r=n("./font_attributes"),u=n("../components/color/attributes");t.exports={font:{family:i({},r.family,{dflt:'"Open Sans", verdana, arial, sans-serif'}),size:i({},r.size,{dflt:12}),color:i({},r.color,{dflt:u.defaultLine})},title:{valType:"string",dflt:"Click to enter Plot title"},titlefont:i({},r,{}),autosize:{valType:"enumerated",values:[!0,!1,"initial"]},width:{valType:"number",min:10,dflt:700},height:{valType:"number",min:10,dflt:450},margin:{l:{valType:"number",min:0,dflt:80},r:{valType:"number",min:0,dflt:80},t:{valType:"number",min:0,dflt:100},b:{valType:"number",min:0,dflt:80},pad:{valType:"number",min:0,dflt:0},autoexpand:{valType:"boolean",dflt:!0}},paper_bgcolor:{valType:"color",dflt:u.background},plot_bgcolor:{valType:"color",dflt:u.background},separators:{valType:"string",dflt:".,"},hidesources:{valType:"boolean",dflt:!1},smith:{valType:"enumerated",values:[!1],dflt:!1},showlegend:{valType:"boolean"},_composedModules:{"*":"Fx"},_nestedModules:{xaxis:"Axes",yaxis:"Axes",scene:"gl3d",geo:"geo",ternary:"ternary",mapbox:"mapbox",legend:"legend",annotations:"annotations",shapes:"shapes",images:"images",updatemenus:"updatemenus",sliders:"sliders"}}},{"../components/color/attributes":581,"../lib":681,"./font_attributes":729}],761:[function(n,t){"use strict";t.exports={styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",controlContainerClassName:"mapboxgl-control-container",noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",mapOnErrorMsg:"Mapbox error."}},{}],762:[function(n,t){"use strict";var i=n("../../lib");t.exports=function(n,t){var f=n.split(" "),c=f[0],l=f[1],e=Array.isArray(t)?i.mean(t):t,o=.5+e/100,s=1.5+e/100,r=["",""],u=[0,0],h;switch(c){case"top":r[0]="top";u[1]=-s;break;case"bottom":r[0]="bottom";u[1]=s}switch(l){case"left":r[1]="right";u[0]=-o;break;case"right":r[1]="left";u[0]=o}return h=r[0]&&r[1]?r.join("-"):r[0]?r[0]:r[1]?r[1]:"center",{anchor:h,offset:u}}},{"../../lib":681}],763:[function(n,t,i){"use strict";function s(n,t){for(var r,f,u=[],i=0;i<n.length;i++)r=n[i],f=r[0].trace,f.subplot===t&&u.push(r);return u}function h(n,t){var e=n._fullLayout,f=n._context,i,r,u;if(f.mapboxAccessToken==="")return"";for(i=f.mapboxAccessToken,r=0;r<t.length;r++)if(u=e[t[r]],u.accesstoken){i=u.accesstoken;break}if(!i)throw new Error(o.noAccessTokenErrorMsg);return i}var u=n("mapbox-gl"),r=n("../plots"),f=n("../../constants/xmlns_namespaces"),e=n("./mapbox"),o=n("./constants");i.name="mapbox";i.attr="subplot";i.idRoot="mapbox";i.idRegex=/^mapbox([2-9]|[1-9][0-9]+)?$/;i.attrRegex=/^mapbox([2-9]|[1-9][0-9]+)?$/;i.attributes={subplot:{valType:"subplotid",dflt:"mapbox"}};i.layoutAttributes=n("./layout_attributes");i.supplyLayoutDefaults=n("./layout_defaults");i.plot=function(n){var t=n._fullLayout,v=n.calcdata,c=r.getSubplotIds(t,"mapbox"),l=h(n,c),i;for(u.accessToken=l,i=0;i<c.length;i++){var f=c[i],y=s(v,f),a=t[f],o=a._subplot;a.accesstoken=l;o||(o=e({gd:n,container:t._glcontainer.node(),id:f,fullLayout:t,staticPlot:n._context.staticPlot}),t[f]._subplot=o);o.plot(y,t,n._promises)}};i.clean=function(n,t,i,u){for(var f,o=r.getSubplotIds(u,"mapbox"),e=0;e<o.length;e++)f=o[e],t[f]||!u[f]._subplot||u[f]._subplot.destroy()};i.toSVG=function(n){for(var u=n._fullLayout,o=r.getSubplotIds(u,"mapbox"),t=u._size,e=0;e<o.length;e++){var s=u[o[e]],i=s.domain,h=s._subplot,c=h.toImage("png"),l=u._glimages.append("svg:image");l.attr({xmlns:f.svg,"xlink:href":c,x:t.l+t.w*i.x[0],y:t.t+t.h*(1-i.y[1]),width:t.w*(i.x[1]-i.x[0]),height:t.h*(i.y[1]-i.y[0]),preserveAspectRatio:"none"});h.destroy()}}},{"../../constants/xmlns_namespaces":666,"../plots":769,"./constants":761,"./layout_attributes":765,"./layout_defaults":766,"./mapbox":767,"mapbox-gl":336}],764:[function(n,t){"use strict";function f(n,t){this.mapbox=n;this.map=n.map;this.uid=n.uid+"-layer"+t;this.idSource=this.uid+"-source";this.idLayer=this.uid+"-layer";this.sourceType=null;this.source=null;this.layerType=null;this.below=null;this.visible=!1}function u(n){var t=n.source;return r.isPlainObject(t)||typeof t=="string"&&t.length>0}function o(n){var f={},i={},t,u;switch(n.type){case"circle":r.extendFlat(i,{"circle-radius":n.circle.radius,"circle-color":n.color,"circle-opacity":n.opacity});break;case"line":r.extendFlat(i,{"line-width":n.line.width,"line-color":n.color,"line-opacity":n.opacity});break;case"fill":r.extendFlat(i,{"fill-color":n.color,"fill-outline-color":n.fill.outlinecolor,"fill-opacity":n.opacity});break;case"symbol":t=n.symbol;u=e(t.textposition,t.iconsize);r.extendFlat(f,{"icon-image":t.icon+"-15","icon-size":t.iconsize/10,"text-field":t.text,"text-size":t.textfont.size,"text-anchor":u.anchor,"text-offset":u.offset});r.extendFlat(i,{"icon-color":n.color,"text-color":t.textfont.color,"text-opacity":n.opacity})}return{layout:f,paint:i}}function s(n){var t=n.sourcetype,r=n.source,u={type:t},f=typeof r=="string",i;return t==="geojson"?i="data":t==="vector"&&(i=f?"url":"tiles"),u[i]=r,u}var r=n("../../lib"),e=n("./convert_text_opts"),i=f.prototype;i.update=function(n){this.visible?this.needsNewSource(n)?(this.updateLayer(n),this.updateSource(n)):this.needsNewLayer(n)&&this.updateLayer(n):(this.updateSource(n),this.updateLayer(n));this.updateStyle(n);this.visible=u(n)};i.needsNewSource=function(n){return this.sourceType!==n.sourcetype||this.source!==n.source||this.layerType!==n.type};i.needsNewLayer=function(n){return this.layerType!==n.type||this.below!==n.below};i.updateSource=function(n){var t=this.map,i;(t.getSource(this.idSource)&&t.removeSource(this.idSource),this.sourceType=n.sourcetype,this.source=n.source,u(n))&&(i=s(n),t.addSource(this.idSource,i))};i.updateLayer=function(n){var t=this.map,i;(t.getLayer(this.idLayer)&&t.removeLayer(this.idLayer),this.layerType=n.type,u(n))&&(t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":n.sourcelayer||"",type:n.type},n.below),i={visibility:"visible"},this.mapbox.setOptions(this.idLayer,"setLayoutProperty",i))};i.updateStyle=function(n){var t=o(n);u(n)&&(this.mapbox.setOptions(this.idLayer,"setLayoutProperty",t.layout),this.mapbox.setOptions(this.idLayer,"setPaintProperty",t.paint))};i.dispose=function(){var n=this.map;n.removeLayer(this.idLayer);n.removeSource(this.idSource)};t.exports=function(n,t,i){var r=new f(n,t);return r.update(i),r}},{"../../lib":681,"./convert_text_opts":762}],765:[function(n,t){"use strict";var i=n("../../lib"),r=n("../../components/color").defaultLine,u=n("../font_attributes"),f=n("../../traces/scatter/attributes").textposition;t.exports={domain:{x:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},y:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]}},accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],dflt:"basic"},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:{_isLinkedToArray:!0,sourcetype:{valType:"enumerated",values:["geojson","vector"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},type:{valType:"enumerated",values:["circle","line","fill","symbol"],dflt:"circle"},below:{valType:"string",dflt:""},color:{valType:"color",dflt:r},opacity:{valType:"number",min:0,max:1,dflt:1},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2}},fill:{outlinecolor:{valType:"color",dflt:r}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},textfont:i.extendDeep({},u,{family:{dflt:"Open Sans Regular, Arial Unicode MS Regular"}}),textposition:i.extendFlat({},f,{arrayOk:!1})}}}},{"../../components/color":582,"../../lib":681,"../../traces/scatter/attributes":889,"../font_attributes":729}],766:[function(n,t){"use strict";function f(n,t,i){i("accesstoken");i("style");i("center.lon");i("center.lat");i("zoom");i("bearing");i("pitch");e(n,t);t._input=n}function e(n,t){function u(n,t){return i.coerce(s,e,r.layers,n,t)}for(var c,f,h=n.layers||[],l=t.layers=[],s,e,o=0;o<h.length;o++)(s=h[o],e={},i.isPlainObject(s))&&(c=u("sourcetype"),u("source"),c==="vector"&&u("sourcelayer"),f=u("type"),u("below"),u("color"),u("opacity"),f==="circle"&&u("circle.radius"),f==="line"&&u("line.width"),f==="fill"&&u("fill.outlinecolor"),f==="symbol"&&(u("symbol.icon"),u("symbol.iconsize"),u("symbol.text"),i.coerceFont(u,"symbol.textfont"),u("symbol.textposition")),e._index=o,l.push(e))}var i=n("../../lib"),u=n("../subplot_defaults"),r=n("./layout_attributes");t.exports=function(n,t,i){u(n,t,i,{type:"mapbox",attributes:r,handleDefaults:f,partition:"y"})}},{"../../lib":681,"../subplot_defaults":776,"./layout_attributes":765}],767:[function(n,t){"use strict";function s(n){this.id=n.id;this.gd=n.gd;this.container=n.container;this.isStatic=n.staticPlot;var t=n.fullLayout;this.uid=t._uid+"-"+this.id;this.opts=t[this.id];this.div=null;this.xaxis=null;this.yaxis=null;this.createFramework(t);this.map=null;this.accessToken=null;this.styleObj=null;this.traceHash={};this.layerList=[]}function h(n){var r=o.style.values,i=o.style.dflt,t={};return e.isPlainObject(n)?(t.id=n.id,t.style=n):typeof n=="string"?(t.id=n,t.style=r.indexOf(n)!==-1?c(n):n):(t.id=i,t.style=c(i)),t}function c(n){return r.styleUrlPrefix+n+"-"+r.styleUrlSuffix}function l(n){return[n.lon,n.lat]}var f=n("mapbox-gl"),u=n("../cartesian/graph_interact"),e=n("../../lib"),r=n("./constants"),o=n("./layout_attributes"),a=n("./layers"),i=s.prototype;t.exports=function(n){return new s(n)};i.plot=function(n,t,i){var r=this,f=r.opts=t[this.id],u;r.map&&f.accesstoken!==r.accessToken&&(r.map.remove(),r.map=null,r.styleObj=null,r.traceHash=[],r.layerList={});u=r.map?new Promise(function(i,u){r.updateMap(n,t,i,u)}):new Promise(function(i,u){r.createMap(n,t,i,u)});i.push(u)};i.createMap=function(n,t,i,o){function y(){u.loneUnhover(t._toppaper)}var s=this,v=s.gd,c=s.opts,p=s.styleObj=h(c.style);s.accessToken=c.accesstoken;var a=s.map=new f.Map({container:s.div,style:p.style,center:l(c.center),zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,interactive:!s.isStatic,preserveDrawingBuffer:s.isStatic}),w=r.controlContainerClassName,b=s.div.getElementsByClassName(w)[0];s.div.removeChild(b);s.rejectOnError(o);a.once("load",function(){s.updateData(n);s.updateLayout(t);s.resolveOnRender(i)});a.on("moveend",function(n){var t=s.getView(),i;c._input.center=c.center=t.center;c._input.zoom=c.zoom=t.zoom;c._input.bearing=c.bearing=t.bearing;c._input.pitch=c.pitch=t.pitch;n.originalEvent&&(i={},i[s.id]=e.extendFlat({},t),v.emit("plotly_relayout",i))});a.on("mousemove",function(n){var t=s.div.getBoundingClientRect();n.clientX=n.point.x+t.left;n.clientY=n.point.y+t.top;n.target.getBoundingClientRect=function(){return t};s.xaxis.p2c=function(){return n.lngLat.lng};s.yaxis.p2c=function(){return n.lngLat.lat};u.hover(v,n,s.id)});a.on("click",function(){u.click(v,{target:!0})});a.on("dragstart",y);a.on("zoomstart",y)};i.updateMap=function(n,t,i,r){var u=this,e=u.map,f;if(u.rejectOnError(r),f=h(u.opts.style),u.styleObj.id!==f.id){u.styleObj=f;e.setStyle(f.style);e.style.once("load",function(){u.traceHash={};u.updateData(n);u.updateLayout(t);u.resolveOnRender(i)})}else u.updateData(n),u.updateLayout(t),u.resolveOnRender(i)};i.updateData=function(n){for(var r=this.traceHash,u,i,f,e,s,o,t=0;t<n.length;t++)e=n[t],i=e[0].trace,u=r[i.uid],u?u.update(e):i._module&&(r[i.uid]=i._module.plot(this,e));s=Object.keys(r);n:for(t=0;t<s.length;t++){for(o=s[t],f=0;f<n.length;f++)if(i=n[f][0].trace,o===i.uid)continue n;u=r[o];u.dispose();delete r[o]}};i.updateLayout=function(n){var t=this.map,i=this.opts;t.setCenter(l(i.center));t.setZoom(i.zoom);t.setBearing(i.bearing);t.setPitch(i.pitch);this.updateLayers();this.updateFramework(n);this.map.resize()};i.resolveOnRender=function(n){var t=this.map;t.on("render",function i(){t.loaded()&&(t.off("render",i),n())})};i.rejectOnError=function(n){function i(){n(new Error(r.mapOnErrorMsg))}var t=this.map;t.once("error",i);t.once("style.error",i);t.once("source.error",i);t.once("tile.error",i);t.once("layer.error",i)};i.createFramework=function(n){var t=this,i=t.div=document.createElement("div");i.id=t.uid;i.style.position="absolute";t.container.appendChild(i);t.xaxis={_id:"x",c2p:function(n){return t.project(n).x}};t.yaxis={_id:"y",c2p:function(n){return t.project(n).y}};t.updateFramework(n)};i.updateFramework=function(n){var t=n[this.id].domain,i=n._size,r=this.div.style;r.width=i.w*(t.x[1]-t.x[0])+"px";r.height=i.h*(t.y[1]-t.y[0])+"px";r.left=i.l+t.x[0]*i.w+"px";r.top=i.t+(1-t.y[1])*i.h+"px";this.xaxis._offset=i.l+t.x[0]*i.w;this.xaxis._length=i.w*(t.x[1]-t.x[0]);this.yaxis._offset=i.t+(1-t.y[1])*i.h;this.yaxis._length=i.h*(t.y[1]-t.y[0])};i.updateLayers=function(){var r=this.opts,i=r.layers,t=this.layerList,n;if(i.length!==t.length){for(n=0;n<t.length;n++)t[n].dispose();for(t=this.layerList=[],n=0;n<i.length;n++)t.push(a(this,n,i[n]))}else for(n=0;n<i.length;n++)t[n].update(i[n])};i.destroy=function(){this.map&&this.map.remove();this.container.removeChild(this.div)};i.toImage=function(){return this.map.getCanvas().toDataURL()};i.initSource=function(n){return this.map.addSource(n,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[]}}})};i.setSourceData=function(n,t){this.map.getSource(n).setData(t)};i.setOptions=function(n,t,i){for(var u,e=this.map,f=Object.keys(i),r=0;r<f.length;r++)u=f[r],e[t](n,u,i[u])};i.project=function(n){return this.map.project(new f.LngLat(n[0],n[1]))};i.getView=function(){var n=this.map,t=n.getCenter(),i={lon:t.lng,lat:t.lat};return{center:i,zoom:n.getZoom(),bearing:n.getBearing(),pitch:n.getPitch()}}},{"../../lib":681,"../cartesian/graph_interact":717,"./constants":761,"./layers":764,"./layout_attributes":765,"mapbox-gl":336}],768:[function(n,t){"use strict";t.exports={t:{valType:"number",dflt:0},r:{valType:"number",dflt:0},b:{valType:"number",dflt:0},l:{valType:"number",dflt:0}}},{}],769:[function(n,t){"use strict";function p(n,t){var r,u,f;if(t.text(""),r=t.append("a").attr({"xlink:xlink:href":"#","class":"link--impt link--embedview","font-weight":"bold"}).text(n._context.linkText+" "+String.fromCharCode(187)),n._context.sendData)r.on("click",function(){i.sendDataToCloud(n)});else u=window.location.pathname.split("/"),f=window.location.search,r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+u[2].split(".")[0]+"/"+u[1]+f})}function e(n,t){for(var u,s=r.isPlainObject,c=Array.isArray,l=Object.keys(t||{}),h=0;h<l.length;h++){var f=l[h],i=t[f],o=n[f];if(f.charAt(0)==="_"||typeof i=="function"){if(f in n)continue;n[f]=i}else if(c(i)&&c(o)&&s(i[0]))for(u=0;u<i.length;u++)s(i[u])&&s(o[u])&&e(o[u],i[u]);else s(i)&&s(o)&&(e(o,i),Object.keys(o).length||delete n[f])}}function w(n,t,i){var h=i._globalTransforms||[],u;if(Array.isArray(n.transforms)||h.length!==0){var a=n.transforms||[],l=h.concat(a),v=t.transforms=[];for(u=0;u<l.length;u++){var o=l[u],s=o.type,f=c[s],e;f||r.warn("Unrecognized transform type "+s+".");f&&f.supplyDefaults?(e=f.supplyDefaults(o,t,i,n),e.type=s):e=r.extendFlat({},o);v.push(e)}}}function b(n,t,i,r){for(var o,f,s=n.transforms,e=[n],u=0;u<s.length;u++)o=s[u],f=c[o.type],f&&f.transform&&(e=f.transform(e,{transform:o,fullTrace:n,fullData:t,layout:i,fullLayout:r,transformIndex:u}));return e}var o=n("d3"),l=n("fast-isnumeric"),u=n("../plotly"),f=n("../registry"),r=n("../lib"),s=n("../components/color"),i=t.exports={},h=n("./animation_attributes"),v=n("./frame_attributes");r.extendFlat(i,f);i.attributes=n("./attributes");i.attributes.type.values=i.allTypes;i.fontAttrs=n("./font_attributes");i.layoutAttributes=n("./layout_attributes");i.fontWeight="normal";var a=i.subplotsRegistry,c=i.transformsRegistry,y=n("../components/errorbars");i.findSubplotIds=function(n,t){var r=[],e,u,f;if(i.subplotsRegistry[t]===undefined)return r;for(e=i.subplotsRegistry[t].attr,u=0;u<n.length;u++)f=n[u],i.traceIs(f,t)&&r.indexOf(f[e])===-1&&r.push(f[e]);return r};i.getSubplotIds=function(n,t){var u=i.subplotsRegistry[t],r,e,o;if(u===undefined)return[];if(t==="cartesian"&&(!n._has||!n._has("cartesian")))return[];if(t==="gl2d"&&(!n._has||!n._has("gl2d")))return[];if(t==="cartesian"||t==="gl2d")return Object.keys(n._plots||{});var h=u.idRegex,s=Object.keys(n),f=[];for(r=0;r<s.length;r++)e=s[r],h.test(e)&&f.push(e);return o=u.idRoot.length,f.sort(function(n,t){var i=+(n.substr(o)||1),r=+(t.substr(o)||1);return i-r}),f};i.getSubplotData=function(n,t,r){var e,o,f,s;if(i.subplotsRegistry[t]===undefined)return[];for(e=i.subplotsRegistry[t].attr,o=[],s=0;s<n.length;s++)if(f=n[s],t==="gl2d"&&i.traceIs(f,"gl2d")){var h=u.Axes.subplotMatch,c="x"+r.match(h)[1],l="y"+r.match(h)[2];f[e[0]]===c&&f[e[1]]===l&&o.push(f)}else f[e]===r&&o.push(f);return o};i.redrawText=function(n){if(!n.data||!n.data[0]||!n.data[0].r)return new Promise(function(t){setTimeout(function(){f.getComponentMethod("annotations","draw")(n);f.getComponentMethod("legend","draw")(n);(n.calcdata||[]).forEach(function(n){n[0]&&n[0].t&&n[0].t.cb&&n[0].t.cb()});t(i.previousPromises(n))},300)})};i.resize=function(n){return new Promise(function(t,i){n&&o.select(n).style("display")!=="none"||i(new Error("Resize must be passed a plot div element."));n._redrawTimer&&clearTimeout(n._redrawTimer);n._redrawTimer=setTimeout(function(){if((n._fullLayout||{}).autosize){var i=n.changed;n.autoplay=!0;u.relayout(n,{autosize:!0});n.changed=i;t(n)}},100)})};i.previousPromises=function(n){if((n._promises||[]).length)return Promise.all(n._promises).then(function(){n._promises=[]})};i.addLinks=function(n){var r=n._fullLayout,t=r._paper.selectAll("text.js-plot-link-container").data([0]),u,i;t.enter().append("text").classed("js-plot-link-container",!0).style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:s.defaultLine,"pointer-events":"all"}).each(function(){var n=o.select(this);n.append("tspan").classed("js-link-to-tool",!0);n.append("tspan").classed("js-link-spacer",!0);n.append("tspan").classed("js-sourcelinks",!0)});u=t.node();i={y:r._paper.attr("height")-9};document.body.contains(u)&&u.getComputedTextLength()>=r.width-20?(i["text-anchor"]="start",i.x=5):(i["text-anchor"]="end",i.x=r._paper.attr("width")-7);t.attr(i);var f=t.select(".js-link-to-tool"),e=t.select(".js-link-spacer"),h=t.select(".js-sourcelinks");n._context.showSources&&n._context.showSources(n);n._context.showLink&&p(n,f);e.text(f.text()&&h.text()?" - ":"")};i.sendDataToCloud=function(n){n.emit("plotly_beforeexport");var u=window.PLOTLYENV&&window.PLOTLYENV.BASE_URL||"https://plot.ly",t=o.select(n).append("div").attr("id","hiddenform").style("display","none"),r=t.append("form").attr({action:u+"/external",method:"post",target:"_blank"}),f=r.append("input").attr({type:"text",name:"data"});return f.node().value=i.graphJson(n,!1,"keepdata"),r.node().submit(),t.remove(),n.emit("plotly_afterexport"),!1};i.supplyDefaults=function(n){var s=n._fullLayout||{},t=n._fullLayout={},h=n.layout||{},o=n._fullData||[],f=n._fullData=[],c=n.data||[],r,l,a,v,y,p;for(i.supplyLayoutGlobalDefaults(h,t),t._dataLength=c.length,t._globalTransforms=(n._context||{}).globalTransforms,i.supplyDataDefaults(c,f,h,t),t._has=i._hasPlotType.bind(t),l=t._modules,r=0;r<l.length;r++)a=l[r],a.cleanData&&a.cleanData(f);if(o.length===c.length)for(r=0;r<f.length;r++)e(f[r],o[r]);for(i.supplyLayoutModuleDefaults(h,t,f),t._hasCartesian=t._has("cartesian"),t._hasGeo=t._has("geo"),t._hasGL3D=t._has("gl3d"),t._hasGL2D=t._has("gl2d"),t._hasTernary=t._has("ternary"),t._hasPie=t._has("pie"),i.cleanPlot(f,t,o,s),i.linkSubplots(f,t,o,s),e(t,s),i.doAutoMargin(n),v=u.Axes.list(n),r=0;r<v.length;r++)y=v[r],y._gd=n,y.setScale();if((n.calcdata||[]).length===f.length)for(r=0;r<f.length;r++)p=f[r],(n.calcdata[r][0]||{}).trace=p;n._transitionData||i.createTransitionData(n)};i.createTransitionData=function(n){n._transitionData||(n._transitionData={});n._transitionData._frames||(n._transitionData._frames=[]);n._transitionData._frameHash||(n._transitionData._frameHash={});n._transitionData._counter||(n._transitionData._counter=0);n._transitionData._interruptCallbacks||(n._transitionData._interruptCallbacks=[])};i._hasPlotType=function(n){for(var r,i=this._basePlotModules||[],t=0;t<i.length;t++)if(r=i[t],r.name===n)return!0;return!1};i.cleanPlot=function(n,t,i,r){for(var e,s=r._basePlotModules||[],o,h,c,l,f,a,u=0;u<s.length;u++)o=s[u],o.clean&&o.clean(n,t,i,r);h=!!r._paper;c=!!r._infolayer;n:for(u=0;u<i.length;u++){for(l=i[u],f=l.uid,e=0;e<n.length;e++)if(a=n[e],f===a.uid)continue n;h&&r._paper.selectAll(".hm"+f+",.contour"+f+",#clip"+f+",.trace"+f).remove();c&&r._infolayer.selectAll(".cb"+f).remove()}};i.linkSubplots=function(n,t,i,r){for(var f,h,e,a=r._plots||{},c=t._plots={},o={data:n,_fullLayout:t},l=u.Axes.getSubplots(o),s=0;s<l.length;s++)f=l[s],h=a[f],h?e=c[f]=h:(e=c[f]={},e.id=f),e.xaxis=u.Axes.getFromId(o,f,"x"),e.yaxis=u.Axes.getFromId(o,f,"y")};i.supplyDataDefaults=function(n,t,u,f){function y(n){t.push(n);var i=n._module;i&&(r.pushUnique(p,i),r.pushUnique(w,n._module.basePlotModule),s++)}for(var l,e,v,c,a,o,p=f._modules=[],w=f._basePlotModules=[],s=0,h=0;h<n.length;h++)if(l=n[h],e=i.supplyTraceDefaults(l,s,f),e.index=h,e._input=l,e._expandedIndex=s,e.transforms&&e.transforms.length)for(v=b(e,t,u,f),c=0;c<v.length;c++)a=v[c],o=i.supplyTraceDefaults(a,s,f),a.uid=o.uid=e.uid+c,o.index=h,o._input=l,o._fullInput=e,o._expandedIndex=s,o._expandedInput=a,y(o);else y(e)};i.supplyAnimationDefaults=function(n){function f(t,i){return r.coerce(n||{},u,h,t,i)}n=n||{};var t,u={};if(f("mode"),Array.isArray(n.frame))for(u.frame=[],t=0;t<n.frame.length;t++)u.frame[t]=i.supplyAnimationFrameDefaults(n.frame[t]||{});else u.frame=i.supplyAnimationFrameDefaults(n.frame||{});if(Array.isArray(n.transition))for(u.transition=[],t=0;t<n.transition.length;t++)u.transition[t]=i.supplyAnimationTransitionDefaults(n.transition[t]||{});else u.transition=i.supplyAnimationTransitionDefaults(n.transition||{});return u};i.supplyAnimationFrameDefaults=function(n){function i(i,u){return r.coerce(n||{},t,h.frame,i,u)}var t={};return i("duration"),i("redraw"),t};i.supplyAnimationTransitionDefaults=function(n){function i(i,u){return r.coerce(n||{},t,h.transition,i,u)}var t={};return i("duration"),i("easing"),t};i.supplyFrameDefaults=function(n){function t(t,u){return r.coerce(n,i,v,t,u)}var i={};return t("group"),t("name"),t("traces"),t("baseframe"),t("data"),t("layout"),i};i.supplyTraceDefaults=function(n,t,u){function e(t,u){return r.coerce(n,f,i.attributes,t,u)}function o(t,u){if(i.traceIs(f,t))return r.coerce(n,f,i.subplotsRegistry[t].attributes,u)}var f={},p=s.defaults[t%s.defaults.length],b=e("visible"),v,h,c,y,l;for(e("type"),e("uid"),e("name","trace "+t),v=Object.keys(a),h=0;h<v.length;h++)(c=v[h],["cartesian","gl2d"].indexOf(c)===-1)&&(y=a[c].attr,y&&o(c,y));return b&&(l=i.getModule(f),f._module=l,e("hoverinfo",u._dataLength===1?"x+y+z+text":undefined),l&&l.supplyDefaults(n,f,p,u),i.traceIs(f,"noOpacity")||e("opacity"),o("cartesian","xaxis"),o("cartesian","yaxis"),o("gl2d","xaxis"),o("gl2d","yaxis"),i.traceIs(f,"showLegend")&&(e("showlegend"),e("legendgroup")),w(n,f,u)),f};i.supplyLayoutGlobalDefaults=function(n,t){function u(u,f){return r.coerce(n,t,i.layoutAttributes,u,f)}var f=r.coerceFont(u,"font"),e;u("title");r.coerceFont(u,"titlefont",{family:f.family,size:Math.round(f.size*1.4),color:f.color});e=u("autosize",n.width&&n.height?!1:"initial");u("width");u("height");u("margin.l");u("margin.r");u("margin.t");u("margin.b");u("margin.pad");u("margin.autoexpand");e!=="initial"&&i.sanitizeMargins(t);u("paper_bgcolor");u("separators");u("hidesources");u("smith")};i.supplyLayoutModuleDefaults=function(n,t,i){var r,e,o,s,h;for(u.Axes.supplyLayoutDefaults(n,t,i),o=t._basePlotModules,r=0;r<o.length;r++)(e=o[r],e.name!=="cartesian")&&e.supplyLayoutDefaults&&e.supplyLayoutDefaults(n,t,i);for(s=t._modules,r=0;r<s.length;r++)e=s[r],e.supplyLayoutDefaults&&e.supplyLayoutDefaults(n,t,i);for(u.Fx.supplyLayoutDefaults(n,t,i),h=Object.keys(f.componentsRegistry),r=0;r<h.length;r++)e=f.componentsRegistry[h[r]],e.supplyLayoutDefaults&&e.supplyLayoutDefaults(n,t,i)};i.purge=function(n){var t=n._fullLayout||{};t._glcontainer!==undefined&&t._glcontainer.remove();t._geocontainer!==undefined&&t._geocontainer.remove();t._modeBar&&t._modeBar.destroy();n._transitionData&&n._transitionData._animationRaf&&window.cancelAnimationFrame(n._transitionData._animationRaf);delete n.data;delete n.layout;delete n._fullData;delete n._fullLayout;delete n.calcdata;delete n.framework;delete n.empty;delete n.fid;delete n.undoqueue;delete n.undonum;delete n.autoplay;delete n.changed;delete n._tester;delete n._testref;delete n._promises;delete n._redrawTimer;delete n._replotting;delete n.firstscatter;delete n.hmlumcount;delete n.hmpixcount;delete n.numboxes;delete n._hoverTimer;delete n._lastHoverTime;delete n._transitionData;delete n._transitioning;n.removeAllListeners&&n.removeAllListeners()};i.style=function(n){for(var i,r=n._fullLayout._modules,t=0;t<r.length;t++)i=r[t],i.style&&i.style(n)};i.sanitizeMargins=function(n){if(n&&n.margin){var r=n.width,u=n.height,t=n.margin,f=r-(t.l+t.r),e=u-(t.t+t.b),i;f<0&&(i=(r-1)/(t.l+t.r),t.l=Math.floor(i*t.l),t.r=Math.floor(i*t.r));e<0&&(i=(u-1)/(t.t+t.b),t.t=Math.floor(i*t.t),t.b=Math.floor(i*t.b))}};i.autoMargin=function(n,t,r){var u=n._fullLayout,f;u._pushmargin||(u._pushmargin={});u.margin.autoexpand!==!1&&(r?(f=r.pad===undefined?12:r.pad,r.l+r.r>u.width*.5&&(r.l=r.r=0),r.b+r.t>u.height*.5&&(r.b=r.t=0),u._pushmargin[t]={l:{val:r.x,size:r.l+f},r:{val:r.x,size:r.r+f},b:{val:r.y,size:r.b+f},t:{val:r.y,size:r.t+f}}):delete u._pushmargin[t],n._replotting||i.doAutoMargin(n))};i.doAutoMargin=function(n){var t=n._fullLayout;t._size||(t._size={});t._pushmargin||(t._pushmargin={});var i=t._size,h=JSON.stringify(i),f=Math.max(t.margin.l||0,0),e=Math.max(t.margin.r||0,0),o=Math.max(t.margin.t||0,0),s=Math.max(t.margin.b||0,0),r=t._pushmargin;return t.margin.autoexpand!==!1&&(r.base={l:{val:0,size:f},r:{val:1,size:e},t:{val:1,size:o},b:{val:0,size:s}},Object.keys(r).forEach(function(n){var a=r[n].l||{},v=r[n].b||{},i=a.val,h=a.size,u=v.val,c=v.size;Object.keys(r).forEach(function(n){var a,k,y,p,v,d,w,b;l(h)&&r[n].r&&(a=r[n].r.val,k=r[n].r.size,a>i&&(y=(h*a+(k-t.width)*i)/(a-i),p=(k*(1-i)+(h-t.width)*(1-a))/(a-i),y>=0&&p>=0&&y+p>f+e&&(f=y,e=p)));l(c)&&r[n].t&&(v=r[n].t.val,d=r[n].t.size,v>u&&(w=(c*v+(d-t.height)*u)/(v-u),b=(d*(1-u)+(c-t.height)*(1-v))/(v-u),w>=0&&b>=0&&w+b>s+o&&(s=w,o=b)))})})),i.l=Math.round(f),i.r=Math.round(e),i.t=Math.round(o),i.b=Math.round(s),i.p=Math.round(t.margin.pad),i.w=Math.round(t.width)-i.l-i.r,i.h=Math.round(t.height)-i.t-i.b,!n._replotting&&h!=="{}"&&h!==JSON.stringify(t._size)?u.plot(n):void 0};i.graphJson=function(n,t,u,f,e){function s(n){if(typeof n=="function")return null;if(r.isPlainObject(n)){var f={},t,i;for(t in n)if(typeof n[t]!="function"&&["_","["].indexOf(t.charAt(0))===-1){if(u==="keepdata"){if(t.substr(t.length-3)==="src")continue}else if(u==="keepstream"){if(i=n[t+"src"],typeof i=="string"&&i.indexOf(":")>0&&!r.isPlainObject(n.stream))continue}else if(u!=="keepall"&&(i=n[t+"src"],typeof i=="string"&&i.indexOf(":")>0))continue;f[t]=s(n[t])}return f}return Array.isArray(n)?n.map(s):n&&n.getTime?r.ms2DateTime(n):n}var h,c,o;return(e&&t&&!n._fullData||e&&!t&&!n._fullLayout)&&i.supplyDefaults(n),h=e?n._fullData:n.data,c=e?n._fullLayout:n.layout,o={data:(h||[]).map(function(n){var i=s(n);return t&&delete i.fit,i})},t||(o.layout=s(c)),n.framework&&n.framework.isPolar&&(o=n.framework.getConfig()),f==="object"?o:JSON.stringify(o)};i.modifyFrames=function(n,t){for(var r,i,u=n._transitionData._frames,f=n._transitionData._frameHash,s,o,e=0;e<t.length;e++){r=t[e];switch(r.type){case"replace":i=r.value;s=u[r.index].name;o=i.name;u[r.index]=f[o]=i;o!==s&&(delete f[s],f[o]=i);break;case"insert":i=r.value;f[i.name]=i;u.splice(r.index,0,i);break;case"delete":i=u[r.index];delete f[i.name];u.splice(r.index,1)}}return Promise.resolve()};i.computeFrame=function(n,t){var l=n._transitionData._frameHash,f,o,s,e,r=l[t],h,c,u;if(!r)return!1;for(h=[r],c=[r.name];r=l[r.baseframe];){if(c.indexOf(r.name)!==-1)break;h.push(r);c.push(r.name)}for(u={};r=h.pop();)if(r.layout&&(u.layout=i.extendLayout(u.layout,r.layout)),r.data){if(u.data||(u.data=[]),o=r.traces,!o)for(o=[],f=0;f<r.data.length;f++)o[f]=f;for(u.traces||(u.traces=[]),f=0;f<r.data.length;f++)(s=o[f],s!==undefined&&s!==null)&&(e=u.traces.indexOf(s),e===-1&&(e=u.data.length,u.traces[e]=s),u.data[e]=i.extendTrace(u.data[e],r.data[f]))}return u};i.extendObjectWithContainers=function(n,t,u){var h,l,f,e,a,c,s,o,p=r.extendDeepNoArrays({},t||{}),v=r.expandObjectPaths(p),y={};if(u&&u.length)for(f=0;f<u.length;f++)h=r.nestedProperty(v,u[f]),l=h.get(),h.set(null),r.nestedProperty(y,u[f]).set(l);if(n=r.extendDeepNoArrays(n||{},v),u&&u.length)for(f=0;f<u.length;f++)if(a=r.nestedProperty(y,u[f]),s=a.get(),s)for(c=r.nestedProperty(n,u[f]),o=c.get(),Array.isArray(o)||(o=[],c.set(o)),e=0;e<s.length;e++)o[e]=i.extendObjectWithContainers(o[e],s[e]);return n};i.extendTrace=function(n,t){return i.extendObjectWithContainers(n,t,["transforms"])};i.extendLayout=function(n,t){return i.extendObjectWithContainers(n,t,["annotations","shapes","images","sliders","updatemenus"])};i.transition=function(n,t,f,e,o,s){function tt(){for(var e,l,o,u=0;u<c.length;u++){var s=c[u],a=n._fullData[s],h=a._module;h&&h.animatable&&(w.push(s),n.data[c[u]]=i.extendTrace(n.data[c[u]],t[u]))}e=r.expandObjectPaths(r.extendDeepNoArrays({},f));l=/^[xy]axis[0-9]*$/;for(o in e)l.test(o)&&delete e[o].range;return r.extendDeepNoArrays(n.layout,e),i.supplyDefaults(n),i.doCalcdata(n),y.calc(n),Promise.resolve()}function it(n){var t=Promise.resolve();if(!n)return t;while(n.length)t=t.then(n.shift());return t}function rt(n){if(n)while(n.length)n.shift()}function ut(){return new Promise(function(t){function l(){return h++,function(){c++;b||c!==h||ft(t)}}var h,c,e,i,u,o,a;if(n._transitioning=!0,s.duration>0&&(n._transitioningWithDuration=!0),n._transitionData._interruptCallbacks.push(function(){b=!0}),h=0,c=0,u=n._fullLayout._basePlotModules,o=!1,f)for(i=0;i<u.length;i++)u[i].transitionAxes&&(a=r.expandObjectPaths(f),o=u[i].transitionAxes(n,a,s,l)||o);for(o?(e=r.extendFlat({},s),e.duration=0):e=s,i=0;i<u.length;i++)u[i].plot(n,w,e,l);setTimeout(l())})}function ft(t){return rt(n._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(o.redraw)return u.redraw(n)}).then(function(){n._transitioning=!1;n._transitioningWithDuration=!1;n.emit("plotly_transitioned",[])}).then(t)}function et(){return n.emit("plotly_transitioninterrupted",[]),n._transitioning=!1,n._transtionWithDuration=!1,it(n._transitionData._interruptCallbacks)}for(var p,nt=Array.isArray(t)?t.length:0,c=e.slice(0,nt),w=[],b=!1,k,a,d,v,g,l,h=0;h<c.length;h++)if((p=c[h],k=n._fullData[p],a=k._module,a)&&!a.animatable){d={};for(v in t[h])d[v]=[t[h][v]]}return g=[i.previousPromises,et,tt,ut],l=r.syncOrAsync(g,n),l&&l.then||(l=Promise.resolve()),l.then(function(){return n.emit("plotly_transitioning",[]),n})};i.doCalcdata=function(n,t){var h=u.Axes.list(n),l=n._fullData,v=n._fullLayout,i,o,s=new Array(l.length),y=(n.calcdata||[]).slice(0),f,e,r,a;for(n.calcdata=s,n.firstscatter=!0,n.numboxes=0,n._hmpixcount=0,n._hmlumcount=0,v._piecolormap={},v._piedefaultcolorcount=0,i=0;i<h.length;i++)h[i]._categories=h[i]._initialCategories.slice();for(i=0;i<l.length;i++){if(Array.isArray(t)&&t.indexOf(i)===-1){s[i]=y[i];continue}if(f=l[i],e=[],Array.isArray(t)&&t.indexOf(i)===-1){s[i]=y[i];continue}if(f.visible===!0){if(f.transforms)for(r=f._module,r&&r.calc&&r.calc(n,f),o=0;o<f.transforms.length;o++)a=f.transforms[o],r=c[a.type],r&&r.calcTransform&&r.calcTransform(n,f,a);r=f._module;r&&r.calc&&(e=r.calc(n,f))}Array.isArray(e)&&e[0]||(e=[{x:!1,y:!1,placeholder:!0}]);e[0].t||(e[0].t={});e[0].trace=f;s[i]=e}}},{"../components/color":582,"../components/errorbars":611,"../lib":681,"../plotly":706,"../registry":784,"./animation_attributes":707,"./attributes":708,"./font_attributes":729,"./frame_attributes":730,"./layout_attributes":760,d3:129,"fast-isnumeric":133}],770:[function(n,t){"use strict";var r=n("../../traces/scatter/attributes"),i=r.marker;t.exports={r:r.r,t:r.t,marker:{color:i.color,size:i.size,symbol:i.symbol,opacity:i.opacity}}},{"../../traces/scatter/attributes":889}],771:[function(n,t){"use strict";function u(n,t){return i({},t,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number"},visible:{valType:"boolean"}})}var f=n("../cartesian/layout_attributes"),i=n("../../lib/extend").extendFlat,r=i({},f.domain,{});t.exports={radialaxis:u("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:r,orientation:{valType:"number"}}),angularaxis:u("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:r}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}}},{"../../lib/extend":673,"../cartesian/layout_attributes":719}],772:[function(n,t){"use strict";var i=t.exports=n("./micropolar");i.manager=n("./micropolar_manager")},{"./micropolar":773,"./micropolar_manager":774}],773:[function(n,t){var r=n("d3"),f=n("../../lib"),u=f.extendDeepAll,i=t.exports={version:"0.2.2"};i.Axis=function(){function a(c){s=c||s;var a=o.data,l=o.layout;return(typeof s=="string"||s.nodeName)&&(s=r.select(s)),s.datum(a).each(function(e){function oi(n){return h(n)%360+l.orientation}var pt=e.slice(),ut,o,c,ft,ii,a,p,tt,v,y,et,ot,fi,ct,w,bt,ei,b,lt,at,si,g,vt,hi,ci,li,yt,kt,ai,it,bi,ni;t={data:i.util.cloneJson(pt),layout:i.util.cloneJson(l)};ut=0;pt.forEach(function(n,i){n.color||(n.color=l.defaultColorRange[ut],ut=(ut+1)%l.defaultColorRange.length);n.strokeColor||(n.strokeColor=n.geometry==="LinePlot"?n.color:r.rgb(n.color).darker().toString());t.data[i].color=n.color;t.data[i].strokeColor=n.strokeColor;t.data[i].strokeDash=n.strokeDash;t.data[i].strokeSize=n.strokeSize});var s=pt.filter(function(n){var t=n.visible;return typeof t=="undefined"||t===!0}),nt=!1,ki=s.map(function(n){return nt=nt||typeof n.groupId!="undefined",n});if(nt){var di=r.nest().key(function(n){return typeof n.groupId!="undefined"?n.groupId:"unstacked"}).entries(ki),ti=[],gi=di.map(function(n){if(n.key==="unstacked")return n.values;var t=n.values[0].r.map(function(){return 0});return n.values.forEach(function(n){n.yStack=[t];ti.push(t);t=i.util.sumArrays(n.r,t)}),n.values});s=r.merge(gi)}s.forEach(function(n){n.t=Array.isArray(n.t[0])?n.t:[n.t];n.r=Array.isArray(n.r[0])?n.r:[n.r]});o=Math.min(l.width-l.margin.left-l.margin.right,l.height-l.margin.top-l.margin.bottom)/2;o=Math.max(10,o);c=[l.margin.left+o,l.margin.top+o];nt?(ii=r.max(i.util.sumArrays(i.util.arrayLast(s).r[0],i.util.arrayLast(ti))),ft=[0,ii]):ft=r.extent(i.util.flattenArray(s.map(function(n){return n.r})));l.radialAxis.domain!=i.DATAEXTENT&&(ft[0]=0);f=r.scale.linear().domain(l.radialAxis.domain!=i.DATAEXTENT&&l.radialAxis.domain?l.radialAxis.domain:ft).range([0,o]);t.layout.radialAxis.domain=f.domain();a=i.util.flattenArray(s.map(function(n){return n.t}));p=typeof a[0]=="string";p&&(a=i.util.deduplicate(a),tt=a.slice(),a=r.range(a.length),s=s.map(function(n){var t=n;return n.t=[a],nt&&(t.yStack=n.yStack),t}));var ri=s.filter(function(n){return n.geometry==="LinePlot"||n.geometry==="DotPlot"}).length===s.length,ui=l.needsEndSpacing===null?p||!ri:l.needsEndSpacing,nr=l.angularAxis.domain&&l.angularAxis.domain!=i.DATAEXTENT&&!p&&l.angularAxis.domain[0]>=0,tr=nr?l.angularAxis.domain:r.extent(a),wt=Math.abs(a[1]-a[0]);if(ri&&!p&&(wt=0),v=tr.slice(),ui&&p&&(v[1]+=wt),y=l.angularAxis.ticksCount||4,y>8&&(y=y/(y/8)+y%8),l.angularAxis.ticksStep&&(y=(v[1]-v[0])/y),et=l.angularAxis.ticksStep||(v[1]-v[0])/(y*(l.minorTicks+1)),tt&&(et=Math.max(Math.round(et),1)),v[2]||(v[2]=et),ot=r.range.apply(this,v),ot=ot.map(function(n){return parseFloat(n.toPrecision(12))}),h=r.scale.linear().domain(v.slice(0,2)).range(l.direction==="clockwise"?[0,360]:[360,0]),t.layout.angularAxis.domain=h.domain(),t.layout.angularAxis.endPadding=ui?wt:0,n=r.select(this).select("svg.chart-root"),typeof n=="undefined"||n.empty()){var ir=(new DOMParser).parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'><\/circle>' + '<g class='geometry-group'><\/g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'><\/circle>' + '<\/g>' + '<g class='angular axis-group'><\/g>' + '<g class='guides-group'><line><\/line><circle r='0'><\/circle><\/g>' + '<\/g>' + '<g class='legend-group'><\/g>' + '<g class='tooltips-group'><\/g>' + '<g class='title-group'><text><\/text><\/g>' + '<\/g>' + '<\/svg>","application/xml"),rr=this.appendChild(this.ownerDocument.importNode(ir.documentElement,!0));n=r.select(rr)}n.select(".guides-group").style({"pointer-events":"none"});n.select(".angular.axis-group").style({"pointer-events":"none"});n.select(".radial.axis-group").style({"pointer-events":"none"});var st=n.select(".chart-group"),ht={fill:"none",stroke:l.tickColor},k={"font-size":l.font.size,"font-family":l.font.family,fill:l.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(n){return" "+n+" 0 "+l.font.outlineColor}).join(",")},d;l.showLegend?(d=n.select(".legend-group").attr({transform:"translate("+[o,l.margin.top]+")"}).style({display:"block"}),fi=s.map(function(n){var t=i.util.cloneJson(n);return t.symbol=n.geometry==="DotPlot"?n.dotType||"circle":n.geometry!="LinePlot"?"square":"line",t.visibleInLegend=typeof n.visibleInLegend=="undefined"||n.visibleInLegend,t.color=n.geometry==="LinePlot"?n.strokeColor:n.color,t}),i.Legend().config({data:s.map(function(n,t){return n.name||"Element"+t}),legendConfig:u({},i.Legend.defaultConfig().legendConfig,{container:d,elements:fi,reverseOrder:l.legend.reverseOrder})})(),ct=d.node().getBBox(),o=Math.min(l.width-ct.width-l.margin.left-l.margin.right,l.height-l.margin.top-l.margin.bottom)/2,o=Math.max(10,o),c=[l.margin.left+o,l.margin.top+o],f.range([0,o]),t.layout.radialAxis.domain=f.domain(),d.attr("transform","translate("+[c[0]+o,c[1]-o]+")")):d=n.select(".legend-group").style({display:"none"});n.attr({width:l.width,height:l.height}).style({opacity:l.opacity});st.attr("transform","translate("+c+")").style({cursor:"crosshair"});w=[(l.width-(l.margin.left+l.margin.right+o*2+(ct?ct.width:0)))/2,(l.height-(l.margin.top+l.margin.bottom+o*2))/2];w[0]=Math.max(0,w[0]);w[1]=Math.max(0,w[1]);n.select(".outer-group").attr("transform","translate("+w+")");l.title&&(bt=n.select("g.title-group text").style(k).text(l.title),ei=bt.node().getBBox(),bt.attr({x:c[0]-ei.width/2,y:c[1]-o-20}));b=n.select(".radial.axis-group");l.radialAxis.gridLinesVisible&&(lt=b.selectAll("circle.grid-circle").data(f.ticks(5)),lt.enter().append("circle").attr({"class":"grid-circle"}).style(ht),lt.attr("r",f),lt.exit().remove());b.select("circle.outside-circle").attr({r:o}).style(ht);at=n.select("circle.background-circle").attr({r:o}).style({fill:l.backgroundColor,stroke:l.stroke});l.radialAxis.visible&&(si=r.svg.axis().scale(f).ticks(5).tickSize(5),b.call(si).attr({transform:"rotate("+l.radialAxis.orientation+")"}),b.selectAll(".domain").style(ht),b.selectAll("g>text").text(function(){return this.textContent+l.radialAxis.ticksSuffix}).style(k).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return l.radialAxis.tickOrientation==="horizontal"?"rotate("+-l.radialAxis.orientation+") translate("+[0,k["font-size"]]+")":"translate("+[0,k["font-size"]]+")"}}),b.selectAll("g>line").style({stroke:"black"}));g=n.select(".angular.axis-group").selectAll("g.angular-tick").data(ot);vt=g.enter().append("g").classed("angular-tick",!0);g.attr({transform:function(n,t){return"rotate("+oi(n,t)+")"}}).style({display:l.angularAxis.visible?"block":"none"});g.exit().remove();vt.append("line").classed("grid-line",!0).classed("major",function(n,t){return t%(l.minorTicks+1)==0}).classed("minor",function(n,t){return!(t%(l.minorTicks+1)==0)}).style(ht);vt.selectAll(".minor").style({stroke:l.minorTickColor});g.select("line.grid-line").attr({x1:l.tickLength?o-l.tickLength:0,x2:o}).style({display:l.angularAxis.gridLinesVisible?"block":"none"});vt.append("text").classed("axis-text",!0).style(k);hi=g.select("text.axis-text").attr({x:o+l.labelOffset,dy:".35em",transform:function(n,t){var i=oi(n,t),r=o+l.labelOffset,u=l.angularAxis.tickOrientation;return u=="horizontal"?"rotate("+-i+" "+r+" 0)":u=="radial"?i<270&&i>90?"rotate(180 "+r+" 0)":null:"rotate("+(i<=180&&i>0?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle",display:l.angularAxis.labelsVisible?"block":"none"}).text(function(n,t){return t%(l.minorTicks+1)!=0?"":tt?tt[n]+l.angularAxis.ticksSuffix:n+l.angularAxis.ticksSuffix}).style(k);l.angularAxis.rewriteTicks&&hi.text(function(n,t){return t%(l.minorTicks+1)!=0?"":l.angularAxis.rewriteTicks(this.textContent,t)});ci=r.max(st.selectAll(".angular-tick text")[0].map(function(n){return n.getCTM().e+n.getBBox().width}));d.attr({transform:"translate("+[o+ci,l.margin.top]+")"});li=n.select("g.geometry-group").selectAll("g").size()>0;yt=n.select("g.geometry-group").selectAll("g.geometry").data(s);yt.enter().append("g").attr({"class":function(n,t){return"geometry geometry"+t}});yt.exit().remove();(s[0]||li)&&(kt=[],s.forEach(function(n,t){var i={};i.radialScale=f;i.angularScale=h;i.container=yt.filter(function(n,i){return i==t});i.geometry=n.geometry;i.orientation=l.orientation;i.direction=l.direction;i.index=t;kt.push({data:n,geometryConfig:i})}),ai=r.nest().key(function(n){return typeof n.data.groupId!="undefined"||"unstacked"}).entries(kt),it=[],ai.forEach(function(n){n.key==="unstacked"?it=it.concat(n.values.map(function(n){return[n]})):it.push(n.values)}),it.forEach(function(n){var t,r;t=Array.isArray(n)?n[0].geometryConfig.geometry:n.geometryConfig.geometry;r=n.map(function(n){return u(i[t].defaultConfig(),n)});i[t]().config(r)()}));var dt=n.select(".guides-group"),gt=n.select(".tooltips-group"),vi=i.tooltipPanel().config({container:gt,fontSize:8})(),yi=i.tooltipPanel().config({container:gt,fontSize:8})(),rt=i.tooltipPanel().config({container:gt,hasTick:!0})(),pi,wi;if(!p){bi=dt.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});st.on("mousemove.angular-guide",function(){var n=i.util.getMousePos(at).angle,r,t;bi.attr({x2:-o,transform:"rotate("+n+")"}).style({opacity:.5});r=(n+180+360-l.orientation)%360;pi=h.invert(r);t=i.util.convertToCartesian(o+12,n+180);vi.text(i.util.round(pi)).move([t[0]+c[0],t[1]+c[1]])}).on("mouseout.angular-guide",function(){dt.select("line").style({opacity:0})})}ni=dt.select("circle").style({stroke:"grey",fill:"none"});st.on("mousemove.radial-guide",function(){var t=i.util.getMousePos(at).radius,n;ni.attr({r:t}).style({opacity:.5});wi=f.invert(i.util.getMousePos(at).radius);n=i.util.convertToCartesian(t,l.radialAxis.orientation);yi.text(i.util.round(wi)).move([n[0]+c[0],n[1]+c[1]])}).on("mouseout.radial-guide",function(){ni.style({opacity:0});rt.hide();vi.hide();yi.hide()});n.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(t){var u=r.select(this),f=u.style("fill"),e="black",c=u.style("opacity")||1,o;if(u.attr({"data-opacity":c}),f!="none"){u.attr({"data-fill":f});e=r.hsl(f).darker().toString();u.style({fill:e,opacity:1});o={t:i.util.round(t[0]),r:i.util.round(t[1])};p&&(o.t=tt[t[0]]);var l="t: "+o.t+", r: "+o.r,s=this.getBoundingClientRect(),h=n.node().getBoundingClientRect(),a=[s.left+s.width/2-w[0]-h.left,s.top+s.height/2-w[1]-h.top];rt.config({color:e}).text(l);rt.move(a)}else f=u.style("stroke"),u.attr({"data-stroke":f}),e=r.hsl(f).darker().toString(),u.style({stroke:e,opacity:1})}).on("mousemove.tooltip",function(){if(r.event.which!=0)return!1;r.select(this).attr("data-fill")&&rt.show()}).on("mouseout.tooltip",function(){rt.hide();var n=r.select(this),t=n.attr("data-fill");t?n.style({fill:t,opacity:n.attr("data-opacity")}):n.style({stroke:n.attr("data-stroke"),opacity:n.attr("data-opacity")})})}),e}var o={data:[],layout:{}},c={},t={},n,s,l=r.dispatch("hover"),f,h,e={};return e.render=function(n){return a(n),this},e.config=function(n){if(!arguments.length)return o;var t=i.util.cloneJson(n);return t.data.forEach(function(n,t){o.data[t]||(o.data[t]={});u(o.data[t],i.Axis.defaultConfig().data[0]);u(o.data[t],n)}),u(o.layout,i.Axis.defaultConfig().layout),u(o.layout,t.layout),this},e.getLiveConfig=function(){return t},e.getinputConfig=function(){return c},e.radialScale=function(){return f},e.angularScale=function(){return h},e.svg=function(){return n},r.rebind(e,l,"on"),e};i.Axis.defaultConfig=function(){return{data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:r.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}}};i.util={};i.DATAEXTENT="dataExtent";i.AREA="AreaChart";i.LINE="LinePlot";i.DOT="DotPlot";i.BAR="BarChart";i.util._override=function(n,t){for(var i in n)i in t&&(t[i]=n[i])};i.util._extend=function(n,t){for(var i in n)t[i]=n[i]};i.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1)};i.util.dataFromEquation2=function(n,t){var i=t||6;return r.range(0,360+i,i).map(function(t){var i=t*Math.PI/180,r=n(i);return[t,r]})};i.util.dataFromEquation=function(n,t,i){var f=t||6,e=[],o=[],u;return r.range(0,360+f,f).forEach(function(t){var i=t*Math.PI/180,r=n(i);e.push(t);o.push(r)}),u={t:e,r:o},i&&(u.name=i),u};i.util.ensureArray=function(n,t){if(typeof n=="undefined")return null;var i=[].concat(n);return r.range(t).map(function(n,t){return i[t]||i[0]})};i.util.fillArrays=function(n,t,r){return t.forEach(function(t){n[t]=i.util.ensureArray(n[t],r)}),n};i.util.cloneJson=function(n){return JSON.parse(JSON.stringify(n))};i.util.validateKeys=function(n,t){typeof t=="string"&&(t=t.split("."));var i=t.shift();return n[i]&&(!t.length||objHasKeys(n[i],t))};i.util.sumArrays=function(n,t){return r.zip(n,t).map(function(n){return r.sum(n)})};i.util.arrayLast=function(n){return n[n.length-1]};i.util.arrayEqual=function(n,t){for(var i=Math.max(n.length,t.length,1);i-->=0&&n[i]===t[i];);return i===-2};i.util.flattenArray=function(n){for(var t=[];!i.util.arrayEqual(t,n);)t=n,n=[].concat.apply([],n);return n};i.util.deduplicate=function(n){return n.filter(function(n,t,i){return i.indexOf(n)==t})};i.util.convertToCartesian=function(n,t){var i=t*Math.PI/180,r=n*Math.cos(i),u=n*Math.sin(i);return[r,u]};i.util.round=function(n,t){var r=t||2,i=Math.pow(10,r);return Math.round(n*i)/i};i.util.getMousePos=function(n){var f=r.mouse(n.node()),i=f[0],u=f[1],t={};return t.x=i,t.y=u,t.pos=f,t.angle=(Math.atan2(u,i)+Math.PI)*180/Math.PI,t.radius=Math.sqrt(i*i+u*u),t};i.util.duplicatesCount=function(n){for(var i={},t,u={},r=0,f=n.length;r<f;r++)t=n[r],t in i?(i[t]++,u[t]=i[t]):i[t]=1;return u};i.util.duplicates=function(n){return Object.keys(i.util.duplicatesCount(n))};i.util.translator=function(n,t,i,r){var f,u;(r&&(f=i.slice(),i=t,t=f),u=t.reduce(function(n,t){if(typeof n!="undefined")return n[t]},n),typeof u!="undefined")&&(t.reduce(function(n,i,r){if(typeof n!="undefined")return r===t.length-1&&delete n[i],n[i]},n),i.reduce(function(n,t,r){return typeof n[t]=="undefined"&&(n[t]={}),r===i.length-1&&(n[t]=u),n[t]},n))};i.PolyChart=function(){function t(){var t=n[0].geometryConfig,i=t.container;typeof i=="string"&&(i=r.select(i));i.datum(n).each(function(n){function w(n){var i=t.radialScale(n[1]),r=(t.angularScale(n[0])+t.orientation)*Math.PI/180;return{r:i,t:r}}function b(n){var t=n.r*Math.cos(n.t),i=n.r*Math.sin(n.t);return{x:t,y:i}}var y=!!n[0].data.yStack,f=n.map(function(n){return y?r.zip(n.data.t[0],n.data.r[0],n.data.yStack[0]):r.zip(n.data.t[0],n.data.r[0])}),h=t.angularScale,c=t.radialScale.domain()[0],u={},l,i,o,s;u.bar=function(i,u,f){var c=n[f].data,s=t.radialScale(i[1])-t.radialScale(0),e=t.radialScale(i[2]||0),o=c.barWidth;r.select(this).attr({"class":"mark bar",d:"M"+[[s+e,-o/2],[s+e,o/2],[e,o/2],[e,-o/2]].join("L")+"Z",transform:function(n){return"rotate("+(t.orientation+h(n[0]))+")"}})};u.dot=function(t,i,u){var f=t[2]?[t[0],t[1]+t[2]]:t,e=r.svg.symbol().size(n[u].data.dotSize).type(n[u].data.dotType)(t,i);r.select(this).attr({"class":"mark dot",d:e,transform:function(){var n=b(w(f));return"translate("+[n.x,n.y]+")"}})};l=r.svg.line.radial().interpolate(n[0].data.lineInterpolation).radius(function(n){return t.radialScale(n[1])}).angle(function(n){return t.angularScale(n[0])*Math.PI/180});u.line=function(e,o,s){var c=e[2]?f[s].map(function(n){return[n[0],n[1]+n[2]]}):f[s],h;(r.select(this).each(u.dot).style({opacity:function(){return+n[s].data.dotVisible},fill:i.stroke(e,o,s)}).attr({"class":"mark dot"}),o>0)||(h=r.select(this.parentNode).selectAll("path.line").data([0]),h.enter().insert("path"),h.attr({"class":"line",d:l(c),transform:function(){return"rotate("+(t.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(){return i.fill(e,o,s)},"fill-opacity":0,stroke:function(){return i.stroke(e,o,s)},"stroke-width":function(){return i["stroke-width"](e,o,s)},"stroke-dasharray":function(){return i["stroke-dasharray"](e,o,s)},opacity:function(){return i.opacity(e,o,s)},display:function(){return i.display(e,o,s)}}))};var a=t.angularScale.range(),v=Math.abs(a[1]-a[0])/f[0].length*Math.PI/180,p=r.svg.arc().startAngle(function(){return-v/2}).endAngle(function(){return v/2}).innerRadius(function(n){return t.radialScale(c+(n[2]||0))}).outerRadius(function(n){return t.radialScale(c+(n[2]||0))+t.radialScale(n[1])});u.arc=function(){r.select(this).attr({"class":"mark arc",d:p,transform:function(n){return"rotate("+(t.orientation+h(n[0])+90)+")"}})};i={fill:function(t,i,r){return n[r].data.color},stroke:function(t,i,r){return n[r].data.strokeColor},"stroke-width":function(t,i,r){return n[r].data.strokeSize+"px"},"stroke-dasharray":function(t,i,r){return e[n[r].data.strokeDash]},opacity:function(t,i,r){return n[r].data.opacity},display:function(t,i,r){return typeof n[r].data.visible=="undefined"||n[r].data.visible?"block":"none"}};o=r.select(this).selectAll("g.layer").data(f);o.enter().append("g").attr({"class":"layer"});s=o.selectAll("path.mark").data(function(n){return n});s.enter().append("path").attr({"class":"mark"});s.style(i).each(u[t.geometryType]);s.exit().remove();o.exit().remove()})}var n=[i.PolyChart.defaultConfig()],f=r.dispatch("hover"),e={solid:"none",dash:[5,2],dot:[2,5]},o;return t.config=function(t){return arguments.length?(t.forEach(function(t,r){n[r]||(n[r]={});u(n[r],i.PolyChart.defaultConfig());u(n[r],t)}),this):n},t.getColorScale=function(){return o},r.rebind(t,f,"on"),t};i.PolyChart.defaultConfig=function(){return{data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:r.scale.category20()}}};i.BarChart=function(){return i.PolyChart()};i.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}};i.AreaChart=function(){return i.PolyChart()};i.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}};i.DotPlot=function(){return i.PolyChart()};i.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}};i.LinePlot=function(){return i.PolyChart()};i.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}};i.Legend=function(){function t(){var i=n.legendConfig,d=n.data.map(function(n,t){return[].concat(n).map(function(n,r){var f=u({},i.elements[t]);return f.name=n,f.color=[].concat(i.elements[t].color)[r],f})}),f=r.merge(d),s,v,c,k,l;f=f.filter(function(n,t){return i.elements[t]&&(i.elements[t].visibleInLegend||typeof i.elements[t].visibleInLegend=="undefined")});i.reverseOrder&&(f=f.reverse());s=i.container;(typeof s=="string"||s.nodeName)&&(s=r.select(s));var a=f.map(function(n){return n.color}),e=i.fontSize,o=i.isContinuous==null?typeof f[0]=="number":i.isContinuous,y=o?i.height:e*f.length,g=s.classed("legend-group",!0),h=g.selectAll("svg").data([0]),p=h.enter().append("svg").attr({width:300,height:y+e,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});p.append("g").classed("legend-axis",!0);p.append("g").classed("legend-marks",!0);var w=r.range(f.length),nt=r.scale[o?"linear":"ordinal"]().domain(w).range(a),b=r.scale[o?"linear":"ordinal"]().domain(w)[o?"range":"rangePoints"]([0,y]),tt=function(n,t){var i=t*3;return n==="line"?"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z":r.svg.symbolTypes.indexOf(n)!=-1?r.svg.symbol().type(n).size(i)():r.svg.symbol().type("square").size(i)()};return o?(v=h.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(a),v.enter().append("stop"),v.attr({offset:function(n,t){return t/(a.length-1)*100+"%"}}).style({"stop-color":function(n){return n}}),h.append("rect").classed("legend-mark",!0).attr({height:i.height,width:i.colorBandWidth,fill:"url(#grad1)"})):(c=h.select(".legend-marks").selectAll("path.legend-mark").data(f),c.enter().append("path").classed("legend-mark",!0),c.attr({transform:function(n,t){return"translate("+[e/2,b(t)+e/2]+")"},d:function(n){var t=n.symbol;return tt(t,e)},fill:function(n,t){return nt(t)}}),c.exit().remove()),k=r.svg.axis().scale(b).orient("right"),l=h.select("g.legend-axis").attr({transform:"translate("+[o?i.colorBandWidth:e,e/2]+")"}).call(k),l.selectAll(".domain").style({fill:"none",stroke:"none"}),l.selectAll("line").style({fill:"none",stroke:o?i.textColor:"none"}),l.selectAll("text").style({fill:i.textColor,"font-size":i.fontSize}).text(function(n,t){return f[t].name}),t}var n=i.Legend.defaultConfig(),f=r.dispatch("hover");return t.config=function(t){return arguments.length?(u(n,t),this):n},r.rebind(t,f,"on"),t};i.Legend.defaultConfig=function(){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}};i.tooltipPanel=function(){var t,o,s,f={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},h="tooltip-"+i.tooltipPanel.uid++,e=10,n=function(){t=f.container.selectAll("g."+h).data([0]);var i=t.enter().append("g").classed(h,!0).style({"pointer-events":"none",display:"none"});return s=i.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),o=i.append("text").attr({dx:f.padding+e,dy:+f.fontSize*.3}),n};return n.text=function(i){var c=r.hsl(f.color).l,v=c>=.5?"#aaa":"white",y=c>=.5?"black":"white",p=i||"";o.style({fill:y,"font-size":f.fontSize+"px"}).text(p);var h=f.padding,l=o.node().getBBox(),w={fill:f.color,stroke:v,"stroke-width":"2px"},a=l.width+h*2+e,u=l.height+h*2;return s.attr({d:"M"+[[e,-u/2],[e,-u/4],[f.hasTick?0:e,0],[e,u/4],[e,u/2],[a,u/2],[a,-u/2]].join("L")+"Z"}).style(w),t.attr({transform:"translate("+[e,-u/2+h*2]+")"}),t.style({display:"block"}),n},n.move=function(i){if(t)return t.attr({transform:"translate("+[i[0],i[1]]+")"}).style({display:"block"}),n},n.hide=function(){if(t)return t.style({display:"none"}),n},n.show=function(){if(t)return t.style({display:"block"}),n},n.config=function(t){return u(f,t),n},n};i.tooltipPanel.uid=1;i.adapter={};i.adapter.plotly=function(){var n={};return n.convert=function(n,t){var e={},o,f,s;if(n.data&&(e.data=n.data.map(function(n){var r=u({},n),f=[[r,["marker","color"],["color"]],[r,["marker","opacity"],["opacity"]],[r,["marker","line","color"],["strokeColor"]],[r,["marker","line","dash"],["strokeDash"]],[r,["marker","line","width"],["strokeSize"]],[r,["marker","symbol"],["dotType"]],[r,["marker","size"],["dotSize"]],[r,["marker","barWidth"],["barWidth"]],[r,["line","interpolation"],["lineInterpolation"]],[r,["showlegend"],["visibleInLegend"]]];return f.forEach(function(n){i.util.translator.apply(null,n.concat(t))}),t||delete r.marker,t&&delete r.groupId,t?(r.geometry==="LinePlot"?(r.type="scatter",r.dotVisible===!0?(delete r.dotVisible,r.mode="lines+markers"):r.mode="lines"):r.geometry==="DotPlot"?(r.type="scatter",r.mode="markers"):r.geometry==="AreaChart"?r.type="area":r.geometry==="BarChart"&&(r.type="bar"),delete r.geometry):(r.type==="scatter"?r.mode==="lines"?r.geometry="LinePlot":r.mode==="markers"?r.geometry="DotPlot":r.mode==="lines+markers"&&(r.geometry="LinePlot",r.dotVisible=!0):r.type==="area"?r.geometry="AreaChart":r.type==="bar"&&(r.geometry="BarChart"),delete r.mode,delete r.type),r}),!t&&n.layout&&n.layout.barmode==="stack"&&(o=i.util.duplicates(e.data.map(function(n){return n.geometry})),e.data.forEach(function(n,t){var i=o.indexOf(n.geometry);i!=-1&&(e.data[t].groupId=i)}))),n.layout){if(f=u({},n.layout),s=[[f,["plot_bgcolor"],["backgroundColor"]],[f,["showlegend"],["showLegend"]],[f,["radialaxis"],["radialAxis"]],[f,["angularaxis"],["angularAxis"]],[f.angularaxis,["showline"],["gridLinesVisible"]],[f.angularaxis,["showticklabels"],["labelsVisible"]],[f.angularaxis,["nticks"],["ticksCount"]],[f.angularaxis,["tickorientation"],["tickOrientation"]],[f.angularaxis,["ticksuffix"],["ticksSuffix"]],[f.angularaxis,["range"],["domain"]],[f.angularaxis,["endpadding"],["endPadding"]],[f.radialaxis,["showline"],["gridLinesVisible"]],[f.radialaxis,["tickorientation"],["tickOrientation"]],[f.radialaxis,["ticksuffix"],["ticksSuffix"]],[f.radialaxis,["range"],["domain"]],[f.angularAxis,["showline"],["gridLinesVisible"]],[f.angularAxis,["showticklabels"],["labelsVisible"]],[f.angularAxis,["nticks"],["ticksCount"]],[f.angularAxis,["tickorientation"],["tickOrientation"]],[f.angularAxis,["ticksuffix"],["ticksSuffix"]],[f.angularAxis,["range"],["domain"]],[f.angularAxis,["endpadding"],["endPadding"]],[f.radialAxis,["showline"],["gridLinesVisible"]],[f.radialAxis,["tickorientation"],["tickOrientation"]],[f.radialAxis,["ticksuffix"],["ticksSuffix"]],[f.radialAxis,["range"],["domain"]],[f.font,["outlinecolor"],["outlineColor"]],[f.legend,["traceorder"],["reverseOrder"]],[f,["labeloffset"],["labelOffset"]],[f,["defaultcolorrange"],["defaultColorRange"]]],s.forEach(function(n){i.util.translator.apply(null,n.concat(t))}),t?(typeof f.tickLength!="undefined"&&(f.angularaxis.ticklen=f.tickLength,delete f.tickLength),f.tickColor&&(f.angularaxis.tickcolor=f.tickColor,delete f.tickColor)):(f.angularAxis&&typeof f.angularAxis.ticklen!="undefined"&&(f.tickLength=f.angularAxis.ticklen),f.angularAxis&&typeof f.angularAxis.tickcolor!="undefined"&&(f.tickColor=f.angularAxis.tickcolor)),f.legend&&typeof f.legend.reverseOrder!="boolean"&&(f.legend.reverseOrder=f.legend.reverseOrder!="normal"),f.legend&&typeof f.legend.traceorder=="boolean"&&(f.legend.traceorder=f.legend.traceorder?"reversed":"normal",delete f.legend.reverseOrder),f.margin&&typeof f.margin.t!="undefined"){var c=["t","r","b","l","pad"],l=["top","right","bottom","left","pad"],h={};r.entries(f.margin).forEach(function(n){h[l[c.indexOf(n.key)]]=n.value});f.margin=h}t&&(delete f.needsEndSpacing,delete f.minorTickColor,delete f.minorTicks,delete f.angularaxis.ticksCount,delete f.angularaxis.ticksCount,delete f.angularaxis.ticksStep,delete f.angularaxis.rewriteTicks,delete f.angularaxis.nticks,delete f.radialaxis.ticksCount,delete f.radialaxis.ticksCount,delete f.radialaxis.ticksStep,delete f.radialaxis.rewriteTicks,delete f.radialaxis.nticks);e.layout=f}return e},n}},{"../../lib":681,d3:129}],774:[function(n,t){"use strict";var r=n("d3"),e=n("../../lib"),o=n("../../components/color"),i=n("./micropolar"),s=n("./undo_manager"),f=e.extendDeepAll,u=t.exports={};u.framework=function(n){function e(e,s){return s&&(h=s),r.select(r.select(h).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),t=t?f(t,e):e,o||(o=i.Axis()),a=i.adapter.plotly().convert(t),o.config(a).render(h),n.data=t.data,n.layout=t.layout,u.fillLayout(n),t}var t,l,o,a,h,c=new s;return e.isPolar=!0,e.svg=function(){return o.svg()},e.getConfig=function(){return t},e.getLiveConfig=function(){return i.adapter.plotly().convert(o.getLiveConfig(),!0)},e.getLiveScales=function(){return{t:o.angularScale(),r:o.radialScale()}},e.setUndoPoint=function(){var n=this,r=i.util.cloneJson(t);(function(t,i){c.add({undo:function(){i&&n(i)},redo:function(){n(t)}})})(r,l);l=i.util.cloneJson(r)},e.undo=function(){c.undo()},e.redo=function(){c.redo()},e};u.fillLayout=function(n){var t=r.select(n).selectAll(".plot-container"),i=t.selectAll(".svg-container"),u=n.framework&&n.framework.svg&&n.framework.svg(),e={width:800,height:600,paper_bgcolor:o.background,_container:t,_paperdiv:i,_paper:u};n._fullLayout=f(e,n.layout)}},{"../../components/color":582,"../../lib":681,"./micropolar":773,"./undo_manager":775,d3:129}],775:[function(n,t){"use strict";t.exports=function(){function u(n,t){return n?(r=!0,n[t](),r=!1,this):this}var t=[],n=-1,r=!1,i;return{add:function(i){return r?this:(t.splice(n+1,t.length-n),t.push(i),n=t.length-1,this)},setCallback:function(n){i=n},undo:function(){var r=t[n];return r?(u(r,"undo"),n-=1,i&&i(r.undo),this):this},redo:function(){var r=t[n+1];return r?(u(r,"redo"),n+=1,i&&i(r.redo),this):this},clear:function(){t=[];n=-1},hasUndo:function(){return n!==-1},hasRedo:function(){return n<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[n-1]},getIndex:function(){return n}}}},{}],776:[function(n,t){"use strict";var i=n("../lib"),r=n("./plots");t.exports=function(n,t,u,f){function l(n,t){return i.coerce(h,c,p,n,t)}for(var e,y=f.type,p=f.attributes,w=f.handleDefaults,a=f.partition||"x",v=r.findSubplotIds(u,y),s=v.length,h,c,o=0;o<s;o++)e=v[o],h=n[e]?n[e]:n[e]={},t[e]=c={},l("domain."+a,[o/s,(o+1)/s]),l("domain."+{x:"y",y:"x"}[a]),f.id=e,w(h,c,l,f)}},{"../lib":681,"./plots":769}],777:[function(n,t,i){"use strict";var u=n("./ternary"),r=n("../../plots/plots");i.name="ternary";i.attr="subplot";i.idRoot="ternary";i.idRegex=/^ternary([2-9]|[1-9][0-9]+)?$/;i.attrRegex=/^ternary([2-9]|[1-9][0-9]+)?$/;i.attributes=n("./layout/attributes");i.layoutAttributes=n("./layout/layout_attributes");i.supplyLayoutDefaults=n("./layout/defaults");i.plot=function(n){for(var t=n._fullLayout,s=n._fullData,o=r.getSubplotIds(t,"ternary"),e=0;e<o.length;e++){var i=o[e],h=r.getSubplotData(s,"ternary",i),f=t[i]._subplot;f===undefined&&(f=new u({id:i,graphDiv:n,container:t._ternarylayer.node()},t),t[i]._subplot=f);f.plot(h,t,n._promises)}};i.clean=function(n,t,i,u){for(var o,f,s=r.getSubplotIds(u,"ternary"),e=0;e<s.length;e++)o=s[e],f=u[o]._subplot,t[o]||!f||(f.plotContainer.remove(),f.clipDef.remove())}},{"../../plots/plots":769,"./layout/attributes":778,"./layout/defaults":781,"./layout/layout_attributes":782,"./ternary":783}],778:[function(n,t){"use strict";t.exports={subplot:{valType:"subplotid",dflt:"ternary"}}},{}],779:[function(n,t){"use strict";var i=n("../../cartesian/layout_attributes"),r=n("../../../lib/extend").extendFlat;t.exports={title:i.title,titlefont:i.titlefont,color:i.color,tickmode:i.tickmode,nticks:r({},i.nticks,{dflt:6,min:1}),tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:i.ticks,ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,showtickprefix:i.showtickprefix,tickprefix:i.tickprefix,showticksuffix:i.showticksuffix,ticksuffix:i.ticksuffix,showexponent:i.showexponent,exponentformat:i.exponentformat,separatethousands:i.separatethousands,tickfont:i.tickfont,tickangle:i.tickangle,tickformat:i.tickformat,hoverformat:i.hoverformat,showline:r({},i.showline,{dflt:!0}),linecolor:i.linecolor,linewidth:i.linewidth,showgrid:r({},i.showgrid,{dflt:!0}),gridcolor:i.gridcolor,gridwidth:i.gridwidth,min:{valType:"number",dflt:0,min:0}}},{"../../../lib/extend":673,"../../cartesian/layout_attributes":719}],780:[function(n,t){"use strict";var r=n("tinycolor2").mix,i=n("../../../lib"),u=n("./axis_attributes"),f=n("../../cartesian/tick_label_defaults"),e=n("../../cartesian/tick_mark_defaults"),o=n("../../cartesian/tick_value_defaults");t.exports=function(n,t,s){function h(r,f){return i.coerce(n,t,u,r,f)}var p,w,b;t.type="linear";var c=h("color"),l=c===n.color?c:s.font.color,k=t._name,a=k.charAt(0).toUpperCase(),v="Component "+a,y=h("title",v);t._hovertitle=y===v?y:a;i.coerceFont(h,"titlefont",{family:s.font.family,size:Math.round(s.font.size*1.2),color:l});h("min");o(n,t,h,"linear");f(n,t,h,"linear",{noHover:!1});e(n,t,h,{outerTicks:!0});p=h("showticklabels");p&&(i.coerceFont(h,"tickfont",{family:s.font.family,size:s.font.size,color:l}),h("tickangle"),h("tickformat"));h("hoverformat");w=h("showline");w&&(h("linecolor",c),h("linewidth"));b=h("showgrid");b&&(h("gridcolor",r(c,s.bgColor,60).toRgbString()),h("gridwidth"))}},{"../../../lib":681,"../../cartesian/tick_label_defaults":725,"../../cartesian/tick_mark_defaults":726,"../../cartesian/tick_value_defaults":727,"./axis_attributes":779,tinycolor2:546}],781:[function(n,t){"use strict";function o(n,t,u,f){var y=u("bgcolor"),p=u("sum"),o,h,c,s;for(f.bgColor=r.combine(y,f.paper_bgcolor),s=0;s<i.length;s++)o=i[s],h=n[o]||{},c=t[o]={_name:o},e(h,c,f);var l=t.aaxis,a=t.baxis,v=t.caxis;l.min+a.min+v.min>=p&&(l.min=0,a.min=0,v.min=0,n.aaxis&&delete n.aaxis.min,n.baxis&&delete n.baxis.min,n.caxis&&delete n.caxis.min)}var r=n("../../../components/color"),u=n("../../subplot_defaults"),f=n("./layout_attributes"),e=n("./axis_defaults"),i=["aaxis","baxis","caxis"];t.exports=function(n,t,i){u(n,t,i,{type:"ternary",attributes:f,handleDefaults:o,font:t.font,paper_bgcolor:t.paper_bgcolor})}},{"../../../components/color":582,"../../subplot_defaults":776,"./axis_defaults":780,"./layout_attributes":782}],782:[function(n,t){"use strict";var r=n("../../../components/color/attributes"),i=n("./axis_attributes");t.exports={domain:{x:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},y:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]}},bgcolor:{valType:"color",dflt:r.background},sum:{valType:"number",dflt:1,min:0},aaxis:i,baxis:i,caxis:i}},{"../../../components/color/attributes":581,"./axis_attributes":779}],783:[function(n,t){"use strict";function w(n,t){this.id=n.id;this.graphDiv=n.graphDiv;this.init(t);this.makeFramework()}function k(n){o.select(n).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var o=n("d3"),d=n("tinycolor2"),s=n("../../plotly"),a=n("../../lib"),f=n("../../components/color"),g=n("../../components/drawing"),e=n("../cartesian/set_convert"),h=n("../../lib/extend").extendFlat,c=n("../cartesian/axes"),nt=n("../../lib/filter_visible"),v=n("../../components/dragelement"),l=n("../../components/titles"),tt=n("../cartesian/select"),y=n("../cartesian/constants"),p=n("../cartesian/graph_interact"),r,u;t.exports=w;r=w.prototype;r.init=function(n){this.container=n._ternarylayer;this.defs=n._defs;this.layoutId=n._uid;this.traceHash={}};r.plot=function(n,t){var r=this,h=t[r.id],w=t._size,i,c,u,e,l,o,s,v,y,p;for(a.getPlotDiv(r.plotContainer.node())!==r.graphDiv&&(r.init(r.graphDiv._fullLayout),r.makeFramework()),r.adjustLayout(h,w),c=r.traceHash,u={},i=0;i<n.length;i++)e=n[i],u[e.type]=u[e.type]||[],u[e.type].push(e);for(l=Object.keys(c),o=Object.keys(u),i=0;i<l.length;i++)s=l[i],o.indexOf(s)===-1&&(v=c[s][0],v.visible=!1,u[s]=[v]);for(o=Object.keys(u),i=0;i<o.length;i++)y=u[o[i]],p=y[0]._module,p.plot(r,nt(y),h);r.traceHash=u;r.layers.plotbg.select("path").call(f.fill,h.bgcolor)};r.makeFramework=function(){var n=this,i=n.defs.selectAll("g.clips").data([0]),t,r,u,f;i.enter().append("g").classed("clips",!0);t="clip"+n.layoutId+n.id;n.clipDef=i.selectAll("#"+t).data([0]);n.clipDef.enter().append("clipPath").attr("id",t).append("path").attr("d","M0,0Z");n.plotContainer=n.container.selectAll("g."+n.id).data([0]);n.plotContainer.enter().append("g").classed(n.id,!0);n.layers={};r=["draglayer","plotbg","backplot","grids","frontplot","zoom","aaxis","baxis","caxis","axlines"];u=n.plotContainer.selectAll("g.toplevel").data(r);u.enter().append("g").attr("class",function(n){return"toplevel "+n}).each(function(t){var i=o.select(this);n.layers[t]=i;t==="frontplot"?i.append("g").classed("scatterlayer",!0):t==="backplot"?i.append("g").classed("maplayer",!0):t==="plotbg"?i.append("path").attr("d","M0,0Z"):t==="axlines"&&i.selectAll("path").data(["aline","bline","cline"]).enter().append("path").each(function(n){o.select(this).classed(n,!0)})});f=n.plotContainer.select(".grids").selectAll("g.grid").data(["agrid","bgrid","cgrid"]);f.enter().append("g").attr("class",function(n){return"grid "+n}).each(function(t){n.layers[t]=o.select(this)});n.plotContainer.selectAll(".backplot,.frontplot,.grids").call(g.setClipUrl,t);n.graphDiv._context.staticPlot||n.initInteractions()};u=Math.sqrt(4/3);r.adjustLayout=function(n,t){var i=this,l=n.domain,tt=(l.x[0]+l.x[1])/2,it=(l.y[0]+l.y[1])/2,ct=l.x[1]-l.x[0],lt=l.y[1]-l.y[0],rt=ct*t.w,ut=lt*t.h,a=n.sum,v=n.aaxis.min,w=n.baxis.min,b=n.caxis.min,s,c,r,o,ft,k,d,y,p,g,et,at,ot,st,ht,nt;rt>u*ut?(o=ut,r=o*u):(r=rt,o=r/u);ft=ct*r/rt;k=lt*o/ut;s=t.l+t.w*tt-r/2;c=t.t+t.h*(1-it)-o/2;i.x0=s;i.y0=c;i.w=r;i.h=o;i.sum=a;i.xaxis={type:"linear",range:[v+2*b-a,a-v-2*w],domain:[tt-ft/2,tt+ft/2],_id:"x",_gd:i.graphDiv};e(i.xaxis);i.xaxis.setScale();i.yaxis={type:"linear",range:[v,a-w-b],domain:[it-k/2,it+k/2],_id:"y",_gd:i.graphDiv};e(i.yaxis);i.yaxis.setScale();d=i.yaxis.domain[0];y=i.aaxis=h({},n.aaxis,{range:[v,a-w-b],side:"left",_counterangle:30,tickangle:(+n.aaxis.tickangle||0)-30,domain:[d,d+k*u],_axislayer:i.layers.aaxis,_gridlayer:i.layers.agrid,_pos:0,_gd:i.graphDiv,_id:"y",_length:r,_gridpath:"M0,0l"+o+",-"+r/2});e(y);p=i.baxis=h({},n.baxis,{range:[a-v-b,w],side:"bottom",_counterangle:30,domain:i.xaxis.domain,_axislayer:i.layers.baxis,_gridlayer:i.layers.bgrid,_counteraxis:i.aaxis,_pos:0,_gd:i.graphDiv,_id:"x",_length:r,_gridpath:"M0,0l-"+r/2+",-"+o});e(p);y._counteraxis=p;g=i.caxis=h({},n.caxis,{range:[a-v-w,b],side:"right",_counterangle:30,tickangle:(+n.caxis.tickangle||0)+30,domain:[d,d+k*u],_axislayer:i.layers.caxis,_gridlayer:i.layers.cgrid,_counteraxis:i.baxis,_pos:0,_gd:i.graphDiv,_id:"y",_length:r,_gridpath:"M0,0l-"+o+","+r/2});e(g);et="M"+s+","+(c+o)+"h"+r+"l-"+r/2+",-"+o+"Z";i.clipDef.select("path").attr("d",et);i.layers.plotbg.select("path").attr("d",et);at="translate("+s+","+c+")";i.plotContainer.selectAll(".scatterlayer,.maplayer,.zoom").attr("transform",at);ot="translate("+s+","+(c+o)+")";i.layers.baxis.attr("transform",ot);i.layers.bgrid.attr("transform",ot);st="translate("+(s+r/2)+","+c+")rotate(30)";i.layers.aaxis.attr("transform",st);i.layers.agrid.attr("transform",st);ht="translate("+(s+r/2)+","+c+")rotate(-30)";i.layers.caxis.attr("transform",ht);i.layers.cgrid.attr("transform",ht);i.drawAxes(!0);i.plotContainer.selectAll(".crisp").classed("crisp",!1);nt=i.layers.axlines;nt.select(".aline").attr("d",y.showline?"M"+s+","+(c+o)+"l"+r/2+",-"+o:"M0,0").call(f.stroke,y.linecolor||"#000").style("stroke-width",(y.linewidth||0)+"px");nt.select(".bline").attr("d",p.showline?"M"+s+","+(c+o)+"h"+r:"M0,0").call(f.stroke,p.linecolor||"#000").style("stroke-width",(p.linewidth||0)+"px");nt.select(".cline").attr("d",g.showline?"M"+(s+r/2)+","+c+"l"+r/2+","+o:"M0,0").call(f.stroke,g.linecolor||"#000").style("stroke-width",(g.linewidth||0)+"px")};r.drawAxes=function(n){var t=this,u=t.graphDiv,o=t.id.substr(7)+"title",f=t.aaxis,i=t.baxis,r=t.caxis,s,e;c.doTicks(u,f,!0);c.doTicks(u,i,!0);c.doTicks(u,r,!0);n&&(s=Math.max(f.showticklabels?f.tickfont.size/2:0,(r.showticklabels?r.tickfont.size*.75:0)+(r.ticks==="outside"?r.ticklen*.87:0)),l.draw(u,"a"+o,{propContainer:f,propName:t.id+".aaxis.title",dfltName:"Component A",attributes:{x:t.x0+t.w/2,y:t.y0-f.titlefont.size/3-s,"text-anchor":"middle"}}),e=(i.showticklabels?i.tickfont.size:0)+(i.ticks==="outside"?i.ticklen:0)+3,l.draw(u,"b"+o,{propContainer:i,propName:t.id+".baxis.title",dfltName:"Component B",attributes:{x:t.x0-e,y:t.y0+t.h+i.titlefont.size*.83+e,"text-anchor":"middle"}}),l.draw(u,"c"+o,{propContainer:r,propName:t.id+".caxis.title",dfltName:"Component C",attributes:{x:t.x0+t.w+e,y:t.y0+t.h+r.titlefont.size*.83+e,"text-anchor":"middle"}}))};var i=y.MINZOOM/2+.87,it="m-0.87,.5h"+i+"v3h-"+(i+5.2)+"l"+(i/2+2.6)+",-"+(i*.87+4.5)+"l2.6,1.5l-"+i/2+","+i*.87+"Z",rt="m0.87,.5h-"+i+"v3h"+(i+5.2)+"l-"+(i/2+2.6)+",-"+(i*.87+4.5)+"l-2.6,1.5l"+i/2+","+i*.87+"Z",ut="m0,1l"+i/2+","+i*.87+"l2.6,-1.5l-"+(i/2+2.6)+",-"+(i*.87+4.5)+"l-"+(i/2+2.6)+","+(i*.87+4.5)+"l2.6,1.5l"+i/2+",-"+i*.87+"Z",ft="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",b=!0;r.initInteractions=function(){function yt(i,u,e){var s=o.getBoundingClientRect();h=u-s.left;c=e-s.top;r={a:n.aaxis.range[0],b:n.baxis.range[1],c:n.caxis.range[1]};t=r;l=n.aaxis.range[1]-r.a;ot=d(n.graphDiv._fullLayout[n.id].bgcolor).getLuminance();w="M0,"+n.h+"L"+n.w/2+", 0L"+n.w+","+n.h+"Z";st=!1;g=et.append("path").attr("class","zoombox").style({fill:ot>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",w);nt=et.append("path").attr("class","zoombox-corners").style({fill:f.background,stroke:f.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z");vt()}function ct(t,i){return 1-i/n.h}function lt(t,i){return 1-(t+(n.h-i)/Math.sqrt(3))/n.w}function at(t,i){return(t-(n.h-i)/Math.sqrt(3))/n.w}function pt(i,f){var v=h+i,p=c+f,s=Math.max(0,Math.min(1,ct(h,c),ct(v,p))),b=Math.max(0,Math.min(1,lt(h,c),lt(v,p))),k=Math.max(0,Math.min(1,at(h,c),at(v,p))),e=(s/2+k)*n.w,a=(1-s/2-b)*n.w,d=(e+a)/2,tt=a-e,o=(1-s)*n.h,et=o-tt/u;tt<y.MINZOOM?(t=r,g.attr("d",w),nt.attr("d","M0,0Z")):(t={a:r.a+s*l,b:r.b+b*l,c:r.c+k*l},g.attr("d",w+"M"+e+","+o+"H"+a+"L"+d+","+et+"L"+e+","+o+"Z"),nt.attr("d","M"+h+","+c+ft+"M"+e+","+o+it+"M"+a+","+o+rt+"M"+d+","+et+ut));st||(g.transition().style("fill",ot>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),nt.transition().style("opacity",1).duration(200),st=!0)}function wt(u,f){if(t===r)return f===2&&ht(),k(i);k(i);var e={};e[n.id+".aaxis.min"]=t.a;e[n.id+".baxis.min"]=t.b;e[n.id+".caxis.min"]=t.c;s.relayout(i,e);b&&i.data&&i._context.showTips&&(a.notifier("Double-click to<br>zoom back out","long"),b=!1)}function bt(){r={a:n.aaxis.range[0],b:n.baxis.range[1],c:n.caxis.range[1]};t=r}function kt(i,u){var s=i/n.xaxis._m,o=u/n.yaxis._m,f,e,h;t={a:r.a-o,b:r.b+(s+o)/2,c:r.c-(s-o)/2};f=[t.a,t.b,t.c].sort();e={a:f.indexOf(t.a),b:f.indexOf(t.b),c:f.indexOf(t.c)};f[0]<0&&(f[1]+f[0]/2<0?(f[2]+=f[0]+f[1],f[0]=f[1]=0):(f[2]+=f[0]/2,f[1]+=f[0]/2,f[0]=0),t={a:f[e.a],b:f[e.b],c:f[e.c]},u=(r.a-t.a)*n.yaxis._m,i=(r.c-t.c-r.b+t.b)*n.xaxis._m);h="translate("+(n.x0+i)+","+(n.y0+u)+")";n.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",h);n.aaxis.range=[t.a,n.sum-t.b-t.c];n.baxis.range=[n.sum-t.a-t.c,t.b];n.caxis.range=[n.sum-t.a-t.b,t.c];n.drawAxes(!1);n.plotContainer.selectAll(".crisp").classed("crisp",!1)}function dt(r,u){if(r){var f={};f[n.id+".aaxis.min"]=t.a;f[n.id+".baxis.min"]=t.b;f[n.id+".caxis.min"]=t.c;s.relayout(i,f)}else u===2&&ht()}function vt(){n.plotContainer.selectAll(".select-outline").remove()}function ht(){var t={};t[n.id+".aaxis.min"]=0;t[n.id+".baxis.min"]=0;t[n.id+".caxis.min"]=0;i.emit("plotly_doubleclick",null);s.relayout(i,t)}var n=this,o=n.layers.plotbg.select("path").node(),i=n.graphDiv,et=n.layers.zoom,e={element:o,gd:i,plotinfo:{plot:et},doubleclick:ht,subplot:n.id,prepFn:function(t,r,u){e.xaxes=[n.xaxis];e.yaxes=[n.yaxis];var f=i._fullLayout.dragmode;t.shiftKey&&(f=f==="pan"?"zoom":"pan");e.minDrag=f==="lasso"?1:undefined;f==="zoom"?(e.moveFn=pt,e.doneFn=wt,yt(t,r,u)):f==="pan"?(e.moveFn=kt,e.doneFn=dt,bt(),vt()):(f==="select"||f==="lasso")&&tt(t,r,u,e,f)}},h,c,r,l,t,ot,w,st,g,nt;o.onmousemove=function(t){p.hover(i,t,n.id);i._fullLayout._lasthover=o;i._fullLayout._hoversubplot=n.id};o.onmouseout=function(n){i._dragging||v.unhover(i,n)};o.onclick=function(n){p.click(i,n)};v.init(e)}},{"../../components/color":582,"../../components/dragelement":603,"../../components/drawing":605,"../../components/titles":656,"../../lib":681,"../../lib/extend":673,"../../lib/filter_visible":675,"../../plotly":706,"../cartesian/axes":710,"../cartesian/constants":715,"../cartesian/graph_interact":717,"../cartesian/select":723,"../cartesian/set_convert":724,d3:129,tinycolor2:546}],784:[function(n,t,i){"use strict";function u(n){return typeof n=="object"&&(n=n.type),n}var r=n("./lib"),f=n("./plots/attributes");i.modules={};i.allTypes=[];i.allCategories={};i.subplotsRegistry={};i.transformsRegistry={};i.componentsRegistry={};i.register=function(n,t,u,f){var o,e;if(i.modules[t]){r.log("Type "+t+" already registered");return}for(o={},e=0;e<u.length;e++)o[u[e]]=!0,i.allCategories[u[e]]=!0;i.modules[t]={_module:n,categories:o};f&&Object.keys(f).length&&(i.modules[t].meta=f);i.allTypes.push(t)};i.registerSubplot=function(n){var t=n.name;if(i.subplotsRegistry[t]){r.log("Plot type "+t+" already registered.");return}i.subplotsRegistry[t]=n};i.getModule=function(n){if(n.r!==undefined)return r.warn("Tried to put a polar trace on an incompatible graph of cartesian data. Ignoring this dataset.",n),!1;var t=i.modules[u(n)];return t?t._module:!1};i.traceIs=function(n,t){if(n=u(n),n==="various")return!1;var e=i.modules[n];return e||(n&&n!=="area"&&r.log("Unrecognized trace type "+n+"."),e=i.modules[f.type.dflt]),!!e.categories[t]};i.getComponentMethod=function(n,t){var u=i.componentsRegistry[n];return u?u[t]:r.noop}},{"./lib":681,"./plots/attributes":708}],785:[function(n,t){"use strict";function f(n){var t;switch(n){case"themes__thumb":t={autosize:!0,width:150,height:150,title:"",showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:"",hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}function o(n){return["xaxis","yaxis","zaxis"].indexOf(n.slice(0,5))>-1}var r=n("../lib"),e=n("../plots/plots"),i=r.extendFlat,u=r.extendDeep;t.exports=function(n,t){var a,h,v,c,l,w,y;n.framework&&n.framework.isPolar&&(n=n.framework.getConfig());var r,b=n.data,k=n.layout,p=u([],b),s=u({},k,f(t.tileClass));if(t.width&&(s.width=t.width),t.height&&(s.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){for(s.annotations=[],a=Object.keys(s),r=0;r<a.length;r++)o(a[r])&&(s[a[r]].title="");for(r=0;r<p.length;r++)h=p[r],h.showscale=!1,h.marker&&(h.marker.showscale=!1),h.type==="pie"&&(h.textposition="none")}if(Array.isArray(t.annotations))for(r=0;r<t.annotations.length;r++)s.annotations.push(t.annotations[r]);if(v=e.getSubplotIds(s,"gl3d"),v.length)for(c={},t.tileClass==="thumbnail"&&(c={title:"",showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),r=0;r<v.length;r++)l=v[r],i(s[l].xaxis,c),i(s[l].yaxis,c),i(s[l].zaxis,c),s[l]._scene=null;return w=document.createElement("div"),t.tileClass&&(w.className=t.tileClass),y={td:w,layout:s,data:p,config:{staticPlot:t.staticPlot===undefined?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===undefined?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1}},t.setBackground!=="transparent"&&(y.config.setBackground=t.setBackground||"opaque"),y.td.defaultLayout=f(t.tileClass),y}},{"../lib":681,"../plots/plots":769}],786:[function(n,t){"use strict";function f(n,t){return t=t||{},t.format=t.format||"png",new Promise(function(f,e){n._snapshotInProgress&&e(new Error("Snapshotting already in progress."));r.isIE()&&t.format!=="svg"&&e(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."));n._snapshotInProgress=!0;var s=i(n,t),o=t.filename||n.fn||"newplot";o+="."+t.format;s.then(function(t){return n._snapshotInProgress=!1,u(t,o)}).then(function(n){f(n)}).catch(function(t){n._snapshotInProgress=!1;e(t)})})}var i=n("../plot_api/to_image"),r=n("../lib"),u=n("./filesaver");t.exports=f},{"../lib":681,"../plot_api/to_image":704,"./filesaver":787}],787:[function(n,t){"use strict";var i=function(n,t){var i=document.createElement("a"),r="download"in i,u=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);return new Promise(function(f,e){typeof navigator!="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)&&e(new Error("IE < 10 unsupported"));u&&(document.location.href="data:application/octet-stream"+n.slice(n.search(/[,;]/)),f(t));t||(t="download");r&&(i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),f(t));typeof navigator!="undefined"&&navigator.msSaveBlob&&(navigator.msSaveBlob(new Blob([n]),t),f(t));e(new Error("download error"))})};t.exports=i},{}],788:[function(n,t,i){"use strict";i.getDelay=function(n){return n._has?n._has("gl3d")||n._has("gl2d")?500:0:0};i.getRedrawFunc=function(n){if(!n.data||!n.data[0]||!n.data[0].r)return function(){(n.calcdata||[]).forEach(function(n){n[0]&&n[0].t&&n[0].t.cb&&n[0].t.cb()})}}},{}],789:[function(n,t){"use strict";var i=n("./helpers"),r={getDelay:i.getDelay,getRedrawFunc:i.getRedrawFunc,clone:n("./cloneplot"),toSVG:n("./tosvg"),svgToImg:n("./svgtoimg"),toImage:n("./toimage"),downloadImage:n("./download")};t.exports=r},{"./cloneplot":785,"./download":786,"./helpers":788,"./svgtoimg":790,"./toimage":791,"./tosvg":792}],790:[function(n,t){"use strict";function u(n){var t=n.emitter||new r,u=new Promise(function(r,f){var a=window.Image,e=n.svg,h=n.format||"png",c;if(i.isIE()&&(e=e.replace(/"/gi,"'"),e=e.replace(/(\('#)(.*)('\))/gi,'("$2")'),e=e.replace(/(\\')/gi,'"'),h!=="svg"))return c=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."),f(c),n.promise?u:t.emit("error",c);var o=n.canvas,v=o.getContext("2d"),s=new a,l="data:image/svg+xml,"+encodeURIComponent(e);o.height=n.height||150;o.width=n.width||300;s.onload=function(){var i;h!=="svg"&&v.drawImage(s,0,0);switch(h){case"jpeg":i=o.toDataURL("image/jpeg");break;case"png":i=o.toDataURL("image/png");break;case"webp":i=o.toDataURL("image/webp");break;case"svg":i=l;break;default:if(f(new Error("Image format is not jpeg, png or svg")),!n.promise)return t.emit("error","Image format is not jpeg, png or svg")}r(i);n.promise||t.emit("success",i)};s.onerror=function(i){return f(i),n.promise?void 0:t.emit("error",i)};s.src=l});return n.promise?u:t}var i=n("../lib"),r=n("events").EventEmitter;t.exports=u},{"../lib":681,events:61}],791:[function(n,t){"use strict";function h(n,t){function v(){var n=i.getDelay(h._fullLayout);setTimeout(function(){var i=o(h),n=document.createElement("canvas");n.id=f.randstr();c=s({format:t.format,width:h._fullLayout.width,height:h._fullLayout.height,canvas:n,emitter:c,svg:i});c.clean=function(){h&&document.body.removeChild(h)}},n)}var c=new r,l=e(n,{format:"png"}),h=l.td,a;return h.style.position="absolute",h.style.left="-5000px",document.body.appendChild(h),a=i.getRedrawFunc(h),u.plot(h,l.data,l.layout,l.config).then(a).then(v).catch(function(n){c.emit("error",n)}),c}var r=n("events").EventEmitter,u=n("../plotly"),f=n("../lib"),i=n("./helpers"),e=n("./cloneplot"),o=n("./tosvg"),s=n("./svgtoimg");t.exports=h},{"../lib":681,"../plotly":706,"./cloneplot":785,"./helpers":788,"./svgtoimg":790,"./tosvg":792,events:61}],792:[function(n,t){"use strict";var u=n("d3"),r=n("../lib/svg_text_utils"),f=n("../components/drawing"),e=n("../components/color"),i=n("../constants/xmlns_namespaces");t.exports=function(n,t){var o=n._fullLayout,s=o._paper,p=o._toppaper,h,l,a,w,v,y,c;for(s.insert("rect",":first-child").call(f.setRect,0,0,o.width,o.height).call(e.fill,o.paper_bgcolor),l=o._basePlotModules||[],h=0;h<l.length;h++)a=l[h],a.toSVG&&a.toSVG(n);if(p)for(w=p.node().childNodes,v=Array.prototype.slice.call(w),h=0;h<v.length;h++)y=v[h],y.childNodes.length&&s.node().appendChild(y);return o._draggers&&o._draggers.remove(),s.node().style.background="",s.selectAll("text").attr("data-unformatted",null).each(function(){var n=u.select(this),t;if(n.style("visibility")==="hidden"){n.remove();return}n.style("visibility","visible");t=n.style("font-family");t&&t.indexOf('"')!==-1&&n.style("font-family",t.replace(/"/g,"TOBESTRIPPED"))}),(t==="pdf"||t==="eps")&&s.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),s.node().setAttributeNS(i.xmlns,"xmlns",i.svg),s.node().setAttributeNS(i.xmlns,"xmlns:xlink",i.xlink),c=(new window.XMLSerializer).serializeToString(s.node()),c=r.html_entity_decode(c),c=r.xml_entity_encode(c),c.replace(/("TOBESTRIPPED)|(TOBESTRIPPED")/g,"'")}},{"../components/color":582,"../components/drawing":605,"../constants/xmlns_namespaces":666,"../lib/svg_text_utils":695,d3:129}],793:[function(n,t){"use strict";var i=n("../../lib").mergeArray;t.exports=function(n){var u=n[0].trace,t=u.marker,r;i(u.text,n,"tx");t&&t.line&&(r=t.line,i(t.opacity,n,"mo"),i(t.color,n,"mc"),i(r.color,n,"mlc"),i(r.width,n,"mlw"))}},{"../../lib":681}],794:[function(n,t){"use strict";var i=n("../scatter/attributes"),u=n("../../components/colorscale/color_attributes"),r=n("../../lib/extend").extendFlat,f=i.marker,e=f.line,o=r({},e.width,{dflt:0}),s=r({},{width:o},u("marker.line")),h=r({},{showscale:f.showscale,line:s},u("marker"));t.exports={x:i.x,x0:i.x0,dx:i.dx,y:i.y,y0:i.y0,dy:i.dy,text:i.text,orientation:{valType:"enumerated",values:["v","h"]},marker:h,r:i.r,t:i.t,_nestedModules:{error_y:"ErrorBars",error_x:"ErrorBars","marker.colorbar":"Colorbar"},_deprecated:{bardir:{valType:"enumerated",values:["v","h"]}}}},{"../../components/colorscale/color_attributes":590,"../../lib/extend":673,"../scatter/attributes":889}],795:[function(n,t){"use strict";var f=n("fast-isnumeric"),i=n("../../plots/cartesian/axes"),r=n("../../components/colorscale/has_colorscale"),u=n("../../components/colorscale/calc");t.exports=function(n,t){var c=i.getFromId(n,t.xaxis||"x"),l=i.getFromId(n,t.yaxis||"y"),v=t.orientation||(t.x&&!t.y?"h":"v"),o,s,e,a,h;for(v==="h"?(s=c.makeCalcdata(t,"x"),o=l.makeCalcdata(t,"y")):(s=l.makeCalcdata(t,"y"),o=c.makeCalcdata(t,"x")),a=Math.min(o.length,s.length),h=[],e=0;e<a;e++)f(o[e])&&h.push({p:o[e],s:s[e],b:0});return r(t,"marker")&&u(t,t.marker.color,"marker","c"),r(t,"marker.line")&&u(t,t.marker.line.color,"marker.line","c"),h}},{"../../components/colorscale/calc":589,"../../components/colorscale/has_colorscale":595,"../../plots/cartesian/axes":710,"fast-isnumeric":133}],796:[function(n,t){"use strict";var u=n("../../lib"),i=n("../../components/color"),f=n("../scatter/xy_defaults"),e=n("../bar/style_defaults"),r=n("../../components/errorbars/defaults"),o=n("./attributes");t.exports=function(n,t,s,h){function c(i,r){return u.coerce(n,t,o,i,r)}var l=f(n,t,c);if(!l){t.visible=!1;return}c("orientation",t.x&&!t.y?"h":"v");c("text");e(n,t,c,s,h);r(n,t,i.defaultLine,{axis:"y"});r(n,t,i.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":582,"../../components/errorbars/defaults":610,"../../lib":681,"../bar/style_defaults":804,"../scatter/xy_defaults":911,"./attributes":794}],797:[function(n,t){"use strict";var i=n("../../plots/cartesian/graph_interact"),u=n("../../components/errorbars"),r=n("../../components/color");t.exports=function(n,t,f,e){var l=n.cd,h=l[0].trace,w=l[0].t,a=n.xa,v=n.ya,s=e==="closest"?w.barwidth/2:w.dbar*(1-a._gd._fullLayout.bargap)/2,c,y,p,b;if(c=e!=="closest"?function(n){return n.p}:h.orientation==="h"?function(n){return n.y}:function(n){return n.x},h.orientation==="h"?(y=function(n){return i.inbox(n.b-t,n.x-t)+(n.x-t)/(n.x-n.b)},p=function(n){var t=c(n)-f;return i.inbox(t-s,t+s)}):(p=function(n){return i.inbox(n.b-f,n.y-f)+(n.y-f)/(n.y-n.b)},y=function(n){var r=c(n)-t;return i.inbox(r-s,r+s)}),b=i.getDistanceFunction(e,y,p),i.getClosest(l,b,n),n.index!==!1){var o=l[n.index],k=o.mcc||h.marker.color,d=o.mlcc||h.marker.line.color,g=o.mlw||h.marker.line.width;return r.opacity(k)?n.color=k:r.opacity(d)&&g&&(n.color=d),h.orientation==="h"?(n.x0=n.x1=a.c2p(o.x,!0),n.xLabelVal=o.s,n.y0=v.c2p(c(o)-s,!0),n.y1=v.c2p(c(o)+s,!0),n.yLabelVal=o.p):(n.y0=n.y1=v.c2p(o.y,!0),n.yLabelVal=o.s,n.x0=a.c2p(c(o)-s,!0),n.x1=a.c2p(c(o)+s,!0),n.xLabelVal=o.p),o.tx&&(n.text=o.tx),u.hoverInfo(o,h,n),[n]}}},{"../../components/color":582,"../../components/errorbars":611,"../../plots/cartesian/graph_interact":717}],798:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.layoutAttributes=n("./layout_attributes");i.supplyDefaults=n("./defaults");i.supplyLayoutDefaults=n("./layout_defaults");i.calc=n("./calc");i.setPositions=n("./set_positions");i.colorbar=n("../scatter/colorbar");i.arraysToCalcdata=n("./arrays_to_calcdata");i.plot=n("./plot");i.style=n("./style");i.hoverPoints=n("./hover");i.moduleType="trace";i.name="bar";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","bar","oriented","markerColorscale","errorBarsOK","showLegend"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"../scatter/colorbar":892,"./arrays_to_calcdata":793,"./attributes":794,"./calc":795,"./defaults":796,"./hover":797,"./layout_attributes":799,"./layout_defaults":800,"./plot":801,"./set_positions":802,"./style":803}],799:[function(n,t){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:""},bargap:{valType:"number",min:0,max:1},bargroupgap:{valType:"number",min:0,max:1,dflt:0}}},{}],800:[function(n,t){"use strict";var i=n("../../registry"),r=n("../../plots/cartesian/axes"),u=n("../../lib"),f=n("./layout_attributes");t.exports=function(n,t,e){function s(i,r){return u.coerce(n,t,f,i,r)}for(var o,c,p,w,l=!1,a=!1,v=!1,y={},h=0;h<e.length;h++){if(o=e[h],i.traceIs(o,"bar"))l=!0;else continue;n.barmode!=="overlay"&&n.barmode!=="stack"&&(c=o.xaxis+o.yaxis,y[c]&&(v=!0),y[c]=!0);o.visible&&o.type==="histogram"&&(p=r.getFromId({_fullLayout:t},o[o.orientation==="v"?"xaxis":"yaxis"]),p.type!=="category"&&(a=!0))}l&&(w=s("barmode"),w!=="overlay"&&s("barnorm"),s("bargap",a&&!v?0:.2),s("bargroupgap"))}},{"../../lib":681,"../../plots/cartesian/axes":710,"../../registry":784,"./layout_attributes":799}],801:[function(n,t){"use strict";var i=n("d3"),r=n("fast-isnumeric"),u=n("../../lib"),f=n("../../components/color"),e=n("../../components/errorbars"),o=n("./arrays_to_calcdata");t.exports=function(n,t,s){var h=t.xaxis,c=t.yaxis,l=n._fullLayout,a=t.plot.select(".barlayer").selectAll("g.trace.bars").data(s).enter().append("g").attr("class","trace bars");a.append("g").attr("class","points").each(function(t){var e=t[0].t,s=t[0].trace;o(t);i.select(this).selectAll("path").data(u.identity).enter().append("path").each(function(t){function b(n){return l.bargap===0&&l.bargroupgap===0?i.round(Math.round(n)-w,2):n}function d(n,t){return Math.abs(n-t)>=2?b(n):n>t?Math.ceil(n):Math.floor(n)}var o,a,u,v,p,w,k,y;if(s.orientation==="h"?(u=c.c2p(e.poffset+t.p,!0),v=c.c2p(e.poffset+t.p+e.barwidth,!0),o=h.c2p(t.b,!0),a=h.c2p(t.s+t.b,!0)):(o=h.c2p(e.poffset+t.p,!0),a=h.c2p(e.poffset+t.p+e.barwidth,!0),v=c.c2p(t.s+t.b,!0),u=c.c2p(t.b,!0)),!r(o)||!r(a)||!r(u)||!r(v)||o===a||u===v){i.select(this).remove();return}p=(t.mlw+1||s.marker.line.width+1||(t.trace?t.trace.marker.line.width:0)+1)-1;w=i.round(p/2%1,2);n._context.staticPlot||(k=f.opacity(t.mc||s.marker.color),y=k<1||p>.01?b:d,o=y(o,a),a=y(a,o),u=y(u,v),v=y(v,u));i.select(this).attr("d","M"+o+","+u+"V"+v+"H"+a+"V"+u+"Z")})});a.call(e.plot,t)}},{"../../components/color":582,"../../components/errorbars":611,"../../lib":681,"./arrays_to_calcdata":793,d3:129,"fast-isnumeric":133}],802:[function(n,t){"use strict";var r=n("fast-isnumeric"),u=n("../../registry"),i=n("../../plots/cartesian/axes"),f=n("../../lib");t.exports=function(n,t){var s=n._fullLayout,h=t.xaxis,c=t.yaxis,o,e;["v","h"].forEach(function(l){function ct(t){function p(n){n[st]=n.p+y}var c=[],y,o,e;t.forEach(function(t){n.calcdata[t].forEach(function(n){c.push(n.p)})});var h=f.distinctVals(c),l=h.vals,r=h.minDiff,u=!1,a=[];for(s.barmode==="group"&&t.forEach(function(t){u||(n.calcdata[t].forEach(function(n){u||a.forEach(function(t){Math.abs(n.p-t)<r&&(u=!0)})}),u)||n.calcdata[t].forEach(function(n){a.push(n.p)})}),i.minDtick(ht,r,l[0],u),i.expand(ht,l,{vpad:r/2}),r*=1-s.bargap,u&&(r/=v.length),o=0;o<t.length;o++)e=n.calcdata[t[o]][0].t,e.barwidth=r*(1-s.bargroupgap),e.poffset=((u?(2*o+1-t.length)*r:0)-e.barwidth)/2,e.dbar=h.minDiff,y=e.poffset+e.barwidth/2,n.calcdata[t[o]].forEach(p)}var v=[],st={v:"x",h:"y"}[l],g={v:"y",h:"x"}[l],ht=t[st+"axis"],b=t[g+"axis"],ft,vt;if(n._fullData.forEach(function(n,t){n.visible===!0&&u.traceIs(n,"bar")&&n.orientation===l&&n.xaxis===h._id&&n.yaxis===c._id&&v.push(t)}),v.length){s.barmode==="overlay"?v.forEach(function(n){ct([n])}):ct(v);var nt=s.barmode==="stack",d=s.barmode==="relative",tt=s.barnorm;if(nt||d||tt){var w=b.l2c(b.c2l(0)),k=w,ut={},lt=n.calcdata[v[0]][0].t.barwidth/100,p=0,it=!0,y,a,rt;for(o=0;o<v.length;o++)for(a=n.calcdata[v[o]],e=0;e<a.length;e++)r(a[e].s)&&(p=Math.round(a[e].p/lt),d&&a[e].s<0&&(p="-"+p),ft=ut[p]||0,(nt||d)&&(a[e].b=ft),y=a[e].b+a[e].s,ut[p]=ft+a[e].s,(nt||d)&&(a[e][g]=y,!tt&&r(b.c2l(y))&&(w=Math.max(w,y),k=Math.min(k,y))));if(tt){var et=tt==="fraction"?1:100,ot=!1,at=et/1e9;for(it=!1,k=0,w=nt?et:0,o=0;o<v.length;o++)for(a=n.calcdata[v[o]],e=0;e<a.length;e++)ot=d&&a[e].s<0,p=Math.round(a[e].p/lt),ot&&(p="-"+p),rt=et/ut[p],ot&&(rt*=-1),a[e].b*=rt,a[e].s*=rt,y=a[e].b+a[e].s,a[e][g]=y,r(b.c2l(y))&&(y<k-at&&(it=!0,k=y),y>w+at&&(it=!0,w=y))}i.expand(b,[k,w],{tozero:!0,padded:it})}else for(vt=function(n){return n[g]=n.s,n.s},o=0;o<v.length;o++)i.expand(b,n.calcdata[v[o]].map(vt),{tozero:!0,padded:!0})}})}},{"../../lib":681,"../../plots/cartesian/axes":710,"../../registry":784,"fast-isnumeric":133}],803:[function(n,t){"use strict";var i=n("d3"),r=n("../../components/color"),u=n("../../components/drawing"),f=n("../../components/errorbars");t.exports=function(n){var t=i.select(n).selectAll("g.trace.bars"),o=t.size(),e=n._fullLayout;t.style("opacity",function(n){return n[0].trace.opacity}).each(function(n){(e.barmode==="stack"&&o>1||e.bargap===0&&e.bargroupgap===0&&!n[0].trace.marker.line.width)&&i.select(this).attr("shape-rendering","crispEdges")});t.selectAll("g.points").each(function(n){var e=n[0].trace,t=e.marker,f=t.line,o=(e._input||{}).marker||{},s=u.tryColorscale(t,o,""),h=u.tryColorscale(t,o,"line.");i.select(this).selectAll("path").each(function(n){var u,e,o=(n.mlw+1||f.width+1)-1,c=i.select(this);u="mc"in n?n.mcc=s(n.mc):Array.isArray(t.color)?r.defaultLine:t.color;c.style("stroke-width",o+"px").call(r.fill,u);o&&(e="mlc"in n?n.mlcc=h(n.mlc):Array.isArray(f.color)?r.defaultLine:f.color,c.call(r.stroke,e))})});t.call(f.style)}},{"../../components/color":582,"../../components/drawing":605,"../../components/errorbars":611,d3:129}],804:[function(n,t){"use strict";var u=n("../../components/color"),i=n("../../components/colorscale/has_colorscale"),r=n("../../components/colorscale/defaults");t.exports=function(n,t,f,e,o){f("marker.color",e);i(n,"marker")&&r(n,t,o,f,{prefix:"marker.",cLetter:"c"});f("marker.line.color",u.defaultLine);i(n,"marker.line")&&r(n,t,o,f,{prefix:"marker.line.",cLetter:"c"});f("marker.line.width")}},{"../../components/color":582,"../../components/colorscale/defaults":592,"../../components/colorscale/has_colorscale":595}],805:[function(n,t){"use strict";var u=n("../scatter/attributes"),e=n("../../components/color/attributes"),i=n("../../lib/extend").extendFlat,r=u.marker,f=r.line;t.exports={y:{valType:"data_array"},x:{valType:"data_array"},x0:{valType:"any"},y0:{valType:"any"},whiskerwidth:{valType:"number",min:0,max:1,dflt:.5},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],dflt:!1},jitter:{valType:"number",min:0,max:1},pointpos:{valType:"number",min:-2,max:2},orientation:{valType:"enumerated",values:["v","h"]},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)"},symbol:i({},r.symbol,{arrayOk:!1}),opacity:i({},r.opacity,{arrayOk:!1,dflt:1}),size:i({},r.size,{arrayOk:!1}),color:i({},r.color,{arrayOk:!1}),line:{color:i({},f.color,{arrayOk:!1,dflt:e.defaultLine}),width:i({},f.width,{arrayOk:!1,dflt:0}),outliercolor:{valType:"color"},outlierwidth:{valType:"number",min:0,dflt:1}}},line:{color:{valType:"color"},width:{valType:"number",min:0,dflt:2}},fillcolor:u.fillcolor}},{"../../components/color/attributes":581,"../../lib/extend":673,"../scatter/attributes":889}],806:[function(n,t){"use strict";var u=n("fast-isnumeric"),i=n("../../lib"),r=n("../../plots/cartesian/axes");t.exports=function(n,t){function d(n,t,r,f,o){var s;return r in t?e=f.makeCalcdata(t,r):(s=r+"0"in t?t[r+"0"]:"name"in t&&(f.type==="category"||u(t.name)&&["linear","log"].indexOf(f.type)!==-1||i.isDateTime(t.name)&&f.type==="date")?t.name:n.numboxes,s=f.d2c(s),e=o.map(function(){return s})),e}function g(n,t,r,f,e){for(var v=f.length,y=t.length,h=[],c=[],l,s,a,o=0;o<v;++o)l=f[o],n[o]={pos:l},c[o]=l-e,h[o]=[];for(c.push(f[v-1]+e),o=0;o<y;++o)(a=t[o],u(a))&&(s=i.findBin(r[o],c),s>=0&&s<y&&h[s].push(a));return h}function nt(n,t){for(var u,f,r,e=0;e<t.length;++e)u=t[e].sort(i.sorterAsc),f=u.length,r=n[e],r.val=u,r.min=u[0],r.max=u[f-1],r.mean=i.mean(u,f),r.sd=i.stdev(u,f,r.mean),r.q1=i.interp(u,.25),r.med=i.interp(u,.5),r.q3=i.interp(u,.75),r.lf=Math.min(r.q1,u[Math.min(i.findBin(2.5*r.q1-1.5*r.q3,u,!0)+1,f-1)]),r.uf=Math.max(r.q3,u[Math.max(i.findBin(2.5*r.q3-1.5*r.q1,u),0)]),r.lo=4*r.q1-3*r.q3,r.uo=4*r.q3-3*r.q1}var y=r.getFromId(n,t.xaxis||"x"),p=r.getFromId(n,t.yaxis||"y"),k=t.orientation,f=[],o,h,s,w,c,l,e,b,a,v;return(k==="h"?(o=y,h="x",c=p,l="y"):(o=p,h="y",c=y,l="x"),s=o.makeCalcdata(t,h),r.expand(o,s,{padded:!0}),e=d(n,t,l,c,s),v=i.distinctVals(e),b=v.vals,a=v.minDiff/2,w=g(f,s,e,b,a),nt(f,w),f=f.filter(function(n){return n.val&&n.val.length}),!f.length)?[{t:{emptybox:!0}}]:(f[0].t={boxnum:n.numboxes,dPos:a},n.numboxes++,f)}},{"../../lib":681,"../../plots/cartesian/axes":710,"fast-isnumeric":133}],807:[function(n,t){"use strict";var i=n("../../lib"),u=n("../../components/color"),r=n("./attributes");t.exports=function(n,t,f){function e(u,f){return i.coerce(n,t,r,u,f)}var c=e("y"),s=e("x"),h;if(c&&c.length)h="v",s||e("x0");else if(s&&s.length)h="h",e("y0");else{t.visible=!1;return}e("orientation",h);e("line.color",(n.marker||{}).color||f);e("line.width",2);e("fillcolor",u.addOpacity(t.line.color,.5));e("whiskerwidth");e("boxmean");var l=i.coerce2(n,t,r,"marker.outliercolor"),a=e("marker.line.outliercolor"),o=l||a?e("boxpoints","suspectedoutliers"):e("boxpoints");o&&(e("jitter",o==="all"?.3:0),e("pointpos",o==="all"?-1.5:0),e("marker.symbol"),e("marker.opacity"),e("marker.size"),e("marker.color",t.line.color),e("marker.line.color"),e("marker.line.width"),o==="suspectedoutliers"&&(e("marker.line.outliercolor",t.marker.color),e("marker.line.outlierwidth")))}},{"../../components/color":582,"../../lib":681,"./attributes":805}],808:[function(n,t){"use strict";var u=n("../../plots/cartesian/axes"),i=n("../../plots/cartesian/graph_interact"),f=n("../../lib"),r=n("../../components/color");t.exports=function(n,t,e,o){var k=n.cd,h=k[0].trace,c=k[0].t,rt=n.xa,ut=n.ya,ft=[],g,nt,et,p,w,v,ot,y,tt,it,b,l,a,d;if(p=o==="closest"?2.5*c.bdPos:c.bdPos,h.orientation==="h"?(g=function(n){return i.inbox(n.min-t,n.max-t)},nt=function(n){var t=n.pos+c.bPos-e;return i.inbox(t-p,t+p)},w="y",v=ut,y="x",tt=rt):(g=function(n){var r=n.pos+c.bPos-t;return i.inbox(r-p,r+p)},nt=function(n){return i.inbox(n.min-e,n.max-e)},w="x",v=rt,y="y",tt=ut),et=i.getDistanceFunction(o,g,nt),i.getClosest(k,et,n),n.index!==!1){var s=k[n.index],st=h.line.color,ht=(h.marker||{}).color;for(n.color=r.opacity(st)&&h.line.width?st:r.opacity(ht)&&h.boxpoints?ht:h.fillcolor,n[w+"0"]=v.c2p(s.pos+c.bPos-c.bdPos,!0),n[w+"1"]=v.c2p(s.pos+c.bPos+c.bdPos,!0),u.tickText(v,v.c2l(s.pos),"hover").text,n[w+"LabelVal"]=s.pos,it={},b=["med","min","q1","q3","max"],h.boxmean&&b.push("mean"),h.boxpoints&&[].push.apply(b,["lf","uf"]),d=0;d<b.length;d++)(l=b[d],l in s&&!(s[l]in it))&&(it[s[l]]=!0,ot=tt.c2p(s[l],!0),a=f.extendFlat({},n),a[y+"0"]=a[y+"1"]=ot,a[y+"LabelVal"]=s[l],a.attr=l,l==="mean"&&"sd"in s&&h.boxmean==="sd"&&(a[y+"err"]=s.sd),n.name="",ft.push(a));return ft}}},{"../../components/color":582,"../../lib":681,"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717}],809:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.layoutAttributes=n("./layout_attributes");i.supplyDefaults=n("./defaults");i.supplyLayoutDefaults=n("./layout_defaults");i.calc=n("./calc");i.setPositions=n("./set_positions");i.plot=n("./plot");i.style=n("./style");i.hoverPoints=n("./hover");i.moduleType="trace";i.name="box";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","symbols","oriented","box","showLegend"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"./attributes":805,"./calc":806,"./defaults":807,"./hover":808,"./layout_attributes":810,"./layout_defaults":811,"./plot":812,"./set_positions":813,"./style":814}],810:[function(n,t){"use strict";t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay"},boxgap:{valType:"number",min:0,max:1,dflt:.3},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3}}},{}],811:[function(n,t){"use strict";var i=n("../../registry"),r=n("../../lib"),u=n("./layout_attributes");t.exports=function(n,t,f){function e(i,f){return r.coerce(n,t,u,i,f)}for(var s,o=0;o<f.length;o++)if(i.traceIs(f[o],"box")){s=!0;break}s&&(e("boxmode"),e("boxgap"),e("boxgroupgap"))}},{"../../lib":681,"../../registry":784,"./layout_attributes":810}],812:[function(n,t){"use strict";function s(){r=2e9}function f(){var n=r;return(r=(69069*r+1)%4294967296,Math.abs(r-n)<429496729)?f():r/4294967296}var i=n("d3"),u=n("../../lib"),o=n("../../components/drawing"),r=2e9,e=5,h=.01;t.exports=function(n,t,r){var a=n._fullLayout,v=t.xaxis,y=t.yaxis,c,l,p=t.plot.select(".boxlayer").selectAll("g.trace.boxes").data(r).enter().append("g").attr("class","trace boxes");p.each(function(t){var b=t[0].t,r=t[0].trace,k=a.boxmode==="group"&&n.numboxes>1,w=b.dPos*(1-a.boxgap)*(1-a.boxgroupgap)/(k?n.numboxes:1),p=k?2*b.dPos*(-.5+(b.boxnum+.5)/n.numboxes)*(1-a.boxgap):0,d=w*r.whiskerwidth;if(r.visible!==!0||b.emptybox){i.select(this).remove();return}r.orientation==="h"?(c=y,l=v):(c=v,l=y);b.bPos=p;b.bdPos=w;s();i.select(this).selectAll("path.box").data(u.identity).enter().append("path").attr("class","box").each(function(n){var o=c.c2p(n.pos+p,!0),t=c.c2p(n.pos+p-w,!0),s=c.c2p(n.pos+p+w,!0),h=c.c2p(n.pos+p-d,!0),a=c.c2p(n.pos+p+d,!0),f=l.c2p(n.q1,!0),e=l.c2p(n.q3,!0),b=u.constrain(l.c2p(n.med,!0),Math.min(f,e)+1,Math.max(f,e)-1),v=l.c2p(r.boxpoints===!1?n.min:n.lf,!0),y=l.c2p(r.boxpoints===!1?n.max:n.uf,!0);r.orientation==="h"?i.select(this).attr("d","M"+b+","+t+"V"+s+"M"+f+","+t+"V"+s+"H"+e+"V"+t+"ZM"+f+","+o+"H"+v+"M"+e+","+o+"H"+y+(r.whiskerwidth===0?"":"M"+v+","+h+"V"+a+"M"+y+","+h+"V"+a)):i.select(this).attr("d","M"+t+","+b+"H"+s+"M"+t+","+f+"H"+s+"V"+e+"H"+t+"ZM"+o+","+f+"V"+v+"M"+o+","+e+"V"+y+(r.whiskerwidth===0?"":"M"+h+","+v+"H"+a+"M"+h+","+y+"H"+a))});r.boxpoints&&i.select(this).selectAll("g.points").data(function(n){return n.forEach(function(n){n.t=b;n.trace=r}),n}).enter().append("g").attr("class","points").selectAll("path").data(function(n){var i=r.boxpoints==="all"?n.val:n.val.filter(function(t){return t<n.lf||t>n.uf}),v=Math.max((n.max-n.min)/10,n.q3-n.q1),d=v*1e-9,g=v*h,s=[],c=0,t,y,b,l,a,o,k;if(r.jitter){if(v===0)for(c=1,s=new Array(i.length),t=0;t<i.length;t++)s[t]=1;else for(t=0;t<i.length;t++)y=Math.max(0,t-e),l=i[y],b=Math.min(i.length-1,t+e),a=i[b],r.boxpoints!=="all"&&(i[t]<n.lf?a=Math.min(a,n.lf):l=Math.max(l,n.uf)),o=Math.sqrt(g*(b-y)/(a-l+d))||0,o=u.constrain(Math.abs(o),0,1),s.push(o),c=Math.max(o,c);k=r.jitter*2/c}return i.map(function(t,i){var u=r.pointpos,e;return r.jitter&&(u+=k*s[i]*(f()-.5)),e=r.orientation==="h"?{y:n.pos+u*w+p,x:t}:{x:n.pos+u*w+p,y:t},r.boxpoints==="suspectedoutliers"&&t<n.uo&&t>n.lo&&(e.so=!0),e})}).enter().append("path").call(o.translatePoints,v,y);r.boxmean&&i.select(this).selectAll("path.mean").data(u.identity).enter().append("path").attr("class","mean").style("fill","none").each(function(n){var t=c.c2p(n.pos+p,!0),u=c.c2p(n.pos+p-w,!0),e=c.c2p(n.pos+p+w,!0),f=l.c2p(n.mean,!0),o=l.c2p(n.mean-n.sd,!0),s=l.c2p(n.mean+n.sd,!0);r.orientation==="h"?i.select(this).attr("d","M"+f+","+u+"V"+e+(r.boxmean!=="sd"?"":"m0,0L"+o+","+t+"L"+f+","+u+"L"+s+","+t+"Z")):i.select(this).attr("d","M"+u+","+f+"H"+e+(r.boxmean!=="sd"?"":"m0,0L"+t+","+o+"L"+u+","+f+"L"+t+","+s+"Z"))})})}},{"../../components/drawing":605,"../../lib":681,d3:129}],813:[function(n,t){"use strict";var r=n("../../registry"),i=n("../../plots/cartesian/axes"),u=n("../../lib");t.exports=function(n,t){for(var k=n._fullLayout,d=t.xaxis,g=t.yaxis,nt=["v","h"],y,e,l,h,c,b,o=0;o<nt.length;++o){var tt=nt[o],a=[],v=[],p=0,w=0,s,it,f;for(y=tt==="h"?g:d,e=0;e<n.calcdata.length;++e)s=n.calcdata[e],it=s[0].t,f=s[0].trace,f.visible===!0&&r.traceIs(f,"box")&&!it.emptybox&&f.orientation===tt&&f.xaxis===d._id&&f.yaxis===g._id&&(a.push(e),f.boxpoints!==!1&&(p=Math.max(p,f.jitter-f.pointpos-1),w=Math.max(w,f.jitter+f.pointpos-1)));for(e=0;e<a.length;e++)for(s=n.calcdata[a[e]],l=0;l<s.length;l++)v.push(s[l].pos);if(v.length){for(h=u.distinctVals(v),c=h.minDiff/2,v.length===h.vals.length&&(n.numboxes=1),i.minDtick(y,h.minDiff,h.vals[0],!0),o=0;o<a.length;++o)n.calcdata[o][0].t.dPos=c;b=(1-k.boxgap)*(1-k.boxgroupgap)*c/n.numboxes;i.expand(y,h.vals,{vpadminus:c+p*b,vpadplus:c+w*b})}}}},{"../../lib":681,"../../plots/cartesian/axes":710,"../../registry":784}],814:[function(n,t){"use strict";var i=n("d3"),r=n("../../components/color"),u=n("../../components/drawing");t.exports=function(n){var t=i.select(n).selectAll("g.trace.boxes");t.style("opacity",function(n){return n[0].trace.opacity}).each(function(n){var t=n[0].trace,f=t.line.width;i.select(this).selectAll("path.box").style("stroke-width",f+"px").call(r.stroke,t.line.color).call(r.fill,t.fillcolor);i.select(this).selectAll("path.mean").style({"stroke-width":f,"stroke-dasharray":2*f+"px,"+f+"px"}).call(r.stroke,t.line.color);i.select(this).selectAll("g.points path").call(u.pointStyle,t)})}},{"../../components/color":582,"../../components/drawing":605,d3:129}],815:[function(n,t){"use strict";var r=n("../../lib"),i=n("../ohlc/attributes"),u=n("../box/attributes"),f={name:i.increasing.name,showlegend:i.increasing.showlegend,line:{color:r.extendFlat({},u.line.color),width:r.extendFlat({},u.line.width)},fillcolor:r.extendFlat({},u.fillcolor)};t.exports={x:i.x,open:i.open,high:i.high,low:i.low,close:i.close,line:{width:r.extendFlat({},u.line.width,{})},increasing:r.extendDeep({},f,{line:{color:{dflt:i.increasing.line.color.dflt}}}),decreasing:r.extendDeep({},f,{line:{color:{dflt:i.decreasing.line.color.dflt}}}),text:i.text,whiskerwidth:r.extendFlat({},u.whiskerwidth,{dflt:0})}},{"../../lib":681,"../box/attributes":805,"../ohlc/attributes":866}],816:[function(n,t){"use strict";function i(n,t,i,r){f(n,t,i,r);i(r+".line.color");i(r+".line.width",t.line.width);i(r+".fillcolor")}var r=n("../../lib"),u=n("../ohlc/ohlc_defaults"),f=n("../ohlc/direction_defaults"),e=n("../ohlc/helpers"),o=n("./attributes");t.exports=function(n,t){function f(i,u){return r.coerce(n,t,o,i,u)}e.pushDummyTransformOpts(n,t);var s=u(n,t,f);if(s===0){t.visible=!1;return}f("line.width");i(n,t,f,"increasing");i(n,t,f,"decreasing");f("text");f("whiskerwidth")}},{"../../lib":681,"../ohlc/direction_defaults":868,"../ohlc/helpers":869,"../ohlc/ohlc_defaults":871,"./attributes":815}],817:[function(n,t){"use strict";var i=n("../../plot_api/register");t.exports={moduleType:"trace",name:"candlestick",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","showLegend"],meta:{},attributes:n("./attributes"),supplyDefaults:n("./defaults")};i(n("../box"));i(n("./transform"))},{"../../plot_api/register":701,"../../plots/cartesian":718,"../box":809,"./attributes":815,"./defaults":816,"./transform":818}],818:[function(n,t,i){"use strict";function u(n,t,i){var e={type:"box",boxpoints:!1,visible:n.visible,hoverinfo:n.hoverinfo,opacity:n.opacity,xaxis:n.xaxis,yaxis:n.yaxis,transforms:r.makeTransform(n,t,i)},u=n[i];return u&&f.extendFlat(e,{x:n.x||[0],y:[].concat(n.low).concat(n.high),whiskerwidth:n.whiskerwidth,text:n.text,name:u.name,showlegend:u.showlegend,line:u.line,fillcolor:u.fillcolor}),e}var f=n("../../lib"),r=n("../ohlc/helpers");i.moduleType="transform";i.name="candlestick";i.attributes={};i.supplyDefaults=function(n,t,i,u){return r.clearEphemeralTransformOpts(u),r.copyOHLC(n,t),n};i.transform=function(n,t){for(var i,f=[],e=0;e<n.length;e++){if(i=n[e],i.type!=="candlestick"){f.push(i);continue}f.push(u(i,t,"increasing"),u(i,t,"decreasing"))}return r.addRangeSlider(t.layout),f};i.calcTransform=function(n,t,i){for(var h=i.direction,c=r.getFilterFn(h),f=t.open,l=t.high,a=t.low,o=t.close,v=f.length,e=[],s=[],y=t._fullInput.x?function(n){var i=t.x[n];e.push(i,i,i,i,i,i)}:function(n){e.push(n,n,n,n,n,n)},p=function(n,t,i,r){s.push(i,n,r,r,r,t)},u=0;u<v;u++)c(f[u],o[u])&&(y(u),p(f[u],l[u],a[u],o[u]));t.x=e;t.y=s}},{"../../lib":681,"../ohlc/helpers":869}],819:[function(n,t){"use strict";var i=n("../scattergeo/attributes"),f=n("../../components/colorscale/attributes"),e=n("../../plots/attributes"),r=n("../../lib/extend").extendFlat,u=i.marker.line;t.exports=r({},{locations:{valType:"data_array"},locationmode:i.locationmode,z:{valType:"data_array"},text:{valType:"data_array"},marker:{line:{color:u.color,width:u.width}},hoverinfo:r({},e.hoverinfo,{flags:["location","z","text","name"]}),_nestedModules:{colorbar:"Colorbar"}},f)},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../../plots/attributes":708,"../scattergeo/attributes":918}],820:[function(n,t){"use strict";var i=n("../../components/colorscale/calc");t.exports=function(n,t){i(t,t.z,"","z")}},{"../../components/colorscale/calc":589}],821:[function(n,t){"use strict";var i=n("../../lib"),r=n("../../components/colorscale/defaults"),u=n("./attributes");t.exports=function(n,t,f,e){function o(r,f){return i.coerce(n,t,u,r,f)}var c=o("locations"),s,h;if(c&&(s=c.length),!c||!s){t.visible=!1;return}if(h=o("z"),!Array.isArray(h)){t.visible=!1;return}h.length>s&&(t.z=h.slice(0,s));o("locationmode");o("text");o("marker.line.color");o("marker.line.width");r(n,t,e,o,{prefix:"",cLetter:"z"});o("hoverinfo",e._dataLength===1?"location+z+text":undefined)}},{"../../components/colorscale/defaults":592,"../../lib":681,"./attributes":819}],822:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../heatmap/colorbar");i.calc=n("./calc");i.plot=n("./plot").plot;i.hoverPoints=function(){};i.moduleType="trace";i.name="choropleth";i.basePlotModule=n("../../plots/geo");i.categories=["geo","noOpacity"];i.meta={};t.exports=i},{"../../plots/geo":733,"../heatmap/colorbar":836,"./attributes":819,"./calc":820,"./defaults":821,"./plot":823}],823:[function(n,t){"use strict";function p(n,t){function c(t){var i=n.mockAxis;return e.tickText(i,i.c2l(t),"hover").text}var i=t.hoverinfo;if(i==="none"||i==="skip")return function(n){delete n.nameLabel;delete n.textLabel};var r=i==="all"?y.hoverinfo.flags:i.split("+"),u=r.indexOf("name")!==-1,f=r.indexOf("location")!==-1,o=r.indexOf("z")!==-1,s=r.indexOf("text")!==-1,h=!u&&f;return function(n){var i=[];h?n.nameLabel=n.id:(u&&(n.nameLabel=t.name),f&&i.push(n.id));o&&i.push(c(n.z));s&&i.push(n.tx);n.textLabel=i.join("<br>")}}function w(n){return function(t,i){return{points:[{data:n._input,fullData:n,curveNumber:n.index,pointNumber:i,location:t.id,z:t.z}]}}}var r=n("d3"),e=n("../../plots/cartesian/axes"),u=n("../../plots/cartesian/graph_interact"),o=n("../../components/color"),s=n("../../components/drawing"),h=n("../../components/colorscale/get_scale"),c=n("../../components/colorscale/make_scale_function"),l=n("../../lib/topojson_utils").getTopojsonFeatures,a=n("../../lib/geo_location_utils").locationToFeature,f=n("../../lib/array_to_calc_item"),v=n("../../plots/geo/constants"),y=n("./attributes"),i=t.exports={};i.calcGeoJSON=function(n,t){for(var u=[],e=n.locations,s=e.length,h=l(n,t),o=(n.marker||{}).line||{},i,r=0;r<s;r++)(i=a(n.locationmode,e[r],h),i)&&(i.z=n.z[r],n.text!==undefined&&(i.tx=n.text[r]),f(o.color,i,"mlc",r),f(o.width,i,"mlw",r),u.push(i));return u.length>0&&(u[0].trace=n),u};i.plot=function(n,t,f){function a(n){return n[0].trace.uid}var s=n.framework,y=s.select("g.choroplethlayer"),b=s.select("g.baselayer"),h=s.select("g.baselayeroverchoropleth"),l=v.baseLayersOverChoropleth,e,c=y.selectAll("g.trace.choropleth").data(t,a),o;for(c.enter().append("g").attr("class","trace choropleth"),c.exit().remove(),c.each(function(t){function s(t,i){if(n.showHover){var r=n.projection(t.properties.ct);l(t);u.loneHover({x:r[0],y:r[1],name:t.nameLabel,text:t.textLabel},{container:n.hoverContainer.node()});e=o(t,i);n.graphDiv.emit("plotly_hover",e)}}function a(t,i){n.graphDiv.emit("plotly_click",o(t,i))}var f=t[0].trace,c=i.calcGeoJSON(f,n.topojson),l=p(n,f),o=w(f),e=null,h=r.select(this).selectAll("path.choroplethlocation").data(c);h.enter().append("path").classed("choroplethlocation",!0).on("mouseover",s).on("click",a).on("mouseout",function(){u.loneUnhover(n.hoverContainer);n.graphDiv.emit("plotly_unhover",e)}).on("mousedown",function(){u.loneUnhover(n.hoverContainer)}).on("mouseup",s);h.exit().remove()}),h.selectAll("*").remove(),o=0;o<l.length;o++)e=l[o],b.select("g."+e).remove(),n.drawTopo(h,e,f),n.styleLayer(h,e,f);i.style(n)};i.style=function(n){n.framework.selectAll("g.trace.choropleth").each(function(n){var t=n[0].trace,u=r.select(this),f=t.marker||{},i=f.line||{},e=t.zmin,l=t.zmax,a=h(t.colorscale),v=c(a,e,l);u.selectAll("path.choroplethlocation").each(function(n){r.select(this).attr("fill",function(n){return v(n.z)}).call(o.stroke,n.mlc||i.color).call(s.dashLine,"",n.mlw||i.width)})})}},{"../../components/color":582,"../../components/colorscale/get_scale":594,"../../components/colorscale/make_scale_function":599,"../../components/drawing":605,"../../lib/array_to_calc_item":669,"../../lib/geo_location_utils":677,"../../lib/topojson_utils":696,"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717,"../../plots/geo/constants":731,"./attributes":819,d3:129}],824:[function(n,t){"use strict";var i=n("../heatmap/attributes"),e=n("../scatter/attributes"),f=n("../../components/colorscale/attributes"),r=n("../../lib/extend").extendFlat,u=e.line;t.exports=r({},{z:i.z,x:i.x,x0:i.x0,dx:i.dx,y:i.y,y0:i.y0,dy:i.dy,text:i.text,transpose:i.transpose,xtype:i.xtype,ytype:i.ytype,connectgaps:i.connectgaps,autocontour:{valType:"boolean",dflt:!0},ncontours:{valType:"integer",dflt:0},contours:{start:{valType:"number",dflt:null},end:{valType:"number",dflt:null},size:{valType:"number",dflt:null},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill"},showlines:{valType:"boolean",dflt:!0}},line:{color:r({},u.color,{}),width:u.width,dash:u.dash,smoothing:r({},u.smoothing,{})},_nestedModules:{colorbar:"Colorbar"}},f,{autocolorscale:r({},f.autocolorscale,{dflt:!1})})},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../heatmap/attributes":834,"../scatter/attributes":889}],825:[function(n,t){"use strict";var i=n("../../plots/cartesian/axes"),r=n("../heatmap/calc");t.exports=function(n,t){var e=r(n,t),u=t.contours,f;return t.autocontour!==!1&&(f={type:"linear",range:[t.zmin,t.zmax]},i.autoTicks(f,(t.zmax-t.zmin)/(t.ncontours||15)),u.start=i.tickFirst(f),u.size=f.dtick,f.range.reverse(),u.end=i.tickFirst(f),u.start===t.zmin&&(u.start+=u.size),u.end===t.zmax&&(u.end-=u.size),u.end+=u.size/100,t._input.contours=u),e}},{"../../plots/cartesian/axes":710,"../heatmap/calc":835}],826:[function(n,t){"use strict";var i=n("../../plots/plots"),r=n("../../components/colorbar/draw"),u=n("./make_color_map");t.exports=function(n,t){var f=t[0].trace,h="cb"+f.uid,o;if(n._fullLayout._infolayer.selectAll("."+h).remove(),f.showscale===!1){i.autoMargin(n,h);return}o=r(n,h);t[0].t.cb=o;var e=f.contours,c=f.line,a=e.size||1,s=e.coloring,l=u(f,{isColorbar:!0});s==="heatmap"&&o.filllevels({start:f.zmin,end:f.zmax,size:(f.zmax-f.zmin)/254});o.fillcolor(s==="fill"||s==="heatmap"?l:"").line({color:s==="lines"?l:c.color,width:e.showlines!==!1?c.width:0,dash:c.dash}).levels({start:e.start,end:e.end,size:a}).options(f.colorbar)()}},{"../../components/colorbar/draw":585,"../../plots/plots":769,"./make_color_map":830}],827:[function(n,t){"use strict";var i=n("../../lib"),u=n("../heatmap/has_columns"),f=n("../heatmap/xyz_defaults"),e=n("../contour/style_defaults"),r=n("./attributes");t.exports=function(n,t,o,s){function h(u,f){return i.coerce(n,t,r,u,f)}var c=f(n,t,h);if(!c){t.visible=!1;return}h("text");h("connectgaps",u(t));var l=i.coerce2(n,t,r,"contours.start"),a=i.coerce2(n,t,r,"contours.end"),v=h("autocontour",!(l&&a));v?h("ncontours"):h("contours.size");e(n,t,h,s)}},{"../../lib":681,"../contour/style_defaults":833,"../heatmap/has_columns":839,"../heatmap/xyz_defaults":845,"./attributes":824}],828:[function(n,t){"use strict";var i=n("../heatmap/hover");t.exports=function(n,t,r,u){return i(n,t,r,u,!0)}},{"../heatmap/hover":840}],829:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("./calc");i.plot=n("./plot");i.style=n("./style");i.colorbar=n("./colorbar");i.hoverPoints=n("./hover");i.moduleType="trace";i.name="contour";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","2dMap","contour"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"./attributes":824,"./calc":825,"./colorbar":826,"./defaults":827,"./hover":828,"./plot":831,"./style":832}],830:[function(n,t){"use strict";var i=n("d3"),r=n("../../components/colorscale/get_scale");t.exports=function(n){var u=n.contours,c=u.start,b=u.end,e=u.size||1,l=Math.floor((b+e/10-c)/e)+1,v=u.coloring==="lines"?0:1,a=r(n.colorscale),h=a.length,s=new Array(h),f=new Array(h),o,t;if(u.coloring==="heatmap"){for(n.zauto&&n.autocontour===!1&&(n.zmin=c-e/2,n.zmax=n.zmin+l*e),t=0;t<h;t++)o=a[t],s[t]=o[0]*(n.zmax-n.zmin)+n.zmin,f[t]=o[1];var y=i.extent([n.zmin,n.zmax,u.start,u.start+e*(l-1)]),p=y[n.zmin<n.zmax?0:1],w=y[n.zmin<n.zmax?1:0];p!==n.zmin&&(s.splice(0,0,p),f.splice(0,0,Range[0]));w!==n.zmax&&(s.push(w),f.push(f[f.length-1]))}else for(t=0;t<h;t++)o=a[t],s[t]=(o[0]*(l+v-1)-v/2)*e+c,f[t]=o[1];return i.scale.linear().interpolate(i.interpolateRgb).domain(s).range(f)}},{"../../components/colorscale/get_scale":594,d3:129}],831:[function(n,t){"use strict";function d(n,t,i){var r=i[0].trace,s=i[0].x,c=i[0].y,u=r.contours,e=r.uid,p=t.xaxis,w=t.yaxis,a=n._fullLayout,b="contour"+e,f=g(u,t,i[0]);if(r.visible!==!0){a._paper.selectAll("."+b+",.hm"+e).remove();a._infolayer.selectAll(".cb"+e).remove();return}u.coloring==="heatmap"?(r.zauto&&r.autocontour===!1&&(r._input.zmin=r.zmin=u.start-u.size/2,r._input.zmax=r.zmax=r.zmin+f.length*u.size),y(n,t,[i])):a._paper.selectAll(".hm"+e).remove();h(f);l(f);var k=p.c2p(s[0],!0),d=p.c2p(s[s.length-1],!0),nt=w.c2p(c[0],!0),tt=w.c2p(c[c.length-1],!0),v=[[k,tt],[d,tt],[d,nt],[k,nt]],o=rt(t,i,b);ut(o,v,u);ft(o,f,v,u);et(o,f,u);ot(o,t,i[0],v)}function g(n,t,i){for(var u=n.size||1,f=[],r=n.start;r<n.end+u/10;r+=u)f.push({level:r,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:i.x,y:i.y,z:i.z,smoothing:i.trace.line.smoothing});return f}function nt(n,t){var i=(t[0][0]>n?0:1)+(t[0][1]>n?0:2)+(t[1][1]>n?0:4)+(t[1][0]>n?0:8),r;return i===5||i===10?(r=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4,n>r)?i===5?713:1114:i===5?104:208:i===15?0:i}function h(n){for(var u=n[0].z,a=u.length,v=u[0].length,b=a===2||v===2,t,r,f,y,w,h,c,l,i=0;i<a-1;i++)for(f=[],i===0&&(f=f.concat(e)),i===a-2&&(f=f.concat(o)),t=0;t<v-1;t++)for(r=f.slice(),t===0&&(r=r.concat(s)),t===v-2&&(r=r.concat(p)),y=t+","+i,w=[[u[i][t],u[i][t+1]],[u[i+1][t],u[i+1][t+1]]],l=0;l<n.length;l++)(c=n[l],h=nt(c.level,w),h)&&(c.crossings[y]=h,r.indexOf(h)!==-1&&(c.starts.push([t,i]),b&&r.indexOf(h,r.indexOf(h)+1)!==-1&&c.starts.push([t,i])))}function c(n,t,r){function nt(n){return f[n%f.length]}for(var ft=t.join(","),v=ft,c=n.crossings[v],o=tt(c,r,t),f=[a(n,t,[-o[0],-o[1]])],ct=o.join(","),lt=n.z.length,at=n.z[0].length,ut,d,e=0;e<1e4;e++){if(c>20?(c=b[c][(o[0]||o[1])<0?0:1],n.crossings[v]=k[c]):delete n.crossings[v],o=w[c],!o){i.log("Found bad marching index:",c,t,n.level);break}if(f.push(a(n,t,o)),t[0]+=o[0],t[1]+=o[1],u(f[f.length-1],f[f.length-2])&&f.pop(),v=t.join(","),v===ft&&o.join(",")===ct||r&&(o[0]&&(t[0]<0||t[0]>at-2)||o[1]&&(t[1]<0||t[1]>lt-2)))break;c=n.crossings[v]}e===1e4&&i.log("Infinite loop in contour?");var g=u(f[0],f[f.length-1]),ot=0,vt=.2*n.smoothing,l=[],rt=0,y,s,h,st,ht,p,et;for(e=1;e<f.length;e++)et=it(f[e],f[e-1]),ot+=et,l.push(et);for(ut=ot/l.length*vt,e=f.length-2;e>=rt;e--)if(y=l[e],y<ut){for(h=0,s=e-1;s>=rt;s--)if(y+l[s]<ut)y+=l[s];else break;if(g&&e===f.length-2)for(h=0;h<s;h++)if(y+l[h]<ut)y+=l[h];else break;ht=e-s+h+1;p=Math.floor((e+s+h+2)/2);st=g||e!==f.length-2?g||s!==-1?ht%2?nt(p):[(nt(p)[0]+nt(p+1)[0])/2,(nt(p)[1]+nt(p+1)[1])/2]:f[0]:f[f.length-1];f.splice(s+1,e-s+1,st);e=s+1;h&&(rt=h);g&&(e===f.length-2?f[h]=f[f.length-1]:e===0&&(f[f.length-1]=f[0]))}(f.splice(0,rt),f.length<2)||(g?(f.pop(),n.paths.push(f)):(r||i.log("Unclosed interior contour?",n.level,ft,f.join("L")),d=!1,n.edgepaths.forEach(function(t,i){if(!d&&u(t[0],f[f.length-1])){f.pop();d=!0;var r=!1;n.edgepaths.forEach(function(t,e){!r&&u(t[t.length-1],f[0])&&(r=!0,f.splice(0,1),n.edgepaths.splice(i,1),e===i?n.paths.push(f.concat(t)):n.edgepaths[e]=n.edgepaths[e].concat(f,t))});r||(n.edgepaths[i]=f.concat(t))}}),n.edgepaths.forEach(function(t,i){!d&&u(t[t.length-1],f[0])&&(f.splice(0,1),n.edgepaths[i]=t.concat(f),d=!0)}),d||n.edgepaths.push(f)))}function l(n){for(var r,u,t,e,f=0;f<n.length;f++){for(t=n[f],e=0;e<t.starts.length;e++)u=t.starts[e],c(t,u,"edge");for(r=0;Object.keys(t.crossings).length&&r<1e4;)r++,u=Object.keys(t.crossings)[0].split(",").map(Number),c(t,u);r===1e4&&i.log("Infinite loop in contour?")}}function tt(n,t,i){var r=0,u=0;return n>20&&t?n===208||n===1114?r=i[0]===0?1:-1:u=i[1]===0?1:-1:e.indexOf(n)!==-1?u=1:s.indexOf(n)!==-1?r=1:o.indexOf(n)!==-1?u=-1:r=-1,[r,u]}function u(n,t){return Math.abs(n[0]-t[0])<.01&&Math.abs(n[1]-t[1])<.01}function it(n,t){var i=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(i*i+r*r)}function a(n,t,i){var r=t[0]+Math.max(i[0],0),u=t[1]+Math.max(i[1],0),f=n.z[u][r],s=n.xaxis,h=n.yaxis,e,o;return i[1]?(e=(n.level-f)/(n.z[u][r+1]-f),[s.c2p((1-e)*n.x[r]+e*n.x[r+1],!0),h.c2p(n.y[u],!0)]):(o=(n.level-f)/(n.z[u+1][r]-f),[s.c2p(n.x[r],!0),h.c2p((1-o)*n.y[u]+o*n.y[u+1],!0)])}function rt(n,t,i){var r=n.plot.select(".maplayer").selectAll("g.contour."+i).data(t);return r.enter().append("g").classed("contour",!0).classed(i,!0),r.exit().remove(),r}function ut(n,t,i){var u=n.selectAll("g.contourbg").data([0]),r;u.enter().append("g").classed("contourbg",!0);r=u.selectAll("path").data(i.coloring==="fill"?[0]:[]);r.enter().append("path");r.exit().remove();r.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function ft(n,t,i,r){var e=n.selectAll("g.contourfill").data([0]),u;e.enter().append("g").classed("contourfill",!0);u=e.selectAll("path").data(r.coloring==="fill"?t:[]);u.enter().append("path");u.exit().remove();u.each(function(n){var t=v(n,i);t?f.select(this).attr("d",t).style("stroke","none"):f.select(this).remove()})}function v(n,t){function w(n){return Math.abs(n[1]-t[0][1])<.01}function b(n){return Math.abs(n[1]-t[2][1])<.01}function k(n){return Math.abs(n[0]-t[0][0])<.01}function p(n){return Math.abs(n[0]-t[2][0])<.01}for(var c=n.edgepaths.length||n.z[0][0]<n.level?"":"M"+t.join("L")+"Z",e=0,l=n.edgepaths.map(function(n,t){return t}),a=!0,u,f,v,s,h,y,o;l.length;){for(y=r.smoothopen(n.edgepaths[e],n.smoothing),c+=a?y:y.replace(/^M/,"L"),l.splice(l.indexOf(e),1),u=n.edgepaths[e][n.edgepaths[e].length-1],s=-1,v=0;v<4;v++){if(!u){i.log("Missing end?",e,n);break}for(w(u)&&!p(u)?f=t[1]:k(u)?f=t[0]:b(u)?f=t[3]:p(u)&&(f=t[2]),h=0;h<n.edgepaths.length;h++)o=n.edgepaths[h][0],Math.abs(u[0]-f[0])<.01?Math.abs(u[0]-o[0])<.01&&(o[1]-u[1])*(f[1]-o[1])>=0&&(f=o,s=h):Math.abs(u[1]-f[1])<.01?Math.abs(u[1]-o[1])<.01&&(o[0]-u[0])*(f[0]-o[0])>=0&&(f=o,s=h):i.log("endpt to newendpt is not vert. or horz.",u,f,o);if(u=f,s>=0)break;c+="L"+f}if(s===n.edgepaths.length){i.log("unclosed perimeter path");break}e=s;a=l.indexOf(e)===-1;a&&(e=l[0],c+="Z")}for(e=0;e<n.paths.length;e++)c+=r.smoothclosed(n.paths[e],n.smoothing);return c}function et(n,t,i){var o=t[0].smoothing,u=n.selectAll("g.contourlevel").data(i.showlines===!1?[]:t),f,e;u.enter().append("g").classed("contourlevel",!0);u.exit().remove();f=u.selectAll("path.openline").data(function(n){return n.edgepaths});f.enter().append("path").classed("openline",!0);f.exit().remove();f.attr("d",function(n){return r.smoothopen(n,o)}).style("stroke-miterlimit",1);e=u.selectAll("path.closedline").data(function(n){return n.paths});e.enter().append("path").classed("closedline",!0);e.exit().remove();e.attr("d",function(n){return r.smoothclosed(n,o)}).style("stroke-miterlimit",1)}function ot(n,t,i,u){var f="clip"+i.trace.uid,c=t.plot.selectAll("defs").data([0]),e,o,a,s;c.enter().append("defs");e=c.selectAll("#"+f).data(i.trace.connectgaps?[]:[0]);e.enter().append("clipPath").attr("id",f);e.exit().remove();i.trace.connectgaps===!1?(o={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:i.x,y:i.y,z:st(i),smoothing:0},h([o]),l([o]),a=v(o,u),s=e.selectAll("path").data([0]),s.enter().append("path"),s.attr("d",a)):f=null;n.call(r.setClipUrl,f);t.plot.selectAll(".hm"+i.trace.uid).call(r.setClipUrl,f)}function st(n){for(var u=n.trace._emptypoints,i=[],e=n.z.length,o=n.z[0].length,f=[],r,t=0;t<o;t++)f.push(1);for(t=0;t<e;t++)i.push(f.slice());for(t=0;t<u.length;t++)r=u[t],i[r[0]][r[1]]=0;return n.zmask=i,i}var f=n("d3"),i=n("../../lib"),r=n("../../components/drawing"),y=n("../heatmap/plot");t.exports=function(n,t,i){for(var r=0;r<i.length;r++)d(n,t,i[r])};var e=[1,9,13,104,713],o=[4,6,7,104,713],s=[8,12,14,208,1114],p=[2,3,11,208,1114],w=[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],b={104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},k={1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11}},{"../../components/drawing":605,"../../lib":681,"../heatmap/plot":843,d3:129}],832:[function(n,t){"use strict";var i=n("d3"),r=n("../../components/drawing"),u=n("../heatmap/style"),f=n("./make_color_map");t.exports=function(n){var t=i.select(n).selectAll("g.contour");t.style("opacity",function(n){return n.trace.opacity});t.each(function(n){var t=i.select(this),u=n.trace,e=u.contours,o=u.line,s=e.size||1,h=e.start,c=f(u);t.selectAll("g.contourlevel").each(function(n,t){i.select(this).selectAll("path").call(r.lineGroupStyle,o.width,e.coloring==="lines"?c(h+t*s):o.color,o.dash)});t.selectAll("g.contourbg path").style("fill",c(h-s/2));t.selectAll("g.contourfill path").style("fill",function(n,t){return c(h+(t+.5)*s)})});u(n)}},{"../../components/drawing":605,"../heatmap/style":844,"./make_color_map":830,d3:129}],833:[function(n,t){"use strict";var i=n("../../components/colorscale/defaults");t.exports=function(n,t,r,u){var f=r("contours.coloring"),e;f==="fill"&&(e=r("contours.showlines"));e!==!1&&(f!=="lines"&&r("line.color","#000"),r("line.width",.5),r("line.dash"));r("line.smoothing");(t.contours||{}).coloring!=="none"&&i(n,t,u,r,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":592}],834:[function(n,t){"use strict";var i=n("../scatter/attributes"),r=n("../../components/colorscale/attributes"),u=n("../../lib/extend").extendFlat;t.exports=u({},{z:{valType:"data_array"},x:i.x,x0:i.x0,dx:i.dx,y:i.y,y0:i.y0,dy:i.dy,text:{valType:"data_array"},transpose:{valType:"boolean",dflt:!1},xtype:{valType:"enumerated",values:["array","scaled"]},ytype:{valType:"enumerated",values:["array","scaled"]},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1},connectgaps:{valType:"boolean",dflt:!1},xgap:{valType:"number",dflt:0,min:0},ygap:{valType:"number",dflt:0,min:0},_nestedModules:{colorbar:"Colorbar"}},r,{autocolorscale:u({},r.autocolorscale,{dflt:!1})})},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../scatter/attributes":889}],835:[function(n,t){"use strict";function p(n){function h(n){return c(n)?+n:undefined}var r=n.z,i,e,o,s,t,u,f;if(n.transpose){for(i=0,t=0;t<r.length;t++)i=Math.max(i,r[t].length);if(i===0)return!1;o=function(n){return n.length};s=function(n,t,i){return n[i][t]}}else i=r.length,o=function(n,t){return n[t].length},s=function(n,t,i){return n[t][i]};for(f=new Array(i),t=0;t<i;t++)for(e=o(r,t),f[t]=new Array(e),u=0;u<e;u++)f[t][u]=h(s(r,t,u));return f}function u(n,t,r,u,f,e){var o=[],l=i.traceIs(n,"contour"),a=i.traceIs(n,"histogram"),v=i.traceIs(n,"gl2d"),y,p,s,b=Array.isArray(t)&&t.length>1,h,c,w;if(b&&!a&&e.type!=="category")if(t=t.map(e.d2c),h=t.length,h<=f){if(l||v)o=t.slice(0,f);else if(f===1)o=[t[0]-.5,t[0]+.5];else{for(o=[1.5*t[0]-.5*t[1]],s=1;s<h;s++)o.push((t[s-1]+t[s])*.5);o.push(1.5*t[h-1]-.5*t[h-2])}if(h<f)for(c=o[o.length-1],w=c-o[o.length-2],s=h;s<f;s++)c+=w,o.push(c)}else return l?t.slice(0,f):t.slice(0,f+1);else for(p=u||1,y=a||e.type==="category"?r||0:Array.isArray(t)&&t.length===1?t[0]:r===undefined?0:e.d2c(r),s=l||v?0:-.5;s<f;s++)o.push(y+p*s);return o}function w(n){return.5-.25*Math.min(1,n*.5)}function b(n,t,i){var u=1,r,o;if(Array.isArray(i))for(r=0;r<t.length;r++)o=t[r],n[o[0]][o[1]]=i[o[0]][o[1]];else h(n,t);for(r=0;r<t.length;r++)if(t[r][2]<4)break;for(t=t.slice(r),r=0;r<100&&u>f;r++)u=h(n,t,w(u));return u>f&&e.log("interp2d didn't converge quickly",u),n}function k(n){for(var a=[],f={},s=[],v=n[0],e=[],l=[0,0,0],w=o(n),p,t,u,h,r,c,y,i=0;i<n.length;i++)for(p=e,e=v,v=n[i+1]||[],t=0;t<w;t++)e[t]===undefined&&(r=(e[t-1]!==undefined?1:0)+(e[t+1]!==undefined?1:0)+(p[t]!==undefined?1:0)+(v[t]!==undefined?1:0),r?(i===0&&r++,t===0&&r++,i===n.length-1&&r++,t===e.length-1&&r++,r<4&&(f[[i,t]]=[i,t,r]),a.push([i,t,r])):s.push([i,t]));while(s.length){for(c={},y=!1,h=s.length-1;h>=0;h--)u=s[h],i=u[0],t=u[1],r=((f[[i-1,t]]||l)[2]+(f[[i+1,t]]||l)[2]+(f[[i,t-1]]||l)[2]+(f[[i,t+1]]||l)[2])/20,r&&(c[u]=[i,t,r],s.splice(h,1),y=!0);if(!y)throw"findEmpties iterated with no new neighbors";for(u in c)f[u]=c[u],a.push(c[u])}return a.sort(function(n,t){return t[2]-n[2]})}function h(n,t,i){for(var c=0,p,r,u,a,w,b,f,e,v,y,o,h,l=0;l<t.length;l++){for(p=t[l],r=p[0],u=p[1],y=n[r][u],v=0,e=0,a=0;a<4;a++)(w=s[a],b=n[r+w[0]],b)&&(f=b[u+w[1]],f!==undefined&&(v===0?o=h=f:(o=Math.min(o,f),h=Math.max(h,f)),e++,v+=f));if(e===0)throw"iterateInterp2d order is wrong: no defined neighbors";n[r][u]=v/e;y===undefined?e<4&&(c=1):(n[r][u]=(1+i)*n[r][u]-i*y,h>o&&(c=Math.max(c,Math.abs(n[r][u]-y)/(h-o))))}return c}var c=n("fast-isnumeric"),i=n("../../registry"),e=n("../../lib"),r=n("../../plots/cartesian/axes"),l=n("../histogram2d/calc"),a=n("../../components/colorscale/calc"),v=n("./has_columns"),y=n("./convert_column_xyz"),o=n("./max_row_length"),f,s;t.exports=function(n,t){function ot(n){et=t._input.zsmooth=t.zsmooth=!1;e.notifier("cannot fast-zsmooth: "+n)}var d=r.getFromId(n,t.xaxis||"x"),g=r.getFromId(n,t.yaxis||"y"),ft=i.traceIs(t,"contour"),lt=i.traceIs(t,"histogram"),dt=i.traceIs(t,"gl2d"),et=ft?"best":t.zsmooth,f,nt,tt,s,it,rt,c,h,w,st,at,ht,vt,ut,ct;if(d._minDtick=0,g._minDtick=0,lt?(w=l(n,t),f=w.x,nt=w.x0,tt=w.dx,s=w.y,it=w.y0,rt=w.dy,c=w.z):(v(t)&&y(t,d,g),f=t.x?d.makeCalcdata(t,"x"):[],s=t.y?g.makeCalcdata(t,"y"):[],nt=t.x0||0,tt=t.dx||1,it=t.y0||0,rt=t.dy||1,c=p(t),(ft||t.connectgaps)&&(t._emptypoints=k(c),t._interpz=b(c,t._emptypoints,t._interpz))),et==="fast")if(d.type==="log"||g.type==="log")ot("log axis found");else if(!lt){if(f.length)for(st=(f[f.length-1]-f[0])/(f.length-1),at=Math.abs(st/100),h=0;h<f.length-1;h++)if(Math.abs(f[h+1]-f[h]-st)>at){ot("x scale is not linear");break}if(s.length&&et==="fast")for(ht=(s[s.length-1]-s[0])/(s.length-1),vt=Math.abs(ht/100),h=0;h<s.length-1;h++)if(Math.abs(s[h+1]-s[h]-ht)>vt){ot("y scale is not linear");break}}var yt=o(c),pt=t.xtype==="scaled"?"":t.x,wt=u(t,pt,nt,tt,yt,d),bt=t.ytype==="scaled"?"":t.y,kt=u(t,bt,it,rt,c.length,g);return dt||(r.expand(d,wt),r.expand(g,kt)),ut={x:wt,y:kt,z:c},a(t,c,"","z"),ft&&t.contours&&t.contours.coloring==="heatmap"&&(ct=t.type==="contour"?"heatmap":"histogram2d",ut.xfill=u(ct,pt,nt,tt,yt,d),ut.yfill=u(ct,bt,it,rt,c.length,g)),[ut]};f=.01;s=[[-1,0],[1,0],[0,-1],[0,1]]},{"../../components/colorscale/calc":589,"../../lib":681,"../../plots/cartesian/axes":710,"../../registry":784,"../histogram2d/calc":855,"./convert_column_xyz":837,"./has_columns":839,"./max_row_length":842,"fast-isnumeric":133}],836:[function(n,t){"use strict";var u=n("d3"),i=n("fast-isnumeric"),r=n("../../lib"),f=n("../../plots/plots"),e=n("../../components/colorscale/get_scale"),o=n("../../components/colorbar/draw");t.exports=function(n,t){var s=t[0].trace,l="cb"+s.uid,a=e(s.colorscale),h=s.zmin,c=s.zmax,v;if(i(h)||(h=r.aggNums(Math.min,null,s.z)),i(c)||(c=r.aggNums(Math.max,null,s.z)),n._fullLayout._infolayer.selectAll("."+l).remove(),!s.showscale){f.autoMargin(n,l);return}v=t[0].t.cb=o(n,l);v.fillcolor(u.scale.linear().domain(a.map(function(n){return h+n[0]*(c-h)})).range(a.map(function(n){return n[1]}))).filllevels({start:h,end:c,size:(c-h)/254}).options(s.colorbar)()}},{"../../components/colorbar/draw":585,"../../components/colorscale/get_scale":594,"../../lib":681,"../../plots/plots":769,d3:129,"fast-isnumeric":133}],837:[function(n,t){"use strict";var i=n("../../lib");t.exports=function(n,t,r){var f=n.x.slice(),e=n.y.slice(),p=n.z,c=n.text,o=Math.min(f.length,e.length,p.length),l=c!==undefined&&!Array.isArray(c[0]),u;for(o<f.length&&(f=f.slice(0,o)),o<e.length&&(e=e.slice(0,o)),u=0;u<o;u++)f[u]=t.d2c(f[u]),e[u]=r.d2c(e[u]);var w=i.distinctVals(f),s=w.vals,b=i.distinctVals(e),h=b.vals,k=i.init2dArray(h.length,s.length),a,v,y;for(l&&(y=i.init2dArray(h.length,s.length)),u=0;u<o;u++)a=i.findBin(f[u]+w.minDiff/2,s),v=i.findBin(e[u]+b.minDiff/2,h),k[v][a]=p[u],l&&(y[v][a]=c[u]);n.x=s;n.y=h;n.z=k;l&&(n.text=y)}},{"../../lib":681}],838:[function(n,t){"use strict";var i=n("../../lib"),r=n("./has_columns"),u=n("./xyz_defaults"),f=n("../../components/colorscale/defaults"),e=n("./attributes");t.exports=function(n,t,o,s){function h(r,u){return i.coerce(n,t,e,r,u)}var l=u(n,t,h),c;if(!l){t.visible=!1;return}h("text");c=h("zsmooth");c===!1&&(h("xgap"),h("ygap"));h("connectgaps",r(t)&&t.zsmooth!==!1);f(n,t,s,h,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":592,"../../lib":681,"./attributes":834,"./has_columns":839,"./xyz_defaults":845}],839:[function(n,t){"use strict";t.exports=function(n){return!Array.isArray(n.z[0])}},{}],840:[function(n,t){"use strict";var u=n("../../plots/cartesian/graph_interact"),i=n("../../lib"),r=n("../../plots/cartesian/constants").MAXDIST;t.exports=function(n,t,f,e,o){var a,rt,ot;if(!(n.distance<r)){var v=n.cd[0],w=v.trace,ut=n.xa,ft=n.ya,s=v.x,h=v.y,nt=v.z,et=v.zmask,y=s,p=h,tt,it,l,c;if(n.index!==!1){try{l=Math.round(n.index[1]);c=Math.round(n.index[0])}catch(st){i.error("Error hovering on heatmap, pointNumber must be [row,col], found:",n.index);return}if(l<0||l>=nt[0].length||c<0||c>nt.length)return}else{if(u.inbox(t-s[0],t-s[s.length-1])>r||u.inbox(f-h[0],f-h[h.length-1])>r)return;if(o){for(y=[2*s[0]-s[1]],a=1;a<s.length;a++)y.push((s[a]+s[a-1])/2);for(y.push([2*s[s.length-1]-s[s.length-2]]),p=[2*h[0]-h[1]],a=1;a<h.length;a++)p.push((h[a]+h[a-1])/2);p.push([2*h[h.length-1]-h[h.length-2]])}l=Math.max(0,Math.min(y.length-2,i.findBin(t,y)));c=Math.max(0,Math.min(p.length-2,i.findBin(f,p)))}var b=ut.c2p(s[l]),k=ut.c2p(s[l+1]),d=ft.c2p(h[c]),g=ft.c2p(h[c+1]);return o?(k=b,tt=s[l],g=d,it=h[c]):(tt=(s[l]+s[l+1])/2,it=(h[c]+h[c+1])/2,w.zsmooth&&(b=k=(b+k)/2,d=g=(d+g)/2)),rt=nt[c][l],et&&!et[c][l]&&(rt=undefined),Array.isArray(w.text)&&Array.isArray(w.text[c])&&(ot=w.text[c][l]),[i.extendFlat(n,{index:[c,l],distance:r+10,x0:b,x1:k,y0:d,y1:g,xLabelVal:tt,yLabelVal:it,zLabelVal:rt,text:ot})]}}},{"../../lib":681,"../../plots/cartesian/constants":715,"../../plots/cartesian/graph_interact":717}],841:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("./calc");i.plot=n("./plot");i.colorbar=n("./colorbar");i.style=n("./style");i.hoverPoints=n("./hover");i.moduleType="trace";i.name="heatmap";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","2dMap"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"./attributes":834,"./calc":835,"./colorbar":836,"./defaults":838,"./hover":840,"./plot":843,"./style":844}],842:[function(n,t){"use strict";t.exports=function(n){for(var t=0,i=0;i<n.length;i++)t=Math.max(t,n[i].length);return t}},{}],843:[function(n,t){"use strict";function h(n,t,h){function gi(n,t){var f=t.length-2,e=i.constrain(i.findBin(n,t),0,f),s=t[e],h=t[e+1],u=i.constrain(e+(n-s)/(h-s)-.5,0,f),r=Math.round(u),o=Math.abs(u-r);return!u||u===f||!o?{bin0:r,bin1:r,frac:0}:{bin0:r,frac:o,bin1:Math.round(r+o/(u-r))}}function ar(n,t,i,r,u,f,e,o,s){var h={x0:t,x1:i,y0:r,y1:u},c=n.xgap*2/3,l=n.ygap*2/3,a=n.xgap/3,v=n.ygap/3;return o===s-1&&(h.y1=u-l),f===e-1&&(h.x0=t+c),o===0&&(h.y0=r+l),f===0&&(h.x1=i-c),f>0&&f<e-1&&(h.x0=t+a,h.x1=i-a),o>0&&o<s-1&&(h.y0=r+v,h.y1=u-v),h}function ti(n,t){if(n!==undefined){var i=di((n-pi)/(hr-pi));return i[0]=Math.round(i[0]),i[1]=Math.round(i[1]),i[2]=Math.round(i[2]),ot+=t,kt+=i[0]*t,dt+=i[1]*t,gt+=i[2]*t,i}return[0,0,0,0]}function ir(n,t,i){n[t]=i[0];n[t+1]=i[1];n[t+2]=i[2];n[t+3]=Math.round(i[3]*255)}function vr(n,t,i,r){var u=n[i.bin0];if(u===undefined)return ti(undefined,1);var o=n[i.bin1],f=t[i.bin0],e=t[i.bin1],h=o-u||0,c=f-u||0,s;return s=o===undefined?e===undefined?0:f===undefined?2*(e-u):(2*e-f-u)*2/3:e===undefined?f===undefined?0:(2*u-o-f)*2/3:f===undefined?(2*e-o-u)*2/3:e+u-o-f,ti(u+i.frac*h+r.frac*(c+i.frac*s))}var d=h[0].trace,fi=d.uid,rt=t.xaxis,ut=t.yaxis,ei=n._fullLayout,oi="hm"+fi,ct,li,ai,lt,at,di,vt,yt,pt,ii,yi,sr,ui;if(ei._paper.selectAll(".contour"+fi).remove(),d.visible!==!0){ei._paper.selectAll("."+oi).remove();ei._infolayer.selectAll(".cb"+fi).remove();return}for(var ft=h[0].z,pi=d.zmin,hr=d.zmax,wi=e(d.colorscale),b=h[0].x,k=h[0].y,bi=f.traceIs(d,"contour"),et=bi?"best":d.zsmooth,ht=ft.length,wt=s(ft),si=!1,v,g,bt,hi=!1,y,nt,c=0;v===undefined&&c<b.length-1;)v=rt.c2p(b[c]),c++;for(c=b.length-1;g===undefined&&c>0;)g=rt.c2p(b[c]),c--;for(g<v&&(bt=g,g=v,v=bt,si=!0),c=0;y===undefined&&c<k.length-1;)y=ut.c2p(k[c]),c++;for(c=k.length-1;nt===undefined&&c>0;)nt=ut.c2p(k[c]),c--;nt<y&&(bt=y,y=nt,nt=bt,hi=!0);bi&&(b=h[0].xfill,k=h[0].yfill);et!=="fast"&&(ct=et==="best"?0:.5,v=Math.max(-ct*rt._length,v),g=Math.min((1+ct)*rt._length,g),y=Math.max(-ct*ut._length,y),nt=Math.min((1+ct)*ut._length,nt));var p=Math.round(g-v),tt=Math.round(nt-y),ki=p<=0||tt<=0,ci=t.plot.select(".imagelayer").selectAll("g.hm."+oi).data(ki?[]:[0]);if(ci.enter().append("g").classed("hm",!0).classed(oi,!0),ci.exit().remove(),!ki){et==="fast"?(li=wt,ai=ht):(li=p,ai=tt);lt=document.createElement("canvas");lt.width=li;lt.height=ai;at=lt.getContext("2d");di=u.scale.linear().domain(wi.map(function(n){return n[0]})).range(wi.map(function(n){var t=r(n[1]).toRgb();return[t.r,t.g,t.b,t.a]})).clamp(!0);et==="fast"?(vt=si?function(n){return wt-1-n}:i.identity,yt=hi?function(n){return ht-1-n}:i.identity):(vt=function(n){return i.constrain(Math.round(rt.c2p(b[n])-v),0,p)},yt=function(n){return i.constrain(Math.round(ut.c2p(k[n])-y),0,tt)});var nr=yt(0),a=[nr,nr],cr=si?0:1,lr=hi?0:1,ot=0,kt=0,dt=0,gt=0,it,w,l,vi,tr,ni,st;if(et){if(pt=0,ii=new Uint8Array(p*tt*4),et==="best"){var rr=new Array(b.length),ur=new Array(k.length),fr=new Array(p),ri,er,or;for(c=0;c<b.length;c++)rr[c]=Math.round(rt.c2p(b[c])-v);for(c=0;c<k.length;c++)ur[c]=Math.round(ut.c2p(k[c])-y);for(c=0;c<p;c++)fr[c]=gi(c,rr);for(l=0;l<tt;l++)for(ri=gi(l,ur),er=ft[ri.bin0],or=ft[ri.bin1],c=0;c<p;c++,pt+=4)st=vr(er,or,fr[c],ri),ir(ii,pt,st)}else for(l=0;l<ht;l++)for(ni=ft[l],a=yt(l),c=0;c<p;c++)st=ti(ni[c],1),pt=(a*p+vt(c))*4,ir(ii,pt,st);yi=at.createImageData(p,tt);yi.data.set(ii);at.putImageData(yi,0,0)}else for(l=0;l<ht;l++)if(ni=ft[l],a.reverse(),a[lr]=yt(l+1),a[0]!==a[1]&&a[0]!==undefined&&a[1]!==undefined)for(vi=vt(0),w=[vi,vi],c=0;c<wt;c++)(w.reverse(),w[cr]=vt(c+1),w[0]!==w[1]&&w[0]!==undefined&&w[1]!==undefined)&&(tr=ni[c],st=ti(tr,(w[1]-w[0])*(a[1]-a[0])),at.fillStyle="rgba("+st.join(",")+")",it=ar(d,w[0],w[1],a[0],a[1],c,wt,l,ht),at.fillRect(it.x0,it.y0,it.x1-it.x0,it.y1-it.y0));kt=Math.round(kt/ot);dt=Math.round(dt/ot);gt=Math.round(gt/ot);sr=r("rgb("+kt+","+dt+","+gt+")");n._hmpixcount=(n._hmpixcount||0)+ot;n._hmlumcount=(n._hmlumcount||0)+ot*sr.getLuminance();ui=ci.selectAll("image").data(h);ui.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"});ui.attr({height:tt,width:p,x:v,y:y,"xlink:href":lt.toDataURL("image/png")});ui.exit().remove()}}var u=n("d3"),r=n("tinycolor2"),f=n("../../registry"),i=n("../../lib"),e=n("../../components/colorscale/get_scale"),o=n("../../constants/xmlns_namespaces"),s=n("./max_row_length");t.exports=function(n,t,i){for(var r=0;r<i.length;r++)h(n,t,i[r])}},{"../../components/colorscale/get_scale":594,"../../constants/xmlns_namespaces":666,"../../lib":681,"../../registry":784,"./max_row_length":842,d3:129,tinycolor2:546}],844:[function(n,t){"use strict";var i=n("d3");t.exports=function(n){i.select(n).selectAll(".hm image").style("opacity",function(n){return n.trace.opacity})}},{d3:129}],845:[function(n,t){"use strict";function i(n,t){var i=t(n),r=i?t(n+"type","array"):"scaled";return r==="scaled"&&(t(n+"0"),t("d"+n)),i}function f(n){for(var i,f=!0,e=!1,o=!1,t,u=0;u<n.length;u++){if(t=n[u],!Array.isArray(t)){f=!1;break}for(t.length>0&&(e=!0),i=0;i<t.length;i++)if(r(t[i])){o=!0;break}}return f&&e&&o}var r=n("fast-isnumeric"),u=n("./has_columns");t.exports=function(n,t,r){var e=r("z"),o,s;if(e===undefined||!e.length)return 0;if(u(n)){if(o=r("x"),s=r("y"),!o||!s)return 0}else{if(o=i("x",r),s=i("y",r),!f(e))return 0;r("transpose")}return t.z.length}},{"./has_columns":839,"fast-isnumeric":133}],846:[function(n,t){"use strict";function r(){return{start:{valType:"number",dflt:null},end:{valType:"number",dflt:null},size:{valType:"any",dflt:1}}}var i=n("../bar/attributes");t.exports={x:{valType:"data_array"},y:{valType:"data_array"},text:i.text,orientation:i.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:""},autobinx:{valType:"boolean",dflt:!0},nbinsx:{valType:"integer",min:0,dflt:0},xbins:r("x"),autobiny:{valType:"boolean",dflt:!0},nbinsy:{valType:"integer",min:0,dflt:0},ybins:r("y"),marker:i.marker,_nestedModules:{error_y:"ErrorBars",error_x:"ErrorBars","marker.colorbar":"Colorbar"},_deprecated:{bardir:i._deprecated.bardir}}},{"../bar/attributes":794}],847:[function(n,t){"use strict";t.exports=function(n,t){for(var u=n.length,r=0,i=0;i<u;i++)t[i]?(n[i]/=t[i],r+=n[i]):n[i]=null;return r}},{}],848:[function(n,t){"use strict";t.exports=function(n,t,i,r){return i("histnorm"),r.forEach(function(n){var t=i(n+"bins.start"),r=i(n+"bins.end"),u=i("autobin"+n,!(t&&r));u?i("nbins"+n):i(n+"bins.size")}),t}},{}],849:[function(n,t){"use strict";var i=n("fast-isnumeric");t.exports={count:function(n,t,i){return i[n]++,1},sum:function(n,t,r,u){var f=u[t];return i(f)?(f=Number(f),r[n]+=f,f):0},avg:function(n,t,r,u,f){var e=u[t];return i(e)&&(e=Number(e),r[n]+=e,f[n]++),0},min:function(n,t,r,u){var f=u[t];if(i(f))if(f=Number(f),i(r[n])){if(r[n]>f)return r[n]=f,f-r[n]}else return r[n]=f,f;return 0},max:function(n,t,r,u){var f=u[t];if(i(f))if(f=Number(f),i(r[n])){if(r[n]<f)return r[n]=f,f-r[n]}else return r[n]=f,f;return 0}}},{"fast-isnumeric":133}],850:[function(n,t){"use strict";var r=n("fast-isnumeric"),f=n("../../lib"),i=n("../../plots/cartesian/axes"),u=n("./bin_functions"),e=n("./norm_functions"),o=n("./average");t.exports=function(n,t){var lt;if(t.visible===!0){var a=[],h=[],s,tt=i.getFromId(n,t.orientation==="h"?t.yaxis||"y":t.xaxis||"x"),c=t.orientation==="h"?"y":"x",it={x:"y",y:"x"}[c],w=tt.makeCalcdata(t,c);t["autobin"+c]===!1&&c+"bins"in t||(t[c+"bins"]=i.autoBin(w,tt,t["nbins"+c]),t._input[c+"bins"]=t[c+"bins"]);var l=t[c+"bins"],rt=typeof l.size=="string",ut=rt?[]:l,y,ft,p,et=[],b=[],k=0,ot=t.histnorm,v=t.histfunc,yt=ot.indexOf("density")!==-1,pt=v==="max"||v==="min",wt=pt?null:0,st=u.count,ht=e[ot],d=!1,ct;for(Array.isArray(t[it])&&v!=="count"&&(ct=t[it],d=v==="avg",st=u[v]),s=l.start,ft=l.end+(l.start-i.tickIncrement(l.start,l.size))/1e6;s<ft&&a.length<5e3;)y=i.tickIncrement(s,l.size),a.push((s+y)/2),h.push(wt),rt&&ut.push(s),yt&&et.push(1/(y-s)),d&&b.push(0),s=y;for(lt=h.length,s=0;s<w.length;s++)p=f.findBin(w[s],ut),p>=0&&p<lt&&(k+=st(p,s,h,ct,b));d&&(k=o(h,b));ht&&ht(h,k,et);var g=Math.min(a.length,h.length),at=[],nt=0,vt=g-1;for(s=0;s<g;s++)if(h[s]){nt=s;break}for(s=g-1;s>nt;s--)if(h[s]){vt=s;break}for(s=nt;s<=vt;s++)r(a[s])&&r(h[s])&&at.push({p:a[s],s:h[s],b:0});return at}}},{"../../lib":681,"../../plots/cartesian/axes":710,"./average":847,"./bin_functions":849,"./norm_functions":853,"fast-isnumeric":133}],851:[function(n,t){"use strict";var u=n("../../lib"),i=n("../../components/color"),f=n("./bin_defaults"),e=n("../bar/style_defaults"),r=n("../../components/errorbars/defaults"),o=n("./attributes");t.exports=function(n,t,s,h){function c(i,r){return u.coerce(n,t,o,i,r)}var p=c("x"),w=c("y"),l,a,v,y;if(c("text"),l=c("orientation",w&&!p?"h":"v"),a=t[l==="v"?"x":"y"],!(a&&a.length)){t.visible=!1;return}v=t[l==="h"?"x":"y"];v&&c("histfunc");y=l==="h"?["y"]:["x"];f(n,t,c,y);e(n,t,c,s,h);r(n,t,i.defaultLine,{axis:"y"});r(n,t,i.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":582,"../../components/errorbars/defaults":610,"../../lib":681,"../bar/style_defaults":804,"./attributes":846,"./bin_defaults":848}],852:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.layoutAttributes=n("../bar/layout_attributes");i.supplyDefaults=n("./defaults");i.supplyLayoutDefaults=n("../bar/layout_defaults");i.calc=n("./calc");i.setPositions=n("../bar/set_positions");i.plot=n("../bar/plot");i.style=n("../bar/style");i.colorbar=n("../scatter/colorbar");i.hoverPoints=n("../bar/hover");i.moduleType="trace";i.name="histogram";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","bar","histogram","oriented","errorBarsOK","showLegend"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"../bar/hover":797,"../bar/layout_attributes":799,"../bar/layout_defaults":800,"../bar/plot":801,"../bar/set_positions":802,"../bar/style":803,"../scatter/colorbar":892,"./attributes":846,"./calc":850,"./defaults":851}],853:[function(n,t){"use strict";t.exports={percent:function(n,t){for(var r=n.length,u=100/t,i=0;i<r;i++)n[i]*=u},probability:function(n,t){for(var r=n.length,i=0;i<r;i++)n[i]/=t},density:function(n,t,i,r){var f=n.length,u;for(r=r||1,u=0;u<f;u++)n[u]*=i[u]*r},"probability density":function(n,t,i,r){var f=n.length,u;for(r&&(t/=r),u=0;u<f;u++)n[u]*=i[u]/t}}},{}],854:[function(n,t){"use strict";var i=n("../histogram/attributes"),r=n("../heatmap/attributes"),u=n("../../components/colorscale/attributes"),f=n("../../lib/extend").extendFlat;t.exports=f({},{x:i.x,y:i.y,z:{valType:"data_array"},marker:{color:{valType:"data_array"}},histnorm:i.histnorm,histfunc:i.histfunc,autobinx:i.autobinx,nbinsx:i.nbinsx,xbins:i.xbins,autobiny:i.autobiny,nbinsy:i.nbinsy,ybins:i.ybins,xgap:r.xgap,ygap:r.ygap,zsmooth:r.zsmooth,_nestedModules:{colorbar:"Colorbar"}},u,{autocolorscale:f({},u.autocolorscale,{dflt:!1})})},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../heatmap/attributes":834,"../histogram/attributes":846}],855:[function(n,t){"use strict";var r=n("../../lib"),i=n("../../plots/cartesian/axes"),u=n("../histogram/bin_functions"),f=n("../histogram/norm_functions"),e=n("../histogram/average");t.exports=function(n,t){var st=i.getFromId(n,t.xaxis||"x"),v=t.x?st.makeCalcdata(t,"x"):[],ht=i.getFromId(n,t.yaxis||"y"),y=t.y?ht.makeCalcdata(t,"y"):[],k,d,g,nt,c,o,p=Math.min(v.length,y.length),h,ut,ot,b;v.length>p&&v.splice(p,v.length-p);y.length>p&&y.splice(p,y.length-p);!t.autobinx&&"xbins"in t||(t.xbins=i.autoBin(v,st,t.nbinsx,"2d"),t.type==="histogram2dcontour"&&(t.xbins.start-=t.xbins.size,t.xbins.end+=t.xbins.size),t._input.xbins=t.xbins);!t.autobiny&&"ybins"in t||(t.ybins=i.autoBin(y,ht,t.nbinsy,"2d"),t.type==="histogram2dcontour"&&(t.ybins.start-=t.ybins.size,t.ybins.end+=t.ybins.size),t._input.ybins=t.ybins);c=[];var tt=[],ct=[],l=typeof t.xbins.size=="string"?[]:t.xbins,a=typeof t.xbins.size=="string"?[]:t.ybins,ft=0,it,s,et=[],lt=t.histnorm,w=t.histfunc,bt=lt.indexOf("density")!==-1,kt=w==="max"||w==="min",dt=kt?null:0,at=u.count,vt=f[lt],rt=!1,yt=[],pt=[],wt="z"in t?t.z:"marker"in t&&Array.isArray(t.marker.color)?t.marker.color:"";for(wt&&w!=="count"&&(rt=w==="avg",at=u[w]),h=t.xbins,ut=h.end+(h.start-i.tickIncrement(h.start,h.size))/1e6,o=h.start;o<ut;o=i.tickIncrement(o,h.size))tt.push(dt),Array.isArray(l)&&l.push(o),rt&&ct.push(0);for(Array.isArray(l)&&l.push(o),ot=tt.length,k=t.xbins.start,d=(o-k)/ot,k+=d/2,h=t.ybins,ut=h.end+(h.start-i.tickIncrement(h.start,h.size))/1e6,o=h.start;o<ut;o=i.tickIncrement(o,h.size))c.push(tt.concat()),Array.isArray(a)&&a.push(o),rt&&et.push(ct.concat());for(Array.isArray(a)&&a.push(o),b=c.length,g=t.ybins.start,nt=(o-g)/b,g+=nt/2,bt&&(yt=tt.map(function(n,t){return Array.isArray(l)?1/(l[t+1]-l[t]):1/d}),pt=c.map(function(n,t){return Array.isArray(a)?1/(a[t+1]-a[t]):1/nt})),o=0;o<p;o++)it=r.findBin(v[o],l),s=r.findBin(y[o],a),it>=0&&it<ot&&s>=0&&s<b&&(ft+=at(it,o,c[s],wt,et[s]));if(rt)for(s=0;s<b;s++)ft+=e(c[s],et[s]);if(vt)for(s=0;s<b;s++)vt(c[s],ft,yt,pt[s]);return{x:v,x0:k,dx:d,y:y,y0:g,dy:nt,z:c}}},{"../../lib":681,"../../plots/cartesian/axes":710,"../histogram/average":847,"../histogram/bin_functions":849,"../histogram/norm_functions":853}],856:[function(n,t){"use strict";var i=n("../../lib"),r=n("./sample_defaults"),u=n("../../components/colorscale/defaults"),f=n("./attributes");t.exports=function(n,t,e){function o(r,u){return i.coerce(n,t,f,r,u)}r(n,t,o);var s=o("zsmooth");s===!1&&(o("xgap"),o("ygap"));u(n,t,e,o,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":592,"../../lib":681,"./attributes":854,"./sample_defaults":858}],857:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("../heatmap/calc");i.plot=n("../heatmap/plot");i.colorbar=n("../heatmap/colorbar");i.style=n("../heatmap/style");i.hoverPoints=n("../heatmap/hover");i.moduleType="trace";i.name="histogram2d";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","2dMap","histogram"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"../heatmap/calc":835,"../heatmap/colorbar":836,"../heatmap/hover":840,"../heatmap/plot":843,"../heatmap/style":844,"./attributes":854,"./defaults":856}],858:[function(n,t){"use strict";var i=n("../histogram/bin_defaults");t.exports=function(n,t,r){var u=r("x"),f=r("y"),e,o;if(!(u&&u.length&&f&&f.length)){t.visible=!1;return}e=r("z")||r("marker.color");e&&r("histfunc");o=["x","y"];i(n,t,r,o)}},{"../histogram/bin_defaults":848}],859:[function(n,t){"use strict";var i=n("../histogram2d/attributes"),r=n("../contour/attributes"),u=n("../../components/colorscale/attributes"),f=n("../../lib/extend").extendFlat;t.exports=f({},{x:i.x,y:i.y,z:i.z,marker:i.marker,histnorm:i.histnorm,histfunc:i.histfunc,autobinx:i.autobinx,nbinsx:i.nbinsx,xbins:i.xbins,autobiny:i.autobiny,nbinsy:i.nbinsy,ybins:i.ybins,autocontour:r.autocontour,ncontours:r.ncontours,contours:r.contours,line:r.line,_nestedModules:{colorbar:"Colorbar"}},u)},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../contour/attributes":824,"../histogram2d/attributes":854}],860:[function(n,t){"use strict";var i=n("../../lib"),u=n("../histogram2d/sample_defaults"),f=n("../contour/style_defaults"),r=n("./attributes");t.exports=function(n,t,e,o){function s(u,f){return i.coerce(n,t,r,u,f)}u(n,t,s);var h=i.coerce2(n,t,r,"contours.start"),c=i.coerce2(n,t,r,"contours.end"),l=s("autocontour",!(h&&c));l?s("ncontours"):s("contours.size");f(n,t,s,o)}},{"../../lib":681,"../contour/style_defaults":833,"../histogram2d/sample_defaults":858,"./attributes":859}],861:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("../contour/calc");i.plot=n("../contour/plot");i.style=n("../contour/style");i.colorbar=n("../contour/colorbar");i.hoverPoints=n("../contour/hover");i.moduleType="trace";i.name="histogram2dcontour";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","2dMap","contour","histogram"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"../contour/calc":825,"../contour/colorbar":826,"../contour/hover":828,"../contour/plot":831,"../contour/style":832,"./attributes":859,"./defaults":860}],862:[function(n,t){"use strict";var u=n("../../components/colorscale/attributes"),i=n("../surface/attributes"),r=n("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},i:{valType:"data_array"},j:{valType:"data_array"},k:{valType:"data_array"},delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z"},alphahull:{valType:"number",dflt:-1},intensity:{valType:"data_array"},color:{valType:"color"},vertexcolor:{valType:"data_array"},facecolor:{valType:"data_array"},opacity:r({},i.opacity),flatshading:{valType:"boolean",dflt:!1},contour:{show:r({},i.contours.x.show,{}),color:r({},i.contours.x.color),width:r({},i.contours.x.width)},colorscale:u.colorscale,reversescale:u.reversescale,showscale:u.showscale,lightposition:{x:r({},i.lightposition.x,{dflt:1e5}),y:r({},i.lightposition.y,{dflt:1e5}),z:r({},i.lightposition.z,{dflt:0})},lighting:r({},{vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6}},i.lighting),_nestedModules:{colorbar:"Colorbar"}}},{"../../components/colorscale/attributes":588,"../../lib/extend":673,"../surface/attributes":945}],863:[function(n,t){"use strict";function u(n,t,i){this.scene=n;this.uid=i;this.mesh=t;this.name="";this.color="#fff";this.data=null;this.showContour=!1}function a(n){return n.map(function(n){var i=n[0],r=s(n[1]),t=r.toRgb();return{index:i,rgb:[t.r,t.g,t.b,1]}})}function f(n){return n.map(i)}function e(n,t,i){for(var u=new Array(n.length),r=0;r<n.length;++r)u[r]=[n[r],t[r],i[r]];return u}function v(n,t){var f=n.glplot.gl,i=o({gl:f}),r=new u(n,i,t.uid);return r.update(t),n.glplot.add(i),r}var o=n("gl-mesh3d"),s=n("tinycolor2"),h=n("delaunay-triangulate"),c=n("alpha-shape"),l=n("convex-hull"),i=n("../../lib/str2rgbarray"),r=u.prototype;r.handlePick=function(n){if(n.object===this.mesh){var t=n.data.index;return n.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]],!0}};r.update=function(n){function v(n,t,i){return t.map(function(t){return n.d2l(t)*i})}var o=this.scene,s=o.fullSceneLayout,r,u,y,t;this.data=n;r=e(v(s.xaxis,n.x,o.dataScale[0]),v(s.yaxis,n.y,o.dataScale[1]),v(s.zaxis,n.z,o.dataScale[2]));n.i&&n.j&&n.k?u=e(n.i,n.j,n.k):n.alphahull===0?u=l(r):n.alphahull>0?u=c(n.alphahull,r):(y=["x","y","z"].indexOf(n.delaunayaxis),u=h(r.map(function(n){return[n[(y+1)%3],n[(y+2)%3]]})));t={positions:r,cells:u,lightPosition:[n.lightposition.x,n.lightposition.y,n.lightposition.z],ambient:n.lighting.ambient,diffuse:n.lighting.diffuse,specular:n.lighting.specular,roughness:n.lighting.roughness,fresnel:n.lighting.fresnel,vertexNormalsEpsilon:n.lighting.vertexnormalsepsilon,faceNormalsEpsilon:n.lighting.facenormalsepsilon,opacity:n.opacity,contourEnable:n.contour.show,contourColor:i(n.contour.color).slice(0,3),contourWidth:n.contour.width,useFacetNormals:n.flatshading};n.intensity?(this.color="#fff",t.vertexIntensity=n.intensity,t.colormap=a(n.colorscale)):n.vertexcolor?(this.color=n.vertexcolors[0],t.vertexColors=f(n.vertexcolor)):n.facecolor?(this.color=n.facecolor[0],t.cellColors=f(n.facecolor)):(this.color=n.color,t.meshColor=i(n.color));this.mesh.update(t)};r.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};t.exports=v},{"../../lib/str2rgbarray":694,"alpha-shape":46,"convex-hull":118,"delaunay-triangulate":130,"gl-mesh3d":166,tinycolor2:546}],864:[function(n,t){"use strict";var i=n("../../lib"),r=n("../../components/colorbar/defaults"),u=n("./attributes");t.exports=function(n,t,f,e){function o(r,f){return i.coerce(n,t,u,r,f)}function s(n){var t=n.map(function(n){var t=o(n);return t&&Array.isArray(t)?t:null});return t.every(function(n){return n&&n.length===t[0].length})&&t}var c=s(["x","y","z"]),h=s(["i","j","k"]);if(!c){t.visible=!1;return}h&&h.forEach(function(n){for(var t=0;t<n.length;++t)n[t]|=0});["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(n){o(n)});"intensity"in n?(o("intensity"),o("showscale",!0)):(t.showscale=!1,"vertexcolor"in n?o("vertexcolor"):"facecolor"in n?o("facecolor"):o("color",f));t.reversescale&&(t.colorscale=t.colorscale.map(function(n){return[1-n[0],n[1]]}).reverse());t.showscale&&r(n,t,e)}},{"../../components/colorbar/defaults":584,"../../lib":681,"./attributes":862}],865:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../heatmap/colorbar");i.plot=n("./convert");i.moduleType="trace";i.name="mesh3d";i.basePlotModule=n("../../plots/gl3d");i.categories=["gl3d"];i.meta={};t.exports=i},{"../../plots/gl3d":748,"../heatmap/colorbar":836,"./attributes":862,"./convert":863,"./defaults":864}],866:[function(n,t){"use strict";var i=n("../../lib"),f=n("../scatter/attributes"),r=f.line,u={name:{valType:"string"},showlegend:{valType:"boolean",dflt:!0},line:{color:i.extendFlat({},r.color),width:i.extendFlat({},r.width),dash:i.extendFlat({},r.dash)}};t.exports={x:{valType:"data_array"},open:{valType:"data_array",dflt:[]},high:{valType:"data_array",dflt:[]},low:{valType:"data_array",dflt:[]},close:{valType:"data_array",dflt:[]},line:{width:i.extendFlat({},r.width,{}),dash:i.extendFlat({},r.dash,{})},increasing:i.extendDeep({},u,{line:{color:{dflt:"#3D9970"}}}),decreasing:i.extendDeep({},u,{line:{color:{dflt:"#FF4136"}}}),text:{valType:"string",dflt:"",arrayOk:!0},tickwidth:{valType:"number",min:0,max:.5,dflt:.3}}},{"../../lib":681,"../scatter/attributes":889}],867:[function(n,t){"use strict";function i(n,t,i,r){f(n,t,i,r);i(r+".line.color");i(r+".line.width",t.line.width);i(r+".line.dash",t.line.dash)}var r=n("../../lib"),u=n("./ohlc_defaults"),f=n("./direction_defaults"),e=n("./attributes"),o=n("./helpers");t.exports=function(n,t){function f(i,u){return r.coerce(n,t,e,i,u)}o.pushDummyTransformOpts(n,t);var s=u(n,t,f);if(s===0){t.visible=!1;return}f("line.width");f("line.dash");i(n,t,f,"increasing");i(n,t,f,"decreasing");f("text");f("tickwidth")}},{"../../lib":681,"./attributes":866,"./direction_defaults":868,"./helpers":869,"./ohlc_defaults":871}],868:[function(n,t){"use strict";t.exports=function(n,t,i,r){i(r+".showlegend");n.showlegend===!1&&(t[r].showlegend=!1);var u=t.name+" - "+r;i(r+".name",u)}},{}],869:[function(n,t,i){"use strict";var r=n("../../lib");i.pushDummyTransformOpts=function(n,t){var i={type:t.type,_ephemeral:!0};Array.isArray(n.transforms)?n.transforms.push(i):n.transforms=[i]};i.clearEphemeralTransformOpts=function(n){var t=n.transforms,i;if(Array.isArray(t)){for(i=0;i<t.length;i++)t[i]._ephemeral&&t.splice(i,1);t.length===0&&delete n.transforms}};i.copyOHLC=function(n,t){n.open&&(t.open=n.open);n.high&&(t.high=n.high);n.low&&(t.low=n.low);n.close&&(t.close=n.close)};i.makeTransform=function(n,t,i){var u=r.extendFlat([],n.transforms);return u[t.transformIndex]={type:n.type,direction:i,open:n.open,high:n.high,low:n.low,close:n.close},u};i.getFilterFn=function(n){switch(n){case"increasing":return function(n,t){return n<=t};case"decreasing":return function(n,t){return n>t}}};i.addRangeSlider=function(n){n.xaxis||(n.xaxis={});n.xaxis.rangeslider||(n.xaxis.rangeslider={})}},{"../../lib":681}],870:[function(n,t){"use strict";var i=n("../../plot_api/register");t.exports={moduleType:"trace",name:"ohlc",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","showLegend"],meta:{},attributes:n("./attributes"),supplyDefaults:n("./defaults")};i(n("../scatter"));i(n("./transform"))},{"../../plot_api/register":701,"../../plots/cartesian":718,"../scatter":899,"./attributes":866,"./defaults":867,"./transform":872}],871:[function(n,t){"use strict";t.exports=function(n,t,i){var r,u=i("x"),f=i("open"),e=i("high"),o=i("low"),s=i("close");return r=Math.min(f.length,e.length,o.length,s.length),u&&(r=Math.min(r,u.length),r<u.length&&(t.x=u.slice(0,r))),r<f.length&&(t.open=f.slice(0,r)),r<e.length&&(t.high=e.slice(0,r)),r<o.length&&(t.low=o.slice(0,r)),r<s.length&&(t.close=s.slice(0,r)),r}},{}],872:[function(n,t,i){"use strict";function f(n,t,i){var f={type:"scatter",mode:"lines",connectgaps:!1,visible:n.visible,opacity:n.opacity,xaxis:n.xaxis,yaxis:n.yaxis,hoverinfo:s(n),transforms:r.makeTransform(n,t,i)},u=n[i];return u&&e.extendFlat(f,{x:n.x||[0],y:[].concat(n.low).concat(n.high),text:n.text,name:u.name,showlegend:u.showlegend,line:u.line}),f}function s(n){var i=n.hoverinfo;if(i==="all")return"x+text+name";var t=i.split("+"),r=t.indexOf("y"),u=t.indexOf("text");return r!==-1&&(t.splice(r,1),u===-1&&t.push("text")),t.join("+")}function h(n,t,i){var r,f,u,e;if(n.length<2)return i;for(r=n.map(t.d2c),f=Math.abs(r[1]-r[0]),u=1;u<r.length-1;u++)e=Math.abs(r[u+1]-r[u]),f=Math.min(e,f);return f*i}var e=n("../../lib"),r=n("./helpers"),o=n("../../plots/cartesian/axes"),u=n("../../plots/cartesian/axis_ids");i.moduleType="transform";i.name="ohlc";i.attributes={};i.supplyDefaults=function(n,t,i,u){return r.clearEphemeralTransformOpts(u),r.copyOHLC(n,t),n};i.transform=function(n,t){for(var i,u=[],e=0;e<n.length;e++){if(i=n[e],i.type!=="ohlc"){u.push(i);continue}u.push(f(i,t,"increasing"),f(i,t,"decreasing"))}return r.addRangeSlider(t.layout),u};i.calcTransform=function(n,t,i){for(var it=i.direction,rt=r.getFilterFn(it),v=u.getFromTrace(n,t,"x"),e=u.getFromTrace(n,t,"y"),y=h(t.x,v,t._fullInput.tickwidth),s=t.open,p=t.high,w=t.low,l=t.close,a=t.text,ut=s.length,b=[],k=[],d=[],ft=t._fullInput.x?function(n){return v.d2c(t.x[n])}:function(n){return n},et=Array.isArray(a)?function(n){return a[n]||""}:function(){return a},ot=function(n){var t=ft(n);b.push(t-y,t,t,t,t,t+y,null)},st=function(n,t,i,r){k.push(n,n,t,i,r,r,null)},c=function(n,t){return o.tickText(n,n.c2l(t),"hover").text},g=t._fullInput.hoverinfo,nt=g.split("+"),tt=g==="all",ht=tt||nt.indexOf("y")!==-1,ct=tt||nt.indexOf("text")!==-1,lt=function(n,t,i,r,u){var o=[],f;ht&&(o.push("Open: "+c(e,t)),o.push("High: "+c(e,i)),o.push("Low: "+c(e,r)),o.push("Close: "+c(e,u)));ct&&o.push(et(n));f=o.join("<br>");d.push(f,f,f,f,f,f,null)},f=0;f<ut;f++)rt(s[f],l[f])&&(ot(f),st(s[f],p[f],w[f],l[f]),lt(f,s[f],p[f],w[f],l[f]));t.x=b;t.y=k;t.text=d}},{"../../lib":681,"../../plots/cartesian/axes":710,"../../plots/cartesian/axis_ids":712,"./helpers":869}],873:[function(n,t){"use strict";var u=n("../../components/color/attributes"),r=n("../../plots/font_attributes"),f=n("../../plots/attributes"),i=n("../../lib/extend").extendFlat;t.exports={labels:{valType:"data_array"},label0:{valType:"number",dflt:0},dlabel:{valType:"number",dflt:1},values:{valType:"data_array"},marker:{colors:{valType:"data_array"},line:{color:{valType:"color",dflt:u.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}}},text:{valType:"data_array"},scalegroup:{valType:"string",dflt:""},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"]},hoverinfo:i({},f.hoverinfo,{flags:["label","text","value","percent","name"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0},textfont:i({},r,{}),insidetextfont:i({},r,{}),outsidetextfont:i({},r,{}),domain:{x:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]},y:{valType:"info_array",items:[{valType:"number",min:0,max:1},{valType:"number",min:0,max:1}],dflt:[0,1]}},hole:{valType:"number",min:0,max:1,dflt:0},sort:{valType:"boolean",dflt:!0},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise"},rotation:{valType:"number",min:-360,max:360,dflt:0},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0}}},{"../../components/color/attributes":581,"../../lib/extend":673,"../../plots/attributes":708,"../../plots/font_attributes":729}],874:[function(n,t,i){"use strict";function u(n,t){for(var r,u,f=[],i=0;i<n.length;i++)r=n[i],u=r[0].trace,u._module===t&&u.visible===!0&&f.push(r);return f}var r=n("../../registry");i.name="pie";i.plot=function(n){var t=r.getModule("pie"),i=u(n.calcdata,t);i.length&&t.plot(n,i)};i.clean=function(n,t,i,r){var u=r._has&&r._has("pie"),f=t._has&&t._has("pie");u&&!f&&r._pielayer.selectAll("g.trace").remove()}},{"../../registry":784}],875:[function(n,t){"use strict";function o(n){var f,t;if(!i){for(f=u.defaults,i=f.slice(),t=0;t<f.length;t++)i.push(r(f[t]).lighten(20).toHexString());for(t=0;t<u.defaults.length;t++)i.push(r(f[t]).darken(20).toHexString())}return i[n%i.length]}var e=n("fast-isnumeric"),r=n("tinycolor2"),u=n("../../components/color"),f=n("./helpers"),i;t.exports=function(n,t){var w=t.values,b=t.labels,c=[],v=n._fullLayout,y=v._piecolormap,g={},nt=!1,k=0,it=v.hiddenlabels||[],i,a,s,l,d,h;if(t.dlabel)for(b=new Array(w.length),i=0;i<w.length;i++)b[i]=String(t.label0+i*t.dlabel);for(i=0;i<w.length;i++)if((a=w[i],e(a))&&(a=+a,!(a<0))){if(s=b[i],(s===undefined||s==="")&&(s=i),s=String(s),g[s]===undefined)g[s]=!0;else continue;l=r(t.marker.colors[i]);l.isValid()?(l=u.addOpacity(l,l.getAlpha()),y[s]||(y[s]=l)):y[s]?l=y[s]:(l=!1,nt=!0);d=it.indexOf(s)!==-1;d||(k+=a);c.push({v:a,label:s,color:l,i:i,hidden:d})}if(t.sort&&c.sort(function(n,t){return t.v-n.v}),nt)for(i=0;i<c.length;i++)h=c[i],h.color===!1&&(y[h.label]=h.color=o(v._piedefaultcolorcount),v._piedefaultcolorcount++);if(c[0]&&(c[0].vTotal=k),t.textinfo&&t.textinfo!=="none"){var rt=t.textinfo.indexOf("label")!==-1,ut=t.textinfo.indexOf("text")!==-1,ft=t.textinfo.indexOf("value")!==-1,et=t.textinfo.indexOf("percent")!==-1,tt=v.separators,p;for(i=0;i<c.length;i++)h=c[i],p=rt?[h.label]:[],ut&&t.text[h.i]&&p.push(t.text[h.i]),ft&&p.push(f.formatPieValue(h.v,tt)),et&&p.push(f.formatPiePercent(h.v/k,tt)),h.text=p.join("<br>")}return c}},{"../../components/color":582,"./helpers":877,"fast-isnumeric":133,tinycolor2:546}],876:[function(n,t){"use strict";var i=n("../../lib"),r=n("./attributes");t.exports=function(n,t,u,f){function e(u,f){return i.coerce(n,t,r,u,f)}var s=i.coerceFont,l=e("values"),a,v,y,p,h,c;if(!Array.isArray(l)||!l.length){t.visible=!1;return}if(a=e("labels"),Array.isArray(a)||(e("label0"),e("dlabel")),v=e("marker.line.width"),v&&e("marker.line.color"),y=e("marker.colors"),Array.isArray(y)||(t.marker.colors=[]),e("scalegroup"),p=e("text"),h=e("textinfo",Array.isArray(p)?"text+percent":"percent"),e("hoverinfo",f._dataLength===1?"label+text+value+percent":undefined),h&&h!=="none"){var o=e("textposition"),w=Array.isArray(o)||o==="auto",b=w||o==="inside",k=w||o==="outside";(b||k)&&(c=s(e,"textfont",f.font),b&&s(e,"insidetextfont",c),k&&s(e,"outsidetextfont",c))}e("domain.x");e("domain.y");e("hole");e("sort");e("direction");e("rotation");e("pull")}},{"../../lib":681,"./attributes":873}],877:[function(n,t,i){"use strict";var r=n("../../lib");i.formatPiePercent=function(n,t){var i=(n*100).toPrecision(3);return i.lastIndexOf(".")!==-1&&(i=i.replace(/[.]?0+$/,"")),r.numSeparate(i,t)+"%"};i.formatPieValue=function(n,t){var i=n.toPrecision(10);return i.lastIndexOf(".")!==-1&&(i=i.replace(/[.]?0+$/,"")),r.numSeparate(i,t)}},{"../../lib":681}],878:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.supplyLayoutDefaults=n("./layout_defaults");i.layoutAttributes=n("./layout_attributes");i.calc=n("./calc");i.plot=n("./plot");i.style=n("./style");i.styleOne=n("./style_one");i.moduleType="trace";i.name="pie";i.basePlotModule=n("./base_plot");i.categories=["pie","showLegend"];i.meta={};t.exports=i},{"./attributes":873,"./base_plot":874,"./calc":875,"./defaults":876,"./layout_attributes":879,"./layout_defaults":880,"./plot":881,"./style":882,"./style_one":883}],879:[function(n,t){"use strict";t.exports={hiddenlabels:{valType:"data_array"}}},{}],880:[function(n,t){"use strict";var i=n("../../lib"),r=n("./layout_attributes");t.exports=function(n,t){function u(u,f){return i.coerce(n,t,r,u,f)}u("hiddenlabels")}},{"../../lib":681,"./layout_attributes":879}],881:[function(n,t){"use strict";function l(n,t,i){var b=Math.sqrt(n.width*n.width+n.height*n.height),r=n.width/n.height,a=Math.PI*Math.min(t.v/i.vTotal,.5),f=1-i.trace.hole,v=e(t,i),u={scale:v*i.r*2/b,rCenter:1-v,rotate:0};if(u.scale>=1)return u;var s=r+1/(2*Math.tan(a)),h=i.r*Math.min(1/(Math.sqrt(s*s+.5)+s),f/(Math.sqrt(r*r+f/2)+r)),y={scale:h*2/n.height,rCenter:Math.cos(h/i.r)-h*r/i.r,rotate:(180/Math.PI*t.midangle+720)%180-90},o=1/r,c=o+1/(2*Math.tan(a)),l=i.r*Math.min(1/(Math.sqrt(c*c+.5)+c),f/(Math.sqrt(o*o+f/2)+o)),p={scale:l*2/n.width,rCenter:Math.cos(l/i.r)-l/r/i.r,rotate:(180/Math.PI*t.midangle+810)%180-90},w=p.scale>y.scale?p:y;return u.scale<1&&w.scale>u.scale?w:u}function e(n,t){if(n.v===t.vTotal&&!t.trace.hole)return 1;var i=Math.PI*Math.min(n.v/t.vTotal,.5);return Math.min(1/(1+1/Math.sin(i)),(1-t.trace.hole)/2)}function o(n,t){var i=t.pxmid[0],r=t.pxmid[1],u=n.width/2,f=n.height/2;return i<0&&(u*=-1),r<0&&(f*=-1),{scale:1,rCenter:1,rotate:0,x:u+Math.abs(f)*(u>0?1:-1)/2,y:f/(1+i*i/(r*r)),outside:!0}}function a(n,t){function w(n,t){return n.pxmid[1]-t.pxmid[1]}function b(n,t){return t.pxmid[1]-n.pxmid[1]}function k(n,i){i||(i={});var b=i.labelExtraY+(r?i.yLabelMax:i.yLabelMin),c=r?n.yLabelMin:n.yLabelMax,k=r?n.yLabelMax:n.yLabelMin,d=n.cyFinal+l(n.px0[1],n.px1[1]),f=b-c,v,o,u,y,w,s;if(f*e>0&&(n.labelExtraY=f),Array.isArray(t.pull))for(o=0;o<h.length;o++)(u=h[o],u===n||(t.pull[n.i]||0)>=t.pull[u.i]||0)||((n.pxmid[1]-u.pxmid[1])*e>0?(y=u.cyFinal+l(u.px0[1],u.px1[1]),f=y-c-n.labelExtraY,f*e>0&&(n.labelExtraY+=f)):(k+n.labelExtraY-d)*e>0&&(v=3*a*Math.abs(o-h.indexOf(n)),w=u.cxFinal+p(u.px0[0],u.px1[0]),s=w+v-(n.cxFinal+n.pxmid[0])-n.labelExtraX,s*a>0&&(n.labelExtraX+=s)))}for(var u,y,p,l,a,e,f,o,h,i,s,c,v,r=0;r<2;r++)for(y=r?w:b,l=r?Math.max:Math.min,e=r?1:-1,u=0;u<2;u++){for(p=u?Math.max:Math.min,a=u?1:-1,f=n[r][u],f.sort(y),o=n[1-r][u],h=o.concat(f),s=[],i=0;i<f.length;i++)f[i].yLabelMid!==undefined&&s.push(f[i]);for(c=!1,i=0;r&&i<o.length;i++)if(o[i].yLabelMid!==undefined){c=o[i];break}for(i=0;i<s.length;i++)v=i&&s[i-1],c&&!i&&(v=c),k(s[i],v)}}function v(n,t){for(var a,v,f,r,i,c,e,o=[],l,h,u=0;u<n.length;u++){if(r=n[u][0],i=r.trace,a=t.w*(i.domain.x[1]-i.domain.x[0]),v=t.h*(i.domain.y[1]-i.domain.y[0]),c=i.tiltaxis*Math.PI/180,e=i.pull,Array.isArray(e))for(e=0,f=0;f<i.pull.length;f++)i.pull[f]>e&&(e=i.pull[f]);r.r=Math.min(a/s(i.tilt,Math.sin(c),i.depth),v/s(i.tilt,Math.cos(c),i.depth))/(2+2*e);r.cx=t.l+t.w*(i.domain.x[1]+i.domain.x[0])/2;r.cy=t.t+t.h*(2-i.domain.y[1]-i.domain.y[0])/2;i.scalegroup&&o.indexOf(i.scalegroup)===-1&&o.push(i.scalegroup)}for(f=0;f<o.length;f++){for(h=Infinity,l=o[f],u=0;u<n.length;u++)r=n[u][0],r.trace.scalegroup===l&&(h=Math.min(h,r.r*r.r/r.vTotal));for(u=0;u<n.length;u++)r=n[u][0],r.trace.scalegroup===l&&(r.r=Math.sqrt(h*r.vTotal))}}function y(n){function p(n){var t=u.r*Math.sin(n),i=-u.r*Math.cos(n);return a?[t*(1-e*s*s)+i*y*e,t*y*e+i*(1-e*h*h),Math.sin(v)*(i*h-t*s)]:[t,i]}var u=n[0],o=u.trace,a=o.tilt,f,s,h,v,y,e,r=o.rotation*Math.PI/180,c=2*Math.PI/u.vTotal,w="px0",b="px1",t,i,l;if(o.direction==="counterclockwise"){for(t=0;t<n.length;t++)if(!n[t].hidden)break;if(t===n.length)return;r+=c*n[t].v;c*=-1;w="px1";b="px0"}for(a&&(v=a*Math.PI/180,f=o.tiltaxis*Math.PI/180,y=Math.sin(f)*Math.cos(f),e=1-Math.cos(v),s=Math.sin(f),h=Math.cos(f)),l=p(r),t=0;t<n.length;t++)(i=n[t],i.hidden)||(i[w]=l,r+=c*i.v/2,i.pxmid=p(r),i.midangle=r,r+=c*i.v/2,l=p(r),i[b]=l,i.largeArc=i.v>u.vTotal/2?1:0)}function s(n,t,i){if(!n)return 1;var r=Math.sin(n*Math.PI/180);return Math.max(.01,i*r*Math.abs(t)+2*Math.sqrt(1-r*r*t*t))}var i=n("d3"),r=n("../../plots/cartesian/graph_interact"),h=n("../../components/color"),u=n("../../components/drawing"),c=n("../../lib/svg_text_utils"),f=n("./helpers");t.exports=function(n,t){var p=n._fullLayout,s;v(t,p._size);s=p._pielayer.selectAll("g.trace").data(t);s.enter().append("g").attr({"stroke-linejoin":"round","class":"trace"});s.exit().remove();s.order();s.each(function(t){var b=i.select(this),v=t[0],s=v.trace,k=0,d=(s.depth||0)*v.r*Math.sin(k)/2,g=s.tiltaxis||0,nt=g*Math.PI/180,tt=[d*Math.sin(nt),d*Math.cos(nt)],it=v.r*Math.cos(k),w=b.selectAll("g.part").data(s.tilt?["top","sides"]:["top"]);w.enter().append("g").attr("class",function(n){return n+" part"});w.exit().remove();w.order();y(t);b.selectAll(".top").each(function(){var y=i.select(this).selectAll("g.slice").data(t),w,b;y.enter().append("g").classed("slice",!0);y.exit().remove();w=[[[],[]],[[],[]]];b=!1;y.each(function(h){function lt(t){var l=n._fullLayout,u=n._fullData[s.index],i=u.hoverinfo;if(i==="all"&&(i="label+text+value+percent+name"),!n._dragging&&l.hovermode!==!1&&i!=="none"&&i!=="skip"&&i){var c=e(h,v),a=y+h.pxmid[0]*(1-c),b=k+h.pxmid[1]*(1-c),w=p.separators,o=[];i.indexOf("label")!==-1&&o.push(h.label);u.text&&u.text[h.i]&&i.indexOf("text")!==-1&&o.push(u.text[h.i]);i.indexOf("value")!==-1&&o.push(f.formatPieValue(h.v,w));i.indexOf("percent")!==-1&&o.push(f.formatPiePercent(h.v/v.vTotal,w));r.loneHover({x0:a-c*v.r,x1:a+c*v.r,y:b,text:o.join("<br>"),name:i.indexOf("name")!==-1?u.name:undefined,color:h.color,idealAlign:h.pxmid[0]<0?"left":"right"},{container:l._hoverlayer.node(),outerContainer:l._paper.node()});r.hover(n,t,"pie");ot=!0}}function at(t){n.emit("plotly_unhover",{points:[t]});ot&&(r.loneUnhover(p._hoverlayer.node()),ot=!1)}function vt(){n._hoverdata=[h];n._hoverdata.trace=t.trace;r.click(n,{target:!0})}function d(n,t,i,r){return"a"+r*v.r+","+r*it+" "+g+" "+h.largeArc+(i?" 1 ":" 0 ")+r*(t[0]-n[0])+","+r*(t[1]-n[1])}var ft,a,st,ht,ct,rt,et;if(h.hidden){i.select(this).selectAll("path,g").remove();return}w[h.pxmid[1]<0?0:1][h.pxmid[0]<0?0:1].push(h);var y=v.cx+tt[0],k=v.cy+tt[1],ut=i.select(this),nt=ut.selectAll("path.surface").data([h]),ot=!1;nt.enter().append("path").classed("surface",!0).style({"pointer-events":"all"});ut.select("path.textline").remove();ut.on("mouseover",lt).on("mouseout",at).on("click",vt);s.pull&&(ft=+(Array.isArray(s.pull)?s.pull[h.i]:s.pull)||0,ft>0&&(y+=ft*h.pxmid[0],k+=ft*h.pxmid[1]));h.cxFinal=y;h.cyFinal=k;a=s.hole;h.v===v.vTotal?(st="M"+(y+h.px0[0])+","+(k+h.px0[1])+d(h.px0,h.pxmid,!0,1)+d(h.pxmid,h.px0,!0,1)+"Z",a?nt.attr("d","M"+(y+a*h.px0[0])+","+(k+a*h.px0[1])+d(h.px0,h.pxmid,!1,a)+d(h.pxmid,h.px0,!1,a)+"Z"+st):nt.attr("d",st)):(ht=d(h.px0,h.px1,!0,1),a?(ct=1-a,nt.attr("d","M"+(y+a*h.px1[0])+","+(k+a*h.px1[1])+d(h.px1,h.px0,!1,a)+"l"+ct*h.px0[0]+","+ct*h.px0[1]+ht+"Z")):nt.attr("d","M"+y+","+k+"l"+h.px0[0]+","+h.px0[1]+ht+"Z"));rt=Array.isArray(s.textposition)?s.textposition[h.i]:s.textposition;et=ut.selectAll("g.slicetext").data(h.text&&rt!=="none"?[0]:[]);et.enter().append("g").classed("slicetext",!0);et.exit().remove();et.each(function(){var r=i.select(this).selectAll("text").data([0]),t,n,e,f;r.enter().append("text").attr("data-notex",1);r.exit().remove();r.text(h.text).attr({"class":"slicetext",transform:"","data-bb":"","text-anchor":"middle",x:0,y:0}).call(u.font,rt==="outside"?s.outsidetextfont:s.insidetextfont).call(c.convertToTspans);r.selectAll("tspan.line").attr({x:0,y:0});t=u.bBox(r.node());rt==="outside"?n=o(t,h):(n=l(t,h,v),rt==="auto"&&n.scale<1&&(r.call(u.font,s.outsidetextfont),(s.outsidetextfont.family!==s.insidetextfont.family||s.outsidetextfont.size!==s.insidetextfont.size)&&(r.attr({"data-bb":""}),t=u.bBox(r.node())),n=o(t,h)));e=y+h.pxmid[0]*n.rCenter+(n.x||0);f=k+h.pxmid[1]*n.rCenter+(n.y||0);n.outside&&(h.yLabelMin=f-t.height/2,h.yLabelMid=f,h.yLabelMax=f+t.height/2,h.labelExtraX=0,h.labelExtraY=0,b=!0);r.attr("transform","translate("+e+","+f+")"+(n.scale<1?"scale("+n.scale+")":"")+(n.rotate?"rotate("+n.rotate+")":"")+"translate("+-(t.left+t.right)/2+","+-(t.top+t.bottom)/2+")")})});b&&a(w,s);y.each(function(n){var u,f,r,t;if(n.labelExtraX||n.labelExtraY){u=i.select(this);f=u.select("g.slicetext text");f.attr("transform","translate("+n.labelExtraX+","+n.labelExtraY+")"+f.attr("transform"));var c=n.cxFinal+n.pxmid[0],l=n.cyFinal+n.pxmid[1],e="M"+c+","+l,o=(n.yLabelMax-n.yLabelMin)*(n.pxmid[0]<0?-1:1)/4;n.labelExtraX?(r=n.labelExtraX*n.pxmid[1]/n.pxmid[0],t=n.yLabelMid+n.labelExtraY-(n.cyFinal+n.pxmid[1]),e+=Math.abs(r)>Math.abs(t)?"l"+t*n.pxmid[0]/n.pxmid[1]+","+t+"H"+(c+n.labelExtraX+o):"l"+n.labelExtraX+","+r+"v"+(t-r)+"h"+o):e+="V"+(n.yLabelMid+n.labelExtraY)+"h"+o;u.append("path").classed("textline",!0).call(h.stroke,s.outsidetextfont.color).attr({"stroke-width":Math.min(2,s.outsidetextfont.size/8),d:e,fill:"none"})}})})});setTimeout(function(){s.selectAll("tspan").each(function(){var n=i.select(this);n.attr("dy")&&n.attr("dy",n.attr("dy"))})},0)}},{"../../components/color":582,"../../components/drawing":605,"../../lib/svg_text_utils":695,"../../plots/cartesian/graph_interact":717,"./helpers":877,d3:129}],882:[function(n,t){"use strict";var i=n("d3"),r=n("./style_one");t.exports=function(n){n._fullLayout._pielayer.selectAll(".trace").each(function(n){var f=n[0],t=f.trace,u=i.select(this);u.style({opacity:t.opacity});u.selectAll(".top path.surface").each(function(n){i.select(this).call(r,n,t)})})}},{"./style_one":883,d3:129}],883:[function(n,t){"use strict";var i=n("../../components/color");t.exports=function(n,t,r){var f=r.marker.line.color,u;Array.isArray(f)&&(f=f[t.i]||i.defaultLine);u=r.marker.line.width||0;Array.isArray(u)&&(u=u[t.i]||0);n.style({"stroke-width":u,fill:t.color}).call(i.stroke,f)}},{"../../components/color":582}],884:[function(n,t){"use strict";var i=n("../scattergl/attributes");t.exports={x:i.x,y:i.y,xy:{valType:"data_array"},indices:{valType:"data_array"},xbounds:{valType:"data_array"},ybounds:{valType:"data_array"},text:i.text,marker:{color:{valType:"color",arrayOk:!1},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1},blend:{valType:"boolean",dflt:null},sizemin:{valType:"number",min:.1,max:2,dflt:.5},sizemax:{valType:"number",min:.1,dflt:20},border:{color:{valType:"color",arrayOk:!1},arearatio:{valType:"number",min:0,max:1,dflt:0}}}}},{"../scattergl/attributes":925}],885:[function(n,t){"use strict";function u(n,t){this.scene=n;this.uid=t;this.type="pointcloud";this.pickXData=[];this.pickYData=[];this.xData=[];this.yData=[];this.textLabels=[];this.color="rgb(0, 0, 0)";this.name="";this.hoverinfo="all";this.idToIndex=new Int32Array(0);this.bounds=[0,0,0,0];this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]};this.pointcloud=f(n.glplot,this.pointcloudOptions);this.pointcloud._trace=this}function s(n,t){var i=new u(n,t.uid);return i.update(t),i}var f=n("gl-pointcloud2d"),r=n("../../lib/str2rgbarray"),e=n("../scatter/get_trace_color"),o=["xaxis","yaxis"],i=u.prototype;i.handlePick=function(n){var t=this.idToIndex[n.pointId];return{trace:this,dataCoord:n.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}};i.update=function(n){this.textLabels=n.text;this.name=n.name;this.hoverinfo=n.hoverinfo;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.updateFast(n);this.color=e(n,{})};i.updateFast=function(n){var c=this.xData=this.pickXData=n.x,y=this.yData=this.pickYData=n.y,l=this.pickXYData=n.xy,g=n.xbounds&&n.ybounds,p=n.indices,e,o,s,t=this.bounds,u,f,i,h,a,d,v;if(l){if(s=l,e=l.length>>>1,g)t[0]=n.xbounds[0],t[2]=n.xbounds[1],t[1]=n.ybounds[0],t[3]=n.ybounds[1];else for(i=0;i<e;i++)u=s[i*2],f=s[i*2+1],u<t[0]&&(t[0]=u),u>t[2]&&(t[2]=u),f<t[1]&&(t[1]=f),f>t[3]&&(t[3]=f);if(p)o=p;else for(o=new Int32Array(e),i=0;i<e;i++)o[i]=i}else for(e=c.length,s=new Float32Array(2*e),o=new Int32Array(e),i=0;i<e;i++)u=c[i],f=y[i],o[i]=i,s[i*2]=u,s[i*2+1]=f,u<t[0]&&(t[0]=u),u>t[2]&&(t[2]=u),f<t[1]&&(t[1]=f),f>t[3]&&(t[3]=f);this.idToIndex=o;this.pointcloudOptions.idToIndex=o;this.pointcloudOptions.positions=s;var w=r(n.marker.color),b=r(n.marker.border.color),k=n.opacity*n.marker.opacity;w[3]*=k;this.pointcloudOptions.color=w;h=n.marker.blend;h===null&&(a=100,h=c.length<a||y.length<a);this.pointcloudOptions.blend=h;b[3]*=k;this.pointcloudOptions.borderColor=b;d=n.marker.sizemin;v=Math.max(n.marker.sizemax,n.marker.sizemin);this.pointcloudOptions.sizeMin=d;this.pointcloudOptions.sizeMax=v;this.pointcloudOptions.areaRatio=n.marker.border.arearatio;this.pointcloud.update(this.pointcloudOptions);this.expandAxesFast(t,v/2)};i.expandAxesFast=function(n,t){for(var e=t||.5,f,r,u,i=0;i<2;i++)f=this.scene[o[i]],r=f._min,r||(r=[]),r.push({val:n[i],pad:e}),u=f._max,u||(u=[]),u.push({val:n[i+2],pad:e})};i.dispose=function(){this.pointcloud.dispose()};t.exports=s},{"../../lib/str2rgbarray":694,"../scatter/get_trace_color":897,"gl-pointcloud2d":245}],886:[function(n,t){"use strict";var i=n("../../lib"),r=n("./attributes");t.exports=function(n,t,u){function f(u,f){return i.coerce(n,t,r,u,f)}f("x");f("y");f("xbounds");f("ybounds");n.xy&&n.xy instanceof Float32Array&&(t.xy=n.xy);n.indices&&n.indices instanceof Int32Array&&(t.indices=n.indices);f("text");f("marker.color",u);f("marker.opacity");f("marker.blend");f("marker.sizemin");f("marker.sizemax");f("marker.border.color",u);f("marker.border.arearatio")}},{"../../lib":681,"./attributes":884}],887:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.calc=n("../scatter3d/calc");i.plot=n("./convert");i.moduleType="trace";i.name="pointcloud";i.basePlotModule=n("../../plots/gl2d");i.categories=["gl2d","showLegend"];i.meta={};t.exports=i},{"../../plots/gl2d":745,"../scatter3d/calc":913,"./attributes":884,"./convert":885,"./defaults":886}],888:[function(n,t){"use strict";var i=n("../../lib");t.exports=function(n){var t=n[0].trace,r=t.marker,u;i.mergeArray(t.text,n,"tx");i.mergeArray(t.textposition,n,"tp");t.textfont&&(i.mergeArray(t.textfont.size,n,"ts"),i.mergeArray(t.textfont.color,n,"tc"),i.mergeArray(t.textfont.family,n,"tf"));r&&r.line&&(u=r.line,i.mergeArray(r.opacity,n,"mo"),i.mergeArray(r.symbol,n,"mx"),i.mergeArray(r.color,n,"mc"),i.mergeArray(u.color,n,"mlc"),i.mergeArray(u.width,n,"mlw"))}},{"../../lib":681}],889:[function(n,t){"use strict";var i=n("../../components/colorscale/color_attributes"),u=n("../../components/drawing"),f=n("./constants"),r=n("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array"},x0:{valType:"any",dflt:0},dx:{valType:"number",dflt:1},y:{valType:"data_array"},y0:{valType:"any",dflt:0},dy:{valType:"number",dflt:1},ids:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},hoveron:{valType:"flaglist",flags:["points","fills"]},line:{color:{valType:"color"},width:{valType:"number",min:0,dflt:2},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear"},smoothing:{valType:"number",min:0,max:1.3,dflt:1},dash:{valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid"},simplify:{valType:"boolean",dflt:!0}},connectgaps:{valType:"boolean",dflt:!1},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],dflt:"none"},fillcolor:{valType:"color"},marker:r({},{symbol:{valType:"enumerated",values:u.symbolList,dflt:"circle",arrayOk:!0},opacity:{valType:"number",min:0,max:1,arrayOk:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0},maxdisplayed:{valType:"number",min:0,dflt:0},sizeref:{valType:"number",dflt:1},sizemin:{valType:"number",min:0,dflt:0},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter"},showscale:{valType:"boolean",dflt:!1},line:r({},{width:{valType:"number",min:0,arrayOk:!0}},i("marker.line"))},i("marker")),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0},textfont:{family:{valType:"string",noBlank:!0,strict:!0,arrayOk:!0},size:{valType:"number",min:1,arrayOk:!0},color:{valType:"color",arrayOk:!0}},r:{valType:"data_array"},t:{valType:"data_array"},_nestedModules:{error_y:"ErrorBars",error_x:"ErrorBars","marker.colorbar":"Colorbar"}}},{"../../components/colorscale/color_attributes":590,"../../components/drawing":605,"../../lib/extend":673,"./constants":894}],890:[function(n,t){"use strict";var u=n("fast-isnumeric"),i=n("../../plots/cartesian/axes"),f=n("../../lib"),r=n("./subtypes"),e=n("./colorscale_calc");t.exports=function(n,t){var p=i.getFromId(n,t.xaxis||"x"),w=i.getFromId(n,t.yaxis||"y"),s=p.makeCalcdata(t,"x"),h=w.makeCalcdata(t,"y"),o=Math.min(s.length,h.length),g,c,l,a,v,b,k,d,y;for(p._minDtick=0,w._minDtick=0,s.length>o&&s.splice(o,s.length-o),h.length>o&&h.splice(o,h.length-o),a={padded:!0},v={padded:!0},r.hasMarkers(t)&&(g=t.marker,c=g.size,Array.isArray(c)&&(b={type:"linear"},i.setConvert(b),c=b.makeCalcdata(t.marker,"size"),c.length>o&&c.splice(o,c.length-o)),k=1.6*(t.marker.sizeref||1),d=t.marker.sizemode==="area"?function(n){return Math.max(Math.sqrt((n||0)/k),3)}:function(n){return Math.max((n||0)/k,3)},a.ppad=v.ppad=Array.isArray(c)?c.map(d):d(c)),e(t),(t.fill==="tozerox"||t.fill==="tonextx"&&n.firstscatter)&&(s[0]!==s[o-1]||h[0]!==h[o-1])?a.tozero=!0:t.error_y.visible||["tonexty","tozeroy"].indexOf(t.fill)===-1&&(r.hasMarkers(t)||r.hasText(t))||(a.padded=!1,a.ppad=0),(t.fill==="tozeroy"||t.fill==="tonexty"&&n.firstscatter)&&(s[0]!==s[o-1]||h[0]!==h[o-1])?v.tozero=!0:["tonextx","tozerox"].indexOf(t.fill)!==-1&&(v.padded=!1),i.expand(p,s,a),i.expand(w,h,v),y=new Array(o),l=0;l<o;l++)y[l]=u(s[l])&&u(h[l])?{x:s[l],y:h[l]}:{x:!1,y:!1},t.ids&&(y[l].id=String(t.ids[l]));return typeof c!="undefined"&&f.mergeArray(c,y,"ms"),n.firstscatter=!1,y}},{"../../lib":681,"../../plots/cartesian/axes":710,"./colorscale_calc":893,"./subtypes":909,"fast-isnumeric":133}],891:[function(n,t){"use strict";t.exports=function(n){for(var t,r,f,u,i=0;i<n.length;i++)if((t=n[i],t.type==="scatter")&&(r=t.fill,r!=="none"&&r!=="toself")&&(t.opacity=undefined,r==="tonexty"||r==="tonextx"))for(f=i-1;f>=0;f--)if(u=n[f],u.type==="scatter"&&u.xaxis===t.xaxis&&u.yaxis===t.yaxis){u.opacity=undefined;break}}},{}],892:[function(n,t){"use strict";var u=n("d3"),i=n("fast-isnumeric"),r=n("../../lib"),f=n("../../plots/plots"),e=n("../../components/colorscale/get_scale"),o=n("../../components/colorbar/draw");t.exports=function(n,t){var a=t[0].trace,s=a.marker,l="cb"+a.uid,p;if(n._fullLayout._infolayer.selectAll("."+l).remove(),s===undefined||!s.showscale){f.autoMargin(n,l);return}var v=e(s.colorscale),y=s.color,h=s.cmin,c=s.cmax;i(h)||(h=r.aggNums(Math.min,null,y));i(c)||(c=r.aggNums(Math.max,null,y));p=t[0].t.cb=o(n,l);p.fillcolor(u.scale.linear().domain(v.map(function(n){return h+n[0]*(c-h)})).range(v.map(function(n){return n[1]}))).filllevels({start:h,end:c,size:(c-h)/254}).options(s.colorbar)()}},{"../../components/colorbar/draw":585,"../../components/colorscale/get_scale":594,"../../lib":681,"../../plots/plots":769,d3:129,"fast-isnumeric":133}],893:[function(n,t){"use strict";var i=n("../../components/colorscale/has_colorscale"),r=n("../../components/colorscale/calc"),u=n("./subtypes");t.exports=function(n){u.hasLines(n)&&i(n,"line")&&r(n,n.line.color,"line","c");u.hasMarkers(n)&&(i(n,"marker")&&r(n,n.marker.color,"marker","c"),i(n,"marker.line")&&r(n,n.marker.line.color,"marker.line","c"))}},{"../../components/colorscale/calc":589,"../../components/colorscale/has_colorscale":595,"./subtypes":909}],894:[function(n,t){"use strict";t.exports={PTS_LINESONLY:20}},{}],895:[function(n,t){"use strict";var f=n("../../lib"),e=n("./attributes"),o=n("./constants"),i=n("./subtypes"),s=n("./xy_defaults"),h=n("./marker_defaults"),c=n("./line_defaults"),r=n("./line_shape_defaults"),l=n("./text_defaults"),a=n("./fillcolor_defaults"),u=n("../../components/errorbars/defaults");t.exports=function(n,t,v,y){function p(i,r){return f.coerce(n,t,e,i,r)}var b=s(n,t,p),k=b<o.PTS_LINESONLY?"lines+markers":"lines",w;if(!b){t.visible=!1;return}p("text");p("mode",k);p("ids");i.hasLines(t)&&(c(n,t,v,y,p),r(n,t,p),p("connectgaps"),p("line.simplify"));i.hasMarkers(t)&&h(n,t,v,y,p);i.hasText(t)&&l(n,t,y,p);w=[];(i.hasMarkers(t)||i.hasText(t))&&(p("marker.maxdisplayed"),w.push("points"));p("fill");t.fill!=="none"&&(a(n,t,v,p),i.hasLines(t)||r(n,t,p));(t.fill==="tonext"||t.fill==="toself")&&w.push("fills");p("hoveron",w.join("+")||"points");u(n,t,v,{axis:"y"});u(n,t,v,{axis:"x",inherit:"y"})}},{"../../components/errorbars/defaults":610,"../../lib":681,"./attributes":889,"./constants":894,"./fillcolor_defaults":896,"./line_defaults":900,"./line_shape_defaults":902,"./marker_defaults":905,"./subtypes":909,"./text_defaults":910,"./xy_defaults":911}],896:[function(n,t){"use strict";var i=n("../../components/color");t.exports=function(n,t,r,u){var o=!1,f,e;t.marker&&(f=t.marker.color,e=(t.marker.line||{}).color,f&&!Array.isArray(f)?o=f:e&&!Array.isArray(e)&&(o=e));u("fillcolor",i.addOpacity((t.line||{}).color||o||r,.5))}},{"../../components/color":582}],897:[function(n,t){"use strict";var i=n("../../components/color"),r=n("./subtypes");t.exports=function(n,t){var u,f,e,o;return n.mode==="lines"?(u=n.line.color,u&&i.opacity(u)?u:n.fillcolor):n.mode==="none"?n.fill?n.fillcolor:"":(e=t.mcc||(n.marker||{}).color,o=t.mlcc||((n.marker||{}).line||{}).color,f=e&&i.opacity(e)?e:o&&i.opacity(o)&&(t.mlw||((n.marker||{}).line||{}).width)?o:"",f?i.opacity(f)<.3?i.addOpacity(f,.3):f:(u=(n.line||{}).color,u&&i.opacity(u)&&r.hasLines(n)&&n.line.width?u:n.fillcolor))}},{"../../components/color":582,"./subtypes":909}],898:[function(n,t){"use strict";var r=n("../../lib"),u=n("../../plots/cartesian/graph_interact"),f=n("../../plots/cartesian/constants"),e=n("../../components/errorbars"),o=n("./get_trace_color"),i=n("../../components/color");t.exports=function(n,t,s,h){var ft=n.cd,c=ft[0].trace,w=n.xa,b=n.ya,et=w.c2p(t),ot=b.c2p(s),bt=[et,ot],p,ut;if(c.hoveron.indexOf("points")!==-1){var kt=function(n){var t=Math.max(3,n.mrc||0);return Math.max(Math.abs(w.c2p(n.x)-et)-t,1-3/t)},dt=function(n){var t=Math.max(3,n.mrc||0);return Math.max(Math.abs(b.c2p(n.y)-ot)-t,1-3/t)},gt=function(n){var t=Math.max(3,n.mrc||0),i=w.c2p(n.x)-et,r=b.c2p(n.y)-ot;return Math.max(Math.sqrt(i*i+r*r)-t,1-3/t)},ni=u.getDistanceFunction(h,kt,dt,gt);if(u.getClosest(ft,ni,n),n.index!==!1){var l=ft[n.index],vt=w.c2p(l.x,!0),yt=b.c2p(l.y,!0),it=l.mrc||1;return r.extendFlat(n,{color:o(c,l),x0:vt-it,x1:vt+it,xLabelVal:l.x,y0:yt-it,y1:yt+it,yLabelVal:l.y}),l.tx?n.text=l.tx:c.text&&(n.text=c.text),e.hoverInfo(l,c,n),[n]}}if(c.hoveron.indexOf("fills")!==-1&&c._polygons){for(var pt=c._polygons,st=[],ht=!1,k=Infinity,d=-Infinity,g=Infinity,nt=-Infinity,v,tt,y,ct,lt,wt,rt,at,a=0;a<pt.length;a++)tt=pt[a],tt.contains(bt)&&(ht=!ht,st.push(tt),g=Math.min(g,tt.ymin),nt=Math.max(nt,tt.ymax));if(ht){for(g=Math.max(g,0),nt=Math.min(nt,b._length),p=(g+nt)/2,a=0;a<st.length;a++)for(y=st[a].pts,v=1;v<y.length;v++)rt=y[v-1][1],at=y[v][1],rt>p!=at>=p&&(lt=y[v-1][0],wt=y[v][0],ct=lt+(wt-lt)*(p-rt)/(at-rt),k=Math.min(k,ct),d=Math.max(d,ct));return k=Math.max(k,0),d=Math.min(d,w._length),ut=i.defaultLine,i.opacity(c.fillcolor)?ut=c.fillcolor:i.opacity((c.line||{}).color)&&(ut=c.line.color),r.extendFlat(n,{distance:f.MAXDIST+10,x0:k,x1:d,y0:p,y1:p,color:ut}),delete n.index,n.text=c.text&&!Array.isArray(c.text)?String(c.text):c.name,[n]}}}},{"../../components/color":582,"../../components/errorbars":611,"../../lib":681,"../../plots/cartesian/constants":715,"../../plots/cartesian/graph_interact":717,"./get_trace_color":897}],899:[function(n,t){"use strict";var i={},r=n("./subtypes");i.hasLines=r.hasLines;i.hasMarkers=r.hasMarkers;i.hasText=r.hasText;i.isBubble=r.isBubble;i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.cleanData=n("./clean_data");i.calc=n("./calc");i.arraysToCalcdata=n("./arrays_to_calcdata");i.plot=n("./plot");i.colorbar=n("./colorbar");i.style=n("./style");i.hoverPoints=n("./hover");i.selectPoints=n("./select");i.animatable=!0;i.moduleType="trace";i.name="scatter";i.basePlotModule=n("../../plots/cartesian");i.categories=["cartesian","symbols","markerColorscale","errorBarsOK","showLegend"];i.meta={};t.exports=i},{"../../plots/cartesian":718,"./arrays_to_calcdata":888,"./attributes":889,"./calc":890,"./clean_data":891,"./colorbar":892,"./defaults":895,"./hover":898,"./plot":906,"./select":907,"./style":908,"./subtypes":909}],900:[function(n,t){"use strict";var i=n("../../components/colorscale/has_colorscale"),r=n("../../components/colorscale/defaults");t.exports=function(n,t,u,f,e){var o=(n.marker||{}).color,s;e("line.color",u);i(n,"line")?r(n,t,f,e,{prefix:"line.",cLetter:"c"}):(s=(Array.isArray(o)?!1:o)||u,e("line.color",s));e("line.width");e("line.dash")}},{"../../components/colorscale/defaults":592,"../../components/colorscale/has_colorscale":595}],901:[function(n,t){"use strict";var i=n("../../plots/cartesian/axes");t.exports=function(n,t){function nt(t){var i=tt.c2p(n[t].x),r=it.c2p(n[t].y);return i===et||r===et?!1:[i,r]}function st(n){var t=n[0]/tt._length,i=n[1]/it._length;return(1+10*Math.max(0,-t,t-1,-i,i-1))*ut}function lt(n,t){var i=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(i*i+r*r)}var tt=t.xaxis,it=t.yaxis,ht=t.simplify,rt=t.connectGaps,ut=t.baseTolerance,ct=t.linear,ft=[],et=i.BADNUM,ot=.2,s=new Array(n.length),o=0,r,f,c,u,h,e,l,p,a,v,k,d,y,w,b,g;for(ht||(ut=ot=-1),r=0;r<n.length;r++)if(f=nt(r),f){for(o=0,s[o++]=f,r++;r<n.length;r++){if(u=nt(r),!u)if(rt)continue;else break;if(!ct){s[o++]=u;continue}if(l=lt(u,f),!(l<st(u)*ot)){for(a=[(u[0]-f[0])/l,(u[1]-f[1])/l],h=f,k=l,d=w=b=0,p=!1,c=u,r++;r<n.length;r++){if(e=nt(r),!e)if(rt)continue;else break;if(v=[e[0]-f[0],e[1]-f[1]],g=v[0]*a[1]-v[1]*a[0],w=Math.min(w,g),b=Math.max(b,g),b-w>st(e))break;c=e;y=v[0]*a[0]+v[1]*a[1];y>k?(k=y,u=e,p=!1):y<d&&(d=y,h=e,p=!0)}if(p?(s[o++]=u,c!==h&&(s[o++]=h)):(h!==f&&(s[o++]=h),c!==u&&(s[o++]=u)),s[o++]=c,r>=n.length||!e)break;s[o++]=e;f=e}}ft.push(s.slice(0,o))}return ft}},{"../../plots/cartesian/axes":710}],902:[function(n,t){"use strict";t.exports=function(n,t,i){var r=i("line.shape");r==="spline"&&i("line.smoothing")}},{}],903:[function(n,t){"use strict";t.exports=function(n,t,i){for(var e,r,u=null,f=0;f<i.length;++f)e=i[f],r=e[0].trace,r.visible===!0?(r._nexttrace=null,["tonextx","tonexty","tonext"].indexOf(r.fill)!==-1&&(r._prevtrace=u,u&&(u._nexttrace=r)),u=r):r._prevtrace=r._nexttrace=null}},{}],904:[function(n,t){"use strict";var i=n("fast-isnumeric");t.exports=function(n){var t=n.marker,r=t.sizeref||1,u=t.sizemin||0,f=t.sizemode==="area"?function(n){return Math.sqrt(n/r)}:function(n){return n/r};return function(n){var t=f(n/2);return i(t)&&t>0?Math.max(t,u):0}}},{"fast-isnumeric":133}],905:[function(n,t){"use strict";var i=n("../../components/color"),r=n("../../components/colorscale/has_colorscale"),u=n("../../components/colorscale/defaults"),f=n("./subtypes");t.exports=function(n,t,e,o,s){var c=f.isBubble(n),h=(n.line||{}).color,l;h&&(e=h);s("marker.symbol");s("marker.opacity",c?.7:1);s("marker.size");s("marker.color",e);r(n,"marker")&&u(n,t,o,s,{prefix:"marker.",cLetter:"c"});l=h&&!Array.isArray(h)&&t.marker.color!==h?h:c?i.background:i.defaultLine;s("marker.line.color",l);r(n,"marker.line")&&u(n,t,o,s,{prefix:"marker.line.",cLetter:"c"});s("marker.line.width",c?1:0);c&&(s("marker.sizeref"),s("marker.sizemin"),s("marker.sizemode"))}},{"../../components/color":582,"../../components/colorscale/defaults":592,"../../components/colorscale/has_colorscale":595,"./subtypes":909}],906:[function(n,t){"use strict";function a(n,t){var i;t.selectAll("g.trace").each(function(n){var t=r.select(this),u;i=n[0].trace;i._nexttrace?(i._nextFill=t.select(".js-fill.js-tonext"),i._nextFill.size()||(u=":first-child",t.select(".js-fill.js-tozero").size()&&(u+=" + *"),i._nextFill=t.insert("path",u).attr("class","js-fill js-tonext"))):(t.selectAll(".js-fill.js-tonext").remove(),i._nextFill=null);i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace)?(i._ownFill=t.select(".js-fill.js-tozero"),i._ownFill.size()||(i._ownFill=t.insert("path",":first-child").attr("class","js-fill js-tozero"))):(t.selectAll(".js-fill.js-tozero").remove(),i._ownFill=null)})}function e(n,t,e,c,a,y,p){function b(n){return ht?n.transition():n}function fi(n){return n.filter(function(n){return n.vis})}function si(n){return n.id}function hi(n){if(n.ids)return si}function ei(){return!1}function oi(n){var t,o,e=n[0].trace,h=r.select(this),v=u.hasMarkers(e),y=u.hasText(e),c=hi(e),l=ei,a=ei,s;v&&(l=e.marker.maxdisplayed?fi:f.identity);y&&(a=e.marker.maxdisplayed?fi:f.identity);o=h.selectAll("path.point");t=o.data(l,c);s=t.enter().append("path").classed("point",!0);s.call(i.pointStyle,e).call(i.translatePoints,tt,it,e);ht&&s.style("opacity",0).transition().style("opacity",1);t.each(function(n){var t=b(r.select(this));i.translatePoint(n,t,tt,it);i.singlePointStyle(n,t,e)});ht?t.exit().transition().style("opacity",0).remove():t.exit().remove();o=h.selectAll("g");t=o.data(a,c);t.enter().append("g").append("text");t.each(function(n){var t=b(r.select(this).select("text"));i.translatePoint(n,t,tt,it)});t.selectAll("text").call(i.textPointStyle,e).each(function(n){var t=n.xp||tt.c2p(n.x),i=n.yp||it.c2p(n.y);r.select(this).selectAll("tspan").each(function(){b(r.select(this)).attr({x:t,y:i})})});t.exit().remove()}var bt,ft,ht,lt,et,nt,wt,ni;v(n,t,e,c,a);ht=!!p&&p.duration>0;var tt=e.xaxis,it=e.yaxis,w=c[0].trace,d=w.line,ct=r.select(y);if(ct.call(o.plot,e,p),w.visible===!0){nt=w.fill.charAt(w.fill.length-1);nt!=="x"&&nt!=="y"&&(nt="");c[0].node3=ct;s(c);var at="",ti=[],vt=w._prevtrace;vt&&(at=vt._prevRevpath||"",et=vt._nextFill,ti=vt._polygons);var rt,yt,g="",ut="",kt,pt,ii,ot,dt,st,ri,k=[],ui=[],gt=f.noop;if(lt=w._ownFill,u.hasLines(w)||w.fill!=="none"){for(et&&et.datum(c),["hv","vh","hvh","vhv"].indexOf(d.shape)!==-1?(kt=i.steps(d.shape),pt=i.steps(d.shape.split("").reverse().join(""))):kt=d.shape==="spline"?pt=function(n){var t=n[n.length-1];return n[0][0]===t[0]&&n[0][1]===t[1]?i.smoothclosed(n.slice(1),d.smoothing):i.smoothopen(n,d.smoothing)}:pt=function(n){return"M"+n.join("L")},ii=function(n){return pt(n.reverse())},k=h(c,{xaxis:tt,yaxis:it,connectGaps:w.connectgaps,baseTolerance:Math.max(d.width||1,3)/4,linear:d.shape==="linear",simplify:d.simplify}),ri=w._polygons=new Array(k.length),ft=0;ft<k.length;ft++)w._polygons[ft]=l(k[ft]);k.length&&(ot=k[0][0],dt=k[k.length-1],st=dt[dt.length-1]);ui=k.filter(function(n){return n.length>1});gt=function(n){return function(t){var f,e;rt=kt(t);yt=ii(t);g?nt?(g+="L"+rt.substr(1),ut=yt+("L"+ut.substr(1))):(g+="Z"+rt,ut=yt+"Z"+ut):(g=rt,ut=yt);u.hasLines(w)&&t.length>1&&(f=r.select(this),f.datum(c),n?b(f.style("opacity",0).attr("d",rt).call(i.lineGroupStyle)).style("opacity",1):(e=b(f),e.attr("d",rt),i.singleLineStyle(c,e)))}}}wt=ct.selectAll(".js-line").data(ui);b(wt.exit()).style("opacity",0).remove();wt.each(gt(!1));wt.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(i.lineGroupStyle).each(gt(!0));k.length&&(lt?ot&&st&&(nt?(nt==="y"?ot[1]=st[1]=it.c2p(0,!0):nt==="x"&&(ot[0]=st[0]=tt.c2p(0,!0)),b(lt).attr("d","M"+st+"L"+ot+"L"+g.substr(1))):b(lt).attr("d",g+"Z")):w.fill.substr(0,6)==="tonext"&&g&&at&&(w.fill==="tonext"?b(et).attr("d",g+"Z"+at+"Z"):b(et).attr("d",g+"L"+at.substr(1)+"Z"),w._polygons=w._polygons.concat(ti)),w._prevRevpath=ut,w._prevPolygons=ri);ni=ct.selectAll(".points");bt=ni.data([c]);ni.each(oi);bt.enter().append("g").classed("points",!0).each(oi);bt.exit().remove()}}function v(n,t,i,f,e){var c=i.xaxis,l=i.yaxis,a=r.extent(c.range.map(c.l2c)),v=r.extent(l.range.map(l.l2c)),y=f[0].trace,o,w;if(u.hasMarkers(y)&&(o=y.marker.maxdisplayed,o!==0)){var p=f.filter(function(n){return n.x>=a[0]&&n.x<=a[1]&&n.y>=v[0]&&n.y<=v[1]}),s=Math.ceil(p.length/o),h=0;e.forEach(function(n,i){var r=n[0].trace;u.hasMarkers(r)&&r.marker.maxdisplayed>0&&i<t&&h++});w=Math.round(h*s/3+Math.floor(h/3)*s/7.1);f.forEach(function(n){delete n.vis});p.forEach(function(n,t){Math.round((t+w)%s)===0&&(n.vis=!0)})}}var r=n("d3"),f=n("../../lib"),i=n("../../components/drawing"),o=n("../../components/errorbars"),u=n("./subtypes"),s=n("./arrays_to_calcdata"),h=n("./line_points"),c=n("./link_traces"),l=n("../../lib/polygon").tester;t.exports=function(n,t,i,u,f){var s,l,y,v,h,o=t.plot.select("g.scatterlayer"),w=!u,b=!!u&&u.duration>0,p;for(y=o.selectAll("g.trace"),v=y.data(i,function(n){return n[0].trace.uid}),v.enter().append("g").attr("class",function(n){return"trace scatter trace"+n[0].trace.uid}).style("stroke-miterlimit",2),c(n,t,i),a(n,o),s=0,l=[];s<i.length;s++)l[s]=i[s][0].trace.uid;o.selectAll("g.trace").sort(function(n,t){var i=l.indexOf(n[0].trace.uid),r=l.indexOf(t[0].trace.uid);return i>r?1:-1});b?(f&&(h=f()),p=r.transition().duration(u.duration).ease(u.easing).each("end",function(){h&&h()}).each("interrupt",function(){h&&h()}),p.each(function(){o.selectAll("g.trace").each(function(r,f){e(n,f,t,r,i,this,u)})})):o.selectAll("g.trace").each(function(r,f){e(n,f,t,r,i,this,u)});w&&v.exit().remove();o.selectAll("path:not([d])").remove()}},{"../../components/drawing":605,"../../components/errorbars":611,"../../lib":681,"../../lib/polygon":688,"./arrays_to_calcdata":888,"./line_points":901,"./link_traces":903,"./subtypes":909,d3:129}],907:[function(n,t){"use strict";var i=n("./subtypes"),r=.2;t.exports=function(n,t){var e=n.cd,v=n.xaxis,y=n.yaxis,s=[],o=e[0].trace,p=o.index,h=o.marker,u,f,c,l,w=!i.hasMarkers(o)&&!i.hasText(o),a;if(o.visible===!0&&!w){if(a=Array.isArray(h.opacity)?1:h.opacity,t===!1)for(u=0;u<e.length;u++)e[u].dim=0;else for(u=0;u<e.length;u++)f=e[u],c=v.c2p(f.x),l=y.c2p(f.y),t.contains([c,l])?(s.push({curveNumber:p,pointNumber:u,x:f.x,y:f.y,id:f.id}),f.dim=0):f.dim=1;return e[0].node3.selectAll("path.point").style("opacity",function(n){return((n.mo+1||a+1)-1)*(n.dim?r:1)}),e[0].node3.selectAll("text").style("opacity",function(n){return n.dim?r:1}),s}}},{"./subtypes":909}],908:[function(n,t){"use strict";var r=n("d3"),i=n("../../components/drawing"),u=n("../../components/errorbars");t.exports=function(n){var t=r.select(n).selectAll("g.trace.scatter");t.style("opacity",function(n){return n[0].trace.opacity});t.selectAll("g.points").each(function(n){r.select(this).selectAll("path.point").call(i.pointStyle,n.trace||n[0].trace);r.select(this).selectAll("text").call(i.textPointStyle,n.trace||n[0].trace)});t.selectAll("g.trace path.js-line").call(i.lineGroupStyle);t.selectAll("g.trace path.js-fill").call(i.fillGroupStyle);t.call(u.style)}},{"../../components/drawing":605,"../../components/errorbars":611,d3:129}],909:[function(n,t){"use strict";var i=n("../../lib");t.exports={hasLines:function(n){return n.visible&&n.mode&&n.mode.indexOf("lines")!==-1},hasMarkers:function(n){return n.visible&&n.mode&&n.mode.indexOf("markers")!==-1},hasText:function(n){return n.visible&&n.mode&&n.mode.indexOf("text")!==-1},isBubble:function(n){return i.isPlainObject(n.marker)&&Array.isArray(n.marker.size)}}},{"../../lib":681}],910:[function(n,t){"use strict";var i=n("../../lib");t.exports=function(n,t,r,u){u("textposition");i.coerceFont(u,"textfont",r.font)}},{"../../lib":681}],911:[function(n,t){"use strict";t.exports=function(n,t,i){var r,u=i("x"),f=i("y");if(u)f?(r=Math.min(u.length,f.length),r<u.length&&(t.x=u.slice(0,r)),r<f.length&&(t.y=f.slice(0,r))):(r=u.length,i("y0"),i("dy"));else{if(!f)return 0;r=t.y.length;i("x0");i("dx")}return r}},{}],912:[function(n,t){"use strict";function e(){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var r=n("../scatter/attributes"),f=n("../../components/colorscale/color_attributes"),s=n("../../constants/gl_markers"),i=n("../../lib/extend").extendFlat,o=r.line,u=r.marker,h=u.line;t.exports={x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},text:i({},r.text,{}),mode:i({},r.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:e("x"),y:e("y"),z:e("z")},connectgaps:r.connectgaps,line:i({},{width:o.width,dash:o.dash,showscale:{valType:"boolean",dflt:!1}},f("line")),marker:i({},{symbol:{valType:"enumerated",values:Object.keys(s),dflt:"circle",arrayOk:!0},size:i({},u.size,{dflt:8}),sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,opacity:i({},u.opacity,{arrayOk:!1}),showscale:u.showscale,line:i({},{width:i({},h.width,{arrayOk:!1})},f("marker.line"))},f("marker")),textposition:i({},r.textposition,{dflt:"top center"}),textfont:r.textfont,_nestedModules:{error_x:"ErrorBars",error_y:"ErrorBars",error_z:"ErrorBars","marker.colorbar":"Colorbar"}}},{"../../components/colorscale/color_attributes":590,"../../constants/gl_markers":664,"../../lib/extend":673,"../scatter/attributes":889}],913:[function(n,t){"use strict";var i=n("../scatter/arrays_to_calcdata"),r=n("../scatter/colorscale_calc");t.exports=function(n,t){var u=[{x:!1,y:!1,trace:t,t:{}}];return i(u),r(t),u}},{"../scatter/arrays_to_calcdata":888,"../scatter/colorscale_calc":893}],914:[function(n,t){"use strict";function i(n,t,i){var o,f,u,e;if(!t||!t.visible)return null;for(o=r(t),f=new Array(n.length),u=0;u<n.length;u++)e=o(+n[u],u),f[u]=[-e[0]*i,e[1]*i];return f}function u(n){for(var t=0;t<n.length;t++)if(n[t])return n[t].length;return 0}function f(n,t){var o=[i(n.x,n.error_x,t[0]),i(n.y,n.error_y,t[1]),i(n.z,n.error_z,t[2])],s=u(o),h,f,c,r,e;if(s===0)return null;for(h=new Array(s),f=0;f<s;f++){for(c=[[0,0,0],[0,0,0]],r=0;r<3;r++)if(o[r])for(e=0;e<2;e++)c[e][r]=o[r][f][e];h[f]=c}return h}var r=n("../../components/errorbars/compute_error");t.exports=f},{"../../components/errorbars/compute_error":609}],915:[function(n,t){"use strict";function h(n,t){this.scene=n;this.uid=t;this.linePlot=null;this.scatterPlot=null;this.errorBars=null;this.textMarkers=null;this.delaunayMesh=null;this.color=null;this.mode="";this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.textLabels=null;this.data=null}function k(n,t,i){for(var s=(i+1)%3,h=(i+2)%3,c=[],l=[],u,e,o,f,r=0;r<n.length;++r)(u=n[r],!isNaN(u[s])&&isFinite(u[s])&&!isNaN(u[h])&&isFinite(u[h]))&&(c.push([u[s],u[h]]),l.push(r));for(e=y(c),r=0;r<e.length;++r)for(o=e[r],f=0;f<o.length;++f)o[f]=l[o[f]];return{positions:n,cells:e,meshColor:t}}function d(n){for(var t,r=[0,0,0],u=[[0,0,0],[0,0,0],[0,0,0]],f=[0,0,0],i=0;i<3;i++)(t=n[i],t&&t.copy_zstyle!==!1&&(t=n[2]),t)&&(r[i]=t.width/2,u[i]=s(t.color),f=t.thickness);return{capSize:r,color:u,lineWidth:f}}function g(n){var t=[0,0];return Array.isArray(n)?[0,-1]:(n.indexOf("bottom")>=0&&(t[1]+=1),n.indexOf("top")>=0&&(t[1]-=1),n.indexOf("left")>=0&&(t[0]-=1),n.indexOf("right")>=0&&(t[0]+=1),t)}function nt(n,t){return t(n*4)}function tt(n){return w[n]}function f(n,t,i,r,u){var e=null,f;if(Array.isArray(n))for(e=[],f=0;f<t;f++)e[f]=n[f]===undefined?r:i(n[f],u);else e=i(n,o.identity);return e}function it(n,t){for(var r,k=[],y=n.fullSceneLayout,c=n.dataScale,st=y.xaxis,ht=y.yaxis,ct=y.zaxis,h=t.marker,w=t.line,it,rt=t.x||[],ut,lt=t.y||[],ft,at=t.z||[],e=rt.length,l,et,ot,a,v,u=0;u<e;u++)it=st.d2l(rt[u])*c[0],ut=ht.d2l(lt[u])*c[1],ft=ct.d2l(at[u])*c[2],k[u]=[it,ut,ft];if(Array.isArray(t.text))l=t.text;else if(t.text!==undefined)for(l=new Array(e),u=0;u<e;u++)l[u]=t.text;for(r={position:k,mode:t.mode,text:l},("line"in t)&&(r.lineColor=i(w,1,e),r.lineWidth=w.width,r.lineDashes=w.dash),("marker"in t)&&(et=p(t),r.scatterColor=i(h,1,e),r.scatterSize=f(h.size,e,nt,20,et),r.scatterMarker=f(h.symbol,e,tt,"●"),r.scatterLineWidth=h.line.width,r.scatterLineColor=i(h.line,1,e),r.scatterAngle=0),("textposition"in t)&&(r.textOffset=g(t.textposition),r.textColor=i(t.textfont,1,e),r.textSize=f(t.textfont.size,e,o.identity,12),r.textFont=t.textfont.family,r.textAngle=0),ot=["x","y","z"],r.project=[!1,!1,!1],r.projectScale=[1,1,1],r.projectOpacity=[1,1,1],u=0;u<3;++u)a=t.projection[ot[u]],(r.project[u]=a.show)&&(r.projectOpacity[u]=a.opacity,r.projectScale[u]=a.scale);return r.errorBounds=b(t,c),v=d([t.error_x,t.error_y,t.error_z]),r.errorColor=v.color,r.errorLineWidth=v.lineWidth,r.errorCapSize=v.capSize,r.delaunayAxis=t.surfaceaxis,r.delaunayColor=s(t.surfacecolor),r}function c(n){if(Array.isArray(n)){var t=n[0];return Array.isArray(t)&&(n=t),"rgb("+n.slice(0,3).map(function(n){return Math.round(n*255)})+")"}return null}function rt(n,t){var i=new h(n,t.uid);return i.update(t),i}var l=n("gl-line3d"),e=n("gl-scatter3d"),a=n("gl-error3d"),v=n("gl-mesh3d"),y=n("delaunay-triangulate"),o=n("../../lib"),s=n("../../lib/str2rgbarray"),i=n("../../lib/gl_format_color"),p=n("../scatter/make_bubble_size_func"),r=n("../../constants/gl3d_dashes"),w=n("../../constants/gl_markers"),b=n("./calc_errors"),u=h.prototype;u.handlePick=function(n){if(n.object&&(n.object===this.linePlot||n.object===this.delaunayMesh||n.object===this.textMarkers||n.object===this.scatterPlot)){n.object.highlight&&n.object.highlight(null);this.scatterPlot&&(n.object=this.scatterPlot,this.scatterPlot.highlight(n.data));n.textLabel=this.textLabels&&this.textLabels[n.data.index]!==undefined?this.textLabels[n.data.index]:"";var t=n.data.index;return n.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]],!0}};u.update=function(n){var i=this.scene.glplot.gl,f,o,s,h,y=r.solid,t,p,u;this.data=n;t=it(this.scene,n);"mode"in t&&(this.mode=t.mode);"lineDashes"in t&&t.lineDashes in r&&(y=r[t.lineDashes]);this.color=c(t.scatterColor)||c(t.lineColor);this.dataPoints=t.position;f={gl:i,position:t.position,color:t.lineColor,lineWidth:t.lineWidth||1,dashes:y[0],dashScale:y[1],opacity:n.opacity,connectGaps:n.connectgaps};this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(f):(this.linePlot=l(f),this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);p=n.opacity;n.marker&&n.marker.opacity&&(p*=n.marker.opacity);o={gl:i,position:t.position,color:t.scatterColor,size:t.scatterSize,glyph:t.scatterMarker,opacity:p,orthographic:!0,lineWidth:t.scatterLineWidth,lineColor:t.scatterLineColor,project:t.project,projectScale:t.projectScale,projectOpacity:t.projectOpacity};this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(o):(this.scatterPlot=e(o),this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null);h={gl:i,position:t.position,glyph:t.text,color:t.textColor,size:t.textSize,angle:t.textAngle,alignment:t.textOffset,font:t.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:n.opacity};this.textLabels=t.text;this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(h):(this.textMarkers=e(h),this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null);s={gl:i,position:t.position,color:t.errorColor,error:t.errorBounds,lineWidth:t.errorLineWidth,capSize:t.errorCapSize,opacity:n.opacity};this.errorBars?t.errorBounds?this.errorBars.update(s):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):t.errorBounds&&(this.errorBars=a(s),this.scene.glplot.add(this.errorBars));t.delaunayAxis>=0?(u=k(t.position,t.delaunayColor,t.delaunayAxis),u.opacity=n.opacity,this.delaunayMesh?this.delaunayMesh.update(u):(u.gl=i,this.delaunayMesh=v(u),this.scene.glplot.add(this.delaunayMesh))):this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)};u.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose());this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose());this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose());this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose());this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};t.exports=rt},{"../../constants/gl3d_dashes":663,"../../constants/gl_markers":664,"../../lib":681,"../../lib/gl_format_color":679,"../../lib/str2rgbarray":694,"../scatter/make_bubble_size_func":904,"./calc_errors":914,"delaunay-triangulate":130,"gl-error3d":137,"gl-line3d":143,"gl-mesh3d":166,"gl-scatter3d":273}],916:[function(n,t){"use strict";function h(n,t,i){var r=0,u=i("x"),f=i("y"),e=i("z");return u&&f&&e&&(r=Math.min(u.length,f.length,e.length),r<u.length&&(t.x=u.slice(0,r)),r<f.length&&(t.y=f.slice(0,r)),r<e.length&&(t.z=e.slice(0,r))),r}var u=n("../../lib"),i=n("../scatter/subtypes"),f=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/text_defaults"),r=n("../../components/errorbars/defaults"),s=n("./attributes");t.exports=function(n,t,c,l){function a(i,r){return u.coerce(n,t,s,i,r)}var k=h(n,t,a),p,w,b,v,y;if(!k){t.visible=!1;return}for(a("text"),a("mode"),i.hasLines(t)&&(a("connectgaps"),e(n,t,c,l,a)),i.hasMarkers(t)&&f(n,t,c,l,a),i.hasText(t)&&o(n,t,l,a),p=(t.line||{}).color,w=(t.marker||{}).color,a("surfaceaxis")>=0&&a("surfacecolor",p||w),b=["x","y","z"],v=0;v<3;++v)y="projection."+b[v],a(y+".show")&&(a(y+".opacity"),a(y+".scale"));r(n,t,c,{axis:"z"});r(n,t,c,{axis:"y",inherit:"z"});r(n,t,c,{axis:"x",inherit:"z"})}},{"../../components/errorbars/defaults":610,"../../lib":681,"../scatter/line_defaults":900,"../scatter/marker_defaults":905,"../scatter/subtypes":909,"../scatter/text_defaults":910,"./attributes":912}],917:[function(n,t){"use strict";var i={};i.plot=n("./convert");i.attributes=n("./attributes");i.markerSymbols=n("../../constants/gl_markers");i.supplyDefaults=n("./defaults");i.colorbar=n("../scatter/colorbar");i.calc=n("./calc");i.moduleType="trace";i.name="scatter3d";i.basePlotModule=n("../../plots/gl3d");i.categories=["gl3d","symbols","markerColorscale","showLegend"];i.meta={};t.exports=i},{"../../constants/gl_markers":664,"../../plots/gl3d":748,"../scatter/colorbar":892,"./attributes":912,"./calc":913,"./convert":915,"./defaults":916}],918:[function(n,t){"use strict";var i=n("../scatter/attributes"),o=n("../../plots/attributes"),e=n("../../components/colorscale/color_attributes"),u=n("../../lib/extend").extendFlat,r=i.marker,f=i.line,s=r.line;t.exports={lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),textfont:i.textfont,textposition:i.textposition,line:{color:f.color,width:f.width,dash:f.dash},connectgaps:i.connectgaps,marker:u({},{symbol:r.symbol,opacity:r.opacity,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,showscale:r.showscale,line:u({},{width:s.width},e("marker.line"))},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:i.fillcolor,hoverinfo:u({},o.hoverinfo,{flags:["lon","lat","location","text","name"]}),_nestedModules:{"marker.colorbar":"Colorbar"}}},{"../../components/colorscale/color_attributes":590,"../../lib/extend":673,"../../plots/attributes":708,"../scatter/attributes":889}],919:[function(n,t){"use strict";var i=n("fast-isnumeric"),r=n("../scatter/colorscale_calc");t.exports=function(n,t){for(var f,s,h,c,l,a=Array.isArray(t.locations),v=a?t.locations.length:t.lon.length,e=[],o=0,u=0;u<v;u++){if(f={},a?(h=t.locations[u],f.loc=h,s=typeof h!="string"):(c=t.lon[u],l=t.lat[u],f.lonlat=[+c,+l],s=!i(c)||!i(l)),s){o>0&&(e[o-1].gapAfter=!0);continue}o++;e.push(f)}return r(t),e}},{"../scatter/colorscale_calc":893,"fast-isnumeric":133}],920:[function(n,t){"use strict";function h(n,t,i){var r=0,e=i("locations"),u,f;return e?(i("locationmode"),e.length):(u=i("lon")||[],f=i("lat")||[],r=Math.min(u.length,f.length),r<u.length&&(t.lon=u.slice(0,r)),r<f.length&&(t.lat=f.slice(0,r)),r)}var r=n("../../lib"),i=n("../scatter/subtypes"),u=n("../scatter/marker_defaults"),f=n("../scatter/line_defaults"),e=n("../scatter/text_defaults"),o=n("../scatter/fillcolor_defaults"),s=n("./attributes");t.exports=function(n,t,c,l){function a(i,u){return r.coerce(n,t,s,i,u)}var v=h(n,t,a);if(!v){t.visible=!1;return}a("text");a("mode");i.hasLines(t)&&(f(n,t,c,l,a),a("connectgaps"));i.hasMarkers(t)&&u(n,t,c,l,a);i.hasText(t)&&e(n,t,l,a);a("fill");t.fill!=="none"&&o(n,t,c,a);a("hoverinfo",l._dataLength===1?"lon+lat+location+text":undefined)}},{"../../lib":681,"../scatter/fillcolor_defaults":896,"../scatter/line_defaults":900,"../scatter/marker_defaults":905,"../scatter/subtypes":909,"../scatter/text_defaults":910,"./attributes":918}],921:[function(n,t){"use strict";t.exports=function(n,t){return n.lon=t.lon,n.lat=t.lat,n.location=t.lon?t.lon:null,n}},{}],922:[function(n,t){"use strict";function e(n,t,i){function o(n){return r.tickText(i,i.c2l(n),"hover").text+"°"}var s=n.hoverinfo,e=s==="all"?f.hoverinfo.flags:s.split("+"),l=e.indexOf("location")!==-1&&Array.isArray(n.locations),h=e.indexOf("lon")!==-1,c=e.indexOf("lat")!==-1,a=e.indexOf("text")!==-1,u=[];return l?u.push(t.loc):h&&c?u.push("("+o(t.lonlat[0])+", "+o(t.lonlat[1])+")"):h?u.push("lon: "+o(t.lonlat[0])):c&&u.push("lat: "+o(t.lonlat[1])),a&&u.push(t.tx||n.text),u.join("<br>")}var i=n("../../plots/cartesian/graph_interact"),r=n("../../plots/cartesian/axes"),u=n("../scatter/get_trace_color"),f=n("./attributes");t.exports=function(n){function l(n){return s.projection(n)}function y(n){var t=n.lonlat;if(t[0]===null||t[1]===null||s.isLonLatOverEdges(t))return Infinity;var i=l(t),e=a.c2p(),o=v.c2p(),r=Math.abs(e-i[0]),u=Math.abs(o-i[1]),f=Math.max(3,n.mrc||0);return Math.max(Math.sqrt(r*r+u*u)-f,1-3/f)}var r=n.cd,c=r[0].trace,a=n.xa,v=n.ya,s=n.subplot;if(!r[0].placeholder&&(i.getClosest(r,y,n),n.index!==!1)){var t=r[n.index],h=t.lonlat,f=l(h),o=t.mrc||1;return n.x0=f[0]-o,n.x1=f[0]+o,n.y0=f[1]-o,n.y1=f[1]+o,n.loc=t.loc,n.lat=h[0],n.lon=h[1],n.color=u(c,t),n.extraText=e(c,t,s.mockAxis),[n]}}},{"../../plots/cartesian/axes":710,"../../plots/cartesian/graph_interact":717,"../scatter/get_trace_color":897,"./attributes":918}],923:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../scatter/colorbar");i.calc=n("./calc");i.plot=n("./plot");i.hoverPoints=n("./hover");i.eventData=n("./event_data");i.moduleType="trace";i.name="scattergeo";i.basePlotModule=n("../../plots/geo");i.categories=["geo","symbols","markerColorscale","showLegend"];i.meta={};t.exports=i},{"../../plots/geo":733,"../scatter/colorbar":892,"./attributes":918,"./calc":919,"./defaults":920,"./event_data":921,"./hover":922,"./plot":924}],924:[function(n,t){"use strict";function l(n,t){if(!Array.isArray(n.locations))return o.identity;var i=s(n,t),r=n.locationmode;return function(n){var t=h(r,n.loc,i);return t?(n.lonlat=t.properties.ct,n):(n.lonlat=[null,null],!1)}}function a(n,t,i){function r(n,r){c(n,t,r,i)}var u=n.marker,f;r(n.text,"tx");r(n.textposition,"tp");n.textfont&&(r(n.textfont.size,"ts"),r(n.textfont.color,"tc"),r(n.textfont.family,"tf"));u&&u.line&&(f=u.line,r(u.opacity,"mo"),r(u.symbol,"mx"),r(u.color,"mc"),r(u.size,"ms"),r(f.color,"mlc"),r(f.width,"mlw"))}function v(n){var t=n.framework.selectAll("g.trace.scattergeo");t.style("opacity",function(n){return n[0].trace.opacity});t.each(function(n){var t=n[0].trace,u=i.select(this);u.selectAll("path.point").call(r.pointStyle,t);u.selectAll("text").call(r.textPointStyle,t)});t.selectAll("path.js-line").style("fill","none").each(function(n){var f=i.select(this),t=n.trace,u=t.line||{};f.call(e.stroke,u.color).call(r.dashLine,u.dash||"",u.width||0);t.fill!=="none"&&f.call(e.fill,t.fillcolor)})}var i=n("d3"),r=n("../../components/drawing"),e=n("../../components/color"),o=n("../../lib"),s=n("../../lib/topojson_utils").getTopojsonFeatures,h=n("../../lib/geo_location_utils").locationToFeature,u=n("../../lib/geojson_utils"),c=n("../../lib/array_to_calc_item"),f=n("../scatter/subtypes");t.exports=function(n,t){function e(n){return n[0].trace.uid}var r=n.framework.select(".scattergeolayer").selectAll("g.trace.scattergeo").data(t,e);r.enter().append("g").attr("class","trace scattergeo");r.exit().remove();r.selectAll("*").remove();r.each(function(t){var s=i.select(this),r=t[0].trace,y=l(r,n.topojson),o,e,h,c,v;for(t[0].placeholder&&s.remove(),o=[],e=0;e<t.length;e++)h=y(t[e]),h&&(a(r,t[e],e),o.push(h));(f.hasLines(r)||r.fill!=="none")&&(c=u.calcTraceToLineCoords(o),v=r.fill!=="none"?u.makePolygon(c,r):u.makeLine(c,r),s.selectAll("path.js-line").data([v]).enter().append("path").classed("js-line",!0));f.hasMarkers(r)&&s.selectAll("path.point").data(o).enter().append("path").classed("point",!0);f.hasText(r)&&s.selectAll("g").data(o).enter().append("g").append("text")});v(n)}},{"../../components/color":582,"../../components/drawing":605,"../../lib":681,"../../lib/array_to_calc_item":669,"../../lib/geo_location_utils":677,"../../lib/geojson_utils":678,"../../lib/topojson_utils":696,"../scatter/subtypes":909,d3:129}],925:[function(n,t){"use strict";var i=n("../scatter/attributes"),u=n("../../components/colorscale/color_attributes"),s=n("../../constants/gl2d_dashes"),h=n("../../constants/gl_markers"),f=n("../../lib/extend").extendFlat,e=n("../../lib/extend").extendDeep,o=i.line,r=i.marker,c=r.line;t.exports={x:i.x,x0:i.x0,dx:i.dx,y:i.y,y0:i.y0,dy:i.dy,text:f({},i.text,{}),mode:{valType:"flaglist",flags:["lines","markers"],extras:["none"]},line:{color:o.color,width:o.width,dash:{valType:"enumerated",values:Object.keys(s),dflt:"solid"}},marker:e({},u("marker"),{symbol:{valType:"enumerated",values:Object.keys(h),dflt:"circle",arrayOk:!0},size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,showscale:r.showscale,line:e({},u("marker.line"),{width:c.width})}),connectgaps:i.connectgaps,fill:f({},i.fill,{values:["none","tozeroy","tozerox"]}),fillcolor:i.fillcolor,_nestedModules:{error_x:"ErrorBars",error_y:"ErrorBars","marker.colorbar":"Colorbar"}}},{"../../components/colorscale/color_attributes":590,"../../constants/gl2d_dashes":662,"../../constants/gl_markers":664,"../../lib/extend":673,"../scatter/attributes":889}],926:[function(n,t){"use strict";function l(n,t){this.scene=n;this.uid=t;this.type="scattergl";this.pickXData=[];this.pickYData=[];this.xData=[];this.yData=[];this.textLabels=[];this.color="rgb(0, 0, 0)";this.name="";this.hoverinfo="all";this.connectgaps=!0;this.idToIndex=[];this.bounds=[0,0,0,0];this.hasLines=!1;this.lineOptions={positions:new Float32Array(0),color:[0,0,0,1],width:1,fill:[!1,!1,!1,!1],fillColor:[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],dashes:[1]};this.line=k(n.glplot,this.lineOptions);this.line._trace=this;this.hasErrorX=!1;this.errorXOptions={positions:new Float32Array(0),errors:new Float32Array(0),lineWidth:1,capSize:0,color:[0,0,0,1]};this.errorX=e(n.glplot,this.errorXOptions);this.errorX._trace=this;this.hasErrorY=!1;this.errorYOptions={positions:new Float32Array(0),errors:new Float32Array(0),lineWidth:1,capSize:0,color:[0,0,0,1]};this.errorY=e(n.glplot,this.errorYOptions);this.errorY._trace=this;this.hasMarkers=!1;this.scatterOptions={positions:new Float32Array(0),sizes:[],colors:[],glyphs:[],borderWidths:[],borderColors:[],size:12,color:[0,0,0,1],borderSize:1,borderColor:[0,0,0,1]};this.scatter=w(n.glplot,this.scatterOptions);this.scatter._trace=this;this.fancyScatter=b(n.glplot,this.scatterOptions);this.fancyScatter._trace=this}function u(n,t,i){return Array.isArray(t)||(t=[t]),a(n,t,i)}function a(n,t,i){for(var u=new Array(i),f=t[0],r=0;r<i;++r)u[r]=r>=t.length?n(f):n(t[r]);return u}function v(n,t,i){return p(et(n,i),f(t,i),i)}function y(n,t,i,r){var u=nt(n,t,r);return u=Array.isArray(u[0])?u:a(d.identity,[u],r),p(u,f(i,r),r)}function p(n,t,i){for(var u,f=new Array(4*i),r=0;r<i;++r){for(u=0;u<3;++u)f[4*r+u]=n[r][u];f[4*r+3]=n[r][3]*t[r]}return f}function st(n,t){var i=new l(n,t.uid);return i.update(t),i}var w=n("gl-scatter2d"),b=n("gl-scatter2d-fancy"),k=n("gl-line2d"),e=n("gl-error2d"),o=n("fast-isnumeric"),d=n("../../lib"),s=n("../../plots/cartesian/axes"),g=n("../../components/errorbars"),r=n("../../lib/str2rgbarray"),h=n("../../lib/float32_truncate"),nt=n("../../lib/gl_format_color"),c=n("../scatter/subtypes"),tt=n("../scatter/make_bubble_size_func"),it=n("../scatter/get_trace_color"),rt=n("../../constants/gl_markers"),ut=n("../../constants/gl2d_dashes"),ft=["xaxis","yaxis"],i=l.prototype;i.handlePick=function(n){var t=n.pointId;return(n.object!==this.line||this.connectgaps)&&(t=this.idToIndex[n.pointId]),{trace:this,dataCoord:n.dataCoord,traceCoord:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:Array.isArray(this.color)?this.color[t]:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}};i.isFancy=function(n){if(this.scene.xaxis.type!=="linear"||this.scene.yaxis.type!=="linear"||!n.x||!n.y)return!0;if(this.hasMarkers){var t=n.marker||{};if(Array.isArray(t.symbol)||t.symbol!=="circle"||Array.isArray(t.size)||Array.isArray(t.color)||Array.isArray(t.line.width)||Array.isArray(t.line.color)||Array.isArray(t.opacity))return!0}return this.hasLines&&!this.connectgaps?!0:this.hasErrorX?!0:this.hasErrorY?!0:!1};var f=u.bind(null,function(n){return+n}),et=u.bind(null,r),ot=u.bind(null,function(n){return rt[n]||"●"});i.update=function(n){n.visible!==!0?(this.hasLines=!1,this.hasErrorX=!1,this.hasErrorY=!1,this.hasMarkers=!1):(this.hasLines=c.hasLines(n),this.hasErrorX=n.error_x.visible===!0,this.hasErrorY=n.error_y.visible===!0,this.hasMarkers=c.hasMarkers(n));this.textLabels=n.text;this.name=n.name;this.hoverinfo=n.hoverinfo;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.connectgaps=!!n.connectgaps;this.isFancy(n)?this.updateFancy(n):this.updateFast(n);this.color=it(n,{})};i.updateFast=function(n){for(var l,a=this.xData=this.pickXData=n.x,b=this.yData=this.pickYData=n.y,s=a.length,v=new Array(s),i=new Float32Array(2*s),t=this.bounds,k=0,c=0,u,f,e=0;e<s;++e)(u=a[e],f=b[e],o(u)&&o(f))&&(v[k++]=e,i[c++]=u,i[c++]=f,t[0]=Math.min(t[0],u),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],u),t[3]=Math.max(t[3],f));if(i=h(i,c),this.idToIndex=v,this.updateLines(n,i),this.updateError("X",n),this.updateError("Y",n),this.hasMarkers){this.scatterOptions.positions=i;var y=r(n.marker.color),p=r(n.marker.line.color),w=n.opacity*n.marker.opacity;y[3]*=w;this.scatterOptions.color=y;p[3]*=w;this.scatterOptions.borderColor=p;l=n.marker.size;this.scatterOptions.size=l;this.scatterOptions.borderSize=n.marker.line.width;this.scatter.update(this.scatterOptions)}else this.scatterOptions.positions=new Float32Array(0),this.scatterOptions.glyphs=[],this.scatter.update(this.scatterOptions);this.scatterOptions.positions=new Float32Array(0);this.scatterOptions.glyphs=[];this.fancyScatter.update(this.scatterOptions);this.expandAxesFast(t,l)};i.updateFancy=function(n){var it=this.scene,rt=it.xaxis,ut=it.yaxis,r=this.bounds,b=this.pickXData=rt.makeCalcdata(n,"x").slice(),ft=this.pickYData=ut.makeCalcdata(n,"y").slice(),ht;this.xData=b.slice();this.yData=ft.slice();for(var k=g.calcFromTrace(n,it.fullLayout),i=b.length,et=new Array(i),e=new Float32Array(2*i),p=new Float32Array(4*i),w=new Float32Array(4*i),o=0,st=0,d=0,nt=0,wt=rt.type==="log"?function(n){return rt.d2l(n)}:function(n){return n},bt=ut.type==="log"?function(n){return ut.d2l(n)}:function(n){return n},s,c,l,ct,lt,at,vt,t=0;t<i;++t)(this.xData[t]=c=wt(b[t]),this.yData[t]=l=bt(ft[t]),isNaN(c)||isNaN(l))||(et[o++]=t,e[st++]=c,e[st++]=l,ct=p[d++]=c-k[t].xs||0,lt=p[d++]=k[t].xh-c||0,p[d++]=0,p[d++]=0,w[nt++]=0,w[nt++]=0,at=w[nt++]=l-k[t].ys||0,vt=w[nt++]=k[t].yh-l||0,r[0]=Math.min(r[0],c-ct),r[1]=Math.min(r[1],l-at),r[2]=Math.max(r[2],c+lt),r[3]=Math.max(r[3],l+vt));if(e=h(e,st),this.idToIndex=et,this.updateLines(n,e),this.updateError("X",n,e,p),this.updateError("Y",n,e,w),this.hasMarkers){this.scatterOptions.positions=e;this.scatterOptions.sizes=new Array(o);this.scatterOptions.glyphs=new Array(o);this.scatterOptions.borderWidths=new Array(o);this.scatterOptions.colors=new Array(o*4);this.scatterOptions.borderColors=new Array(o*4);var kt=tt(n),a=n.marker,yt=a.opacity,pt=n.opacity,dt=y(a,yt,pt,i),gt=ot(a.symbol,i),ni=f(a.line.width,i),ti=y(a.line,yt,pt,i),v;for(ht=u(kt,a.size,i),t=0;t<o;++t)for(v=et[t],this.scatterOptions.sizes[t]=4*ht[v],this.scatterOptions.glyphs[t]=gt[v],this.scatterOptions.borderWidths[t]=.5*ni[v],s=0;s<4;++s)this.scatterOptions.colors[4*t+s]=dt[4*v+s],this.scatterOptions.borderColors[4*t+s]=ti[4*v+s];this.fancyScatter.update(this.scatterOptions)}else this.scatterOptions.positions=new Float32Array(0),this.scatterOptions.glyphs=[],this.fancyScatter.update(this.scatterOptions);this.scatterOptions.positions=new Float32Array(0);this.scatterOptions.glyphs=[];this.scatter.update(this.scatterOptions);this.expandAxesFancy(b,ft,ht)};i.updateLines=function(n,t){var i,u,f;if(this.hasLines){if(u=t,!n.connectgaps){var s=0,e=this.xData,h=this.yData;for(u=new Float32Array(2*e.length),i=0;i<e.length;++i)u[s++]=e[i],u[s++]=h[i]}this.lineOptions.positions=u;var c=v(n.line.color,n.opacity,1),l=Math.round(.5*this.lineOptions.width),o=(ut[n.line.dash]||[1]).slice();for(i=0;i<o.length;++i)o[i]*=l;switch(n.fill){case"tozeroy":this.lineOptions.fill=[!1,!0,!1,!1];break;case"tozerox":this.lineOptions.fill=[!0,!1,!1,!1];break;default:this.lineOptions.fill=[!1,!1,!1,!1]}f=r(n.fillcolor);this.lineOptions.color=c;this.lineOptions.width=2*n.line.width;this.lineOptions.dashes=o;this.lineOptions.fillColor=[f,f,f,f]}else this.lineOptions.positions=new Float32Array(0);this.line.update(this.lineOptions)};i.updateError=function(n,t,i,r){var e=this["error"+n],f=t["error_"+n.toLowerCase()],u=this["error"+n+"Options"];n.toLowerCase()==="x"&&f.copy_ystyle&&(f=t.error_y);this["hasError"+n]?(u.positions=i,u.errors=r,u.capSize=f.width,u.lineWidth=f.thickness/2,u.color=v(f.color,1,1)):u.positions=new Float32Array(0);e.update(u)};i.expandAxesFast=function(n,t){for(var e=t||10,f,r,u,i=0;i<2;i++)f=this.scene[ft[i]],r=f._min,r||(r=[]),r.push({val:n[i],pad:e}),u=f._max,u||(u=[]),u.push({val:n[i+2],pad:e})};i.expandAxesFancy=function(n,t,i){var r=this.scene,u={padded:!0,ppad:i};s.expand(r.xaxis,n,u);s.expand(r.yaxis,t,u)};i.dispose=function(){this.line.dispose();this.errorX.dispose();this.errorY.dispose();this.scatter.dispose();this.fancyScatter.dispose()};t.exports=st},{"../../components/errorbars":611,"../../constants/gl2d_dashes":662,"../../constants/gl_markers":664,"../../lib":681,"../../lib/float32_truncate":676,"../../lib/gl_format_color":679,"../../lib/str2rgbarray":694,"../../plots/cartesian/axes":710,"../scatter/get_trace_color":897,"../scatter/make_bubble_size_func":904,"../scatter/subtypes":909,"fast-isnumeric":133,"gl-error2d":135,"gl-line2d":141,"gl-scatter2d":270,"gl-scatter2d-fancy":265}],927:[function(n,t){"use strict";var u=n("../../lib"),f=n("../scatter/constants"),i=n("../scatter/subtypes"),e=n("../scatter/xy_defaults"),o=n("../scatter/marker_defaults"),s=n("../scatter/line_defaults"),h=n("../scatter/fillcolor_defaults"),r=n("../../components/errorbars/defaults"),c=n("./attributes");t.exports=function(n,t,l,a){function v(i,r){return u.coerce(n,t,c,i,r)}var y=e(n,t,v);if(!y){t.visible=!1;return}v("text");v("mode",y<f.PTS_LINESONLY?"lines+markers":"lines");i.hasLines(t)&&(v("connectgaps"),s(n,t,l,a,v));i.hasMarkers(t)&&o(n,t,l,a,v);v("fill");t.fill!=="none"&&h(n,t,l,v);r(n,t,l,{axis:"y"});r(n,t,l,{axis:"x",inherit:"y"})}},{"../../components/errorbars/defaults":610,"../../lib":681,"../scatter/constants":894,"../scatter/fillcolor_defaults":896,"../scatter/line_defaults":900,"../scatter/marker_defaults":905,"../scatter/subtypes":909,"../scatter/xy_defaults":911,"./attributes":925}],928:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../scatter/colorbar");i.calc=n("../scatter3d/calc");i.plot=n("./convert");i.moduleType="trace";i.name="scattergl";i.basePlotModule=n("../../plots/gl2d");i.categories=["gl2d","symbols","errorBarsOK","markerColorscale","showLegend"];i.meta={};t.exports=i},{"../../plots/gl2d":745,"../scatter/colorbar":892,"../scatter3d/calc":913,"./attributes":925,"./convert":926,"./defaults":927}],929:[function(n,t){"use strict";var r=n("../scattergeo/attributes"),u=n("../scatter/attributes"),o=n("../../plots/mapbox/layout_attributes"),s=n("../../plots/attributes"),f=n("../../lib/extend").extendFlat,e=r.line,i=r.marker;t.exports={lon:r.lon,lat:r.lat,mode:{valType:"flaglist",flags:["lines","markers","text"],dflt:"markers",extras:["none"]},text:f({},u.text,{}),line:{color:e.color,width:e.width,dash:e.dash},connectgaps:u.connectgaps,marker:{symbol:{valType:"string",dflt:"circle",arrayOk:!0},opacity:f({},i.opacity,{arrayOk:!1}),size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,color:i.color,colorscale:i.colorscale,cauto:i.cauto,cmax:i.cmax,cmin:i.cmin,autocolorscale:i.autocolorscale,reversescale:i.reversescale,showscale:i.showscale},fill:r.fill,fillcolor:u.fillcolor,textfont:o.layers.symbol.textfont,textposition:o.layers.symbol.textposition,hoverinfo:f({},s.hoverinfo,{flags:["lon","lat","text","name"]}),_nestedModules:{"marker.colorbar":"Colorbar"}}},{"../../lib/extend":673,"../../plots/attributes":708,"../../plots/mapbox/layout_attributes":765,"../scatter/attributes":889,"../scattergeo/attributes":918}],930:[function(n,t){"use strict";var i=n("fast-isnumeric"),r=n("../../lib"),f=n("../../components/colorscale/has_colorscale"),e=n("../../components/colorscale/make_scale_function"),u=n("../scatter/subtypes"),o=n("../scatter/colorscale_calc"),s=n("../scatter/make_bubble_size_func");t.exports=function(n,t){var nt=t.lon.length,h=t.marker,a=u.hasMarkers(t),tt=a&&Array.isArray(h.color),it=a&&Array.isArray(h.size),rt=a&&Array.isArray(h.symbol),ut=Array.isArray(t.text),c,p,w,l,b,k,d,g;o(t);var ft=f(t,"marker")?e(h.colorscale,h.cmin,h.cmax):r.identity,et=u.isBubble(t)?s(t):r.identity,v=[],y=0;for(c=0;c<nt;c++){if(p=t.lon[c],w=t.lat[c],!i(p)||!i(w)){y>0&&(v[y-1].gapAfter=!0);continue}l={};y++;l.lonlat=[+p,+w];a&&(tt&&(b=h.color[c],l.mc=b,l.mcc=ft(b)),it&&(k=h.size[c],l.ms=k,l.mrc=et(k)),rt&&(d=h.symbol[c],l.mx=typeof d=="string"?d:"circle"));ut&&(g=t.text[c],l.tx=typeof g=="string"?g:"");v.push(l)}return v}},{"../../components/colorscale/has_colorscale":595,"../../components/colorscale/make_scale_function":599,"../../lib":681,"../scatter/colorscale_calc":893,"../scatter/make_bubble_size_func":904,"../scatter/subtypes":909,"fast-isnumeric":133}],931:[function(n,t){"use strict";function o(){return{geojson:f.makeBlank(),layout:{visibility:"none"},paint:{}}}function l(n,t){function s(n,i,r,u){t[i][r]===undefined&&(t[i][r]=u);n[i]=t[i][r]}for(var f,e,c=n[0].trace,o=c.marker,l=Array.isArray(o.color),a=Array.isArray(o.size),h=[],i=0;i<n.length;i++)f=n[i],e={},l&&s(e,r,f.mcc,i),a&&s(e,u,f.mrc,i),h.push({type:"Feature",geometry:{type:"Point",coordinates:f.lonlat},properties:e});return{type:"FeatureCollection",features:h}}function a(n){for(var t,i=n[0].trace,o=i.marker||{},u=o.symbol,c=i.text,l=u!=="circle"?h(u):s,a=e.hasText(i)?h(c):s,f=[],r=0;r<n.length;r++)t=n[r],f.push({type:"Feature",geometry:{type:"Point",coordinates:t.lonlat},properties:{symbol:l(t.mx),text:a(t.tx)}});return{type:"FeatureCollection",features:f}}function v(n,t){var s=n.marker,u,f,e,i,o;if(Array.isArray(s.color)){for(f=Object.keys(t[r]),e=[],i=0;i<f.length;i++)o=f[i],e.push([t[r][o],o]);u={property:r,stops:e}}else u=s.color;return u}function y(n,t){var s=n.marker,f,e,i,r,o;if(Array.isArray(s.size)){for(e=Object.keys(t[u]),i=[],r=0;r<e.length;r++)o=e[r],i.push([t[u][o],+o]);i.sort(function(n,t){return n[0]-t[0]});f={property:u,stops:i}}else f=s.size/2;return f}function h(n){return Array.isArray(n)?function(n){return n}:n?function(){return n}:s}function s(){return""}var i=n("../../lib"),f=n("../../lib/geojson_utils"),e=n("../scatter/subtypes"),c=n("../../plots/mapbox/convert_text_opts"),r="circle-color",u="circle-radius";t.exports=function(n){var t=n[0].trace,et=t.visible===!0,g=t.fill!=="none",nt=e.hasLines(t),tt=e.hasMarkers(t),it=e.hasText(t),ot=tt&&t.marker.symbol==="circle",rt=tt&&t.marker.symbol!=="circle",p=o(),w=o(),b=o(),s=o(),ut={fill:p,line:w,circle:b,symbol:s},k,h,ft,d;return!et||n[0].placeholder?ut:((g||nt)&&(k=f.calcTraceToLineCoords(n)),g&&(p.geojson=f.makePolygon(k),p.layout.visibility="visible",i.extendFlat(p.paint,{"fill-color":t.fillcolor})),nt&&(w.geojson=f.makeLine(k),w.layout.visibility="visible",i.extendFlat(w.paint,{"line-width":t.line.width,"line-color":t.line.color,"line-opacity":t.opacity})),ot&&(h={},h[r]={},h[u]={},b.geojson=l(n,h),b.layout.visibility="visible",i.extendFlat(b.paint,{"circle-opacity":t.opacity*t.marker.opacity,"circle-color":v(t,h),"circle-radius":y(t,h)})),(rt||it)&&(s.geojson=a(n),i.extendFlat(s.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),rt&&(i.extendFlat(s.layout,{"icon-size":t.marker.size/10}),i.extendFlat(s.paint,{"icon-opacity":t.opacity*t.marker.opacity,"icon-color":t.marker.color})),it&&(ft=(t.marker||{}).size,d=c(t.textposition,ft),i.extendFlat(s.layout,{"text-size":t.textfont.size,"text-anchor":d.anchor,"text-offset":d.offset}),i.extendFlat(s.paint,{"text-color":t.textfont.color,"text-opacity":t.opacity}))),ut)}},{"../../lib":681,"../../lib/geojson_utils":678,"../../plots/mapbox/convert_text_opts":762,"../scatter/subtypes":909}],932:[function(n,t){"use strict";function c(n,t,i){var u=i("lon")||[],f=i("lat")||[],r=Math.min(u.length,f.length);return r<u.length&&(t.lon=u.slice(0,r)),r<f.length&&(t.lat=f.slice(0,r)),r}var r=n("../../lib"),i=n("../scatter/subtypes"),f=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/text_defaults"),s=n("../scatter/fillcolor_defaults"),u=n("./attributes"),h=n("../scatter/attributes");t.exports=function(n,t,l,a){function v(i,f){return r.coerce(n,t,u,i,f)}function p(i,f){var e=i.indexOf(".line")===-1?u:h;return r.coerce(n,t,e,i,f)}var w=c(n,t,v),y;if(!w){t.visible=!1;return}v("text");v("mode");i.hasLines(t)&&(e(n,t,l,a,v),v("connectgaps"));i.hasMarkers(t)&&(f(n,t,l,a,p),y=t.marker,y.symbol!=="circle"&&(Array.isArray(y.size)&&(y.size=y.size[0]),Array.isArray(y.color)&&(y.color=y.color[0])));i.hasText(t)&&o(n,t,a,v);v("fill");t.fill!=="none"&&s(n,t,l,v);v("hoverinfo",a._dataLength===1?"lon+lat+text":undefined)}},{"../../lib":681,"../scatter/attributes":889,"../scatter/fillcolor_defaults":896,"../scatter/line_defaults":900,"../scatter/marker_defaults":905,"../scatter/subtypes":909,"../scatter/text_defaults":910,"./attributes":929}],933:[function(n,t){"use strict";t.exports=function(n,t){return n.lon=t.lon,n.lat=t.lat,n}},{}],934:[function(n,t){"use strict";function u(n,t){function f(n){return n+"°"}var r=n.hoverinfo.split("+"),e=r.indexOf("all")!==-1,o=r.indexOf("lon")!==-1,s=r.indexOf("lat")!==-1,u=t.lonlat,i=[];return e||o&&s?i.push("("+f(u[0])+", "+f(u[1])+")"):o?i.push("lon: "+f(u[0])):s&&i.push("lat: "+f(u[1])),(e||r.indexOf("text")!==-1)&&i.push(t.tx||n.text),i.join("<br>")}var i=n("../../plots/cartesian/graph_interact"),r=n("../scatter/get_trace_color");t.exports=function(n,t,f){function d(n){var t=n.lonlat,i=Math.abs(h.c2p(t)-h.c2p([k,t[1]])),r=Math.abs(c.c2p(t)-c.c2p([t[0],f])),u=Math.max(3,n.mrc||0);return Math.max(Math.sqrt(i*i+r*r)-u,1-3/u)}var e=n.cd,l=e[0].trace,h=n.xa,c=n.ya;if(!e[0].placeholder){var b=t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360),a=b*360,k=t-a;if(i.getClosest(e,d,n),n.index!==!1){var o=e[n.index],v=o.lonlat,y=[v[0]+a,v[1]],p=h.c2p(y),w=c.c2p(y),s=o.mrc||1;return n.x0=p-s,n.x1=p+s,n.y0=w-s,n.y1=w+s,n.color=r(l,o),n.extraText=u(l,o),[n]}}}},{"../../plots/cartesian/graph_interact":717,"../scatter/get_trace_color":897}],935:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../scatter/colorbar");i.calc=n("./calc");i.hoverPoints=n("./hover");i.eventData=n("./event_data");i.plot=n("./plot");i.moduleType="trace";i.name="scattermapbox";i.basePlotModule=n("../../plots/mapbox");i.categories=["mapbox","gl","symbols","markerColorscale","showLegend"];i.meta={};t.exports=i},{"../../plots/mapbox":763,"../scatter/colorbar":892,"./attributes":929,"./calc":930,"./defaults":932,"./event_data":933,"./hover":934,"./plot":936}],936:[function(n,t){"use strict";function r(n,t){this.mapbox=n;this.map=n.map;this.uid=t;this.idSourceFill=t+"-source-fill";this.idSourceLine=t+"-source-line";this.idSourceCircle=t+"-source-circle";this.idSourceSymbol=t+"-source-symbol";this.idLayerFill=t+"-layer-fill";this.idLayerLine=t+"-layer-line";this.idLayerCircle=t+"-layer-circle";this.idLayerSymbol=t+"-layer-symbol";this.mapbox.initSource(this.idSourceFill);this.mapbox.initSource(this.idSourceLine);this.mapbox.initSource(this.idSourceCircle);this.mapbox.initSource(this.idSourceSymbol);this.map.addLayer({id:this.idLayerFill,source:this.idSourceFill,type:"fill"});this.map.addLayer({id:this.idLayerLine,source:this.idSourceLine,type:"line"});this.map.addLayer({id:this.idLayerCircle,source:this.idSourceCircle,type:"circle"});this.map.addLayer({id:this.idLayerSymbol,source:this.idSourceSymbol,type:"symbol"})}function i(n){return n.layout.visibility==="visible"}var f=n("./convert"),u=r.prototype;u.update=function(n){var r=this.mapbox,t=f(n);r.setOptions(this.idLayerFill,"setLayoutProperty",t.fill.layout);r.setOptions(this.idLayerLine,"setLayoutProperty",t.line.layout);r.setOptions(this.idLayerCircle,"setLayoutProperty",t.circle.layout);r.setOptions(this.idLayerSymbol,"setLayoutProperty",t.symbol.layout);i(t.fill)&&(r.setSourceData(this.idSourceFill,t.fill.geojson),r.setOptions(this.idLayerFill,"setPaintProperty",t.fill.paint));i(t.line)&&(r.setSourceData(this.idSourceLine,t.line.geojson),r.setOptions(this.idLayerLine,"setPaintProperty",t.line.paint));i(t.circle)&&(r.setSourceData(this.idSourceCircle,t.circle.geojson),r.setOptions(this.idLayerCircle,"setPaintProperty",t.circle.paint));i(t.symbol)&&(r.setSourceData(this.idSourceSymbol,t.symbol.geojson),r.setOptions(this.idLayerSymbol,"setPaintProperty",t.symbol.paint))};u.dispose=function(){var n=this.map;n.removeLayer(this.idLayerFill);n.removeLayer(this.idLayerLine);n.removeLayer(this.idLayerCircle);n.removeLayer(this.idLayerSymbol);n.removeSource(this.idSourceFill);n.removeSource(this.idSourceLine);n.removeSource(this.idSourceCircle);n.removeSource(this.idSourceSymbol)};t.exports=function(n,t){var u=t[0].trace,i=new r(n,u.uid);return i.update(t),i}},{"./convert":931}],937:[function(n,t){"use strict";var i=n("../scatter/attributes"),o=n("../../plots/attributes"),e=n("../../components/colorscale/color_attributes"),u=n("../../lib/extend").extendFlat,r=i.marker,f=i.line,s=r.line;t.exports={a:{valType:"data_array"},b:{valType:"data_array"},c:{valType:"data_array"},sum:{valType:"number",dflt:0,min:0},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),line:{color:f.color,width:f.width,dash:f.dash,shape:u({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing},connectgaps:i.connectgaps,fill:u({},i.fill,{values:["none","toself","tonext"]}),fillcolor:i.fillcolor,marker:u({},{symbol:r.symbol,opacity:r.opacity,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,showscale:r.showscale,line:u({},{width:s.width},e("marker".line))},e("marker")),textfont:i.textfont,textposition:i.textposition,hoverinfo:u({},o.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:i.hoveron,_nestedModules:{"marker.colorbar":"Colorbar"}}},{"../../components/colorscale/color_attributes":590,"../../lib/extend":673,"../../plots/attributes":708,"../scatter/attributes":889}],938:[function(n,t){"use strict";var i=n("fast-isnumeric"),f=n("../../plots/cartesian/axes"),e=n("../../lib"),o=n("../scatter/subtypes"),s=n("../scatter/colorscale_calc"),r=["a","b","c"],u={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function(n,t){for(var et=n._fullLayout[t.subplot],tt=et.sum,ot=t.sum||tt,y,w,g,d,it,p,b,c,l,a,k,rt,ut,ft,v,nt,h=0;h<r.length;h++)if(w=r[h],!t[w]){for(d=t[u[w][0]],it=t[u[w][1]],g=new Array(d.length),y=0;y<d.length;y++)g[y]=ot-d[y]-it[y];t[w]=g}for(p=t.a.length,b=new Array(p),h=0;h<p;h++)c=t.a[h],l=t.b[h],a=t.c[h],i(c)&&i(l)&&i(a)?(c=+c,l=+l,a=+a,k=tt/(c+l+a),k!==1&&(c*=k,l*=k,a*=k),ut=c,rt=a-l,b[h]={x:rt,y:ut,a:c,b:l,c:a}):b[h]={x:!1,y:!1};return o.hasMarkers(t)&&(ft=t.marker,v=ft.size,Array.isArray(v)&&(nt={type:"linear"},f.setConvert(nt),v=nt.makeCalcdata(t.marker,"size"),v.length>p&&v.splice(p,v.length-p))),s(t),typeof v!="undefined"&&e.mergeArray(v,b,"ms"),b}},{"../../lib":681,"../../plots/cartesian/axes":710,"../scatter/colorscale_calc":893,"../scatter/subtypes":909,"fast-isnumeric":133}],939:[function(n,t){"use strict";var u=n("../../lib"),f=n("../scatter/constants"),i=n("../scatter/subtypes"),e=n("../scatter/marker_defaults"),o=n("../scatter/line_defaults"),r=n("../scatter/line_shape_defaults"),s=n("../scatter/text_defaults"),h=n("../scatter/fillcolor_defaults"),c=n("./attributes");t.exports=function(n,t,l,a){function v(i,r){return u.coerce(n,t,c,i,r)}var b=v("a"),w=v("b"),p=v("c"),y,d,k;if(b?(y=b.length,w?(y=Math.min(y,w.length),p&&(y=Math.min(y,p.length))):y=p?Math.min(y,p.length):0):w&&p&&(y=Math.min(w.length,p.length)),!y){t.visible=!1;return}b&&y<b.length&&(t.a=b.slice(0,y));w&&y<w.length&&(t.b=w.slice(0,y));p&&y<p.length&&(t.c=p.slice(0,y));v("sum");v("text");d=y<f.PTS_LINESONLY?"lines+markers":"lines";v("mode",d);i.hasLines(t)&&(o(n,t,l,a,v),r(n,t,v),v("connectgaps"));i.hasMarkers(t)&&e(n,t,l,a,v);i.hasText(t)&&s(n,t,a,v);k=[];(i.hasMarkers(t)||i.hasText(t))&&(v("marker.maxdisplayed"),k.push("points"));v("fill");t.fill!=="none"&&(h(n,t,l,v),i.hasLines(t)||r(n,t,v));v("hoverinfo",a._dataLength===1?"a+b+c+text":undefined);(t.fill==="tonext"||t.fill==="toself")&&k.push("fills");v("hoveron",k.join("+")||"points")}},{"../../lib":681,"../scatter/constants":894,"../scatter/fillcolor_defaults":896,"../scatter/line_defaults":900,"../scatter/line_shape_defaults":902,"../scatter/marker_defaults":905,"../scatter/subtypes":909,"../scatter/text_defaults":910,"./attributes":937}],940:[function(n,t){"use strict";var i=n("../scatter/hover"),r=n("../../plots/cartesian/axes");t.exports=function(n,t,u,f){function a(n,t){w.push(n._hovertitle+": "+r.tickText(n,t,"hover").text)}var s=i(n,t,u,f),e,o;if(s&&s[0].index!==!1){if(e=s[0],e.index===undefined){var b=1-e.y0/n.ya._length,v=n.xa._length,c=v*b/2,y=v-c;return e.x0=Math.max(Math.min(e.x0,y),c),e.x1=Math.max(Math.min(e.x1,y),c),s}o=e.cd[e.index];e.a=o.a;e.b=o.b;e.c=o.c;e.xLabelVal=undefined;e.yLabelVal=undefined;var p=e.trace,l=p._ternary,h=p.hoverinfo.split("+"),w=[];return h.indexOf("all")!==-1&&(h=["a","b","c"]),h.indexOf("a")!==-1&&a(l.aaxis,o.a),h.indexOf("b")!==-1&&a(l.baxis,o.b),h.indexOf("c")!==-1&&a(l.caxis,o.c),e.extraText=w.join("<br>"),s}}},{"../../plots/cartesian/axes":710,"../scatter/hover":898}],941:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("../scatter/colorbar");i.calc=n("./calc");i.plot=n("./plot");i.style=n("./style");i.hoverPoints=n("./hover");i.selectPoints=n("./select");i.moduleType="trace";i.name="scatterternary";i.basePlotModule=n("../../plots/ternary");i.categories=["ternary","symbols","markerColorscale","showLegend"];i.meta={};t.exports=i},{"../../plots/ternary":777,"../scatter/colorbar":892,"./attributes":937,"./calc":938,"./defaults":939,"./hover":940,"./plot":942,"./select":943,"./style":944}],942:[function(n,t){"use strict";var i=n("../scatter/plot");t.exports=function(n,t){var e=n.plotContainer,r,u;e.select(".scatterlayer").selectAll("*").remove();var s={xaxis:n.xaxis,yaxis:n.yaxis,plot:e},o=new Array(t.length),f=n.graphDiv.calcdata;for(r=0;r<f.length;r++)(u=t.indexOf(f[r][0].trace),u!==-1)&&(o[u]=f[r],t[u]._ternary=n);i(n.graphDiv,s,o)}},{"../scatter/plot":906}],943:[function(n,t){"use strict";var i=n("../scatter/select");t.exports=function(n,t){var u=i(n,t),o,r,f,e;if(u){for(o=n.cd,e=0;e<u.length;e++)r=u[e],f=o[r.pointNumber],r.a=f.a,r.b=f.b,r.c=f.c,delete r.x,delete r.y;return u}}},{"../scatter/select":907}],944:[function(n,t){"use strict";var i=n("../scatter/style");t.exports=function(n){for(var r=n._fullLayout._modules,t=0;t<r.length;t++)if(r[t].name==="scatter")return;i(n)}},{"../scatter/style":908}],945:[function(n,t){"use strict";function u(){return{valType:"boolean",dflt:!1}}function f(){return{show:{valType:"boolean",dflt:!1},project:{x:u("x"),y:u("y"),z:u("z")},color:{valType:"color",dflt:e.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:e.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var e=n("../../components/color"),i=n("../../components/colorscale/attributes"),r=n("../../lib/extend").extendFlat;t.exports={z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"data_array"},surfacecolor:{valType:"data_array"},cauto:i.zauto,cmin:i.zmin,cmax:i.zmax,colorscale:i.colorscale,autocolorscale:r({},i.autocolorscale,{dflt:!1}),reversescale:i.reversescale,showscale:i.showscale,contours:{x:f("x"),y:f("y"),z:f("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_nestedModules:{colorbar:"Colorbar"},_deprecated:{zauto:r({},i.zauto,{}),zmin:r({},i.zmin,{}),zmax:r({},i.zmax,{})}}},{"../../components/color":582,"../../components/colorscale/attributes":588,"../../lib/extend":673}],946:[function(n,t){"use strict";var i=n("../../components/colorscale/calc");t.exports=function(n,t){t.surfacecolor?i(t,t.surfacecolor,"","c"):i(t,t.z,"","c")}},{"../../components/colorscale/calc":589}],947:[function(n,t){"use strict";var u=n("d3"),i=n("fast-isnumeric"),r=n("../../lib"),f=n("../../plots/plots"),e=n("../../components/colorscale/get_scale"),o=n("../../components/colorbar/draw");t.exports=function(n,t){var s=t[0].trace,l="cb"+s.uid,a=e(s.colorscale),h=s.cmin,c=s.cmax,v=s.surfacecolor||s.z,y;if(i(h)||(h=r.aggNums(Math.min,null,v)),i(c)||(c=r.aggNums(Math.max,null,v)),n._fullLayout._infolayer.selectAll("."+l).remove(),!s.showscale){f.autoMargin(n,l);return}y=t[0].t.cb=o(n,l);y.fillcolor(u.scale.linear().domain(a.map(function(n){return h+n[0]*(c-h)})).range(a.map(function(n){return n[1]}))).filllevels({start:h,end:c,size:(c-h)/254}).options(s.colorbar)()}},{"../../components/colorbar/draw":585,"../../components/colorscale/get_scale":594,"../../lib":681,"../../plots/plots":769,d3:129,"fast-isnumeric":133}],948:[function(n,t){"use strict";function s(n,t,i){this.scene=n;this.uid=i;this.surface=t;this.data=null;this.showContour=[!1,!1,!1];this.dataScale=1}function a(n,t){return t===undefined&&(t=1),n.map(function(n){var r=n[0],u=l(n[1]),i=u.toRgb();return{index:r,rgb:[i.r,i.g,i.b,t]}})}function v(n){var t=n[0].rgb,i=n[n.length-1].rgb;return t[0]===i[0]&&t[1]===i[1]&&t[2]===i[2]&&t[3]===i[3]}function y(n){var t=n.shape,f=[t[0]+2,t[1]+2],r=i(new Float32Array(f[0]*f[1]),f);return u.assign(r.lo(1,1).hi(t[0],t[1]),n),u.assign(r.lo(1).hi(t[0],1),n.hi(t[0],1)),u.assign(r.lo(1,f[1]-1).hi(t[0],1),n.lo(0,t[1]-1).hi(t[0],1)),u.assign(r.lo(0,1).hi(1,t[1]),n.hi(1)),u.assign(r.lo(f[0]-1,1).hi(1,t[1]),n.lo(t[0]-1)),r.set(0,0,n.get(0,0)),r.set(0,f[1]-1,n.get(0,t[1]-1)),r.set(f[0]-1,0,n.get(t[0]-1,0)),r.set(f[0]-1,f[1]-1,n.get(t[0]-1,t[1]-1)),r}function p(n){var e=Math.max(n[0].shape[0],n[0].shape[1]),r,s,f;if(e<o){var t=o/e,u=[Math.floor(n[0].shape[0]*t+1)|0,Math.floor(n[0].shape[1]*t+1)|0],h=u[0]*u[1];for(r=0;r<n.length;++r)s=y(n[r]),f=i(new Float32Array(h),u),c(f,s,[t,0,0,0,t,0,0,0,1]),n[r]=f;return t}return 1}function w(n,t){var u=n.glplot.gl,i=h({gl:u}),r=new s(n,i,t.uid);return r.update(t),n.glplot.add(i),r}var h=n("gl-surface3d"),i=n("ndarray"),c=n("ndarray-homography"),r=n("ndarray-fill"),u=n("ndarray-ops"),l=n("tinycolor2"),e=n("../../lib/str2rgbarray"),o=128,f=s.prototype;f.handlePick=function(n){var t,i,u,r;if(n.object===this.surface)return t=[Math.min(Math.round(n.data.index[0]/this.dataScale-1)|0,this.data.z[0].length-1),Math.min(Math.round(n.data.index[1]/this.dataScale-1)|0,this.data.z.length-1)],i=[0,0,0],i[0]=Array.isArray(this.data.x[0])?this.data.x[t[1]][t[0]]:this.data.x[t[0]],i[1]=Array.isArray(this.data.y[0])?this.data.y[t[1]][t[0]]:this.data.y[t[1]],i[2]=this.data.z[t[1]][t[0]],n.traceCoordinate=i,u=this.scene.fullSceneLayout,n.dataCoordinate=[u.xaxis.d2l(i[0])*this.scene.dataScale[0],u.yaxis.d2l(i[1])*this.scene.dataScale[1],u.zaxis.d2l(i[2])*this.scene.dataScale[2]],r=this.data.text,n.textLabel=r&&r[t[1]]&&r[t[1]][t[0]]!==undefined?r[t[1]][t[0]]:"",n.data.dataCoordinate=n.dataCoordinate.slice(),this.surface.highlight(n.data),this.scene.glplot.spikes.position=n.dataCoordinate,!0};f.setContourLevels=function(){for(var t=[[],[],[]],i=!1,n=0;n<3;++n)this.showContour[n]&&(i=!0,t[n]=this.scene.contourLevels[n]);i&&this.surface.update({levels:t})};f.update=function(n){var t,y=this.scene,w=y.fullSceneLayout,o=this.surface,b=n.opacity,it=a(n.colorscale,b),k=n.z,d=n.x,g=n.y,rt=w.xaxis,ut=w.yaxis,st=w.zaxis,c=y.dataScale,s=k[0].length,h=k.length,l=[i(new Float32Array(s*h),[s,h]),i(new Float32Array(s*h),[s,h]),i(new Float32Array(s*h),[s,h])],ft=l[0],et=l[1],ht=y.contourLevels,u,nt,tt,ot,f;for(this.data=n,r(l[2],function(n,t){return st.d2l(k[t][n])*c[2]}),Array.isArray(d[0])?r(ft,function(n,t){return rt.d2l(d[t][n])*c[0]}):r(ft,function(n){return rt.d2l(d[n])*c[0]}),Array.isArray(g[0])?r(et,function(n,t){return ut.d2l(g[t][n])*c[1]}):r(et,function(n,t){return ut.d2l(g[t])*c[1]}),u={colormap:it,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!n.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:1},u.intensityBounds=[n.cmin,n.cmax],n.surfacecolor?(nt=i(new Float32Array(s*h),[s,h]),r(nt,function(t,i){return n.surfacecolor[i][t]}),l.push(nt)):(u.intensityBounds[0]*=c[2],u.intensityBounds[1]*=c[2]),this.dataScale=p(l),n.surfacecolor&&(u.intensity=l.pop()),("opacity"in n)&&n.opacity<1&&(u.opacity=.25*n.opacity),tt=[!0,!0,!0],ot=["x","y","z"],t=0;t<3;++t)(f=n.contours[ot[t]],tt[t]=f.highlight,u.showContour[t]=f.show||f.highlight,u.showContour[t])&&(u.contourProject[t]=[f.project.x,f.project.y,f.project.z],f.show?(this.showContour[t]=!0,u.levels[t]=ht[t],o.highlightColor[t]=u.contourColor[t]=e(f.color),o.highlightTint[t]=f.usecolormap?u.contourTint[t]=0:u.contourTint[t]=1,u.contourWidth[t]=f.width):this.showContour[t]=!1,f.highlight&&(u.dynamicColor[t]=e(f.highlightcolor),u.dynamicWidth[t]=f.highlightwidth));v(it)&&(u.vertexColor=!0);u.coords=l;o.update(u);o.visible=n.visible;o.enableDynamic=tt;o.snapToData=!0;"lighting"in n&&(o.ambientLight=n.lighting.ambient,o.diffuseLight=n.lighting.diffuse,o.specularLight=n.lighting.specular,o.roughness=n.lighting.roughness,o.fresnel=n.lighting.fresnel);"lightposition"in n&&(o.lightPosition=[n.lightposition.x,n.lightposition.y,n.lightposition.z]);b&&b<1&&(o.supportsTransparency=!0)};f.dispose=function(){this.scene.glplot.remove(this.surface);this.surface.dispose()};t.exports=w},{"../../lib/str2rgbarray":694,"gl-surface3d":301,ndarray:525,"ndarray-fill":518,"ndarray-homography":523,"ndarray-ops":524,tinycolor2:546}],949:[function(n,t){"use strict";function i(n,t,i){t in n&&!(i in n)&&(n[i]=n[t])}var r=n("../../lib"),u=n("../../components/colorscale/defaults"),f=n("./attributes");t.exports=function(n,t,e,o){function s(i,u){return r.coerce(n,t,f,i,u)}var h,l,a=s("z"),y,p,w,v;if(!a){t.visible=!1;return}if(y=a[0].length,p=a.length,s("x"),s("y"),!Array.isArray(t.x))for(t.x=[],h=0;h<y;++h)t.x[h]=h;if(s("text"),!Array.isArray(t.y))for(t.y=[],h=0;h<p;++h)t.y[h]=h;for(["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","opacity"].forEach(function(n){s(n)}),w=s("surfacecolor"),s("colorscale"),v=["x","y","z"],h=0;h<3;++h){var c="contours."+v[h],b=s(c+".show"),k=s(c+".highlight");if(b||k)for(l=0;l<3;++l)s(c+".project."+v[l]);b&&(s(c+".color"),s(c+".width"),s(c+".usecolormap"));k&&(s(c+".highlightcolor"),s(c+".highlightwidth"))}w||(i(n,"zmin","cmin"),i(n,"zmax","cmax"),i(n,"zauto","cauto"));u(n,t,o,s,{prefix:"",cLetter:"c"})}},{"../../components/colorscale/defaults":592,"../../lib":681,"./attributes":945}],950:[function(n,t){"use strict";var i={};i.attributes=n("./attributes");i.supplyDefaults=n("./defaults");i.colorbar=n("./colorbar");i.calc=n("./calc");i.plot=n("./convert");i.moduleType="trace";i.name="surface";i.basePlotModule=n("../../plots/gl3d");i.categories=["gl3d","noOpacity"];i.meta={};t.exports=i},{"../../plots/gl3d":748,"./attributes":945,"./calc":946,"./colorbar":947,"./convert":948,"./defaults":949}],951:[function(n,t,i){"use strict";function s(n,t,i){var r=o.getFromTrace(n,t,i);return r?r.d2c:i==="ids"?function(n){return String(n)}:function(n){return+n}}function h(n,t){function s(n){return n.indexOf(h)!==-1}var h=n.operation,r=n.value,o=Array.isArray(r),i;s(u)?i=o?t(r[0]):t(r):s(f)?i=o?[t(r[0]),t(r[1])]:[t(r),t(r)]:s(e)&&(i=o?r.map(t):[t(r)]);switch(h){case"=":return function(n){return t(n)===i};case"<":return function(n){return t(n)<i};case"<=":return function(n){return t(n)<=i};case">":return function(n){return t(n)>i};case">=":return function(n){return t(n)>=i};case"[]":return function(n){var r=t(n);return r>=i[0]&&r<=i[1]};case"()":return function(n){var r=t(n);return r>i[0]&&r<i[1]};case"[)":return function(n){var r=t(n);return r>=i[0]&&r<i[1]};case"(]":return function(n){var r=t(n);return r>i[0]&&r<=i[1]};case"][":return function(n){var r=t(n);return r<=i[0]||r>=i[1]};case")(":return function(n){var r=t(n);return r<i[0]||r>i[1]};case"](":return function(n){var r=t(n);return r<=i[0]||r>i[1]};case")[":return function(n){var r=t(n);return r<i[0]||r>=i[1]};case"{}":return function(n){return i.indexOf(t(n))!==-1};case"}{":return function(n){return i.indexOf(t(n))===-1}}}var r=n("../lib"),o=n("../plots/cartesian/axis_ids"),u=["=","<",">=",">","<="],f=["[]","()","[)","(]","][",")(","](",")["],e=["{}","}{"];i.moduleType="transform";i.name="filter";i.attributes={enabled:{valType:"boolean",dflt:!0},filtersrc:{valType:"string",strict:!0,noBlank:!0,dflt:"x"},operation:{valType:"enumerated",values:[].concat(u).concat(f).concat(e),dflt:"="},value:{valType:"any",dflt:0}};i.supplyDefaults=function(n){function t(t,f){return r.coerce(n,u,i.attributes,t,f)}var u={},f=t("enabled");return f&&(t("operation"),t("value"),t("filtersrc")),u};i.calcTransform=function(n,t,i){function g(n,i){var u=y[n],f=r.nestedProperty(t,n).get();f.push(u[i])}var f=i.filtersrc,w=f&&Array.isArray(r.nestedProperty(t,f).get()),o,l,a,u,p,c;if(i.enabled&&w){var b=s(n,t,f),k=h(i,b),v=r.nestedProperty(t,f).get(),d=v.length,e=r.findArrayAttributes(t),y={};for(o=0;o<e.length;o++)l=e[o],a=r.nestedProperty(t,l),y[l]=r.extendDeep([],a.get()),a.set([]);for(u=0;u<d;u++)if(p=v[u],k(p))for(c=0;c<e.length;c++)g(e[c],u)}}},{"../lib":681,"../plots/cartesian/axis_ids":712}],952:[function(n,t,i){"use strict";function u(n,t){r.nestedProperty(n,t).set([])}function f(n,t,i,u){r.nestedProperty(n,u).set(r.nestedProperty(n,u).get().concat([r.nestedProperty(t,u).get()[i]]))}function e(n,t){var v=t.transform,e=n.transforms[t.transformIndex].groups,o,h,i,s;if(!Array.isArray(e)||e.length===0)return n;var c=r.filterUnique(e),l=new Array(c.length),y=e.length,a=r.findArrayAttributes(n),p=v.style||{};for(o=0;o<c.length;o++){for(h=c[o],i=l[o]=r.extendDeepNoArrays({},n),a.forEach(u.bind(null,i)),s=0;s<y;s++)e[s]===h&&a.forEach(f.bind(0,i,n,s));i.name=h;i=r.extendDeepNoArrays(i,p[h]||{})}return l}var r=n("../lib");i.moduleType="transform";i.name="groupby";i.attributes={enabled:{valType:"boolean",dflt:!0},groups:{valType:"data_array",dflt:[]},style:{valType:"any",dflt:{}}};i.supplyDefaults=function(n){function u(u,f){return r.coerce(n,t,i.attributes,u,f)}var t={},f=u("enabled");return f?(u("groups"),u("style"),t):t};i.transform=function(n,t){for(var i=[],r=0;r<n.length;r++)i=i.concat(e(n[r],t));return i}},{"../lib":681}]},{},[15])(15)});